<html><head><title>Faiss - Introduction to Similarity Search</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Faiss - Introduction to Similarity Search</h2><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk"><img src="https://i.ytimg.com/vi_webp/sKyvsdEv6rk/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=201">3:21</a> Code Overview<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=375">6:15</a> Index Flat L2<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=490">8:10</a> Index Training<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=542">9:2</a> Adding Vectors<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=730">12:10</a> Query Time<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=780">13:0</a> Voronoi Cells<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=975">16:15</a> Coding<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1216">20:16</a> Index IVF<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1363">22:43</a> Product Quantization Index<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1554">25:54</a> Implementing Product Quantization Index<br><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1838">30:38</a> Comparison<br><br><div style="text-align: left;"><a href="./sKyvsdEv6rk.html">Whisper Transcript</a> | <a href="./transcript_sKyvsdEv6rk.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=0" target="_blank">00:00:00.920</a></span> | <span class="t">Hi, welcome to this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=3" target="_blank">00:00:03.120</a></span> | <span class="t">We're going to be covering Facebook AI Similarity Search, or FICE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=6" target="_blank">00:00:06.760</a></span> | <span class="t">And we're going to be covering what FICE is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=10" target="_blank">00:00:10.880</a></span> | <span class="t">and how we can actually begin using it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=14" target="_blank">00:00:14.480</a></span> | <span class="t">And we'll introduce a few of the key indexes that we can use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=18" target="_blank">00:00:18.920</a></span> | <span class="t">So just as a quick introduction to FICE,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=24" target="_blank">00:00:24.760</a></span> | <span class="t">as you can probably tell from the name, it's a similarity search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=28" target="_blank">00:00:28.280</a></span> | <span class="t">and it's a library that we can use from Facebook AI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=32" target="_blank">00:00:32.880</a></span> | <span class="t">that allows us to compare vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=37" target="_blank">00:00:37.240</a></span> | <span class="t">with a very high efficiency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=42" target="_blank">00:00:42.120</a></span> | <span class="t">So, if you've seen any of my videos before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=46" target="_blank">00:00:46.000</a></span> | <span class="t">on building sentence embeddings and comparing sentence embeddings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=50" target="_blank">00:00:50.520</a></span> | <span class="t">in those videos, I just did a generic Python loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=54" target="_blank">00:00:54.480</a></span> | <span class="t">to go through and compare each embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=56" target="_blank">00:00:56.800</a></span> | <span class="t">And that's very slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=58" target="_blank">00:00:58.760</a></span> | <span class="t">Now, if you're only working with maybe 100 vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=62" target="_blank">00:01:02.360</a></span> | <span class="t">it's probably OK, you can deal with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=64" target="_blank">00:01:04.080</a></span> | <span class="t">But in reality, we're probably never going to be working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=67" target="_blank">00:01:07.080</a></span> | <span class="t">with that smaller data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=68" target="_blank">00:01:08.880</a></span> | <span class="t">Facebook AI Similarity Search can scale to tens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=73" target="_blank">00:01:13.040</a></span> | <span class="t">hundreds of thousands or up to millions and even billions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=76" target="_blank">00:01:16.880</a></span> | <span class="t">So this is incredibly good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=82" target="_blank">00:01:22.160</a></span> | <span class="t">for efficient similarity search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=86" target="_blank">00:01:26.400</a></span> | <span class="t">But before we get into it, I'll just sort of visualize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=89" target="_blank">00:01:29.560</a></span> | <span class="t">what this index looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=92" target="_blank">00:01:32.880</a></span> | <span class="t">So if we imagine that we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=96" target="_blank">00:01:36.960</a></span> | <span class="t">all of the vectors that we have created and we put it into our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=101" target="_blank">00:01:41.960</a></span> | <span class="t">similar search index, now they could look like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=107" target="_blank">00:01:47.000</a></span> | <span class="t">So this is only a three dimensional space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=110" target="_blank">00:01:50.000</a></span> | <span class="t">But in reality, there would be hundreds of dimensions here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=115" target="_blank">00:01:55.840</a></span> | <span class="t">In our use case, we're going to be using dimensions of 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=122" target="_blank">00:02:02.160</a></span> | <span class="t">So, you know, there's a fair bit in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=124" target="_blank">00:02:04.760</a></span> | <span class="t">Now, when we search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=131" target="_blank">00:02:11.240</a></span> | <span class="t">we would introduce a new vector into here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=135" target="_blank">00:02:15.200</a></span> | <span class="t">So let's say here, this is our query vector, so X, Q.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=139" target="_blank">00:02:19.520</a></span> | <span class="t">Now, if we were comparing every item here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=144" target="_blank">00:02:24.520</a></span> | <span class="t">we would have to calculate the distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=147" target="_blank">00:02:27.120</a></span> | <span class="t">between every single item.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=149" target="_blank">00:02:29.400</a></span> | <span class="t">So we would calculate for between our query vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=153" target="_blank">00:02:33.920</a></span> | <span class="t">and every other vector that is already in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=156" target="_blank">00:02:36.400</a></span> | <span class="t">in order to find the vectors which are closest to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=158" target="_blank">00:02:38.960</a></span> | <span class="t">Now, we can optimize this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=162" target="_blank">00:02:42.720</a></span> | <span class="t">We can improve, we can decrease the number of dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=169" target="_blank">00:02:49.040</a></span> | <span class="t">in each of our vectors and do it in a intelligent way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=171" target="_blank">00:02:51.800</a></span> | <span class="t">so they take up less space and the calculations are faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=175" target="_blank">00:02:55.960</a></span> | <span class="t">And we can also restrict our search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=178" target="_blank">00:02:58.320</a></span> | <span class="t">So in this case, rather than comparing every single item,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=181" target="_blank">00:03:01.880</a></span> | <span class="t">we might restrict our search to just this area here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=186" target="_blank">00:03:06.400</a></span> | <span class="t">And these are a few of the optimizations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=190" target="_blank">00:03:10.320</a></span> | <span class="t">at a very high level that we can do with FICE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=193" target="_blank">00:03:13.240</a></span> | <span class="t">So that's enough for the introduction to FICE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=198" target="_blank">00:03:18.280</a></span> | <span class="t">Let's actually jump straight into the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=201" target="_blank">00:03:21.640</a></span> | <span class="t">Okay, so this is our code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=203" target="_blank">00:03:23.800</a></span> | <span class="t">In here, this is how we are loading in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=207" target="_blank">00:03:27.200</a></span> | <span class="t">all of our sentence embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=209" target="_blank">00:03:29.440</a></span> | <span class="t">So I've gone ahead and processed them already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=211" target="_blank">00:03:31.320</a></span> | <span class="t">'cause they do take a little bit of time to actually build,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=215" target="_blank">00:03:35.000</a></span> | <span class="t">but we're building them from this file here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=218" target="_blank">00:03:38.040</a></span> | <span class="t">We'll load this into Python as well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=219" target="_blank">00:03:39.800</a></span> | <span class="t">but I mean, it's pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=222" target="_blank">00:03:42.960</a></span> | <span class="t">It's just a load of sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=225" target="_blank">00:03:45.880</a></span> | <span class="t">that have been separated by a newline character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=228" target="_blank">00:03:48.400</a></span> | <span class="t">And then in here, we have all of those NumPy binary files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=232" target="_blank">00:03:52.560</a></span> | <span class="t">Now, there's NumPy binary files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=235" target="_blank">00:03:55.400</a></span> | <span class="t">Like I said, we're getting them from GitHub,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=237" target="_blank">00:03:57.040</a></span> | <span class="t">which are over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=238" target="_blank">00:03:58.480</a></span> | <span class="t">That's where we're pulling them all in using this cell here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=242" target="_blank">00:04:02.960</a></span> | <span class="t">Now, that saves everything to file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=246" target="_blank">00:04:06.720</a></span> | <span class="t">And then we just read in each of those files</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=248" target="_blank">00:04:08.920</a></span> | <span class="t">and we append them all into a single NumPy array here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=254" target="_blank">00:04:14.160</a></span> | <span class="t">And that gives us these 14.5 thousand samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=258" target="_blank">00:04:18.520</a></span> | <span class="t">Each embedding is a vector with 768 values inside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=263" target="_blank">00:04:23.520</a></span> | <span class="t">So that's how we're loading in our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=267" target="_blank">00:04:27.560</a></span> | <span class="t">I'll also load in that text file as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=269" target="_blank">00:04:29.840</a></span> | <span class="t">So we just want to do with open</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=272" target="_blank">00:04:32.000</a></span> | <span class="t">sentences.text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=279" target="_blank">00:04:39.760</a></span> | <span class="t">And then we're just reading that in as a normal file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=283" target="_blank">00:04:43.680</a></span> | <span class="t">And we just write, I'm gonna put lines equals fp.read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=288" target="_blank">00:04:48.680</a></span> | <span class="t">And like I said, we're splitting that by newline characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=292" target="_blank">00:04:52.400</a></span> | <span class="t">So we just write that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=295" target="_blank">00:04:55.120</a></span> | <span class="t">Sorry, it's sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=300" target="_blank">00:05:00.880</a></span> | <span class="t">And we see a few of those as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=306" target="_blank">00:05:06.640</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=309" target="_blank">00:05:09.880</a></span> | <span class="t">Now, to convert from those sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=313" target="_blank">00:05:13.200</a></span> | <span class="t">into those sentence embeddings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=315" target="_blank">00:05:15.440</a></span> | <span class="t">I need to import this anyway for later on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=317" target="_blank">00:05:17.600</a></span> | <span class="t">when we're building our query vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=318" target="_blank">00:05:18.800</a></span> | <span class="t">I'll just show you how I do that now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=321" target="_blank">00:05:21.240</a></span> | <span class="t">All we do is from sentence transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=323" target="_blank">00:05:23.640</a></span> | <span class="t">which is the library we're using to create those embeddings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=327" target="_blank">00:05:27.480</a></span> | <span class="t">import sentence transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=336" target="_blank">00:05:36.720</a></span> | <span class="t">And then our model, we're using sentence transformer again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=340" target="_blank">00:05:40.040</a></span> | <span class="t">And we're using the BERT and BASE NLI mean tokens model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=345" target="_blank">00:05:45.040</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=347" target="_blank">00:05:47.920</a></span> | <span class="t">So that's how we initialize our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=351" target="_blank">00:05:51.160</a></span> | <span class="t">And then when we're encoding our text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=352" target="_blank">00:05:52.720</a></span> | <span class="t">we'll see in a moment, we just write model encode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=356" target="_blank">00:05:56.680</a></span> | <span class="t">and then we write something in here, hello world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=359" target="_blank">00:05:59.800</a></span> | <span class="t">Okay, and that will encode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=361" target="_blank">00:06:01.680</a></span> | <span class="t">that will give us a sentence embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=364" target="_blank">00:06:04.400</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=365" target="_blank">00:06:05.240</a></span> | <span class="t">So that is what we have inside here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=369" target="_blank">00:06:09.000</a></span> | <span class="t">We just have the sentence embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=370" target="_blank">00:06:10.720</a></span> | <span class="t">of all of our lines here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=372" target="_blank">00:06:12.440</a></span> | <span class="t">Now, I think we have everything we need to get started.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=379" target="_blank">00:06:19.400</a></span> | <span class="t">So let's build our first FICE index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=382" target="_blank">00:06:22.880</a></span> | <span class="t">So the first one we're gonna build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=386" target="_blank">00:06:26.760</a></span> | <span class="t">is called the index flat L2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=391" target="_blank">00:06:31.760</a></span> | <span class="t">And this is a flat index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=394" target="_blank">00:06:34.120</a></span> | <span class="t">which means that all the vectors are just flat vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=398" target="_blank">00:06:38.120</a></span> | <span class="t">We're not modifying them in any way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=400" target="_blank">00:06:40.320</a></span> | <span class="t">And the L2 stands for the distance metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=404" target="_blank">00:06:44.200</a></span> | <span class="t">that we're using to measure the similarity of each vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=409" target="_blank">00:06:49.200</a></span> | <span class="t">or the proximity of each vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=412" target="_blank">00:06:52.600</a></span> | <span class="t">And L2 is just Euclidean distance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=414" target="_blank">00:06:54.720</a></span> | <span class="t">So it's a pretty straightforward function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=419" target="_blank">00:06:59.720</a></span> | <span class="t">Now, to initialize that, we just write FICE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=423" target="_blank">00:07:03.520</a></span> | <span class="t">So we imported, no, so we need to import FICE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=427" target="_blank">00:07:07.120</a></span> | <span class="t">And then we write index equals FICE.index flat L2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=434" target="_blank">00:07:14.280</a></span> | <span class="t">And then in here, we need to pass the dimensionality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=437" target="_blank">00:07:17.560</a></span> | <span class="t">of our vectors or our sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=441" target="_blank">00:07:21.240</a></span> | <span class="t">Now, what is our dimensionality?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=443" target="_blank">00:07:23.400</a></span> | <span class="t">So each one is 768 values long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=448" target="_blank">00:07:28.920</a></span> | <span class="t">So if we'd like a nicer way of writing out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=453" target="_blank">00:07:33.920</a></span> | <span class="t">we put sentence embeddings and we write shape one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=459" target="_blank">00:07:39.720</a></span> | <span class="t">And our index requires that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=466" target="_blank">00:07:46.560</a></span> | <span class="t">in order to be properly initialized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=469" target="_blank">00:07:49.080</a></span> | <span class="t">So do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=470" target="_blank">00:07:50.280</a></span> | <span class="t">That will be initialized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=474" target="_blank">00:07:54.240</a></span> | <span class="t">Let me run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=475" target="_blank">00:07:55.640</a></span> | <span class="t">The, I think my notebook just restarted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=480" target="_blank">00:08:00.640</a></span> | <span class="t">It did restart, it's weird.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=484" target="_blank">00:08:04.920</a></span> | <span class="t">Okay, one minute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=485" target="_blank">00:08:05.800</a></span> | <span class="t">So that's going to initialize the index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=494" target="_blank">00:08:14.360</a></span> | <span class="t">And there is one thing that we need to be aware of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=496" target="_blank">00:08:16.800</a></span> | <span class="t">So sometimes with these indexes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=499" target="_blank">00:08:19.840</a></span> | <span class="t">we will need to train them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=502" target="_blank">00:08:22.920</a></span> | <span class="t">So if the index is going to do any clustering,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=506" target="_blank">00:08:26.040</a></span> | <span class="t">we will need to train that clustering algorithm on our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=509" target="_blank">00:08:29.520</a></span> | <span class="t">And now in this case, we can check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=512" target="_blank">00:08:32.520</a></span> | <span class="t">if an index needs training or is trained already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=516" target="_blank">00:08:36.000</a></span> | <span class="t">using the is trained attribute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=517" target="_blank">00:08:37.840</a></span> | <span class="t">And we'll see with this index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=521" target="_blank">00:08:41.720</a></span> | <span class="t">because it's just a flat L2 index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=525" target="_blank">00:08:45.600</a></span> | <span class="t">it's not doing anything special.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=527" target="_blank">00:08:47.960</a></span> | <span class="t">We'll see, because it's not doing anything special,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=532" target="_blank">00:08:52.040</a></span> | <span class="t">we don't need to train it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=532" target="_blank">00:08:52.920</a></span> | <span class="t">And we can see that when we write is trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=536" target="_blank">00:08:56.160</a></span> | <span class="t">it says it's already trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=537" target="_blank">00:08:57.440</a></span> | <span class="t">just means that we don't actually need to train it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=539" target="_blank">00:08:59.560</a></span> | <span class="t">So that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=541" target="_blank">00:09:01.320</a></span> | <span class="t">Now, how do we add our vectors, our sentence embeddings?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=547" target="_blank">00:09:07.640</a></span> | <span class="t">All we need to do is write index, add,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=549" target="_blank">00:09:09.960</a></span> | <span class="t">and then we just add embeddings like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=552" target="_blank">00:09:12.520</a></span> | <span class="t">So pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=554" target="_blank">00:09:14.760</a></span> | <span class="t">So add sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=558" target="_blank">00:09:18.840</a></span> | <span class="t">And then from there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=560" target="_blank">00:09:20.840</a></span> | <span class="t">we can check that they've been added properly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=564" target="_blank">00:09:24.280</a></span> | <span class="t">by looking at the end total value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=566" target="_blank">00:09:26.440</a></span> | <span class="t">So this is number of embeddings or vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=569" target="_blank">00:09:29.240</a></span> | <span class="t">that we have in our index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=571" target="_blank">00:09:31.080</a></span> | <span class="t">And with that, we can go ahead and start querying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=574" target="_blank">00:09:34.560</a></span> | <span class="t">So let's first create a query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=577" target="_blank">00:09:37.480</a></span> | <span class="t">So we'll do XQ, which is our query vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=582" target="_blank">00:09:42.000</a></span> | <span class="t">And we want to do the model and code that we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=585" target="_blank">00:09:45.320</a></span> | <span class="t">Now, I'm going to write someone sprints with a football.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=590" target="_blank">00:09:50.320</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=593" target="_blank">00:09:53.760</a></span> | <span class="t">That's going to be our query vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=597" target="_blank">00:09:57.600</a></span> | <span class="t">And to search, we do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=600" target="_blank">00:10:00.280</a></span> | <span class="t">So we write DI equals index, search, XQ.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=605" target="_blank">00:10:05.280</a></span> | <span class="t">And then in here, we need to add K as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=609" target="_blank">00:10:09.720</a></span> | <span class="t">So K, let me define it above here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=614" target="_blank">00:10:14.240</a></span> | <span class="t">So K is the number of items or vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=619" target="_blank">00:10:19.080</a></span> | <span class="t">similar vectors that we'd like to return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=620" target="_blank">00:10:20.800</a></span> | <span class="t">So I'm going to want to return four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=623" target="_blank">00:10:23.120</a></span> | <span class="t">So with here, with this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=625" target="_blank">00:10:25.720</a></span> | <span class="t">we will return four index IDs into this I variable here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=630" target="_blank">00:10:30.720</a></span> | <span class="t">I'm going to time it as well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=633" target="_blank">00:10:33.600</a></span> | <span class="t">just so you see how long it takes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=635" target="_blank">00:10:35.320</a></span> | <span class="t">And let's print I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=642" target="_blank">00:10:42.200</a></span> | <span class="t">You can see that we get these four items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=644" target="_blank">00:10:44.960</a></span> | <span class="t">Now, these align to our lines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=648" target="_blank">00:10:48.520</a></span> | <span class="t">So the text that we have up here, that will align.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=652" target="_blank">00:10:52.080</a></span> | <span class="t">So what we can do is we can print all of those out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=656" target="_blank">00:10:56.480</a></span> | <span class="t">So let's do I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=658" target="_blank">00:10:58.360</a></span> | <span class="t">And then in here, we want to write lines I for I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=665" target="_blank">00:11:05.120</a></span> | <span class="t">Sorry, let me end that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=671" target="_blank">00:11:11.440</a></span> | <span class="t">I for I in I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=675" target="_blank">00:11:15.840</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=677" target="_blank">00:11:17.560</a></span> | <span class="t">Ah, sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=682" target="_blank">00:11:22.560</a></span> | <span class="t">So this is zero here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=684" target="_blank">00:11:24.880</a></span> | <span class="t">Okay, so these are the sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=687" target="_blank">00:11:27.760</a></span> | <span class="t">or the similar sentences that we got back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=689" target="_blank">00:11:29.280</a></span> | <span class="t">And we see, obviously, it seems to be working pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=691" target="_blank">00:11:31.520</a></span> | <span class="t">All of them talking about football</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=693" target="_blank">00:11:33.320</a></span> | <span class="t">or being on a football field.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=696" target="_blank">00:11:36.160</a></span> | <span class="t">So that looks pretty good, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=700" target="_blank">00:11:40.240</a></span> | <span class="t">The only problem is that this takes a long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=702" target="_blank">00:11:42.720</a></span> | <span class="t">We don't have that many vectors in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=705" target="_blank">00:11:45.080</a></span> | <span class="t">And it took 57.4 milliseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=708" target="_blank">00:11:48.400</a></span> | <span class="t">So it's a little bit long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=711" target="_blank">00:11:51.520</a></span> | <span class="t">and something that we can actually improve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=715" target="_blank">00:11:55.320</a></span> | <span class="t">Okay, so before we move on to the next index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=720" target="_blank">00:12:00.560</a></span> | <span class="t">I just want to have a look at the sort of speed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=722" target="_blank">00:12:02.960</a></span> | <span class="t">that we would expect from this when we are,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=725" target="_blank">00:12:05.640</a></span> | <span class="t">this is a very small data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=726" target="_blank">00:12:06.880</a></span> | <span class="t">So what else could we expect?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=730" target="_blank">00:12:10.760</a></span> | <span class="t">So if we go over here, I've already written all this code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=734" target="_blank">00:12:14.640</a></span> | <span class="t">If you'd like to go through this notebook,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=736" target="_blank">00:12:16.560</a></span> | <span class="t">I'll leave a link in the description.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=738" target="_blank">00:12:18.480</a></span> | <span class="t">So come down here, we have this flat L2 index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=743" target="_blank">00:12:23.560</a></span> | <span class="t">and this is the query time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=745" target="_blank">00:12:25.120</a></span> | <span class="t">So this is for a randomly generated vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=748" target="_blank">00:12:28.400</a></span> | <span class="t">with a dimension size of 100.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=750" target="_blank">00:12:30.320</a></span> | <span class="t">And this is a number of vectors within that index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=755" target="_blank">00:12:35.320</a></span> | <span class="t">So we go up to 1 million here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=758" target="_blank">00:12:38.320</a></span> | <span class="t">And this is a query time in milliseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=760" target="_blank">00:12:40.880</a></span> | <span class="t">You can see, you know, it increases quite quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=764" target="_blank">00:12:44.560</a></span> | <span class="t">Now this is in FICE, but it's still an exhaustive search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=767" target="_blank">00:12:47.960</a></span> | <span class="t">We're not really optimizing how we could do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=772" target="_blank">00:12:52.040</a></span> | <span class="t">We're not using that approximate search capabilities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=775" target="_blank">00:12:55.240</a></span> | <span class="t">of FICE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=776" target="_blank">00:12:56.880</a></span> | <span class="t">So if we switch back over to FICE,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=780" target="_blank">00:13:00.280</a></span> | <span class="t">we can begin using that approximate search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=785" target="_blank">00:13:05.160</a></span> | <span class="t">by adding partitioning into our index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=789" target="_blank">00:13:09.440</a></span> | <span class="t">Now, the most popular of these uses a technique</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=793" target="_blank">00:13:13.280</a></span> | <span class="t">very similar to something called Voronoi cells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=797" target="_blank">00:13:17.520</a></span> | <span class="t">I'm not sure how you pronounce it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=798" target="_blank">00:13:18.720</a></span> | <span class="t">I think that's about right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=800" target="_blank">00:13:20.960</a></span> | <span class="t">And I can show you what that looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=805" target="_blank">00:13:25.600</a></span> | <span class="t">So over here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=807" target="_blank">00:13:27.160</a></span> | <span class="t">if we go here, we have all of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=812" target="_blank">00:13:32.680</a></span> | <span class="t">So this is called a Voronoi diagram.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=817" target="_blank">00:13:37.680</a></span> | <span class="t">And each of the sort of squares</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=821" target="_blank">00:13:41.800</a></span> | <span class="t">or the cells that you see are called Voronoi cells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=824" target="_blank">00:13:44.640</a></span> | <span class="t">So here we have Voronoi cells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=829" target="_blank">00:13:49.640</a></span> | <span class="t">And that is just what you see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=834" target="_blank">00:13:54.960</a></span> | <span class="t">So this, this, all of these kind of squares</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=839" target="_blank">00:13:59.680</a></span> | <span class="t">are each a cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=841" target="_blank">00:14:01.800</a></span> | <span class="t">Now, as well as those, we also have our centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=845" target="_blank">00:14:05.200</a></span> | <span class="t">So I'm just gonna write this out instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=847" target="_blank">00:14:07.680</a></span> | <span class="t">So centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=848" target="_blank">00:14:08.960</a></span> | <span class="t">And these are simply the centers of those cells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=853" target="_blank">00:14:13.320</a></span> | <span class="t">Now, when we introduce a new vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=857" target="_blank">00:14:17.880</a></span> | <span class="t">or our query vector into this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=861" target="_blank">00:14:21.360</a></span> | <span class="t">what we're doing is essentially,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=863" target="_blank">00:14:23.200</a></span> | <span class="t">so we have our query vector,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=865" target="_blank">00:14:25.040</a></span> | <span class="t">and let's say it appears here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=869" target="_blank">00:14:29.840</a></span> | <span class="t">Now, within each one of these cells,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=872" target="_blank">00:14:32.000</a></span> | <span class="t">we actually have a lot of other vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=875" target="_blank">00:14:35.160</a></span> | <span class="t">So we could have, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=876" target="_blank">00:14:36.880</a></span> | <span class="t">we could have millions in each cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=878" target="_blank">00:14:38.720</a></span> | <span class="t">So there's a lot in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=882" target="_blank">00:14:42.840</a></span> | <span class="t">And if we were to compare that query vector,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=885" target="_blank">00:14:45.520</a></span> | <span class="t">this thing here, to every single one of those vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=890" target="_blank">00:14:50.360</a></span> | <span class="t">it would obviously take a long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=892" target="_blank">00:14:52.160</a></span> | <span class="t">We're going through every single one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=894" target="_blank">00:14:54.160</a></span> | <span class="t">We don't want to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=895" target="_blank">00:14:55.320</a></span> | <span class="t">So what this approach allows us to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=898" target="_blank">00:14:58.440</a></span> | <span class="t">is instead of checking against every one of those vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=901" target="_blank">00:15:01.360</a></span> | <span class="t">we just check it against every centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=903" target="_blank">00:15:03.800</a></span> | <span class="t">And once we figure out which centroid is the closest,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=908" target="_blank">00:15:08.360</a></span> | <span class="t">we limit our search scope to only vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=914" target="_blank">00:15:14.000</a></span> | <span class="t">that are within that centroid Voronoi cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=918" target="_blank">00:15:18.560</a></span> | <span class="t">So in this case, it would probably be this centroid here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=923" target="_blank">00:15:23.000</a></span> | <span class="t">which is the closest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=924" target="_blank">00:15:24.480</a></span> | <span class="t">And then we would just limit our search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=927" target="_blank">00:15:27.280</a></span> | <span class="t">to only be within these boundaries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=931" target="_blank">00:15:31.400</a></span> | <span class="t">Now, what we might find is maybe there's,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=934" target="_blank">00:15:34.440</a></span> | <span class="t">the closest vector here is actually here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=937" target="_blank">00:15:37.360</a></span> | <span class="t">whereas the closest vector here is right there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=940" target="_blank">00:15:40.040</a></span> | <span class="t">So in reality, this vector here, this one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=943" target="_blank">00:15:43.640</a></span> | <span class="t">might actually be a better approximation or a better,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=949" target="_blank">00:15:49.680</a></span> | <span class="t">it might be more similar to our query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=953" target="_blank">00:15:53.480</a></span> | <span class="t">And that's why this is approximate search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=956" target="_blank">00:15:56.400</a></span> | <span class="t">not exhaustive search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=958" target="_blank">00:15:58.000</a></span> | <span class="t">because we might miss out on something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=962" target="_blank">00:16:02.040</a></span> | <span class="t">but that is kind of outweighed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=964" target="_blank">00:16:04.560</a></span> | <span class="t">by the fact that this is just a lot, a lot faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=968" target="_blank">00:16:08.800</a></span> | <span class="t">So it's sort of pros and cons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=971" target="_blank">00:16:11.040</a></span> | <span class="t">It's whatever is going to work best for your use case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=975" target="_blank">00:16:15.560</a></span> | <span class="t">Now, if we want to implement that in code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=979" target="_blank">00:16:19.600</a></span> | <span class="t">first thing that we want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=980" target="_blank">00:16:20.760</a></span> | <span class="t">is define how many of those cells we would like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=985" target="_blank">00:16:25.400</a></span> | <span class="t">So I'm going to go 50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=987" target="_blank">00:16:27.440</a></span> | <span class="t">So use this endless parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=989" target="_blank">00:16:29.680</a></span> | <span class="t">And then from there, we can set up our quantizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=993" target="_blank">00:16:33.000</a></span> | <span class="t">which is almost, it's like another step in the process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=997" target="_blank">00:16:37.400</a></span> | <span class="t">So with our index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1001" target="_blank">00:16:41.840</a></span> | <span class="t">we are still going to be measuring the L2 distance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1004" target="_blank">00:16:44.560</a></span> | <span class="t">So we still actually need that index in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1008" target="_blank">00:16:48.200</a></span> | <span class="t">So to do that, we need to write FICE index flat L2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1013" target="_blank">00:16:53.200</a></span> | <span class="t">and we pass out dimensions again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1018" target="_blank">00:16:58.560</a></span> | <span class="t">just like we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1019" target="_blank">00:16:59.760</a></span> | <span class="t">And like I said, that's just a step in the process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1024" target="_blank">00:17:04.120</a></span> | <span class="t">That's not our full index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1026" target="_blank">00:17:06.080</a></span> | <span class="t">Our full index is going to look like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1029" target="_blank">00:17:09.080</a></span> | <span class="t">So we write index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1031" target="_blank">00:17:11.000</a></span> | <span class="t">And in here, we're going to have our FICE,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1033" target="_blank">00:17:13.120</a></span> | <span class="t">and this is a new index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1034" target="_blank">00:17:14.640</a></span> | <span class="t">So this is the one that is creating those partitions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1036" target="_blank">00:17:16.920</a></span> | <span class="t">So we write index IVF flat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1041" target="_blank">00:17:21.920</a></span> | <span class="t">And in there, we need to pass our quantizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1048" target="_blank">00:17:28.080</a></span> | <span class="t">the dimensions, and also the end list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1055" target="_blank">00:17:35.440</a></span> | <span class="t">Okay, now, if you remember what I said before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1061" target="_blank">00:17:41.520</a></span> | <span class="t">we, in some cases, we'll need to train our index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1066" target="_blank">00:17:46.120</a></span> | <span class="t">Now, this is an example of one of those times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1069" target="_blank">00:17:49.520</a></span> | <span class="t">Because we're doing the clustering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1071" target="_blank">00:17:51.800</a></span> | <span class="t">and creating those foreign noise cells,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1074" target="_blank">00:17:54.640</a></span> | <span class="t">we do need to train it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1076" target="_blank">00:17:56.040</a></span> | <span class="t">And we can see that because this is false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1078" target="_blank">00:17:58.320</a></span> | <span class="t">Now, to train it, we need to just write index train,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1083" target="_blank">00:18:03.320</a></span> | <span class="t">and then in here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1089" target="_blank">00:18:09.360</a></span> | <span class="t">we want to pass all of our sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1092" target="_blank">00:18:12.960</a></span> | <span class="t">So sentence embeddings, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1097" target="_blank">00:18:17.960</a></span> | <span class="t">Let's run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1098" target="_blank">00:18:18.920</a></span> | <span class="t">It's very quick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1099" target="_blank">00:18:19.920</a></span> | <span class="t">And then we can write, it's trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1102" target="_blank">00:18:22.960</a></span> | <span class="t">And we see that's true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1103" target="_blank">00:18:23.800</a></span> | <span class="t">So now our index is essentially ready to receive our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1108" target="_blank">00:18:28.800</a></span> | <span class="t">So we do this exactly the same way as we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1115" target="_blank">00:18:35.320</a></span> | <span class="t">We write index add,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1117" target="_blank">00:18:37.280</a></span> | <span class="t">and we pass our sentence embeddings again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1121" target="_blank">00:18:41.560</a></span> | <span class="t">And we can check that everything is in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1123" target="_blank">00:18:43.320</a></span> | <span class="t">with index and total.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1126" target="_blank">00:18:46.000</a></span> | <span class="t">Okay, so now we see that we have our index, it's ready,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1129" target="_blank">00:18:49.600</a></span> | <span class="t">and we can begin querying it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1131" target="_blank">00:18:51.800</a></span> | <span class="t">So what I'm going to do is use the exact same query vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1136" target="_blank">00:18:56.800</a></span> | <span class="t">that we used before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1139" target="_blank">00:18:59.080</a></span> | <span class="t">Going to time it so that we can see how quick this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1142" target="_blank">00:19:02.600</a></span> | <span class="t">compared to our previous query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1144" target="_blank">00:19:04.680</a></span> | <span class="t">And we're actually going to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1148" target="_blank">00:19:08.720</a></span> | <span class="t">the exact same thing we wrote before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1150" target="_blank">00:19:10.640</a></span> | <span class="t">So can I actually just copy it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1154" target="_blank">00:19:14.480</a></span> | <span class="t">So I'll take that, bring it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1164" target="_blank">00:19:24.080</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1166" target="_blank">00:19:26.120</a></span> | <span class="t">So now let's have a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1167" target="_blank">00:19:27.920</a></span> | <span class="t">So total 7.22.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1170" target="_blank">00:19:30.600</a></span> | <span class="t">So bring it up here, and we have 57.4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1173" target="_blank">00:19:33.760</a></span> | <span class="t">Now this is maybe a little bit slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1176" target="_blank">00:19:36.960</a></span> | <span class="t">So we'll see that the times do vary a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1181" target="_blank">00:19:41.920</a></span> | <span class="t">quite randomly, but maybe that's a little bit slow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1186" target="_blank">00:19:46.920</a></span> | <span class="t">but it's probably pretty realistic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1189" target="_blank">00:19:49.640</a></span> | <span class="t">So that took 57 milliseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1194" target="_blank">00:19:54.320</a></span> | <span class="t">This one, seven.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1196" target="_blank">00:19:56.640</a></span> | <span class="t">Now let's have a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1197" target="_blank">00:19:57.520</a></span> | <span class="t">So these are the indexes we've got.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1199" target="_blank">00:19:59.320</a></span> | <span class="t">Let's compare them to what we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1202" target="_blank">00:20:02.720</a></span> | <span class="t">And I believe they're all the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1206" target="_blank">00:20:06.080</a></span> | <span class="t">So we've just shortened the time by a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1210" target="_blank">00:20:10.360</a></span> | <span class="t">and we're getting the exact same results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1213" target="_blank">00:20:13.240</a></span> | <span class="t">So that's pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1214" target="_blank">00:20:14.200</a></span> | <span class="t">Now, sometimes we will find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1217" target="_blank">00:20:17.240</a></span> | <span class="t">that we do get different results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1218" target="_blank">00:20:18.320</a></span> | <span class="t">And a lot of the time that's fine,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1220" target="_blank">00:20:20.520</a></span> | <span class="t">but maybe if you find the results are not that great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1225" target="_blank">00:20:25.520</a></span> | <span class="t">when you add this sort of index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1227" target="_blank">00:20:27.760</a></span> | <span class="t">then that just means that this search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1230" target="_blank">00:20:30.240</a></span> | <span class="t">is not exhaustive enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1232" target="_blank">00:20:32.680</a></span> | <span class="t">Like we are using approximate search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1234" target="_blank">00:20:34.200</a></span> | <span class="t">but maybe we should approximate a little bit less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1236" target="_blank">00:20:36.760</a></span> | <span class="t">and be slightly more exhaustive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1239" target="_blank">00:20:39.120</a></span> | <span class="t">And we can do that by setting the nProbe value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1243" target="_blank">00:20:43.400</a></span> | <span class="t">So nProbe, let's explain in a minute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1248" target="_blank">00:20:48.400</a></span> | <span class="t">So let me actually first just run this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1252" target="_blank">00:20:52.400</a></span> | <span class="t">and we can see it will probably take slightly longer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1256" target="_blank">00:20:56.840</a></span> | <span class="t">So yeah, we get 15 milliseconds here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1259" target="_blank">00:20:59.840</a></span> | <span class="t">Of course, we get the same results again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1262" target="_blank">00:21:02.680</a></span> | <span class="t">'cause there were no accuracy issues here anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1266" target="_blank">00:21:06.320</a></span> | <span class="t">But let me just explain what that is actually doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1270" target="_blank">00:21:10.680</a></span> | <span class="t">So in this case here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1273" target="_blank">00:21:13.200</a></span> | <span class="t">what you can see is a IVF search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1278" target="_blank">00:21:18.160</a></span> | <span class="t">where we are using an nProbe value of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1281" target="_blank">00:21:21.720</a></span> | <span class="t">So we're just searching one cell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1286" target="_blank">00:21:26.320</a></span> | <span class="t">based on the first nearest centroid to our query vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1290" target="_blank">00:21:30.560</a></span> | <span class="t">Now, if we increase this up to eight,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1293" target="_blank">00:21:33.920</a></span> | <span class="t">or let's use a smaller number in this example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1297" target="_blank">00:21:37.720</a></span> | <span class="t">So maybe we increase it to four,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1301" target="_blank">00:21:41.200</a></span> | <span class="t">our four nearest centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1304" target="_blank">00:21:44.400</a></span> | <span class="t">So I would say probably these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1308" target="_blank">00:21:48.280</a></span> | <span class="t">this one, this one, this one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1312" target="_blank">00:21:52.680</a></span> | <span class="t">and the one we've already highlighted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1314" target="_blank">00:21:54.560</a></span> | <span class="t">All of those would now be in scope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1318" target="_blank">00:21:58.840</a></span> | <span class="t">because our nProbe value,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1320" target="_blank">00:22:00.200</a></span> | <span class="t">so the number of cells that we are going to search is four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1324" target="_blank">00:22:04.000</a></span> | <span class="t">Now, if we increase it again to say six,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1327" target="_blank">00:22:07.960</a></span> | <span class="t">these two cells might also be included.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1330" target="_blank">00:22:10.440</a></span> | <span class="t">Now, of course, when we do that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1332" target="_blank">00:22:12.960</a></span> | <span class="t">we are searching more,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1334" target="_blank">00:22:14.800</a></span> | <span class="t">so we might get a better performance, better accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1338" target="_blank">00:22:18.840</a></span> | <span class="t">But in terms of performance in time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1343" target="_blank">00:22:23.320</a></span> | <span class="t">it's also not, it's also going to increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1347" target="_blank">00:22:27.200</a></span> | <span class="t">and we don't want time to increase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1350" target="_blank">00:22:30.920</a></span> | <span class="t">So there's a trade-off between those two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1354" target="_blank">00:22:34.080</a></span> | <span class="t">In our case, we don't really need to increase this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1356" target="_blank">00:22:36.520</a></span> | <span class="t">so don't really need to worry about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1361" target="_blank">00:22:41.280</a></span> | <span class="t">So that is the index IVF.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1367" target="_blank">00:22:47.680</a></span> | <span class="t">And we have one more that I want to look at,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1373" target="_blank">00:22:53.360</a></span> | <span class="t">and that is the product quantization index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1377" target="_blank">00:22:57.640</a></span> | <span class="t">So this is actually, so we use IVF,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1382" target="_blank">00:23:02.640</a></span> | <span class="t">and then we also use product quantization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1385" target="_blank">00:23:05.640</a></span> | <span class="t">So it's probably better if I try and draw this out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1390" target="_blank">00:23:10.640</a></span> | <span class="t">So when we use product quantization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1395" target="_blank">00:23:15.880</a></span> | <span class="t">imagine we have one vector here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1399" target="_blank">00:23:19.080</a></span> | <span class="t">So this is our vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1401" target="_blank">00:23:21.960</a></span> | <span class="t">Now, the first step in product quantization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1405" target="_blank">00:23:25.360</a></span> | <span class="t">is to split this into sub-vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1408" target="_blank">00:23:28.440</a></span> | <span class="t">So we split this into several and then we take them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1412" target="_blank">00:23:32.120</a></span> | <span class="t">We pull these out and they are now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1416" target="_blank">00:23:36.160</a></span> | <span class="t">their own sort of mini-vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1418" target="_blank">00:23:38.640</a></span> | <span class="t">And this is just one vector that I'm visualizing here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1423" target="_blank">00:23:43.640</a></span> | <span class="t">but we would obviously do this with many, many vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1428" target="_blank">00:23:48.000</a></span> | <span class="t">So there would be many, many more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1431" target="_blank">00:23:51.360</a></span> | <span class="t">So in our case, that's just under 15,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1436" target="_blank">00:23:56.360</a></span> | <span class="t">Now, that means that we have a lot of these sub-vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1441" target="_blank">00:24:01.400</a></span> | <span class="t">And what we do with these is we run them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1450" target="_blank">00:24:10.520</a></span> | <span class="t">through their own clustering algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1452" target="_blank">00:24:12.880</a></span> | <span class="t">So what we do is we end up getting clusters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1456" target="_blank">00:24:16.400</a></span> | <span class="t">and each of those clusters is going to have a centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1461" target="_blank">00:24:21.400</a></span> | <span class="t">So this one would also be run through one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1463" target="_blank">00:24:23.600</a></span> | <span class="t">So each subset of vector slices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1467" target="_blank">00:24:27.840</a></span> | <span class="t">is going to be run through its own clustering algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1472" target="_blank">00:24:32.840</a></span> | <span class="t">creating these centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1475" target="_blank">00:24:35.080</a></span> | <span class="t">And these centroids are smaller in size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1478" target="_blank">00:24:38.920</a></span> | <span class="t">than the original sub-vectors here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1482" target="_blank">00:24:42.200</a></span> | <span class="t">And what we do is for each of these sub-vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1487" target="_blank">00:24:47.200</a></span> | <span class="t">so each of these sub-vectors, they get pulled into here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1492" target="_blank">00:24:52.160</a></span> | <span class="t">So maybe this one is here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1495" target="_blank">00:24:55.200</a></span> | <span class="t">and it gets assigned to its nearest centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1498" target="_blank">00:24:58.560</a></span> | <span class="t">And then we take that assignment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1502" target="_blank">00:25:02.660</a></span> | <span class="t">all the way back over here and add it into our vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1507" target="_blank">00:25:07.660</a></span> | <span class="t">So this is centroid three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1512" target="_blank">00:25:12.480</a></span> | <span class="t">For example, and when I say assign it back,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1517" target="_blank">00:25:17.160</a></span> | <span class="t">it's probably the wrong way to think about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1519" target="_blank">00:25:19.920</a></span> | <span class="t">Maybe it's more like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1522" target="_blank">00:25:22.200</a></span> | <span class="t">So it becomes a new vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1525" target="_blank">00:25:25.400</a></span> | <span class="t">built from those centroid IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1531" target="_blank">00:25:31.800</a></span> | <span class="t">Okay, so this would be three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1534" target="_blank">00:25:34.120</a></span> | <span class="t">Now, what that does is essentially reduces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1538" target="_blank">00:25:38.320</a></span> | <span class="t">the size of our vectors, but pretty significantly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1543" target="_blank">00:25:43.260</a></span> | <span class="t">depending on what dimensions we use there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1547" target="_blank">00:25:47.220</a></span> | <span class="t">So, so you're back to the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1552" target="_blank">00:25:52.360</a></span> | <span class="t">Let's implement that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1553" target="_blank">00:25:53.460</a></span> | <span class="t">Now we need to define two new variables here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1558" target="_blank">00:25:58.440</a></span> | <span class="t">So M, which is going to be the number of centroids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1562" target="_blank">00:26:02.000</a></span> | <span class="t">in the final vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1564" target="_blank">00:26:04.000</a></span> | <span class="t">So now one thing that we do need to know with M</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1568" target="_blank">00:26:08.640</a></span> | <span class="t">is that M must be,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1572" target="_blank">00:26:12.240</a></span> | <span class="t">we must be able to multiply M into D.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1575" target="_blank">00:26:15.320</a></span> | <span class="t">So what is our D value?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1577" target="_blank">00:26:17.880</a></span> | <span class="t">It's 100, I can't remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1580" target="_blank">00:26:20.580</a></span> | <span class="t">Where are we?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1583" target="_blank">00:26:23.420</a></span> | <span class="t">Let me check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1585" target="_blank">00:26:25.440</a></span> | <span class="t">So 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1590" target="_blank">00:26:30.040</a></span> | <span class="t">Now we should be able to divide that into eight, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1593" target="_blank">00:26:33.920</a></span> | <span class="t">Yeah, so this is good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1596" target="_blank">00:26:36.800</a></span> | <span class="t">We can use eight for M,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1598" target="_blank">00:26:38.600</a></span> | <span class="t">but we couldn't use something like five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1600" target="_blank">00:26:40.720</a></span> | <span class="t">because if we do five, we see that D doesn't fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1605" target="_blank">00:26:45.480</a></span> | <span class="t">So five doesn't fit nicely into D, whereas eight does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1610" target="_blank">00:26:50.180</a></span> | <span class="t">So M or D must be a multiple of M.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1615" target="_blank">00:26:55.180</a></span> | <span class="t">Otherwise we're going to get an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1619" target="_blank">00:26:59.640</a></span> | <span class="t">And that's because of the way that those vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1624" target="_blank">00:27:04.440</a></span> | <span class="t">are broken down into the final centroid ID vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1629" target="_blank">00:27:09.440</a></span> | <span class="t">And we also need to specify the number of bits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1633" target="_blank">00:27:13.220</a></span> | <span class="t">within each of those centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1635" target="_blank">00:27:15.320</a></span> | <span class="t">So this value, we can use what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1637" target="_blank">00:27:17.800</a></span> | <span class="t">I'm going to use eight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1639" target="_blank">00:27:19.680</a></span> | <span class="t">And then we can set up our index and also the quantizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1644" target="_blank">00:27:24.160</a></span> | <span class="t">So we use a quantizer as we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1646" target="_blank">00:27:26.640</a></span> | <span class="t">So the quantizer is going to be FICE.index Flat L2 D.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1651" target="_blank">00:27:31.640</a></span> | <span class="t">And also our index here is going to be,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1660" target="_blank">00:27:40.640</a></span> | <span class="t">so this is a new one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1662" target="_blank">00:27:42.600</a></span> | <span class="t">This is index IVFPQ.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1665" target="_blank">00:27:45.160</a></span> | <span class="t">So it's not a flat vector anymore, which is the full vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1669" target="_blank">00:27:49.240</a></span> | <span class="t">It's a quantized vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1672" target="_blank">00:27:52.080</a></span> | <span class="t">So where we have reduced the size of it through this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1677" target="_blank">00:27:57.080</a></span> | <span class="t">through the method I explained before, where we drew out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1680" target="_blank">00:28:00.800</a></span> | <span class="t">Now we need to pass a few arguments into here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1687" target="_blank">00:28:07.200</a></span> | <span class="t">First one is the quantizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1690" target="_blank">00:28:10.960</a></span> | <span class="t">So the quantizer D, which is our own dimensionality,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1695" target="_blank">00:28:15.920</a></span> | <span class="t">and list M and bits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1700" target="_blank">00:28:20.840</a></span> | <span class="t">So pass all of those to our index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1703" target="_blank">00:28:23.760</a></span> | <span class="t">Sorry, we need to put FICE there as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1708" target="_blank">00:28:28.080</a></span> | <span class="t">And there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1711" target="_blank">00:28:31.720</a></span> | <span class="t">So we now have our index again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1714" target="_blank">00:28:34.400</a></span> | <span class="t">You may have guessed that we might need to train this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1717" target="_blank">00:28:37.680</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1720" target="_blank">00:28:40.840</a></span> | <span class="t">So to train it, we'll just write index.train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1724" target="_blank">00:28:44.400</a></span> | <span class="t">That's our sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1729" target="_blank">00:28:49.440</a></span> | <span class="t">Okay, so it might take a little bit longer this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1732" target="_blank">00:28:52.480</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1733" target="_blank">00:28:53.360</a></span> | <span class="t">And then we can add our vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1735" target="_blank">00:28:55.360</a></span> | <span class="t">Now, after adding those,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1737" target="_blank">00:28:57.920</a></span> | <span class="t">let's see how quick this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1740" target="_blank">00:29:00.520</a></span> | <span class="t">Should be a lot quicker, or a fair bit quicker.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1743" target="_blank">00:29:03.040</a></span> | <span class="t">It's hard to get much quicker than the last one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1745" target="_blank">00:29:05.480</a></span> | <span class="t">So we're going to use the same code as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1748" target="_blank">00:29:08.120</a></span> | <span class="t">So I'm going to take this right down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1752" target="_blank">00:29:12.880</a></span> | <span class="t">See, 2.86.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1755" target="_blank">00:29:15.040</a></span> | <span class="t">So we've gotten a lot faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1758" target="_blank">00:29:18.320</a></span> | <span class="t">So we've gone from, what's up here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1761" target="_blank">00:29:21.960</a></span> | <span class="t">57 milliseconds down to two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1765" target="_blank">00:29:25.960</a></span> | <span class="t">Now, there is one thing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1769" target="_blank">00:29:29.720</a></span> | <span class="t">These values are now different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1772" target="_blank">00:29:32.280</a></span> | <span class="t">So the accuracy has decreased.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1777" target="_blank">00:29:37.480</a></span> | <span class="t">So if we, where is the last one here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1779" target="_blank">00:29:39.680</a></span> | <span class="t">So you can see that we are getting,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1784" target="_blank">00:29:44.560</a></span> | <span class="t">so we have the 190, we still have that one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1787" target="_blank">00:29:47.160</a></span> | <span class="t">and we have the 12.465,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1788" target="_blank">00:29:48.960</a></span> | <span class="t">but these two at the front are now different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1791" target="_blank">00:29:51.640</a></span> | <span class="t">And this is just, it's one of the trade-offs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1794" target="_blank">00:29:54.480</a></span> | <span class="t">of accuracy versus speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1797" target="_blank">00:29:57.400</a></span> | <span class="t">So if we come down here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1800" target="_blank">00:30:00.400</a></span> | <span class="t">let's give that a go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1802" target="_blank">00:30:02.640</a></span> | <span class="t">Let's have a look at what we are pulling through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1806" target="_blank">00:30:06.240</a></span> | <span class="t">So I'll copy this again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1808" target="_blank">00:30:08.160</a></span> | <span class="t">Let's just see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1812" target="_blank">00:30:12.320</a></span> | <span class="t">So we have these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1814" target="_blank">00:30:14.240</a></span> | <span class="t">I mean, although the accuracy has decreased technically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1819" target="_blank">00:30:19.000</a></span> | <span class="t">because it's not getting the same results</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1820" target="_blank">00:30:20.560</a></span> | <span class="t">as the exhaustive search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1822" target="_blank">00:30:22.160</a></span> | <span class="t">they're still pretty good results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1823" target="_blank">00:30:23.840</a></span> | <span class="t">So I mean, nonetheless, I think that is pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1828" target="_blank">00:30:28.240</a></span> | <span class="t">So let's have a look at,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1831" target="_blank">00:30:31.880</a></span> | <span class="t">let's compare this to our previous two other methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1836" target="_blank">00:30:36.880</a></span> | <span class="t">in terms of, as we did before, the graphs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1840" target="_blank">00:30:40.600</a></span> | <span class="t">So here is that final one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1842" target="_blank">00:30:42.680</a></span> | <span class="t">So we have IVF PQ along the bottom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1845" target="_blank">00:30:45.280</a></span> | <span class="t">Yeah, it's a lot faster, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1848" target="_blank">00:30:48.200</a></span> | <span class="t">And then we have IVF flat with a end period value of 10,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1854" target="_blank">00:30:54.320</a></span> | <span class="t">much faster than L2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1856" target="_blank">00:30:56.320</a></span> | <span class="t">but still not quite as fast as PQ.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1861" target="_blank">00:31:01.280</a></span> | <span class="t">And then we have flat L2 at the top, which obviously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1864" target="_blank">00:31:04.120</a></span> | <span class="t">And just as well, just be aware,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1866" target="_blank">00:31:06.440</a></span> | <span class="t">on the left here, we have a large scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1868" target="_blank">00:31:08.960</a></span> | <span class="t">So the differences are pretty significant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1871" target="_blank">00:31:11.800</a></span> | <span class="t">when we go to the 1 million mark.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1873" target="_blank">00:31:13.960</a></span> | <span class="t">So I think that's it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1879" target="_blank">00:31:19.920</a></span> | <span class="t">So I think obviously Pfizer's is pretty cool,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1884" target="_blank">00:31:24.280</a></span> | <span class="t">definitely really useful,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1885" target="_blank">00:31:25.320</a></span> | <span class="t">and I think we're definitely going to explore it more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1888" target="_blank">00:31:28.800</a></span> | <span class="t">in the future.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1889" target="_blank">00:31:29.920</a></span> | <span class="t">So for now, that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1893" target="_blank">00:31:33.400</a></span> | <span class="t">So thank you for watching,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=sKyvsdEv6rk&t=1894" target="_blank">00:31:34.520</a></span> | <span class="t">and I'll see you in the next one.</span></div></div></body></html>