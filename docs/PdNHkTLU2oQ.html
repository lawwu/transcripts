<html><head><title>Lesson 20: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 20: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ"><img src="https://i.ytimg.com/vi/PdNHkTLU2oQ/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=0">0:0</a> noisify inside a collation function<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=176">2:56</a> MixedPrecision callback<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=359">5:59</a> Getting the benefits from MixedPrecision<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=447">7:27</a> HuggingFace Accelerator<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=837">13:57</a> Sneaky trick: keep GPUs busy with MultDL<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1013">16:53</a> Homework and experiment ideas<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1233">20:33</a> Style Transfer notebook<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1459">24:19</a> Optimizing an image<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1807">30:7</a> Loss function and Learner<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1953">32:33</a> Viewing progress: ImageLogCB<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2104">35:4</a> Extracting features from a pre-trained network, VGG16<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2436">40:36</a> Normalizing the image<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2661">44:21</a> Intermediate representations, features<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2781">46:21</a> Hooks homework<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2840">47:20</a> Optimizing an image with Content Loss<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3365">56:5</a> Style Loss with Gram Matrix<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3561">59:21</a> “A Neural Algorithm of Artistic Style” paper<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3959">65:59</a> Optimizing to get the final result<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4062">67:42</a> Possible experiments and miniai<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4466">74:26</a> Neural Cellular Automata (NCA) notebook<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4777">79:37</a> Alexander Mordvintsev’s NCA simulation<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4904">81:44</a> Setting up a Neural Network<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5236">87:16</a> Getting into code<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5871">97:51</a> Training<br><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6170">102:50</a> Preview of what’s possible<br><br><div style="text-align: left;"><a href="./PdNHkTLU2oQ.html">Whisper Transcript</a> | <a href="./transcript_PdNHkTLU2oQ.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi and welcome to lesson 20. In the last lesson we were about to learn about implementing mixed precision training. Let's dive into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=10" target="_blank">00:00:10.000</a></span> | <span class="t">And I'm going to fiddle with other things just because I want to really experiment. I just love fiddling around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=17" target="_blank">00:00:17.000</a></span> | <span class="t">So one thing I wanted to do is I wanted to get rid of the DDPMCB entirely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=26" target="_blank">00:00:26.000</a></span> | <span class="t">We made it pretty small here, but I wanted to remove it. So much as Janice said, isn't it great the callbacks make everything so cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=34" target="_blank">00:00:34.000</a></span> | <span class="t">I wanted to show we can actually make things so cool without callbacks at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=38" target="_blank">00:00:38.000</a></span> | <span class="t">And so to do that, I realized what we could do is we could put noisify inside a collation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=46" target="_blank">00:00:46.000</a></span> | <span class="t">So the collation function, if you remember back to our datasets notebook, which was going back to notebook five and you've probably forgotten that by now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=57" target="_blank">00:00:57.000</a></span> | <span class="t">So go and reread that to remind yourself. It's the function that runs to take all of the, you know, you've basically each kind of row of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=70" target="_blank">00:01:10.000</a></span> | <span class="t">It will be a separate tuple, but then it hits the collation function and the collation function turns that into tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=77" target="_blank">00:01:17.000</a></span> | <span class="t">You know, one tensor representing the independent variable, one tensor representing the dependent variable, something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=84" target="_blank">00:01:24.000</a></span> | <span class="t">And the default collation function is called, not surprisingly, default collate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=88" target="_blank">00:01:28.000</a></span> | <span class="t">So if our collation function calls that on our batch and then grabs the X part, which is it's always been the same for the last few things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=99" target="_blank">00:01:39.000</a></span> | <span class="t">That's the image because we use because datasets uses dictionaries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=102" target="_blank">00:01:42.000</a></span> | <span class="t">So we're going to grab the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=104" target="_blank">00:01:44.000</a></span> | <span class="t">Then we can call noisify on that collated batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=112" target="_blank">00:01:52.000</a></span> | <span class="t">Then that's exactly the same thing as Tunis before batch did because before batch is operating on the thing that came out of the default collect function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=121" target="_blank">00:02:01.000</a></span> | <span class="t">So we could just do it in a click function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=123" target="_blank">00:02:03.000</a></span> | <span class="t">So if we do it here and then we create a DDPM data loader function, which just creates a data loader from some dataset that we pass in with some batch size with that collation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=139" target="_blank">00:02:19.000</a></span> | <span class="t">Then we can create our DL's not using data loaders from data loaders from DD. But instead of that, the original, you know, the plane in it that we created for data loaders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=155" target="_blank">00:02:35.000</a></span> | <span class="t">And again, you should go back and remind yourself of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=157" target="_blank">00:02:37.000</a></span> | <span class="t">You just pass in the data loaders for training and test.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=160" target="_blank">00:02:40.000</a></span> | <span class="t">So there's our two data loaders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=163" target="_blank">00:02:43.000</a></span> | <span class="t">So with that, we don't need a DDPM callback anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=168" target="_blank">00:02:48.000</a></span> | <span class="t">All right. So now that we've, you know, and again, this is this is not required for mixed precision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=172" target="_blank">00:02:52.000</a></span> | <span class="t">This is just because I wanted to experiment and flex our muscles a little bit of trying things out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=178" target="_blank">00:02:58.000</a></span> | <span class="t">So here's our mixed precision callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=181" target="_blank">00:03:01.000</a></span> | <span class="t">And this is a training callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=183" target="_blank">00:03:03.000</a></span> | <span class="t">And basically, if you Google for PyTorch mixed precision, you'll see that the docs show the typical mixed precision basically says with autocast, device equals CUDA, type equals float 16, get your predictions and core your loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=210" target="_blank">00:03:30.000</a></span> | <span class="t">So, again, remind yourself if you've forgotten that this is called a context manager and context managers when they start call something called done to enter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=220" target="_blank">00:03:40.000</a></span> | <span class="t">And when they finish, they call something called done to exit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=223" target="_blank">00:03:43.000</a></span> | <span class="t">So we could therefore put the torch autocast into an attribute and call done to enter before the batch begins.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=235" target="_blank">00:03:55.000</a></span> | <span class="t">And then after we've calculated the loss, we want to finish that context manager.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=243" target="_blank">00:04:03.000</a></span> | <span class="t">So after loss, we call autocast done to exit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=248" target="_blank">00:04:08.000</a></span> | <span class="t">And so I had to add this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=250" target="_blank">00:04:10.000</a></span> | <span class="t">So you'll find now in the 09 learner that there's a section called updated version since the lesson where I've added an after predict, an after loss, an after backward and an after step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=272" target="_blank">00:04:32.000</a></span> | <span class="t">And that means that a callback can now insert code at any point of the training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=279" target="_blank">00:04:39.000</a></span> | <span class="t">And so we haven't used all of those different things here, but we certainly do want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=286" target="_blank">00:04:46.000</a></span> | <span class="t">Yeah, after loss, it better do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=290" target="_blank">00:04:50.000</a></span> | <span class="t">And then, yeah, this is just code that has to be run according to it, to the PyTorch docs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=299" target="_blank">00:04:59.000</a></span> | <span class="t">So instead of calling lost dot backwards, you have to call scalar dot scale, lost dot backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=304" target="_blank">00:05:04.000</a></span> | <span class="t">So we replace our backward in the train callback with something called scalar dot scale, lost dot backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=311" target="_blank">00:05:11.000</a></span> | <span class="t">And then it says that finally, when you do the step, you don't call optimizer dot step, you call scalar dot step optimizer scalar dot update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=320" target="_blank">00:05:20.000</a></span> | <span class="t">So we've replaced step with scalar dot step scalar dot update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=326" target="_blank">00:05:26.000</a></span> | <span class="t">So that does all of the things in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=329" target="_blank">00:05:29.000</a></span> | <span class="t">And the nice thing is now that this exists, we don't have to think about any of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=334" target="_blank">00:05:34.000</a></span> | <span class="t">We can add mixed precision to anything, which is really nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=341" target="_blank">00:05:41.000</a></span> | <span class="t">And so we now, as you'll see, CB is no longer has a DDPM CB, but we do have the mixed precision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=351" target="_blank">00:05:51.000</a></span> | <span class="t">And that's a train callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=352" target="_blank">00:05:52.000</a></span> | <span class="t">So we just need a normal learner, not a train learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=355" target="_blank">00:05:55.000</a></span> | <span class="t">And we initialize our DDPM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=357" target="_blank">00:05:57.000</a></span> | <span class="t">Now, to get benefit from mixed precision, you need to do quite a bit at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=363" target="_blank">00:06:03.000</a></span> | <span class="t">You know, your GPU needs to be busy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=367" target="_blank">00:06:07.000</a></span> | <span class="t">And on something as small as fashion MNIST, it's not easy to keep a GPU busy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=371" target="_blank">00:06:11.000</a></span> | <span class="t">So that's why I've increased the batch size by four times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=376" target="_blank">00:06:16.000</a></span> | <span class="t">Now, that means that each epoch, it's going to have four times less batches because they're bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=384" target="_blank">00:06:24.000</a></span> | <span class="t">That means it's got four times less opportunities to update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=387" target="_blank">00:06:27.000</a></span> | <span class="t">And that's going to be a problem because if I want to have as good a result as to niche CAD and as I had here in less time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=395" target="_blank">00:06:35.000</a></span> | <span class="t">that's the whole purpose of this is to do it in less time, then I'm going to need to, you know, increase the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=405" target="_blank">00:06:45.000</a></span> | <span class="t">and maybe also increase the epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=407" target="_blank">00:06:47.000</a></span> | <span class="t">So I increase the epochs up to eight from five and I increase the learning rate up to one in egg two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=414" target="_blank">00:06:54.000</a></span> | <span class="t">And yeah, I've found I could train it fine with that once I use the proper initialization and most importantly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=422" target="_blank">00:07:02.000</a></span> | <span class="t">use the optimization function that has epsilon of one in egg five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=427" target="_blank">00:07:07.000</a></span> | <span class="t">And so this trains, even though it's doing more epochs, this trains about twice as fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=436" target="_blank">00:07:16.000</a></span> | <span class="t">And gets the same result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=442" target="_blank">00:07:22.000</a></span> | <span class="t">Does that make sense so far?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=445" target="_blank">00:07:25.000</a></span> | <span class="t">Yeah, it was great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=446" target="_blank">00:07:26.000</a></span> | <span class="t">Cool. Now, the good news is actually we don't even need to write all this because there's a nice library from Hugging Face,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=457" target="_blank">00:07:37.000</a></span> | <span class="t">originally created by Silver, who used to work with me at FastAI and went to Hugging Face and kept on doing awesome work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=464" target="_blank">00:07:44.000</a></span> | <span class="t">And he started this project called Accelerator, which he now works on with another FastAI alum named Zach Riele,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=471" target="_blank">00:07:51.000</a></span> | <span class="t">and accelerates a library that provides this in-court accelerator that does things to accelerate your training loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=478" target="_blank">00:07:58.000</a></span> | <span class="t">And one of the things it does is mix precision training and it basically handles these things for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=486" target="_blank">00:08:06.000</a></span> | <span class="t">It also lets you train on multiple GPUs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=488" target="_blank">00:08:08.000</a></span> | <span class="t">It also lets you train on TPUs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=491" target="_blank">00:08:11.000</a></span> | <span class="t">So by adding a train_cb subclass that will allow us to use Accelerate,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=497" target="_blank">00:08:17.000</a></span> | <span class="t">that means we can now hopefully use TPUs and multi-GPU training and all that kind of thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=504" target="_blank">00:08:24.000</a></span> | <span class="t">So the Accelerate docs show that what you have to do to use Accelerate is to create an accelerator,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=515" target="_blank">00:08:35.000</a></span> | <span class="t">tell it what kind of mixed precision you want to use. So we're going to use 16-bit floating point FP16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=523" target="_blank">00:08:43.000</a></span> | <span class="t">And then you have to basically call Accelerator.Prepare and you pass in your model, your optimizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=533" target="_blank">00:08:53.000</a></span> | <span class="t">and your training and validation data loaders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=536" target="_blank">00:08:56.000</a></span> | <span class="t">And it returns you back a model, an optimizer, and training and validation data loaders,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=541" target="_blank">00:09:01.000</a></span> | <span class="t">but they've been wrapped up in Accelerate. And Accelerate is going to now do all the things we saw you have to do automatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=551" target="_blank">00:09:11.000</a></span> | <span class="t">And that's why that's almost all the code we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=554" target="_blank">00:09:14.000</a></span> | <span class="t">The only other thing we need is we didn't tell it how to change our loss function to use Accelerate,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=561" target="_blank">00:09:21.000</a></span> | <span class="t">so we actually have to change backward. That's why we inherit from train_cb.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=565" target="_blank">00:09:25.000</a></span> | <span class="t">We have to change backward to not call loss.backward, but self.accelerate.backward and pass in loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=574" target="_blank">00:09:34.000</a></span> | <span class="t">OK. And then I had another idea of something I wanted to do, which is I like the idea that Noisify,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=581" target="_blank">00:09:41.000</a></span> | <span class="t">I've copied Noisify here, but rather than returning a tuple of tuples, I just return a tuple with three things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=589" target="_blank">00:09:49.000</a></span> | <span class="t">I think this is neater to me. I would like to just have three things in the tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=594" target="_blank">00:09:54.000</a></span> | <span class="t">I don't want to have to modify my model. I don't want to have to modify my training callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=600" target="_blank">00:10:00.000</a></span> | <span class="t">I don't want to do anything tricky. I don't even want to have a custom collation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=612" target="_blank">00:10:12.000</a></span> | <span class="t">Sorry, I want to have a custom collation function, but I don't want to have a modified model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=616" target="_blank">00:10:16.000</a></span> | <span class="t">So I'm going to go back to using a UNet2D model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=620" target="_blank">00:10:20.000</a></span> | <span class="t">So how can we use a UNet2D model when we've now got three things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=625" target="_blank">00:10:25.000</a></span> | <span class="t">And what I did in my modified ladder, just underneath it, sorry, actually what I did is I modified train_cb</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=639" target="_blank">00:10:39.000</a></span> | <span class="t">to add one parameter, which is number of inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=643" target="_blank">00:10:43.000</a></span> | <span class="t">And so this tells you how many inputs are there to the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=651" target="_blank">00:10:51.000</a></span> | <span class="t">Normally you would expect one input, but our model has two inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=657" target="_blank">00:10:57.000</a></span> | <span class="t">So here we say, okay, so accelerate_cb is a train_cb. So when we call it, we say we're going to have two inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=673" target="_blank">00:11:13.000</a></span> | <span class="t">And so what that's going to do is it's just going to remember how many you asked for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=678" target="_blank">00:11:18.000</a></span> | <span class="t">And so when you call predict, it's not going to pass learn.batch0. It's going to call star learn.batch colon self.name_inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=690" target="_blank">00:11:30.000</a></span> | <span class="t">And ditto, when you call the loss function, it's going to be the rest. So it's star learn.batch self.add_imp onwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=697" target="_blank">00:11:37.000</a></span> | <span class="t">So this way you can have one, two, three, four, five inputs, one, two, three, four, five outputs, whatever you like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=703" target="_blank">00:11:43.000</a></span> | <span class="t">And it's just up to you then to make sure that your model and your loss function take the number of parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=709" target="_blank">00:11:49.000</a></span> | <span class="t">So the loss function is going to first of all take your creds and then, yeah, however many non-inputs you have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=720" target="_blank">00:12:00.000</a></span> | <span class="t">So that way, yeah, we now don't need to replace anything except that we did need to do the thing to make sure that we get the dot sample out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=734" target="_blank">00:12:14.000</a></span> | <span class="t">So I just had a little, this is the whole DDPMCB callback now, DDPMCB2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=740" target="_blank">00:12:20.000</a></span> | <span class="t">So after the predictions are done, replace them with the dot sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=746" target="_blank">00:12:26.000</a></span> | <span class="t">Right. So that's nice and easy, you know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=751" target="_blank">00:12:31.000</a></span> | <span class="t">So we end up with quite a bit of pieces, but they're all very decoupled, you know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=756" target="_blank">00:12:36.000</a></span> | <span class="t">So with mini AI, you know, with and with AccelerateCB and whatever, I guess we should export these actually into a nice module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=769" target="_blank">00:12:49.000</a></span> | <span class="t">Well, if you had all those, then, yeah, you wouldn't have AccelerateCB. The only thing you would need would be the noisify and the collation function and this tiny callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=781" target="_blank">00:13:01.000</a></span> | <span class="t">And then, yeah, use our learner and fit and we get the same result as usual.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=790" target="_blank">00:13:10.000</a></span> | <span class="t">And this takes basically an identical amount of time because at this point I'm not using all the GPU or TPU or whatever. I'm just using mixed precision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=799" target="_blank">00:13:19.000</a></span> | <span class="t">So this is just a shortcut for this. It's not a huge shortcut.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=805" target="_blank">00:13:25.000</a></span> | <span class="t">The main purpose of it really is to allow us to use other types of accelerators or multiple accelerators or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=812" target="_blank">00:13:32.000</a></span> | <span class="t">So we'll look at those later. Does that make sense so far?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=817" target="_blank">00:13:37.000</a></span> | <span class="t">Yeah. Yeah. Accelerator is really powerful and pretty amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=822" target="_blank">00:13:42.000</a></span> | <span class="t">Yeah, it is. And I know like a lot of, yeah, like I know Kat Carlson uses it in all her K diffusion code, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=832" target="_blank">00:13:52.000</a></span> | <span class="t">Yeah, it's used a lot out there in the real world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=835" target="_blank">00:13:55.000</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=836" target="_blank">00:13:56.000</a></span> | <span class="t">I've got one more thing I just want to mention briefly. Just a sneaky trick. I haven't even bothered training anything with it because it's just a sneaky trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=846" target="_blank">00:14:06.000</a></span> | <span class="t">But sometimes thinking about speed, loading the data is the slow bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=857" target="_blank">00:14:17.000</a></span> | <span class="t">And so particularly if you use Kaggle, for example, on Kaggle, you get two GPUs, which is amazing, but trying to get two CPUs, which is crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=866" target="_blank">00:14:26.000</a></span> | <span class="t">So it's really hard to take advantage of them because the amount of time it takes to open a PNG or a JPEG, your GPU is sitting there waiting for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=876" target="_blank">00:14:36.000</a></span> | <span class="t">So if your data loading and transformation process is slow and it's difficult to keep your GPUs busy, there's a trick you can do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=890" target="_blank">00:14:50.000</a></span> | <span class="t">which is you could create a new data loader class, which wraps your existing data loader and it replaces DunderIdder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=900" target="_blank">00:15:00.000</a></span> | <span class="t">Now, DunderIdder is the thing that gets called when you use a for loop, right? Or when you use NextIdder, it calls this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=908" target="_blank">00:15:08.000</a></span> | <span class="t">And when you call this, you just go through the data loader as per usual.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=912" target="_blank">00:15:12.000</a></span> | <span class="t">So that's what DunderIdder would normally do. But then you also go through I from zero to by default two and then you spit out the batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=926" target="_blank">00:15:26.000</a></span> | <span class="t">And what this is going to do is it's going to go through the data loader and spit out the batch twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=933" target="_blank">00:15:33.000</a></span> | <span class="t">Why is that interesting? Because it means every epoch is going to be twice as long, but it's going to only load and augment the data as often as one epoch, but it's going to give you two epochs worth of updates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=948" target="_blank">00:15:48.000</a></span> | <span class="t">And basically, there's no reason to have a whole new batch every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=954" target="_blank">00:15:54.000</a></span> | <span class="t">You know, looking at the same batch two or three or four times at a row is totally fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=960" target="_blank">00:16:00.000</a></span> | <span class="t">And what happens in practice is you look at that batch, you do an update, get 20 part of the weight space, look at exactly the same batch and find out now where to go in the in the weight space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=972" target="_blank">00:16:12.000</a></span> | <span class="t">It's still, yeah, basically equally useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=977" target="_blank">00:16:17.000</a></span> | <span class="t">So I just wanted to add this little sneaky trick here, particularly because if we start doing more stuff on Kaggle, we'll probably want to surprise all the Kagglers with how fast our mini AI solutions are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=991" target="_blank">00:16:31.000</a></span> | <span class="t">And they'll be like, how is that possible? We'll be like, oh, we're using our, you know, two GPUs, six to accelerate. Thinking about how do we use the two GPUs and like, oh, and we're, you know, using, you know, getting out, loading, flying through using multi L.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1006" target="_blank">00:16:46.000</a></span> | <span class="t">I think that'd be pretty sweet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1012" target="_blank">00:16:52.000</a></span> | <span class="t">So that's that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1014" target="_blank">00:16:54.000</a></span> | <span class="t">Nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1016" target="_blank">00:16:56.000</a></span> | <span class="t">Yeah, it's great to see the various different ways that we can use mini AI to do to do the same thing, I guess, or, you know, however you feel like doing it or whatever works best for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1029" target="_blank">00:17:09.000</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1030" target="_blank">00:17:10.000</a></span> | <span class="t">And I'll be curious to see if other people find other ways to, you know, I'm sure there's so many different ways to to handle this problem. I think it's an interesting, interesting problem to solve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1040" target="_blank">00:17:20.000</a></span> | <span class="t">And I think for the homework, it'd be useful for people to run some of their own experiments, maybe either use these techniques on other data sets or see if you can come up with other variants of these approaches or come up with some different noise schedules to try.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1063" target="_blank">00:17:43.000</a></span> | <span class="t">It would all be useful. Any other thoughts of exercises people could try?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1071" target="_blank">00:17:51.000</a></span> | <span class="t">Yeah, I mean, getting away with less than a thousand steps. Yeah, a thousand steps happening in the final 200. So why not just train with only 200 steps? Yeah, that steps would be good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1083" target="_blank">00:18:03.000</a></span> | <span class="t">Yeah, because the sampling is actually pretty slow. So that's a good point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1090" target="_blank">00:18:10.000</a></span> | <span class="t">Yeah, yeah, I was gonna say something similar in terms of like, yeah, many, I guess, work with less number of steps. You know, you have to adjust the noise schedule appropriately and you have to, I guess there's maybe a little bit more thought into some of these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1106" target="_blank">00:18:26.000</a></span> | <span class="t">Or, you know, another aspect is like, when you're selecting the time step during training, right now we select it randomly, kind of uniformly, each time step has equal probability of being selected.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1121" target="_blank">00:18:41.000</a></span> | <span class="t">Maybe different probabilities are better and some papers do analyze that more carefully. So that's another thing to play around with as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1130" target="_blank">00:18:50.000</a></span> | <span class="t">That's almost kind of like, I guess there are almost two ways of doing the same thing in a sense, right? If you change that mapping from t to beta, then you could reduce t and have different betas would kind of give you a similar result as changing the probabilities of the t's, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1154" target="_blank">00:19:14.000</a></span> | <span class="t">Yeah, I think there's definitely, they're kind of similar, but potentially something complementary happening there as well. And I think those could be some interesting experiments to study that and also the sort of noise levels that you do choose affect the sort of behavior of the sampling process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1181" target="_blank">00:19:41.000</a></span> | <span class="t">And of course, what features you focus on. And so maybe as people play around with that, maybe they'll start to notice how using different noise levels or different noise schedules affect maybe some of the features that you see in the final image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1198" target="_blank">00:19:58.000</a></span> | <span class="t">And that could be something very interesting to study as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1204" target="_blank">00:20:04.000</a></span> | <span class="t">Right. Well, let me also say it's been really fun doing something a bit different, which is doing a lesson with you guys rather than all on my lonesome. I hope we can do this again because I've really enjoyed it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1216" target="_blank">00:20:16.000</a></span> | <span class="t">Yeah, it was great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1217" target="_blank">00:20:17.000</a></span> | <span class="t">So, of course, now we're, you know, strictly speaking in the recording, we'll next up see Johnno, who's actually already recorded his thanks to the Zoom mess up, but stick around. So I've already seen it. Johnno's thing is amazing. So you definitely don't want to miss that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1233" target="_blank">00:20:33.000</a></span> | <span class="t">Hello, everyone. So today, depending on the order that this ends up happening, you've probably seen Denise a DDPM implementation where we're taking the default training call back and doing some more interesting things with preparing the data for the learner or interpreting the results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1249" target="_blank">00:20:49.000</a></span> | <span class="t">So in these two notebooks that I'm going to show, we're going to be doing something similar, just exploring like what else can we do besides just the classic kind of classification model or where we have some inputs and a label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1261" target="_blank">00:21:01.000</a></span> | <span class="t">And what else can we do with this mini AI setup that we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1265" target="_blank">00:21:05.000</a></span> | <span class="t">And so in the first one, we're going to approach a kind of classic AI art approach called style transfer. And so the idea here is that we're going to want to somehow create an artistic combination of two images where we have the structure and layout of one image and the style of another.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1286" target="_blank">00:21:26.000</a></span> | <span class="t">So we'll look at how we do that. And then we'll also talk along the way in terms of like, why is this actually useful beyond just making pretty pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1294" target="_blank">00:21:34.000</a></span> | <span class="t">So to start with, I've got a couple of URLs for images. You're welcome to go and slip in your own as well and definitely recommend trying this notebook with some different ones just to see what effects you can get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1305" target="_blank">00:21:45.000</a></span> | <span class="t">And we're going to download the image and load it up as a tensor. So we have here a three channel image 256 by 256 pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1314" target="_blank">00:21:54.000</a></span> | <span class="t">And so this is the kind of base image that we're going to start working with. So before we talk about styles or anything, let's just think what is our goal here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1323" target="_blank">00:22:03.000</a></span> | <span class="t">We'd like to do some sort of training or optimization. We'd like to get to a point where we can match some aspect of this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1331" target="_blank">00:22:11.000</a></span> | <span class="t">And so maybe a good place to start is to just try and do what can we start from a random image and optimize it until it matches pixel for pixel exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1341" target="_blank">00:22:21.000</a></span> | <span class="t">And that's going to help us get this. Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1343" target="_blank">00:22:23.000</a></span> | <span class="t">I think that might be helpful is if you type style transfer deep learning into Google images, you could maybe show some examples so that people will see what their goal is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1357" target="_blank">00:22:37.000</a></span> | <span class="t">Yeah, that's a very good point. So let's see. This is a good one here. We've got the Mona Lisa as our our base.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1364" target="_blank">00:22:44.000</a></span> | <span class="t">But we've managed to apply some how some different artistic styles to that same base structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1370" target="_blank">00:22:50.000</a></span> | <span class="t">So we have the Great Wave by Psaki. We have Starry Night by Vincent Mango. This is some sort of Kandinsky or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1377" target="_blank">00:22:57.000</a></span> | <span class="t">Yeah. So this is our end goal to be able to take the overall structure and layout of one image and the style from some different reference image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1385" target="_blank">00:23:05.000</a></span> | <span class="t">And in fact, this was the first ever I think fast AI generative modeling lesson looked at style transfer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1395" target="_blank">00:23:15.000</a></span> | <span class="t">It's it's been around for a few years. It's kind of a classic technique.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1399" target="_blank">00:23:19.000</a></span> | <span class="t">And it's really I think a lot of the students when we first did it found it extremely useful way of better understanding, like, you know, flexing their deep learning muscles, understanding what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1414" target="_blank">00:23:34.000</a></span> | <span class="t">And also created some really interesting new approaches. So hopefully we'll see the same thing again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1420" target="_blank">00:23:40.000</a></span> | <span class="t">Maybe some students will be able to show some really interesting results from this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1427" target="_blank">00:23:47.000</a></span> | <span class="t">Yeah. And I mean, today we're going to focus on kind of the classic approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1431" target="_blank">00:23:51.000</a></span> | <span class="t">But I know one of the previous students from fast AI did a whole different way of doing that style loss that we'll maybe post in the forums or, you know, I've got some comparisons that we can look at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1442" target="_blank">00:24:02.000</a></span> | <span class="t">So, yeah, definitely a fruitful field still. And I think after the initial hype of like everyone was excited about style transfer apps and things five years ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1451" target="_blank">00:24:11.000</a></span> | <span class="t">I feel like there's still some things to explore there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1454" target="_blank">00:24:14.000</a></span> | <span class="t">Very creative and fun little and divergent in the deep learning world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1460" target="_blank">00:24:20.000</a></span> | <span class="t">OK, so our first step in getting to that point is being able to optimize an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1465" target="_blank">00:24:25.000</a></span> | <span class="t">And so up until now, we've been optimizing like the weights of a neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1469" target="_blank">00:24:29.000</a></span> | <span class="t">But now you want to go to something a bit more simple and we just want to optimize the raw pixels of an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1473" target="_blank">00:24:33.000</a></span> | <span class="t">Do you mind if you scroll up a bit to the previous code just so we can have a look at it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1477" target="_blank">00:24:37.000</a></span> | <span class="t">So there's a couple of interesting points about this code here is, you know, we're not we're not cheating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1483" target="_blank">00:24:43.000</a></span> | <span class="t">Well, not really. So we're so yeah, we've seen how to download things in the network before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1490" target="_blank">00:24:50.000</a></span> | <span class="t">So we're using fastcodes URL read because we're allowed to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1493" target="_blank">00:24:53.000</a></span> | <span class="t">And then I think we decided we weren't going to write our own JPEG parser.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1497" target="_blank">00:24:57.000</a></span> | <span class="t">So TorchVision actually has a pretty good one, which a lot of people don't realize exists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1503" target="_blank">00:25:03.000</a></span> | <span class="t">And a lot of people tend to use PIL, but actually TorchVision has a more performant option.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1511" target="_blank">00:25:11.000</a></span> | <span class="t">And it's actually quite difficult to find any examples of how to use it like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1519" target="_blank">00:25:19.000</a></span> | <span class="t">Here's some code you can borrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1522" target="_blank">00:25:22.000</a></span> | <span class="t">Yeah, actually, Google load image from a URL in PyTorch. All of the examples are going to use PIL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1527" target="_blank">00:25:27.000</a></span> | <span class="t">And that's what I've done historically is use the requests library to download the URL and then feed that into PIL's image.open function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1537" target="_blank">00:25:37.000</a></span> | <span class="t">So yeah, that was fun when I was working with Jeremy on this notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1540" target="_blank">00:25:40.000</a></span> | <span class="t">Like that's how I was doing it. It's with me breaking the rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1543" target="_blank">00:25:43.000</a></span> | <span class="t">And let's see if we can do this directly into a tensor without this intermediate step of loading it with with pillow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1551" target="_blank">00:25:51.000</a></span> | <span class="t">Cool. Okay. So how are we going to do this image optimization?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1556" target="_blank">00:25:56.000</a></span> | <span class="t">Well, first thing is we don't really have a data set of lots of training examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1560" target="_blank">00:26:00.000</a></span> | <span class="t">We just have a single target and a single thing we're optimizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1564" target="_blank">00:26:04.000</a></span> | <span class="t">And so we built this linked data set here, which is just going to follow the PyTorch data set standard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1569" target="_blank">00:26:09.000</a></span> | <span class="t">We're going to tell it how to get a particular item and what our length is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1574" target="_blank">00:26:14.000</a></span> | <span class="t">But in this case, we're just always going to return zero zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1578" target="_blank">00:26:18.000</a></span> | <span class="t">We're not actually going to care about the results from this data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1581" target="_blank">00:26:21.000</a></span> | <span class="t">We just want something that we can pass to the learner to do some number of training iterations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1585" target="_blank">00:26:25.000</a></span> | <span class="t">So we create like a thick dummy data set with a hundred items and then we create our data loaders from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1592" target="_blank">00:26:32.000</a></span> | <span class="t">And that's going to give us a way to train for some number of steps without really caring about what this data is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1599" target="_blank">00:26:39.000</a></span> | <span class="t">So does that make sense?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1601" target="_blank">00:26:41.000</a></span> | <span class="t">Yeah. So just to clarify the reason we're doing this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1604" target="_blank">00:26:44.000</a></span> | <span class="t">So basically, the idea is we're going to start with that photo you downloaded and I guess you're going to be downloading another photo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1614" target="_blank">00:26:54.000</a></span> | <span class="t">So that photo is going to be like the content.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1616" target="_blank">00:26:56.000</a></span> | <span class="t">We're going to try to make it continue to look like that lady.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1619" target="_blank">00:26:59.000</a></span> | <span class="t">And then we're going to try to change the style so that the style looks like the style of some other picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1624" target="_blank">00:27:04.000</a></span> | <span class="t">And the way we're going to be doing that is by doing an optimization loop with like SGD or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1633" target="_blank">00:27:13.000</a></span> | <span class="t">So the idea is that each step of that, we're going to be moving the style somehow of the image closer and closer to one of those images you downloaded.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1642" target="_blank">00:27:22.000</a></span> | <span class="t">So it's not that we're going to be looping through lots of different images, but we're just going to be looping through steps of a optimization loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1652" target="_blank">00:27:32.000</a></span> | <span class="t">Is that the idea?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1654" target="_blank">00:27:34.000</a></span> | <span class="t">Exactly. And so, yeah, we can create this data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1659" target="_blank">00:27:39.000</a></span> | <span class="t">And then in terms of the actual model that we're optimizing and passing to the learner, we created this tensor model class, which just has whatever tensor we pass in as its parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1670" target="_blank">00:27:50.000</a></span> | <span class="t">So there's no actual neural network necessarily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1672" target="_blank">00:27:52.000</a></span> | <span class="t">We're just going to pass in a random image or some image-shaped thing, a set of numbers that we can then optimize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1679" target="_blank">00:27:59.000</a></span> | <span class="t">So just in case people have forgotten that, so to remind people, when you put something in an n-end or parameter, it doesn't change it in any way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1686" target="_blank">00:28:06.000</a></span> | <span class="t">It's just a normal tensor, but it's stored inside the module as being something as being a tensor to optimize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1694" target="_blank">00:28:14.000</a></span> | <span class="t">So what you're doing here, Jono, I guess, is to say I'm not actually optimizing a model at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1700" target="_blank">00:28:20.000</a></span> | <span class="t">I'm optimizing an image, the pixels of an image directly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1706" target="_blank">00:28:26.000</a></span> | <span class="t">Exactly. And because it's in a parameter, if we look at our model, we can see that, for example, model.t, it does require grad, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1720" target="_blank">00:28:40.000</a></span> | <span class="t">Because that's already set up, because this n-end module is going to look for any parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1724" target="_blank">00:28:44.000</a></span> | <span class="t">And if our optimizer is looking at, let's look at the shape of the parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1734" target="_blank">00:28:54.000</a></span> | <span class="t">So this is the shape of the parameters that we're optimizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1737" target="_blank">00:28:57.000</a></span> | <span class="t">This is just that tensor that we passed in, the same shape as our image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1741" target="_blank">00:29:01.000</a></span> | <span class="t">And this is what's going to be optimized if we pass this into any sort of learner fit method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1746" target="_blank">00:29:06.000</a></span> | <span class="t">OK, so this model does have a thing being passed to forward, which is x, which we're ignoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1752" target="_blank">00:29:12.000</a></span> | <span class="t">And I guess that's just because our learner passes something in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1755" target="_blank">00:29:15.000</a></span> | <span class="t">So we're making life a bit easier for ourselves by making the model look the way our learner expects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1761" target="_blank">00:29:21.000</a></span> | <span class="t">Yeah. And we could do that using like train_cb or something if we wanted to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1765" target="_blank">00:29:25.000</a></span> | <span class="t">But this seems like a nice, nice, easy way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1770" target="_blank">00:29:30.000</a></span> | <span class="t">Yeah, so I mean, this is the way I've done it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1772" target="_blank">00:29:32.000</a></span> | <span class="t">If you do want to use train_cb, you can set it up with a custom predict method that is just going to call the model forward method with no parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1783" target="_blank">00:29:43.000</a></span> | <span class="t">And if you want, likewise, just calling the loss function on just the predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1788" target="_blank">00:29:48.000</a></span> | <span class="t">But if you want to skip this because we take this argument x equals zero and never use it, that should also work without this callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1795" target="_blank">00:29:55.000</a></span> | <span class="t">So either way is fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1797" target="_blank">00:29:57.000</a></span> | <span class="t">This is a nice approach if you have something that you're using an existing model, which expects some number of parameters or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1803" target="_blank">00:30:03.000</a></span> | <span class="t">Yeah, you can just modify that training callback, but we almost don't need to in this case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1809" target="_blank">00:30:09.000</a></span> | <span class="t">OK, so let's see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1811" target="_blank">00:30:11.000</a></span> | <span class="t">Let's put this in a learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1812" target="_blank">00:30:12.000</a></span> | <span class="t">Let's optimize it with some loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1814" target="_blank">00:30:14.000</a></span> | <span class="t">Oh, just to clarify, I get it. So the get_loss you had to change because normally we pass a target to the loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1820" target="_blank">00:30:20.000</a></span> | <span class="t">Yes, it's learner.prids and then learner.batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1823" target="_blank">00:30:23.000</a></span> | <span class="t">And again, we could avoid, we could remove that as well if we wanted to by having our loss function take a target that we then ignore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1834" target="_blank">00:30:34.000</a></span> | <span class="t">Yeah, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1836" target="_blank">00:30:36.000</a></span> | <span class="t">So both other approaches, I like this because we're going to kind of be building on this idea of modifying the training callback in the DDPM example and the other examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1846" target="_blank">00:30:46.000</a></span> | <span class="t">But in this case, it's just these two lines change.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1848" target="_blank">00:30:48.000</a></span> | <span class="t">This is how we get our model predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1849" target="_blank">00:30:49.000</a></span> | <span class="t">We just call the forward method, which returns this image that we're optimizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1854" target="_blank">00:30:54.000</a></span> | <span class="t">And we're going to evaluate this according to some loss function that just takes in an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1860" target="_blank">00:31:00.000</a></span> | <span class="t">So for our first loss function, we're just going to use the mean squared error between the image that we are generating, like this output of our model and that content image that's our target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1872" target="_blank">00:31:12.000</a></span> | <span class="t">Right. So we're going to set up our model, start it out with a random image like this above.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1876" target="_blank">00:31:16.000</a></span> | <span class="t">We're going to create a learner with a dummy data loader for 100 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1882" target="_blank">00:31:22.000</a></span> | <span class="t">Our loss function is going to be this mean squared error loss function, set a learning rate and an optimizer function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1889" target="_blank">00:31:29.000</a></span> | <span class="t">The default would probably also work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1892" target="_blank">00:31:32.000</a></span> | <span class="t">And if we run this, something's going to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1894" target="_blank">00:31:34.000</a></span> | <span class="t">Our loss is going to go from a non-zero number to close this error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1899" target="_blank">00:31:39.000</a></span> | <span class="t">And we can look at the final result, like if we call learn.model and show that as an image versus the actual image, we'll see that they look pretty much identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1908" target="_blank">00:31:48.000</a></span> | <span class="t">So just to clarify, this is like a pointless example, but what we did, we started with that noisy image she showed above.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1915" target="_blank">00:31:55.000</a></span> | <span class="t">And then we used SGD to make those pixels get closer and closer to the lady in the sunglasses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1923" target="_blank">00:32:03.000</a></span> | <span class="t">Not for any particular purpose, but just to show that we can turn noisy pixels into something else by having it follow a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1932" target="_blank">00:32:12.000</a></span> | <span class="t">Make the pixels look as much as possible, like that idea in the sunglasses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1938" target="_blank">00:32:18.000</a></span> | <span class="t">Exactly. And so in this case, it's a very simple loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1940" target="_blank">00:32:20.000</a></span> | <span class="t">There's like a one direction that you update, so it's almost trivial to solve, but it still helps us get the framework in place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1947" target="_blank">00:32:27.000</a></span> | <span class="t">But just seeing this final result is not very instructive because you almost think, well, did I get a bug in my code?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1952" target="_blank">00:32:32.000</a></span> | <span class="t">Did I just duplicate the image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1953" target="_blank">00:32:33.000</a></span> | <span class="t">How do I know this is actually doing what we expect?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1956" target="_blank">00:32:36.000</a></span> | <span class="t">And so before we even move on to any more complicated loss functions, I thought it was important to have some sort of more obvious way of doing progress.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1965" target="_blank">00:32:45.000</a></span> | <span class="t">So I've created a little logging callback here that is just after every batch, it's going to store the output as an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1977" target="_blank">00:32:57.000</a></span> | <span class="t">I guess after every 10 batches here by default.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1979" target="_blank">00:32:59.000</a></span> | <span class="t">Oh, yes. Yeah. Sorry. So we can set how often it's going to update and then every 10 iterations or 50 iterations, whatever we set the log every argument to, it's going to store that in a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1990" target="_blank">00:33:10.000</a></span> | <span class="t">And then after the training is done, after that, we're just going to show those images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=1995" target="_blank">00:33:15.000</a></span> | <span class="t">And so everything else the same as before, but passing in this extra logging callback, it's going to give us the kind of progress.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2003" target="_blank">00:33:23.000</a></span> | <span class="t">And so now you can see, OK, there is actually something happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2006" target="_blank">00:33:26.000</a></span> | <span class="t">We're starting from this noise after a few iterations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2009" target="_blank">00:33:29.000</a></span> | <span class="t">Already, most of it is gone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2011" target="_blank">00:33:31.000</a></span> | <span class="t">And by the end of this process, it looks exactly like the content image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2015" target="_blank">00:33:35.000</a></span> | <span class="t">So I really like this because what you've basically done here is you've now already got all the pooling and infrastructure in place you need to basically create a really wide variety of interesting outputs that could either be artistic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2034" target="_blank">00:33:54.000</a></span> | <span class="t">or like, you know, there could be more like image reconstruction, super resolution, colorization, whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2045" target="_blank">00:34:05.000</a></span> | <span class="t">And you just have to modify the loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2049" target="_blank">00:34:09.000</a></span> | <span class="t">And I really like the way you've created the absolute easiest possible first and fully checked it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2058" target="_blank">00:34:18.000</a></span> | <span class="t">And before you start doing the fancy stuff and now you kind of, I guess, feel really comfortable doing the fancy stuff because you know that's all in place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2069" target="_blank">00:34:29.000</a></span> | <span class="t">Yeah, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2070" target="_blank">00:34:30.000</a></span> | <span class="t">And we know that we're going to see some tracking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2072" target="_blank">00:34:32.000</a></span> | <span class="t">Hopefully it'll be visually obvious if things are going wrong and we know exactly what we need to modify.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2076" target="_blank">00:34:36.000</a></span> | <span class="t">If we can now express some desired property that's more interesting than just like mean squared error to a target image, then we could have everything in place to optimize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2085" target="_blank">00:34:45.000</a></span> | <span class="t">And so this is now really fun to like, OK, let's think about what other loss functions we could do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2090" target="_blank">00:34:50.000</a></span> | <span class="t">Maybe we wanted to match an image, but also have a particular overall color.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2094" target="_blank">00:34:54.000</a></span> | <span class="t">Maybe we want some some more complicated thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2097" target="_blank">00:34:57.000</a></span> | <span class="t">And so towards that, like towards starting to get a more richer like measure of what this output image looks like, we're going to talk about extracting features from a pre-trained network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2107" target="_blank">00:35:07.000</a></span> | <span class="t">And this is kind of like the core idea of this notebook is that we have these big convolutional neural networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2114" target="_blank">00:35:14.000</a></span> | <span class="t">This one is a much older architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2117" target="_blank">00:35:17.000</a></span> | <span class="t">And it's a relatively simple compared to some of the big, you know, dense nets and so on used today.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2121" target="_blank">00:35:21.000</a></span> | <span class="t">It's actually a model like our Pre-ResNet Fashioned MNIST model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2127" target="_blank">00:35:27.000</a></span> | <span class="t">It's basically almost the same as VGG16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2131" target="_blank">00:35:31.000</a></span> | <span class="t">Yeah, yeah, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2133" target="_blank">00:35:33.000</a></span> | <span class="t">And so we're feeding in an image and then we have these like convolutional layers, downsampling, convolution, you know, downsampling with max pooling up until some final prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2143" target="_blank">00:35:43.000</a></span> | <span class="t">Oh, but can I just point something out?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2145" target="_blank">00:35:45.000</a></span> | <span class="t">There's one big difference here, which is that seven by seven by five twelve, if you can point at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2151" target="_blank">00:35:51.000</a></span> | <span class="t">Normally nowadays and in our models, we tried, you know, using an adaptive or global pooling to get down to a one by one by five twelve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2161" target="_blank">00:36:01.000</a></span> | <span class="t">VGG16 does something which is very unusual by today's standards, which is it just flattens that out into a one by one by four or nine six.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2170" target="_blank">00:36:10.000</a></span> | <span class="t">Which actually might be a really interesting feature of VGG.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2176" target="_blank">00:36:16.000</a></span> | <span class="t">And I've always felt like people might want to consider training, you know, res nets and stuff without the global pooling and instead do the flattening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2185" target="_blank">00:36:25.000</a></span> | <span class="t">The reason we don't do the flattening nowadays is that that very last linear layer that goes from one by one by four or nine six to one by one by a thousand, because this is an image net model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2195" target="_blank">00:36:35.000</a></span> | <span class="t">is going to need an awfully big weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2200" target="_blank">00:36:40.000</a></span> | <span class="t">You've got a four or nine six by a thousand weight matrix as a result of which this is actually horrifically memory intensive for a reasonably poor performing model by modern standards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2211" target="_blank">00:36:51.000</a></span> | <span class="t">But yeah, I think that doing that actually also has some some benefits potentially as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2218" target="_blank">00:36:58.000</a></span> | <span class="t">Yeah. And in this case, we are not even really interested in the classification side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2224" target="_blank">00:37:04.000</a></span> | <span class="t">We're more excited about the capacity of this to extract different features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2230" target="_blank">00:37:10.000</a></span> | <span class="t">And so the idea here and maybe I should pull up this classic article looking at like what do neural networks learn and trying to visualize some of these features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2245" target="_blank">00:37:25.000</a></span> | <span class="t">And this is something we've mentioned before with these big pre-trained networks is that the early layers tend to pick up on very simple features, edges and shapes and textures and those get mixed together into more complicated textures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2257" target="_blank">00:37:37.000</a></span> | <span class="t">And by the way, this is just trying to visualize like what what kind of input maximally activates a particular like output on each of these layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2265" target="_blank">00:37:45.000</a></span> | <span class="t">And so it's a great way to see like what kinds of things that's learning. And so you can see as we move deeper and deeper into the into the network, we're getting more and more complicated, like hierarchical features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2276" target="_blank">00:37:56.000</a></span> | <span class="t">And so we've looked at the Zeiler and Fergus paper before that which is an earlier version doing something like this to see what kind of features were available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2285" target="_blank">00:38:05.000</a></span> | <span class="t">So we'll link to this distill paper from the forum and the course lesson page because it's actually a more modern and fancy version kind of the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2299" target="_blank">00:38:19.000</a></span> | <span class="t">Yeah. Also note the names here. All of these people are worth following. Chris does amazing work on interpretability and Alexander Modvinsov we'll see in the second notebook that I look at today and doing all sorts of other cool stuff as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2312" target="_blank">00:38:32.000</a></span> | <span class="t">And anyway, so we want to think about like let's extract the outputs of these layers in the hope that they give us a representation of our image that's richer than just the raw pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2323" target="_blank">00:38:43.000</a></span> | <span class="t">So we can list the idea being there that if we had another if we were able to change our image to have the same features at those various types that you were just showing us that then it would like have similar textures or similar kind of higher level concepts or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2345" target="_blank">00:39:05.000</a></span> | <span class="t">Exactly. So if you think of this like 14 by 14 feature map over here, maybe it's capturing that there's an eye in the top left and some hair on the top right, these kind of abstract things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2356" target="_blank">00:39:16.000</a></span> | <span class="t">And if you change the brightness of the image, it's unlikely that it's going to change what features are stored there because the networks learned to be somewhat invariant to these like rough transformations, a bit of noise, a bit of changing texture early on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2369" target="_blank">00:39:29.000</a></span> | <span class="t">It's not going to affect the fact that it still thinks this looks like a dog and a few layers before that, that it still thinks that part looks like a nose and that part looks like an ear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2377" target="_blank">00:39:37.000</a></span> | <span class="t">Maybe the more interesting bits then for what you're doing are those earlier layers where it's going to be like there's a whole bunch of kind of diagonal lines here or there's a kind of a loopy bit here because then if you replicate those, you're going to get similar textures without changing the semantics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2395" target="_blank">00:39:55.000</a></span> | <span class="t">Exactly. Yeah. So, I mean, I guess let's load the model and look at what the layers are. And then in the next section, we can try and like see what kinds of images work when we optimize towards different layers in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2407" target="_blank">00:40:07.000</a></span> | <span class="t">And so this is the network we have, revolutions, relu, max pooling, all of this we should be familiar with by now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2415" target="_blank">00:40:15.000</a></span> | <span class="t">And it's all just in one big and in dot sequential. This doesn't have the head. So we said dot features. If you did this without you'd have then the this is like the features sub sub sub network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2427" target="_blank">00:40:27.000</a></span> | <span class="t">That's everything up until some point. And then you have the flattening and the classification, which we are kind of just throwing away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2433" target="_blank">00:40:33.000</a></span> | <span class="t">So this is the body of the network. And we're going to try and tag into various layers here and extract the outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2440" target="_blank">00:40:40.000</a></span> | <span class="t">But before we do that, there's one more bit of admin we need to handle. And this was trained on a normalized version of ImageNet, right, where you took the data set me and the data set standard deviation and use that to normalize your images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2452" target="_blank">00:40:52.000</a></span> | <span class="t">So if we want to match what the data looked like during training, we need to match that normalization step. And we've done this on grayscale images where we just subtract the mean divide by the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2462" target="_blank">00:41:02.000</a></span> | <span class="t">But with three channel images, these RGB images, we can't get away with just saying, let's subtract our mean from our image and divide by the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2471" target="_blank">00:41:11.000</a></span> | <span class="t">You're going to get an error that's going to pop up. And this is because we now need to think about broadcasting and these shapes a little bit more carefully than we can with just a scalar value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2481" target="_blank">00:41:21.000</a></span> | <span class="t">So if we look at the mean here, we just have three values, right, one for each channel, the red, green and blue channels, whereas our content image has three channels and then 256 by 256 for the spatial dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2495" target="_blank">00:41:35.000</a></span> | <span class="t">So if we try and say content image divided by the mean or minus the mean, it's going to go from right to left and find the first non-unit axis. So anything with a size greater than one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2511" target="_blank">00:41:51.000</a></span> | <span class="t">And it's going to try and line those up. And in this case, the three and the 256, those aren't going to match. And so we're going to get an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2517" target="_blank">00:41:57.000</a></span> | <span class="t">More perniciously, if the shape did happen to match, that might still not be what you intended.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2522" target="_blank">00:42:02.000</a></span> | <span class="t">So what we'd like is to have these three channels map to the three channels of our image and then somehow expand those values out across the two other dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2532" target="_blank">00:42:12.000</a></span> | <span class="t">And the way we do that is we just add two additional dimensions on the right for our image.net.mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2538" target="_blank">00:42:18.000</a></span> | <span class="t">And you could also do the unsqueezed minus one, the unsqueezed minus one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2542" target="_blank">00:42:22.000</a></span> | <span class="t">But this is the kind of syntax that we're using in this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2546" target="_blank">00:42:26.000</a></span> | <span class="t">And now our shapes are going to match because we're going to go from right to left if it's a unit dimension size one, we're going to expand it out to match the other tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2556" target="_blank">00:42:36.000</a></span> | <span class="t">And if it's a non-unit dimension, then the shapes have to match. And that looks like it's the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2560" target="_blank">00:42:40.000</a></span> | <span class="t">And so now with this reshaping operation, we can write a little normalized function, which we can then apply to our content image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2568" target="_blank">00:42:48.000</a></span> | <span class="t">And I'm just checking the min and the max to make sure that this roughly makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2573" target="_blank">00:42:53.000</a></span> | <span class="t">And we could check the mean as well to make sure that the mean is somewhat close to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2582" target="_blank">00:43:02.000</a></span> | <span class="t">OK, in this case, less maybe because it's a darker image than average, but at least we are doing the operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2588" target="_blank">00:43:08.000</a></span> | <span class="t">It seems like the math is correct. And now the sharing the channel wise mean would be interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2594" target="_blank">00:43:14.000</a></span> | <span class="t">Oh, yes. So that would be the mean over the dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2600" target="_blank">00:43:20.000</a></span> | <span class="t">One and two, I think. I think you have to type all one comma to this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2609" target="_blank">00:43:29.000</a></span> | <span class="t">I wasn't sure which way around. Yeah, I always forget to say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2615" target="_blank">00:43:35.000</a></span> | <span class="t">OK, so our blue channel is brighter than the others. And if you go back and look at our image, maybe believe that the image interest is going to be blue and red and the face is going to be just blue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2629" target="_blank">00:43:49.000</a></span> | <span class="t">Yeah, OK, so that seems to be working. We can double check because now that we've implemented ourselves,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2635" target="_blank">00:43:55.000</a></span> | <span class="t">TorchVision dot transforms has a normalized function that you can pass the mean and standard deviation to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2639" target="_blank">00:43:59.000</a></span> | <span class="t">And it's going to handle making sure that the devices match, that the shapes match, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2644" target="_blank">00:44:04.000</a></span> | <span class="t">And you can see if we check them in a max, it's exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2647" target="_blank">00:44:07.000</a></span> | <span class="t">Just a little bit of reassurance that our function is doing the same thing as this normalized transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2653" target="_blank">00:44:13.000</a></span> | <span class="t">I appreciate you not cheating by implementing that, Jono. Thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2658" target="_blank">00:44:18.000</a></span> | <span class="t">You're welcome. Got to follow the rules. Got to follow that. OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2661" target="_blank">00:44:21.000</a></span> | <span class="t">So with that bit of admin out the way, we can finally say, how do we extract the features from this network?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2667" target="_blank">00:44:27.000</a></span> | <span class="t">Now, if you remember the previous lesson on hooks, that might be something that springs to mind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2673" target="_blank">00:44:33.000</a></span> | <span class="t">I'm going to leave that as an exercise for the reader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2676" target="_blank">00:44:36.000</a></span> | <span class="t">And what we're going to do is we're just going to normalize our input and then we're going to run through the layers one by one in this sequential stack.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2685" target="_blank">00:44:45.000</a></span> | <span class="t">We're going to pass our X through that layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2688" target="_blank">00:44:48.000</a></span> | <span class="t">And then if we're in one of the target layers, which we can specify, we're going to store the outputs of that layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2694" target="_blank">00:44:54.000</a></span> | <span class="t">And I can't remember if I've used the term features before or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2698" target="_blank">00:44:58.000</a></span> | <span class="t">So apologies if I have, but just to clarify here, when we say features, we just mean the activations of a layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2706" target="_blank">00:45:06.000</a></span> | <span class="t">And in this case, Jono has picked out two particular layers, 18 and 25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2712" target="_blank">00:45:12.000</a></span> | <span class="t">I mean, I'm not sure it matters in this particular case, but there's a bit of a gotcha you've got here, Jono,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2717" target="_blank">00:45:17.000</a></span> | <span class="t">which is you should change that default 18, 25 from a list to a tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2724" target="_blank">00:45:24.000</a></span> | <span class="t">And the reason for that is that when you use a mutable type like a list in a Python default parameter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2734" target="_blank">00:45:34.000</a></span> | <span class="t">it does this really weird thing where it actually keeps it around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2738" target="_blank">00:45:38.000</a></span> | <span class="t">And if you change it at all later, then it actually kind of modifies your function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2742" target="_blank">00:45:42.000</a></span> | <span class="t">So I would suggest, yeah, never using a list as a default parameter because at some point it will create the weirdest bug you've ever had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2751" target="_blank">00:45:51.000</a></span> | <span class="t">I say this from experience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2753" target="_blank">00:45:53.000</a></span> | <span class="t">Yeah, that sounds like something that was hard one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2757" target="_blank">00:45:57.000</a></span> | <span class="t">All right. I'll change that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2758" target="_blank">00:45:58.000</a></span> | <span class="t">And by the time you see this notebook, that change should be there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2761" target="_blank">00:46:01.000</a></span> | <span class="t">All right. So this is one way to do it, just manually running through the layers one by one up until whatever the latest layer we're interested in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2767" target="_blank">00:46:07.000</a></span> | <span class="t">But you could do this just as easily by adding hooks to the specific layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2771" target="_blank">00:46:11.000</a></span> | <span class="t">and then just feeding your data through the whole network at once and relying on the hooks to store those intermediates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2777" target="_blank">00:46:17.000</a></span> | <span class="t">Yeah. So let's make that homework, actually, not just an exercise you can do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2781" target="_blank">00:46:21.000</a></span> | <span class="t">But yeah, I want let's make sure everybody does that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2784" target="_blank">00:46:24.000</a></span> | <span class="t">Use one of the hooks callbacks we had or the hooks context managers we had,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2790" target="_blank">00:46:30.000</a></span> | <span class="t">or you can use the register forward hook PyTorch directly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2796" target="_blank">00:46:36.000</a></span> | <span class="t">Yeah. And so what we get out here, we're feeding in an image that's 256 by 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2802" target="_blank">00:46:42.000</a></span> | <span class="t">And the first layer that we're looking at is this one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2805" target="_blank">00:46:45.000</a></span> | <span class="t">And so it's getting half to 128, then to 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2810" target="_blank">00:46:50.000</a></span> | <span class="t">These ones are just different because it's a different starting size and then to 32 by 32 by 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2816" target="_blank">00:46:56.000</a></span> | <span class="t">And so those are the features that we're talking about for that layer 18.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2820" target="_blank">00:47:00.000</a></span> | <span class="t">It's this thing of shape 512 by 32 by 32. For every kind of spatial location in that 32 by 32 grid,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2827" target="_blank">00:47:07.000</a></span> | <span class="t">we have the output from 512 different filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2831" target="_blank">00:47:11.000</a></span> | <span class="t">And so those are going to be the features that we're talking about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2834" target="_blank">00:47:14.000</a></span> | <span class="t">So there's purpose being that the channels in a single convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2840" target="_blank">00:47:20.000</a></span> | <span class="t">Yeah. Okay. So what's the point of this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2844" target="_blank">00:47:24.000</a></span> | <span class="t">Well, like I said, we're hoping that we can capture different things at different layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2849" target="_blank">00:47:29.000</a></span> | <span class="t">And so to kind of first get a feel for this, like what if we just compared these feature maps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2855" target="_blank">00:47:35.000</a></span> | <span class="t">we can institute what I'm calling a content loss, or you might see it as a perceptual loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2861" target="_blank">00:47:41.000</a></span> | <span class="t">And we're going to focus on a couple of later layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2864" target="_blank">00:47:44.000</a></span> | <span class="t">Again, make sure that this is as I've learned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2869" target="_blank">00:47:49.000</a></span> | <span class="t">And what we're going to do is we're going to pass in a target image, in this case our content image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2874" target="_blank">00:47:54.000</a></span> | <span class="t">And we're going to calculate those features in those target layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2880" target="_blank">00:48:00.000</a></span> | <span class="t">And then in the forward method when we're comparing to our inputs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2890" target="_blank">00:48:10.000</a></span> | <span class="t">we're going to calculate the features of our inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2893" target="_blank">00:48:13.000</a></span> | <span class="t">And we're going to do the mean squared error between those and our target features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2898" target="_blank">00:48:18.000</a></span> | <span class="t">So maybe there's a bad way of explaining it. But the idea is that I can maybe read it back to you to make sure you understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2904" target="_blank">00:48:24.000</a></span> | <span class="t">Yeah. Good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2906" target="_blank">00:48:26.000</a></span> | <span class="t">Okay. So this is a loss function you've created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2909" target="_blank">00:48:29.000</a></span> | <span class="t">It has a done to call method, which means you can pretend that it's a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2913" target="_blank">00:48:33.000</a></span> | <span class="t">It's a callable in Python language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2918" target="_blank">00:48:38.000</a></span> | <span class="t">Your forward, so yeah, any module would call it forward, but in normal Python, we just use done to call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2926" target="_blank">00:48:46.000</a></span> | <span class="t">It's taking one input, which is the way you set up your image training callback earlier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2935" target="_blank">00:48:55.000</a></span> | <span class="t">It's just going to pass in the input, which is this is the image as it's been optimized to so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2940" target="_blank">00:49:00.000</a></span> | <span class="t">So initially it's going to be that random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2943" target="_blank">00:49:03.000</a></span> | <span class="t">And then the loss you're calculating is the mean squared error of how far away is this input image from the target image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2957" target="_blank">00:49:17.000</a></span> | <span class="t">the mean squared error for each of the layers by default 18 and 25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2966" target="_blank">00:49:26.000</a></span> | <span class="t">And so you're literally actually it's a bit weird. You're actually calling a different neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2973" target="_blank">00:49:33.000</a></span> | <span class="t">Tap features actually call the neural network, but not because that's the model we're optimizing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2978" target="_blank">00:49:38.000</a></span> | <span class="t">but because it's actually the loss function is how far away are we.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2986" target="_blank">00:49:46.000</a></span> | <span class="t">Yeah. So that's the last reaction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2988" target="_blank">00:49:48.000</a></span> | <span class="t">And so if we with SGD optimize that loss function, you're not going to get the same pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2996" target="_blank">00:49:56.000</a></span> | <span class="t">You're going to get I don't even know what this is going to look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=2999" target="_blank">00:49:59.000</a></span> | <span class="t">You're going to get some pixels which have the same activations of those features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3007" target="_blank">00:50:07.000</a></span> | <span class="t">Yeah. And so if we run that, we see you can see the sort of shape of our person there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3013" target="_blank">00:50:13.000</a></span> | <span class="t">but it definitely doesn't match on like a color and style basis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3020" target="_blank">00:50:20.000</a></span> | <span class="t">So 18 and 25 remind us how deep they are in the scheme of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3026" target="_blank">00:50:26.000</a></span> | <span class="t">So these are fairly close towards the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3029" target="_blank">00:50:29.000</a></span> | <span class="t">OK. So I guess color often doesn't have much of a semantic kind of property.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3035" target="_blank">00:50:35.000</a></span> | <span class="t">So that's probably why it doesn't care much about color because it's still going to be an eyeball,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3039" target="_blank">00:50:39.000</a></span> | <span class="t">whether it's green or blue or brown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3043" target="_blank">00:50:43.000</a></span> | <span class="t">Yeah. There's something else I should mention, which is we aren't constraining our tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3050" target="_blank">00:50:50.000</a></span> | <span class="t">that we're optimizing to be in the same bounds as a normal image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3054" target="_blank">00:50:54.000</a></span> | <span class="t">And so some of these will also be less than zero or greater than one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3058" target="_blank">00:50:58.000</a></span> | <span class="t">as kind of like almost hacking the neural network to get the same features at those deep layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3063" target="_blank">00:51:03.000</a></span> | <span class="t">by passing in something that it's never seen during training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3066" target="_blank">00:51:06.000</a></span> | <span class="t">And so for display, we're clipping it to the same bounds as an image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3069" target="_blank">00:51:09.000</a></span> | <span class="t">but you might want to have either some sort of sigmoid function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3072" target="_blank">00:51:12.000</a></span> | <span class="t">or some other way that you'd clamp your tensor model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3076" target="_blank">00:51:16.000</a></span> | <span class="t">and to have outputs that are like within the allowed range for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3080" target="_blank">00:51:20.000</a></span> | <span class="t">Oh, good point. Also, it's interesting to note the background hasn't changed much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3085" target="_blank">00:51:25.000</a></span> | <span class="t">And I guess the reason for that would be that the VGG model you were using in the lost function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3089" target="_blank">00:51:29.000</a></span> | <span class="t">was trained on ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3091" target="_blank">00:51:31.000</a></span> | <span class="t">And ImageNet is specifically about recognizing generally as a single big object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3097" target="_blank">00:51:37.000</a></span> | <span class="t">like a dog or a boat or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3100" target="_blank">00:51:40.000</a></span> | <span class="t">So it's not going to care about the background,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3103" target="_blank">00:51:43.000</a></span> | <span class="t">and the background probably isn't going to have much in the way of features at all,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3107" target="_blank">00:51:47.000</a></span> | <span class="t">which is why it hasn't really changed the background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3112" target="_blank">00:51:52.000</a></span> | <span class="t">Yeah, exactly. And so, I mean, this is kind of interesting to see how little it looks like the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3117" target="_blank">00:51:57.000</a></span> | <span class="t">while at the same time still being like, if you squint, you can recognize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3121" target="_blank">00:52:01.000</a></span> | <span class="t">But we can also try passing in earlier layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3126" target="_blank">00:52:06.000</a></span> | <span class="t">and comparing on those earlier layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3128" target="_blank">00:52:08.000</a></span> | <span class="t">and see that we get a completely different result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3130" target="_blank">00:52:10.000</a></span> | <span class="t">because now we're optimizing to some image that is a lot closer to the original.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3137" target="_blank">00:52:17.000</a></span> | <span class="t">It still doesn't look exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3139" target="_blank">00:52:19.000</a></span> | <span class="t">And so there's a few things that I thought were worth noting,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3141" target="_blank">00:52:21.000</a></span> | <span class="t">just potentially of interest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3143" target="_blank">00:52:23.000</a></span> | <span class="t">One is that we're looking into these ready layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3147" target="_blank">00:52:27.000</a></span> | <span class="t">which might mean, for example, that if you're looking at the very early layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3151" target="_blank">00:52:31.000</a></span> | <span class="t">you're missing out on some kinds of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3153" target="_blank">00:52:33.000</a></span> | <span class="t">That was one of my guesses as to why this didn't have as dark a darks as the input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3159" target="_blank">00:52:39.000</a></span> | <span class="t">And then also we still have this thing where we might be going out of bounds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3163" target="_blank">00:52:43.000</a></span> | <span class="t">to get the same kinds of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3165" target="_blank">00:52:45.000</a></span> | <span class="t">So yeah, you can see how by looking at really deep layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3168" target="_blank">00:52:48.000</a></span> | <span class="t">we really don't care about the color or texture at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3170" target="_blank">00:52:50.000</a></span> | <span class="t">We're just getting some glossy bits and nosy bits there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3174" target="_blank">00:52:54.000</a></span> | <span class="t">And by looking at the earlier layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3176" target="_blank">00:52:56.000</a></span> | <span class="t">we have much more rigid adherence to the lower-level features as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3181" target="_blank">00:53:01.000</a></span> | <span class="t">And so this is nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3182" target="_blank">00:53:02.000</a></span> | <span class="t">It gives you a very tunable way to compare two images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3185" target="_blank">00:53:05.000</a></span> | <span class="t">You can say, do I care that they match exactly on pixels?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3188" target="_blank">00:53:08.000</a></span> | <span class="t">I could use mean to get error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3189" target="_blank">00:53:09.000</a></span> | <span class="t">But do I care quite a lot about the exact match?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3192" target="_blank">00:53:12.000</a></span> | <span class="t">Then I can use maybe some early layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3194" target="_blank">00:53:14.000</a></span> | <span class="t">But do I only care about the overall semantics?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3197" target="_blank">00:53:17.000</a></span> | <span class="t">In that case, I can go to some deeper layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3199" target="_blank">00:53:19.000</a></span> | <span class="t">And you can experiment with--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3201" target="_blank">00:53:21.000</a></span> | <span class="t">If I remember correctly, this is also something like the kind of technique</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3205" target="_blank">00:53:25.000</a></span> | <span class="t">that Zyler and Fergus and the Distill.pub papers used to just identify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3210" target="_blank">00:53:30.000</a></span> | <span class="t">what do filters look at, which is you can optimize an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3214" target="_blank">00:53:34.000</a></span> | <span class="t">to try and maximize a particular filter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3217" target="_blank">00:53:37.000</a></span> | <span class="t">For example, that would be a similar loss function to the one you've built here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3220" target="_blank">00:53:40.000</a></span> | <span class="t">And that would show you what they're looking at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3225" target="_blank">00:53:45.000</a></span> | <span class="t">Yeah, and that would be a really fun little project, actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3227" target="_blank">00:53:47.000</a></span> | <span class="t">So do it where you calculate these feature maps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3230" target="_blank">00:53:50.000</a></span> | <span class="t">and then just pick one of those 512 features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3235" target="_blank">00:53:55.000</a></span> | <span class="t">and optimize the image to maximize that activation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3240" target="_blank">00:54:00.000</a></span> | <span class="t">By default, you might get quite a noisy, weird result,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3243" target="_blank">00:54:03.000</a></span> | <span class="t">like almost an adversarial input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3245" target="_blank">00:54:05.000</a></span> | <span class="t">And so what these feature visualization people do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3247" target="_blank">00:54:07.000</a></span> | <span class="t">is they add things like augmentations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3250" target="_blank">00:54:10.000</a></span> | <span class="t">so that you're optimizing an image that even under some augmentations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3253" target="_blank">00:54:13.000</a></span> | <span class="t">still activates that feature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3256" target="_blank">00:54:16.000</a></span> | <span class="t">But yeah, that might be a good one to play with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3259" target="_blank">00:54:19.000</a></span> | <span class="t">Cool, OK. So we have a lot of our infrastructure in place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3262" target="_blank">00:54:22.000</a></span> | <span class="t">We know how to optimize an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3264" target="_blank">00:54:24.000</a></span> | <span class="t">We know how to extract features from this neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3266" target="_blank">00:54:26.000</a></span> | <span class="t">And we're saying this is great for comparing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3268" target="_blank">00:54:28.000</a></span> | <span class="t">at these different types of feature, how similar two images are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3273" target="_blank">00:54:33.000</a></span> | <span class="t">The final piece that we need for our full style transfer artistic application</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3278" target="_blank">00:54:38.000</a></span> | <span class="t">is to say I'd like to keep the structure of this image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3281" target="_blank">00:54:41.000</a></span> | <span class="t">but I'd like to have the style come from a different image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3284" target="_blank">00:54:44.000</a></span> | <span class="t">And you might think, oh, well, that's easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3286" target="_blank">00:54:46.000</a></span> | <span class="t">We just look at the early layers, like you've shown us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3289" target="_blank">00:54:49.000</a></span> | <span class="t">But there's a problem, which is that these feature maps, by default,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3292" target="_blank">00:54:52.000</a></span> | <span class="t">we feed in our image and we get these feature maps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3295" target="_blank">00:54:55.000</a></span> | <span class="t">They have a spatial component, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3298" target="_blank">00:54:58.000</a></span> | <span class="t">We said we had a 32 by 32 by 512 feature map out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3303" target="_blank">00:55:03.000</a></span> | <span class="t">And each of those locations in that 32 by 32 grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3307" target="_blank">00:55:07.000</a></span> | <span class="t">are going to correspond to some part of the input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3310" target="_blank">00:55:10.000</a></span> | <span class="t">And so if we just said let's do mean squared error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3313" target="_blank">00:55:13.000</a></span> | <span class="t">for the activations from some early layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3315" target="_blank">00:55:15.000</a></span> | <span class="t">what we'd be saying is I want the same types of feature,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3318" target="_blank">00:55:18.000</a></span> | <span class="t">like the same style, the same textures,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3320" target="_blank">00:55:20.000</a></span> | <span class="t">and I want them in the same location, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3323" target="_blank">00:55:23.000</a></span> | <span class="t">And so we can't just get like Van Gogh brush strokes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3326" target="_blank">00:55:26.000</a></span> | <span class="t">We're going to try and have the same colors in the same place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3329" target="_blank">00:55:29.000</a></span> | <span class="t">and the same textures in the same place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3331" target="_blank">00:55:31.000</a></span> | <span class="t">And so we're going to get something that just matches our image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3334" target="_blank">00:55:34.000</a></span> | <span class="t">What we'd like is something that has the same colors and textures,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3337" target="_blank">00:55:37.000</a></span> | <span class="t">but they might be in different parts of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3339" target="_blank">00:55:39.000</a></span> | <span class="t">So we want to get rid of this spatial aspect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3343" target="_blank">00:55:43.000</a></span> | <span class="t">Just to clarify, when we're saying to it, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3346" target="_blank">00:55:46.000</a></span> | <span class="t">give it to us in the style of Van Gogh's Starry Night,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3350" target="_blank">00:55:50.000</a></span> | <span class="t">we're not saying in this part of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3354" target="_blank">00:55:54.000</a></span> | <span class="t">there should be something with this texture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3356" target="_blank">00:55:56.000</a></span> | <span class="t">but we're saying that the kinds of textures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3358" target="_blank">00:55:58.000</a></span> | <span class="t">that are used anywhere in that image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3360" target="_blank">00:56:00.000</a></span> | <span class="t">should also appear in our version,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3362" target="_blank">00:56:02.000</a></span> | <span class="t">but not necessarily in the same place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3365" target="_blank">00:56:05.000</a></span> | <span class="t">Exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3367" target="_blank">00:56:07.000</a></span> | <span class="t">And so the solution that Siler-Werksen proposed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3371" target="_blank">00:56:11.000</a></span> | <span class="t">is this thing called a Gram Matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3373" target="_blank">00:56:13.000</a></span> | <span class="t">So what we want is some measure of what kinds of styles are present</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3377" target="_blank">00:56:17.000</a></span> | <span class="t">without worrying about where they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3379" target="_blank">00:56:19.000</a></span> | <span class="t">And so there's always a trouble trying to represent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3382" target="_blank">00:56:22.000</a></span> | <span class="t">more than two-dimensional things on a 2D grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3385" target="_blank">00:56:25.000</a></span> | <span class="t">But what I've done here is I've made our feature map,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3388" target="_blank">00:56:28.000</a></span> | <span class="t">where we have our height and our width that might be 32 by 32</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3391" target="_blank">00:56:31.000</a></span> | <span class="t">and some number of features,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3392" target="_blank">00:56:32.000</a></span> | <span class="t">but instead of having those be like a third dimension,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3395" target="_blank">00:56:35.000</a></span> | <span class="t">I've just represented those features as these little colored dots.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3398" target="_blank">00:56:38.000</a></span> | <span class="t">And so what we're going to do with the Gram Matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3401" target="_blank">00:56:41.000</a></span> | <span class="t">is we're going to flatten out our spatial dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3404" target="_blank">00:56:44.000</a></span> | <span class="t">So we're going to reshape this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3405" target="_blank">00:56:45.000</a></span> | <span class="t">so that we have the width times the height</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3409" target="_blank">00:56:49.000</a></span> | <span class="t">so that like the spatial location on one axis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3411" target="_blank">00:56:51.000</a></span> | <span class="t">and the feature dimension on the other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3414" target="_blank">00:56:54.000</a></span> | <span class="t">So each of these rows is like this is the location here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3417" target="_blank">00:56:57.000</a></span> | <span class="t">There's no yellow dots, so we get a zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3419" target="_blank">00:56:59.000</a></span> | <span class="t">There's no green, so we get a zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3423" target="_blank">00:57:03.000</a></span> | <span class="t">There is a red and a blue, so we get ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3425" target="_blank">00:57:05.000</a></span> | <span class="t">So we've kind of flattened out this feature map into a 2D thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3429" target="_blank">00:57:09.000</a></span> | <span class="t">And then instead of caring about the spatial dimension at all,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3433" target="_blank">00:57:13.000</a></span> | <span class="t">all we care about is which features do we have in general,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3436" target="_blank">00:57:16.000</a></span> | <span class="t">which types of features, and do they occur with each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3440" target="_blank">00:57:20.000</a></span> | <span class="t">And so we're going to get effectively the dot products</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3443" target="_blank">00:57:23.000</a></span> | <span class="t">of this row with itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3447" target="_blank">00:57:27.000</a></span> | <span class="t">and then this row with the next row and this row with the next row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3450" target="_blank">00:57:30.000</a></span> | <span class="t">We're saying like for these feature vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3454" target="_blank">00:57:34.000</a></span> | <span class="t">how correlated are they with each other?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3457" target="_blank">00:57:37.000</a></span> | <span class="t">And so we'll see this in code just now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3459" target="_blank">00:57:39.000</a></span> | <span class="t">I think you might have said,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3463" target="_blank">00:57:43.000</a></span> | <span class="t">I might have misheard you,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3465" target="_blank">00:57:45.000</a></span> | <span class="t">but I just want to make sure I got the citation here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3469" target="_blank">00:57:49.000</a></span> | <span class="t">So this idea came from,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3471" target="_blank">00:57:51.000</a></span> | <span class="t">it was first invented in the Gattis et al paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3476" target="_blank">00:57:56.000</a></span> | <span class="t">So a neural algorithm or test of artistic style?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3480" target="_blank">00:58:00.000</a></span> | <span class="t">Yeah, I mean Gattis, that's the style transfer one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3484" target="_blank">00:58:04.000</a></span> | <span class="t">Cider in Ferguson is the feature visualization one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3486" target="_blank">00:58:06.000</a></span> | <span class="t">Yeah, sorry, I got the switch. Thanks, Jeremy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3489" target="_blank">00:58:09.000</a></span> | <span class="t">Okay, so we are ending up with this kind of like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3492" target="_blank">00:58:12.000</a></span> | <span class="t">this grand matrix, this correlation of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3495" target="_blank">00:58:15.000</a></span> | <span class="t">And the way you can read this in this example is to say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3498" target="_blank">00:58:18.000</a></span> | <span class="t">okay, there are seven reds, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3501" target="_blank">00:58:21.000</a></span> | <span class="t">Red with red, there's seven in total.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3504" target="_blank">00:58:24.000</a></span> | <span class="t">And if you go and count them, there's seven there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3506" target="_blank">00:58:26.000</a></span> | <span class="t">And then if I look at any other one in this row,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3509" target="_blank">00:58:29.000</a></span> | <span class="t">like here, there's only one red that occurs alongside a green, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3513" target="_blank">00:58:33.000</a></span> | <span class="t">This is the only location where there's one red cell and one green cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3517" target="_blank">00:58:37.000</a></span> | <span class="t">There's three reds that occur with the yellow, there, there, and there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3521" target="_blank">00:58:41.000</a></span> | <span class="t">And so this grand matrix here has no spatial component at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3525" target="_blank">00:58:45.000</a></span> | <span class="t">It's just the feature dimension by the feature dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3528" target="_blank">00:58:48.000</a></span> | <span class="t">But it has a measure of how common these features are,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3532" target="_blank">00:58:52.000</a></span> | <span class="t">like what's an uncommon one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3537" target="_blank">00:58:57.000</a></span> | <span class="t">Yeah, maybe there's only three greens in total, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3543" target="_blank">00:59:03.000</a></span> | <span class="t">And all of them occur alongside a yellow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3546" target="_blank">00:59:06.000</a></span> | <span class="t">One of them occurs alongside a red, one of them occurs alongside a blue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3549" target="_blank">00:59:09.000</a></span> | <span class="t">Yeah, so this is exactly what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3550" target="_blank">00:59:10.000</a></span> | <span class="t">This is some measure of what features are present,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3553" target="_blank">00:59:13.000</a></span> | <span class="t">where if they occur together with other features often,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3556" target="_blank">00:59:16.000</a></span> | <span class="t">that's a useful thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3558" target="_blank">00:59:18.000</a></span> | <span class="t">But it doesn't have the spatial component.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3559" target="_blank">00:59:19.000</a></span> | <span class="t">We've gotten rid of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3561" target="_blank">00:59:21.000</a></span> | <span class="t">This is the first clear explanation I've ever seen of how a grand matrix works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3568" target="_blank">00:59:28.000</a></span> | <span class="t">This is such a cool picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3571" target="_blank">00:59:31.000</a></span> | <span class="t">I also want to maybe you can open up the original paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3574" target="_blank">00:59:34.000</a></span> | <span class="t">because I'd also like to encourage people to look at the original paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3577" target="_blank">00:59:37.000</a></span> | <span class="t">because this is something we're trying to practice at this point,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3580" target="_blank">00:59:40.000</a></span> | <span class="t">is reading papers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3582" target="_blank">00:59:42.000</a></span> | <span class="t">And so hopefully you can take Jono's fantastic explanation and bring it back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3590" target="_blank">00:59:50.000</a></span> | <span class="t">to understanding the paper as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3598" target="_blank">00:59:58.000</a></span> | <span class="t">That's crazy that it's put so far down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3601" target="_blank">01:00:01.000</a></span> | <span class="t">Oh, yeah, it's a different search engine that I'm trying out that has some AI magic,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3605" target="_blank">01:00:05.000</a></span> | <span class="t">but they use Bing for their actual searching, which...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3608" target="_blank">01:00:08.000</a></span> | <span class="t">Right, that's smart.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3610" target="_blank">01:00:10.000</a></span> | <span class="t">List, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3612" target="_blank">01:00:12.000</a></span> | <span class="t">And yeah, so we can quickly check the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3615" target="_blank">01:00:15.000</a></span> | <span class="t">I don't know if I've actually read this paper as horrific as that sounds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3618" target="_blank">01:00:18.000</a></span> | <span class="t">Not horrific at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3620" target="_blank">01:00:20.000</a></span> | <span class="t">It was a while ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3622" target="_blank">01:00:22.000</a></span> | <span class="t">But I think it's got some nice pictures, and I'm going to zoom in a bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3628" target="_blank">01:00:28.000</a></span> | <span class="t">Oh, good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3631" target="_blank">01:00:31.000</a></span> | <span class="t">Okay, there are the examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3633" target="_blank">01:00:33.000</a></span> | <span class="t">It's great examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3635" target="_blank">01:00:35.000</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3636" target="_blank">01:00:36.000</a></span> | <span class="t">Love for Kandinsky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3639" target="_blank">01:00:39.000</a></span> | <span class="t">Sorry about the doorbell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3644" target="_blank">01:00:44.000</a></span> | <span class="t">Okay, yeah, ground matrix, inner product between the vectorized feature map.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3648" target="_blank">01:00:48.000</a></span> | <span class="t">And so those kinds of wordings kind of put me off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3651" target="_blank">01:00:51.000</a></span> | <span class="t">For a while, the way I explained ground matrices when I had to deal with them at all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3654" target="_blank">01:00:54.000</a></span> | <span class="t">was to say it's magic that measures what features are there without worrying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3658" target="_blank">01:00:58.000</a></span> | <span class="t">about where they are, and lifted at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3662" target="_blank">01:01:02.000</a></span> | <span class="t">But it is worth trying to decode this back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3665" target="_blank">01:01:05.000</a></span> | <span class="t">They talk about which layers they're looking into.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3667" target="_blank">01:01:07.000</a></span> | <span class="t">I think in TensorFlow, they have names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3669" target="_blank">01:01:09.000</a></span> | <span class="t">We're just using the index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3672" target="_blank">01:01:12.000</a></span> | <span class="t">Okay, yeah, so it doesn't really explain how the ground matrix works,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3675" target="_blank">01:01:15.000</a></span> | <span class="t">but it's something that people use historically in some other contexts as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3680" target="_blank">01:01:20.000</a></span> | <span class="t">for the same kind of measure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3682" target="_blank">01:01:22.000</a></span> | <span class="t">Nowadays, actually PyTorch has named parameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3687" target="_blank">01:01:27.000</a></span> | <span class="t">and I don't know if they've updated VGG yet,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3689" target="_blank">01:01:29.000</a></span> | <span class="t">but you can name layers of a sequential model as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3695" target="_blank">01:01:35.000</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3697" target="_blank">01:01:37.000</a></span> | <span class="t">Okay, so just quickly, I wanted to implement this diagram in code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3701" target="_blank">01:01:41.000</a></span> | <span class="t">I should mention these are like zero or one for simplicity,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3704" target="_blank">01:01:44.000</a></span> | <span class="t">but you could have obviously different size activations and things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3707" target="_blank">01:01:47.000</a></span> | <span class="t">The correlation idea is still going to be there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3710" target="_blank">01:01:50.000</a></span> | <span class="t">just not as easy to represent visually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3712" target="_blank">01:01:52.000</a></span> | <span class="t">And so we're going to do it with an ironsome</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3714" target="_blank">01:01:54.000</a></span> | <span class="t">because it makes it easy to add later the bash dimension and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3719" target="_blank">01:01:59.000</a></span> | <span class="t">But I wanted to also highlight that this is just this matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3722" target="_blank">01:02:02.000</a></span> | <span class="t">multiplied with its own transpose, and you're going to get the same result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3727" target="_blank">01:02:07.000</a></span> | <span class="t">So, yeah, that's our ground matrix calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3731" target="_blank">01:02:11.000</a></span> | <span class="t">There's no magic involved there as much as it might seem like it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3735" target="_blank">01:02:15.000</a></span> | <span class="t">And so we can now use this, like can we create this measure and then...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3739" target="_blank">01:02:19.000</a></span> | <span class="t">When you look later at things like Word2Vec,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3742" target="_blank">01:02:22.000</a></span> | <span class="t">I think it's got some similarities, this idea of kind of co-occurrence of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3745" target="_blank">01:02:25.000</a></span> | <span class="t">And it also reminds me of the clip loss similar idea of like basically a dot product,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3754" target="_blank">01:02:34.000</a></span> | <span class="t">but in this case with itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3755" target="_blank">01:02:35.000</a></span> | <span class="t">I mean, we've seen how covariance is basically that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3760" target="_blank">01:02:40.000</a></span> | <span class="t">So this idea of kind of like multiplying with your own transpose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3763" target="_blank">01:02:43.000</a></span> | <span class="t">is a really common mathematical technique.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3766" target="_blank">01:02:46.000</a></span> | <span class="t">We've come across three or four times a ring in this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3771" target="_blank">01:02:51.000</a></span> | <span class="t">Yeah. And it comes up all over the place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3773" target="_blank">01:02:53.000</a></span> | <span class="t">Even, yeah, you'll see that in like protein folding stuff as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3779" target="_blank">01:02:59.000</a></span> | <span class="t">They have a big covariance matrix for like...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3783" target="_blank">01:03:03.000</a></span> | <span class="t">So the difference in each case is like, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3786" target="_blank">01:03:06.000</a></span> | <span class="t">the difference in each case is the matrix that we're multiplying by its own transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3789" target="_blank">01:03:09.000</a></span> | <span class="t">So for covariance, the matrix is the matrix of differences to the mean, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3795" target="_blank">01:03:15.000</a></span> | <span class="t">And yeah, in this case, the matrix is this flattened picture thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3803" target="_blank">01:03:23.000</a></span> | <span class="t">Cool. So I have here the calculate grams function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3807" target="_blank">01:03:27.000</a></span> | <span class="t">that's going to do exactly that operation we did above,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3810" target="_blank">01:03:30.000</a></span> | <span class="t">but we're going to add some scaling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3812" target="_blank">01:03:32.000</a></span> | <span class="t">And the reason we're adding the scaling is that we have this feature map</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3815" target="_blank">01:03:35.000</a></span> | <span class="t">and we might pass in images of different sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3817" target="_blank">01:03:37.000</a></span> | <span class="t">And so what this gives us is the absolute like...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3820" target="_blank">01:03:40.000</a></span> | <span class="t">You can see there's a relation to the number of spatial locations here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3824" target="_blank">01:03:44.000</a></span> | <span class="t">And so by scaling by this width times height,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3827" target="_blank">01:03:47.000</a></span> | <span class="t">we're going to get like a relative measure as opposed to like an absolute measure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3831" target="_blank">01:03:51.000</a></span> | <span class="t">It just means that the comparisons are going to be valid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3834" target="_blank">01:03:54.000</a></span> | <span class="t">even for images of different sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3836" target="_blank">01:03:56.000</a></span> | <span class="t">And so that's the only extra complexity here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3839" target="_blank">01:03:59.000</a></span> | <span class="t">but we have channels by height by width, image in,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3843" target="_blank">01:04:03.000</a></span> | <span class="t">and we're going to pass in...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3845" target="_blank">01:04:05.000</a></span> | <span class="t">Oh, sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3846" target="_blank">01:04:06.000</a></span> | <span class="t">So this is like channels being the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3849" target="_blank">01:04:09.000</a></span> | <span class="t">We're going to pass it in two versions of that, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3855" target="_blank">01:04:15.000</a></span> | <span class="t">Because it's the same image in both times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3858" target="_blank">01:04:18.000</a></span> | <span class="t">But we're going to map this down to just the features by features,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3863" target="_blank">01:04:23.000</a></span> | <span class="t">but you can't repeat variables and items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3865" target="_blank">01:04:25.000</a></span> | <span class="t">So that's why it's C and D.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3867" target="_blank">01:04:27.000</a></span> | <span class="t">And if we run this on our style image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3873" target="_blank">01:04:33.000</a></span> | <span class="t">you can see I'm targeting five different layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3876" target="_blank">01:04:36.000</a></span> | <span class="t">And for each one, the first layer has 64 features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3880" target="_blank">01:04:40.000</a></span> | <span class="t">And so we get a 64 by 64 gram matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3883" target="_blank">01:04:43.000</a></span> | <span class="t">The second one has 128 features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3885" target="_blank">01:04:45.000</a></span> | <span class="t">We can get 120 by 128 gram matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3887" target="_blank">01:04:47.000</a></span> | <span class="t">So this is doing, it seems like, what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3891" target="_blank">01:04:51.000</a></span> | <span class="t">There's a...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3892" target="_blank">01:04:52.000</a></span> | <span class="t">Because this is a list, we can use this Atrogot method, which I...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3897" target="_blank">01:04:57.000</a></span> | <span class="t">Well, actually, it's a fast call capital L, not a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3901" target="_blank">01:05:01.000</a></span> | <span class="t">Oh, sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3902" target="_blank">01:05:02.000</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3903" target="_blank">01:05:03.000</a></span> | <span class="t">A magic list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3905" target="_blank">01:05:05.000</a></span> | <span class="t">And so I like to think of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3907" target="_blank">01:05:07.000</a></span> | <span class="t">Yeah, so either works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3910" target="_blank">01:05:10.000</a></span> | <span class="t">Okay, so let's use this as a loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3912" target="_blank">01:05:12.000</a></span> | <span class="t">Just like with the content loss before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3916" target="_blank">01:05:16.000</a></span> | <span class="t">we're going to take in a target image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3918" target="_blank">01:05:18.000</a></span> | <span class="t">which is going to be our style.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3919" target="_blank">01:05:19.000</a></span> | <span class="t">We're going to calculate these gram matrices for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3921" target="_blank">01:05:21.000</a></span> | <span class="t">And then when we get in an input to our loss function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3926" target="_blank">01:05:26.000</a></span> | <span class="t">we're going to calculate the gram matrices for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3929" target="_blank">01:05:29.000</a></span> | <span class="t">and do the mean squared error between the gram matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3932" target="_blank">01:05:32.000</a></span> | <span class="t">So these are the no spatial components,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3935" target="_blank">01:05:35.000</a></span> | <span class="t">just what features are there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3937" target="_blank">01:05:37.000</a></span> | <span class="t">comparing the two to make sure that they're ideally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3939" target="_blank">01:05:39.000</a></span> | <span class="t">have the same kinds of features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3941" target="_blank">01:05:41.000</a></span> | <span class="t">and the same kinds of correlations between features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3944" target="_blank">01:05:44.000</a></span> | <span class="t">So we can set that up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3946" target="_blank">01:05:46.000</a></span> | <span class="t">We can evaluate it on my image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3948" target="_blank">01:05:48.000</a></span> | <span class="t">So our content image at the moment has quite a high loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3951" target="_blank">01:05:51.000</a></span> | <span class="t">when we compare it to our style image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3954" target="_blank">01:05:54.000</a></span> | <span class="t">And that means that the content image doesn't look anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3956" target="_blank">01:05:56.000</a></span> | <span class="t">like a spider web in terms of its textures and whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3959" target="_blank">01:05:59.000</a></span> | <span class="t">Exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3961" target="_blank">01:06:01.000</a></span> | <span class="t">So we're going to set up an optimization thing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3964" target="_blank">01:06:04.000</a></span> | <span class="t">One difference is that at the moment,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3966" target="_blank">01:06:06.000</a></span> | <span class="t">I'm starting from the content image itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3969" target="_blank">01:06:09.000</a></span> | <span class="t">rather than optimizing from random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3972" target="_blank">01:06:12.000</a></span> | <span class="t">You can choose either way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3973" target="_blank">01:06:13.000</a></span> | <span class="t">For style transfer, it's quite nice to use the content image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3976" target="_blank">01:06:16.000</a></span> | <span class="t">as a starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3978" target="_blank">01:06:18.000</a></span> | <span class="t">And so you can see at the beginning,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3979" target="_blank">01:06:19.000</a></span> | <span class="t">it just looks like our content image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3981" target="_blank">01:06:21.000</a></span> | <span class="t">But as we do more and more steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3983" target="_blank">01:06:23.000</a></span> | <span class="t">we maintain the structure because we're still using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3987" target="_blank">01:06:27.000</a></span> | <span class="t">the content loss as one component of our loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3991" target="_blank">01:06:31.000</a></span> | <span class="t">But now we also have more and more of the style</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3994" target="_blank">01:06:34.000</a></span> | <span class="t">because of the early layers, we're evaluating that style loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=3998" target="_blank">01:06:38.000</a></span> | <span class="t">And you can see this doesn't have the same layout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4001" target="_blank">01:06:41.000</a></span> | <span class="t">as our spider web, but it has the same kinds of textures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4004" target="_blank">01:06:44.000</a></span> | <span class="t">and the same types of structure there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4008" target="_blank">01:06:48.000</a></span> | <span class="t">And so we can check out the final result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4010" target="_blank">01:06:50.000</a></span> | <span class="t">And you can see it's done ostensibly what our goal is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4013" target="_blank">01:06:53.000</a></span> | <span class="t">It's taken one image and it's done it in the style of another.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4017" target="_blank">01:06:57.000</a></span> | <span class="t">And to me, this is quite satisfying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4019" target="_blank">01:06:59.000</a></span> | <span class="t">And it's actually done it in a particularly clever way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4022" target="_blank">01:07:02.000</a></span> | <span class="t">because look at her arm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4024" target="_blank">01:07:04.000</a></span> | <span class="t">Her arm has the spider web nicely laid out on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4027" target="_blank">01:07:07.000</a></span> | <span class="t">And she's almost picking it out with her fingers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4033" target="_blank">01:07:13.000</a></span> | <span class="t">And her face, which is quite important or very important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4037" target="_blank">01:07:17.000</a></span> | <span class="t">in terms of object recognition,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4040" target="_blank">01:07:20.000</a></span> | <span class="t">the model didn't want to mess with the face much at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4044" target="_blank">01:07:24.000</a></span> | <span class="t">So it's kept the spider webs away from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4047" target="_blank">01:07:27.000</a></span> | <span class="t">I think the more you look at it, the more impressive it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4051" target="_blank">01:07:31.000</a></span> | <span class="t">in how it's managed to find a way to add spider webs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4055" target="_blank">01:07:35.000</a></span> | <span class="t">without messing up the overall semantics of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4062" target="_blank">01:07:42.000</a></span> | <span class="t">Yeah, so this is really fun to play with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4066" target="_blank">01:07:46.000</a></span> | <span class="t">If you've been running the notebook with the demo images,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4068" target="_blank">01:07:48.000</a></span> | <span class="t">please right now go and find your own pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4071" target="_blank">01:07:51.000</a></span> | <span class="t">Make sure you're not stealing someone's licensed work,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4073" target="_blank">01:07:53.000</a></span> | <span class="t">but there's lots of Creative Commons images out there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4076" target="_blank">01:07:56.000</a></span> | <span class="t">And try bash them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4077" target="_blank">01:07:57.000</a></span> | <span class="t">Do it at a larger size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4079" target="_blank">01:07:59.000</a></span> | <span class="t">Get some higher resolution stylus going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4083" target="_blank">01:08:03.000</a></span> | <span class="t">And then there's so much that you can experiment with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4085" target="_blank">01:08:05.000</a></span> | <span class="t">So for example, you can change the content loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4088" target="_blank">01:08:08.000</a></span> | <span class="t">to focus on maybe an earlier layer as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4093" target="_blank">01:08:13.000</a></span> | <span class="t">You can start from a random image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4095" target="_blank">01:08:15.000</a></span> | <span class="t">instead of the content image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4097" target="_blank">01:08:17.000</a></span> | <span class="t">Or you can start from a style image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4098" target="_blank">01:08:18.000</a></span> | <span class="t">and optimize towards the content image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4100" target="_blank">01:08:20.000</a></span> | <span class="t">You can change how you scale these two components</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4103" target="_blank">01:08:23.000</a></span> | <span class="t">of the loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4104" target="_blank">01:08:24.000</a></span> | <span class="t">You can change how long you train for,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4106" target="_blank">01:08:26.000</a></span> | <span class="t">what your learning rate is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4108" target="_blank">01:08:28.000</a></span> | <span class="t">All of this is up for grabs in terms of what you can optimize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4112" target="_blank">01:08:32.000</a></span> | <span class="t">and what you can explore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4115" target="_blank">01:08:35.000</a></span> | <span class="t">And you get different results with different scalings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4118" target="_blank">01:08:38.000</a></span> | <span class="t">and different focus layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4120" target="_blank">01:08:40.000</a></span> | <span class="t">So there's a whole lot of fun experimentation to be done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4123" target="_blank">01:08:43.000</a></span> | <span class="t">in terms of finding a set of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4125" target="_blank">01:08:45.000</a></span> | <span class="t">that gives you a pleasing result for a given style content pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4129" target="_blank">01:08:49.000</a></span> | <span class="t">and for a given effect that you want on the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4133" target="_blank">01:08:53.000</a></span> | <span class="t">Yeah, on that note, I wanted to--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4135" target="_blank">01:08:55.000</a></span> | <span class="t">one of the really interesting things about this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4137" target="_blank">01:08:57.000</a></span> | <span class="t">is just how well VGG works as a network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4141" target="_blank">01:09:01.000</a></span> | <span class="t">even though it's a very old network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4143" target="_blank">01:09:03.000</a></span> | <span class="t">And I think it's also worth playing around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4145" target="_blank">01:09:05.000</a></span> | <span class="t">with other networks as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4147" target="_blank">01:09:07.000</a></span> | <span class="t">I think there's definitely some special properties of VGG</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4151" target="_blank">01:09:11.000</a></span> | <span class="t">that allow for it to do well for style transfer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4154" target="_blank">01:09:14.000</a></span> | <span class="t">And there are a few papers on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4156" target="_blank">01:09:16.000</a></span> | <span class="t">And there are also some papers that explore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4158" target="_blank">01:09:18.000</a></span> | <span class="t">how we can use maybe other networks for style transfer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4161" target="_blank">01:09:21.000</a></span> | <span class="t">that maintain maybe some of these nice properties of VGG.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4164" target="_blank">01:09:24.000</a></span> | <span class="t">So I think that could be interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4167" target="_blank">01:09:27.000</a></span> | <span class="t">to explore some of these papers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4169" target="_blank">01:09:29.000</a></span> | <span class="t">And of course, we have this very nice framework</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4171" target="_blank">01:09:31.000</a></span> | <span class="t">that allows us to easily plug and play different networks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4174" target="_blank">01:09:34.000</a></span> | <span class="t">and try that aspect out as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4177" target="_blank">01:09:37.000</a></span> | <span class="t">Yeah, and in particular, I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4180" target="_blank">01:09:40.000</a></span> | <span class="t">taking a ConvNext or a ResNet or something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4183" target="_blank">01:09:43.000</a></span> | <span class="t">and replacing its head with a VGG head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4186" target="_blank">01:09:46.000</a></span> | <span class="t">would be an interesting thing to try.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4190" target="_blank">01:09:50.000</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4192" target="_blank">01:09:52.000</a></span> | <span class="t">The niche on the experimentation version--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4194" target="_blank">01:09:54.000</a></span> | <span class="t">one of the things that when we were developing this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4196" target="_blank">01:09:56.000</a></span> | <span class="t">I said to Jeremy, was like, ah, we're doing all this work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4198" target="_blank">01:09:58.000</a></span> | <span class="t">setting up these callbacks and things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4200" target="_blank">01:10:00.000</a></span> | <span class="t">Isn't it nicer to just have like, here's my image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4202" target="_blank">01:10:02.160</a></span> | <span class="t">that I'm optimizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4203" target="_blank">01:10:03.120</a></span> | <span class="t">Set up an optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4204" target="_blank">01:10:04.580</a></span> | <span class="t">Set up my loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4205" target="_blank">01:10:05.880</a></span> | <span class="t">And do this optimization loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4207" target="_blank">01:10:07.800</a></span> | <span class="t">And the answer is that it is theoretically easier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4212" target="_blank">01:10:12.400</a></span> | <span class="t">when you just want to do this once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4214" target="_blank">01:10:14.000</a></span> | <span class="t">And that's why you see in a tutorial or something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4216" target="_blank">01:10:16.600</a></span> | <span class="t">you keep this as minimal as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4218" target="_blank">01:10:18.120</a></span> | <span class="t">You just want to show what style loss is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4220" target="_blank">01:10:20.400</a></span> | <span class="t">But as soon as you say, OK, I'd like to try this again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4224" target="_blank">01:10:24.600</a></span> | <span class="t">but adding a different layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4225" target="_blank">01:10:25.760</a></span> | <span class="t">So maybe let me do another cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4227" target="_blank">01:10:27.720</a></span> | <span class="t">And you're copying and pasting over a bunch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4230" target="_blank">01:10:30.080</a></span> | <span class="t">And then you say, oh, let me add some progress stuff, so images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4233" target="_blank">01:10:33.940</a></span> | <span class="t">It gets messy really quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4235" target="_blank">01:10:35.880</a></span> | <span class="t">As soon as you want to save images for a video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4238" target="_blank">01:10:38.640</a></span> | <span class="t">and you want to mess with the loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4240" target="_blank">01:10:40.600</a></span> | <span class="t">and you want to do some sort of annealing on your learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4243" target="_blank">01:10:43.520</a></span> | <span class="t">rate, each of these things is going to grow this loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4245" target="_blank">01:10:45.880</a></span> | <span class="t">into something messier and messier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4248" target="_blank">01:10:48.160</a></span> | <span class="t">And so I thought it was fun.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4249" target="_blank">01:10:49.360</a></span> | <span class="t">I was very quickly a convert to being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4251" target="_blank">01:10:51.360</a></span> | <span class="t">able to experiment with a completely new version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4256" target="_blank">01:10:56.160</a></span> | <span class="t">with minimal lines of code, minimal changes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4259" target="_blank">01:10:59.400</a></span> | <span class="t">and having everything in its own piece, like the image logging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4263" target="_blank">01:11:03.200</a></span> | <span class="t">Or if you wanted to make a little movie showing the progress,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4266" target="_blank">01:11:06.480</a></span> | <span class="t">that goes in a separate callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4268" target="_blank">01:11:08.200</a></span> | <span class="t">You want to tweak the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4269" target="_blank">01:11:09.480</a></span> | <span class="t">You're just tweaking one thing, but all the other infrastructure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4272" target="_blank">01:11:12.500</a></span> | <span class="t">can stay the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4274" target="_blank">01:11:14.440</a></span> | <span class="t">So that was pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4275" target="_blank">01:11:15.440</a></span> | <span class="t">I mean, this is one answer, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4280" target="_blank">01:11:20.320</a></span> | <span class="t">Use the right layer of abstraction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4283" target="_blank">01:11:23.240</a></span> | <span class="t">for what you're doing at the right time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4285" target="_blank">01:11:25.080</a></span> | <span class="t">Something I actually think that Paul do too much of when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4292" target="_blank">01:11:32.480</a></span> | <span class="t">they use the fast AI library is jumping straight into data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4296" target="_blank">01:11:36.600</a></span> | <span class="t">blocks, for example, even though they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4302" target="_blank">01:11:42.240</a></span> | <span class="t">might be working on a slightly more custom thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4304" target="_blank">01:11:44.520</a></span> | <span class="t">where there isn't a data block already written for them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4309" target="_blank">01:11:49.080</a></span> | <span class="t">And so then step one is like, oh, write a data block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4312" target="_blank">01:11:52.040</a></span> | <span class="t">That's not at all easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4313" target="_blank">01:11:53.440</a></span> | <span class="t">And you actually want to be focusing on building your model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4317" target="_blank">01:11:57.360</a></span> | <span class="t">So I say to people, I will go down a layer of abstraction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4323" target="_blank">01:12:03.400</a></span> | <span class="t">Now, I will say I don't very often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4327" target="_blank">01:12:07.000</a></span> | <span class="t">start at the very lowest level of abstraction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4328" target="_blank">01:12:08.920</a></span> | <span class="t">So something like the very last thing that you showed, Jono,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4331" target="_blank">01:12:11.380</a></span> | <span class="t">just because in my experience, I'm not good enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4335" target="_blank">01:12:15.480</a></span> | <span class="t">to do that, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4337" target="_blank">01:12:17.000</a></span> | <span class="t">And so most of the time, yeah, I'll forget zero grad,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4341" target="_blank">01:12:21.440</a></span> | <span class="t">or I'll just mess up something, especially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4344" target="_blank">01:12:24.360</a></span> | <span class="t">if I want to have it run reasonably quickly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4346" target="_blank">01:12:26.680</a></span> | <span class="t">by using like, you know, FP16, mixed precision,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4350" target="_blank">01:12:30.640</a></span> | <span class="t">or I'll be like, oh, now I've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4354" target="_blank">01:12:34.400</a></span> | <span class="t">to think about how to put a metrics in so that I can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4357" target="_blank">01:12:37.360</a></span> | <span class="t">see it's trading properly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4358" target="_blank">01:12:38.520</a></span> | <span class="t">And I always mess that up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4360" target="_blank">01:12:40.320</a></span> | <span class="t">And so I don't often go to that level,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4363" target="_blank">01:12:43.760</a></span> | <span class="t">but I do quite often start at a reasonably low level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4368" target="_blank">01:12:48.100</a></span> | <span class="t">And I think with mini AI now, we all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4371" target="_blank">01:12:51.160</a></span> | <span class="t">have this tool where we fully understand all the layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4376" target="_blank">01:12:56.280</a></span> | <span class="t">and there aren't that many.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4378" target="_blank">01:12:58.200</a></span> | <span class="t">And yeah, you could like write your own train cb or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4382" target="_blank">01:13:02.920</a></span> | <span class="t">And at least you've got something that makes sure,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4384" target="_blank">01:13:04.920</a></span> | <span class="t">for example, that, oh, OK, you remember to use torch.nograd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4387" target="_blank">01:13:07.720</a></span> | <span class="t">here, and you remember to put it in, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4390" target="_blank">01:13:10.000</a></span> | <span class="t">put it in eval mode there, but, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4393" target="_blank">01:13:13.200</a></span> | <span class="t">those things will be done correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4395" target="_blank">01:13:15.880</a></span> | <span class="t">And you'll be able to easily run a learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4397" target="_blank">01:13:17.980</a></span> | <span class="t">finder and easily have it run on CUDA or whatever device</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4402" target="_blank">01:13:22.800</a></span> | <span class="t">you're on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4403" target="_blank">01:13:23.320</a></span> | <span class="t">So I think hopefully this is a good place for people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4407" target="_blank">01:13:27.400</a></span> | <span class="t">now to have a framework that they can call their own,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4412" target="_blank">01:13:32.760</a></span> | <span class="t">you know, and use as much or as little as it makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4416" target="_blank">01:13:36.900</a></span> | <span class="t">The other nice thing is, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4418" target="_blank">01:13:38.560</a></span> | <span class="t">like there are multiple ways of doing the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4421" target="_blank">01:13:41.120</a></span> | <span class="t">And it's like, whatever way maybe works better for you,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4423" target="_blank">01:13:43.960</a></span> | <span class="t">you can implement that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4425" target="_blank">01:13:45.200</a></span> | <span class="t">Like, for example, Jonathan showed with the image opt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4428" target="_blank">01:13:48.020</a></span> | <span class="t">callback, you could implement that in different ways,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4430" target="_blank">01:13:50.600</a></span> | <span class="t">and whichever one, I guess, is easier for you to understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4435" target="_blank">01:13:55.040</a></span> | <span class="t">or easier for you to work with, you can implement it that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4438" target="_blank">01:13:58.480</a></span> | <span class="t">And yeah, Mini-AI is flexible in multiple ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4442" target="_blank">01:14:02.800</a></span> | <span class="t">So that's the especially one thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4445" target="_blank">01:14:05.640</a></span> | <span class="t">I really enjoy about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4446" target="_blank">01:14:06.980</a></span> | <span class="t">Yeah, and this is one extreme of like weirdness,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4449" target="_blank">01:14:09.320</a></span> | <span class="t">I think, which is like, John is like using Mini-AI for something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4453" target="_blank">01:14:13.120</a></span> | <span class="t">that we never really considered making it for,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4456" target="_blank">01:14:16.080</a></span> | <span class="t">which is like it's not even looping through data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4460" target="_blank">01:14:20.680</a></span> | <span class="t">It's just looping through loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4463" target="_blank">01:14:23.480</a></span> | <span class="t">So, you know, this is about as weird as it's going to get,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4465" target="_blank">01:14:25.840</a></span> | <span class="t">I guess.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4466" target="_blank">01:14:26.800</a></span> | <span class="t">Yeah, well, the next notebook is about as weird</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4468" target="_blank">01:14:28.920</a></span> | <span class="t">as it's going to get, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4470" target="_blank">01:14:30.300</a></span> | <span class="t">Oh, great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4473" target="_blank">01:14:33.160</a></span> | <span class="t">OK, so before we move on to--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4474" target="_blank">01:14:34.920</a></span> | <span class="t">what we're going to do next is use this kind of style loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4477" target="_blank">01:14:37.200</a></span> | <span class="t">in an even funkier way to train a different kind of thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4480" target="_blank">01:14:40.940</a></span> | <span class="t">But before we do that, I did want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4482" target="_blank">01:14:42.480</a></span> | <span class="t">to just call out like using these pre-trained networks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4485" target="_blank">01:14:45.040</a></span> | <span class="t">as very smart feature extractors is pretty powerful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4488" target="_blank">01:14:48.760</a></span> | <span class="t">And unlike the kind of fun, crazy example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4490" target="_blank">01:14:50.840</a></span> | <span class="t">that we're going to look at just now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4492" target="_blank">01:14:52.460</a></span> | <span class="t">they also have very valid uses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4494" target="_blank">01:14:54.040</a></span> | <span class="t">So if you're doing like a super resolution or even something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4497" target="_blank">01:14:57.480</a></span> | <span class="t">like a fusion, adding in a perceptual loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4500" target="_blank">01:15:00.560</a></span> | <span class="t">or even a style loss to your target image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4503" target="_blank">01:15:03.440</a></span> | <span class="t">it can improve things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4504" target="_blank">01:15:04.360</a></span> | <span class="t">We've played around with using perceptual loss for diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4507" target="_blank">01:15:07.520</a></span> | <span class="t">Or even during like say you want to generate an image that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4510" target="_blank">01:15:10.840</a></span> | <span class="t">matches effects in some kind of image-to-image thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4513" target="_blank">01:15:13.040</a></span> | <span class="t">with stable diffusion, maybe you have an extra guidance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4516" target="_blank">01:15:16.160</a></span> | <span class="t">function that makes sure that structurally it matches,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4518" target="_blank">01:15:18.360</a></span> | <span class="t">but maybe it texturally it doesn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4520" target="_blank">01:15:20.280</a></span> | <span class="t">Maybe you want to pass in a style image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4522" target="_blank">01:15:22.320</a></span> | <span class="t">and have that guide to the diffusion process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4524" target="_blank">01:15:24.280</a></span> | <span class="t">to be a particular style without having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4526" target="_blank">01:15:26.040</a></span> | <span class="t">to say in the style of it's a Van Gogh starry night.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4530" target="_blank">01:15:30.240</a></span> | <span class="t">And for all sorts of like image-to-image tasks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4533" target="_blank">01:15:33.960</a></span> | <span class="t">this idea of using the features from a network like VGG,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4537" target="_blank">01:15:37.720</a></span> | <span class="t">it does actually have lots of practical uses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4539" target="_blank">01:15:39.680</a></span> | <span class="t">apart from just this artistic fiddling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4544" target="_blank">01:15:44.720</a></span> | <span class="t">So speaking of artistic fiddling, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4547" target="_blank">01:15:47.080</a></span> | <span class="t">going to look at something a little bit more niche now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4549" target="_blank">01:15:49.240</a></span> | <span class="t">called neural cellular automata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4551" target="_blank">01:15:51.440</a></span> | <span class="t">And so try and spend about half an hour on this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4553" target="_blank">01:15:53.480</a></span> | <span class="t">before we move on to the next section.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4555" target="_blank">01:15:55.800</a></span> | <span class="t">And so this is off the beaten track.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4559" target="_blank">01:15:59.000</a></span> | <span class="t">It's a really fun domain of combining</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4564" target="_blank">01:16:04.120</a></span> | <span class="t">a lot of different fields, all of which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4565" target="_blank">01:16:05.760</a></span> | <span class="t">I'm quite excited about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4566" target="_blank">01:16:06.840</a></span> | <span class="t">And so you may be familiar with classic cellular automata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4571" target="_blank">01:16:11.600</a></span> | <span class="t">So if we look at Conway's Game of Life--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4573" target="_blank">01:16:13.680</a></span> | <span class="t">oops, I misspelled it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4579" target="_blank">01:16:19.240</a></span> | <span class="t">But you've probably seen this kind of classic Conway's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4584" target="_blank">01:16:24.600</a></span> | <span class="t">Game of Life.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4586" target="_blank">01:16:26.160</a></span> | <span class="t">I was still not like Edward Lively there when I was a kid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4589" target="_blank">01:16:29.040</a></span> | <span class="t">Yeah, so the idea here is that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4591" target="_blank">01:16:31.120</a></span> | <span class="t">have all of these independent cells,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4593" target="_blank">01:16:33.400</a></span> | <span class="t">and each cell can only see its neighbors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4595" target="_blank">01:16:35.840</a></span> | <span class="t">And you have some sort of update rule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4598" target="_blank">01:16:38.160</a></span> | <span class="t">that says if a cell has three neighbors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4600" target="_blank">01:16:40.560</a></span> | <span class="t">it's going to remain the same state for the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4602" target="_blank">01:16:42.760</a></span> | <span class="t">If it has only one neighbor, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4604" target="_blank">01:16:44.760</a></span> | <span class="t">going to die in the next iteration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4607" target="_blank">01:16:47.760</a></span> | <span class="t">And so this is a really cool example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4609" target="_blank">01:16:49.920</a></span> | <span class="t">of a distributed system, a self-organizing system,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4614" target="_blank">01:16:54.800</a></span> | <span class="t">where there's no global communication or anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4618" target="_blank">01:16:58.000</a></span> | <span class="t">Each cell can only look at its immediate neighbors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4620" target="_blank">01:17:00.160</a></span> | <span class="t">And typically, the rules are really small and simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4623" target="_blank">01:17:03.640</a></span> | <span class="t">And so we can use these to model these complex systems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4626" target="_blank">01:17:06.520</a></span> | <span class="t">It's very much inspired by biology,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4628" target="_blank">01:17:08.320</a></span> | <span class="t">where we actually do have huge arrangements of cells, each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4632" target="_blank">01:17:12.240</a></span> | <span class="t">of which is only seeing its neighborhood,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4633" target="_blank">01:17:13.880</a></span> | <span class="t">like sensing chemicals in the bloodstream next to it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4636" target="_blank">01:17:16.320</a></span> | <span class="t">and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4637" target="_blank">01:17:17.120</a></span> | <span class="t">And yet somehow, they're able to coordinate together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4639" target="_blank">01:17:19.720</a></span> | <span class="t">I watched a really cool Hergizak video the other day about ants.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4644" target="_blank">01:17:24.600</a></span> | <span class="t">And I didn't know this before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4645" target="_blank">01:17:25.880</a></span> | <span class="t">Maybe everybody else does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4646" target="_blank">01:17:26.960</a></span> | <span class="t">But ants, like huge ant colonies,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4649" target="_blank">01:17:29.520</a></span> | <span class="t">were organized by having little chemical signals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4653" target="_blank">01:17:33.000</a></span> | <span class="t">that the ants around can smell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4655" target="_blank">01:17:35.680</a></span> | <span class="t">And yeah, it can organize the entire massive ant colony</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4661" target="_blank">01:17:41.080</a></span> | <span class="t">just using that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4662" target="_blank">01:17:42.080</a></span> | <span class="t">I thought it was crazy, but it sounds really similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4665" target="_blank">01:17:45.360</a></span> | <span class="t">Yeah, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4667" target="_blank">01:17:47.280</a></span> | <span class="t">And you could do--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4669" target="_blank">01:17:49.880</a></span> | <span class="t">sorry, I'm doing tangent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4673" target="_blank">01:17:53.360</a></span> | <span class="t">You could do very similar things where you have--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4675" target="_blank">01:17:55.720</a></span> | <span class="t">yeah, the chemical trails being left</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4678" target="_blank">01:17:58.160</a></span> | <span class="t">are just like pixel values in some grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4680" target="_blank">01:18:00.840</a></span> | <span class="t">And your ants are just little tiny agents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4682" target="_blank">01:18:02.680</a></span> | <span class="t">that have some rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4683" target="_blank">01:18:03.920</a></span> | <span class="t">And so I should probably link this here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4685" target="_blank">01:18:05.600</a></span> | <span class="t">But this is exactly that kind of system, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4687" target="_blank">01:18:07.640</a></span> | <span class="t">Each little tiny dot, which are almost too small to see,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4690" target="_blank">01:18:10.480</a></span> | <span class="t">is leaving behind these different trails.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4692" target="_blank">01:18:12.280</a></span> | <span class="t">And then that determines the behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4694" target="_blank">01:18:14.320</a></span> | <span class="t">The difference between this and what we're going to do today</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4697" target="_blank">01:18:17.360</a></span> | <span class="t">is that--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4697" target="_blank">01:18:17.880</a></span> | <span class="t">Just to clarify, I think you've told me before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4699" target="_blank">01:18:19.760</a></span> | <span class="t">that actual slime molds kind of do this, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4702" target="_blank">01:18:22.600</a></span> | <span class="t">They're another example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4703" target="_blank">01:18:23.720</a></span> | <span class="t">Yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4704" target="_blank">01:18:24.960</a></span> | <span class="t">Yeah, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4705" target="_blank">01:18:25.960</a></span> | <span class="t">There's some limited signaling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4707" target="_blank">01:18:27.680</a></span> | <span class="t">Each one is like, oh, I'm by food.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4709" target="_blank">01:18:29.320</a></span> | <span class="t">And then after that, that signal is going to propagate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4711" target="_blank">01:18:31.680</a></span> | <span class="t">And anything that's moving is going to follow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4714" target="_blank">01:18:34.360</a></span> | <span class="t">And so yeah, if you play with this kind of simulation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4716" target="_blank">01:18:36.600</a></span> | <span class="t">you often get patterns that look exactly like emergent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4719" target="_blank">01:18:39.680</a></span> | <span class="t">patterns in nature, like ants moving to food or corals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4724" target="_blank">01:18:44.680</a></span> | <span class="t">coordinating and that sort of thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4727" target="_blank">01:18:47.120</a></span> | <span class="t">So it's a very biological field.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4730" target="_blank">01:18:50.640</a></span> | <span class="t">The difference with our cellular automata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4732" target="_blank">01:18:52.840</a></span> | <span class="t">is that there's nothing moving.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4735" target="_blank">01:18:55.200</a></span> | <span class="t">Each grid cell has its own little agent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4739" target="_blank">01:18:59.240</a></span> | <span class="t">And so there's no wandering around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4742" target="_blank">01:19:02.160</a></span> | <span class="t">It's just each individual cell looking at its neighbors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4744" target="_blank">01:19:04.320</a></span> | <span class="t">and then updating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4745" target="_blank">01:19:05.400</a></span> | <span class="t">And just to clarify, when you say agent,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4747" target="_blank">01:19:07.040</a></span> | <span class="t">that can be really simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4748" target="_blank">01:19:08.200</a></span> | <span class="t">I don't really remember, but I vaguely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4749" target="_blank">01:19:09.480</a></span> | <span class="t">remember that Conway's gain of life,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4751" target="_blank">01:19:11.120</a></span> | <span class="t">it's kind of like a single kind of if statement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4754" target="_blank">01:19:14.280</a></span> | <span class="t">It's like if there's--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4755" target="_blank">01:19:15.920</a></span> | <span class="t">I don't know, what is it, two cells around,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4757" target="_blank">01:19:17.720</a></span> | <span class="t">you get another one or something?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4759" target="_blank">01:19:19.640</a></span> | <span class="t">Yeah, yeah, if there's two or three nearby,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4761" target="_blank">01:19:21.720</a></span> | <span class="t">you stay alive in the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4763" target="_blank">01:19:23.040</a></span> | <span class="t">If you're overcrowded with four or five,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4765" target="_blank">01:19:25.000</a></span> | <span class="t">or there's no one there, you with zero or one neighbors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4767" target="_blank">01:19:27.160</a></span> | <span class="t">then you're going to die.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4768" target="_blank">01:19:28.200</a></span> | <span class="t">So it's a very, very simple rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4769" target="_blank">01:19:29.880</a></span> | <span class="t">But what we're going to do today is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4771" target="_blank">01:19:31.400</a></span> | <span class="t">replace that hard-coded if statement with a neural network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4775" target="_blank">01:19:35.880</a></span> | <span class="t">and in particular, a very small neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4779" target="_blank">01:19:39.360</a></span> | <span class="t">So I should start with the paper that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4781" target="_blank">01:19:41.480</a></span> | <span class="t">inspired me to even begin looking at this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4784" target="_blank">01:19:44.760</a></span> | <span class="t">So this is by Alexander Morvinsov and a team</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4787" target="_blank">01:19:47.760</a></span> | <span class="t">with him at Google Brain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4789" target="_blank">01:19:49.120</a></span> | <span class="t">And they built these neural cellular automata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4791" target="_blank">01:19:51.000</a></span> | <span class="t">So this is a pixel grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4793" target="_blank">01:19:53.240</a></span> | <span class="t">Every pixel is a cellular automata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4795" target="_blank">01:19:55.680</a></span> | <span class="t">that's looking at its neighbors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4797" target="_blank">01:19:57.360</a></span> | <span class="t">And they can't see the global structure at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4799" target="_blank">01:19:59.160</a></span> | <span class="t">And it starts out with a single black pixel in the middle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4801" target="_blank">01:20:01.960</a></span> | <span class="t">And if you run this simulation, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4804" target="_blank">01:20:04.160</a></span> | <span class="t">can see it builds this little lizard structure,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4806" target="_blank">01:20:06.680</a></span> | <span class="t">this little emoji.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4807" target="_blank">01:20:07.920</a></span> | <span class="t">So that's wild to me that a bunch of pixels that only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4812" target="_blank">01:20:12.000</a></span> | <span class="t">know about their neighbor can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4814" target="_blank">01:20:14.960</a></span> | <span class="t">create such a large and sophisticated image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4820" target="_blank">01:20:20.400</a></span> | <span class="t">Yeah, they can self-assemble into this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4822" target="_blank">01:20:22.520</a></span> | <span class="t">And what's more, the way that they train them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4825" target="_blank">01:20:25.120</a></span> | <span class="t">they are robust.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4826" target="_blank">01:20:26.680</a></span> | <span class="t">They're able to repair damage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4828" target="_blank">01:20:28.600</a></span> | <span class="t">And so it's not perfect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4831" target="_blank">01:20:31.120</a></span> | <span class="t">But there's no global signaling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4832" target="_blank">01:20:32.880</a></span> | <span class="t">No little agent here knows what the full picture looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4835" target="_blank">01:20:35.560</a></span> | <span class="t">It doesn't know where in the picture it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4837" target="_blank">01:20:37.560</a></span> | <span class="t">All it knows is that its neighbors have certain values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4840" target="_blank">01:20:40.480</a></span> | <span class="t">And so it's going to update itself to match those values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4844" target="_blank">01:20:44.400</a></span> | <span class="t">And so you can see after this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4845" target="_blank">01:20:45.720</a></span> | <span class="t">I mean, this does seem like something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4847" target="_blank">01:20:47.820</a></span> | <span class="t">that ought to have a lot of use in the real world with--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4854" target="_blank">01:20:54.000</a></span> | <span class="t">I don't know-- having a bunch of drones working together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4858" target="_blank">01:20:58.000</a></span> | <span class="t">when they can't contact some kind of central base.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4860" target="_blank">01:21:00.400</a></span> | <span class="t">So I'm thinking about work that some Australian folks have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4864" target="_blank">01:21:04.000</a></span> | <span class="t">been involved in, where they were doing subterranean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4867" target="_blank">01:21:07.680</a></span> | <span class="t">automated subterranean rescue operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4869" target="_blank">01:21:09.840</a></span> | <span class="t">And you literally can't communicate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4871" target="_blank">01:21:11.640</a></span> | <span class="t">through thousands of meters of rock, stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4875" target="_blank">01:21:15.800</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4876" target="_blank">01:21:16.880</a></span> | <span class="t">Yeah, so this idea of self-organizing systems,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4880" target="_blank">01:21:20.520</a></span> | <span class="t">there's a lot of promise for nanotechnology</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4883" target="_blank">01:21:23.120</a></span> | <span class="t">and things like that that can do pretty amazing things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4886" target="_blank">01:21:26.560</a></span> | <span class="t">This is the blog post that's linked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4888" target="_blank">01:21:28.440</a></span> | <span class="t">The future of artificial intelligence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4890" target="_blank">01:21:30.080</a></span> | <span class="t">is self-organizing and self-assembling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4891" target="_blank">01:21:31.820</a></span> | <span class="t">Oh, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4892" target="_blank">01:21:32.320</a></span> | <span class="t">And definitely, yeah, that's a pattern that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4895" target="_blank">01:21:35.560</a></span> | <span class="t">worked really well in nature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4897" target="_blank">01:21:37.600</a></span> | <span class="t">Lots of loosely coordinated cells coming together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4900" target="_blank">01:21:40.080</a></span> | <span class="t">and talking about deep learning is quite a miracle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4903" target="_blank">01:21:43.720</a></span> | <span class="t">And so I think, yeah, that's an interesting pattern to explore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4908" target="_blank">01:21:48.920</a></span> | <span class="t">OK, so how do we train something like this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4911" target="_blank">01:21:51.520</a></span> | <span class="t">How on earth do you set up your structure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4914" target="_blank">01:21:54.920</a></span> | <span class="t">so that you can get something that not only builds out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4917" target="_blank">01:21:57.420</a></span> | <span class="t">an image or builds out something like a texture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4919" target="_blank">01:21:59.720</a></span> | <span class="t">but then is robust and able to maintain that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4921" target="_blank">01:22:01.800</a></span> | <span class="t">and keep it going?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4924" target="_blank">01:22:04.040</a></span> | <span class="t">So the sort of base is that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4927" target="_blank">01:22:07.760</a></span> | <span class="t">going to set up a neural network with some learnable weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4931" target="_blank">01:22:11.000</a></span> | <span class="t">that's going to apply our little update rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4934" target="_blank">01:22:14.720</a></span> | <span class="t">And this is just going to be a little dense MLP.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4940" target="_blank">01:22:20.000</a></span> | <span class="t">We can get our inputs, which is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4941" target="_blank">01:22:21.560</a></span> | <span class="t">the neighborhood of the cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4944" target="_blank">01:22:24.200</a></span> | <span class="t">And they sometimes have additional channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4946" target="_blank">01:22:26.360</a></span> | <span class="t">that aren't shown that the agents can use as communication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4950" target="_blank">01:22:30.560</a></span> | <span class="t">with their neighbors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4952" target="_blank">01:22:32.760</a></span> | <span class="t">So we can set this up in code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4954" target="_blank">01:22:34.920</a></span> | <span class="t">We'll be able to get our neighbors using maybe convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4957" target="_blank">01:22:37.680</a></span> | <span class="t">or some other method, flatten those out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4960" target="_blank">01:22:40.080</a></span> | <span class="t">and feed them through a little MLP, and take our outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4963" target="_blank">01:22:43.520</a></span> | <span class="t">and use that as our updates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4964" target="_blank">01:22:44.880</a></span> | <span class="t">And just to clarify something that I missed originally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4967" target="_blank">01:22:47.220</a></span> | <span class="t">is this is not a simplified picture of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4970" target="_blank">01:22:50.480</a></span> | <span class="t">This is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4972" target="_blank">01:22:52.520</a></span> | <span class="t">It's literally three by three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4974" target="_blank">01:22:54.080</a></span> | <span class="t">You're only allowed to see the little things right next to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4977" target="_blank">01:22:57.560</a></span> | <span class="t">Or they can be in a different channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4980" target="_blank">01:23:00.800</a></span> | <span class="t">Exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4981" target="_blank">01:23:01.320</a></span> | <span class="t">And this paper has this additional step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4983" target="_blank">01:23:03.120</a></span> | <span class="t">of cells being alive or dead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4985" target="_blank">01:23:05.280</a></span> | <span class="t">But we're going to do one that doesn't even have that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4987" target="_blank">01:23:07.400</a></span> | <span class="t">So it's even simpler than this diagram.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4990" target="_blank">01:23:10.420</a></span> | <span class="t">OK, so to train this, what we could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4991" target="_blank">01:23:11.920</a></span> | <span class="t">is we could start from our initial state,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4994" target="_blank">01:23:14.200</a></span> | <span class="t">apply our network over some number of steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4996" target="_blank">01:23:16.940</a></span> | <span class="t">look at the final output and compare it to our targets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=4999" target="_blank">01:23:19.640</a></span> | <span class="t">and calculate our loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5001" target="_blank">01:23:21.080</a></span> | <span class="t">And you might think, OK, well, that's pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5003" target="_blank">01:23:23.080</a></span> | <span class="t">We can maybe do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5004" target="_blank">01:23:24.680</a></span> | <span class="t">And if you run this, you do indeed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5007" target="_blank">01:23:27.840</a></span> | <span class="t">get something that after some number of steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5010" target="_blank">01:23:30.000</a></span> | <span class="t">can learn to grow into something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5011" target="_blank">01:23:31.760</a></span> | <span class="t">looks like your target image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5014" target="_blank">01:23:34.220</a></span> | <span class="t">But there's this problem, which is that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5016" target="_blank">01:23:36.560</a></span> | <span class="t">applying some number of steps, and then you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5018" target="_blank">01:23:38.720</a></span> | <span class="t">applying your loss after that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5020" target="_blank">01:23:40.840</a></span> | <span class="t">But that doesn't guarantee that it's going to be stable--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5023" target="_blank">01:23:43.960</a></span> | <span class="t">Hubspool, I think is my phone-- stable longer term.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5027" target="_blank">01:23:47.600</a></span> | <span class="t">And so we need some additional way to say, OK,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5029" target="_blank">01:23:49.480</a></span> | <span class="t">I don't just want to grow into this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5031" target="_blank">01:23:51.600</a></span> | <span class="t">I'd like to then maintain that shape once I have it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5035" target="_blank">01:23:55.080</a></span> | <span class="t">And the solution that this paper proposes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5038" target="_blank">01:23:58.120</a></span> | <span class="t">is to have a pool of training examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5042" target="_blank">01:24:02.720</a></span> | <span class="t">And we'll see this in code just now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5044" target="_blank">01:24:04.560</a></span> | <span class="t">So the idea here is that sometimes we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5046" target="_blank">01:24:06.160</a></span> | <span class="t">start from a random state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5048" target="_blank">01:24:08.600</a></span> | <span class="t">And we'll apply some number of updates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5050" target="_blank">01:24:10.560</a></span> | <span class="t">We'll apply our loss function and update our network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5053" target="_blank">01:24:13.440</a></span> | <span class="t">And then most of the time, we'll take that final output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5056" target="_blank">01:24:16.140</a></span> | <span class="t">and we'll put it back into the pool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5058" target="_blank">01:24:18.160</a></span> | <span class="t">to be used again as a starting point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5059" target="_blank">01:24:19.720</a></span> | <span class="t">for another round of training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5062" target="_blank">01:24:22.360</a></span> | <span class="t">And so this means that the network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5063" target="_blank">01:24:23.880</a></span> | <span class="t">might see the initial state and have to produce the lizard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5067" target="_blank">01:24:27.360</a></span> | <span class="t">Or it might see a lizard that's already been produced.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5069" target="_blank">01:24:29.960</a></span> | <span class="t">And after some number of steps, it still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5071" target="_blank">01:24:31.400</a></span> | <span class="t">needs to look like that lizard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5073" target="_blank">01:24:33.000</a></span> | <span class="t">And so this is adding an additional constraint that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5075" target="_blank">01:24:35.480</a></span> | <span class="t">says even after much more steps, we'd still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5078" target="_blank">01:24:38.720</a></span> | <span class="t">like you to look like this final output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5082" target="_blank">01:24:42.160</a></span> | <span class="t">And so, yeah, it's also nice because, like I mentioned here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5086" target="_blank">01:24:46.360</a></span> | <span class="t">initially, the model ends up in various incorrect states</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5088" target="_blank">01:24:48.480</a></span> | <span class="t">that don't look like a lizard, but also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5089" target="_blank">01:24:49.800</a></span> | <span class="t">don't look like the starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5091" target="_blank">01:24:51.480</a></span> | <span class="t">And it then has to learn to correct those as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5093" target="_blank">01:24:53.840</a></span> | <span class="t">So we get this nice additional robustness</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5095" target="_blank">01:24:55.940</a></span> | <span class="t">from this in addition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5098" target="_blank">01:24:58.160</a></span> | <span class="t">And you can see here, now they have a thing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5100" target="_blank">01:25:00.120</a></span> | <span class="t">is able to grow into the lizard and then maintain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5103" target="_blank">01:25:03.240</a></span> | <span class="t">that structure indefinitely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5106" target="_blank">01:25:06.600</a></span> | <span class="t">And in this paper, they do this final step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5108" target="_blank">01:25:08.380</a></span> | <span class="t">where they sometimes chop off half of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5112" target="_blank">01:25:12.240</a></span> | <span class="t">as additional augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5114" target="_blank">01:25:14.120</a></span> | <span class="t">So you could have a bunch of drones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5116" target="_blank">01:25:16.200</a></span> | <span class="t">or something that can only see the ones nearby.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5120" target="_blank">01:25:20.200</a></span> | <span class="t">And they don't have GPS or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5122" target="_blank">01:25:22.200</a></span> | <span class="t">And a gust of wind could come along and set them off path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5126" target="_blank">01:25:26.360</a></span> | <span class="t">And they still reconfigure themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5129" target="_blank">01:25:29.420</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5129" target="_blank">01:25:29.920</a></span> | <span class="t">Yeah, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5130" target="_blank">01:25:30.460</a></span> | <span class="t">Half of them go offline and run out of battery.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5132" target="_blank">01:25:32.380</a></span> | <span class="t">That's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5134" target="_blank">01:25:34.080</a></span> | <span class="t">So very, very cool paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5135" target="_blank">01:25:35.740</a></span> | <span class="t">But you can see this kind of training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5137" target="_blank">01:25:37.360</a></span> | <span class="t">is a little bit more complicated than we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5140" target="_blank">01:25:40.000</a></span> | <span class="t">have a network and some target outputs and we optimize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5143" target="_blank">01:25:43.680</a></span> | <span class="t">So we're not going to follow that paper exactly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5145" target="_blank">01:25:45.600</a></span> | <span class="t">although it should be fairly easy to tweak what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5148" target="_blank">01:25:48.200</a></span> | <span class="t">we have to match that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5149" target="_blank">01:25:49.800</a></span> | <span class="t">We're instead going to go for a slightly different one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5153" target="_blank">01:25:53.320</a></span> | <span class="t">by the same authors where they train even smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5156" target="_blank">01:25:56.440</a></span> | <span class="t">networks to match textures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5158" target="_blank">01:25:58.480</a></span> | <span class="t">And so you can imagine our style loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5160" target="_blank">01:26:00.080</a></span> | <span class="t">is going to come in useful here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5161" target="_blank">01:26:01.600</a></span> | <span class="t">We'd like to produce a texture without necessarily worrying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5164" target="_blank">01:26:04.160</a></span> | <span class="t">about the overall structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5166" target="_blank">01:26:06.160</a></span> | <span class="t">We just want the style.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5168" target="_blank">01:26:08.680</a></span> | <span class="t">And so the same sort of idea, the same sort of training,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5171" target="_blank">01:26:11.480</a></span> | <span class="t">we're going to start from random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5172" target="_blank">01:26:12.900</a></span> | <span class="t">And then after some of our steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5174" target="_blank">01:26:14.400</a></span> | <span class="t">we'd like it to look like our target style image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5177" target="_blank">01:26:17.200</a></span> | <span class="t">And in fact, there she's a spider whip,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5178" target="_blank">01:26:18.840</a></span> | <span class="t">which I hadn't noticed until now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5181" target="_blank">01:26:21.000</a></span> | <span class="t">And something that makes a texture a texture in this case,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5183" target="_blank">01:26:23.480</a></span> | <span class="t">is it something you can tile nicely?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5186" target="_blank">01:26:26.400</a></span> | <span class="t">Is that--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5187" target="_blank">01:26:27.240</a></span> | <span class="t">Yes, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5188" target="_blank">01:26:28.520</a></span> | <span class="t">And so that tiling is going to come almost for free.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5190" target="_blank">01:26:30.800</a></span> | <span class="t">So we're going to have our input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5191" target="_blank">01:26:31.840</a></span> | <span class="t">We're going to look at our neighbors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5193" target="_blank">01:26:33.280</a></span> | <span class="t">We're going to feed that through a network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5194" target="_blank">01:26:34.440</a></span> | <span class="t">and produce an output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5195" target="_blank">01:26:35.800</a></span> | <span class="t">And every cell is going to do the same rule, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5198" target="_blank">01:26:38.960</a></span> | <span class="t">will work fine by default if we set this up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5201" target="_blank">01:26:41.760</a></span> | <span class="t">without thinking about tiling at all,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5204" target="_blank">01:26:44.080</a></span> | <span class="t">except that at the edges, when we do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5206" target="_blank">01:26:46.480</a></span> | <span class="t">like, say, a convolution to get our neighbors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5208" target="_blank">01:26:48.240</a></span> | <span class="t">we need to think about what happens for the neighbors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5210" target="_blank">01:26:50.960</a></span> | <span class="t">of the cells on the edge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5212" target="_blank">01:26:52.300</a></span> | <span class="t">Which ones should those be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5213" target="_blank">01:26:53.720</a></span> | <span class="t">And by default, those will just be padding of 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5215" target="_blank">01:26:55.920</a></span> | <span class="t">And so those cells on the edge, A,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5217" target="_blank">01:26:57.640</a></span> | <span class="t">they'll know they're on the edge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5219" target="_blank">01:26:59.300</a></span> | <span class="t">And B, they won't necessarily have any communication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5222" target="_blank">01:27:02.120</a></span> | <span class="t">with the other side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5223" target="_blank">01:27:03.440</a></span> | <span class="t">If we want this to tile, what we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5225" target="_blank">01:27:05.320</a></span> | <span class="t">is we're going to set our padding mode to circular.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5228" target="_blank">01:27:08.280</a></span> | <span class="t">Or in other words, the neighbors of this top right cell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5230" target="_blank">01:27:10.560</a></span> | <span class="t">are going to be these cells next to it here and these cells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5233" target="_blank">01:27:13.400</a></span> | <span class="t">down in the bottom corner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5234" target="_blank">01:27:14.920</a></span> | <span class="t">And then for free, we're going to get tiling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5239" target="_blank">01:27:19.040</a></span> | <span class="t">So enough waffle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5240" target="_blank">01:27:20.320</a></span> | <span class="t">Let's get into code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5242" target="_blank">01:27:22.280</a></span> | <span class="t">We're going to download our style image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5244" target="_blank">01:27:24.200</a></span> | <span class="t">Oops, I need to do my imports.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5245" target="_blank">01:27:25.800</a></span> | <span class="t">This is going to be our target style image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5250" target="_blank">01:27:30.440</a></span> | <span class="t">And again, feel free to experiment with your own, please.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5253" target="_blank">01:27:33.280</a></span> | <span class="t">We're going to set up a style loss just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5254" target="_blank">01:27:34.940</a></span> | <span class="t">like we did in lesson 17a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5257" target="_blank">01:27:37.400</a></span> | <span class="t">The difference being that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5258" target="_blank">01:27:38.920</a></span> | <span class="t">to have a batch dimension to our inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5261" target="_blank">01:27:41.040</a></span> | <span class="t">to this calculate grams function, which I didn't do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5264" target="_blank">01:27:44.760</a></span> | <span class="t">in the style transfer example because you're always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5266" target="_blank">01:27:46.760</a></span> | <span class="t">dealing with a single image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5268" target="_blank">01:27:48.560</a></span> | <span class="t">Everything else is going to be pretty much the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5271" target="_blank">01:27:51.040</a></span> | <span class="t">So we can set up our style loss with the target image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5273" target="_blank">01:27:53.920</a></span> | <span class="t">And then we can feed in a new image, or in this case,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5276" target="_blank">01:27:56.080</a></span> | <span class="t">batch of images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5277" target="_blank">01:27:57.380</a></span> | <span class="t">And we're going to get back loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5280" target="_blank">01:28:00.120</a></span> | <span class="t">So we're setting up our evaluation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5283" target="_blank">01:28:03.620</a></span> | <span class="t">We would like, after some number of steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5285" target="_blank">01:28:05.800</a></span> | <span class="t">our output to look like a spider web.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5289" target="_blank">01:28:09.720</a></span> | <span class="t">Let's define our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5290" target="_blank">01:28:10.700</a></span> | <span class="t">And here, I'm making a very small model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5292" target="_blank">01:28:12.760</a></span> | <span class="t">with only four channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5293" target="_blank">01:28:13.960</a></span> | <span class="t">And our number of hidden neurons in the brain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5296" target="_blank">01:28:16.800</a></span> | <span class="t">is just going to be eight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5298" target="_blank">01:28:18.400</a></span> | <span class="t">You can increase these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5300" target="_blank">01:28:20.040</a></span> | <span class="t">Something I would be inclined to do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5302" target="_blank">01:28:22.000</a></span> | <span class="t">people might want to play with in style loss to target,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5305" target="_blank">01:28:25.320</a></span> | <span class="t">is you're giving all the layers the same weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5308" target="_blank">01:28:28.440</a></span> | <span class="t">A nice addition would be to have a vector of weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5313" target="_blank">01:28:33.880</a></span> | <span class="t">you could pass in and experiment with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5317" target="_blank">01:28:37.520</a></span> | <span class="t">Definitely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5319" target="_blank">01:28:39.260</a></span> | <span class="t">So the world in which these cellular automata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5321" target="_blank">01:28:41.600</a></span> | <span class="t">are going to live is going to be a grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5323" target="_blank">01:28:43.440</a></span> | <span class="t">We're going to have some number of them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5325" target="_blank">01:28:45.060</a></span> | <span class="t">if we call this function, number of channels, and the size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5328" target="_blank">01:28:48.800</a></span> | <span class="t">You could make it non-square if you cared about that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5331" target="_blank">01:28:51.920</a></span> | <span class="t">For our perception, in this little diagram here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5334" target="_blank">01:28:54.840</a></span> | <span class="t">we're going to use some hard-coded filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5338" target="_blank">01:28:58.160</a></span> | <span class="t">And you could have these be learned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5339" target="_blank">01:28:59.920</a></span> | <span class="t">There would be additional weights in the neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5342" target="_blank">01:29:02.760</a></span> | <span class="t">The reason they're hard-coded is because the people who</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5345" target="_blank">01:29:05.880</a></span> | <span class="t">are working behind this paper, they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5347" target="_blank">01:29:07.760</a></span> | <span class="t">wanted to keep the parameter counts really low.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5350" target="_blank">01:29:10.840</a></span> | <span class="t">Literally like a few hundred parameters total.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5353" target="_blank">01:29:13.360</a></span> | <span class="t">And also, they were kind of inspired by--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5354" target="_blank">01:29:14.960</a></span> | <span class="t">A few hundred.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5355" target="_blank">01:29:15.800</a></span> | <span class="t">That's crazy, because we've been--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5358" target="_blank">01:29:18.160</a></span> | <span class="t">even our little fashion feminist models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5359" target="_blank">01:29:19.760</a></span> | <span class="t">have had quite a few million parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5362" target="_blank">01:29:22.260</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5362" target="_blank">01:29:22.760</a></span> | <span class="t">So this is a totally--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5364" target="_blank">01:29:24.080</a></span> | <span class="t">So I should have mentioned, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5365" target="_blank">01:29:25.280</a></span> | <span class="t">one of the coolest things about these systems</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5367" target="_blank">01:29:27.360</a></span> | <span class="t">is they really can do a lot with very little parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5370" target="_blank">01:29:30.840</a></span> | <span class="t">And so these filters that we're just going to hard-code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5373" target="_blank">01:29:33.040</a></span> | <span class="t">are going to be the identity, just looking at itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5376" target="_blank">01:29:36.720</a></span> | <span class="t">And then a couple that are looking at gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5380" target="_blank">01:29:40.160</a></span> | <span class="t">Again, inspired by biology, where even simple cells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5382" target="_blank">01:29:42.760</a></span> | <span class="t">can sense gradients of chemical concentration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5385" target="_blank">01:29:45.680</a></span> | <span class="t">So we're going to have these filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5387" target="_blank">01:29:47.240</a></span> | <span class="t">We're going to have a way to apply these filters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5390" target="_blank">01:29:50.240</a></span> | <span class="t">individually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5390" target="_blank">01:29:50.840</a></span> | <span class="t">Just to help people understand that that first one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5393" target="_blank">01:29:53.280</a></span> | <span class="t">for example, that's a 3 by 3 that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5395" target="_blank">01:29:55.760</a></span> | <span class="t">being kind of like visually flattened out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5397" target="_blank">01:29:57.840</a></span> | <span class="t">But if you were to kind of lay it out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5399" target="_blank">01:29:59.560</a></span> | <span class="t">you could see it's a identity matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5401" target="_blank">01:30:01.760</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5405" target="_blank">01:30:05.300</a></span> | <span class="t">Anyway, so you can see these filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5406" target="_blank">01:30:06.800</a></span> | <span class="t">This one is going to sense a horizontal gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5409" target="_blank">01:30:09.960</a></span> | <span class="t">This one is going to sense a vertical gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5412" target="_blank">01:30:12.480</a></span> | <span class="t">And the final one is called a Sobel filter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5415" target="_blank">01:30:15.840</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5416" target="_blank">01:30:16.320</a></span> | <span class="t">So we've got some hard-coded filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5417" target="_blank">01:30:17.960</a></span> | <span class="t">We're going to apply them individually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5419" target="_blank">01:30:19.840</a></span> | <span class="t">to each channel of the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5421" target="_blank">01:30:21.360</a></span> | <span class="t">And rather than having a kernel that has separate weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5425" target="_blank">01:30:25.600</a></span> | <span class="t">for each channel on the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5428" target="_blank">01:30:28.640</a></span> | <span class="t">And so we can make a grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5430" target="_blank">01:30:30.360</a></span> | <span class="t">We can apply our evolution--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5432" target="_blank">01:30:32.640</a></span> | <span class="t">I didn't know circular was a padding mode before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5434" target="_blank">01:30:34.800</a></span> | <span class="t">So that just does the thing you said,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5436" target="_blank">01:30:36.320</a></span> | <span class="t">where it's basically going to circle around and kind of copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5440" target="_blank">01:30:40.960</a></span> | <span class="t">in the thing from the other side when you reach the edge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5443" target="_blank">01:30:43.440</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5444" target="_blank">01:30:44.520</a></span> | <span class="t">Yeah, and this is very useful for avoiding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5447" target="_blank">01:30:47.200</a></span> | <span class="t">issues on the edges with zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5448" target="_blank">01:30:48.480</a></span> | <span class="t">You'll see a lot of limitations just deal with the fact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5451" target="_blank">01:30:51.320</a></span> | <span class="t">that they have slightly weird pixels around the edge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5453" target="_blank">01:30:53.440</a></span> | <span class="t">and they don't really look into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5455" target="_blank">01:30:55.440</a></span> | <span class="t">So this is one way to deal with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5457" target="_blank">01:30:57.920</a></span> | <span class="t">Yeah, OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5458" target="_blank">01:30:58.440</a></span> | <span class="t">So we can make a grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5459" target="_blank">01:30:59.520</a></span> | <span class="t">We can apply our filters to get our model inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5462" target="_blank">01:31:02.800</a></span> | <span class="t">And this is going to be 16 inputs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5465" target="_blank">01:31:05.320</a></span> | <span class="t">because we have four channels and four filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5467" target="_blank">01:31:07.840</a></span> | <span class="t">16 inputs, that's going to be the input to our little brain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5470" target="_blank">01:31:10.560</a></span> | <span class="t">And we have this for every location in the grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5473" target="_blank">01:31:13.640</a></span> | <span class="t">So now, how do we implement that little neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5477" target="_blank">01:31:17.200</a></span> | <span class="t">that we saw?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5478" target="_blank">01:31:18.720</a></span> | <span class="t">The way it's shown in the diagram</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5480" target="_blank">01:31:20.160</a></span> | <span class="t">is the dense linear network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5482" target="_blank">01:31:22.720</a></span> | <span class="t">And we can set that up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5483" target="_blank">01:31:23.720</a></span> | <span class="t">We have a linear layer with number of channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5487" target="_blank">01:31:27.280</a></span> | <span class="t">by four, which is the number of filters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5488" target="_blank">01:31:28.960</a></span> | <span class="t">as its number of inputs, some hidden number of neurons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5491" target="_blank">01:31:31.720</a></span> | <span class="t">We have a relu, and then we have a second linear layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5494" target="_blank">01:31:34.880</a></span> | <span class="t">that's outputting one output per channel as the update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5499" target="_blank">01:31:39.440</a></span> | <span class="t">And so if we wanted to use this as our brain, what we'd have to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5502" target="_blank">01:31:42.000</a></span> | <span class="t">is we'd have to deal with these extra dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5506" target="_blank">01:31:46.000</a></span> | <span class="t">So we take our batch by channel by height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5508" target="_blank">01:31:48.760</a></span> | <span class="t">We're going to map the batch and the height and the width</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5511" target="_blank">01:31:51.040</a></span> | <span class="t">all to one dimension and the channels to the second dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5514" target="_blank">01:31:54.280</a></span> | <span class="t">So now we have a big grid of 16 inputs and lots of examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5518" target="_blank">01:31:58.280</a></span> | <span class="t">I know we've seen Inops to rearrange before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5521" target="_blank">01:32:01.440</a></span> | <span class="t">So let's put a bit of bookmark to come back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5524" target="_blank">01:32:04.520</a></span> | <span class="t">to teach people about that, and then maybe in the next case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5527" target="_blank">01:32:07.120</a></span> | <span class="t">Yeah, very, very useful function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5530" target="_blank">01:32:10.120</a></span> | <span class="t">But it is a little complicated, because we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5532" target="_blank">01:32:12.800</a></span> | <span class="t">have to rearrange our inputs into something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5534" target="_blank">01:32:14.560</a></span> | <span class="t">that has just 16 features, feed that through the linear layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5537" target="_blank">01:32:17.760</a></span> | <span class="t">and then rearrange the outputs back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5539" target="_blank">01:32:19.560</a></span> | <span class="t">to match the shape of our grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5542" target="_blank">01:32:22.760</a></span> | <span class="t">So you can totally do that, and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5545" target="_blank">01:32:25.080</a></span> | <span class="t">can see what parameters we have on our brain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5546" target="_blank">01:32:26.920</a></span> | <span class="t">We have an 8 by 16 inputs and 8 biases for the first layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5551" target="_blank">01:32:31.680</a></span> | <span class="t">And then we just have a 4 by 8 weight matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5555" target="_blank">01:32:35.040</a></span> | <span class="t">for the second linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5556" target="_blank">01:32:36.200</a></span> | <span class="t">And I've said bias equals false, because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5559" target="_blank">01:32:39.640</a></span> | <span class="t">having these networks propose an update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5562" target="_blank">01:32:42.360</a></span> | <span class="t">And if we want them to be stable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5563" target="_blank">01:32:43.840</a></span> | <span class="t">the update is usually going to be 0 or close to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5566" target="_blank">01:32:46.960</a></span> | <span class="t">And so there's no need for the bias,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5568" target="_blank">01:32:48.800</a></span> | <span class="t">and we want to keep the number of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5570" target="_blank">01:32:50.680</a></span> | <span class="t">as low as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5571" target="_blank">01:32:51.520</a></span> | <span class="t">That's kind of the name of the game.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5573" target="_blank">01:32:53.680</a></span> | <span class="t">And so that's why we're setting bias equals false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5576" target="_blank">01:32:56.560</a></span> | <span class="t">So this is one way to implement this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5578" target="_blank">01:32:58.520</a></span> | <span class="t">It's not particularly fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5579" target="_blank">01:32:59.760</a></span> | <span class="t">We have to do this reshaping, and then we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5581" target="_blank">01:33:01.080</a></span> | <span class="t">feeding these examples through the linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5583" target="_blank">01:33:03.680</a></span> | <span class="t">We can cheat by using convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5586" target="_blank">01:33:06.960</a></span> | <span class="t">So this might seem like, wait, but isn't this a linear layer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5591" target="_blank">01:33:11.200</a></span> | <span class="t">We're going to apply this linear network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5595" target="_blank">01:33:15.720</a></span> | <span class="t">on top of each set of inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5599" target="_blank">01:33:19.440</a></span> | <span class="t">But we can do that by having a filter size of 1,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5603" target="_blank">01:33:23.080</a></span> | <span class="t">a kernel size of 1 in our convolutional layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5605" target="_blank">01:33:25.640</a></span> | <span class="t">So I have 16 input channels in my model inputs here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5611" target="_blank">01:33:31.560</a></span> | <span class="t">And I'm going to have 8 output channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5613" target="_blank">01:33:33.880</a></span> | <span class="t">from this first convolutional layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5615" target="_blank">01:33:35.720</a></span> | <span class="t">And my kernel size is going to be 1 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5618" target="_blank">01:33:38.160</a></span> | <span class="t">And then I have ready, and then I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5619" target="_blank">01:33:39.480</a></span> | <span class="t">have another 1 by 1 convolutional layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5623" target="_blank">01:33:43.600</a></span> | <span class="t">And so we can see this gives me the right shape output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5626" target="_blank">01:33:46.000</a></span> | <span class="t">And if I look at the parameters, my first convolutional layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5629" target="_blank">01:33:49.360</a></span> | <span class="t">has 8 by 16 by 1 by 1 parameters in its filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5634" target="_blank">01:33:54.600</a></span> | <span class="t">And so maybe spend a little bit of time convincing yourself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5638" target="_blank">01:33:58.240</a></span> | <span class="t">that these two are doing the same operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5640" target="_blank">01:34:00.720</a></span> | <span class="t">Yeah, this stuff is used in cheating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5642" target="_blank">01:34:02.400</a></span> | <span class="t">I mean, this is quite elegant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5644" target="_blank">01:34:04.520</a></span> | <span class="t">And in languages like APL, actually, there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5647" target="_blank">01:34:07.760</a></span> | <span class="t">an operation called stenciling, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5649" target="_blank">01:34:09.840</a></span> | <span class="t">is basically the same idea as this idea of applying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5653" target="_blank">01:34:13.280</a></span> | <span class="t">some computation over a grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5655" target="_blank">01:34:15.640</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5656" target="_blank">01:34:16.560</a></span> | <span class="t">And I should mention that convolutions are very efficient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5659" target="_blank">01:34:19.640</a></span> | <span class="t">All of our GPUs and things are set up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5661" target="_blank">01:34:21.640</a></span> | <span class="t">for this kind of operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5663" target="_blank">01:34:23.680</a></span> | <span class="t">And what makes neural cellular automata quite exciting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5666" target="_blank">01:34:26.200</a></span> | <span class="t">is that because we're doing this convolution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5669" target="_blank">01:34:29.560</a></span> | <span class="t">you have an operation for every pixel that we're applying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5673" target="_blank">01:34:33.320</a></span> | <span class="t">There's just looking at the neighborhood</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5674" target="_blank">01:34:34.720</a></span> | <span class="t">and reducing an output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5675" target="_blank">01:34:35.720</a></span> | <span class="t">There's no global thing that we need to handle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5678" target="_blank">01:34:38.760</a></span> | <span class="t">And so this is actually exactly what GPUs were designed for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5681" target="_blank">01:34:41.960</a></span> | <span class="t">They're designed for running some operation for every pixel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5684" target="_blank">01:34:44.240</a></span> | <span class="t">on your screen to render graphics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5686" target="_blank">01:34:46.200</a></span> | <span class="t">or show you your video game or make your website</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5688" target="_blank">01:34:48.280</a></span> | <span class="t">scroll nice and slick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5690" target="_blank">01:34:50.160</a></span> | <span class="t">And so we can take advantage of that kind of built-in bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5692" target="_blank">01:34:52.840</a></span> | <span class="t">of the hardware from doing lots of little operations in parallel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5696" target="_blank">01:34:56.160</a></span> | <span class="t">to make these go really, really fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5697" target="_blank">01:34:57.960</a></span> | <span class="t">And I'll show you just now we can run these real time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5700" target="_blank">01:35:00.480</a></span> | <span class="t">in the browser, which is quite satisfying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5703" target="_blank">01:35:03.640</a></span> | <span class="t">OK, so now that we have all that infrastructure in place,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5706" target="_blank">01:35:06.000</a></span> | <span class="t">I'm just going to put it into a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5707" target="_blank">01:35:07.560</a></span> | <span class="t">My simple CA is my cellular automata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5710" target="_blank">01:35:10.120</a></span> | <span class="t">We have our little brain, two convolutional layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5712" target="_blank">01:35:12.600</a></span> | <span class="t">and a value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5714" target="_blank">01:35:14.120</a></span> | <span class="t">Optionally, we can set the weights of the second layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5716" target="_blank">01:35:16.240</a></span> | <span class="t">to zero again because we want to start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5718" target="_blank">01:35:18.120</a></span> | <span class="t">by being very conservative in terms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5719" target="_blank">01:35:19.880</a></span> | <span class="t">of what updates we produce.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5722" target="_blank">01:35:22.560</a></span> | <span class="t">Not necessarily necessary, but it does help the training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5725" target="_blank">01:35:25.720</a></span> | <span class="t">And then in our forward pass--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5727" target="_blank">01:35:27.080</a></span> | <span class="t">I would be inclined--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5728" target="_blank">01:35:28.080</a></span> | <span class="t">I don't know if it matters, but I'd be inclined to put that--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5730" target="_blank">01:35:30.600</a></span> | <span class="t">I would be inclined to do nn.init constant zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5737" target="_blank">01:35:37.680</a></span> | <span class="t">or put that in a nograd, like often initializing things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5741" target="_blank">01:35:41.840</a></span> | <span class="t">without nograd can cause problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5745" target="_blank">01:35:45.120</a></span> | <span class="t">OK, I'll look into that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5749" target="_blank">01:35:49.000</a></span> | <span class="t">In the forward method, we're going to apply our filters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5751" target="_blank">01:35:51.320</a></span> | <span class="t">to get our model inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5752" target="_blank">01:35:52.400</a></span> | <span class="t">Oh, you've got .data.zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5754" target="_blank">01:35:54.400</a></span> | <span class="t">OK, so that's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5756" target="_blank">01:35:56.600</a></span> | <span class="t">Yeah, I think this is the built-in method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5758" target="_blank">01:35:58.680</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5759" target="_blank">01:35:59.320</a></span> | <span class="t">Oh, it's the .data, which is the thing that makes it--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5761" target="_blank">01:36:01.640</a></span> | <span class="t">yeah, you don't need torch.nograd because you've got .data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5766" target="_blank">01:36:06.000</a></span> | <span class="t">Yeah, it's all good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5768" target="_blank">01:36:08.120</a></span> | <span class="t">Cool, OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5769" target="_blank">01:36:09.040</a></span> | <span class="t">And so the forward is applying the filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5771" target="_blank">01:36:11.640</a></span> | <span class="t">It's feeding it through the first convolutional layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5774" target="_blank">01:36:14.120</a></span> | <span class="t">then the ready, then the second layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5776" target="_blank">01:36:16.800</a></span> | <span class="t">And then it's doing this final step, which again goes back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5779" target="_blank">01:36:19.320</a></span> | <span class="t">to the original paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5781" target="_blank">01:36:21.720</a></span> | <span class="t">Somewhere in here, they mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5783" target="_blank">01:36:23.040</a></span> | <span class="t">that they are inspired by biology.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5786" target="_blank">01:36:26.280</a></span> | <span class="t">And one thing that you don't have in a biological system</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5788" target="_blank">01:36:28.860</a></span> | <span class="t">is some sort of global clock where everything updates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5790" target="_blank">01:36:30.900</a></span> | <span class="t">at exactly the same second.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5792" target="_blank">01:36:32.960</a></span> | <span class="t">It's much more random and organic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5794" target="_blank">01:36:34.280</a></span> | <span class="t">Each one is almost independent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5796" target="_blank">01:36:36.280</a></span> | <span class="t">And so to mirror that, what we do here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5798" target="_blank">01:36:38.760</a></span> | <span class="t">is we create a random update mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5801" target="_blank">01:36:41.320</a></span> | <span class="t">And if you go in-- let's just actually write this out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5803" target="_blank">01:36:43.440</a></span> | <span class="t">Let's just make a cell and check that this is what we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5810" target="_blank">01:36:50.360</a></span> | <span class="t">So I'm going to just go the hw1, just to visualize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5819" target="_blank">01:36:59.080</a></span> | <span class="t">Update rate-- there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5823" target="_blank">01:37:03.640</a></span> | <span class="t">Yeah, so this is creating this random mask,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5825" target="_blank">01:37:05.680</a></span> | <span class="t">some zeros and some ones, according</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5827" target="_blank">01:37:07.740</a></span> | <span class="t">to what our update rate is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5830" target="_blank">01:37:10.160</a></span> | <span class="t">And this is going to determine whether we apply this update</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5833" target="_blank">01:37:13.320</a></span> | <span class="t">to our original input or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5836" target="_blank">01:37:16.000</a></span> | <span class="t">[INTERPOSING VOICES]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5838" target="_blank">01:37:18.240</a></span> | <span class="t">Yeah, it's like dropout, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5840" target="_blank">01:37:20.580</a></span> | <span class="t">And why this is nice, if you imagine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5842" target="_blank">01:37:22.280</a></span> | <span class="t">we start from a perfectly uniform grid,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5844" target="_blank">01:37:24.440</a></span> | <span class="t">and then every cell is running the exact same rule,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5846" target="_blank">01:37:26.920</a></span> | <span class="t">after one update, we'll still have a perfectly uniform grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5849" target="_blank">01:37:29.840</a></span> | <span class="t">There's no way for there to be any randomness.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5852" target="_blank">01:37:32.000</a></span> | <span class="t">And so we can never break out of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5854" target="_blank">01:37:34.720</a></span> | <span class="t">Whereas once we add this random updates,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5856" target="_blank">01:37:36.760</a></span> | <span class="t">only a subset of cells are going to be updated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5858" target="_blank">01:37:38.720</a></span> | <span class="t">And now there's some differences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5859" target="_blank">01:37:39.760</a></span> | <span class="t">They have different neighborhoods and things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5862" target="_blank">01:37:42.120</a></span> | <span class="t">And so then we get this added randomness in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5864" target="_blank">01:37:44.600</a></span> | <span class="t">And this is very much like in a biological system,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5866" target="_blank">01:37:46.600</a></span> | <span class="t">no cell is going to be identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5869" target="_blank">01:37:49.160</a></span> | <span class="t">So that's a little bit of additional complexity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5871" target="_blank">01:37:51.240</a></span> | <span class="t">But again, inspired by nature and inspired by paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5875" target="_blank">01:37:55.680</a></span> | <span class="t">With all of this in place, we can do our training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5878" target="_blank">01:37:58.520</a></span> | <span class="t">We're going to use the same dummy data set idea as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5883" target="_blank">01:38:03.280</a></span> | <span class="t">We are going to have a progress callback, which is a lot of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5887" target="_blank">01:38:07.320</a></span> | <span class="t">But it's all just basically sitting around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5889" target="_blank">01:38:09.640</a></span> | <span class="t">for doing some plotting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5891" target="_blank">01:38:11.040</a></span> | <span class="t">And so I'm not going to spend too much time on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5893" target="_blank">01:38:13.800</a></span> | <span class="t">And then the fun stuff is going to happen in our training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5895" target="_blank">01:38:15.960</a></span> | <span class="t">callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5896" target="_blank">01:38:16.720</a></span> | <span class="t">And so now we are actually getting deep into the weeds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5899" target="_blank">01:38:19.000</a></span> | <span class="t">We're modifying our prediction function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5901" target="_blank">01:38:21.480</a></span> | <span class="t">This is much more complicated than just feeding a batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5903" target="_blank">01:38:23.680</a></span> | <span class="t">of data through our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5905" target="_blank">01:38:25.520</a></span> | <span class="t">We are setting up a pool of grids, 256 examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5911" target="_blank">01:38:31.720</a></span> | <span class="t">And these are all going to start out as just uniform zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5915" target="_blank">01:38:35.640</a></span> | <span class="t">But every time we call predicts, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5917" target="_blank">01:38:37.840</a></span> | <span class="t">going to pick some random samples from that pool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5921" target="_blank">01:38:41.960</a></span> | <span class="t">We are occasionally going to reset those samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5924" target="_blank">01:38:44.000</a></span> | <span class="t">to the initial state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5926" target="_blank">01:38:46.720</a></span> | <span class="t">And then we're going to apply the model a number of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5929" target="_blank">01:38:49.240</a></span> | <span class="t">And it's worth thinking here, if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5933" target="_blank">01:38:53.240</a></span> | <span class="t">are applying this model 50 steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5936" target="_blank">01:38:56.760</a></span> | <span class="t">this is like a 50-layer deep model all of a sudden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5939" target="_blank">01:38:59.680</a></span> | <span class="t">And so we start to get some--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5940" target="_blank">01:39:00.840</a></span> | <span class="t">Is that going to be a learn.model rather than self.learn.model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5945" target="_blank">01:39:05.240</a></span> | <span class="t">Oh, yes, because I already have learned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5948" target="_blank">01:39:08.000</a></span> | <span class="t">Nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5949" target="_blank">01:39:09.880</a></span> | <span class="t">Yeah, so we've got to just be aware</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5952" target="_blank">01:39:12.840</a></span> | <span class="t">that by applying this a large number of times,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5955" target="_blank">01:39:15.000</a></span> | <span class="t">we could get something like gradient exploding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5956" target="_blank">01:39:16.880</a></span> | <span class="t">and things like that, which we'll deal with a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5959" target="_blank">01:39:19.480</a></span> | <span class="t">later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5960" target="_blank">01:39:20.360</a></span> | <span class="t">But we apply the model a large number of steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5963" target="_blank">01:39:23.360</a></span> | <span class="t">Then we put those final outputs back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5965" target="_blank">01:39:25.520</a></span> | <span class="t">in the pool for the next round of training,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5967" target="_blank">01:39:27.760</a></span> | <span class="t">and we store our predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5968" target="_blank">01:39:28.960</a></span> | <span class="t">These are the outputs after we've applied a number of steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5972" target="_blank">01:39:32.720</a></span> | <span class="t">And in the loss, we're going to use a style loss saying,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5976" target="_blank">01:39:36.240</a></span> | <span class="t">does this match the style of my target image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5979" target="_blank">01:39:39.000</a></span> | <span class="t">And we're going to add an overflow loss that penalizes it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5981" target="_blank">01:39:41.440</a></span> | <span class="t">if the values are out of bounds, just to try and--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5983" target="_blank">01:39:43.880</a></span> | <span class="t">Take self.learn here, too.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5986" target="_blank">01:39:46.880</a></span> | <span class="t">Yes, thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5988" target="_blank">01:39:48.560</a></span> | <span class="t">I think I read this before we changed the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5990" target="_blank">01:39:50.680</a></span> | <span class="t">no, because I've got the code back there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5992" target="_blank">01:39:52.520</a></span> | <span class="t">OK, my bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5994" target="_blank">01:39:54.160</a></span> | <span class="t">One more self.learn.pred.clamp and the overflow loss one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=5998" target="_blank">01:39:58.560</a></span> | <span class="t">Yes, thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6000" target="_blank">01:40:00.320</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6001" target="_blank">01:40:01.320</a></span> | <span class="t">And yeah, so get loss is doing a style loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6005" target="_blank">01:40:05.520</a></span> | <span class="t">plus this overflow loss, just to keep things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6007" target="_blank">01:40:07.680</a></span> | <span class="t">from growing exponentially out of bounds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6009" target="_blank">01:40:09.680</a></span> | <span class="t">Again, something that's quite likely to happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6012" target="_blank">01:40:12.120</a></span> | <span class="t">when you're applying a large number of steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6014" target="_blank">01:40:14.040</a></span> | <span class="t">and so we really want to penalize that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6017" target="_blank">01:40:17.520</a></span> | <span class="t">And the final thing is in learn.backward,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6021" target="_blank">01:40:21.080</a></span> | <span class="t">I've added a technique that is probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6023" target="_blank">01:40:23.040</a></span> | <span class="t">going to be quite useful in some other places as well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6025" target="_blank">01:40:25.560</a></span> | <span class="t">called gradient normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6027" target="_blank">01:40:27.680</a></span> | <span class="t">And so we're just running through the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6029" target="_blank">01:40:29.520</a></span> | <span class="t">of our model, and we are normalizing them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6033" target="_blank">01:40:33.320</a></span> | <span class="t">And this means that even if they're really, really tiny,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6035" target="_blank">01:40:35.600</a></span> | <span class="t">really, really large at the end of that multiple number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6037" target="_blank">01:40:37.960</a></span> | <span class="t">of update steps, this is kind of a hack</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6040" target="_blank">01:40:40.640</a></span> | <span class="t">to bring this back under control.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6044" target="_blank">01:40:44.040</a></span> | <span class="t">Jeremy--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6044" target="_blank">01:40:44.540</a></span> | <span class="t">Now, let's put a bookmark to come back to that as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6047" target="_blank">01:40:47.800</a></span> | <span class="t">in more detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6049" target="_blank">01:40:49.320</a></span> | <span class="t">And I guess that before fit, maybe we don't need anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6052" target="_blank">01:40:52.920</a></span> | <span class="t">Oh, right, because this is now a default.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6056" target="_blank">01:40:56.640</a></span> | <span class="t">So I should have set this running before we started talking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6059" target="_blank">01:40:59.120</a></span> | <span class="t">It is going to take a little while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6061" target="_blank">01:41:01.400</a></span> | <span class="t">But you can see my progress callback here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6063" target="_blank">01:41:03.120</a></span> | <span class="t">is scatter plotting the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6065" target="_blank">01:41:05.920</a></span> | <span class="t">And the reason I'm-- you'll see in the callback here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6069" target="_blank">01:41:09.720</a></span> | <span class="t">I'm setting the y limits to the minimum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6076" target="_blank">01:41:16.280</a></span> | <span class="t">of the initial set of losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6077" target="_blank">01:41:17.820</a></span> | <span class="t">It's just because the overflow loss is sometimes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6079" target="_blank">01:41:19.820</a></span> | <span class="t">so much larger than the rest of the loss ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6082" target="_blank">01:41:22.880</a></span> | <span class="t">that you get this really bad scaling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6086" target="_blank">01:41:26.000</a></span> | <span class="t">So using a log scaling and clipping the bounds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6088" target="_blank">01:41:28.580</a></span> | <span class="t">tends to help just visualize what's actually important,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6090" target="_blank">01:41:30.960</a></span> | <span class="t">like the overall trend.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6092" target="_blank">01:41:32.320</a></span> | <span class="t">I guess the last--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6093" target="_blank">01:41:33.080</a></span> | <span class="t">They're not just not run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6094" target="_blank">01:41:34.080</a></span> | <span class="t">Then we can see it without you running it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6096" target="_blank">01:41:36.200</a></span> | <span class="t">Oh, right, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6097" target="_blank">01:41:37.320</a></span> | <span class="t">Yeah, so you can see the outputs here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6099" target="_blank">01:41:39.160</a></span> | <span class="t">So what I'm visualizing is the examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6101" target="_blank">01:41:41.120</a></span> | <span class="t">that we've drawn from the pool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6102" target="_blank">01:41:42.520</a></span> | <span class="t">Every time we're drawing--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6103" target="_blank">01:41:43.960</a></span> | <span class="t">in this case, I've got a fixed batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6106" target="_blank">01:41:46.040</a></span> | <span class="t">That should probably be an argument.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6108" target="_blank">01:41:48.720</a></span> | <span class="t">But you can take a look at them and kind of compare them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6110" target="_blank">01:41:50.920</a></span> | <span class="t">to the style last and see initially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6112" target="_blank">01:41:52.360</a></span> | <span class="t">that I really look too similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6114" target="_blank">01:41:54.840</a></span> | <span class="t">After some training, we get some definite webby tendencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6120" target="_blank">01:42:00.160</a></span> | <span class="t">And we can take this model and then apply it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6122" target="_blank">01:42:02.080</a></span> | <span class="t">to a random grid and log the images every 100 steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6127" target="_blank">01:42:07.600</a></span> | <span class="t">or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6128" target="_blank">01:42:08.600</a></span> | <span class="t">And you can see that starting from this random position,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6131" target="_blank">01:42:11.080</a></span> | <span class="t">it quite quickly builds this pattern.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6133" target="_blank">01:42:13.600</a></span> | <span class="t">It doesn't look perfectly spiderweby.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6136" target="_blank">01:42:16.240</a></span> | <span class="t">But in its defense, this model has 168 parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6141" target="_blank">01:42:21.440</a></span> | <span class="t">And the tiles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6142" target="_blank">01:42:22.280</a></span> | <span class="t">That to me is the magic of these models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6144" target="_blank">01:42:24.520</a></span> | <span class="t">is that even with very few parameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6146" target="_blank">01:42:26.960</a></span> | <span class="t">they're able to do something pretty impressive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6149" target="_blank">01:42:29.920</a></span> | <span class="t">And if you would like, go back up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6151" target="_blank">01:42:31.680</a></span> | <span class="t">to where we define number of channels and number of layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6155" target="_blank">01:42:35.240</a></span> | <span class="t">If you give it more channels to work with, 8 or 16,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6158" target="_blank">01:42:38.480</a></span> | <span class="t">and more hidden neurons, 32 or 64,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6162" target="_blank">01:42:42.080</a></span> | <span class="t">you still have a tiny model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6164" target="_blank">01:42:44.240</a></span> | <span class="t">But it's able to capture some much nicer--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6168" target="_blank">01:42:48.040</a></span> | <span class="t">so I would say, please, on the forums,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6169" target="_blank">01:42:49.880</a></span> | <span class="t">try some larger sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6171" target="_blank">01:42:51.480</a></span> | <span class="t">I'll also maybe post some results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6174" target="_blank">01:42:54.000</a></span> | <span class="t">And just to give you a little preview of what's possible,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6177" target="_blank">01:42:57.400</a></span> | <span class="t">so I did a project before using MiniAI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6181" target="_blank">01:43:01.640</a></span> | <span class="t">So the codes are a little messy and hacky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6185" target="_blank">01:43:05.520</a></span> | <span class="t">But what I did was I logged the cellular automata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6189" target="_blank">01:43:09.960</a></span> | <span class="t">Well, maybe I should show this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6191" target="_blank">01:43:11.320</a></span> | <span class="t">We-- this is way outside of the bounds for this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6196" target="_blank">01:43:16.720</a></span> | <span class="t">But you can write something called a fragment shader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6199" target="_blank">01:43:19.520</a></span> | <span class="t">in WebGL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6200" target="_blank">01:43:20.760</a></span> | <span class="t">So this is designed to run in the browser.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6202" target="_blank">01:43:22.920</a></span> | <span class="t">It's a little program that runs once for every pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6206" target="_blank">01:43:26.520</a></span> | <span class="t">And so you can see here, I have the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6208" target="_blank">01:43:28.160</a></span> | <span class="t">of my neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6209" target="_blank">01:43:29.720</a></span> | <span class="t">I have sampling the neighborhood of each cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6213" target="_blank">01:43:33.560</a></span> | <span class="t">We have our filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6215" target="_blank">01:43:35.000</a></span> | <span class="t">We have our activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6216" target="_blank">01:43:36.960</a></span> | <span class="t">This is in a language called GLSL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6219" target="_blank">01:43:39.560</a></span> | <span class="t">We're running through the layers of our network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6221" target="_blank">01:43:41.480</a></span> | <span class="t">and proposing our updates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6224" target="_blank">01:43:44.000</a></span> | <span class="t">And this one here, I just had more--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6227" target="_blank">01:43:47.240</a></span> | <span class="t">I think more hidden neurons, more channels--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6229" target="_blank">01:43:49.880</a></span> | <span class="t">and optimized with a slightly different loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6232" target="_blank">01:43:52.000</a></span> | <span class="t">So it was a style loss plus clip to the prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6234" target="_blank">01:43:54.640</a></span> | <span class="t">I think, dragon scales or glowing dragon scales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6237" target="_blank">01:43:57.920</a></span> | <span class="t">And you can see this is running in real time or near real time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6240" target="_blank">01:44:00.720</a></span> | <span class="t">because I'm recording.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6242" target="_blank">01:44:02.800</a></span> | <span class="t">And it's interactive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6243" target="_blank">01:44:03.720</a></span> | <span class="t">So you can click to zero out the grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6246" target="_blank">01:44:06.040</a></span> | <span class="t">and then see it rebuild within that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6248" target="_blank">01:44:08.840</a></span> | <span class="t">And so in a similar way, in this weights and biases report,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6251" target="_blank">01:44:11.200</a></span> | <span class="t">I'm logging these interactive HTML previews.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6254" target="_blank">01:44:14.120</a></span> | <span class="t">We've got some videos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6257" target="_blank">01:44:17.000</a></span> | <span class="t">And just logging the grids from the different things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6261" target="_blank">01:44:21.440</a></span> | <span class="t">And so you can see these are still pretty small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6263" target="_blank">01:44:23.680</a></span> | <span class="t">as far as these networks go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6265" target="_blank">01:44:25.040</a></span> | <span class="t">I think they only have four channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6266" target="_blank">01:44:26.520</a></span> | <span class="t">because I'm working with RGBA shaders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6271" target="_blank">01:44:31.120</a></span> | <span class="t">But quite fun to see what you can do with these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6273" target="_blank">01:44:33.560</a></span> | <span class="t">And if you pick the right style images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6275" target="_blank">01:44:35.280</a></span> | <span class="t">and train for a bit longer and use a few more channels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6278" target="_blank">01:44:38.080</a></span> | <span class="t">you can do some really fun stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6279" target="_blank">01:44:39.520</a></span> | <span class="t">And you can get really creative applying them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6281" target="_blank">01:44:41.320</a></span> | <span class="t">at different scales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6282" target="_blank">01:44:42.120</a></span> | <span class="t">Or I did some messing around with video, which, again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6287" target="_blank">01:44:47.040</a></span> | <span class="t">is just like messing with the inputs to different cells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6289" target="_blank">01:44:49.920</a></span> | <span class="t">to try and get some cool patterns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6292" target="_blank">01:44:52.040</a></span> | <span class="t">So yeah, to me, this is a really exciting, fun--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6295" target="_blank">01:44:55.760</a></span> | <span class="t">amazing niche.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6297" target="_blank">01:44:57.640</a></span> | <span class="t">Yeah, I don't know if there's too many practical applications</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6300" target="_blank">01:45:00.100</a></span> | <span class="t">at this stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6300" target="_blank">01:45:00.640</a></span> | <span class="t">But I'm already thinking of denoising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6303" target="_blank">01:45:03.000</a></span> | <span class="t">cellular automata and stylizing or image restoration</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6306" target="_blank">01:45:06.760</a></span> | <span class="t">cellular automata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6307" target="_blank">01:45:07.840</a></span> | <span class="t">And you can really have a lot of fun with this structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6310" target="_blank">01:45:10.880</a></span> | <span class="t">And I also thought it was just a good demo of how far can we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6314" target="_blank">01:45:14.240</a></span> | <span class="t">push what you can do with the training callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6317" target="_blank">01:45:17.000</a></span> | <span class="t">to have this pool training and the gradient normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6321" target="_blank">01:45:21.640</a></span> | <span class="t">and all these extra things added in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6324" target="_blank">01:45:24.160</a></span> | <span class="t">Very, very different from here's a batch of images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6326" target="_blank">01:45:26.440</a></span> | <span class="t">and a batch of labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6327" target="_blank">01:45:27.680</a></span> | <span class="t">So I hope you found that interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6329" target="_blank">01:45:29.080</a></span> | <span class="t">And I'll stop sharing my screen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6330" target="_blank">01:45:30.360</a></span> | <span class="t">And then, Jeremy, if you have any questions or follow-ups?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6333" target="_blank">01:45:33.640</a></span> | <span class="t">No, that's amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6335" target="_blank">01:45:35.120</a></span> | <span class="t">Thank you so much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6335" target="_blank">01:45:35.960</a></span> | <span class="t">I actually have to go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PdNHkTLU2oQ&t=6337" target="_blank">01:45:37.160</a></span> | <span class="t">But that's just one of the coolest things I've seen.</span></div></div></body></html>