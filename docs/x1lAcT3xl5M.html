<html><head><title>Training BERT #4 - Train With Next Sentence Prediction (NSP)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Training BERT #4 - Train With Next Sentence Prediction (NSP)</h2><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M"><img src="https://i.ytimg.com/vi/x1lAcT3xl5M/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1269">21:9</a> Set Up the Input Pipeline for Training<br><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1317">21:57</a> Initialization Method<br><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1632">27:12</a> Initialize Our Data Loader<br><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1678">27:58</a> Model Training Parameters<br><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1770">29:30</a> Initialize Our Optimizer<br><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1821">30:21</a> Training Loop<br><br><div style="text-align: left;"><a href="./x1lAcT3xl5M.html">Whisper Transcript</a> | <a href="./transcript_x1lAcT3xl5M.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi and welcome to the video. Here we're going to have a look at how we can use NSP or next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=7" target="_blank">00:00:07.120</a></span> | <span class="t">sentence prediction to train a BERT model. Now in a previous video I covered how NSP works but I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=15" target="_blank">00:00:15.680</a></span> | <span class="t">didn't really cover how you actually train a model using it. So that's what we're going to do here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=21" target="_blank">00:00:21.040</a></span> | <span class="t">So we're going to jump straight into it and we have this notebook. Here is the data that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=29" target="_blank">00:00:29.760</a></span> | <span class="t">going to be using. I will load that in a moment but first thing I want to do before doing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=35" target="_blank">00:00:35.120</a></span> | <span class="t">is import and initialize everything we need. So obviously when we are downloading that data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=42" target="_blank">00:00:42.400</a></span> | <span class="t">I'm going to be using requests for that. So I'm going to import requests</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=45" target="_blank">00:00:45.760</a></span> | <span class="t">and for our actual training of the model we're going to be using both Hugging Faces Transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=53" target="_blank">00:00:53.440</a></span> | <span class="t">and PyTorch. So I need to import Transformers and I'm going to import a BERT Tokenizer class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=62" target="_blank">00:01:02.720</a></span> | <span class="t">and also a BERT for next sentence prediction class. So BERT for next sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=75" target="_blank">00:01:15.760</a></span> | <span class="t">prediction and as well as that we need to import Torch. So once we've imported all those we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=84" target="_blank">00:01:24.800</a></span> | <span class="t">initialize our Tokenizer and model. So Tokenizer equals BERT Tokenizer from pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=93" target="_blank">00:01:33.120</a></span> | <span class="t">and I'm using BERT based on case for this example. Obviously you can use another BERT model if you'd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=102" target="_blank">00:01:42.480</a></span> | <span class="t">like. So copy that and initialize our model as well. Okay and we can run that and now let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=119" target="_blank">00:01:59.280</a></span> | <span class="t">extract this data. So this warning here we don't need to worry about that. That's just saying if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=124" target="_blank">00:02:04.720</a></span> | <span class="t">you are using this model for inference you shouldn't because you need to train it a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=131" target="_blank">00:02:11.440</a></span> | <span class="t">So we don't need to worry about that it's fine because we are going to be training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=135" target="_blank">00:02:15.280</a></span> | <span class="t">Now what we do need to do is get this data. So the data equals requests.get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=144" target="_blank">00:02:24.400</a></span> | <span class="t">and we just take this link. I will keep this link in the description for you so you can just copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=152" target="_blank">00:02:32.720</a></span> | <span class="t">it across if you want to follow along and we should see that we get a 200 response there that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=159" target="_blank">00:02:39.280</a></span> | <span class="t">So all we need to do is extract the text from that and we're going to store it in a another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=164" target="_blank">00:02:44.800</a></span> | <span class="t">variable here text variable and if we just have a quick look at what we have in there we see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=170" target="_blank">00:02:50.320</a></span> | <span class="t">we have all of these paragraphs. This is from the meditations by Marcus Aurelius. You can get that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=176" target="_blank">00:02:56.880</a></span> | <span class="t">book online that's why I'm using it and the language is a bit unique as well so that's why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=181" target="_blank">00:03:01.920</a></span> | <span class="t">I want to use it because when we're using next sentence prediction we're training the BERT model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=188" target="_blank">00:03:08.320</a></span> | <span class="t">to better comprehend the style of language that we train it on. So in here we have our paragraphs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=196" target="_blank">00:03:16.480</a></span> | <span class="t">and they're all separated by a newline character. So I'm just going to add another little bit of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=201" target="_blank">00:03:21.360</a></span> | <span class="t">code here which is a split by newline character and we have a look here we now have a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=207" target="_blank">00:03:27.920</a></span> | <span class="t">containing paragraphs and that's our training data that's what we want to be using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=215" target="_blank">00:03:35.760</a></span> | <span class="t">So when we're using NSP we want to create a 50/50 split of sentences that are random and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=225" target="_blank">00:03:45.680</a></span> | <span class="t">sentences that are not random. So we're going to be taking sentence A's and 50% of the time we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=233" target="_blank">00:03:53.920</a></span> | <span class="t">going to be adding the genuine sentence B for that sentence A's e.g. the sentence that follows it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=239" target="_blank">00:03:59.680</a></span> | <span class="t">in the text and then the other 50% of the time we're going to be just choosing a random sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=245" target="_blank">00:04:05.760</a></span> | <span class="t">and pulling that in and using that. So to do that we first want a bag of sentences to actually pull</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=257" target="_blank">00:04:17.680</a></span> | <span class="t">that text from. So the reason we can't just use text directly is because if we for example look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=264" target="_blank">00:04:24.800</a></span> | <span class="t">at this we see that we have multiple sentences in this single paragraph. So if I just split by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=272" target="_blank">00:04:32.400</a></span> | <span class="t">period we get this one, two, three, four so we get four sentences and this empty one at the end as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=280" target="_blank">00:04:40.800</a></span> | <span class="t">well which we we need to remove. So what I'm going to do is loop through our text here so the text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=291" target="_blank">00:04:51.440</a></span> | <span class="t">variable, split every sentence by the period characters and append all of those to a new list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=302" target="_blank">00:05:02.400</a></span> | <span class="t">so a flat list containing just sentences so no paragraphs just sentences. And at the same time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=308" target="_blank">00:05:08.640</a></span> | <span class="t">we'll need to make sure we don't include these empty ones because we get those with almost I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=312" target="_blank">00:05:12.800</a></span> | <span class="t">think actually every paragraph in there. So we need to make sure we don't include those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=319" target="_blank">00:05:19.600</a></span> | <span class="t">Now to create this bag we write something like this so we want to go through each sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=326" target="_blank">00:05:26.320</a></span> | <span class="t">so we want each sentence from each paragraph so sentence sorry sentence for each paragraph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=337" target="_blank">00:05:37.200</a></span> | <span class="t">in the text for the sentences so for sentence in so this is where we're getting sentences from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=347" target="_blank">00:05:47.280</a></span> | <span class="t">so paragraph.split we split by the period and as well as that we also need to add that condition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=358" target="_blank">00:05:58.000</a></span> | <span class="t">that we don't want any sentences that look like this so we just add that in so if sentence is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=364" target="_blank">00:06:04.720</a></span> | <span class="t">equal to that and that should be okay so let's check the length okay so we get 1372 sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=377" target="_blank">00:06:17.120</a></span> | <span class="t">from that and we'll actually want to save this to a parameter because we're using it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=383" target="_blank">00:06:23.600</a></span> | <span class="t">So we now have the 1300 sentences to sample from and now what we want to do is loop through each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=393" target="_blank">00:06:33.120</a></span> | <span class="t">sentence within text or each paragraph within text choose a sentence from each paragraph if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=399" target="_blank">00:06:39.840</a></span> | <span class="t">there's multiple paragraphs only multiple sentences only and then 50% of the time select a random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=409" target="_blank">00:06:49.600</a></span> | <span class="t">sentence from a bag and append that to the end 50% of the time append the actual genuine sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=416" target="_blank">00:06:56.000</a></span> | <span class="t">onto it and then we create labels as to whether we have randomized it or not randomized it so to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=423" target="_blank">00:07:03.920</a></span> | <span class="t">create that random 50% we import the random library and we also want to initialize our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=433" target="_blank">00:07:13.440</a></span> | <span class="t">sentence a list sentence b list and we also need to initialize a label list okay so that'll be zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=446" target="_blank">00:07:26.800</a></span> | <span class="t">one now what we want to do is loop through each paragraph in our text so for paragraph in text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=455" target="_blank">00:07:35.760</a></span> | <span class="t">and then here we extract our sentences like we did with the bag before so we go sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=463" target="_blank">00:07:43.600</a></span> | <span class="t">equals and here we want to write sentence for sentence in paragraph dot split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=476" target="_blank">00:07:56.320</a></span> | <span class="t">and remember we have those random empty sentences we don't want to include those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=483" target="_blank">00:08:03.920</a></span> | <span class="t">so we write if sentence is not equal to that empty sentence so we have now so we're now looping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=496" target="_blank">00:08:16.560</a></span> | <span class="t">through each paragraph and we've split each paragraph into sentences now what we want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=502" target="_blank">00:08:22.560</a></span> | <span class="t">is check if that paragraph eg our new sentences variable has more than one sentence so we'll do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=512" target="_blank">00:08:32.880</a></span> | <span class="t">number of sentences equals to length of sentences and then we say if number of sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=521" target="_blank">00:08:41.440</a></span> | <span class="t">is greater than one oops okay don't execute it right now and then we apply our 50 50 logic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=532" target="_blank">00:08:52.240</a></span> | <span class="t">and append that to our actual training data otherwise if it's just a single sentence we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=538" target="_blank">00:08:58.640</a></span> | <span class="t">don't actually add it to the train data i mean ideally we would want to do something like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=543" target="_blank">00:09:03.840</a></span> | <span class="t">but for this use case i don't want to get make things too complicated so the reason i'm doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=550" target="_blank">00:09:10.880</a></span> | <span class="t">that is for example this sentence it's just a single sentence in that paragraph and we can't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=555" target="_blank">00:09:15.120</a></span> | <span class="t">guarantee that each continuous paragraph is talking about the same subject you might switch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=560" target="_blank">00:09:20.480</a></span> | <span class="t">so for the sake of simplicity i'm just going to ignore the single sentence paragraphs although</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=568" target="_blank">00:09:28.160</a></span> | <span class="t">we do have them in our bag so they can be pulled in as potential sentence bees when we randomize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=576" target="_blank">00:09:36.240</a></span> | <span class="t">the selection now what i want to do is set the sentence that we will start from so we write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=583" target="_blank">00:09:43.360</a></span> | <span class="t">sense of start equals random rand int so this is only if we have more than one sentence remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=594" target="_blank">00:09:54.400</a></span> | <span class="t">so our random random so this is going to be the start sentence in the case that we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=601" target="_blank">00:10:01.680</a></span> | <span class="t">sentence a and b consecutively so we don't randomize sentence b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=606" target="_blank">00:10:06.160</a></span> | <span class="t">we want to make sure that we have enough space at the end of our sentences so here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=613" target="_blank">00:10:13.840</a></span> | <span class="t">to take both sentence a and sentence b so let's say for example we have i'm going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=622" target="_blank">00:10:22.560</a></span> | <span class="t">an example here so we have zero one two three four let's say this is our paragraph we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=628" target="_blank">00:10:28.720</a></span> | <span class="t">five sentences in here we want the start sentence the sentence a if we select four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=635" target="_blank">00:10:35.600</a></span> | <span class="t">then we don't have a sentence b to select from so what we're going to do here is say you choose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=643" target="_blank">00:10:43.600</a></span> | <span class="t">a random integer between zero and we want three to be the maximum there okay so how do we do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=651" target="_blank">00:10:51.680</a></span> | <span class="t">okay we've we've got the number of sentences here so this value will be five in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=657" target="_blank">00:10:57.120</a></span> | <span class="t">so we would say number of sentences is five minus two because we don't we the maximum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=665" target="_blank">00:11:05.600</a></span> | <span class="t">value we want to select is three in this case so it's going to be the number of sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=673" target="_blank">00:11:13.280</a></span> | <span class="t">minus two okay now what we do is we do our 50 50 randomized or not randomized for sentence b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=682" target="_blank">00:11:22.640</a></span> | <span class="t">so if random dot random so this will just select random float between the values zero and one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=690" target="_blank">00:11:30.480</a></span> | <span class="t">if that is a greater than 0.5 then let's say we'll make this our random selection okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=700" target="_blank">00:11:40.880</a></span> | <span class="t">so for the random selection what we do is sentence b dot append and then here we would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=709" target="_blank">00:11:49.840</a></span> | <span class="t">append a random sentence from our bag up here so to do that we will just write bag</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=717" target="_blank">00:11:57.760</a></span> | <span class="t">and then in here we need to select a random integer like we did up here okay so we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=724" target="_blank">00:12:04.080</a></span> | <span class="t">to use that same that same function so random dot randint and that needs to be between zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=732" target="_blank">00:12:12.080</a></span> | <span class="t">and the length of our bag minus one so we use bag size that's why that's why we have it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=740" target="_blank">00:12:20.240</a></span> | <span class="t">so bag size minus one okay now we'll select a random sentence b from that bag for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=749" target="_blank">00:12:29.520</a></span> | <span class="t">and as well as that we also want to set label so our label in this case would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=756" target="_blank">00:12:36.480</a></span> | <span class="t">a one so we have the zero which means it is the next sentence we have a one which means it is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=763" target="_blank">00:12:43.920</a></span> | <span class="t">the next sentence so we set one now our sentence a it our sentence a gets selected it's the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=773" target="_blank">00:12:53.200</a></span> | <span class="t">thing no matter whether we have the random sentence b or the not random sentence b so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=780" target="_blank">00:13:00.160</a></span> | <span class="t">we can actually write our sentence a append up here and this is just going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=788" target="_blank">00:13:08.480</a></span> | <span class="t">sentences and in the index we have start which is our value from here okay so we have the random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=799" target="_blank">00:13:19.680</a></span> | <span class="t">option now let's do our not random option so in here we'd write sentence b append</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=808" target="_blank">00:13:28.240</a></span> | <span class="t">and this needs to append sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=812" target="_blank">00:13:32.400</a></span> | <span class="t">start plus one so the following sentence after our sentence a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=822" target="_blank">00:13:42.400</a></span> | <span class="t">and our label here would be zero which means it is the next sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=828" target="_blank">00:13:48.320</a></span> | <span class="t">so let's there's quite a lot of code let's run that and see what we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=833" target="_blank">00:13:53.840</a></span> | <span class="t">okay now what i want to do is let's have a look at the first few labels see if we have a mix of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=846" target="_blank">00:14:06.720</a></span> | <span class="t">different ones in there okay we just have one one one so i'm going to rerun this because i want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=851" target="_blank">00:14:11.280</a></span> | <span class="t">show you the difference between zeros and ones here okay so we have these so let me print out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=859" target="_blank">00:14:19.360</a></span> | <span class="t">what we have so for i in range three so i'm just doing this so we can print and see what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=870" target="_blank">00:14:30.160</a></span> | <span class="t">actually have in our training data so i want to print the label at that index and then i want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=880" target="_blank">00:14:40.400</a></span> | <span class="t">print the sentence a at that index and we'll follow that with a newline character and a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=893" target="_blank">00:14:53.120</a></span> | <span class="t">dashes so we can distinguish between the start and end of sentence a and b and then we will do print</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=898" target="_blank">00:14:58.960</a></span> | <span class="t">sentence b and then i'm just going to add a new line there to distinguish it from the next set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=905" target="_blank">00:15:05.760</a></span> | <span class="t">of answers so see here that we have zero we have our sentence a and our sentence b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=918" target="_blank">00:15:18.640</a></span> | <span class="t">is a continuation of that first sentence because we have that label zero we know that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=926" target="_blank">00:15:26.720</a></span> | <span class="t">so we have sentence a here and again this one here is a continuation of this sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=934" target="_blank">00:15:34.000</a></span> | <span class="t">a and then down here we have a one so this is why we've selected a random sentence b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=940" target="_blank">00:15:40.240</a></span> | <span class="t">and if we read this i know it's not the easiest thing to read</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=952" target="_blank">00:15:52.400</a></span> | <span class="t">yeah the difference there's reasonably clear difference in the context there okay now this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=960" target="_blank">00:16:00.480</a></span> | <span class="t">won't always work in some cases we might select even the same sentence for sentence a and b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=966" target="_blank">00:16:06.080</a></span> | <span class="t">but for what we're doing here i think this is a completely reasonable way of going about it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=974" target="_blank">00:16:14.800</a></span> | <span class="t">because we don't want to over complicate things if we wanted to really be very strict on it we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=981" target="_blank">00:16:21.040</a></span> | <span class="t">add in some extra logic which confirms that we are not getting a sentence b from around the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=987" target="_blank">00:16:27.360</a></span> | <span class="t">area as sentence a for example but for now this is i think fine okay so we've now prepared our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=996" target="_blank">00:16:36.320</a></span> | <span class="t">what we need to do now is tokenize it so to tokenize our data we're just going to use a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1003" target="_blank">00:16:43.760</a></span> | <span class="t">tokenizer which we've already initialized and in here we can actually just pass our sentence a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1010" target="_blank">00:16:50.800</a></span> | <span class="t">and sentence b like this and our tokenizer will deal with how to fit both of those together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1016" target="_blank">00:16:56.080</a></span> | <span class="t">for us so that's pretty useful we're going to be using pytorch so we want to return tensors pt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1023" target="_blank">00:17:03.360</a></span> | <span class="t">and as well as that we need to truncate or pad each one of those sequences to a maximum length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1035" target="_blank">00:17:15.440</a></span> | <span class="t">of 512 then we truncate using this and we are set padding equal to max length okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1049" target="_blank">00:17:29.280</a></span> | <span class="t">that should be okay let's have a look at what we have we see that we have input ids token type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1056" target="_blank">00:17:36.720</a></span> | <span class="t">ids and attention mass let's have a look at what they look like so you see here we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1063" target="_blank">00:17:43.280</a></span> | <span class="t">all these different vectors and that is a single pair of sentence a and sentence b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1069" target="_blank">00:17:49.040</a></span> | <span class="t">and we have quite a few of those now our token type ids what we would expect is sentence a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1080" target="_blank">00:18:00.400</a></span> | <span class="t">would have a token type id of zero and sentence b would have token type id of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1087" target="_blank">00:18:07.280</a></span> | <span class="t">one we don't we don't see those ones in there so let's expand that out a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1093" target="_blank">00:18:13.840</a></span> | <span class="t">so we'll go with token type ids let's go with number zero okay so now we see okay the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1105" target="_blank">00:18:25.360</a></span> | <span class="t">is because they're in the middle here so what we're seeing here is sentence a followed by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1111" target="_blank">00:18:31.360</a></span> | <span class="t">sentence b and then these remaining zero tokens are our padding tokens so we can also see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1119" target="_blank">00:18:39.120</a></span> | <span class="t">if we switch across to input ids we see that we have all these padding tokens and as well another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1127" target="_blank">00:18:47.600</a></span> | <span class="t">item that the another thing that the tokenizer does for us automatically is adds a separator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1132" target="_blank">00:18:52.640</a></span> | <span class="t">token in the middle of our sentence a and b so sentence a is this sentence b is this okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1143" target="_blank">00:19:03.520</a></span> | <span class="t">so we have our input tensors we also need to build our labels tensor and to do that we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1152" target="_blank">00:19:12.720</a></span> | <span class="t">we add it to this inputs variable so we have inputs labels and we set that equal to torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1163" target="_blank">00:19:23.120</a></span> | <span class="t">long tensor and this is a little bit different so let me just expand that out so let's say we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1173" target="_blank">00:19:33.360</a></span> | <span class="t">just add labels in here so sorry it's label and we just get this one big tensor which is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1182" target="_blank">00:19:42.640</a></span> | <span class="t">really in the correct format that we need we we need each one of these to match to our input ids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1193" target="_blank">00:19:53.280</a></span> | <span class="t">token type ids and tension mass so what i mean by that is if we just have a look at this input ids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1203" target="_blank">00:20:03.760</a></span> | <span class="t">you see that we get it's like a list within a list we need that but for our labels as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1210" target="_blank">00:20:10.560</a></span> | <span class="t">they're in a different format at the moment as you as you can see so we could try transposing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1217" target="_blank">00:20:17.680</a></span> | <span class="t">but you see that doesn't actually do anything because it's just a single nav mention so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1222" target="_blank">00:20:22.880</a></span> | <span class="t">just switching everything around so let's remove that transpose and let's add a list inside here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1230" target="_blank">00:20:30.000</a></span> | <span class="t">you see now we're getting somewhere not not quite there yet so now we have a list within lists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1238" target="_blank">00:20:38.240</a></span> | <span class="t">and now what we do is we transpose it and now we get what we need so we have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1244" target="_blank">00:20:44.320</a></span> | <span class="t">almost vector of each of these and each one of these here so this vector matches up to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1252" target="_blank">00:20:52.080</a></span> | <span class="t">value here and this one matches up to this one and that's that's what we want so let's copy that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1259" target="_blank">00:20:59.760</a></span> | <span class="t">and we'll put it here so now we have all of the sensors we need for training our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1268" target="_blank">00:21:08.480</a></span> | <span class="t">and what we now need to do is set up the input pipeline for training so when we're training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1274" target="_blank">00:21:14.480</a></span> | <span class="t">we're going to need to use a pytorch data loader object and to create that data loader object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1281" target="_blank">00:21:21.920</a></span> | <span class="t">we need to create a pytorch dataset object from our data so to do that we write this so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1290" target="_blank">00:21:30.240</a></span> | <span class="t">we're going to be using a dataset class here so i'm going to call it meditations dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1296" target="_blank">00:21:36.320</a></span> | <span class="t">and in here we write torch utils data dataset so that make sure that we are using the correct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1308" target="_blank">00:21:48.240</a></span> | <span class="t">format for the class for a dataset now we need to define a few methods inside here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1317" target="_blank">00:21:57.280</a></span> | <span class="t">our initialization method and for our initialization method we need to be able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1321" target="_blank">00:22:01.920</a></span> | <span class="t">pass our data so we'll pass it through this encodings variable and all we need to do in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1328" target="_blank">00:22:08.960</a></span> | <span class="t">here is assign our encodings variable to be an internal attribute of that dataset or that class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1335" target="_blank">00:22:15.680</a></span> | <span class="t">so write self encodings equals encodings so that allows us to create our dataset class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1344" target="_blank">00:22:24.320</a></span> | <span class="t">and then our data loader needs two different methods from this class as well it needs a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1350" target="_blank">00:22:30.960</a></span> | <span class="t">get item method and a length method so let's do the length mode first it's easier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1359" target="_blank">00:22:39.920</a></span> | <span class="t">so our length we don't need to pass anything to this it's just it's it's the same as when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1366" target="_blank">00:22:46.320</a></span> | <span class="t">would write say you write this and you put something inside it so a list 01 we get that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1373" target="_blank">00:22:53.280</a></span> | <span class="t">length that's exactly what we're doing here so this creates a enables you to do this same method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1380" target="_blank">00:23:00.400</a></span> | <span class="t">on your class and inside here all we need to do is return the length so what length should we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1388" target="_blank">00:23:08.640</a></span> | <span class="t">return well if we just do len of inputs we get four because we only have four items in there so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1398" target="_blank">00:23:18.160</a></span> | <span class="t">we don't want that we actually want the number of samples that we have within our inputs so what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1406" target="_blank">00:23:26.000</a></span> | <span class="t">can do instead is we write inputs input ids shape zero so we have these this 317 items so we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1417" target="_blank">00:23:37.600</a></span> | <span class="t">show you here see this is our encoding size so the um the max length we set here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1425" target="_blank">00:23:45.680</a></span> | <span class="t">and this is a number of sentences or sentence pairs that we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1432" target="_blank">00:23:52.400</a></span> | <span class="t">so we take that and we return it but obviously we don't have inputs we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1443" target="_blank">00:24:03.200</a></span> | <span class="t">now have this self encodings so swap it like that and then we want to pass this get item</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1453" target="_blank">00:24:13.600</a></span> | <span class="t">method and what this does is given a certain index it will return your four dictionaries your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1462" target="_blank">00:24:22.480</a></span> | <span class="t">input ids token type ids attention mass and labels dictionary which we've created down here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1468" target="_blank">00:24:28.560</a></span> | <span class="t">for that specific index so we need to allow it to take an index argument there what we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1476" target="_blank">00:24:36.720</a></span> | <span class="t">is return let me let me show you down here what that would look like so we want to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1486" target="_blank">00:24:46.480</a></span> | <span class="t">a dictionary just like we we have up here but we just want that for that specific index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1492" target="_blank">00:24:52.240</a></span> | <span class="t">so what we write is key and then we write our value index so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1499" target="_blank">00:24:59.200</a></span> | <span class="t">maybe maybe it makes more sense for me to write so tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1503" target="_blank">00:25:03.680</a></span> | <span class="t">so our key is our input ids attention mass and so on our tensor is obviously the tensor inside</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1512" target="_blank">00:25:12.560</a></span> | <span class="t">there but we have the full tensor containing all 317 items so then we pull out the index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1521" target="_blank">00:25:21.680</a></span> | <span class="t">for that tensor but we need to make sure we're doing that for each of our items so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1527" target="_blank">00:25:27.680</a></span> | <span class="t">because we have multiple tensors here don't we we have the we have the four input ids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1532" target="_blank">00:25:32.560</a></span> | <span class="t">labels and so on so we do four key and tensor in and in here we would write let's say we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1546" target="_blank">00:25:46.160</a></span> | <span class="t">inputs items so let me just take that out so you can see so that gives us our dictionary items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1556" target="_blank">00:25:56.000</a></span> | <span class="t">and if we do a for loop so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1559" target="_blank">00:25:59.200</a></span> | <span class="t">four key tensor in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1564" target="_blank">00:26:04.240</a></span> | <span class="t">we want to print let's print the key right so you see that we're looping through each one of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1574" target="_blank">00:26:14.160</a></span> | <span class="t">and we also get the tensor out for each one of those as well but we're specifying a certain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1580" target="_blank">00:26:20.880</a></span> | <span class="t">tensor with each one so let's say we want zero here we'll get the zero tensor and nothing nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1590" target="_blank">00:26:30.400</a></span> | <span class="t">more okay but we want to specify an index so we copy that and it's what we're going to return here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1600" target="_blank">00:26:40.560</a></span> | <span class="t">except here we change it to self encodings so that's our class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1607" target="_blank">00:26:47.680</a></span> | <span class="t">and with that we can initialize our data set object so we'll say data set equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1617" target="_blank">00:26:57.760</a></span> | <span class="t">meditations data set and then all we need to do is pass our data which is sorry it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1626" target="_blank">00:27:06.080</a></span> | <span class="t">inputs here like that okay so that's our data set ready now we can initialize our data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1635" target="_blank">00:27:15.040</a></span> | <span class="t">and we do that like this so we do loader torch utils data dot data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1650" target="_blank">00:27:30.000</a></span> | <span class="t">we pass our data set object we also want to specify the batch size so i'm going to use batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1657" target="_blank">00:27:37.360</a></span> | <span class="t">of 16 and then we also want to shuffle our data set as well so we write shuffle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1665" target="_blank">00:27:45.440</a></span> | <span class="t">equals true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1671" target="_blank">00:27:51.360</a></span> | <span class="t">that's our data loader so now now we just need to set up a few model training parameters so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1681" target="_blank">00:28:01.440</a></span> | <span class="t">the first thing we want to do is move our model to gpu if we have a gpu so to figure that out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1692" target="_blank">00:28:12.080</a></span> | <span class="t">what we do is write well let me do this torch device cuda so this is we say we want to use a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1702" target="_blank">00:28:22.560</a></span> | <span class="t">cuda enabled gpu if torch.cuda is available so this will check our environment and check if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1715" target="_blank">00:28:35.600</a></span> | <span class="t">have a cuda enabled gpu if it isn't available we want to use a torch device cpu let's run that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1727" target="_blank">00:28:47.760</a></span> | <span class="t">see for me i have a cuda enabled gpu so it comes up with this so we saw that in device and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1735" target="_blank">00:28:55.920</a></span> | <span class="t">what we can do is move our model and also move our tensors later on to that device for training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1744" target="_blank">00:29:04.160</a></span> | <span class="t">so we just write model to device and we'll get a lot of output from that we just ignore that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1752" target="_blank">00:29:12.480</a></span> | <span class="t">don't need to don't need to worry about it and we can also activate our models training mode like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1760" target="_blank">00:29:20.560</a></span> | <span class="t">that okay so we've moved our model over to gpu activated training mode now what we need to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1770" target="_blank">00:29:30.000</a></span> | <span class="t">is initialize our optimizer so we're going to be using adam with way to decay for our optimizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1776" target="_blank">00:29:36.240</a></span> | <span class="t">so to use that we need to need to import it from transformers so from transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1785" target="_blank">00:29:45.440</a></span> | <span class="t">import and w and we are we initialize the optimizer like this so we w we pass our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1799" target="_blank">00:29:59.920</a></span> | <span class="t">parameters and we also want to pass the learning rate which is going to be five plus five e to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1809" target="_blank">00:30:09.200</a></span> | <span class="t">minus five okay that's a pretty common one for training transformers and that looks pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1818" target="_blank">00:30:18.640</a></span> | <span class="t">to me so now we can begin our training loop so first i want to import something called tqdm now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1828" target="_blank">00:30:28.960</a></span> | <span class="t">this is purely for aesthetics we don't need it for training this is so we don't we see a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1834" target="_blank">00:30:34.880</a></span> | <span class="t">progress bar during training otherwise we don't see anything so i just want to include that so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1840" target="_blank">00:30:40.160</a></span> | <span class="t">we can actually see what is going on so from tqdm import tqdm so this is optional you don't need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1846" target="_blank">00:30:46.400</a></span> | <span class="t">include it it's up to you but i would i would recommend it um we'll train for let's go with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1855" target="_blank">00:30:55.280</a></span> | <span class="t">two epochs again we don't want to train transform models too much because they will easily overfit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1862" target="_blank">00:31:02.720</a></span> | <span class="t">and to be honest they'll probably overfit on this data set because it's very small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1866" target="_blank">00:31:06.240</a></span> | <span class="t">but that's fine we just want to use this as an example so we're going to train for two epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1875" target="_blank">00:31:15.120</a></span> | <span class="t">and because we're using tqdm we want to set up our training loop like this so we wrap it within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1883" target="_blank">00:31:23.040</a></span> | <span class="t">a tqdm instance and all we do here is pass our data loader so we create that up here that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1892" target="_blank">00:31:32.000</a></span> | <span class="t">our pytorch data loader and we also want to write leave equals true so this is so that we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1901" target="_blank">00:31:41.520</a></span> | <span class="t">the progress bar and then we loop through each batch that will be generated by that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1913" target="_blank">00:31:53.040</a></span> | <span class="t">loop generator so for batch in loop so now we're in our training loop what we want to do here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1922" target="_blank">00:32:02.000</a></span> | <span class="t">very first thing is set our optimizers gradients to zero so obviously in the very first loop that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1933" target="_blank">00:32:13.200</a></span> | <span class="t">it's fine it doesn't matter but every loop after that our optimizer will have a set of gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1939" target="_blank">00:32:19.520</a></span> | <span class="t">that have been calculated from the previous loop and we need to reset those so we write optim zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1946" target="_blank">00:32:26.320</a></span> | <span class="t">grad and after that we can load in our batches or our tensors from our batch here so we want input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1963" target="_blank">00:32:43.600</a></span> | <span class="t">ids equals a batch and we access it like a dictionary so we have input ids so input ids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1973" target="_blank">00:32:53.600</a></span> | <span class="t">and one other thing that we need to do is our model is on our gpu so we need to move</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1980" target="_blank">00:33:00.080</a></span> | <span class="t">move the data that we're training on to our gpu as well so we just write that okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1991" target="_blank">00:33:11.040</a></span> | <span class="t">and copy this so we have we have one more so we have all these that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=1998" target="_blank">00:33:18.960</a></span> | <span class="t">we create up here so input ids token type ids attention mask and labels we want all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2005" target="_blank">00:33:25.920</a></span> | <span class="t">so token type ids attention mask and labels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2015" target="_blank">00:33:35.040</a></span> | <span class="t">okay so initialize our gradients we have pulled in our tensors and now we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2035" target="_blank">00:33:55.280</a></span> | <span class="t">process them through our model so we do model input ids we have token type ids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2042" target="_blank">00:34:02.160</a></span> | <span class="t">we also have the attention mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2051" target="_blank">00:34:11.120</a></span> | <span class="t">and we also have our labels okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2059" target="_blank">00:34:19.840</a></span> | <span class="t">so that will create two tensors for us in the outputs it will create a logits tensor which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2066" target="_blank">00:34:26.960</a></span> | <span class="t">our prediction and it will create a loss tensor which is the difference between our prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2075" target="_blank">00:34:35.120</a></span> | <span class="t">and our labels so let's extract that loss so we do outputs.loss and then we also after extracting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2086" target="_blank">00:34:46.720</a></span> | <span class="t">that loss we need to calculate that this is the overall loss we need to calculate loss for every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2091" target="_blank">00:34:51.120</a></span> | <span class="t">parameter within our model so we can optimize on that so we just write loss backward I think it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2100" target="_blank">00:35:00.000</a></span> | <span class="t">yeah backward and then we do optim step and this will use our optimizer and take a step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2113" target="_blank">00:35:13.680</a></span> | <span class="t">to optimize based on the loss that we've calculated here and that is all we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2119" target="_blank">00:35:19.680</a></span> | <span class="t">need for our training loop we do also have the tqdm up here as well so I just want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2125" target="_blank">00:35:25.920</a></span> | <span class="t">use that and what we're going to do is we're just going to set the description</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2131" target="_blank">00:35:31.120</a></span> | <span class="t">of our loop at this current step equal to the epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2138" target="_blank">00:35:38.960</a></span> | <span class="t">so this is just purely aesthetics we don't need this for training but it's just so we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2144" target="_blank">00:35:44.000</a></span> | <span class="t">what is going on and we also want to loop set postfix and here I'm going to add in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2150" target="_blank">00:35:50.560</a></span> | <span class="t">our loss which is just going to be loss equals loss dot item like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2159" target="_blank">00:35:59.200</a></span> | <span class="t">now that should be okay let's give it a go let's see what happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2167" target="_blank">00:36:07.440</a></span> | <span class="t">okay so that looks pretty good so you can see that our model is training loss is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2174" target="_blank">00:36:14.080</a></span> | <span class="t">reducing now there isn't that much training data so we're not going to see anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2179" target="_blank">00:36:19.280</a></span> | <span class="t">crazy here but we can see that is it is moving in the right direction so that's pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2184" target="_blank">00:36:24.480</a></span> | <span class="t">so that's everything for this video it's a pretty long video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2188" target="_blank">00:36:28.720</a></span> | <span class="t">I've recorded for 41 minutes it'll probably be a little bit short for you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2194" target="_blank">00:36:34.800</a></span> | <span class="t">but yeah that's long so that's everything for this video I hope it's been useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=x1lAcT3xl5M&t=2200" target="_blank">00:36:40.880</a></span> | <span class="t">and I will see you in the next one</span></div></div></body></html>