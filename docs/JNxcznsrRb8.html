<html><head><title>Lesson 2: Deep Learning 2018</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 2: Deep Learning 2018</h2><a href="https://www.youtube.com/watch?v=JNxcznsrRb8"><img src="https://i.ytimg.com/vi_webp/JNxcznsrRb8/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=160">2:40</a> Learning Rate<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=455">7:35</a> Learning Rate Finder<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=950">15:50</a> Data Augmentation<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1078">17:58</a> Transform Sets<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1764">29:24</a> Accuracy<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1816">30:16</a> Learning rate annealing<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2434">40:34</a> Saving your model<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2630">43:50</a> Finetuning<br><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2799">46:39</a> Differential Learning Rates<br><br><div style="text-align: left;"><a href="./JNxcznsrRb8.html">Whisper Transcript</a> | <a href="./transcript_JNxcznsrRb8.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Okay, so welcome back to deep learning lesson 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7" target="_blank">00:00:07.560</a></span> | <span class="t">Last week we got to the point where we had successfully trained a pretty accurate image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=14" target="_blank">00:00:14.160</a></span> | <span class="t">classifier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=16" target="_blank">00:00:16.200</a></span> | <span class="t">And so just to remind you about how we did that, can you guys see okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=23" target="_blank">00:00:23.440</a></span> | <span class="t">Actually we can't turn the front lights off, can you guys all see the screen, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=30" target="_blank">00:00:30.360</a></span> | <span class="t">We can turn just these ones, can we?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=33" target="_blank">00:00:33.280</a></span> | <span class="t">That pitch is all into darkness, but if that works then...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=38" target="_blank">00:00:38.960</a></span> | <span class="t">Okay, that's better isn't it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=42" target="_blank">00:00:42.320</a></span> | <span class="t">Do you mind doing the other two?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=47" target="_blank">00:00:47.280</a></span> | <span class="t">Maybe that one as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=62" target="_blank">00:01:02.880</a></span> | <span class="t">So just to remind you, the way we built this image classifier was we used a small amount</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=69" target="_blank">00:01:09.080</a></span> | <span class="t">of code, basically three lines of code, and these three lines of code pointed at a particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=75" target="_blank">00:01:15.680</a></span> | <span class="t">path which already had some data in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=79" target="_blank">00:01:19.240</a></span> | <span class="t">And so the key thing for this to know how to train this model was that this path, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=84" target="_blank">00:01:24.840</a></span> | <span class="t">was data, dogs, cats, had to have a particular structure, which is that it had a train folder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=92" target="_blank">00:01:32.320</a></span> | <span class="t">and a valid folder, and in each of those train and valid folders there was a cats folder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=96" target="_blank">00:01:36.960</a></span> | <span class="t">and a dogs folder, and each of the cats and the dogs folders was a bunch of images of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=102" target="_blank">00:01:42.000</a></span> | <span class="t">cats and dogs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=103" target="_blank">00:01:43.000</a></span> | <span class="t">So this is like a pretty standard, it's one of two main structures that are used to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=109" target="_blank">00:01:49.400</a></span> | <span class="t">here is the data that I want you to train an image model from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=113" target="_blank">00:01:53.600</a></span> | <span class="t">So I know some of you during the week went away and tried different data sets where you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=119" target="_blank">00:01:59.320</a></span> | <span class="t">had folders with different sets of images in and created your own image classifiers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=124" target="_blank">00:02:04.960</a></span> | <span class="t">And generally that seems to be working pretty well from what I can see on the forums.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=128" target="_blank">00:02:08.520</a></span> | <span class="t">So to make it clear, at this point this is everything you need to get started.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=135" target="_blank">00:02:15.160</a></span> | <span class="t">So if you create your own folders with different sets of images, a few hundred or a few thousand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=144" target="_blank">00:02:24.000</a></span> | <span class="t">in each folder, and run the same three lines of code, that will give you an image classifier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=151" target="_blank">00:02:31.840</a></span> | <span class="t">and you'll be able to see this third column tells you how accurate it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=157" target="_blank">00:02:37.900</a></span> | <span class="t">So we looked at some kind of simple visualizations to see what was it uncertain about, what was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=168" target="_blank">00:02:48.200</a></span> | <span class="t">it wrong about, and so forth, and that's always a really good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=174" target="_blank">00:02:54.520</a></span> | <span class="t">And then we learned about the one key number you have to pick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=177" target="_blank">00:02:57.840</a></span> | <span class="t">So this number here is the one key number, this 0.01, and this is called the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=183" target="_blank">00:03:03.320</a></span> | <span class="t">rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=184" target="_blank">00:03:04.320</a></span> | <span class="t">So I wanted to go over this again, and we'll learn about the theory behind what this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=190" target="_blank">00:03:10.720</a></span> | <span class="t">during the rest of the course in quite a lot of detail, but for now I just wanted to talk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=194" target="_blank">00:03:14.640</a></span> | <span class="t">about the practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=197" target="_blank">00:03:17.000</a></span> | <span class="t">We're going to talk about the other ones shortly, so the main one we're going to look at for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=221" target="_blank">00:03:41.880</a></span> | <span class="t">now is the last column, which is the accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=226" target="_blank">00:03:46.520</a></span> | <span class="t">The first column as you can see is the epoch number, so this tells us how many times has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=231" target="_blank">00:03:51.960</a></span> | <span class="t">it been through the entire data set trying to learn a better classifier, and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=237" target="_blank">00:03:57.360</a></span> | <span class="t">next two columns is what's called the loss, which we'll be learning about either later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=241" target="_blank">00:04:01.960</a></span> | <span class="t">today or next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=243" target="_blank">00:04:03.480</a></span> | <span class="t">The first one is the loss on the training set, these are the images that we're looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=247" target="_blank">00:04:07.200</a></span> | <span class="t">at in order to try to make a better classifier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=249" target="_blank">00:04:09.760</a></span> | <span class="t">The second is the loss on the validation set, these are the images that we're not looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=253" target="_blank">00:04:13.680</a></span> | <span class="t">at when we're training, but we're just setting them aside to see how accurate we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=257" target="_blank">00:04:17.920</a></span> | <span class="t">So we'll learn about the difference between loss and accuracy later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=269" target="_blank">00:04:29.760</a></span> | <span class="t">So we've got the epoch number, the training loss is the second column, the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=275" target="_blank">00:04:35.160</a></span> | <span class="t">loss is the third column and the accuracy is the fourth column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=286" target="_blank">00:04:46.000</a></span> | <span class="t">So the basic idea of the learning rate is it's the thing that's going to decide how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=299" target="_blank">00:04:59.120</a></span> | <span class="t">quickly do we hone in on the solution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=304" target="_blank">00:05:04.520</a></span> | <span class="t">And so I find that a good way to think about this is to think about what if we were trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=309" target="_blank">00:05:09.120</a></span> | <span class="t">to fit to a function that looks something like this, we're trying to say whereabouts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=317" target="_blank">00:05:17.440</a></span> | <span class="t">is the minimum point?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=319" target="_blank">00:05:19.520</a></span> | <span class="t">This is basically what we do when we do deep learning, is we try to find the minimum point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=324" target="_blank">00:05:24.080</a></span> | <span class="t">of a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=326" target="_blank">00:05:26.840</a></span> | <span class="t">Now our function happens to have millions or hundreds of millions of parameters, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=331" target="_blank">00:05:31.000</a></span> | <span class="t">it works the same basic way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=332" target="_blank">00:05:32.440</a></span> | <span class="t">And so when we look at it, we can immediately see that the lowest point is here, but how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=339" target="_blank">00:05:39.440</a></span> | <span class="t">would you do that if you were a computer algorithm?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=341" target="_blank">00:05:41.880</a></span> | <span class="t">And what we do is we start out at some point at random, so we pick say here, and we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=347" target="_blank">00:05:47.680</a></span> | <span class="t">a look and we say what's the loss or the error at this point, and we say what's the gradient,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=353" target="_blank">00:05:53.640</a></span> | <span class="t">in other words which way is up and which way is down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=356" target="_blank">00:05:56.880</a></span> | <span class="t">And it tells us that down is going to be in that direction, and it also tells us how fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=362" target="_blank">00:06:02.000</a></span> | <span class="t">is it going down, which at this point is going down pretty quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=367" target="_blank">00:06:07.440</a></span> | <span class="t">And so then we take a step in the direction that's down, and the distance we travel is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=373" target="_blank">00:06:13.440</a></span> | <span class="t">going to be proportional to the gradient, it's going to be proportional to how steep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=376" target="_blank">00:06:16.480</a></span> | <span class="t">it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=377" target="_blank">00:06:17.480</a></span> | <span class="t">The idea is if it's deeper, then we're probably further away, that's the general idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=383" target="_blank">00:06:23.640</a></span> | <span class="t">And so specifically what we do is we take the gradient, which is how steep is it at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=387" target="_blank">00:06:27.320</a></span> | <span class="t">this point, and we multiply it by some number, and that number is called the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=392" target="_blank">00:06:32.120</a></span> | <span class="t">So if we pick a number that is very small, then we're guaranteed that we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=398" target="_blank">00:06:38.360</a></span> | <span class="t">go a little bit closer and a little bit closer and a little bit closer each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=402" target="_blank">00:06:42.000</a></span> | <span class="t">But it's going to take us a very long time to eventually get to the bottom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=407" target="_blank">00:06:47.640</a></span> | <span class="t">If we pick a number that's very big, we could actually step too far, we could go in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=412" target="_blank">00:06:52.680</a></span> | <span class="t">right direction, but we could step all the way over to here as a result of which we end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=418" target="_blank">00:06:58.160</a></span> | <span class="t">up further away than we started, and we could oscillate and it gets worse and worse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=423" target="_blank">00:07:03.520</a></span> | <span class="t">So if you start training a neural net and you find that your accuracy or your loss is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=428" target="_blank">00:07:08.440</a></span> | <span class="t">like spitting off into infinity, almost certainly your learning rate is too high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=434" target="_blank">00:07:14.520</a></span> | <span class="t">So in a sense, learning rate too low is a better problem to have because you're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=440" target="_blank">00:07:20.800</a></span> | <span class="t">to have to wait a long time, but wouldn't it be nice if there was a way to figure out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=445" target="_blank">00:07:25.060</a></span> | <span class="t">what's the best learning rate?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=447" target="_blank">00:07:27.000</a></span> | <span class="t">Something where you could quickly go like, boom, boom, boom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=452" target="_blank">00:07:32.000</a></span> | <span class="t">And so that's why we use this thing called a learning rate finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=456" target="_blank">00:07:36.800</a></span> | <span class="t">And what the learning rate finder does is it tries, each time it looks at another, remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=462" target="_blank">00:07:42.320</a></span> | <span class="t">the term minibatch?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=463" target="_blank">00:07:43.320</a></span> | <span class="t">Minibatch is a few images that we look at each time so that we're using the parallel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=468" target="_blank">00:07:48.820</a></span> | <span class="t">processing power of the GPU effectively.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=470" target="_blank">00:07:50.920</a></span> | <span class="t">We look generally at around 64 or 128 images at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=475" target="_blank">00:07:55.600</a></span> | <span class="t">For each minibatch, which is labeled here as an iteration, we gradually increase the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=480" target="_blank">00:08:00.400</a></span> | <span class="t">learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=481" target="_blank">00:08:01.400</a></span> | <span class="t">In fact, multiplicatively increase the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=482" target="_blank">00:08:02.920</a></span> | <span class="t">We start at really tiny learning rates to make sure that we don't start at something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=487" target="_blank">00:08:07.920</a></span> | <span class="t">too high, and we gradually increase it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=490" target="_blank">00:08:10.920</a></span> | <span class="t">And so the idea is that eventually the learning rate will be so big that the loss will start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=496" target="_blank">00:08:16.680</a></span> | <span class="t">getting worse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=497" target="_blank">00:08:17.680</a></span> | <span class="t">So what we're going to do then is look at the plot of learning rate against loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=504" target="_blank">00:08:24.920</a></span> | <span class="t">So when the learning rate's tiny, it increases slowly, then it starts to increase a bit faster,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=510" target="_blank">00:08:30.960</a></span> | <span class="t">and then eventually it starts not increasing as quickly and in fact it starts getting worse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=516" target="_blank">00:08:36.400</a></span> | <span class="t">So clearly here, make sure you're going to be familiar with this scientific notation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=522" target="_blank">00:08:42.720</a></span> | <span class="t">So 10^-1 is 0.1, 10^-2 is 0.01, and when we write this in Python, we'll generally write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=533" target="_blank">00:08:53.520</a></span> | <span class="t">it like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=534" target="_blank">00:08:54.520</a></span> | <span class="t">Rather than writing 10^-1 or 10^-2, we'll just write 1e1 or 1e2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=542" target="_blank">00:09:02.760</a></span> | <span class="t">They mean the same thing, you're going to see that all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=548" target="_blank">00:09:08.720</a></span> | <span class="t">And remember that equals 0.1, 0.01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=557" target="_blank">00:09:17.200</a></span> | <span class="t">So don't be confused by this text that it prints out here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=562" target="_blank">00:09:22.400</a></span> | <span class="t">This loss here is the final loss at the end, it's not of any interest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=568" target="_blank">00:09:28.640</a></span> | <span class="t">So ignore this, this is only interesting when we're doing regular training, not interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=573" target="_blank">00:09:33.360</a></span> | <span class="t">for the learning rate finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=574" target="_blank">00:09:34.760</a></span> | <span class="t">The thing that's interesting for the learning rate finder is this learn.shed.plot, and specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=580" target="_blank">00:09:40.840</a></span> | <span class="t">we're not looking for the point where it's the lowest, because the point where it's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=583" target="_blank">00:09:43.960</a></span> | <span class="t">lowest is actually not getting better anymore, so that's too high a learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=587" target="_blank">00:09:47.840</a></span> | <span class="t">So I generally look to see where is it the lowest, and then I go back like 1 over magnitude.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=593" target="_blank">00:09:53.480</a></span> | <span class="t">So 1e2 would be a pretty good choice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=599" target="_blank">00:09:59.400</a></span> | <span class="t">So that's why you saw when we ran our fit here, we picked 0.01, which is 1e1-2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=610" target="_blank">00:10:10.640</a></span> | <span class="t">So an important point to make here is this is the one key number that we've learned to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=616" target="_blank">00:10:16.520</a></span> | <span class="t">adjust, and if you just adjust this number and nothing else, most of the time you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=623" target="_blank">00:10:23.540</a></span> | <span class="t">going to be able to get pretty good results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=625" target="_blank">00:10:25.760</a></span> | <span class="t">And this is like a very different message to what you would hear or see in any textbook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=631" target="_blank">00:10:31.120</a></span> | <span class="t">or any video or any course, because up until now there's been like dozens and dozens, they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=638" target="_blank">00:10:38.680</a></span> | <span class="t">called hyperparameters, dozens and dozens of hyperparameters to set, and they've been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=642" target="_blank">00:10:42.560</a></span> | <span class="t">thought of as highly sensitive and difficult to set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=645" target="_blank">00:10:45.320</a></span> | <span class="t">So inside the first AI library, we kind of do all that stuff for you as much as we can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=652" target="_blank">00:10:52.320</a></span> | <span class="t">And during the course, we're going to learn that there are some more we can break to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=655" target="_blank">00:10:55.680</a></span> | <span class="t">slightly better results, but it's kind of like, it's kind of in a funny situation here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=662" target="_blank">00:11:02.560</a></span> | <span class="t">because for those of you that haven't done any deep learning before, it's kind of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=666" target="_blank">00:11:06.320</a></span> | <span class="t">oh, this is, that's all there is to it, this is very easy, and then when you talk to people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=671" target="_blank">00:11:11.040</a></span> | <span class="t">outside this class, they'll be like deep learning is so difficult, there's so much to set, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=675" target="_blank">00:11:15.000</a></span> | <span class="t">a real art form, and so that's why there's this difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=679" target="_blank">00:11:19.040</a></span> | <span class="t">And so the truth is that the learning rate really is the key thing to set, and this ability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=683" target="_blank">00:11:23.200</a></span> | <span class="t">to use this trick to figure out how to set it, although the paper is now probably 18</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=689" target="_blank">00:11:29.360</a></span> | <span class="t">months old, almost nobody knows about this paper, it was from a guy who's not from a famous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=695" target="_blank">00:11:35.200</a></span> | <span class="t">research lab, so most people kind of ignored it, and in fact even this particular technique</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=699" target="_blank">00:11:39.400</a></span> | <span class="t">was one sub-part of a paper that was about something else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=703" target="_blank">00:11:43.240</a></span> | <span class="t">So again, this idea of this is how you can set the learning rate, really nobody outside</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=708" target="_blank">00:11:48.320</a></span> | <span class="t">this classroom just about knows about it, obviously the guy who wrote it, Leslie Smith</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=712" target="_blank">00:11:52.800</a></span> | <span class="t">knows about it, so it's a good thing to tell your colleagues about, it's like here is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=719" target="_blank">00:11:59.240</a></span> | <span class="t">a great way to set the learning rate, and there's even been papers called, like one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=723" target="_blank">00:12:03.520</a></span> | <span class="t">of the famous papers is called No More Pesky Learning Rates, which actually is a less effective</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=729" target="_blank">00:12:09.080</a></span> | <span class="t">technique than this one, but this idea that like setting learning rates is very difficult</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=733" target="_blank">00:12:13.760</a></span> | <span class="t">and fiddly has been true for most of the kind of deep learning history.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=739" target="_blank">00:12:19.440</a></span> | <span class="t">So here's the trick, look at this plot, find kind of the lowest, go back about a multiple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=744" target="_blank">00:12:24.760</a></span> | <span class="t">of 10 and try that, and if that doesn't quite work you can always try going back another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=750" target="_blank">00:12:30.520</a></span> | <span class="t">multiple of 10, but this has always worked for me so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=778" target="_blank">00:12:58.920</a></span> | <span class="t">That's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=780" target="_blank">00:13:00.160</a></span> | <span class="t">So we're going to learn during this course about a number of ways of improving gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=784" target="_blank">00:13:04.400</a></span> | <span class="t">percent, like you mentioned momentum and atom and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=788" target="_blank">00:13:08.600</a></span> | <span class="t">This is orthogonal in fact.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=790" target="_blank">00:13:10.360</a></span> | <span class="t">So one of the things the class AI library tries to do is figure out the right gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=795" target="_blank">00:13:15.080</a></span> | <span class="t">percent version, and in fact behind the scenes this is actually using something called atom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=799" target="_blank">00:13:19.760</a></span> | <span class="t">And so this technique is telling us this is the best learning rate to use, given what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=805" target="_blank">00:13:25.240</a></span> | <span class="t">other tweaks you're using in this case, the atom optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=809" target="_blank">00:13:29.000</a></span> | <span class="t">So it's not that there's some compromise between this and some other approaches, this sits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=813" target="_blank">00:13:33.320</a></span> | <span class="t">on top of those approaches, and you still have to set the learning rate when you use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=816" target="_blank">00:13:36.760</a></span> | <span class="t">other approaches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=818" target="_blank">00:13:38.160</a></span> | <span class="t">So we're trying to find the best kind of optimizer to use for a problem, but you still have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=822" target="_blank">00:13:42.440</a></span> | <span class="t">set the learning rate and this is how we can do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=825" target="_blank">00:13:45.320</a></span> | <span class="t">And in fact this idea of using this technique on top of more advanced optimizers like atom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=830" target="_blank">00:13:50.080</a></span> | <span class="t">I haven't even seen mentioned in a paper before, so I think this is not a huge breakthrough,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=835" target="_blank">00:13:55.600</a></span> | <span class="t">it seems obvious, but nobody else seems to have tried it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=839" target="_blank">00:13:59.200</a></span> | <span class="t">So as you can see it works well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=842" target="_blank">00:14:02.360</a></span> | <span class="t">When we use optimizers like atom which have like adaptive learning rates, so when we set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=850" target="_blank">00:14:10.880</a></span> | <span class="t">this learning rate, is it like initial learning rate because it changes during the epoch?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=859" target="_blank">00:14:19.480</a></span> | <span class="t">So we're going to be learning about things like atom, the details about it later in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=865" target="_blank">00:14:25.320</a></span> | <span class="t">class, but the basic answer is no, even with atom there actually is a learning rate, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=875" target="_blank">00:14:35.160</a></span> | <span class="t">being basically divided by the average previous gradient and also the recent sum of squares</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=882" target="_blank">00:14:42.580</a></span> | <span class="t">of gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=883" target="_blank">00:14:43.580</a></span> | <span class="t">So there's still like a number called the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=886" target="_blank">00:14:46.160</a></span> | <span class="t">There isn't even these so-called dynamic learning rate methods that still have a learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=896" target="_blank">00:14:56.720</a></span> | <span class="t">So the most important thing that you can do to make your model better is to give it more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=908" target="_blank">00:15:08.440</a></span> | <span class="t">data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=909" target="_blank">00:15:09.720</a></span> | <span class="t">So the challenge that happens is that these models have hundreds of millions of parameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=916" target="_blank">00:15:16.280</a></span> | <span class="t">and if you train them for a while they start to do what's called overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=921" target="_blank">00:15:21.200</a></span> | <span class="t">And so overfitting means that they're going to start to see like the specific details</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=925" target="_blank">00:15:25.400</a></span> | <span class="t">of the images you're giving them rather than the more general learning that can transfer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=931" target="_blank">00:15:31.480</a></span> | <span class="t">across to the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=933" target="_blank">00:15:33.960</a></span> | <span class="t">So the best thing we can do to avoid overfitting is to find more data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=938" target="_blank">00:15:38.800</a></span> | <span class="t">Now obviously one way to do that would just be to collect more data from wherever you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=941" target="_blank">00:15:41.880</a></span> | <span class="t">getting it from or label more data, but a really easy way that we should always do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=946" target="_blank">00:15:46.800</a></span> | <span class="t">to use something called data augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=951" target="_blank">00:15:51.040</a></span> | <span class="t">So data augmentation is one of these things that in many courses it's not even mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=956" target="_blank">00:15:56.580</a></span> | <span class="t">at all or if it is it's kind of like an advanced topic right at the end, but actually it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=960" target="_blank">00:16:00.520</a></span> | <span class="t">like the most important thing that you can do to make a better model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=965" target="_blank">00:16:05.080</a></span> | <span class="t">So it's built into the fast.io library to make it very easy to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=968" target="_blank">00:16:08.600</a></span> | <span class="t">And so we're going to look at the details of the code shortly, but the basic idea is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=973" target="_blank">00:16:13.680</a></span> | <span class="t">that in our initial code we had a line that said image_classifier.data.from_paths and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=982" target="_blank">00:16:22.840</a></span> | <span class="t">passed in the path to our data, and for transforms we passed in basically the size and the architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=989" target="_blank">00:16:29.880</a></span> | <span class="t">We'll look at this in more detail shortly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=992" target="_blank">00:16:32.620</a></span> | <span class="t">We just add one more parameter which is what kind of data augmentation do you want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=999" target="_blank">00:16:39.120</a></span> | <span class="t">And so to understand data augmentation, it's maybe easiest to look at some pictures of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1004" target="_blank">00:16:44.320</a></span> | <span class="t">data augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1006" target="_blank">00:16:46.120</a></span> | <span class="t">So what I've done here, again we'll look at the code in more detail later, but the basic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1010" target="_blank">00:16:50.080</a></span> | <span class="t">idea is I've built a data class multiple times, I'm going to do it six times, and each time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1019" target="_blank">00:16:59.920</a></span> | <span class="t">I'm going to plot the same cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1023" target="_blank">00:17:03.120</a></span> | <span class="t">And you can see that what happens is that this cat here is further over to the left,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1028" target="_blank">00:17:08.120</a></span> | <span class="t">and this one here is further over to the right, and this one here is flipped horizontally,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1032" target="_blank">00:17:12.800</a></span> | <span class="t">and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1033" target="_blank">00:17:13.800</a></span> | <span class="t">So data augmentation, different types of image are going to want different types of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1040" target="_blank">00:17:20.160</a></span> | <span class="t">augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1042" target="_blank">00:17:22.000</a></span> | <span class="t">So for example, if you were trying to recognize letters and digits, you wouldn't want to flip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1048" target="_blank">00:17:28.040</a></span> | <span class="t">horizontally because it actually has a different meaning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1050" target="_blank">00:17:30.880</a></span> | <span class="t">Whereas on the other hand, if you're looking at photos of cats and dogs, you probably don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1056" target="_blank">00:17:36.440</a></span> | <span class="t">want to flip vertically because cats aren't generally upside down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1061" target="_blank">00:17:41.000</a></span> | <span class="t">Whereas if you were looking at the current Kaggle competition which is recognizing icebergs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1067" target="_blank">00:17:47.640</a></span> | <span class="t">in satellite images, you probably do want to flip them upside down because it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1072" target="_blank">00:17:52.320</a></span> | <span class="t">really matter which way around the iceberg or the satellite was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1076" target="_blank">00:17:56.480</a></span> | <span class="t">So one of the examples of the transform sets we have is "transforms side on".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1083" target="_blank">00:18:03.200</a></span> | <span class="t">So in other words, if you have photos that are generally taken from the side, which generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1087" target="_blank">00:18:07.360</a></span> | <span class="t">means you want to be able to flip them horizontally but not vertically, this is going to give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1090" target="_blank">00:18:10.960</a></span> | <span class="t">you all the transforms you need for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1092" target="_blank">00:18:12.680</a></span> | <span class="t">So it will flip them sideways, rotate them by small amounts but not too much, slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1098" target="_blank">00:18:18.400</a></span> | <span class="t">bury their contrast and brightness, and slightly zoom in and out a little bit and move them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1104" target="_blank">00:18:24.320</a></span> | <span class="t">around a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1105" target="_blank">00:18:25.320</a></span> | <span class="t">So each time it's a slightly different, slightly different edge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1108" target="_blank">00:18:28.760</a></span> | <span class="t">I'm getting a couple of questions from people about, could you explain again the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1116" target="_blank">00:18:36.360</a></span> | <span class="t">why you don't take the minimum of the loss curve but a slightly higher rate?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1122" target="_blank">00:18:42.360</a></span> | <span class="t">Also, could people understand if this works for every CNN or for CNN or for every internet?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1131" target="_blank">00:18:51.600</a></span> | <span class="t">Could you put your hand up if there's a spare seat next to you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1151" target="_blank">00:19:11.100</a></span> | <span class="t">So there was a question about the learning rate finder about why do we use the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1155" target="_blank">00:19:15.240</a></span> | <span class="t">rate that's less than the lowest point?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1158" target="_blank">00:19:18.160</a></span> | <span class="t">And so the reason why is to understand what's going on with this learning rate finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1165" target="_blank">00:19:25.120</a></span> | <span class="t">So let's go back to our picture here of how do we figure out what learning rate to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1172" target="_blank">00:19:32.980</a></span> | <span class="t">And so what we're going to do is we're going to take steps and each time we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1178" target="_blank">00:19:38.320</a></span> | <span class="t">double the learning rate, so double the amount by which we're multiplying the gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1184" target="_blank">00:19:44.000</a></span> | <span class="t">So in other words, we'd go tiny step, slightly bigger, slightly bigger, slightly bigger,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1189" target="_blank">00:19:49.360</a></span> | <span class="t">slightly bigger, slightly bigger, slightly bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1197" target="_blank">00:19:57.040</a></span> | <span class="t">And so the purpose of this is not to find the minimum, the purpose of this is to figure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1202" target="_blank">00:20:02.200</a></span> | <span class="t">out what learning rate is allowing us to decrease quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1208" target="_blank">00:20:08.000</a></span> | <span class="t">So the point at which the loss was lowest here is actually there, but that learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1213" target="_blank">00:20:13.920</a></span> | <span class="t">rate actually looks like it's probably too high, it's going to just jump probably backwards</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1218" target="_blank">00:20:18.880</a></span> | <span class="t">and forwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1220" target="_blank">00:20:20.940</a></span> | <span class="t">So instead what we do is we go back to the point where the learning rate is giving us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1226" target="_blank">00:20:26.280</a></span> | <span class="t">a quick increase in the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1231" target="_blank">00:20:31.200</a></span> | <span class="t">So here is the actual learning rate increasing every single time we look at a new minibatch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1238" target="_blank">00:20:38.520</a></span> | <span class="t">so minibatch or iteration versus learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1241" target="_blank">00:20:41.640</a></span> | <span class="t">And then here is learning rate versus loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1243" target="_blank">00:20:43.600</a></span> | <span class="t">So here's that point at the bottom where it was now already too high, and so here's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1248" target="_blank">00:20:48.920</a></span> | <span class="t">point where we go back a little bit and it's increasing nice and quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1254" target="_blank">00:20:54.880</a></span> | <span class="t">We're going to learn about something called stochastic gradient descent with restarts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1259" target="_blank">00:20:59.200</a></span> | <span class="t">shortly where we're going to see, in a sense you might want to go back to 1e3 where it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1263" target="_blank">00:21:03.660</a></span> | <span class="t">actually even steeper still, and maybe we would actually find this will actually learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1270" target="_blank">00:21:10.400</a></span> | <span class="t">even quicker, you could try it, but we're going to see later why actually using a higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1274" target="_blank">00:21:14.620</a></span> | <span class="t">number is going to give us better generalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1278" target="_blank">00:21:18.600</a></span> | <span class="t">So for now we'll just put that aside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1280" target="_blank">00:21:20.480</a></span> | <span class="t">So as we increase the iterations in the learning rate finder, the learning rate is going up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1296" target="_blank">00:21:36.320</a></span> | <span class="t">This is iteration versus learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1299" target="_blank">00:21:39.280</a></span> | <span class="t">So as we do that, as the learning rate increases and we plot it here, the loss goes down until</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1306" target="_blank">00:21:46.400</a></span> | <span class="t">we get to the point where the learning rate is too high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1309" target="_blank">00:21:49.440</a></span> | <span class="t">And at that point the loss is now getting worse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1311" target="_blank">00:21:51.480</a></span> | <span class="t">Because I asked the question because you were just indicating that even though the minimum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1316" target="_blank">00:21:56.040</a></span> | <span class="t">was at 10^-1, you suggested we should choose 10^-2, but now you're saying maybe we should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1324" target="_blank">00:22:04.160</a></span> | <span class="t">go back the other way higher.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1326" target="_blank">00:22:06.200</a></span> | <span class="t">I didn't mean to say that, I'm sorry if I said something backwards, so I want to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1330" target="_blank">00:22:10.000</a></span> | <span class="t">back down to a lower learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1334" target="_blank">00:22:14.080</a></span> | <span class="t">So possibly I said higher when I meant higher in this lower learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1343" target="_blank">00:22:23.680</a></span> | <span class="t">Last class you said that all the local minima are the same and this graph also shows the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1350" target="_blank">00:22:30.520</a></span> | <span class="t">same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1351" target="_blank">00:22:31.520</a></span> | <span class="t">Is that something that was observed or is there a theory behind it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1357" target="_blank">00:22:37.560</a></span> | <span class="t">That's not what this graph is showing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1359" target="_blank">00:22:39.720</a></span> | <span class="t">This graph is simply showing that there's a point where if we increase the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1363" target="_blank">00:22:43.260</a></span> | <span class="t">rate more, then it stops getting better and it actually starts getting worse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1367" target="_blank">00:22:47.840</a></span> | <span class="t">The idea that all local minima are the same is a totally separate issue and it's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1377" target="_blank">00:22:57.400</a></span> | <span class="t">something we'll see a picture of shortly, so let's come back to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1380" target="_blank">00:23:00.920</a></span> | <span class="t">That's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1408" target="_blank">00:23:28.840</a></span> | <span class="t">I certainly run it once when I start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1412" target="_blank">00:23:32.920</a></span> | <span class="t">Later on in this class, we're going to learn about unfreezing layers, and after I unfreeze</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1418" target="_blank">00:23:38.540</a></span> | <span class="t">layers I sometimes run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1421" target="_blank">00:23:41.160</a></span> | <span class="t">If I do something to change the thing I'm training or change the way I'm training it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1425" target="_blank">00:23:45.880</a></span> | <span class="t">you may want to run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1430" target="_blank">00:23:50.920</a></span> | <span class="t">Particularly if you've changed something about how you train unfreezing layers, which we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1434" target="_blank">00:23:54.800</a></span> | <span class="t">going to soon learn about, and you're finding the other training is unstable or too slow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1442" target="_blank">00:24:02.220</a></span> | <span class="t">you can run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1443" target="_blank">00:24:03.220</a></span> | <span class="t">There's never any harm in running it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1445" target="_blank">00:24:05.960</a></span> | <span class="t">It doesn't take very long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1448" target="_blank">00:24:08.620</a></span> | <span class="t">That's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1451" target="_blank">00:24:11.320</a></span> | <span class="t">Back to data augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1454" target="_blank">00:24:14.600</a></span> | <span class="t">When we run this little transforms from model function, we pass in augmentation transforms,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1461" target="_blank">00:24:21.920</a></span> | <span class="t">we can pass in the main two, a transform side on or transforms top down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1467" target="_blank">00:24:27.160</a></span> | <span class="t">Later on we'll learn about creating your own custom transform lists as well, but for now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1471" target="_blank">00:24:31.980</a></span> | <span class="t">because we're taking pictures from the side of cats and dogs, we'll say transform side</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1476" target="_blank">00:24:36.420</a></span> | <span class="t">on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1477" target="_blank">00:24:37.760</a></span> | <span class="t">Now each time we look at an image, it's going to be zoomed in or out a little bit, moved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1482" target="_blank">00:24:42.480</a></span> | <span class="t">around a little bit, rotated a little bit, possibly flipped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1489" target="_blank">00:24:49.720</a></span> | <span class="t">What this does is it's not exactly creating new data, but as far as the convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1494" target="_blank">00:24:54.880</a></span> | <span class="t">neural net is concerned, it's a different way of looking at this thing, and it actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1499" target="_blank">00:24:59.440</a></span> | <span class="t">therefore allows it to learn how to recognize cats or dogs from somewhat different angles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1507" target="_blank">00:25:07.360</a></span> | <span class="t">So when we do data augmentation, we're basically trying to say based on our domain knowledge,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1514" target="_blank">00:25:14.240</a></span> | <span class="t">here are different ways that we can mess with this image that we know still make it the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1519" target="_blank">00:25:19.360</a></span> | <span class="t">same image, and that we could expect that you might actually see that kind of image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1523" target="_blank">00:25:23.640</a></span> | <span class="t">in the real world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1526" target="_blank">00:25:26.260</a></span> | <span class="t">So what we can do now is when we call this from_parts function, which we'll learn more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1531" target="_blank">00:25:31.600</a></span> | <span class="t">about shortly, we can now pass in this set of transforms which actually have these augmentations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1537" target="_blank">00:25:37.200</a></span> | <span class="t">in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1541" target="_blank">00:25:41.700</a></span> | <span class="t">So we're going to start from scratch here, we do a fit, and initially the augmentations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1550" target="_blank">00:25:50.520</a></span> | <span class="t">actually don't do anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1552" target="_blank">00:25:52.720</a></span> | <span class="t">And the reason initially they don't do anything is because we've got here something that says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1557" target="_blank">00:25:57.160</a></span> | <span class="t">pre-compute = true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1558" target="_blank">00:25:58.160</a></span> | <span class="t">We're going to go back to this lots of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1563" target="_blank">00:26:03.640</a></span> | <span class="t">But basically what this is doing is do you remember this picture we saw where we learned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1568" target="_blank">00:26:08.680</a></span> | <span class="t">each different layer has these activations that basically look for anything from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1575" target="_blank">00:26:15.120</a></span> | <span class="t">middle of flowers to eyeballs of birds or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1581" target="_blank">00:26:21.760</a></span> | <span class="t">And so literally what happens is that the later layers of this convolutional neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1588" target="_blank">00:26:28.840</a></span> | <span class="t">network have these things called activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1592" target="_blank">00:26:32.440</a></span> | <span class="t">Activation is a number that says this feature, like eyeball of birds, is in this location</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1602" target="_blank">00:26:42.420</a></span> | <span class="t">with this level of confidence, with this probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1606" target="_blank">00:26:46.240</a></span> | <span class="t">And so we're going to see a lot of this later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1608" target="_blank">00:26:48.560</a></span> | <span class="t">But what we can do is we can say, in this we've got a pre-trained network, and a pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1616" target="_blank">00:26:56.360</a></span> | <span class="t">network is one where it's already learned to recognize certain things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1619" target="_blank">00:26:59.640</a></span> | <span class="t">In this case it's learned to recognize the 1.5 million images in the ImageNet dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1625" target="_blank">00:27:05.320</a></span> | <span class="t">And so what we could do is we could take the second last layer, so the one which has got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1631" target="_blank">00:27:11.920</a></span> | <span class="t">all of the information necessary to figure out what kind of thing a thing is, and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1636" target="_blank">00:27:16.360</a></span> | <span class="t">can save those activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1638" target="_blank">00:27:18.320</a></span> | <span class="t">So basically saving things saying there's this level of eyeballness here, and this level</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1643" target="_blank">00:27:23.600</a></span> | <span class="t">of dog's face-ness here, and this level of fluffy ear there, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1648" target="_blank">00:27:28.520</a></span> | <span class="t">And so we save for every image these activations, and we call them the pre-computed activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1656" target="_blank">00:27:36.700</a></span> | <span class="t">And so the idea is now that when we want to create a new classifier which can basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1662" target="_blank">00:27:42.960</a></span> | <span class="t">take advantage of these pre-computed activations, we can very quickly train a simple linear model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1673" target="_blank">00:27:53.520</a></span> | <span class="t">based on those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1674" target="_blank">00:27:54.760</a></span> | <span class="t">And so that's what happens when we say pre-compute = true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1678" target="_blank">00:27:58.120</a></span> | <span class="t">And that's why, you may have noticed this week, the first time that you run a new model, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1685" target="_blank">00:28:05.400</a></span> | <span class="t">takes a minute or two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1688" target="_blank">00:28:08.040</a></span> | <span class="t">Whereas you saw when I ran it, it took like 5 or 10 seconds, it took you a minute or two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1692" target="_blank">00:28:12.520</a></span> | <span class="t">and that's because it had to pre-compute these activations, it just has to do that once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1697" target="_blank">00:28:17.800</a></span> | <span class="t">If you're using your own computer or AWS, it just has to do it once ever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1702" target="_blank">00:28:22.960</a></span> | <span class="t">If you're using Cressel, it actually has to do it once every single time you rerun Cressel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1710" target="_blank">00:28:30.320</a></span> | <span class="t">because Cressel just for these pre-computed activations, it uses a special little kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1715" target="_blank">00:28:35.640</a></span> | <span class="t">of scratch space that disappears each time you restart your Cressel instance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1720" target="_blank">00:28:40.680</a></span> | <span class="t">So other than special Cressel, generally speaking, you just have to run it once ever for a dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1729" target="_blank">00:28:49.560</a></span> | <span class="t">So the issue with that is that since we're pre-computed for each image, how much does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1736" target="_blank">00:28:56.040</a></span> | <span class="t">it have an ear here and how much does it have a lizard's eyeball there and so forth?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1741" target="_blank">00:29:01.520</a></span> | <span class="t">That means that data augmentations don't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1744" target="_blank">00:29:04.280</a></span> | <span class="t">In other words, even though we're trying to show it a different version of the cat each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1747" target="_blank">00:29:07.180</a></span> | <span class="t">time, we've pre-computed the activations for a particular version of that cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1753" target="_blank">00:29:13.160</a></span> | <span class="t">So in order to use data augmentation, we just have to go learn.precompute=false, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1759" target="_blank">00:29:19.760</a></span> | <span class="t">we can run a few more APOCs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1764" target="_blank">00:29:24.000</a></span> | <span class="t">And so you can see here that as we run more APOCs, the accuracy isn't particularly getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1770" target="_blank">00:29:30.520</a></span> | <span class="t">better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1771" target="_blank">00:29:31.520</a></span> | <span class="t">That's the bad news.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1772" target="_blank">00:29:32.680</a></span> | <span class="t">The good news is that you can see the train loss, this is like a way of measuring the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1779" target="_blank">00:29:39.800</a></span> | <span class="t">error of this model, although that's getting better, the error's going down, the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1785" target="_blank">00:29:45.080</a></span> | <span class="t">error isn't going down, but we're not overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1789" target="_blank">00:29:49.840</a></span> | <span class="t">And overfitting would mean that the training loss is much lower than the validation loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1796" target="_blank">00:29:56.160</a></span> | <span class="t">We're going to talk about that a lot during this course, but the general idea here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1800" target="_blank">00:30:00.080</a></span> | <span class="t">if you're doing a much better job on the training set than you are on the validation set, that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1805" target="_blank">00:30:05.760</a></span> | <span class="t">means your model's not generalizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1808" target="_blank">00:30:08.240</a></span> | <span class="t">So we're not at that point, which is good, but we're not really improving.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1813" target="_blank">00:30:13.740</a></span> | <span class="t">So we're going to have to figure out how to deal with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1817" target="_blank">00:30:17.500</a></span> | <span class="t">Before we do, I want to show you one other cool trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1820" target="_blank">00:30:20.880</a></span> | <span class="t">I've added here cycle length=1, and this is another really interesting idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1828" target="_blank">00:30:28.940</a></span> | <span class="t">Here's the basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1831" target="_blank">00:30:31.080</a></span> | <span class="t">Cycle length=1 enables a fairly recent discovery in deep learning called Stochastic Gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1837" target="_blank">00:30:37.320</a></span> | <span class="t">% with restarts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1839" target="_blank">00:30:39.360</a></span> | <span class="t">And the basic idea is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1844" target="_blank">00:30:44.080</a></span> | <span class="t">As you get closer and closer to the right spot, I may want to start to decrease my learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1856" target="_blank">00:30:56.520</a></span> | <span class="t">rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1857" target="_blank">00:30:57.520</a></span> | <span class="t">Because as I get closer, I'm pretty close down, so let's slow down my steps to try to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1863" target="_blank">00:31:03.700</a></span> | <span class="t">get exactly to the right spot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1866" target="_blank">00:31:06.600</a></span> | <span class="t">And so as we do more iterations, our learning rate perhaps should actually go down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1878" target="_blank">00:31:18.660</a></span> | <span class="t">Because as we go along, we're getting closer and closer to where we want to be and we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1881" target="_blank">00:31:21.820</a></span> | <span class="t">to get exactly to the right spot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1885" target="_blank">00:31:25.580</a></span> | <span class="t">So the idea of decreasing the learning rate as you train is called learning rate annealing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1892" target="_blank">00:31:32.940</a></span> | <span class="t">And it's very, very common, very, very popular.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1897" target="_blank">00:31:37.080</a></span> | <span class="t">Everybody uses it basically all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1900" target="_blank">00:31:40.320</a></span> | <span class="t">The most common kind of learning rate annealing is really horrendously hacky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1905" target="_blank">00:31:45.640</a></span> | <span class="t">It's basically that researchers pick a learning rate that seems to work for a while, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1910" target="_blank">00:31:50.720</a></span> | <span class="t">when it stops learning well, they drop it down by about 10 times, and then they keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1914" target="_blank">00:31:54.940</a></span> | <span class="t">learning a bit more until it doesn't seem to be improving, and they drop it down by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1918" target="_blank">00:31:58.000</a></span> | <span class="t">another 10 times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1919" target="_blank">00:31:59.680</a></span> | <span class="t">That's what most academic research papers and most people in the industry do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1924" target="_blank">00:32:04.080</a></span> | <span class="t">So this would be like stepwise annealing, very manual, very annoying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1929" target="_blank">00:32:09.620</a></span> | <span class="t">A better approach is simply to pick some kind of functional form like a line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1936" target="_blank">00:32:16.480</a></span> | <span class="t">It turns out that a really good functional form is one half of a cosine curve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1943" target="_blank">00:32:23.720</a></span> | <span class="t">And the reason why is that for a while when you're not very close, you kind of have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1948" target="_blank">00:32:28.200</a></span> | <span class="t">really high learning rate, and then as you do get close you kind of quickly drop down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1952" target="_blank">00:32:32.520</a></span> | <span class="t">and do a few iterations with a really low learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1956" target="_blank">00:32:36.040</a></span> | <span class="t">And so this is called cosine annealing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1959" target="_blank">00:32:39.360</a></span> | <span class="t">So to those of you who haven't done trigonometry for a while, cosine basically looks something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1964" target="_blank">00:32:44.120</a></span> | <span class="t">like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1965" target="_blank">00:32:45.120</a></span> | <span class="t">So we've picked one little half piece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1971" target="_blank">00:32:51.640</a></span> | <span class="t">So we're going to use cosine annealing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1975" target="_blank">00:32:55.080</a></span> | <span class="t">But here's the thing, when you're in a very high dimensional space, and here we're only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1982" target="_blank">00:33:02.120</a></span> | <span class="t">able to show 3 dimensions, but in reality we've got hundreds of millions of dimensions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1988" target="_blank">00:33:08.440</a></span> | <span class="t">we've got lots of different fairly flat points, they're fairly flat points, all of which are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=1996" target="_blank">00:33:16.920</a></span> | <span class="t">pretty good, but they might differ in a really interesting way, which is that some of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2002" target="_blank">00:33:22.680</a></span> | <span class="t">flat points let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2013" target="_blank">00:33:33.360</a></span> | <span class="t">Let's imagine we've got a surface that looks something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2021" target="_blank">00:33:41.720</a></span> | <span class="t">Now imagine that our random guess started here, and our initial learning rate annealing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2029" target="_blank">00:33:49.760</a></span> | <span class="t">schedule got us down to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2032" target="_blank">00:33:52.720</a></span> | <span class="t">Now indeed that's a pretty nice low error, but it probably doesn't generalize very well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2039" target="_blank">00:33:59.560</a></span> | <span class="t">which is to say if we use a different dataset where things are just kind of slightly different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2044" target="_blank">00:34:04.620</a></span> | <span class="t">in one of these directions, suddenly it's a terrible solution, whereas over here it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2051" target="_blank">00:34:11.600</a></span> | <span class="t">basically equally good in terms of loss, but it rather suggests that if you have slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2058" target="_blank">00:34:18.080</a></span> | <span class="t">different datasets that are slightly moved in different directions, it's still going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2061" target="_blank">00:34:21.760</a></span> | <span class="t">to be good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2062" target="_blank">00:34:22.760</a></span> | <span class="t">So in other words, we would expect this solution here is probably going to generalize better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2067" target="_blank">00:34:27.920</a></span> | <span class="t">than the Sparky one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2071" target="_blank">00:34:31.840</a></span> | <span class="t">So here's what we do, if we've got a bunch of different low bits, then our standard learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2079" target="_blank">00:34:39.720</a></span> | <span class="t">rate annealing approach will go downhill, downhill, downhill, downhill, downhill to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2084" target="_blank">00:34:44.520</a></span> | <span class="t">one spot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2086" target="_blank">00:34:46.960</a></span> | <span class="t">But what we could do instead is use a learning rate schedule that looks like this, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2094" target="_blank">00:34:54.280</a></span> | <span class="t">to say we do a cosine annealing and then suddenly jump up again, do a cosine annealing and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2098" target="_blank">00:34:58.600</a></span> | <span class="t">jump up again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2100" target="_blank">00:35:00.040</a></span> | <span class="t">And so each time we jump up, it means that if we're in a spiky bit and then we suddenly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2105" target="_blank">00:35:05.080</a></span> | <span class="t">increase the learning rate and it jumps now all the way over to here, and so then we kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2110" target="_blank">00:35:10.360</a></span> | <span class="t">of learning rate and near, learning rate and near down to here, and then we jump up again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2113" target="_blank">00:35:13.840</a></span> | <span class="t">to a high learning rate, and it stays here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2118" target="_blank">00:35:18.120</a></span> | <span class="t">So in other words, each time we jump up the learning rate, it means that if it's in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2122" target="_blank">00:35:22.480</a></span> | <span class="t">nasty spiky part of the surface, it's going to hop out of the spiky part, and hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2127" target="_blank">00:35:27.640</a></span> | <span class="t">if we do that enough times, it will eventually find a nice smooth ball.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2135" target="_blank">00:35:35.120</a></span> | <span class="t">Could you get the same effect by running multiple iterations through the different randomized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2145" target="_blank">00:35:45.640</a></span> | <span class="t">running points so that eventually you explore all possible minimals and then compare them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2151" target="_blank">00:35:51.080</a></span> | <span class="t">Yeah so in fact, that's a great question, and before this approach, which is called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2161" target="_blank">00:36:01.040</a></span> | <span class="t">stochastic gradient descent with restarts was created, that's exactly what people used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2167" target="_blank">00:36:07.200</a></span> | <span class="t">to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2168" target="_blank">00:36:08.200</a></span> | <span class="t">They used to create these things called ensembles where they would basically relearn a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2173" target="_blank">00:36:13.240</a></span> | <span class="t">new model 10 times in the hope that one of them is going to end up being better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2180" target="_blank">00:36:20.360</a></span> | <span class="t">And so the cool thing about this stochastic gradient descent with restarts is that once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2186" target="_blank">00:36:26.720</a></span> | <span class="t">we're in a reasonably good spot, each time we jump up the learning rate, it doesn't restart,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2193" target="_blank">00:36:33.120</a></span> | <span class="t">it actually hangs out in this nice part of the space and then keeps getting better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2197" target="_blank">00:36:37.880</a></span> | <span class="t">So interestingly it turns out that this approach where we do this a bunch of separate cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2204" target="_blank">00:36:44.200</a></span> | <span class="t">annealing steps, we end up with a better result than if we just randomly tried a few different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2211" target="_blank">00:36:51.040</a></span> | <span class="t">starting points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2212" target="_blank">00:36:52.800</a></span> | <span class="t">So it's a super neat trick and it's a fairly recent development, and again almost nobody's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2221" target="_blank">00:37:01.560</a></span> | <span class="t">heard of it, but I found it's now like my superpower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2227" target="_blank">00:37:07.760</a></span> | <span class="t">Using this, along with the learning rate finder, I can get better results than nearly anybody</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2235" target="_blank">00:37:15.320</a></span> | <span class="t">like in a Kaggle competition in the first week or two, I can jump in, spend an hour</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2240" target="_blank">00:37:20.960</a></span> | <span class="t">or two and back, I've got a fantastically good result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2245" target="_blank">00:37:25.440</a></span> | <span class="t">And so this is why I didn't pick the point where it's got the steepest slope, I actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2251" target="_blank">00:37:31.360</a></span> | <span class="t">tried to pick something kind of aggressively high, it's still getting down but maybe getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2256" target="_blank">00:37:36.240</a></span> | <span class="t">to the point where it's nearly too high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2260" target="_blank">00:37:40.240</a></span> | <span class="t">Because when we do this stochastic gradient descent with restarts, this 10^-2 represents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2267" target="_blank">00:37:47.400</a></span> | <span class="t">the highest number that it uses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2271" target="_blank">00:37:51.400</a></span> | <span class="t">So it goes up to 10^-2 and then goes down, then up to 10^-2 and then down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2277" target="_blank">00:37:57.180</a></span> | <span class="t">So if I use to lower learning rate, it's not going to jump to a different part of the function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2284" target="_blank">00:38:04.520</a></span> | <span class="t">In terms of this part here where it's going down, we change the learning rate every single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2300" target="_blank">00:38:20.680</a></span> | <span class="t">mini-batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2302" target="_blank">00:38:22.880</a></span> | <span class="t">And then the number of times we reset it is set by the cycle length parameter, so 1 means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2310" target="_blank">00:38:30.000</a></span> | <span class="t">reset it after every epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2312" target="_blank">00:38:32.860</a></span> | <span class="t">So if I had 2 there, it would reset it up to every 2 epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2316" target="_blank">00:38:36.760</a></span> | <span class="t">And interestingly this point that when we do the learning rate annealing that we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2320" target="_blank">00:38:40.480</a></span> | <span class="t">change it every single batch, it turns out to be really critical to making this work,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2327" target="_blank">00:38:47.600</a></span> | <span class="t">and again it's very different to what nearly everybody in industry and academia has done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2331" target="_blank">00:38:51.280</a></span> | <span class="t">before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2332" target="_blank">00:38:52.280</a></span> | <span class="t">We're going to come back to that multiple times in this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2344" target="_blank">00:39:04.700</a></span> | <span class="t">So the way this course is going to work is we're going to do a really high-level version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2348" target="_blank">00:39:08.900</a></span> | <span class="t">of each thing, and then we're going to come back to it in 2 or 3 lessons and then come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2352" target="_blank">00:39:12.860</a></span> | <span class="t">back to it at the end of the course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2354" target="_blank">00:39:14.400</a></span> | <span class="t">And each time we're going to see more of the math, more of the code, and get a deeper view.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2360" target="_blank">00:39:20.060</a></span> | <span class="t">We can talk about it also in the forums during the week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2367" target="_blank">00:39:27.540</a></span> | <span class="t">Our main goal is to generalize and we don't want to get those narrow optimals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2373" target="_blank">00:39:33.300</a></span> | <span class="t">Yeah, that's a very good summary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2374" target="_blank">00:39:34.780</a></span> | <span class="t">So with this method, are we keeping track of the minimals and averaging them, and assembling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2381" target="_blank">00:39:41.500</a></span> | <span class="t">them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2382" target="_blank">00:39:42.500</a></span> | <span class="t">That's another level of sophistication, and indeed you can see there's something here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2386" target="_blank">00:39:46.340</a></span> | <span class="t">called Snapshot Ensembles, so we're not doing it in the code right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2392" target="_blank">00:39:52.220</a></span> | <span class="t">But yes, if you wanted to make this generalized even better, you can save the weights here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2397" target="_blank">00:39:57.760</a></span> | <span class="t">and here and here and then take the average of the predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2402" target="_blank">00:40:02.260</a></span> | <span class="t">But for now, we're just going to pick the last one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2410" target="_blank">00:40:10.260</a></span> | <span class="t">If you want to skip ahead, there's a parameter called CycleSaveName, which you can add as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2420" target="_blank">00:40:20.500</a></span> | <span class="t">well as CycleLend, and that will save a set of weights at the end of every learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2425" target="_blank">00:40:25.660</a></span> | <span class="t">cycle and then you can ensemble them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2434" target="_blank">00:40:34.660</a></span> | <span class="t">So we've got a pretty decent model here, 99.3% accuracy, and we've gone through a few steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2443" target="_blank">00:40:43.280</a></span> | <span class="t">that have taken a minute or two to run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2446" target="_blank">00:40:46.420</a></span> | <span class="t">And so from time to time, I tend to save my weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2448" target="_blank">00:40:48.620</a></span> | <span class="t">So if you go Learn.Save and then pass in a file name, it's going to go ahead and save</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2453" target="_blank">00:40:53.660</a></span> | <span class="t">that for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2454" target="_blank">00:40:54.660</a></span> | <span class="t">Later on, if you go Learn.Load, you'll be straight back to where you came from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2459" target="_blank">00:40:59.260</a></span> | <span class="t">So it's a good idea to do that from time to time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2463" target="_blank">00:41:03.140</a></span> | <span class="t">This is a good time to mention what happens when you do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2468" target="_blank">00:41:08.540</a></span> | <span class="t">When you go Learn.Save, when you create pre-computed activations, another thing we'll learn about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2473" target="_blank">00:41:13.480</a></span> | <span class="t">soon when you create resized images, these are all creating various temporary files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2480" target="_blank">00:41:20.500</a></span> | <span class="t">And so what happens is, if we go to Data, and we go to DogsCats, this is my data folder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2495" target="_blank">00:41:35.520</a></span> | <span class="t">and you'll see there's a folder here called TMP, and so this is automatically created,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2502" target="_blank">00:41:42.820</a></span> | <span class="t">and all of my pre-computed activations end up in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2506" target="_blank">00:41:46.180</a></span> | <span class="t">I mention this because if you're getting weird errors, it might be because you've got some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2513" target="_blank">00:41:53.620</a></span> | <span class="t">pre-computed activations that were only half completed, or are in some way incompatible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2519" target="_blank">00:41:59.900</a></span> | <span class="t">with what you're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2520" target="_blank">00:42:00.900</a></span> | <span class="t">So you can always go ahead and just delete this TMP, this temporary directory, and see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2526" target="_blank">00:42:06.460</a></span> | <span class="t">if that causes your error to go away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2528" target="_blank">00:42:08.260</a></span> | <span class="t">This is the fast AI equivalent of turning it off and then on again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2533" target="_blank">00:42:13.660</a></span> | <span class="t">You'll also see there's a directory called Models, and that's where all of these, when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2537" target="_blank">00:42:17.700</a></span> | <span class="t">you say .save with a model, that's where that's going to go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2542" target="_blank">00:42:22.460</a></span> | <span class="t">Actually it reminds me, when the Stochastic Gradient Descent with Restarts paper came</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2545" target="_blank">00:42:25.900</a></span> | <span class="t">out, I saw a tweet that was somebody who was like, "Oh, to make your deep learning work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2549" target="_blank">00:42:29.580</a></span> | <span class="t">better, turn it off and then on again."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2551" target="_blank">00:42:31.060</a></span> | <span class="t">Is there a question there?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2554" target="_blank">00:42:34.340</a></span> | <span class="t">"If I want to say I want to retrain my model from scratch again, do I just delete everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2563" target="_blank">00:42:43.500</a></span> | <span class="t">from that folder?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2570" target="_blank">00:42:50.220</a></span> | <span class="t">If you want to train your model from scratch, there's generally no reason to delete the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2575" target="_blank">00:42:55.300</a></span> | <span class="t">pre-computed activations because the pre-computed activations are without any training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2581" target="_blank">00:43:01.660</a></span> | <span class="t">That's what the pre-trained model created with the weights that you downloaded off the internet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2592" target="_blank">00:43:12.220</a></span> | <span class="t">The only reason you want to delete the pre-computed activations is that there was some error caused</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2596" target="_blank">00:43:16.780</a></span> | <span class="t">by half creating them and crashing or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2602" target="_blank">00:43:22.260</a></span> | <span class="t">As you change the size of your input, change different architectures and so forth, they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2605" target="_blank">00:43:25.980</a></span> | <span class="t">all create different sets of activations with different file names, so generally you shouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2610" target="_blank">00:43:30.540</a></span> | <span class="t">have to worry about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2612" target="_blank">00:43:32.380</a></span> | <span class="t">If you want to start training again from scratch, all you have to do is create a new learn object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2619" target="_blank">00:43:39.540</a></span> | <span class="t">So each time you go con-learner.pre-trained, that creates a new object with new sets of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2625" target="_blank">00:43:45.700</a></span> | <span class="t">weights we've trained from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2631" target="_blank">00:43:51.460</a></span> | <span class="t">Before our break, we'll finish off by talking about fine-tuning and differential learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2637" target="_blank">00:43:57.980</a></span> | <span class="t">roots.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2640" target="_blank">00:44:00.580</a></span> | <span class="t">So far everything we've done has not changed any of these pre-trained filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2649" target="_blank">00:44:09.260</a></span> | <span class="t">We've used a pre-trained model that already knows how to find at the early stages edges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2657" target="_blank">00:44:17.460</a></span> | <span class="t">and gradients, and then corners and curves, and then repeating patterns, and bits of text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2667" target="_blank">00:44:27.420</a></span> | <span class="t">and eventually eyeballs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2670" target="_blank">00:44:30.320</a></span> | <span class="t">We have not re-trained any of those activations, any of those features, or more specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2678" target="_blank">00:44:38.580</a></span> | <span class="t">any of those weights in the convolutional kernels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2682" target="_blank">00:44:42.340</a></span> | <span class="t">All we've done is we've learned some new layers that we've added on top of these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2688" target="_blank">00:44:48.140</a></span> | <span class="t">We've learned how to mix and match these pre-trained features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2693" target="_blank">00:44:53.000</a></span> | <span class="t">Now obviously it may turn out that your pictures have different kinds of eyeballs or faces,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2701" target="_blank">00:45:01.700</a></span> | <span class="t">or if you're using different kinds of images like satellite images, totally different kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2706" target="_blank">00:45:06.140</a></span> | <span class="t">of features altogether.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2708" target="_blank">00:45:08.220</a></span> | <span class="t">So if you're training to recognize icebergs, you'll probably want to go all the way back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2714" target="_blank">00:45:14.140</a></span> | <span class="t">and learn all the way back to different combinations of these simple gradients and edges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2720" target="_blank">00:45:20.500</a></span> | <span class="t">In our case as dogs versus cats, we're going to have some minor differences, but we still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2725" target="_blank">00:45:25.980</a></span> | <span class="t">may find it's helpful to slightly tune some of these later layers as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2732" target="_blank">00:45:32.660</a></span> | <span class="t">So to tell the learner that we now want to start actually changing the convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2738" target="_blank">00:45:38.700</a></span> | <span class="t">fielders themselves, we simply say unfreeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2742" target="_blank">00:45:42.880</a></span> | <span class="t">So a frozen layer is a layer which is not trained, which is not updated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2747" target="_blank">00:45:47.900</a></span> | <span class="t">So unfreeze unfreezes all of the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2751" target="_blank">00:45:51.340</a></span> | <span class="t">Now when you think about it, it's pretty obvious that layer 1, which is like a diagonal edge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2759" target="_blank">00:45:59.420</a></span> | <span class="t">or a gradient, probably doesn't need to change by much if at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2764" target="_blank">00:46:04.620</a></span> | <span class="t">From the 1.5 million images on ImageNet, it probably already has figured out pretty well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2769" target="_blank">00:46:09.260</a></span> | <span class="t">how to find edges and gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2771" target="_blank">00:46:11.340</a></span> | <span class="t">It probably already knows also which kind of corners to look for and how to find which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2776" target="_blank">00:46:16.140</a></span> | <span class="t">kinds of curves and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2777" target="_blank">00:46:17.980</a></span> | <span class="t">So in other words, these early layers probably need little if any learning, whereas these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2785" target="_blank">00:46:25.380</a></span> | <span class="t">later ones are much more likely to need more learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2789" target="_blank">00:46:29.060</a></span> | <span class="t">This is universally true regardless of whether you're looking for satellite images of rainforest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2793" target="_blank">00:46:33.900</a></span> | <span class="t">or icebergs or whether you're looking for cats versus dogs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2799" target="_blank">00:46:39.340</a></span> | <span class="t">So what we do is we create an array of learning rates where we say these are the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2805" target="_blank">00:46:45.700</a></span> | <span class="t">rates to use for our additional layers that we've added on top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2811" target="_blank">00:46:51.980</a></span> | <span class="t">These are the learning rates to use in the middle few layers, and these are the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2816" target="_blank">00:46:56.900</a></span> | <span class="t">rates to use for the first few layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2819" target="_blank">00:46:59.780</a></span> | <span class="t">So these are the ones for the layers that represent very basic geometric features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2825" target="_blank">00:47:05.140</a></span> | <span class="t">These are the ones that are used for the more complex, sophisticated convolutional features,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2832" target="_blank">00:47:12.540</a></span> | <span class="t">and these are the ones that are used for the features that we've added and learned from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2836" target="_blank">00:47:16.300</a></span> | <span class="t">scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2837" target="_blank">00:47:17.300</a></span> | <span class="t">So we can create an array of learning rates, and then when we call .fit and pass in an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2842" target="_blank">00:47:22.700</a></span> | <span class="t">array of learning rates, it's now going to use those different learning rates for different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2847" target="_blank">00:47:27.500</a></span> | <span class="t">parts of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2850" target="_blank">00:47:30.140</a></span> | <span class="t">This is not something that we've invented, but I'd also say it's so not that common that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2858" target="_blank">00:47:38.700</a></span> | <span class="t">it doesn't even have a name as far as I know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2861" target="_blank">00:47:41.440</a></span> | <span class="t">So we're going to call it differential learning rates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2866" target="_blank">00:47:46.540</a></span> | <span class="t">If it actually has a name, or indeed if somebody's actually written a paper specifically talking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2870" target="_blank">00:47:50.980</a></span> | <span class="t">about it, I don't know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2873" target="_blank">00:47:53.340</a></span> | <span class="t">There's a great researcher called Jason Yosinski who did write a paper about the idea that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2878" target="_blank">00:47:58.540</a></span> | <span class="t">you might want different learning rates and showing why, but I don't think any other library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2882" target="_blank">00:48:02.940</a></span> | <span class="t">support it, and I don't know of a name for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2887" target="_blank">00:48:07.260</a></span> | <span class="t">Having said that though, this ability to unfreeze and then use these differential learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2893" target="_blank">00:48:13.100</a></span> | <span class="t">rates I found is the secret to taking a pretty good model and turning it into an awesome model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2905" target="_blank">00:48:25.400</a></span> | <span class="t">So just to clarify, you have three numbers there, three hyperparameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2912" target="_blank">00:48:32.280</a></span> | <span class="t">The first one is for the late layers, the other layers are there in your model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2920" target="_blank">00:48:40.540</a></span> | <span class="t">So the short answer is many, many, and they're kind of in groups, and we're going to learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2926" target="_blank">00:48:46.620</a></span> | <span class="t">about the architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2927" target="_blank">00:48:47.620</a></span> | <span class="t">This is called a ResNet, a residual network, and it kind of has ResNet blocks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2932" target="_blank">00:48:52.820</a></span> | <span class="t">And so what we're doing is we're grouping the blocks into three groups, so this first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2939" target="_blank">00:48:59.100</a></span> | <span class="t">number is for the earliest layers, the ones closest to the pixels that represent like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2946" target="_blank">00:49:06.600</a></span> | <span class="t">corners and edges and gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2948" target="_blank">00:49:08.540</a></span> | <span class="t">I thought those layers are frozen at first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2954" target="_blank">00:49:14.940</a></span> | <span class="t">They are, right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2955" target="_blank">00:49:15.940</a></span> | <span class="t">So we just said unfreeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2956" target="_blank">00:49:16.940</a></span> | <span class="t">Unfreeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2957" target="_blank">00:49:17.940</a></span> | <span class="t">So you're unfreezing them because you have kind of partially trained all the late layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2964" target="_blank">00:49:24.380</a></span> | <span class="t">We've trained our added layers, yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2966" target="_blank">00:49:26.420</a></span> | <span class="t">Now you're retraining the old steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2968" target="_blank">00:49:28.420</a></span> | <span class="t">Exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2969" target="_blank">00:49:29.420</a></span> | <span class="t">I see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2970" target="_blank">00:49:30.420</a></span> | <span class="t">And the learning rate is particularly small for the early layers, because you just kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2975" target="_blank">00:49:35.020</a></span> | <span class="t">of want to fine-tune and you don't want it to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2977" target="_blank">00:49:37.820</a></span> | <span class="t">We probably don't want to change them at all, but if it does need to then it can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2984" target="_blank">00:49:44.340</a></span> | <span class="t">Thanks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2985" target="_blank">00:49:45.340</a></span> | <span class="t">No problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2989" target="_blank">00:49:49.220</a></span> | <span class="t">So using differential random rates, how is it different from grid search?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2995" target="_blank">00:49:55.640</a></span> | <span class="t">There's no similarity to grid search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=2997" target="_blank">00:49:57.500</a></span> | <span class="t">So grid search is where we're trying to find the best hyperparameter for something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3003" target="_blank">00:50:03.420</a></span> | <span class="t">So for example, you could kind of think of the learning rate finder as a really sophisticated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3010" target="_blank">00:50:10.220</a></span> | <span class="t">grid search, which is like trying lots and lots of learning rates to find which one is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3014" target="_blank">00:50:14.580</a></span> | <span class="t">best.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3015" target="_blank">00:50:15.580</a></span> | <span class="t">But this has nothing to do with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3016" target="_blank">00:50:16.660</a></span> | <span class="t">This is actually for the entire training from now on, it's actually going to use a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3021" target="_blank">00:50:21.660</a></span> | <span class="t">learning rate for each layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3030" target="_blank">00:50:30.620</a></span> | <span class="t">So I was wondering, if you have a pre-trained model, then you have to use the same input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3036" target="_blank">00:50:36.380</a></span> | <span class="t">dimensions, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3037" target="_blank">00:50:37.540</a></span> | <span class="t">Because I was thinking, okay, let's say you have these big machines to train these things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3044" target="_blank">00:50:44.500</a></span> | <span class="t">and you want to take advantage of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3046" target="_blank">00:50:46.260</a></span> | <span class="t">How would you go about if you have images that are bigger than the ones that they use?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3051" target="_blank">00:50:51.580</a></span> | <span class="t">We're going to be talking about sizes later, but the short answer is that with this library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3055" target="_blank">00:50:55.860</a></span> | <span class="t">and the modern architectures we're using, we can use any size we like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3063" target="_blank">00:51:03.260</a></span> | <span class="t">So Jeremy, can we unfreeze just a specific layer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3068" target="_blank">00:51:08.060</a></span> | <span class="t">We can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3069" target="_blank">00:51:09.060</a></span> | <span class="t">We're not doing it yet, but if you wanted to, you can type learn.freeze_to and pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3073" target="_blank">00:51:13.780</a></span> | <span class="t">in a latent number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3079" target="_blank">00:51:19.900</a></span> | <span class="t">Much to my surprise, or at least initially my surprise, it turns out I almost never need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3085" target="_blank">00:51:25.540</a></span> | <span class="t">to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3086" target="_blank">00:51:26.540</a></span> | <span class="t">I almost never find it helpful, and I think it's because using differential learning rates,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3092" target="_blank">00:51:32.360</a></span> | <span class="t">the optimizer can kind of learn just as much as it needs to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3098" target="_blank">00:51:38.360</a></span> | <span class="t">The one place I have found it helpful is if I'm using a really big memory-intensive model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3115" target="_blank">00:51:55.860</a></span> | <span class="t">and I'm running out of GPU, the less layers you unfreeze, the less memory it takes and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3123" target="_blank">00:52:03.940</a></span> | <span class="t">the less time it takes, so it's that kind of practical aspect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3126" target="_blank">00:52:06.740</a></span> | <span class="t">To make sure I ask the question right, can I just unfreeze a specific layer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3134" target="_blank">00:52:14.260</a></span> | <span class="t">No, you can only unfreeze layers from layer N onwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3141" target="_blank">00:52:21.580</a></span> | <span class="t">You could probably delve inside the library and unfreeze one layer, but I don't know why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3145" target="_blank">00:52:25.020</a></span> | <span class="t">you would.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3149" target="_blank">00:52:29.140</a></span> | <span class="t">So I'm really excited to be showing you guys this stuff, because it's something we've been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3152" target="_blank">00:52:32.340</a></span> | <span class="t">kind of researching all year is figuring out how to train state-of-the-art models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3157" target="_blank">00:52:37.700</a></span> | <span class="t">And we've kind of found these tiny number of tricks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3160" target="_blank">00:52:40.940</a></span> | <span class="t">And so once we do that, we now go learn.fit, and you can see, look at this, we get right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3166" target="_blank">00:52:46.700</a></span> | <span class="t">up to like 99.5% accuracy, which is crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3172" target="_blank">00:52:52.220</a></span> | <span class="t">There's one other trick you might see here that as well as using stochastic gradient descent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3176" target="_blank">00:52:56.780</a></span> | <span class="t">with restarts, i.e. cycle length = 1, we've done 3 cycles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3182" target="_blank">00:53:02.980</a></span> | <span class="t">Earlier on I lied to you, I said this is the number of epochs, it's actually the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3186" target="_blank">00:53:06.980</a></span> | <span class="t">of cycles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3187" target="_blank">00:53:07.980</a></span> | <span class="t">So if you said cycle length = 2, it would do 3 cycles of each of two epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3196" target="_blank">00:53:16.300</a></span> | <span class="t">So here I've said do 3 cycles, yet somehow it's done 7 epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3200" target="_blank">00:53:20.900</a></span> | <span class="t">The reason why is I've got one last trick to show you which is cycle_mult = 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3205" target="_blank">00:53:25.740</a></span> | <span class="t">And to tell you what that does, I'm simply going to show you the picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3210" target="_blank">00:53:30.460</a></span> | <span class="t">If I go learn.share.plot_learning_rate, there it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3214" target="_blank">00:53:34.980</a></span> | <span class="t">Now you can see what cycle_mult = 2 is doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3218" target="_blank">00:53:38.500</a></span> | <span class="t">It's doubling the length of the cycle after each cycle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3223" target="_blank">00:53:43.020</a></span> | <span class="t">And so in the paper that introduced this stochastic gradient descent with restarts, the researcher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3228" target="_blank">00:53:48.500</a></span> | <span class="t">kind of said hey, this is something that seems to sometimes work pretty well, and I've certainly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3233" target="_blank">00:53:53.500</a></span> | <span class="t">found that often to be the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3235" target="_blank">00:53:55.100</a></span> | <span class="t">So basically, intuitively speaking, if your cycle length is too short, then it kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3244" target="_blank">00:54:04.140</a></span> | <span class="t">starts going down to find a good spot and then it pops out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3247" target="_blank">00:54:07.540</a></span> | <span class="t">And it goes down to try and find a good spot and pops out, and it never actually gets to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3250" target="_blank">00:54:10.740</a></span> | <span class="t">find a good spot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3252" target="_blank">00:54:12.260</a></span> | <span class="t">So earlier on, you want it to do that because it's trying to find the bit that's smoother.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3257" target="_blank">00:54:17.780</a></span> | <span class="t">But then later on you want it to do more exploring, and then more exploring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3262" target="_blank">00:54:22.700</a></span> | <span class="t">So that's why this cycle_mult = 2 thing often seems to be a pretty good approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3269" target="_blank">00:54:29.860</a></span> | <span class="t">So suddenly we're introducing more and more hyperparameters, having told you there aren't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3274" target="_blank">00:54:34.980</a></span> | <span class="t">that many.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3275" target="_blank">00:54:35.980</a></span> | <span class="t">But the reason is that you can really get away with just picking a good learning rate,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3281" target="_blank">00:54:41.460</a></span> | <span class="t">but then adding these extra tweaks really helps get that extra level up without any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3289" target="_blank">00:54:49.340</a></span> | <span class="t">effort.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3290" target="_blank">00:54:50.540</a></span> | <span class="t">And so in practice, I find this kind of 3 cycles starting at 1, mult = 2 works very,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3300" target="_blank">00:55:00.380</a></span> | <span class="t">very often to get a pretty decent model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3305" target="_blank">00:55:05.260</a></span> | <span class="t">If it doesn't, then often I'll just do 3 cycles of length 2 with no mult.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3312" target="_blank">00:55:12.100</a></span> | <span class="t">There's kind of like 2 things that seem to work a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3314" target="_blank">00:55:14.780</a></span> | <span class="t">There's not too much fiddling, I find, necessary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3317" target="_blank">00:55:17.780</a></span> | <span class="t">As I say, even if you use this line every time, I'd be surprised if you didn't get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3323" target="_blank">00:55:23.020</a></span> | <span class="t">a reasonable result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3324" target="_blank">00:55:24.260</a></span> | <span class="t">Is there a question here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3329" target="_blank">00:55:29.100</a></span> | <span class="t">Why does smoother services correlate to more generalized networks?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3340" target="_blank">00:55:40.100</a></span> | <span class="t">So it's kind of this intuitive explanation I tried to give back here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3347" target="_blank">00:55:47.340</a></span> | <span class="t">Which is that if you've got something spiky, and so what this x-axis is showing is how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3363" target="_blank">00:56:03.580</a></span> | <span class="t">good is this at recognizing dogs versus cats as you change this particular parameter?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3369" target="_blank">00:56:09.260</a></span> | <span class="t">And so for something to be generalizable, it means that we want it to work when we give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3374" target="_blank">00:56:14.460</a></span> | <span class="t">it a slightly different data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3376" target="_blank">00:56:16.500</a></span> | <span class="t">And so a slightly different data set may have a slightly different relationship between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3381" target="_blank">00:56:21.900</a></span> | <span class="t">this parameter and how catty versus doggy it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3385" target="_blank">00:56:25.180</a></span> | <span class="t">It may instead look a little bit like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3391" target="_blank">00:56:31.900</a></span> | <span class="t">So in other words, if we end up at this point, then it's not going to do a good job on this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3398" target="_blank">00:56:38.140</a></span> | <span class="t">slightly different data set, or else if we end up on this point, it's still going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3401" target="_blank">00:56:41.740</a></span> | <span class="t">do a good job on this data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3410" target="_blank">00:56:50.860</a></span> | <span class="t">So that's what cyclemult equals do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3413" target="_blank">00:56:53.420</a></span> | <span class="t">So we've got one last thing before we're going to take a break, which is we're now going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3417" target="_blank">00:56:57.140</a></span> | <span class="t">to take this model, which has 99.5% accuracy, and we're going to try to make it better still.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3423" target="_blank">00:57:03.580</a></span> | <span class="t">And what we're going to do is we're not actually going to change the model at all, but instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3428" target="_blank">00:57:08.500</a></span> | <span class="t">we're going to look back at the original visualization we did where we looked at some of our incorrect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3436" target="_blank">00:57:16.460</a></span> | <span class="t">pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3437" target="_blank">00:57:17.460</a></span> | <span class="t">Now what I've done is I've printed out the whole of these incorrect pictures, but the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3446" target="_blank">00:57:26.340</a></span> | <span class="t">key thing to realize is that when we do the validation set, all of our inputs to our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3457" target="_blank">00:57:37.500</a></span> | <span class="t">all the time have to be square.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3460" target="_blank">00:57:40.940</a></span> | <span class="t">The reason for that is it's kind of a minor technical detail, but basically the GPU doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3466" target="_blank">00:57:46.740</a></span> | <span class="t">go very quickly if you have different dimensions for different images because it needs to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3471" target="_blank">00:57:51.620</a></span> | <span class="t">consistent so that every part of the GPU can do the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3475" target="_blank">00:57:55.460</a></span> | <span class="t">I think this is probably fixable, but now that's the state of the technology we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3479" target="_blank">00:57:59.020</a></span> | <span class="t">So our validation set, when we actually say for this particular thing is it's a dog, what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3483" target="_blank">00:58:03.980</a></span> | <span class="t">we actually do to make it square is we just pick out the square in the middle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3489" target="_blank">00:58:09.220</a></span> | <span class="t">So we would take off its two edges, and so we take the whole height and then as much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3494" target="_blank">00:58:14.360</a></span> | <span class="t">of the middle as we can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3495" target="_blank">00:58:15.940</a></span> | <span class="t">And so you can see in this case we wouldn't actually see this dog's head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3500" target="_blank">00:58:20.480</a></span> | <span class="t">So I think the reason this was actually not correctly classified was because the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3505" target="_blank">00:58:25.220</a></span> | <span class="t">set only got to see the body, and the body doesn't look particularly dog-like or cat-like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3511" target="_blank">00:58:31.380</a></span> | <span class="t">it's not at all sure what it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3514" target="_blank">00:58:34.100</a></span> | <span class="t">So what we're going to do when we calculate the predictions for our validation set is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3519" target="_blank">00:58:39.740</a></span> | <span class="t">we're going to use something called test time augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3522" target="_blank">00:58:42.860</a></span> | <span class="t">And what this means is that every time we decide is this cat or a dog, not in the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3527" target="_blank">00:58:47.580</a></span> | <span class="t">but after we train the model, is we're going to actually take four random data augmentations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3537" target="_blank">00:58:57.720</a></span> | <span class="t">And remember the data augmentations move around and zoom in and out and flip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3543" target="_blank">00:59:03.580</a></span> | <span class="t">So we're going to take four of them at random and we're going to take the original un-augmented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3549" target="_blank">00:59:09.020</a></span> | <span class="t">center crop image and we're going to do a prediction for all of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3553" target="_blank">00:59:13.180</a></span> | <span class="t">And then we're going to take the average of those predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3556" target="_blank">00:59:16.580</a></span> | <span class="t">So we're going to say is this a cat, is this a cat, is this a cat, is this a cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3561" target="_blank">00:59:21.660</a></span> | <span class="t">And so hopefully in one of those random ones we actually make sure that the face is there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3566" target="_blank">00:59:26.940</a></span> | <span class="t">zoomed in by a similar amount to other dog's faces at sea and it's rotated by the amount</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3570" target="_blank">00:59:30.820</a></span> | <span class="t">that it expects to see it and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3573" target="_blank">00:59:33.100</a></span> | <span class="t">And so to do that, all we have to do is just call tta, tta stands for test time augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3581" target="_blank">00:59:41.740</a></span> | <span class="t">This term of what do we call it when we're making predictions from a model we've trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3586" target="_blank">00:59:46.860</a></span> | <span class="t">sometimes it's called inference time, sometimes it's called test time, everybody seems to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3590" target="_blank">00:59:50.620</a></span> | <span class="t">have a different name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3591" target="_blank">00:59:51.620</a></span> | <span class="t">So tta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3592" target="_blank">00:59:52.780</a></span> | <span class="t">And so when we do that we go learn.tta, check the accuracy, and lo and behold we're now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3597" target="_blank">00:59:57.760</a></span> | <span class="t">at 99.65%, which is kind of crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3601" target="_blank">01:00:01.460</a></span> | <span class="t">Where's our green box?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3605" target="_blank">01:00:05.580</a></span> | <span class="t">But for every bug we're only showing one type of augmentation of a particular image, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3613" target="_blank">01:00:13.300</a></span> | <span class="t">So when we're training back here, we're not doing any tta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3617" target="_blank">01:00:17.820</a></span> | <span class="t">So you could, and sometimes I've written libraries where after each epoch I run tta to see how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3625" target="_blank">01:00:25.780</a></span> | <span class="t">well it's going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3626" target="_blank">01:00:26.780</a></span> | <span class="t">But that's not what's happening here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3627" target="_blank">01:00:27.780</a></span> | <span class="t">I trained the whole thing with training time augmentation, which doesn't have a special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3633" target="_blank">01:00:33.500</a></span> | <span class="t">name because that's what we mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3634" target="_blank">01:00:34.500</a></span> | <span class="t">When we say data augmentation, we mean training time augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3637" target="_blank">01:00:37.620</a></span> | <span class="t">So here every time we showed a picture, we were randomly changing it a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3642" target="_blank">01:00:42.300</a></span> | <span class="t">So each epoch, each of these seven epochs, it was seeing slightly different versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3645" target="_blank">01:00:45.820</a></span> | <span class="t">of the picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3647" target="_blank">01:00:47.540</a></span> | <span class="t">Having done that, we now have a fully trained model, we then said okay, let's look at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3652" target="_blank">01:00:52.100</a></span> | <span class="t">validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3653" target="_blank">01:00:53.100</a></span> | <span class="t">So tta by default uses the validation set and said okay, what are your predictions of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3657" target="_blank">01:00:57.180</a></span> | <span class="t">which ones are cats and which ones are dogs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3659" target="_blank">01:00:59.260</a></span> | <span class="t">And it did four predictions with different random augmentations, plus one on the unaugmented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3665" target="_blank">01:01:05.020</a></span> | <span class="t">version, averaged them all together, and that's what we got, and that's what we got the accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3669" target="_blank">01:01:09.700</a></span> | <span class="t">from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3670" target="_blank">01:01:10.700</a></span> | <span class="t">So is there a high probability of having a sample in tta that was not shown during training?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3677" target="_blank">01:01:17.220</a></span> | <span class="t">Yeah, actually every data augmented image is unique because the rotation could be like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3684" target="_blank">01:01:24.220</a></span> | <span class="t">0.034 degrees and zoom could be 1.0165.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3689" target="_blank">01:01:29.500</a></span> | <span class="t">So every time it's slightly different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3691" target="_blank">01:01:31.500</a></span> | <span class="t">Okay, thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3692" target="_blank">01:01:32.500</a></span> | <span class="t">No problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3693" target="_blank">01:01:33.500</a></span> | <span class="t">Who's behind you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3697" target="_blank">01:01:37.300</a></span> | <span class="t">What's your, why not use white padding or something like that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3702" target="_blank">01:01:42.980</a></span> | <span class="t">White padding?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3703" target="_blank">01:01:43.980</a></span> | <span class="t">Just put like a white border around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3706" target="_blank">01:01:46.740</a></span> | <span class="t">Oh, padding's not, yeah, so there's lots of different types of data augmentation you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3711" target="_blank">01:01:51.060</a></span> | <span class="t">do and so one of the things you can do is to add a border around it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3716" target="_blank">01:01:56.420</a></span> | <span class="t">Basically adding a border around it in my experiments doesn't help, it doesn't make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3720" target="_blank">01:02:00.180</a></span> | <span class="t">it any less cat-like, convolutional neural network doesn't seem to find it very interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3727" target="_blank">01:02:07.220</a></span> | <span class="t">One thing that I do do, we'll see later, is I do something called reflection padding which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3730" target="_blank">01:02:10.900</a></span> | <span class="t">is where I add some borders that are the outside just reflected, it's a way to kind of make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3735" target="_blank">01:02:15.980</a></span> | <span class="t">some bigger images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3736" target="_blank">01:02:16.980</a></span> | <span class="t">It works well with satellite imagery in particular, but in general I don't do a lot of padding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3742" target="_blank">01:02:22.780</a></span> | <span class="t">instead I do a bit of zooming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3745" target="_blank">01:02:25.260</a></span> | <span class="t">Let's kind of follow up to that last one, but rather than cropping, just add white space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3754" target="_blank">01:02:34.060</a></span> | <span class="t">because when you crop you lose the dog's face, but if you added white space you wouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3758" target="_blank">01:02:38.740</a></span> | <span class="t">have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3759" target="_blank">01:02:39.740</a></span> | <span class="t">Yeah, so that's where the reflection padding or the zooming or whatever can help.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3764" target="_blank">01:02:44.820</a></span> | <span class="t">So there are ways in the fastai library when you do custom transforms of making that happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3773" target="_blank">01:02:53.100</a></span> | <span class="t">I find that it kind of depends on the image size, but generally speaking it seems that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3783" target="_blank">01:03:03.540</a></span> | <span class="t">using TTA plus data augmentation, the best thing to do is to try to use as large an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3789" target="_blank">01:03:09.140</a></span> | <span class="t">as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3790" target="_blank">01:03:10.140</a></span> | <span class="t">So if you kind of crop the thing down and put white borders on top and bottom, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3793" target="_blank">01:03:13.620</a></span> | <span class="t">now quite a lot smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3796" target="_blank">01:03:16.100</a></span> | <span class="t">And so to make it as big as it was before, you now have to use more GPU, and if you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3799" target="_blank">01:03:19.660</a></span> | <span class="t">going to use all that more GPU you could have zoomed in and used a bigger image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3802" target="_blank">01:03:22.660</a></span> | <span class="t">So in my playing around that doesn't seem to be generally as successful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3808" target="_blank">01:03:28.380</a></span> | <span class="t">There is a lot of interest on the topic of how do you do that augmentation in older than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3820" target="_blank">01:03:40.780</a></span> | <span class="t">images, in data that is not images?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3827" target="_blank">01:03:47.820</a></span> | <span class="t">No one seems to know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3832" target="_blank">01:03:52.500</a></span> | <span class="t">I asked some of my friends in the natural language processing community about this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3835" target="_blank">01:03:55.980</a></span> | <span class="t">and we'll get to natural language processing in a couple of lessons, it seems like it would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3840" target="_blank">01:04:00.260</a></span> | <span class="t">be really helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3841" target="_blank">01:04:01.260</a></span> | <span class="t">There's been a very, very few examples of people where papers would try replacing synonyms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3847" target="_blank">01:04:07.460</a></span> | <span class="t">for instance, but on the whole an understanding of appropriate data augmentation for non-image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3853" target="_blank">01:04:13.300</a></span> | <span class="t">domains is under-researched and underdeveloped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3863" target="_blank">01:04:23.940</a></span> | <span class="t">The question was, couldn't we just use a sliding window to generate all the images?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3868" target="_blank">01:04:28.060</a></span> | <span class="t">So in that dog picture, couldn't we generate three parts of that, wouldn't that be better?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3874" target="_blank">01:04:34.860</a></span> | <span class="t">Yeah, for TTA you mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3877" target="_blank">01:04:37.080</a></span> | <span class="t">Just in general when you're creating your realism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3880" target="_blank">01:04:40.180</a></span> | <span class="t">For training time, I would say no, that wouldn't be better because we're not going to get as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3883" target="_blank">01:04:43.940</a></span> | <span class="t">much variation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3885" target="_blank">01:04:45.620</a></span> | <span class="t">We want to have it one degree off, five degrees off, ten pixels up, lots of slightly different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3891" target="_blank">01:04:51.700</a></span> | <span class="t">versions and so if you just have three standard ways, then you're not giving it as many different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3898" target="_blank">01:04:58.020</a></span> | <span class="t">ways of looking at the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3900" target="_blank">01:05:00.300</a></span> | <span class="t">For test time augmentation, having fixed crop locations I think probably would be better,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3908" target="_blank">01:05:08.620</a></span> | <span class="t">and I just haven't gotten around to writing that yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3911" target="_blank">01:05:11.500</a></span> | <span class="t">I have a version in an olden library, I think having fixed crop locations plus random contrast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3919" target="_blank">01:05:19.180</a></span> | <span class="t">brightness rotation changes might be better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3924" target="_blank">01:05:24.060</a></span> | <span class="t">The reason I haven't gotten around to it yet is because in my testing it didn't seem to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3927" target="_blank">01:05:27.540</a></span> | <span class="t">help in practice very much and it made the code a lot more complicated, so it's an interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3932" target="_blank">01:05:32.540</a></span> | <span class="t">question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3933" target="_blank">01:05:33.540</a></span> | <span class="t">"I just want to know how this fast AI API is that you're using, is it open source?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3944" target="_blank">01:05:44.100</a></span> | <span class="t">Yeah, that's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3946" target="_blank">01:05:46.020</a></span> | <span class="t">The fast AI library is open source, and let's talk about it a bit more generally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3954" target="_blank">01:05:54.540</a></span> | <span class="t">The fact that we're using this library is kind of interesting and unusual, and it sits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3959" target="_blank">01:05:59.160</a></span> | <span class="t">on top of something called PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3961" target="_blank">01:06:01.660</a></span> | <span class="t">So PyTorch is a fairly recent development, and I've noticed all the researchers that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3972" target="_blank">01:06:12.180</a></span> | <span class="t">I respect pretty much are now using PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3975" target="_blank">01:06:15.820</a></span> | <span class="t">I found in part 2 of last year's course that a lot of the cutting edge stuff I wanted to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3980" target="_blank">01:06:20.220</a></span> | <span class="t">teach I couldn't do it in Keras and TensorFlow, which is what we used to teach with, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3986" target="_blank">01:06:26.980</a></span> | <span class="t">I had to switch the course to PyTorch halfway through part 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3991" target="_blank">01:06:31.620</a></span> | <span class="t">The problem was that PyTorch isn't very easy to use, you have to write your own training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3997" target="_blank">01:06:37.620</a></span> | <span class="t">loop from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=3998" target="_blank">01:06:38.620</a></span> | <span class="t">Basically if you write everything from scratch, all the stuff you see inside the fast AI library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4002" target="_blank">01:06:42.460</a></span> | <span class="t">we would have had to have written it to learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4006" target="_blank">01:06:46.460</a></span> | <span class="t">And so it really makes it very hard to learn deep learning when you have to write hundreds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4010" target="_blank">01:06:50.180</a></span> | <span class="t">of lines of code to do anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4014" target="_blank">01:06:54.340</a></span> | <span class="t">So we decided to create a library on top of PyTorch because our mission is to teach world</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4021" target="_blank">01:07:01.580</a></span> | <span class="t">class deep learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4022" target="_blank">01:07:02.580</a></span> | <span class="t">So we wanted to show you how you can be the best in the world at doing X, and we found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4028" target="_blank">01:07:08.060</a></span> | <span class="t">that a lot of the world class stuff we needed to show really needed PyTorch, or at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4033" target="_blank">01:07:13.420</a></span> | <span class="t">with PyTorch it was far easier, but then PyTorch itself just wasn't suitable as a first thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4040" target="_blank">01:07:20.820</a></span> | <span class="t">to teach with for new deep learning practitioners.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4045" target="_blank">01:07:25.820</a></span> | <span class="t">So we built this library on top of PyTorch, initially heavily influenced by Keras, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4051" target="_blank">01:07:31.460</a></span> | <span class="t">is what we taught last year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4053" target="_blank">01:07:33.480</a></span> | <span class="t">But then we realized we could actually make things much easier than Keras.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4057" target="_blank">01:07:37.380</a></span> | <span class="t">So in Keras, if you look back at last year's course notes, you'll find that all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4062" target="_blank">01:07:42.500</a></span> | <span class="t">code is 2-3 times longer, and there's lots more opportunities for mistakes because there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4068" target="_blank">01:07:48.380</a></span> | <span class="t">just a lot of things you have to get right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4071" target="_blank">01:07:51.960</a></span> | <span class="t">So we ended up building this library in order to make it easier to get into deep learning,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4079" target="_blank">01:07:59.460</a></span> | <span class="t">but also easier to get state-of-the-art results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4083" target="_blank">01:08:03.060</a></span> | <span class="t">And then over the last year as we started developing on top of that, we started discovering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4086" target="_blank">01:08:06.980</a></span> | <span class="t">that by using this library, it made us so much more productive that we actually started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4093" target="_blank">01:08:13.940</a></span> | <span class="t">developing new state-of-the-art results and new methods ourselves, and we started realizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4098" target="_blank">01:08:18.180</a></span> | <span class="t">that there's a whole bunch of papers that have kind of been ignored or lost, which when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4103" target="_blank">01:08:23.180</a></span> | <span class="t">you use them it could semi-automate stuff, like learning rate finder that's not in any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4109" target="_blank">01:08:29.100</a></span> | <span class="t">other library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4110" target="_blank">01:08:30.100</a></span> | <span class="t">So I kind of got to the point where now not only is kind of fast.ai lets us do things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4117" target="_blank">01:08:37.700</a></span> | <span class="t">much easier than any other approach, but at the same time it actually has a lot more sophisticated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4125" target="_blank">01:08:45.620</a></span> | <span class="t">stuff behind the scenes than anything else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4127" target="_blank">01:08:47.260</a></span> | <span class="t">So it's kind of an interesting mix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4132" target="_blank">01:08:52.580</a></span> | <span class="t">So we've released this library, at this stage it's like a very early version, and so through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4137" target="_blank">01:08:57.700</a></span> | <span class="t">this course, by the end of this course I hope as a group a lot of people are already helping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4143" target="_blank">01:09:03.420</a></span> | <span class="t">have developed it into something that's really pretty stable and rock-solid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4150" target="_blank">01:09:10.300</a></span> | <span class="t">And anybody can then use it to build your own models under an open-source license, as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4157" target="_blank">01:09:17.660</a></span> | <span class="t">you can see it's available on GitHub.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4163" target="_blank">01:09:23.540</a></span> | <span class="t">Behind the scenes it's creating PyTorch models, and so PyTorch models can then be exported</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4170" target="_blank">01:09:30.740</a></span> | <span class="t">into various different formats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4174" target="_blank">01:09:34.100</a></span> | <span class="t">Having said that, a lot of folks, if you want to do something on a mobile phone, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4178" target="_blank">01:09:38.780</a></span> | <span class="t">you're probably going to need to use TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4181" target="_blank">01:09:41.620</a></span> | <span class="t">And so later on in this course, we're going to show how some of the things that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4186" target="_blank">01:09:46.540</a></span> | <span class="t">doing in the fast.ai library you can do in Keras and TensorFlow so you can get a sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4191" target="_blank">01:09:51.560</a></span> | <span class="t">of what the different libraries look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4194" target="_blank">01:09:54.300</a></span> | <span class="t">Generally speaking, the simple stuff will take you a small number of days to learn to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4201" target="_blank">01:10:01.860</a></span> | <span class="t">do it in Keras and TensorFlow versus fast.ai and PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4205" target="_blank">01:10:05.460</a></span> | <span class="t">And the more complex stuff often just won't be possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4209" target="_blank">01:10:09.160</a></span> | <span class="t">So if you need it to be in TensorFlow, you'll just have to simplify it often a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4218" target="_blank">01:10:18.820</a></span> | <span class="t">I think the more important thing to realize is every year, the libraries that are available</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4226" target="_blank">01:10:26.580</a></span> | <span class="t">and which ones are the best totally changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4228" target="_blank">01:10:28.580</a></span> | <span class="t">So the main thing I hope that you get out of this course is an understanding of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4232" target="_blank">01:10:32.180</a></span> | <span class="t">concepts, like here's how you find a learning rate, here's why differential learning rates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4236" target="_blank">01:10:36.300</a></span> | <span class="t">are important, here's how you do learning rate and kneeling, here's what stochastic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4240" target="_blank">01:10:40.740</a></span> | <span class="t">gradient acceptance restarts does, so on and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4245" target="_blank">01:10:45.140</a></span> | <span class="t">Because by the time we do this course again next year, the library situation is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4252" target="_blank">01:10:52.260</a></span> | <span class="t">to be different again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4253" target="_blank">01:10:53.860</a></span> | <span class="t">That's a question to ask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4257" target="_blank">01:10:57.820</a></span> | <span class="t">I was wondering if you've had an opinion on Pyro, which is Uber's new release.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4269" target="_blank">01:11:09.340</a></span> | <span class="t">I haven't looked at it, no, I'm very interested in probabilistic programming and it's really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4273" target="_blank">01:11:13.780</a></span> | <span class="t">cool that it's built on top of PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4275" target="_blank">01:11:15.500</a></span> | <span class="t">So one of the things we'll learn about in this course is we'll see that PyTorch is much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4278" target="_blank">01:11:18.780</a></span> | <span class="t">more than just a deep learning library, it actually lets us write arbitrary GPU accelerated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4286" target="_blank">01:11:26.060</a></span> | <span class="t">algorithms from scratch, which we're actually going to do, and Pyro is a great example of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4291" target="_blank">01:11:31.140</a></span> | <span class="t">what people are now doing with PyTorch outside of the deep learning world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4296" target="_blank">01:11:36.500</a></span> | <span class="t">Great let's take an 8 minute break and we'll come back at 7.55.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4307" target="_blank">01:11:47.060</a></span> | <span class="t">So 99.65% accuracy, what does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4317" target="_blank">01:11:57.020</a></span> | <span class="t">In classification, when we do classification in machine learning, a really simple way to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4323" target="_blank">01:12:03.220</a></span> | <span class="t">look at the result of a classification is what's called the confusion matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4327" target="_blank">01:12:07.180</a></span> | <span class="t">This is not just deep learning, but any kind of classifier in machine learning where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4330" target="_blank">01:12:10.900</a></span> | <span class="t">say what was the actual truth, there were a thousand cats and a thousand dogs, and of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4337" target="_blank">01:12:17.940</a></span> | <span class="t">the thousand actual cats, how many did we predict were cats?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4341" target="_blank">01:12:21.980</a></span> | <span class="t">This is obviously in the validation sets, this is the images that we didn't use to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4346" target="_blank">01:12:26.140</a></span> | <span class="t">with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4347" target="_blank">01:12:27.140</a></span> | <span class="t">It turns out there were 998 cats that we actually predicted as cats and 2 that we got wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4353" target="_blank">01:12:33.420</a></span> | <span class="t">And then for dogs, there were 995 that we predicted were dogs and then 5 that we got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4358" target="_blank">01:12:38.140</a></span> | <span class="t">wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4359" target="_blank">01:12:39.140</a></span> | <span class="t">So often these confusion matrices can be helpful, particularly if you've got four or five classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4364" target="_blank">01:12:44.700</a></span> | <span class="t">you're trying to predict which group you're having the most trouble with and you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4369" target="_blank">01:12:49.180</a></span> | <span class="t">it uses color-coding to highlight the large bits, and you've got to help with the diagonal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4376" target="_blank">01:12:56.540</a></span> | <span class="t">is the highlighted section.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4380" target="_blank">01:13:00.540</a></span> | <span class="t">So now that we've retrained the model, it can be quite helpful, now it's better to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4384" target="_blank">01:13:04.820</a></span> | <span class="t">look back and see which ones in particular were incorrect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4389" target="_blank">01:13:09.180</a></span> | <span class="t">And we can see here there were actually only two incorrect cats, it prints out four by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4395" target="_blank">01:13:15.180</a></span> | <span class="t">default so you can actually see these two actually less than 0.5 so they weren't wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4400" target="_blank">01:13:20.220</a></span> | <span class="t">So it's actually only these two were wrong cats, this one isn't obviously a cat at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4407" target="_blank">01:13:27.060</a></span> | <span class="t">This one is, but it looks like it's got a lot of weird artifacts and you can't see its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4411" target="_blank">01:13:31.420</a></span> | <span class="t">eyeballs at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4413" target="_blank">01:13:33.580</a></span> | <span class="t">And then here are the 5 wrong dogs, here are 4 of them, that's not obviously a dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4422" target="_blank">01:13:42.340</a></span> | <span class="t">That looks like a mistake, that looks like a mistake, that one I guess doesn't have enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4427" target="_blank">01:13:47.020</a></span> | <span class="t">information, but I guess it's a mistake.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4430" target="_blank">01:13:50.620</a></span> | <span class="t">So we've done a pretty good job here of creating a good classifier based on entering a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4437" target="_blank">01:13:57.940</a></span> | <span class="t">of Kaggle competitions and comparing results I've done to various research papers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4441" target="_blank">01:14:01.700</a></span> | <span class="t">I can tell you it's a state-of-the-art classifier, it's right up there with the best in the world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4447" target="_blank">01:14:07.460</a></span> | <span class="t">We're going to make it a little bit better in a moment, but here are the basic steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4451" target="_blank">01:14:11.380</a></span> | <span class="t">So if you want to create a world class image classifier, the steps that we just went through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4456" target="_blank">01:14:16.060</a></span> | <span class="t">was that we turned data augmentation on by saying all transforms equals, you either say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4461" target="_blank">01:14:21.940</a></span> | <span class="t">side on or top down depending on what you're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4465" target="_blank">01:14:25.100</a></span> | <span class="t">Start with pre-compute equals true, find a decent learning rate, we then train just like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4470" target="_blank">01:14:30.540</a></span> | <span class="t">at one or two epochs, which takes a few seconds because we've got pre-compute equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4475" target="_blank">01:14:35.940</a></span> | <span class="t">Then we turn off pre-compute, which allows us to use data augmentation to do another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4481" target="_blank">01:14:41.320</a></span> | <span class="t">two or three epochs, generally with cycle length equals one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4485" target="_blank">01:14:45.580</a></span> | <span class="t">Then I unfreeze all the layers, I then set the earlier layers to be somewhere between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4491" target="_blank">01:14:51.220</a></span> | <span class="t">3 times to 10 times lower learning rate than the previous.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4507" target="_blank">01:15:07.620</a></span> | <span class="t">As a rule of thumb, knowing that you're starting with a pre-trained ImageNet model, if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4513" target="_blank">01:15:13.700</a></span> | <span class="t">can see that the things that you're now trying to classify are pretty similar to the kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4517" target="_blank">01:15:17.460</a></span> | <span class="t">of things in ImageNet, i.e. pictures of normal objects in normal environments, you probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4522" target="_blank">01:15:22.920</a></span> | <span class="t">want about a 10x difference because you think that the earlier layers are probably very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4528" target="_blank">01:15:28.660</a></span> | <span class="t">good already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4529" target="_blank">01:15:29.660</a></span> | <span class="t">Whereas if you're doing something like satellite imagery or medical imaging, which is not at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4534" target="_blank">01:15:34.380</a></span> | <span class="t">all like ImageNet, then you probably want to be training those earlier layers a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4538" target="_blank">01:15:38.140</a></span> | <span class="t">more so you might have just a 3x difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4542" target="_blank">01:15:42.300</a></span> | <span class="t">So that's one change that I make is to try to make it either 10x or 3x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4552" target="_blank">01:15:52.100</a></span> | <span class="t">So then after unfreezing, you can now call LRFind again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4557" target="_blank">01:15:57.660</a></span> | <span class="t">I actually didn't in this case, but once you've unfreezed all the layers, you've turned on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4562" target="_blank">01:16:02.620</a></span> | <span class="t">differential learning rates, you can then call LRFind again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4569" target="_blank">01:16:09.820</a></span> | <span class="t">So you can then check does it still look like the same point I had last time as about right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4575" target="_blank">01:16:15.300</a></span> | <span class="t">Something to note is that if you call LRFind having set differential learning rates, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4581" target="_blank">01:16:21.620</a></span> | <span class="t">thing it's actually going to print out is the learning rate of the last layers, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4585" target="_blank">01:16:25.700</a></span> | <span class="t">you've got three different learning rates, so it's actually showing you the last layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4589" target="_blank">01:16:29.680</a></span> | <span class="t">So then I train the full network with cycle_mult = 2, and until either it starts with a fitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4595" target="_blank">01:16:35.140</a></span> | <span class="t">or I run out of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4597" target="_blank">01:16:37.780</a></span> | <span class="t">So let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4599" target="_blank">01:16:39.980</a></span> | <span class="t">Let's do this again for a totally different dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4602" target="_blank">01:16:42.800</a></span> | <span class="t">So this morning, I noticed that some of you on the forums were playing around with this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4607" target="_blank">01:16:47.420</a></span> | <span class="t">playground Kaggle competition, very similar, called dog breed identification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4614" target="_blank">01:16:54.140</a></span> | <span class="t">So the dog breed identification Kaggle challenge is one where you don't actually have to decide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4621" target="_blank">01:17:01.020</a></span> | <span class="t">which ones are cats and which ones are dogs, they're all dogs, but you have to decide what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4624" target="_blank">01:17:04.820</a></span> | <span class="t">kind of dog it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4626" target="_blank">01:17:06.460</a></span> | <span class="t">There are 120 different breeds of dogs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4630" target="_blank">01:17:10.500</a></span> | <span class="t">So obviously this could be different types of cells in pathology slides, it could be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4639" target="_blank">01:17:19.460</a></span> | <span class="t">different kinds of cancers in CT scans, it could be different kinds of icebergs and satellite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4646" target="_blank">01:17:26.260</a></span> | <span class="t">images, whatever, as long as you've got some kind of labeled images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4651" target="_blank">01:17:31.300</a></span> | <span class="t">So I want to show you what I did this morning, it took me about an hour basically to go end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4656" target="_blank">01:17:36.860</a></span> | <span class="t">to end from something I've never seen before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4660" target="_blank">01:17:40.100</a></span> | <span class="t">So I downloaded the data from Kaggle, and I'll show you how to do that shortly, but the short</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4665" target="_blank">01:17:45.380</a></span> | <span class="t">answer is there's something called Kaggle CLI, which is a GitHub project you can search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4669" target="_blank">01:17:49.860</a></span> | <span class="t">for and if you read the docs, you basically run kg download, provide the competition name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4675" target="_blank">01:17:55.080</a></span> | <span class="t">and it will grab all the data for you to your Cressel or Amazon or whatever instance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4680" target="_blank">01:18:00.260</a></span> | <span class="t">I put it in my data folder and I then went LS and I saw that it's a little bit different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4690" target="_blank">01:18:10.100</a></span> | <span class="t">to our previous dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4693" target="_blank">01:18:13.900</a></span> | <span class="t">It's not that there's a train folder which has a separate folder for each kind of dog,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4699" target="_blank">01:18:19.860</a></span> | <span class="t">but instead it turned out there was a CSV file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4702" target="_blank">01:18:22.580</a></span> | <span class="t">And the CSV file, I read it in with pandas, so pandas is the thing we use in Python to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4708" target="_blank">01:18:28.100</a></span> | <span class="t">do structured data analysis like CSV files, so pandas we call pd, that's pretty much universal,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4714" target="_blank">01:18:34.980</a></span> | <span class="t">pd.read_csv reads in a CSV file, we can then take a look at it and you can see that basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4720" target="_blank">01:18:40.220</a></span> | <span class="t">it had some kind of identifier and then the breed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4724" target="_blank">01:18:44.940</a></span> | <span class="t">So this is like a different way, this is the second main way that people kind of give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4729" target="_blank">01:18:49.940</a></span> | <span class="t">image labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4730" target="_blank">01:18:50.940</a></span> | <span class="t">One is to put different images into different folders, the second is generally to give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4735" target="_blank">01:18:55.060</a></span> | <span class="t">some kind of file like a CSV file to tell you here's the image name and here's the label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4742" target="_blank">01:19:02.460</a></span> | <span class="t">So what I then did was I used pandas again to create a pivot table which basically groups</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4749" target="_blank">01:19:09.700</a></span> | <span class="t">it up just to see how many of each breed there were and I sorted them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4754" target="_blank">01:19:14.900</a></span> | <span class="t">And so I saw they've got about 100 of some of the more common breeds and some of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4761" target="_blank">01:19:21.380</a></span> | <span class="t">less common breeds that got like 60 or so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4765" target="_blank">01:19:25.540</a></span> | <span class="t">All together there were 120 rows and there must have been 120 different breeds represented.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4771" target="_blank">01:19:31.220</a></span> | <span class="t">So I'm going to go through the steps, so enable data augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4777" target="_blank">01:19:37.220</a></span> | <span class="t">So to enable data augmentation when we call this transforms from model, you just pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4781" target="_blank">01:19:41.680</a></span> | <span class="t">in an org transforms, in this case I chose Sidon, again these are pictures of dots and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4786" target="_blank">01:19:46.780</a></span> | <span class="t">stuff so they're Sidon photos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4790" target="_blank">01:19:50.780</a></span> | <span class="t">We'll talk about MaxZoom in more detail later, but MaxZoom basically says when you do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4796" target="_blank">01:19:56.260</a></span> | <span class="t">data augmentation, we zoom into it by up to 1.1 times, randomly between 1, the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4805" target="_blank">01:20:05.600</a></span> | <span class="t">image size, and 1.1 times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4807" target="_blank">01:20:07.820</a></span> | <span class="t">So it's not always cropping out in the middle or an edge, but it could be cropping out a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4811" target="_blank">01:20:11.740</a></span> | <span class="t">smaller part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4813" target="_blank">01:20:13.580</a></span> | <span class="t">So having done that, the key step now is that rather than going from paths, so previously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4820" target="_blank">01:20:20.240</a></span> | <span class="t">we went from paths and that tells us that the names of the folders are the names of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4825" target="_blank">01:20:25.100</a></span> | <span class="t">the labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4826" target="_blank">01:20:26.100</a></span> | <span class="t">We go from CSV and we pass in the CSV file that contains the labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4831" target="_blank">01:20:31.920</a></span> | <span class="t">So we're passing in the path that contains all of the data, the name of the folder that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4837" target="_blank">01:20:37.100</a></span> | <span class="t">contains the training data, the CSV that contains the labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4843" target="_blank">01:20:43.120</a></span> | <span class="t">We need to also tell it where the test set is if we want to submit to Kaggle later, talk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4846" target="_blank">01:20:46.820</a></span> | <span class="t">more about that next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4849" target="_blank">01:20:49.620</a></span> | <span class="t">Now this time, the previous dataset I had actually separated a validation set out into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4857" target="_blank">01:20:57.300</a></span> | <span class="t">a separate folder, but in this case you'll see that there is not a separate folder called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4863" target="_blank">01:21:03.100</a></span> | <span class="t">validation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4864" target="_blank">01:21:04.980</a></span> | <span class="t">So we want to be able to track how good our performance is locally, so we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4869" target="_blank">01:21:09.620</a></span> | <span class="t">have to separate some of the images out to put it into a validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4874" target="_blank">01:21:14.580</a></span> | <span class="t">So I do that at random, and so up here you can see I've basically opened up the CSV file,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4882" target="_blank">01:21:22.900</a></span> | <span class="t">turned it into a list of rows, and then taken the length of that minus 1, because there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4888" target="_blank">01:21:28.300</a></span> | <span class="t">a header at the top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4890" target="_blank">01:21:30.580</a></span> | <span class="t">And so that's the number of rows in the CSV file, which must be the number of images that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4895" target="_blank">01:21:35.700</a></span> | <span class="t">we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4896" target="_blank">01:21:36.860</a></span> | <span class="t">And then this is a fastai thing, get-cross-validation-indexes, we'll talk about cross-validation later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4902" target="_blank">01:21:42.900</a></span> | <span class="t">But basically if you call this and pass in a number, it's going to return to you by default</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4910" target="_blank">01:21:50.100</a></span> | <span class="t">a random 20% of the rows to use as your validation set, and you can pass in parameters to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4916" target="_blank">01:21:56.980</a></span> | <span class="t">different amounts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4918" target="_blank">01:21:58.420</a></span> | <span class="t">So this is now going to grab 20% of the data and say this is the indexes, the numbers of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4925" target="_blank">01:22:05.500</a></span> | <span class="t">the files which we're going to use as a validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4929" target="_blank">01:22:09.420</a></span> | <span class="t">So now that we've got that, let's run this so you can see what that looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4937" target="_blank">01:22:17.580</a></span> | <span class="t">So val_indexes is just a big bunch of numbers, and so n is 10,000, and so about 20% of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4953" target="_blank">01:22:33.060</a></span> | <span class="t">is going to be in the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4955" target="_blank">01:22:35.740</a></span> | <span class="t">So when we call from CSV, we can pass in a parameter which is to tell it which indexes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4967" target="_blank">01:22:47.380</a></span> | <span class="t">to treat it as a validation set, and so let's pass in those indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4972" target="_blank">01:22:52.820</a></span> | <span class="t">One thing that's a little bit tricky here is that the file names actually have a dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4984" target="_blank">01:23:04.700</a></span> | <span class="t">jpg on the end, and these obviously don't have a dot jpg.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4989" target="_blank">01:23:09.260</a></span> | <span class="t">So when you call from CSV, you can pass in a suffix that says the labels don't actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=4995" target="_blank">01:23:15.860</a></span> | <span class="t">contain the full file names, you need to add this to them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5002" target="_blank">01:23:22.100</a></span> | <span class="t">So that's basically all I need to do to set up my data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5006" target="_blank">01:23:26.780</a></span> | <span class="t">And as a lot of you have noticed during the week, inside that data object, you can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5012" target="_blank">01:23:32.820</a></span> | <span class="t">get access to the training dataset by saying train-ds, and inside train-ds is a whole bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5019" target="_blank">01:23:39.260</a></span> | <span class="t">of things including the file names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5022" target="_blank">01:23:42.060</a></span> | <span class="t">So train-ds.file_names contains all of the file names of everything in the training set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5026" target="_blank">01:23:46.780</a></span> | <span class="t">and so here's one file name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5028" target="_blank">01:23:48.980</a></span> | <span class="t">So here's an example of one file name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5032" target="_blank">01:23:52.680</a></span> | <span class="t">So I can now go ahead and open that file and take a look at it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5036" target="_blank">01:23:56.020</a></span> | <span class="t">So the next thing I did was to try and understand what my dataset looks like, and it found an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5041" target="_blank">01:24:01.540</a></span> | <span class="t">adorable puppy, so that was very nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5043" target="_blank">01:24:03.940</a></span> | <span class="t">So I'm feeling good about this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5045" target="_blank">01:24:05.540</a></span> | <span class="t">I also want to know how big are these files, like how big are the images, because that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5051" target="_blank">01:24:11.420</a></span> | <span class="t">a key issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5052" target="_blank">01:24:12.420</a></span> | <span class="t">If they're huge, I'm going to have to think really carefully about how to deal with huge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5055" target="_blank">01:24:15.500</a></span> | <span class="t">images, that's really challenging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5057" target="_blank">01:24:17.780</a></span> | <span class="t">If they're tiny, well that's also challenging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5061" target="_blank">01:24:21.180</a></span> | <span class="t">Most of ImageNet models are trained on either 224x224 or 299x299 images, so any time you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5068" target="_blank">01:24:28.380</a></span> | <span class="t">have images in that kind of range, that's really hopeful, you're probably not going to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5072" target="_blank">01:24:32.980</a></span> | <span class="t">to do too much different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5073" target="_blank">01:24:33.980</a></span> | <span class="t">In this case, the first image I looked at was about the right size, so I'm thinking it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5078" target="_blank">01:24:38.180</a></span> | <span class="t">looking pretty hopeful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5080" target="_blank">01:24:40.340</a></span> | <span class="t">So what I did then is I created a dictionary comprehension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5082" target="_blank">01:24:42.940</a></span> | <span class="t">Now if you don't know about list comprehensions and dictionary comprehensions in Python, go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5088" target="_blank">01:24:48.100</a></span> | <span class="t">study them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5089" target="_blank">01:24:49.100</a></span> | <span class="t">They're the most useful thing, super handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5092" target="_blank">01:24:52.500</a></span> | <span class="t">You can see the basic idea here is that I'm going through all of the files, and I'm creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5096" target="_blank">01:24:56.700</a></span> | <span class="t">a dictionary that maps the name of the file to the size of that file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5104" target="_blank">01:25:04.900</a></span> | <span class="t">Again this is a handy little Python feature which I'll let you learn about during the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5107" target="_blank">01:25:07.980</a></span> | <span class="t">week if you don't know about it, which is zip, and using this special star notation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5111" target="_blank">01:25:11.900</a></span> | <span class="t">is now going to take this dictionary and turn it into the rows and the columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5119" target="_blank">01:25:19.380</a></span> | <span class="t">So I can now turn those into NumPy arrays, and here are the first 5 row sizes for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5126" target="_blank">01:25:26.540</a></span> | <span class="t">of my images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5128" target="_blank">01:25:28.260</a></span> | <span class="t">And then Matplotlib is something you want to be very familiar with if you do any kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5132" target="_blank">01:25:32.020</a></span> | <span class="t">of data science on machine learning in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5134" target="_blank">01:25:34.380</a></span> | <span class="t">Matplotlib we always refer to as PLT, this is a histogram, and so I've got a histogram</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5140" target="_blank">01:25:40.620</a></span> | <span class="t">of how high, how many rows there are in each image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5145" target="_blank">01:25:45.140</a></span> | <span class="t">So you can see here I'm kind of getting a sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5147" target="_blank">01:25:47.540</a></span> | <span class="t">Before I start doing any modeling, I kind of need to know what I'm modeling with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5150" target="_blank">01:25:50.900</a></span> | <span class="t">And I can see some of the images are going to be like 2500-3000 pixels high, but most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5155" target="_blank">01:25:55.780</a></span> | <span class="t">of them seem to be around 500.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5158" target="_blank">01:25:58.540</a></span> | <span class="t">So given that so few of them were bigger than 1000, I used standard NumPy slicing to just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5164" target="_blank">01:26:04.980</a></span> | <span class="t">grab those that are smaller than 1000 and histogram that, just to zoom in a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5169" target="_blank">01:26:09.980</a></span> | <span class="t">And I can see here it looks like the vast majority are around 500.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5174" target="_blank">01:26:14.660</a></span> | <span class="t">And so this actually also prints out the histogram, so I can actually go through and I can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5179" target="_blank">01:26:19.580</a></span> | <span class="t">here 4500 of them are about 450.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5188" target="_blank">01:26:28.380</a></span> | <span class="t">So Jeremy, how many images should we get in the validation set, is it always 20%?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5199" target="_blank">01:26:39.620</a></span> | <span class="t">So the size of the validation set, using 20% is fine unless you're kind of feeling like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5208" target="_blank">01:26:48.620</a></span> | <span class="t">my data set is really small, I'm not sure that's enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5217" target="_blank">01:26:57.980</a></span> | <span class="t">Basically think of it this way, if you train the same model multiple times and you're getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5221" target="_blank">01:27:01.620</a></span> | <span class="t">very different validation set results and your validation set is kind of small, like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5225" target="_blank">01:27:05.620</a></span> | <span class="t">smaller than 1000 or so, then it's going to be quite hard to interpret how well you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5232" target="_blank">01:27:12.020</a></span> | <span class="t">doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5233" target="_blank">01:27:13.020</a></span> | <span class="t">This is particularly true, if you care about the third decimal place of accuracy and you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5239" target="_blank">01:27:19.300</a></span> | <span class="t">got 1000 things in your validation set, then you're thinking about a single image changing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5243" target="_blank">01:27:23.620</a></span> | <span class="t">plus is what you're looking at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5246" target="_blank">01:27:26.380</a></span> | <span class="t">So it really depends on how much difference you care about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5254" target="_blank">01:27:34.860</a></span> | <span class="t">I would say in general, at the point where you care about the difference between 0.01</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5259" target="_blank">01:27:39.620</a></span> | <span class="t">and 0.02, the second decimal place, you want that to represent 10 or 20 rows, like changing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5268" target="_blank">01:27:48.100</a></span> | <span class="t">the class of 10 or 20 rows, then that's something you can be pretty confident of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5274" target="_blank">01:27:54.420</a></span> | <span class="t">So most of the time, given the data sizes we normally have, 20% seems to work fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5285" target="_blank">01:28:05.500</a></span> | <span class="t">It depends a lot on specifically what you're doing and what you care about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5292" target="_blank">01:28:12.140</a></span> | <span class="t">And it's not a deep learning specific question either.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5295" target="_blank">01:28:15.780</a></span> | <span class="t">So those who are interested in this kind of thing, we're going to look into it in a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5298" target="_blank">01:28:18.540</a></span> | <span class="t">more detail in our machine learning course, which will also be available online.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5307" target="_blank">01:28:27.940</a></span> | <span class="t">So I did the same thing for the columns just to make sure that these aren't super wide,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5311" target="_blank">01:28:31.660</a></span> | <span class="t">and I got similar results and checked in and again found that 400-500 seems to be about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5316" target="_blank">01:28:36.820</a></span> | <span class="t">the average size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5318" target="_blank">01:28:38.540</a></span> | <span class="t">So based on all of that, I thought this looks like a pretty normal kind of image dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5322" target="_blank">01:28:42.900</a></span> | <span class="t">that I can probably use pretty normal kinds of models on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5326" target="_blank">01:28:46.100</a></span> | <span class="t">I was also particularly encouraged to see that when I looked at the dog that the dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5329" target="_blank">01:28:49.940</a></span> | <span class="t">takes up most of the frame, so I'm not too worried about cropping problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5336" target="_blank">01:28:56.340</a></span> | <span class="t">If the dog was just a tiny little piece of one little corner that I'd be thinking about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5341" target="_blank">01:29:01.060</a></span> | <span class="t">doing different, maybe zooming in a lot more or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5345" target="_blank">01:29:05.420</a></span> | <span class="t">Like in medical imaging, that happens a lot, like often the tumor or the cell or whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5349" target="_blank">01:29:09.580</a></span> | <span class="t">is like one tiny piece and that's much more complex.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5353" target="_blank">01:29:13.540</a></span> | <span class="t">So based on all that, this morning I kind of thought, okay, this looks pretty standard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5359" target="_blank">01:29:19.380</a></span> | <span class="t">So I went ahead and created a little function called getData that basically had my normal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5367" target="_blank">01:29:27.500</a></span> | <span class="t">two lines of code in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5370" target="_blank">01:29:30.740</a></span> | <span class="t">But I made it so I could pass in a size and a batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5375" target="_blank">01:29:35.460</a></span> | <span class="t">The reason for this is that when I start working with a new dataset, I want everything to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5379" target="_blank">01:29:39.180</a></span> | <span class="t">super fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5380" target="_blank">01:29:40.580</a></span> | <span class="t">And so if I use small images, it's going to go super fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5384" target="_blank">01:29:44.580</a></span> | <span class="t">So I actually started out with size=64, just to create some super small images that just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5390" target="_blank">01:29:50.460</a></span> | <span class="t">go like a second to run through and see how it went.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5394" target="_blank">01:29:54.260</a></span> | <span class="t">Later on, I started using some big images and also some bigger architectures, at which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5399" target="_blank">01:29:59.940</a></span> | <span class="t">point I started running out of GPU memory, so I started getting these errors saying CUDA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5405" target="_blank">01:30:05.220</a></span> | <span class="t">out of memory error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5406" target="_blank">01:30:06.780</a></span> | <span class="t">When you get a CUDA out of memory error, the first thing you need to do is go kernel restart.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5412" target="_blank">01:30:12.580</a></span> | <span class="t">Once you get an out of memory error on your GPU, you can't really recover from it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5417" target="_blank">01:30:17.140</a></span> | <span class="t">It doesn't matter what you do, you have to restart.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5421" target="_blank">01:30:21.780</a></span> | <span class="t">And once I restarted, I then just changed my batch size to something smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5426" target="_blank">01:30:26.000</a></span> | <span class="t">So when you call createYourData object, you can pass in a batch size parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5435" target="_blank">01:30:35.180</a></span> | <span class="t">And I normally use 64 until I hit something that says out of memory, and then I just halve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5440" target="_blank">01:30:40.060</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5441" target="_blank">01:30:41.060</a></span> | <span class="t">And if I still get out of memory, I'll just halve it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5444" target="_blank">01:30:44.940</a></span> | <span class="t">So that's where I created this, to allow me to start making my sizes bigger as I looked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5448" target="_blank">01:30:48.780</a></span> | <span class="t">into it more and as I started running out of memory to decrease my batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5453" target="_blank">01:30:53.780</a></span> | <span class="t">So at this point, I went through this a couple of iterations, but I basically found everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5459" target="_blank">01:30:59.940</a></span> | <span class="t">was working fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5460" target="_blank">01:31:00.940</a></span> | <span class="t">Once it was working fine, I set size to 224, and I created my pre-computed equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5469" target="_blank">01:31:09.800</a></span> | <span class="t">First time I did that it took a minute to create the pre-computed activations, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5473" target="_blank">01:31:13.700</a></span> | <span class="t">it ran through this in about 4 or 5 seconds, and you can see I was getting 83% accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5479" target="_blank">01:31:19.220</a></span> | <span class="t">Now remember accuracy means it's exactly right, and so it's predicting out of 120 categories.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5487" target="_blank">01:31:27.420</a></span> | <span class="t">So when you see something with 2 classes is 80% accurate versus something with 120 classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5494" target="_blank">01:31:34.380</a></span> | <span class="t">is 80% accurate, they're very different levels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5498" target="_blank">01:31:38.700</a></span> | <span class="t">So when I saw 83% accuracy with just a pre-computed classifier, no data augmentation, no unfreezing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5506" target="_blank">01:31:46.060</a></span> | <span class="t">anything else across 120 classes, oh this looks good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5511" target="_blank">01:31:51.540</a></span> | <span class="t">So then I just kept going through our little standard process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5517" target="_blank">01:31:57.220</a></span> | <span class="t">So then I turned pre-compute off, and cycle length equals 1, and I started doing a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5528" target="_blank">01:32:08.060</a></span> | <span class="t">more cycles, a few more epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5531" target="_blank">01:32:11.940</a></span> | <span class="t">So remember an epoch is 1 passed through the data, and a cycle is however many epochs you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5541" target="_blank">01:32:21.760</a></span> | <span class="t">said is in a cycle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5543" target="_blank">01:32:23.100</a></span> | <span class="t">It's the learning rate going from the top that you asked for all the way down to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5548" target="_blank">01:32:28.200</a></span> | <span class="t">So since here cycle length equals 1, a cycle and an epoch are the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5553" target="_blank">01:32:33.780</a></span> | <span class="t">So I tried a few epochs, I did actually do the learning rate finder, and I found one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5560" target="_blank">01:32:40.580</a></span> | <span class="t">in a 2 again looks fine, it often looks fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5564" target="_blank">01:32:44.940</a></span> | <span class="t">And I found it kept improving, so I tried 5 epochs and I found my accuracy getting better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5572" target="_blank">01:32:52.620</a></span> | <span class="t">So then I saved that and I tried something which we haven't looked at before, but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5578" target="_blank">01:32:58.140</a></span> | <span class="t">kind of cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5580" target="_blank">01:33:00.300</a></span> | <span class="t">If you train something on a smaller size, you can then actually call learn.setData()</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5588" target="_blank">01:33:08.340</a></span> | <span class="t">and pass in a larger size dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5591" target="_blank">01:33:11.460</a></span> | <span class="t">And that's going to take your model, however it's trained so far, and it's going to let</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5596" target="_blank">01:33:16.020</a></span> | <span class="t">you continue to train on larger images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5600" target="_blank">01:33:20.420</a></span> | <span class="t">And I'll tell you something amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5603" target="_blank">01:33:23.220</a></span> | <span class="t">This actually is another way you can get state-of-the-art results, and I've never seen this written</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5607" target="_blank">01:33:27.580</a></span> | <span class="t">in any paper or discussed anywhere as far as I know this is a new insight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5613" target="_blank">01:33:33.300</a></span> | <span class="t">Basically I've got a pre-trained model, which in this case I've trained a few epochs with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5617" target="_blank">01:33:37.940</a></span> | <span class="t">a size of 224x224, and I'm now going to do a few more epochs with a size of 299x299.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5625" target="_blank">01:33:45.340</a></span> | <span class="t">Now I've got very little data kind of by deep learning standards, I've only got 10,000 images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5631" target="_blank">01:33:51.340</a></span> | <span class="t">So with a 224x224 I kind of built these final layers to try to find things that worked well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5638" target="_blank">01:33:58.060</a></span> | <span class="t">at 224x224.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5639" target="_blank">01:33:59.060</a></span> | <span class="t">When I go to 299x299, if I overfit the 4, I'm definitely not going to overfit now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5647" target="_blank">01:34:07.380</a></span> | <span class="t">I've changed the size of my images, they're kind of totally different, but conceptually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5652" target="_blank">01:34:12.820</a></span> | <span class="t">they're still the same kinds of pictures as the same kinds of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5656" target="_blank">01:34:16.420</a></span> | <span class="t">So I found this trick of starting training on small images for a few epochs and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5661" target="_blank">01:34:21.180</a></span> | <span class="t">switching to bigger images and continuing training is an amazingly effective way to avoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5666" target="_blank">01:34:26.380</a></span> | <span class="t">overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5669" target="_blank">01:34:29.380</a></span> | <span class="t">And it's so easy and so obvious, I don't understand why it's never been written about before, maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5675" target="_blank">01:34:35.500</a></span> | <span class="t">it's in some paper somewhere and I haven't found it, but I haven't seen it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5680" target="_blank">01:34:40.900</a></span> | <span class="t">Would it be possible to do the same thing using let's take care of TensorFlow as well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5689" target="_blank">01:34:49.340</a></span> | <span class="t">to feed an image of different science?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5691" target="_blank">01:34:51.660</a></span> | <span class="t">Yeah, I think so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5693" target="_blank">01:34:53.700</a></span> | <span class="t">As long as you use one of these more modern architectures, what we call fully convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5698" target="_blank">01:34:58.380</a></span> | <span class="t">architectures, which means not VGG, and you'll see we don't use VGG in this course because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5703" target="_blank">01:35:03.800</a></span> | <span class="t">it doesn't have this property, but most of the architectures developed in the last couple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5708" target="_blank">01:35:08.100</a></span> | <span class="t">of years can handle pretty much arbitrary sizes, it would be worth trying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5714" target="_blank">01:35:14.660</a></span> | <span class="t">I think it ought to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5718" target="_blank">01:35:18.060</a></span> | <span class="t">So I call getData again, remember getData is just the little function that I created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5721" target="_blank">01:35:21.580</a></span> | <span class="t">back up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5722" target="_blank">01:35:22.580</a></span> | <span class="t">GetData is just this little function, so I just passed a different size to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5727" target="_blank">01:35:27.900</a></span> | <span class="t">And so I call freeze just to make sure that everything except the last layer is frozen,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5734" target="_blank">01:35:34.220</a></span> | <span class="t">I mean actually it already was at these points that didn't really do anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5742" target="_blank">01:35:42.700</a></span> | <span class="t">You can see now with free compute off, I've now got data augmentation working, so I kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5747" target="_blank">01:35:47.500</a></span> | <span class="t">of run a few more epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5749" target="_blank">01:35:49.740</a></span> | <span class="t">And what I notice here is that the loss of my training set and the loss of my validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5755" target="_blank">01:35:55.940</a></span> | <span class="t">set losses a lot lower than my training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5758" target="_blank">01:35:58.580</a></span> | <span class="t">This is still just training the last layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5760" target="_blank">01:36:00.860</a></span> | <span class="t">So what this is telling me is I'm underfitting, and so if I'm underfitting, it means the cycle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5766" target="_blank">01:36:06.340</a></span> | <span class="t">length equals 1 is too short, it means it's like finding something better, popping out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5770" target="_blank">01:36:10.980</a></span> | <span class="t">and never getting a chance to zoom in properly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5774" target="_blank">01:36:14.320</a></span> | <span class="t">So then I set cycle_malt = 2 to give it more time, so the first time is 1 epoch, the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5781" target="_blank">01:36:21.580</a></span> | <span class="t">one is 2 epochs, the third one is 4 epochs, and you can see now the validation train and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5788" target="_blank">01:36:28.300</a></span> | <span class="t">training are about the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5790" target="_blank">01:36:30.700</a></span> | <span class="t">So that's kind of thinking yeah, this is about the right track.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5794" target="_blank">01:36:34.620</a></span> | <span class="t">And so then I tried using test time augmentation to see if that gets any better still, it didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5800" target="_blank">01:36:40.020</a></span> | <span class="t">actually help a hell of a lot, just a tiny bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5803" target="_blank">01:36:43.620</a></span> | <span class="t">And just at this point I'm thinking this is nearly done, so I just did one more cycle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5809" target="_blank">01:36:49.700</a></span> | <span class="t">of 2 to see if it got any better, and it did get a little bit better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5814" target="_blank">01:36:54.220</a></span> | <span class="t">And then I'm like okay, that looks pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5817" target="_blank">01:36:57.580</a></span> | <span class="t">I've got a validation set loss of 0.199.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5823" target="_blank">01:37:03.980</a></span> | <span class="t">And so you'll notice here I actually haven't tried unfreezing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5827" target="_blank">01:37:07.540</a></span> | <span class="t">The reason why was when I tried unfreezing and training more, it didn't get any better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5832" target="_blank">01:37:12.180</a></span> | <span class="t">And so the reason for this clearly is that this data set is so similar to ImageNet, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5838" target="_blank">01:37:18.820</a></span> | <span class="t">training that convolutional layers actually doesn't help in the slightest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5842" target="_blank">01:37:22.780</a></span> | <span class="t">And actually when I later looked into it, it turns out that this competition is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5847" target="_blank">01:37:27.180</a></span> | <span class="t">using a subset of ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5851" target="_blank">01:37:31.860</a></span> | <span class="t">So then if we check this out, 0.199 against the leaderboard, this is only a playground</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5857" target="_blank">01:37:37.740</a></span> | <span class="t">competition so it's not like the best here, but it's still interesting, it gets us somewhere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5865" target="_blank">01:37:45.780</a></span> | <span class="t">around 10th or 11th.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5869" target="_blank">01:37:49.180</a></span> | <span class="t">In fact we're competing against, I notice this is a first AI student, these people up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5878" target="_blank">01:37:58.020</a></span> | <span class="t">here, I know they actually posted that they cheated, they actually went and downloaded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5881" target="_blank">01:38:01.900</a></span> | <span class="t">the original images and trained for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5887" target="_blank">01:38:07.500</a></span> | <span class="t">This is why this is a playground competition, it's not real, it's just to allow us to try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5893" target="_blank">01:38:13.300</a></span> | <span class="t">things out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5894" target="_blank">01:38:14.300</a></span> | <span class="t">We basically see out of 200 and something people, we're getting some very good results</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5903" target="_blank">01:38:23.260</a></span> | <span class="t">without doing anything remotely interesting or clever, and we haven't even used the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5906" target="_blank">01:38:26.740</a></span> | <span class="t">data set, we've only used 80% of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5909" target="_blank">01:38:29.140</a></span> | <span class="t">To get a better result, I would go back and remove that validation set and just re-run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5913" target="_blank">01:38:33.500</a></span> | <span class="t">the same steps and then submit that, let's just use 100% of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5918" target="_blank">01:38:38.100</a></span> | <span class="t">I have three questions, the first one is that class in this case is not balanced, it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5934" target="_blank">01:38:54.420</a></span> | <span class="t">balanced.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5935" target="_blank">01:38:55.420</a></span> | <span class="t">It's not totally balanced but it's not bad, it's like between 60 and 100, it's not unbalanced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5944" target="_blank">01:39:04.620</a></span> | <span class="t">enough that I would give it a second thought.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5953" target="_blank">01:39:13.680</a></span> | <span class="t">Let's get to that later in this course, and don't let me forget.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5957" target="_blank">01:39:17.340</a></span> | <span class="t">The short answer is that there was a recent list, a paper came out about two or three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5960" target="_blank">01:39:20.500</a></span> | <span class="t">weeks ago on this and it said the best way to deal with very unbalanced data sets is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5965" target="_blank">01:39:25.100</a></span> | <span class="t">to basically make copies of the rare cases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5971" target="_blank">01:39:31.020</a></span> | <span class="t">My second question is, I want to pin down a difference between pre-computed and unscrewed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5983" target="_blank">01:39:43.300</a></span> | <span class="t">so you have these two options here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5984" target="_blank">01:39:44.860</a></span> | <span class="t">So when you are beginning to add data augmentation, you said pre-computed is true, but in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5990" target="_blank">01:39:50.860</a></span> | <span class="t">case, the layers are still true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5993" target="_blank">01:39:53.180</a></span> | <span class="t">And not only are they frozen, they're pre-computed, so the data augmentation doesn't do anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5996" target="_blank">01:39:56.740</a></span> | <span class="t">at that point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=5997" target="_blank">01:39:57.740</a></span> | <span class="t">What you said pre-computed equals true, but before you increase everything, what does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6004" target="_blank">01:40:04.660</a></span> | <span class="t">exactly do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6005" target="_blank">01:40:05.660</a></span> | <span class="t">You only increase the activation?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6009" target="_blank">01:40:09.020</a></span> | <span class="t">So we're going to learn more about the details as we look into the math and stuff in coming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6013" target="_blank">01:40:13.380</a></span> | <span class="t">lessons, but basically what happened was we started with a pre-trained network, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6019" target="_blank">01:40:19.940</a></span> | <span class="t">was finding activations that had these kind of rich features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6026" target="_blank">01:40:26.540</a></span> | <span class="t">And then we add a couple of layers on the end of it, which start out random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6033" target="_blank">01:40:33.380</a></span> | <span class="t">And so with everything frozen, and indeed with pre-compute equals true, all we're learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6040" target="_blank">01:40:40.360</a></span> | <span class="t">is those couple of layers that we've added.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6044" target="_blank">01:40:44.080</a></span> | <span class="t">And so with pre-compute equals true, we actually pre-calculate how much does this image have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6049" target="_blank">01:40:49.380</a></span> | <span class="t">something that looks like this eyeball and looks like this face and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6053" target="_blank">01:40:53.500</a></span> | <span class="t">And therefore data augmentation doesn't do anything with pre-compute equals true, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6057" target="_blank">01:40:57.300</a></span> | <span class="t">we're actually showing exactly the same activations each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6061" target="_blank">01:41:01.980</a></span> | <span class="t">We can then set pre-compute equals false, which means it's still only training those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6066" target="_blank">01:41:06.700</a></span> | <span class="t">last two layers that we added, it's still frozen, but data augmentation is now working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6072" target="_blank">01:41:12.260</a></span> | <span class="t">because it's actually going through and recalculating all of the activations from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6077" target="_blank">01:41:17.100</a></span> | <span class="t">And then finally when we unfreeze, that's actually saying okay, now you can go ahead and change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6081" target="_blank">01:41:21.700</a></span> | <span class="t">all of these earlier convolutional filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6090" target="_blank">01:41:30.260</a></span> | <span class="t">The only reason to have pre-compute equals true is it's just much faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6094" target="_blank">01:41:34.500</a></span> | <span class="t">It's about 10 or more times faster, so particularly if you're working with quite a large data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6101" target="_blank">01:41:41.400</a></span> | <span class="t">it can save quite a bit of time, but there's no accuracy reason ever to use pre-compute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6110" target="_blank">01:41:50.300</a></span> | <span class="t">equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6111" target="_blank">01:41:51.300</a></span> | <span class="t">So it's just a short plan.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6112" target="_blank">01:41:52.540</a></span> | <span class="t">It's also quite handy if you're throwing together a quick model, it can take a few seconds to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6119" target="_blank">01:41:59.300</a></span> | <span class="t">create it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6122" target="_blank">01:42:02.300</a></span> | <span class="t">If your question is like is there some shorter version of this that's a bit quicker and easier,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6149" target="_blank">01:42:29.980</a></span> | <span class="t">I could like to delete a few things here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6160" target="_blank">01:42:40.100</a></span> | <span class="t">I think this is a kind of a minimal version to get you a very good result, which is like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6164" target="_blank">01:42:44.980</a></span> | <span class="t">don't worry about pre-compute equals true because that's just saving a little bit of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6168" target="_blank">01:42:48.060</a></span> | <span class="t">time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6169" target="_blank">01:42:49.060</a></span> | <span class="t">So I would still suggest use lrfind at the start to find a good learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6175" target="_blank">01:42:55.940</a></span> | <span class="t">By default, everything is frozen from the start, so you can just go ahead and run a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6179" target="_blank">01:42:59.620</a></span> | <span class="t">2 or 3 epochs with cycle equals 1, unfreeze, and then train the rest of the network with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6186" target="_blank">01:43:06.500</a></span> | <span class="t">differential learning rates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6187" target="_blank">01:43:07.700</a></span> | <span class="t">So it's basically 3 steps, learning rate finder, train frozen network with cycle equals 1,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6196" target="_blank">01:43:16.620</a></span> | <span class="t">and then train unfrozen network with differential learning rates and cycle multiples 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6202" target="_blank">01:43:22.140</a></span> | <span class="t">So that's something you could turn into, I guess, 5 or 6 lines of code total.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6210" target="_blank">01:43:30.420</a></span> | <span class="t">By reducing the batch size, does it only affect the speed of training?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6219" target="_blank">01:43:39.020</a></span> | <span class="t">Yeah, pretty much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6220" target="_blank">01:43:40.020</a></span> | <span class="t">So each batch, and again we're going to see all this stuff about pre-compute and batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6224" target="_blank">01:43:44.340</a></span> | <span class="t">size as we dig into the details of the algorithm, it's going to make a lot more sense intuitively.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6229" target="_blank">01:43:49.060</a></span> | <span class="t">But basically if you're showing it less images each time, then it's calculating the gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6237" target="_blank">01:43:57.300</a></span> | <span class="t">with less images, which means it's less accurate, which means knowing which direction to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6241" target="_blank">01:44:01.740</a></span> | <span class="t">and how far to go in that direction is less accurate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6245" target="_blank">01:44:05.660</a></span> | <span class="t">So as you make the batch size smaller, you're basically making it more volatile.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6251" target="_blank">01:44:11.340</a></span> | <span class="t">It kind of impacts the optimal learning rate that you would need to use, but in practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6262" target="_blank">01:44:22.540</a></span> | <span class="t">I generally find I'm only dividing the batch size by 2 or 4, it doesn't seem to change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6267" target="_blank">01:44:27.700</a></span> | <span class="t">things very much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6268" target="_blank">01:44:28.700</a></span> | <span class="t">Should I reduce the learning rate accordingly?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6272" target="_blank">01:44:32.300</a></span> | <span class="t">If you change the batch size by much, you can re-run the learning rate finder to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6276" target="_blank">01:44:36.380</a></span> | <span class="t">if it's changed by much, but since we're only generally looking at a power of 10, it probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6281" target="_blank">01:44:41.300</a></span> | <span class="t">is not going to change things enough that you can't think of it as a possibility.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6285" target="_blank">01:44:45.700</a></span> | <span class="t">This is sort of a conceptual and basic question, so going back to the previous slide where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6292" target="_blank">01:44:52.460</a></span> | <span class="t">you showed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6293" target="_blank">01:44:53.460</a></span> | <span class="t">Could you lift that up at home?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6294" target="_blank">01:44:54.460</a></span> | <span class="t">Sorry, yeah, this is more of a conceptual and basic question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6298" target="_blank">01:44:58.460</a></span> | <span class="t">Going back to your previous slide where you showed what the different layers were doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6306" target="_blank">01:45:06.460</a></span> | <span class="t">So in this slide, I understand the meaning of the third column relative to the fourth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6312" target="_blank">01:45:12.980</a></span> | <span class="t">column is that you're interpreting what the layer is doing based on what images actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6320" target="_blank">01:45:20.960</a></span> | <span class="t">trigger that layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6321" target="_blank">01:45:21.960</a></span> | <span class="t">Yeah, so we're going to look at this in more detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6324" target="_blank">01:45:24.420</a></span> | <span class="t">So these grey ones basically say this is kind of what the filter looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6328" target="_blank">01:45:28.900</a></span> | <span class="t">So on the first layer you can see exactly what the filter looks like because the input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6333" target="_blank">01:45:33.020</a></span> | <span class="t">to it are pixels, so you can absolutely say and remember we looked at what a convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6337" target="_blank">01:45:37.220</a></span> | <span class="t">kernel was, like a 3x3 thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6340" target="_blank">01:45:40.620</a></span> | <span class="t">So these look like they're 7x7 kernels, you can say this is actually what it looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6345" target="_blank">01:45:45.060</a></span> | <span class="t">But later on the input to it are themselves activations which are combinations of activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6352" target="_blank">01:45:52.940</a></span> | <span class="t">which are combinations of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6354" target="_blank">01:45:54.100</a></span> | <span class="t">So you can't draw it, but there's a clever technique that Ziler and Fergus created which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6358" target="_blank">01:45:58.780</a></span> | <span class="t">allowed them to say this is kind of what the filters tended to look like on average, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6364" target="_blank">01:46:04.100</a></span> | <span class="t">this is kind of what the filters looked like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6366" target="_blank">01:46:06.020</a></span> | <span class="t">And then here is specific examples of patches of image which activated that filter highly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6374" target="_blank">01:46:14.340</a></span> | <span class="t">So the pictures are the ones that I kind of find more useful because it tells you this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6379" target="_blank">01:46:19.860</a></span> | <span class="t">kernel is kind of a unicycle wheel finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6383" target="_blank">01:46:23.860</a></span> | <span class="t">Well we may come back to that, if not in this part and the next part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6405" target="_blank">01:46:45.100</a></span> | <span class="t">Probably in part 2 actually because this paper uses to create these things, this paper uses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6410" target="_blank">01:46:50.460</a></span> | <span class="t">something called a deconvolution which I'm pretty sure we won't do in this part, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6414" target="_blank">01:46:54.300</a></span> | <span class="t">we will do it in part 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6415" target="_blank">01:46:55.460</a></span> | <span class="t">So if you're interested, check out the paper, it's in the notebook, there's a link to it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6421" target="_blank">01:47:01.620</a></span> | <span class="t">Ziler and Fergus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6422" target="_blank">01:47:02.620</a></span> | <span class="t">It's a very clever technique and not terribly intuitive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6431" target="_blank">01:47:11.940</a></span> | <span class="t">So you mentioned that it was good that the dog took up the full picture and it would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6441" target="_blank">01:47:21.540</a></span> | <span class="t">have been a problem if it was kind of like off in one of the corners and really tiny.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6446" target="_blank">01:47:26.900</a></span> | <span class="t">What would your technique have been to try to make that work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6453" target="_blank">01:47:33.940</a></span> | <span class="t">Something that we'll learn about in part 2, but basically there's a technique that allows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6458" target="_blank">01:47:38.900</a></span> | <span class="t">you to figure out roughly which parts of an image are most likely to have the interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6464" target="_blank">01:47:44.860</a></span> | <span class="t">things in them, and then you can crop out those bits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6469" target="_blank">01:47:49.300</a></span> | <span class="t">If you're interested in learning about it, we did cover it briefly in lesson 7 of part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6474" target="_blank">01:47:54.580</a></span> | <span class="t">1, but I'm going to actually do it properly in part 2 of this course because I didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6481" target="_blank">01:48:01.580</a></span> | <span class="t">really cover it thoroughly enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6483" target="_blank">01:48:03.580</a></span> | <span class="t">Maybe we'll find time to have a quick look at it, but we'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6489" target="_blank">01:48:09.380</a></span> | <span class="t">I know UNET's written some of the code that we need already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6497" target="_blank">01:48:17.220</a></span> | <span class="t">So once I have something like this notebook that's basically working, I can immediately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6506" target="_blank">01:48:26.380</a></span> | <span class="t">make it better by doing two things, assuming that the size image I was using is smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6513" target="_blank">01:48:33.680</a></span> | <span class="t">than the average size of the image that we've been given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6516" target="_blank">01:48:36.340</a></span> | <span class="t">I can increase the size, and as I showed before with the dog breeds, you can actually increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6520" target="_blank">01:48:40.900</a></span> | <span class="t">it during training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6522" target="_blank">01:48:42.820</a></span> | <span class="t">The other thing I can do is to use a better architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6528" target="_blank">01:48:48.180</a></span> | <span class="t">We're going to talk a lot in this course about architectures, but basically there are different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6537" target="_blank">01:48:57.580</a></span> | <span class="t">ways of putting together what size convolutional filters and how they're connected to each other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6543" target="_blank">01:49:03.260</a></span> | <span class="t">and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6546" target="_blank">01:49:06.660</a></span> | <span class="t">Different architectures have different numbers of layers and sizes of kernels and number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6550" target="_blank">01:49:10.660</a></span> | <span class="t">of filters and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6556" target="_blank">01:49:16.460</a></span> | <span class="t">The one that we've been using, ResNet-34, is a great starting point and often a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6561" target="_blank">01:49:21.740</a></span> | <span class="t">finishing point because it doesn't have too many parameters, often it works pretty well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6567" target="_blank">01:49:27.140</a></span> | <span class="t">with small amounts of data as we've seen and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6571" target="_blank">01:49:31.860</a></span> | <span class="t">But there's actually an architecture that I really like called ResNet but ResNext, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6577" target="_blank">01:49:37.460</a></span> | <span class="t">was actually the second place winner in last year's ImageNet competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6584" target="_blank">01:49:44.620</a></span> | <span class="t">Like ResNet, you can put a number after the ResNext to say how big it is, and my next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6590" target="_blank">01:49:50.780</a></span> | <span class="t">step after ResNet-34 is always ResNext-50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6594" target="_blank">01:49:54.700</a></span> | <span class="t">You'll find ResNext-50 can take twice as long as ResNet-34, it can take 2 to 4 times as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6603" target="_blank">01:50:03.260</a></span> | <span class="t">much memory as ResNet-34.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6607" target="_blank">01:50:07.060</a></span> | <span class="t">So what I wanted to do was I wanted to rerun that previous notebook with ResNext and increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6612" target="_blank">01:50:12.140</a></span> | <span class="t">in the image size to 299.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6614" target="_blank">01:50:14.380</a></span> | <span class="t">So here I just said architecture = ResNext-50, size = 299, and then I found that I had to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6620" target="_blank">01:50:20.460</a></span> | <span class="t">take the batch size all the way back to 28 to get it to fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6623" target="_blank">01:50:23.740</a></span> | <span class="t">My GPU is 11GB, if you're using AWS or Cressel, I think they're like 12GB, so you might be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6630" target="_blank">01:50:30.300</a></span> | <span class="t">able to make it a bit higher, but this is what I found I had to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6633" target="_blank">01:50:33.380</a></span> | <span class="t">So then this is literally a copy of the previous notebook, so you can actually go file, make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6637" target="_blank">01:50:37.820</a></span> | <span class="t">a copy, and then rerun it with these different parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6643" target="_blank">01:50:43.060</a></span> | <span class="t">And so I deleted some of the pros and some of the exploratory stuff to see, basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6648" target="_blank">01:50:48.940</a></span> | <span class="t">I said everything else is the same, all the same steps as before, in fact you can kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6654" target="_blank">01:50:54.460</a></span> | <span class="t">of see what this minimum set of steps looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6656" target="_blank">01:50:56.580</a></span> | <span class="t">I didn't need to worry about learning rate finder, so I just left it as is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6660" target="_blank">01:51:00.560</a></span> | <span class="t">Transforms, data = learn = fit, pre-compute = false, fit, fit cycle length = 1, unfreeze,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6669" target="_blank">01:51:09.860</a></span> | <span class="t">cycle learning rates, fit some more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6673" target="_blank">01:51:13.020</a></span> | <span class="t">And you can see here I didn't do the cycle-mult thing, because I found now that I'm using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6678" target="_blank">01:51:18.400</a></span> | <span class="t">a bigger architecture, it's got more parameters, it was overfitting pretty quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6683" target="_blank">01:51:23.660</a></span> | <span class="t">So rather than cycle length = 1, never finding the right spot, it actually did find the right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6688" target="_blank">01:51:28.420</a></span> | <span class="t">spot and if I used longer cycle lengths, I found that my validation error was higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6696" target="_blank">01:51:36.260</a></span> | <span class="t">than my training error, it was overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6699" target="_blank">01:51:39.920</a></span> | <span class="t">So check this out though, by using these 3 steps, I got +TTA, I got 99.75.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6708" target="_blank">01:51:48.320</a></span> | <span class="t">So what does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6709" target="_blank">01:51:49.760</a></span> | <span class="t">That means I have one incorrect dog, four incorrect cats, and when we look at the pictures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6715" target="_blank">01:51:55.300</a></span> | <span class="t">of them, my incorrect dog has a cat in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6721" target="_blank">01:52:01.580</a></span> | <span class="t">This one is not either, so I've actually got one mistake, and then my incorrect dog is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6729" target="_blank">01:52:09.380</a></span> | <span class="t">teeth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6732" target="_blank">01:52:12.080</a></span> | <span class="t">So we're at a point where we're now able to train a classifier that's so good that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6738" target="_blank">01:52:18.700</a></span> | <span class="t">has like basically one mistake.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6743" target="_blank">01:52:23.780</a></span> | <span class="t">And so when people say we have super-human image performance now, this is kind of what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6748" target="_blank">01:52:28.220</a></span> | <span class="t">they're talking about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6749" target="_blank">01:52:29.500</a></span> | <span class="t">So when I looked at the dog breed one I did this morning, it was getting the dog breeds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6756" target="_blank">01:52:36.580</a></span> | <span class="t">much better than I ever could.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6760" target="_blank">01:52:40.240</a></span> | <span class="t">So this is what we can get to if you use a really modern architecture like ResNext.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6766" target="_blank">01:52:46.700</a></span> | <span class="t">And this only took, I don't know, 20 minutes to train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6774" target="_blank">01:52:54.880</a></span> | <span class="t">So that's kind of where we're up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6779" target="_blank">01:52:59.080</a></span> | <span class="t">So if you wanted to do satellite imagery instead, then it's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6787" target="_blank">01:53:07.860</a></span> | <span class="t">And in fact the planet satellite data set is already on Cresol, if you're using Cresol</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6792" target="_blank">01:53:12.020</a></span> | <span class="t">you can jump straight there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6794" target="_blank">01:53:14.940</a></span> | <span class="t">And I just linked it into data/planet, and I can do exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6801" target="_blank">01:53:21.380</a></span> | <span class="t">I can image classifier from CSV, and you can see these three lines are exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6810" target="_blank">01:53:30.660</a></span> | <span class="t">as my dog breed lines, how many lines are in the file, grab my validation indexes, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6817" target="_blank">01:53:37.060</a></span> | <span class="t">get data, as you can see it's identical except I've changed side on to top down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6823" target="_blank">01:53:43.060</a></span> | <span class="t">The satellite images are like top down, so I can fit them vertically and they still make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6827" target="_blank">01:53:47.820</a></span> | <span class="t">sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6828" target="_blank">01:53:48.820</a></span> | <span class="t">And so you can see here I'm doing this trick where I'm going to do size=64 and train a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6834" target="_blank">01:53:54.380</a></span> | <span class="t">little bit, the first learning rate finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6837" target="_blank">01:53:57.540</a></span> | <span class="t">And interestingly in this case you can see I want really high learning rates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6842" target="_blank">01:54:02.380</a></span> | <span class="t">I don't know what it is about this particular dataset, this is true, but clearly I can use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6847" target="_blank">01:54:07.340</a></span> | <span class="t">super high learning rates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6848" target="_blank">01:54:08.340</a></span> | <span class="t">So I used a learning rate of 0.2, and so I've trained for a while, differential learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6854" target="_blank">01:54:14.460</a></span> | <span class="t">rates, and so remember I said like if the dataset is very different to ImageNet, I probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6861" target="_blank">01:54:21.180</a></span> | <span class="t">want to train those middle layers a lot more, so I'm using divided by 3 rather than divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6866" target="_blank">01:54:26.020</a></span> | <span class="t">by 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6867" target="_blank">01:54:27.020</a></span> | <span class="t">Other than that, here's the same thing, cycle mod equals 2, and then I was just kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6873" target="_blank">01:54:33.620</a></span> | <span class="t">keeping an eye on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6874" target="_blank">01:54:34.620</a></span> | <span class="t">So you can actually plot the loss if you go to learn.shed.plotloss, and you can see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6878" target="_blank">01:54:38.540</a></span> | <span class="t">is the first cycle, here's the second cycle, here's the third cycle, so you can see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6884" target="_blank">01:54:44.260</a></span> | <span class="t">work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6885" target="_blank">01:54:45.260</a></span> | <span class="t">It's better, it pops out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6886" target="_blank">01:54:46.260</a></span> | <span class="t">It's better, it pops out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6887" target="_blank">01:54:47.260</a></span> | <span class="t">It's better, it pops out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6888" target="_blank">01:54:48.260</a></span> | <span class="t">And each time it finds something better than the last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6891" target="_blank">01:54:51.140</a></span> | <span class="t">Then set the size up to 128, and just repeat exactly the last few steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6896" target="_blank">01:54:56.580</a></span> | <span class="t">And then set it up to 256, and repeat the last two steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6901" target="_blank">01:55:01.860</a></span> | <span class="t">And then do TTA, and if you submit this, then this gets about 30th place in this competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6910" target="_blank">01:55:10.220</a></span> | <span class="t">So these basic steps work super well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6913" target="_blank">01:55:13.140</a></span> | <span class="t">This thing where I went all the way back to a size of 64, I wouldn't do that if I was doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6920" target="_blank">01:55:20.380</a></span> | <span class="t">like dogs and cats or dog breeds, because this is so small that if the thing I was working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6926" target="_blank">01:55:26.140</a></span> | <span class="t">on was very similar to ImageNet, I would kind of destroy those ImageNet weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6931" target="_blank">01:55:31.940</a></span> | <span class="t">Like 64 by 64 is so small, but in this case the satellite imagery data is so different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6936" target="_blank">01:55:36.580</a></span> | <span class="t">to ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6937" target="_blank">01:55:37.580</a></span> | <span class="t">I really found that it worked pretty well to start right back to these tiny images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6943" target="_blank">01:55:43.280</a></span> | <span class="t">It really helped me to avoid overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6946" target="_blank">01:55:46.300</a></span> | <span class="t">And interestingly, using this kind of approach, I actually found that even with using only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6951" target="_blank">01:55:51.060</a></span> | <span class="t">128 by 128, I was getting much better Kaggle results than nearly everybody on the leaderboard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6958" target="_blank">01:55:58.340</a></span> | <span class="t">And when I say 30th place, this is a very recent competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6962" target="_blank">01:56:02.100</a></span> | <span class="t">And so I find in the last year, a lot of people have got a lot better at computer vision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6967" target="_blank">01:56:07.700</a></span> | <span class="t">And so the people in the top 50 in this competition were generally ensembling dozens of models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6972" target="_blank">01:56:12.860</a></span> | <span class="t">lots of people on a team, lots of pre-processing specific satellite data and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6978" target="_blank">01:56:18.220</a></span> | <span class="t">So to be able to get 30th using this totally standard technique is pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6987" target="_blank">01:56:27.220</a></span> | <span class="t">So now that we've got to this point, we've got through two lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6990" target="_blank">01:56:30.860</a></span> | <span class="t">If you're still here, then hopefully you're thinking okay, this is actually pretty useful,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=6997" target="_blank">01:56:37.020</a></span> | <span class="t">I want to do more, in which case Cressel might not be where you want to stay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7002" target="_blank">01:56:42.580</a></span> | <span class="t">The issues with Cressel, it's pretty handy, it's pretty cheap, and something we haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7007" target="_blank">01:56:47.580</a></span> | <span class="t">talked about much is PaperSpace is another great choice, by the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7012" target="_blank">01:56:52.020</a></span> | <span class="t">PaperSpace is shortly going to be releasing Cressel-like instant Jupyter notebooks, unfortunately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7016" target="_blank">01:56:56.900</a></span> | <span class="t">they're not ready quite yet, but basically they have the best price performance relationship</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7024" target="_blank">01:57:04.460</a></span> | <span class="t">right now, and you can SSH into them and use them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7028" target="_blank">01:57:08.500</a></span> | <span class="t">So they're also a great choice, and probably by the time this is a MOOC, we'll probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7033" target="_blank">01:57:13.260</a></span> | <span class="t">have a separate lesson showing you how to set up PaperSpace because they're likely to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7038" target="_blank">01:57:18.140</a></span> | <span class="t">be a great option.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7039" target="_blank">01:57:19.460</a></span> | <span class="t">But at some point you're probably going to want to look at AWS, a couple of reasons why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7045" target="_blank">01:57:25.580</a></span> | <span class="t">The first is, as you all know by now, Amazon have been kind enough to donate about $200,000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7053" target="_blank">01:57:33.020</a></span> | <span class="t">worth of compute time to this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7055" target="_blank">01:57:35.940</a></span> | <span class="t">So I want to say thank you very much to Amazon, we've all been given credits, everybody is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7061" target="_blank">01:57:41.220</a></span> | <span class="t">here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7062" target="_blank">01:57:42.220</a></span> | <span class="t">Thanks very much to AWS.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7065" target="_blank">01:57:45.300</a></span> | <span class="t">So sorry if you're on the MOOC, we didn't get it for you, but AWS credits for everybody.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7072" target="_blank">01:57:52.540</a></span> | <span class="t">But even if you're not here in person, you can get AWS credits from lots of places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7078" target="_blank">01:57:58.060</a></span> | <span class="t">GitHub has a student pack, Google for GitHub student pack, that's like $150 worth of credits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7083" target="_blank">01:58:03.660</a></span> | <span class="t">AWS Educate can get credits, these are all for students.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7088" target="_blank">01:58:08.260</a></span> | <span class="t">So there's lots of places you can get started on AWS.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7091" target="_blank">01:58:11.540</a></span> | <span class="t">Pretty much everybody, a lot of the people that you might work with will be using AWS</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7099" target="_blank">01:58:19.580</a></span> | <span class="t">because it's super flexible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7101" target="_blank">01:58:21.660</a></span> | <span class="t">Right now AWS has the fastest available GPUs that you can get in the cloud, the P3s.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7109" target="_blank">01:58:29.900</a></span> | <span class="t">They're kind of expensive at 3 bucks an hour, but if you've got a model where you've done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7113" target="_blank">01:58:33.740</a></span> | <span class="t">all the steps before and you're thinking this is looking pretty good, for 6 bucks you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7118" target="_blank">01:58:38.180</a></span> | <span class="t">get a P3 for 2 hours and run at turbo speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7124" target="_blank">01:58:44.660</a></span> | <span class="t">We didn't start with AWS because A, it's twice as expensive as Cressel, the cheapest GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7131" target="_blank">01:58:51.540</a></span> | <span class="t">And B, it takes some setup.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7134" target="_blank">01:58:54.380</a></span> | <span class="t">I wanted to go through and show you how to get your AWS setup, so we're going to be going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7140" target="_blank">01:59:00.320</a></span> | <span class="t">slightly over time to do that, but I want to show you very quickly, so feel free to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7145" target="_blank">01:59:05.340</a></span> | <span class="t">if you have to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7146" target="_blank">01:59:06.340</a></span> | <span class="t">But I want to show you very quickly how you can get your AWS setup from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7153" target="_blank">01:59:13.740</a></span> | <span class="t">Basically you have to go to console.aws.amazon.com and it will take you to the console.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7160" target="_blank">01:59:20.500</a></span> | <span class="t">You can follow along on the video with this because I'm going to do it very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7164" target="_blank">01:59:24.500</a></span> | <span class="t">From here you have to go to EC2, this is where you set up your instances.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7170" target="_blank">01:59:30.300</a></span> | <span class="t">And so from EC2 you need to do what's called launching an instance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7175" target="_blank">01:59:35.640</a></span> | <span class="t">So launching an instance means you're basically creating a computer, you're creating a computer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7180" target="_blank">01:59:40.060</a></span> | <span class="t">on Amazon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7181" target="_blank">01:59:41.060</a></span> | <span class="t">So I say launch instance, and what we've done is we've created a fast AMI, an AMI is like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7188" target="_blank">01:59:48.620</a></span> | <span class="t">a template for how your computer is going to be created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7191" target="_blank">01:59:51.500</a></span> | <span class="t">So if you've got a community AMIs and type in fastai, you'll see that there's one there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7197" target="_blank">01:59:57.180</a></span> | <span class="t">called fastai part 1 version 2 for the P2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7202" target="_blank">02:00:02.500</a></span> | <span class="t">So I'm going to select that, and we need to say what kind of computer do you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7208" target="_blank">02:00:08.020</a></span> | <span class="t">And so I can say I want a GPU computer, and then I can say I want a P2 x lives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7216" target="_blank">02:00:16.340</a></span> | <span class="t">This is the cheapest, reasonably effective for deep learning instance type they have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7221" target="_blank">02:00:21.820</a></span> | <span class="t">And then I can say launch, and then I can say launch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7227" target="_blank">02:00:27.820</a></span> | <span class="t">And so at this point, they ask you to choose a key pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7233" target="_blank">02:00:33.220</a></span> | <span class="t">Now if you don't have the key pair, you have to create one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7237" target="_blank">02:00:37.580</a></span> | <span class="t">So to create a key pair, you need to open your terminal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7246" target="_blank">02:00:46.740</a></span> | <span class="t">If you've got a Mac or a Linux box, you've definitely got one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7249" target="_blank">02:00:49.480</a></span> | <span class="t">If you've got Windows, hopefully you've got Ubuntu.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7253" target="_blank">02:00:53.220</a></span> | <span class="t">If you don't already have Ubuntu set up, you can go to the Windows Store and click on Ubuntu.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7264" target="_blank">02:01:04.180</a></span> | <span class="t">So from there, you basically go ssh-keygen, and that will create like a special password</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7273" target="_blank">02:01:13.860</a></span> | <span class="t">for your computer to be able to log in to Amazon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7276" target="_blank">02:01:16.780</a></span> | <span class="t">And then you just hit enter three times, and that's going to create for you your key that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7282" target="_blank">02:01:22.580</a></span> | <span class="t">you can use to get into Amazon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7285" target="_blank">02:01:25.020</a></span> | <span class="t">So then what I do is I copy that key somewhere that I know where it is, so it will be in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7288" target="_blank">02:01:28.540</a></span> | <span class="t">the .ssh folder, and it's called idrsa.pub.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7293" target="_blank">02:01:33.180</a></span> | <span class="t">And so I'm going to copy it to my hard drive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7299" target="_blank">02:01:39.180</a></span> | <span class="t">So if you're in a Mac or on Linux, it will already be in an easy to find place, it will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7302" target="_blank">02:01:42.300</a></span> | <span class="t">be in your .ssh folder, let's put that in documents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7309" target="_blank">02:01:49.060</a></span> | <span class="t">So from there, back in AWS, you have to tell it that you've created this key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7315" target="_blank">02:01:55.060</a></span> | <span class="t">So you can go to keypairs, and you say import keypair, and you just browse to that file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7322" target="_blank">02:02:02.020</a></span> | <span class="t">that you just created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7323" target="_blank">02:02:03.940</a></span> | <span class="t">There it is, I say import.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7329" target="_blank">02:02:09.900</a></span> | <span class="t">So if you've ever used ssh before, you've already got the keypair, you don't have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7334" target="_blank">02:02:14.140</a></span> | <span class="t">do those steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7335" target="_blank">02:02:15.420</a></span> | <span class="t">If you've used AWS before, you've already imported it, you don't have to do that step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7339" target="_blank">02:02:19.220</a></span> | <span class="t">If you haven't done any of those things, you have to do both steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7344" target="_blank">02:02:24.220</a></span> | <span class="t">So now I can go ahead and launch my instance, community-amis-search-fastai-select-launch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7359" target="_blank">02:02:39.540</a></span> | <span class="t">And so now it asks me where's your keypair, and I can choose that one that I just grabbed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7369" target="_blank">02:02:49.940</a></span> | <span class="t">So this is going to go ahead and create a new computer for me to log into.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7375" target="_blank">02:02:55.380</a></span> | <span class="t">And you can see here, it says the following have been initiated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7378" target="_blank">02:02:58.100</a></span> | <span class="t">So if I click on that, it will show me this new computer that I've created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7385" target="_blank">02:03:05.620</a></span> | <span class="t">So to be able to log into it, I need to know its IP address.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7391" target="_blank">02:03:11.420</a></span> | <span class="t">So here it is, the IP address there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7393" target="_blank">02:03:13.740</a></span> | <span class="t">So I can copy that, and that's the IP address of my computer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7399" target="_blank">02:03:19.420</a></span> | <span class="t">So to get to this computer, I need to SSH to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7402" target="_blank">02:03:22.100</a></span> | <span class="t">So SSH into a computer means connecting to that computer so that it's like you're typing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7406" target="_blank">02:03:26.100</a></span> | <span class="t">that computer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7407" target="_blank">02:03:27.180</a></span> | <span class="t">So I type SSH, and the username for this instance is always Ubuntu.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7414" target="_blank">02:03:34.260</a></span> | <span class="t">And then I can paste in that IP address, and then there's one more thing I have to do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7420" target="_blank">02:03:40.020</a></span> | <span class="t">which is I have to connect up the Jupyter notebook on that instance to the Jupyter notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7425" target="_blank">02:03:45.060</a></span> | <span class="t">on my machine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7426" target="_blank">02:03:46.460</a></span> | <span class="t">And so to do that, there's just a particular flag that I set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7430" target="_blank">02:03:50.220</a></span> | <span class="t">We can talk about it on the forums as to exactly what it does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7433" target="_blank">02:03:53.260</a></span> | <span class="t">But you just type -l 888 localhost 8888.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7439" target="_blank">02:03:59.220</a></span> | <span class="t">So once you've done it once, you can save that as an alias and type in the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7443" target="_blank">02:04:03.360</a></span> | <span class="t">every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7446" target="_blank">02:04:06.120</a></span> | <span class="t">So we can check here, we can see it says that it's running.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7448" target="_blank">02:04:08.880</a></span> | <span class="t">So we should be able to now hit enter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7451" target="_blank">02:04:11.940</a></span> | <span class="t">First time ever we connect to it, it just checks, this is OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7455" target="_blank">02:04:15.340</a></span> | <span class="t">I'll say yes, and then that goes ahead and SSH is in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7462" target="_blank">02:04:22.980</a></span> | <span class="t">So this AMI is all set up for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7469" target="_blank">02:04:29.180</a></span> | <span class="t">So you'll find that the very first time you log in, it takes a few extra seconds because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7472" target="_blank">02:04:32.740</a></span> | <span class="t">it's getting everything set up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7475" target="_blank">02:04:35.020</a></span> | <span class="t">But once it's logged in, you'll see there that there's a directory called fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7480" target="_blank">02:04:40.340</a></span> | <span class="t">And the fastai directory contains our fastai repo that contains all the notebooks, all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7487" target="_blank">02:04:47.760</a></span> | <span class="t">code, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7488" target="_blank">02:04:48.760</a></span> | <span class="t">So I can just go cd fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7491" target="_blank">02:04:51.700</a></span> | <span class="t">First thing you do when you get in is to make sure it's updated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7494" target="_blank">02:04:54.420</a></span> | <span class="t">So you just go git pull, and that updates to make sure that your repo is the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7501" target="_blank">02:05:01.420</a></span> | <span class="t">the most recent repo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7504" target="_blank">02:05:04.380</a></span> | <span class="t">And so as you can see, there we go, let's make sure it's got all the most recent code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7507" target="_blank">02:05:07.760</a></span> | <span class="t">The second thing you should do is type condor end update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7511" target="_blank">02:05:11.900</a></span> | <span class="t">You can just do this maybe once a month or so, and that makes sure that the library is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7515" target="_blank">02:05:15.660</a></span> | <span class="t">there, all the most recent libraries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7518" target="_blank">02:05:18.000</a></span> | <span class="t">I'm not going to run that because it takes a couple of minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7521" target="_blank">02:05:21.100</a></span> | <span class="t">And then the last step is to type Jupyter Notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7527" target="_blank">02:05:27.060</a></span> | <span class="t">So this is going to go ahead and launch the Jupyter Notebook server on this machine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7533" target="_blank">02:05:33.180</a></span> | <span class="t">And the first time I do it, the first time you do everything on AWS, it just takes like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7538" target="_blank">02:05:38.620</a></span> | <span class="t">a minute or two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7540" target="_blank">02:05:40.740</a></span> | <span class="t">And then once you've done it in the future, it will be just as fast as running it locally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7546" target="_blank">02:05:46.780</a></span> | <span class="t">So you can see it's going ahead and firing up the notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7549" target="_blank">02:05:49.700</a></span> | <span class="t">And so what's going to happen is that because when we SSH into it, we said to connect our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7555" target="_blank">02:05:55.180</a></span> | <span class="t">notebook port to the remote notebook port, we're just going to be able to use this locally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7560" target="_blank">02:06:00.340</a></span> | <span class="t">So you can see it says here, copy/paste this URL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7563" target="_blank">02:06:03.020</a></span> | <span class="t">So I'm going to grab that URL, and I'm going to paste it into my browser, and that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7573" target="_blank">02:06:13.580</a></span> | <span class="t">So this notebook is now actually not running on my machine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7577" target="_blank">02:06:17.580</a></span> | <span class="t">It's actually running on AWS using the AWS GPU, which has got a lot of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7582" target="_blank">02:06:22.840</a></span> | <span class="t">It's not the fastest around, but it's not terrible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7586" target="_blank">02:06:26.300</a></span> | <span class="t">You can always fire up a P3 if you want something that's super fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7589" target="_blank">02:06:29.860</a></span> | <span class="t">This is costing me 90 cents a minute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7593" target="_blank">02:06:33.520</a></span> | <span class="t">So when you're finished, please don't forget to shut it down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7597" target="_blank">02:06:37.700</a></span> | <span class="t">So to shut it down, you can right-click on it and say "instance date, stop".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7608" target="_blank">02:06:48.340</a></span> | <span class="t">We've got 500 bucks of credit, assuming that you put your code down in a spreadsheet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7614" target="_blank">02:06:54.260</a></span> | <span class="t">One thing I forgot to do, the first time I showed you this, by the way I said, make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7618" target="_blank">02:06:58.300</a></span> | <span class="t">you choose a P2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7622" target="_blank">02:07:02.060</a></span> | <span class="t">The second time I went through I didn't choose P2 by mistake, so just don't forget to choose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7626" target="_blank">02:07:06.420</a></span> | <span class="t">gpu compute P2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7628" target="_blank">02:07:08.500</a></span> | <span class="t">Do you have a question?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7631" target="_blank">02:07:11.420</a></span> | <span class="t">I've got 90 cents an hour, thank you, 90 cents an hour.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7639" target="_blank">02:07:19.260</a></span> | <span class="t">It also costs 3 or 4 bucks a month for the storage as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7644" target="_blank">02:07:24.060</a></span> | <span class="t">Thanks for checking that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7645" target="_blank">02:07:25.060</a></span> | <span class="t">Alright, see you next week. Sorry we haven't been over.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=JNxcznsrRb8&t=7647" target="_blank">02:07:27.300</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>