<html><head><title>Cohere AI's LLM for Semantic Search in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Cohere AI's LLM for Semantic Search in Python</h2><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y"><img src="https://i.ytimg.com/vi/ejpc-nbKY2Y/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=0">0:0</a> Semantic search with Cohere LLM and Pinecone<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=45">0:45</a> Architecture overview<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=246">4:6</a> Getting code and prerequisites install<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=290">4:50</a> Cohere and Pinecone API keys<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=372">6:12</a> Initialize Cohere, get data, create embeddings<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=463">7:43</a> Creating Pinecone vector index<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=637">10:37</a> Querying with Cohere and Pinecone<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=776">12:56</a> Testing a few queries<br><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=875">14:35</a> Final notes<br><br><div style="text-align: left;"><a href="./ejpc-nbKY2Y.html">Whisper Transcript</a> | <a href="./transcript_ejpc-nbKY2Y.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we are going to take a look at how to build a semantic search tool using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=5" target="_blank">00:00:05.520</a></span> | <span class="t">Cohere's Embed API endpoint and Pinecone's Vector Database. We'll be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=11" target="_blank">00:00:11.420</a></span> | <span class="t">using Cohere's large language model to embed sentences or paragraphs into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=17" target="_blank">00:00:17.640</a></span> | <span class="t">vector space and then we'll be using Pinecone's Vector Database to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=20" target="_blank">00:00:20.920</a></span> | <span class="t">search through that vector space and retrieve relevant answers to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=25" target="_blank">00:00:25.680</a></span> | <span class="t">particular queries based on the semantics of those queries rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=30" target="_blank">00:00:30.480</a></span> | <span class="t">just keyword matching. Now both of these services together are a pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=35" target="_blank">00:00:35.480</a></span> | <span class="t">combination and they make building this sort of tool incredibly easy as we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=39" target="_blank">00:00:39.440</a></span> | <span class="t">see. But before we start building it let's take a look at what the overall</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=43" target="_blank">00:00:43.680</a></span> | <span class="t">architecture will look like. So we're gonna be starting with our data it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=46" target="_blank">00:00:46.720</a></span> | <span class="t">just going to be a load of text it can be split into sentences or roughly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=52" target="_blank">00:00:52.840</a></span> | <span class="t">paragraph sized chunks of text depending on what we're trying to do and what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=58" target="_blank">00:00:58.480</a></span> | <span class="t">we're going to do is feed those into Cohere's embedding endpoint which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=62" target="_blank">00:01:02.880</a></span> | <span class="t">just going to go to a large language model and what that will do is encode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=68" target="_blank">00:01:08.960</a></span> | <span class="t">each of the chunks of text that we feed into it into a single vector. Now we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=76" target="_blank">00:01:16.740</a></span> | <span class="t">going to have a thousand of these chunks of text we're gonna have like quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=82" target="_blank">00:01:22.040</a></span> | <span class="t">small questions from the Tregg data set so we'll end up with a thousand of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=87" target="_blank">00:01:27.840</a></span> | <span class="t">vectors. Okay and once we have them we then take them we put them into Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=94" target="_blank">00:01:34.960</a></span> | <span class="t">and whilst they are stored in Pinecone or even just the vectors by themselves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=101" target="_blank">00:01:41.360</a></span> | <span class="t">we can think of them as being you know how this works is that they are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=105" target="_blank">00:01:45.560</a></span> | <span class="t">represented in a vector space. So two of these chunks of text are semantically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=111" target="_blank">00:01:51.560</a></span> | <span class="t">similar i.e. they have a similar meaning they would be very close together in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=115" target="_blank">00:01:55.600</a></span> | <span class="t">that vector space whereas two sentences that have a very dissimilar meaning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=121" target="_blank">00:02:01.360</a></span> | <span class="t">would be very far apart within that vector space. Pinecone is the storage the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=125" target="_blank">00:02:05.960</a></span> | <span class="t">database that stores all these vectors and also allows us to search through these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=129" target="_blank">00:02:09.560</a></span> | <span class="t">vectors very efficiently so we can literally store millions, tens of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=133" target="_blank">00:02:13.600</a></span> | <span class="t">millions, billions of vectors in here and search through them incredibly fast. Now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=139" target="_blank">00:02:19.360</a></span> | <span class="t">all of this together is what we would call indexing and on the other side of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=146" target="_blank">00:02:26.000</a></span> | <span class="t">this we have the querying phase so when we're making queries let's say we have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=151" target="_blank">00:02:31.120</a></span> | <span class="t">little search box here obviously this input can be anything we like but we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=156" target="_blank">00:02:36.980</a></span> | <span class="t">have a search box here and our users are going to enter a query it's like Google</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=161" target="_blank">00:02:41.200</a></span> | <span class="t">search that query will go over to go here first using the same large language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=166" target="_blank">00:02:46.560</a></span> | <span class="t">model and what we will get is a single what we call a query vector so here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=174" target="_blank">00:02:54.560</a></span> | <span class="t">our query vector in code we usually refer to it as XQ and we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=179" target="_blank">00:02:59.320</a></span> | <span class="t">pass that over to Pinecone here and we're going to say to Pinecone okay with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=184" target="_blank">00:03:04.680</a></span> | <span class="t">this query vector what are the top K so like the number here top K maybe we say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=192" target="_blank">00:03:12.680</a></span> | <span class="t">equal to 3 what are the top K most similar already index vectors so with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=197" target="_blank">00:03:17.880</a></span> | <span class="t">top K equal to 3 if this was our query vector we would return the top 3 most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=202" target="_blank">00:03:22.840</a></span> | <span class="t">similar items here so I think maybe number 1 would be this vector here maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=208" target="_blank">00:03:28.040</a></span> | <span class="t">number 2 would be this one and number 3 would be this one and the Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=211" target="_blank">00:03:31.760</a></span> | <span class="t">would return those to us so we'd have 3 vectors here but obviously we can't read</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=219" target="_blank">00:03:39.040</a></span> | <span class="t">or understand what these vectors mean all right they're just numbers so what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=224" target="_blank">00:03:44.440</a></span> | <span class="t">we need to do is find the metadata that was attached to those so the metadata is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=229" target="_blank">00:03:49.240</a></span> | <span class="t">going to contain the original text from there so we would actually get that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=233" target="_blank">00:03:53.280</a></span> | <span class="t">original text and we would return all that to our user so that's what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=238" target="_blank">00:03:58.200</a></span> | <span class="t">going to be building it probably looks much more complicated from this chart</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=241" target="_blank">00:04:01.920</a></span> | <span class="t">than it actually is it's incredibly easy as we'll see it won't take as long to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=246" target="_blank">00:04:06.240</a></span> | <span class="t">through so let's get started we are going to using this guide on Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=250" target="_blank">00:04:10.000</a></span> | <span class="t">so docs.pinecone.io/docs/cohere we're not going to have you go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=255" target="_blank">00:04:15.520</a></span> | <span class="t">through this page here we're actually just going to go over to here opening</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=259" target="_blank">00:04:19.000</a></span> | <span class="t">Colab okay and we get this little chart is that pretty much exactly the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=263" target="_blank">00:04:23.400</a></span> | <span class="t">what I just explained just a little simpler and we're going to go down here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=267" target="_blank">00:04:27.600</a></span> | <span class="t">and we just need to install a few prerequisites so we have take a look up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=273" target="_blank">00:04:33.600</a></span> | <span class="t">here we have Cohere and Pinecone you know you know why we're using those I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=277" target="_blank">00:04:37.720</a></span> | <span class="t">just mentioned it and then we also have Hugging Face datasets this is where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=281" target="_blank">00:04:41.140</a></span> | <span class="t">we're going to be sourcing our data set from that we're going to be indexing and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=285" target="_blank">00:04:45.160</a></span> | <span class="t">then querying against later on okay it looks good so come down to here and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=291" target="_blank">00:04:51.520</a></span> | <span class="t">need to sign up for API keys Cohere and Pinecone and both of these we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=295" target="_blank">00:04:55.680</a></span> | <span class="t">actually do this completely free so Cohere has a trial amount that we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=301" target="_blank">00:05:01.400</a></span> | <span class="t">query with so we're going to be using that click on Cohere here that will take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=306" target="_blank">00:05:06.920</a></span> | <span class="t">us to os.cohere.ai and it will also just redirect you to the dashboard if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=312" target="_blank">00:05:12.920</a></span> | <span class="t">you're already logged in if this is your first time using Cohere of course you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=315" target="_blank">00:05:15.920</a></span> | <span class="t">will not be so you have to go to the top right over here and create an account or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=320" target="_blank">00:05:20.840</a></span> | <span class="t">log in once you have done that you can go to settings on the left go to API</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=325" target="_blank">00:05:25.400</a></span> | <span class="t">keys and you should have a trial key here so I've got the default key I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=330" target="_blank">00:05:30.480</a></span> | <span class="t">going to copy that and I'm going to go ahead and put it in here okay so I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=334" target="_blank">00:05:34.720</a></span> | <span class="t">just put mine in and then for the Pinecone key click here and that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=339" target="_blank">00:05:39.840</a></span> | <span class="t">take us to app.pinecone.io if you already logged in you will see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=344" target="_blank">00:05:44.040</a></span> | <span class="t">something like this otherwise you're going to see a little login screen or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=347" target="_blank">00:05:47.040</a></span> | <span class="t">create an account page so you go ahead do that and then you should be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=351" target="_blank">00:05:51.560</a></span> | <span class="t">redirected to here now if this first time using Pinecone this will be empty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=356" target="_blank">00:05:56.440</a></span> | <span class="t">you see I have a few indexes in here already but of course if you haven't created any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=360" target="_blank">00:06:00.800</a></span> | <span class="t">already this will be empty so all we need to do is head on over to API keys</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=365" target="_blank">00:06:05.280</a></span> | <span class="t">on the left we should have a default API key you can copy that and we will place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=370" target="_blank">00:06:10.880</a></span> | <span class="t">in here okay so I've just added mine so I've got my Cohere and Pinecone keys in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=376" target="_blank">00:06:16.080</a></span> | <span class="t">there first thing we want to do is create our embeddings for that we are going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=379" target="_blank">00:06:19.960</a></span> | <span class="t">need to use the Cohere embed endpoint and we also need some data so let's get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=385" target="_blank">00:06:25.880</a></span> | <span class="t">both of those so here we just initialize our connection to Cohere using that API</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=391" target="_blank">00:06:31.440</a></span> | <span class="t">key from before and then here we're going to use HuggingFace datasets and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=395" target="_blank">00:06:35.440</a></span> | <span class="t">we're going to download the first 1,000 questions from the Trek dataset of first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=403" target="_blank">00:06:43.200</a></span> | <span class="t">1,000 rows actually and then the questions themselves are stored within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=406" target="_blank">00:06:46.640</a></span> | <span class="t">this text feature which we can see down here okay cool after this we are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=413" target="_blank">00:06:53.760</a></span> | <span class="t">to be using the Cohere embed endpoint we're going to passing all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=418" target="_blank">00:06:58.680</a></span> | <span class="t">items so yes you have 1,000 items in there just pass them all to Cohere at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=422" target="_blank">00:07:02.720</a></span> | <span class="t">once and this client will just automatically batch those and iterate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=426" target="_blank">00:07:06.880</a></span> | <span class="t">through everything so we don't overload the API requests we're going to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=431" target="_blank">00:07:11.520</a></span> | <span class="t">the small model and we're going to be truncating so we're going to keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=435" target="_blank">00:07:15.760</a></span> | <span class="t">everything on the left here and then after that we want to extract the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=440" target="_blank">00:07:20.560</a></span> | <span class="t">embeddings from what we return there so we run this it should be pretty quick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=444" target="_blank">00:07:24.600</a></span> | <span class="t">a second super fast and then let's just have a look at the dimensionality of what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=449" target="_blank">00:07:29.680</a></span> | <span class="t">we return there so we have 1,000 vectors each one of those vectors is 1,024</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=456" target="_blank">00:07:36.680</a></span> | <span class="t">dimensions which is just the output dimensionality of Cohere's small large</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=462" target="_blank">00:07:42.360</a></span> | <span class="t">language model okay and with those embeddings all created we can move on to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=468" target="_blank">00:07:48.160</a></span> | <span class="t">actually initializing our vector index which is where we're going to start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=471" target="_blank">00:07:51.840</a></span> | <span class="t">everything so for that we initialize our connection Pinecone using the API key we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=476" target="_blank">00:07:56.520</a></span> | <span class="t">used before we are going to be using this index name you can change this to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=480" target="_blank">00:08:00.880</a></span> | <span class="t">whatever you want I would just recommend that you keep it descriptive so that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=484" target="_blank">00:08:04.480</a></span> | <span class="t">you're not getting confused if you have multiple indexes later on and then here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=488" target="_blank">00:08:08.920</a></span> | <span class="t">if this is your first time using Pinecone or going through this notebook this will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=493" target="_blank">00:08:13.160</a></span> | <span class="t">just run here so it will create the index if you've already run this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=496" target="_blank">00:08:16.840</a></span> | <span class="t">notebook and the index already exists within your Pinecone account then this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=501" target="_blank">00:08:21.680</a></span> | <span class="t">is going to say if that index name does exist do not create the index again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=507" target="_blank">00:08:27.080</a></span> | <span class="t">because it already exists but it needs to create it again within that create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=510" target="_blank">00:08:30.120</a></span> | <span class="t">index we have the index name the dimensionality so that's the 1,024 that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=515" target="_blank">00:08:35.200</a></span> | <span class="t">we saw before the Cohere small model and also using cosine similarity as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=520" target="_blank">00:08:40.320</a></span> | <span class="t">similarity metric there as well after that we just go ahead and connect to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=525" target="_blank">00:08:45.360</a></span> | <span class="t">index so let's run that now once that is all done we're going to move on to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=530" target="_blank">00:08:50.040</a></span> | <span class="t">actually upsetting everything so adding all of those vectors the relevant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=534" target="_blank">00:08:54.720</a></span> | <span class="t">metadata and some unique IDs to our index and that will be in this format so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=540" target="_blank">00:09:00.440</a></span> | <span class="t">we're gonna big list where each record content is within a tuple containing an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=546" target="_blank">00:09:06.000</a></span> | <span class="t">ID a unique ID a vector that we've created from Coheres embed endpoint and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=551" target="_blank">00:09:11.040</a></span> | <span class="t">the metadata which is just going to contain the plain text version of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=555" target="_blank">00:09:15.420</a></span> | <span class="t">information so come down here and we will go ahead and create that structure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=560" target="_blank">00:09:20.880</a></span> | <span class="t">so that's what we're doing here so creating a zip list of unique IDs which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=566" target="_blank">00:09:26.000</a></span> | <span class="t">are just a count of the embeddings which we've created before Cohere and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=570" target="_blank">00:09:30.640</a></span> | <span class="t">metadata which you can see we're creating here it's just a dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=574" target="_blank">00:09:34.280</a></span> | <span class="t">metadata is always within the dictionary format and we just have a key</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=579" target="_blank">00:09:39.760</a></span> | <span class="t">which is text and the value which is the original plain text of our data now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=585" target="_blank">00:09:45.800</a></span> | <span class="t">appeal using batch size 128 that is so that we're not overloading the API calls</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=591" target="_blank">00:09:51.840</a></span> | <span class="t">that we're making to Pinecone and we are actually upsetting in batches of 128</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=597" target="_blank">00:09:57.480</a></span> | <span class="t">okay so we can run that at the end here we're going to describe the index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=602" target="_blank">00:10:02.920</a></span> | <span class="t">statistics which is just so we can see the vector count so have we upsert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=608" target="_blank">00:10:08.040</a></span> | <span class="t">everything into our vector index there and we can see here that we have and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=611" target="_blank">00:10:11.400</a></span> | <span class="t">from here we can also change the dimensionality of our index which again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=615" target="_blank">00:10:15.320</a></span> | <span class="t">this should align to the model output dimensionality again the 1024 that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=623" target="_blank">00:10:23.000</a></span> | <span class="t">saw from before and okay so with that we've actually done all the indexing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=628" target="_blank">00:10:28.800</a></span> | <span class="t">stage of our workflow so we can actually cross off this bit here so the indexing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=635" target="_blank">00:10:35.560</a></span> | <span class="t">part this is all done now all we need to do is the querying part so we can see we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=640" target="_blank">00:10:40.760</a></span> | <span class="t">have our plain text query we're going to take that to Cohere we're going to from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=644" target="_blank">00:10:44.840</a></span> | <span class="t">Cohere we're going to create that query embedding we query that with Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=649" target="_blank">00:10:49.920</a></span> | <span class="t">and we return some vectors and the metadata with those vectors to the user</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=655" target="_blank">00:10:55.360</a></span> | <span class="t">so to do that it's pretty much the same process again we have our query we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=660" target="_blank">00:11:00.920</a></span> | <span class="t">what caused the 1929 Great Depression we are going to do the exact same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=665" target="_blank">00:11:05.960</a></span> | <span class="t">that we did before with the Trek data we are going to use Cohere embed use the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=671" target="_blank">00:11:11.920</a></span> | <span class="t">small model which I'm going to create to the left and we get those embeddings we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=676" target="_blank">00:11:16.200</a></span> | <span class="t">can also print the shape here so let me run this okay so the shape is just one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=681" target="_blank">00:11:21.560</a></span> | <span class="t">vector this time which is our query vector and it's still 1024 dimensionality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=686" target="_blank">00:11:26.480</a></span> | <span class="t">because we're using that small Cohere large language model now from there we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=692" target="_blank">00:11:32.480</a></span> | <span class="t">query Pinecone with this we're saying we want to return the top 10 most similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=696" target="_blank">00:11:36.800</a></span> | <span class="t">results and we want to include the metadata that includes the plain text so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=701" target="_blank">00:11:41.440</a></span> | <span class="t">that we can actually read the results and we get this sort of response which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=705" target="_blank">00:11:45.800</a></span> | <span class="t">is we can read it relatively easily but let's clean it up a little bit more so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=710" target="_blank">00:11:50.080</a></span> | <span class="t">we come down here run this so we're going to go through each of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=713" target="_blank">00:11:53.200</a></span> | <span class="t">matches that we returned here and we're just going to print out the score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=717" target="_blank">00:11:57.080</a></span> | <span class="t">rounded so it's be easier to read and we're going to return the metadata text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=722" target="_blank">00:12:02.560</a></span> | <span class="t">and we print all of those out we get something like this now the top two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=726" target="_blank">00:12:06.720</a></span> | <span class="t">results are they have much higher similarity scores than the rest of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=731" target="_blank">00:12:11.320</a></span> | <span class="t">results and they are indeed far more relevant to our question these would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=736" target="_blank">00:12:16.760</a></span> | <span class="t">clearly be counted as duplicates to our question or at least very similar and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=742" target="_blank">00:12:22.200</a></span> | <span class="t">then the rest of these we can see that these are not directly relevant but I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=746" target="_blank">00:12:26.760</a></span> | <span class="t">think most of these kind of occur within the same sort of time error so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=751" target="_blank">00:12:31.240</a></span> | <span class="t">interesting that they it manages to kind of identify some sort of relationship</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=755" target="_blank">00:12:35.760</a></span> | <span class="t">there and return those but of course these are the only two within that 1000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=761" target="_blank">00:12:41.600</a></span> | <span class="t">query data set that we have from Trek these are the only two items that refer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=767" target="_blank">00:12:47.080</a></span> | <span class="t">to the Great Depression the rest of them as you can see not relevant at least not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=773" target="_blank">00:12:53.600</a></span> | <span class="t">directly relevant so they're very good results now let's adjust this a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=778" target="_blank">00:12:58.800</a></span> | <span class="t">bit so I mentioned before that we're searching based on the meaning of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=783" target="_blank">00:13:03.400</a></span> | <span class="t">queries not the keywords so what we're going to do is replace the keyword</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=788" target="_blank">00:13:08.360</a></span> | <span class="t">depression with the incorrect term recession now although it's incorrect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=793" target="_blank">00:13:13.200</a></span> | <span class="t">it's so you know we as humans would understand that it means the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=797" target="_blank">00:13:17.680</a></span> | <span class="t">someone is trying to ask about that specific event and indeed we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=802" target="_blank">00:13:22.440</a></span> | <span class="t">that the results are pretty much exactly the same now the similarity scores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=806" target="_blank">00:13:26.000</a></span> | <span class="t">dropped a bit because we're using that incorrect term but nonetheless it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=811" target="_blank">00:13:31.320</a></span> | <span class="t">identifying that the top two are exactly the same I think most of these are also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=815" target="_blank">00:13:35.880</a></span> | <span class="t">the same there's just a little bit of different order in there and a couple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=819" target="_blank">00:13:39.680</a></span> | <span class="t">that may be dropped from the top there now in this case we still have a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=824" target="_blank">00:13:44.200</a></span> | <span class="t">similar keywords there so maybe recession is very clearly identified as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=829" target="_blank">00:13:49.720</a></span> | <span class="t">depression major with great and so on so maybe we can modify this even more and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=836" target="_blank">00:13:56.840</a></span> | <span class="t">just kind of drop all those similar words and we can be kind of more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=840" target="_blank">00:14:00.880</a></span> | <span class="t">descriptive here as well so why was there a long-term economic downturn in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=845" target="_blank">00:14:05.520</a></span> | <span class="t">the early 20th century so this is very different to the results that we would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=850" target="_blank">00:14:10.640</a></span> | <span class="t">expect to find and yet again we see those two right at the top and the rest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=855" target="_blank">00:14:15.240</a></span> | <span class="t">of these results are also very similar now interestingly I think because we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=859" target="_blank">00:14:19.920</a></span> | <span class="t">using more descriptive language here it's managing to identify these two as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=864" target="_blank">00:14:24.440</a></span> | <span class="t">being more similar than we did with the previous where we use the incorrect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=869" target="_blank">00:14:29.840</a></span> | <span class="t">result you can see that the similarity score here is lower than it is here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=875" target="_blank">00:14:35.320</a></span> | <span class="t">you can see already how easy is to build a pretty high-performing semantic search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=881" target="_blank">00:14:41.720</a></span> | <span class="t">engine using very little code and literally no prior knowledge about this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=889" target="_blank">00:14:49.040</a></span> | <span class="t">technology all we do is make a few API calls to go here and make a few API</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=893" target="_blank">00:14:53.080</a></span> | <span class="t">calls to Pinecone and we have this semantic search tool now that's it for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=899" target="_blank">00:14:59.320</a></span> | <span class="t">this video I hope it has been useful and interesting but for now thank you very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=905" target="_blank">00:15:05.800</a></span> | <span class="t">much for watching and I'll see you again next one, bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=910" target="_blank">00:15:10.640</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=912" target="_blank">00:15:12.700</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=914" target="_blank">00:15:14.760</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=916" target="_blank">00:15:16.820</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=918" target="_blank">00:15:18.880</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ejpc-nbKY2Y&t=920" target="_blank">00:15:20.940</a></span> | <span class="t">you</span></div></div></body></html>