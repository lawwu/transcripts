<html><head><title>Coding Stable Diffusion from scratch in PyTorch</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Coding Stable Diffusion from scratch in PyTorch</h2><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI"><img src="https://i.ytimg.com/vi/ZBKpAp_6TGI/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=270">4:30</a> What is Stable Diffusion?<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=340">5:40</a> Generative Models<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=727">12:7</a> Forward and Reverse Process<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1064">17:44</a> ELBO and Loss<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1230">20:30</a> Generating New Data<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1340">22:20</a> Classifier-Free Guidance<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1860">31:0</a> CLIP<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2000">33:20</a> Variational Auto Encoder<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2246">37:26</a> Text to Image<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2394">39:54</a> Image to Image<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2500">41:40</a> Inpainting<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2670">44:30</a> Coding the VAE<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6890">114:50</a> Coding CLIP<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7750">129:10</a> Coding the Unet<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11080">184:40</a> Coding the Pipeline<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13980">233:0</a> Coding the Scheduler (DDPM)<br><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16680">278:0</a> Coding the Inference code<br><br><div style="text-align: left;"><a href="./ZBKpAp_6TGI.html">Whisper Transcript</a> | <a href="./transcript_ZBKpAp_6TGI.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hello guys! Welcome to my new video on how to code stable diffusion from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5" target="_blank">00:00:05.360</a></span> | <span class="t">And stable diffusion is a model that was introduced last year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9" target="_blank">00:00:09.480</a></span> | <span class="t">I think most of you are already familiar with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12" target="_blank">00:00:12.360</a></span> | <span class="t">And we will be coding it from scratch using PyTorch only.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16" target="_blank">00:00:16.640</a></span> | <span class="t">And as usual my video is going to be quite long,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=19" target="_blank">00:00:19.880</a></span> | <span class="t">because we will be coding from scratch and at the same time I will be explaining each part that makes up stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=27" target="_blank">00:00:27.480</a></span> | <span class="t">So as usual let me introduce you what are the topics that we will discuss and what are the prerequisites for watching this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=35" target="_blank">00:00:35.520</a></span> | <span class="t">So of course we will discuss stable diffusion because we are going to build it from scratch using only PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=41" target="_blank">00:00:41.120</a></span> | <span class="t">So no other libraries will be used except for the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=45" target="_blank">00:00:45.720</a></span> | <span class="t">I will describe the maths of the diffusion models as defined in the DDPM paper, but I will simplify it as much as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=54" target="_blank">00:00:54.240</a></span> | <span class="t">I will show you how classifier-free guidance works and of course we will also implement it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=59" target="_blank">00:00:59.200</a></span> | <span class="t">how the text-to-image works, image-to-image and in-painting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=63" target="_blank">00:01:03.360</a></span> | <span class="t">Of course to have a very complete view of diffusion models actually we should also introduce the score-based models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=68" target="_blank">00:01:08.920</a></span> | <span class="t">and all the ODE and SDF theoretical framework.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=72" target="_blank">00:01:12.240</a></span> | <span class="t">But most people are not familiar with ordinary differential equations or even stochastic differential equations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=78" target="_blank">00:01:18.720</a></span> | <span class="t">So I will not discuss these topics in this video and I'll leave it for future videos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=83" target="_blank">00:01:23.960</a></span> | <span class="t">So anyway we will have a complete copy of a stable diffusion, we will be able to generate images using the prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=92" target="_blank">00:01:32.280</a></span> | <span class="t">also condition on existing images etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=95" target="_blank">00:01:35.680</a></span> | <span class="t">But for example the samplers based on the Euler method or Runge-Kutta method will not be built in this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=102" target="_blank">00:01:42.560</a></span> | <span class="t">I will make a future video in which I describe these ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=106" target="_blank">00:01:46.560</a></span> | <span class="t">What do I expect you to have as a prerequisite for watching this video?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=110" target="_blank">00:01:50.560</a></span> | <span class="t">Well first of all it's good that if you have some notion of probability and statistics,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=115" target="_blank">00:01:55.240</a></span> | <span class="t">so at least you know what is a Gaussian distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=118" target="_blank">00:01:58.160</a></span> | <span class="t">what is the conditional probability, the marginal probability, the likelihood etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=122" target="_blank">00:02:02.520</a></span> | <span class="t">Now I don't expect you to have the mathematical formulation in your mind about these concepts,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=128" target="_blank">00:02:08.520</a></span> | <span class="t">but at least the concepts behind them, so at least what do we mean by conditional probability or what do we mean by marginal probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=136" target="_blank">00:02:16.040</a></span> | <span class="t">Anyway even if you're not very strong with mathematics I will always give a non-mathematics intuition for most concepts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=142" target="_blank">00:02:22.280</a></span> | <span class="t">So even if you don't have this background you will at least understand the concept behind this, some intuition behind this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=151" target="_blank">00:02:31.000</a></span> | <span class="t">And of course I expect you to know Python and PyTorch, at least basic level, because we will be coding using Python and PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=159" target="_blank">00:02:39.840</a></span> | <span class="t">And then we will be using a lot the attention mechanism,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=163" target="_blank">00:02:43.040</a></span> | <span class="t">so if you're not familiar with the transformer model please watch my previous video on the attention and transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=169" target="_blank">00:02:49.800</a></span> | <span class="t">And we will also be using a lot of convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=173" target="_blank">00:02:53.320</a></span> | <span class="t">So I don't expect you to know how mathematically the convolution layers work,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=177" target="_blank">00:02:57.400</a></span> | <span class="t">but at least what they do on a practical level in a neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=182" target="_blank">00:03:02.720</a></span> | <span class="t">Anyway I will also review this while coding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=186" target="_blank">00:03:06.600</a></span> | <span class="t">And because this is going to be a long video I will first, because the stable diffusion and the diffusion models in general are quite complex from a mathematical point of view,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=196" target="_blank">00:03:16.840</a></span> | <span class="t">so we cannot jump directly to the code without explaining what we are going to code and how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=203" target="_blank">00:03:23.120</a></span> | <span class="t">The first thing I will do is to give you some background knowledge from a mathematical point of view,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=208" target="_blank">00:03:28.600</a></span> | <span class="t">but also from a conceptual point of view of how the diffusion models work and how stable diffusion works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=216" target="_blank">00:03:36.880</a></span> | <span class="t">And then we will build each part one by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=221" target="_blank">00:03:41.600</a></span> | <span class="t">Of course at the beginning you will have a lot of ideas that are kind of confused because I will give you a lot of new concepts to grasp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=229" target="_blank">00:03:49.800</a></span> | <span class="t">And it's normal that you don't understand everything at the beginning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=232" target="_blank">00:03:52.920</a></span> | <span class="t">But don't worry because while coding I will repeat each concept more than once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=237" target="_blank">00:03:57.840</a></span> | <span class="t">So while coding you will also get a practical knowledge of what each part is doing and how they interact with each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=245" target="_blank">00:04:05.360</a></span> | <span class="t">So please don't be scared if you don't understand everything in the beginning part of this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=250" target="_blank">00:04:10.560</a></span> | <span class="t">Later when we start coding it everything will make sense to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=254" target="_blank">00:04:14.440</a></span> | <span class="t">But we need this initial part because otherwise we cannot just jump in the dark and start coding without knowing what we are going to code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=262" target="_blank">00:04:22.480</a></span> | <span class="t">So let's start our journey.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=266" target="_blank">00:04:26.800</a></span> | <span class="t">So what is stable diffusion?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=268" target="_blank">00:04:28.720</a></span> | <span class="t">Stable diffusion is a model that was introduced in 2022, so last year, at the end of last year I remember,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=276" target="_blank">00:04:36.080</a></span> | <span class="t">by Confit's group at the Ludwig Maximilian University in Munich, Germany.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=280" target="_blank">00:04:40.680</a></span> | <span class="t">And it's open source, the weights, the pre-trained weights can be found on the Internet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=285" target="_blank">00:04:45.560</a></span> | <span class="t">And it became very famous because people started doing a lot of stuff and building projects with them and products with them with the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=293" target="_blank">00:04:53.240</a></span> | <span class="t">And one of the most simple use of stable diffusion is to do text to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=298" target="_blank">00:04:58.320</a></span> | <span class="t">So given a prompt we want to generate an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=301" target="_blank">00:05:01.040</a></span> | <span class="t">We will also see how image to image works and also how in-painting works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=305" target="_blank">00:05:05.840</a></span> | <span class="t">Image to image means that you already have a picture, for example, of a dog and you want to change it a little bit by using a prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=312" target="_blank">00:05:12.280</a></span> | <span class="t">For example, you want to ask the model to add the wings to the dog so that it looks like a flying dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=317" target="_blank">00:05:17.880</a></span> | <span class="t">Or in-painting means that you remove some part of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=321" target="_blank">00:05:21.920</a></span> | <span class="t">For example, you can remove, I don't know, this part here and you ask the model to replace it with some other part that makes sense,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=330" target="_blank">00:05:30.000</a></span> | <span class="t">that is coherent with the image. And we will see also how this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=335" target="_blank">00:05:35.800</a></span> | <span class="t">Let's jump into generative models because diffusion models are generative models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=341" target="_blank">00:05:41.840</a></span> | <span class="t">But what is a generative model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=344" target="_blank">00:05:44.120</a></span> | <span class="t">Well, a generative model learns a probability distribution of the data such that we can then sample from the distribution to create new instances of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=354" target="_blank">00:05:54.640</a></span> | <span class="t">For example, if we have many pictures of cats or dogs or whatever we have,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=359" target="_blank">00:05:59.640</a></span> | <span class="t">we can train a generative model on it and then we can sample from this distribution to create new images of cats or dogs or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=368" target="_blank">00:06:08.560</a></span> | <span class="t">And this is exactly what we do with stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=371" target="_blank">00:06:11.080</a></span> | <span class="t">We actually have a lot of images, we train it on a massive amount of images,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=375" target="_blank">00:06:15.720</a></span> | <span class="t">and then we sample from this distribution to generate new images that don't exist in our training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=382" target="_blank">00:06:22.320</a></span> | <span class="t">But the question may arise in your mind is why do we model data as distributions, as probability distributions?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=390" target="_blank">00:06:30.240</a></span> | <span class="t">Well, let me give you an example. Imagine you are a criminal and you want to generate thousands of fake identities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=398" target="_blank">00:06:38.200</a></span> | <span class="t">Imagine you also live in a very simple world and each fake identity is made up of variables representing the characteristic of a person.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=405" target="_blank">00:06:45.520</a></span> | <span class="t">So age and height. Suppose we only have two variables that make up a person.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=409" target="_blank">00:06:49.600</a></span> | <span class="t">So it's the age of the person and the height of the person.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=413" target="_blank">00:06:53.520</a></span> | <span class="t">In my case, I will be using the centimetre for the height. I think the Americans can convert it to feet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=419" target="_blank">00:06:59.800</a></span> | <span class="t">And so how do we proceed if we are a criminal with this goal?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=424" target="_blank">00:07:04.120</a></span> | <span class="t">Well, we can ask the statistics department of the government to give us some statistics about the age and the height of the population.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=431" target="_blank">00:07:11.320</a></span> | <span class="t">This information you can easily find online, for example. And then we can sample from this distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=437" target="_blank">00:07:17.800</a></span> | <span class="t">For example, if we model the age of the population like a Gaussian with the mean of 40 and the variance of 30.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=445" target="_blank">00:07:25.840</a></span> | <span class="t">OK, these numbers are made up. I don't know if they reflect the reality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=449" target="_blank">00:07:29.640</a></span> | <span class="t">And the height in centimetres is 120 as mean and the variance is 100.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=458" target="_blank">00:07:38.120</a></span> | <span class="t">We get these two distributions. Then we can sample from these two distributions to generate a fake identity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=465" target="_blank">00:07:45.240</a></span> | <span class="t">What does it mean to sample from a distribution? To sample from this kind of distribution means to throw a coin,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=472" target="_blank">00:07:52.280</a></span> | <span class="t">a very special coin that has a very high chance of falling in this area, a lower chance of falling in this area,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=480" target="_blank">00:08:00.200</a></span> | <span class="t">an even lower chance of falling in this area and a very nearly zero chance of falling in this area.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=487" target="_blank">00:08:07.240</a></span> | <span class="t">So imagine we flip this coin once for the age, for example, and it falls here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=492" target="_blank">00:08:12.880</a></span> | <span class="t">So it's quite probable, not very probable, but quite probable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=496" target="_blank">00:08:16.760</a></span> | <span class="t">So suppose the age is three and let me write. So the age, let's say, is. Three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=507" target="_blank">00:08:27.960</a></span> | <span class="t">And then we toss again this coin and we and the coin falls, let's say here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=515" target="_blank">00:08:35.320</a></span> | <span class="t">So one hundred, let's say, thirty height. One hundred thirty centimetres.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=523" target="_blank">00:08:43.560</a></span> | <span class="t">So as you can see, the combination of age and height is quite improbable in reality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=529" target="_blank">00:08:49.960</a></span> | <span class="t">I mean, no three years old is one metre and thirty centimetres high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=535" target="_blank">00:08:55.160</a></span> | <span class="t">I mean, at least not the ones I know. So this combination of age and height is very not plausible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=542" target="_blank">00:09:02.600</a></span> | <span class="t">So to produce plausible pairs, we actually need to model these two variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=547" target="_blank">00:09:07.320</a></span> | <span class="t">So the age and height, not as independent variables and sample from each of them independently,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=552" target="_blank">00:09:12.840</a></span> | <span class="t">but as a joint distribution. And usually we represent the joint distribution like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=559" target="_blank">00:09:19.080</a></span> | <span class="t">where each combination of age and height has a probability score associated with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=565" target="_blank">00:09:25.000</a></span> | <span class="t">And from this distribution, we only sample using one coin.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=569" target="_blank">00:09:29.240</a></span> | <span class="t">And for example, this coin will have a very high probability with very high chance will fall in this area,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=575" target="_blank">00:09:35.160</a></span> | <span class="t">with less chance will fall in this area and very close to zero chance of falling in this area.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=580" target="_blank">00:09:40.440</a></span> | <span class="t">Suppose we throw the coin and it ends up in this area to get to the corresponding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=584" target="_blank">00:09:44.680</a></span> | <span class="t">Suppose this is the age and this is the height to get to the corresponding age and height.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=590" target="_blank">00:09:50.280</a></span> | <span class="t">We just need to do like this. And suppose these are actually the real height and the real height.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=595" target="_blank">00:09:55.080</a></span> | <span class="t">Now the numbers here are actually do not match, but you got the idea that to model something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=601" target="_blank">00:10:01.080</a></span> | <span class="t">we need a joint distribution over all the variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=603" target="_blank">00:10:03.960</a></span> | <span class="t">And this is actually what we do also with our images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=606" target="_blank">00:10:06.680</a></span> | <span class="t">With our images, we create a very complex distribution in which, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=612" target="_blank">00:10:12.680</a></span> | <span class="t">each pixel is a distribution and the entirety of all the pixels are one big joint distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=620" target="_blank">00:10:20.120</a></span> | <span class="t">And once we have a joint distribution, we can do a lot of interesting things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=624" target="_blank">00:10:24.520</a></span> | <span class="t">For example, we can marginalize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=626" target="_blank">00:10:26.440</a></span> | <span class="t">So, for example, imagine we have a joint distribution over the age and the height.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=630" target="_blank">00:10:30.840</a></span> | <span class="t">So let's call the age X and let's call the height, let's say Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=636" target="_blank">00:10:36.200</a></span> | <span class="t">So if we have a joint distribution, which means having P of X and Y,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=642" target="_blank">00:10:42.440</a></span> | <span class="t">which is defined for each combination of X and Y, we can always calculate P of X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=648" target="_blank">00:10:48.680</a></span> | <span class="t">So the probability of over the single variable by marginalizing over the other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=653" target="_blank">00:10:53.560</a></span> | <span class="t">So as the integral of P of X and Y and the Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=659" target="_blank">00:10:59.320</a></span> | <span class="t">And this is how we marginalize,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=662" target="_blank">00:11:02.280</a></span> | <span class="t">which means marginalizing over all the possible Y that we can have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=666" target="_blank">00:11:06.040</a></span> | <span class="t">And then we can also calculate the probability, the conditional probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=669" target="_blank">00:11:09.960</a></span> | <span class="t">For example, we can say that the probability,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=672" target="_blank">00:11:12.360</a></span> | <span class="t">what is the probability of the age being, let's say, from 0 to 3,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=679" target="_blank">00:11:19.080</a></span> | <span class="t">given that the height is more than 1 meter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=683" target="_blank">00:11:23.320</a></span> | <span class="t">So something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=684" target="_blank">00:11:24.920</a></span> | <span class="t">We can do this kind of queries by using the conditional probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=688" target="_blank">00:11:28.760</a></span> | <span class="t">So this is actually what we do with the generative model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=691" target="_blank">00:11:31.400</a></span> | <span class="t">We model our data as a very big joint distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=694" target="_blank">00:11:34.920</a></span> | <span class="t">And then we learn the parameters of this distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=699" target="_blank">00:11:39.800</a></span> | <span class="t">because it's a very complex distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=701" target="_blank">00:11:41.480</a></span> | <span class="t">So we let the neural network learn the parameters of this distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=705" target="_blank">00:11:45.160</a></span> | <span class="t">And our goal, of course, is to learn this very complex distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=711" target="_blank">00:11:51.000</a></span> | <span class="t">and then sample from it to generate new data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=713" target="_blank">00:11:53.720</a></span> | <span class="t">just like the criminal before wanted to generate new fake identities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=718" target="_blank">00:11:58.360</a></span> | <span class="t">by modeling the very complex distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=720" target="_blank">00:12:00.680</a></span> | <span class="t">that represents the identity of a person.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=723" target="_blank">00:12:03.000</a></span> | <span class="t">In our case, we will model our system as a joint distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=728" target="_blank">00:12:08.680</a></span> | <span class="t">by including also some latent variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=730" target="_blank">00:12:10.920</a></span> | <span class="t">So let me describe.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=731" target="_blank">00:12:11.880</a></span> | <span class="t">As you probably are familiar with the diffusion models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=736" target="_blank">00:12:16.200</a></span> | <span class="t">we have two processes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=737" target="_blank">00:12:17.560</a></span> | <span class="t">One is called the forward process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=739" target="_blank">00:12:19.480</a></span> | <span class="t">and one is called the reverse process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=741" target="_blank">00:12:21.960</a></span> | <span class="t">The forward process means that we have our initial image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=745" target="_blank">00:12:25.000</a></span> | <span class="t">that we will call X0, so this here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=748" target="_blank">00:12:28.760</a></span> | <span class="t">and we add noise to it to get another image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=752" target="_blank">00:12:32.120</a></span> | <span class="t">that is the same as the previous one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=755" target="_blank">00:12:35.240</a></span> | <span class="t">but with some noise on top of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=757" target="_blank">00:12:37.240</a></span> | <span class="t">Then we take this image, which has a little noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=760" target="_blank">00:12:40.920</a></span> | <span class="t">and we generate a new image that is same as the previous one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=764" target="_blank">00:12:44.440</a></span> | <span class="t">but with even more noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=765" target="_blank">00:12:45.960</a></span> | <span class="t">So as you can see, this one has even more noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=768" target="_blank">00:12:48.520</a></span> | <span class="t">and so on, so on, so on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=769" target="_blank">00:12:49.880</a></span> | <span class="t">until we arrive to the last latent variable called Zt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=773" target="_blank">00:12:53.960</a></span> | <span class="t">where t is equal to 1000,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=777" target="_blank">00:12:57.480</a></span> | <span class="t">when it becomes completely noise, pure noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=781" target="_blank">00:13:01.560</a></span> | <span class="t">like N0,1, actually N0i,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=785" target="_blank">00:13:05.960</a></span> | <span class="t">because we are in the multivariate world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=789" target="_blank">00:13:09.080</a></span> | <span class="t">And our goal, actually, is to...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=793" target="_blank">00:13:13.160</a></span> | <span class="t">this process, this forward process is fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=796" target="_blank">00:13:16.520</a></span> | <span class="t">So we define how to build the noisified version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=800" target="_blank">00:13:20.280</a></span> | <span class="t">of each image given the previous one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=802" target="_blank">00:13:22.600</a></span> | <span class="t">so we know how to add noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=804" target="_blank">00:13:24.520</a></span> | <span class="t">and we have a specific formula, an analytical formula,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=807" target="_blank">00:13:27.720</a></span> | <span class="t">on how to add noise to an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=810" target="_blank">00:13:30.600</a></span> | <span class="t">The problem is, we don't have the analytical formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=814" target="_blank">00:13:34.200</a></span> | <span class="t">to reverse this process,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=815" target="_blank">00:13:35.720</a></span> | <span class="t">so we don't know how to take this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=818" target="_blank">00:13:38.280</a></span> | <span class="t">and just remove noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=820" target="_blank">00:13:40.200</a></span> | <span class="t">There is no closed formula on how to do it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=823" target="_blank">00:13:43.640</a></span> | <span class="t">so we learn, we train a neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=827" target="_blank">00:13:47.720</a></span> | <span class="t">to do this inverse process,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=829" target="_blank">00:13:49.800</a></span> | <span class="t">to remove noise from something that has noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=832" target="_blank">00:13:52.840</a></span> | <span class="t">And if you think about it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=834" target="_blank">00:13:54.200</a></span> | <span class="t">it is quite easy to add noise to something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=836" target="_blank">00:13:56.840</a></span> | <span class="t">than it is to remove noise from something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=839" target="_blank">00:13:59.720</a></span> | <span class="t">That's why we are using a neural network for this purpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=842" target="_blank">00:14:02.680</a></span> | <span class="t">Now we need to go inside, of course, of the math,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=846" target="_blank">00:14:06.840</a></span> | <span class="t">because we will be using it not only to write the code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=849" target="_blank">00:14:09.720</a></span> | <span class="t">but also to write the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=851" target="_blank">00:14:11.080</a></span> | <span class="t">And in the sampler, it's all about mathematics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=853" target="_blank">00:14:13.800</a></span> | <span class="t">And I will try to simplify it as much as possible,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=856" target="_blank">00:14:16.840</a></span> | <span class="t">so don't be scared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=858" target="_blank">00:14:18.360</a></span> | <span class="t">So let's start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=859" target="_blank">00:14:19.160</a></span> | <span class="t">Okay, this is from the DDPM paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=862" target="_blank">00:14:22.280</a></span> | <span class="t">so the Noising Diffusion Probabilistic Models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=864" target="_blank">00:14:24.600</a></span> | <span class="t">from Ho in 2020.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=867" target="_blank">00:14:27.480</a></span> | <span class="t">And here we have two processes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=869" target="_blank">00:14:29.240</a></span> | <span class="t">The first is the forward process,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=871" target="_blank">00:14:31.720</a></span> | <span class="t">which means that given the original image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=876" target="_blank">00:14:36.440</a></span> | <span class="t">how can I generate the noisified version of this image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=880" target="_blank">00:14:40.680</a></span> | <span class="t">at time step t?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=882" target="_blank">00:14:42.360</a></span> | <span class="t">In this case, actually, this is the joint distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=885" target="_blank">00:14:45.000</a></span> | <span class="t">Let's look at this one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=889" target="_blank">00:14:49.000</a></span> | <span class="t">This means if I have the image at time step t minus one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=893" target="_blank">00:14:53.560</a></span> | <span class="t">how can I get the next time step,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=895" target="_blank">00:14:55.400</a></span> | <span class="t">so the more noisified version of this image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=898" target="_blank">00:14:58.920</a></span> | <span class="t">Well, we define it as a Gaussian distribution centered,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=904" target="_blank">00:15:04.200</a></span> | <span class="t">so the mean centered on the previous one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=906" target="_blank">00:15:06.600</a></span> | <span class="t">and the variance defined by this beta parameter here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=910" target="_blank">00:15:10.520</a></span> | <span class="t">This beta parameter here is decided by us,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=913" target="_blank">00:15:13.960</a></span> | <span class="t">and it means how much noise we want to add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=916" target="_blank">00:15:16.920</a></span> | <span class="t">at every step of this noisification process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=919" target="_blank">00:15:19.560</a></span> | <span class="t">This is also known as the Markov chain of noisification,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=923" target="_blank">00:15:23.320</a></span> | <span class="t">because each variable is conditioned on the previous one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=926" target="_blank">00:15:26.840</a></span> | <span class="t">So to get xt, we need to have xt minus one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=930" target="_blank">00:15:30.600</a></span> | <span class="t">And as you can see from here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=932" target="_blank">00:15:32.520</a></span> | <span class="t">we start from x0, we go to x1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=936" target="_blank">00:15:36.120</a></span> | <span class="t">Here I call it z1 to differentiate it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=938" target="_blank">00:15:38.360</a></span> | <span class="t">but x1 actually is equal to z1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=940" target="_blank">00:15:40.920</a></span> | <span class="t">So x0 is the original image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=943" target="_blank">00:15:43.000</a></span> | <span class="t">and all the next x are noisy versions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=946" target="_blank">00:15:46.360</a></span> | <span class="t">with xt being the most noisy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=948" target="_blank">00:15:48.760</a></span> | <span class="t">So this is called the Markov chain of noisification,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=953" target="_blank">00:15:53.240</a></span> | <span class="t">and we can do it like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=956" target="_blank">00:15:56.840</a></span> | <span class="t">So it's defined by us as a process,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=959" target="_blank">00:15:59.800</a></span> | <span class="t">which is a series of Gaussians that add noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=962" target="_blank">00:16:02.680</a></span> | <span class="t">There is an interesting formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=965" target="_blank">00:16:05.880</a></span> | <span class="t">This is a closed loop, closed formula,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=968" target="_blank">00:16:08.440</a></span> | <span class="t">to go from the original image to any image at time step t,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=973" target="_blank">00:16:13.320</a></span> | <span class="t">without calculating all the intermediate images,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=976" target="_blank">00:16:16.120</a></span> | <span class="t">using this particular parametrization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=979" target="_blank">00:16:19.480</a></span> | <span class="t">So we can go from the image, original image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=983" target="_blank">00:16:23.400</a></span> | <span class="t">to the image at time step t,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=985" target="_blank">00:16:25.000</a></span> | <span class="t">by sampling from this distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=989" target="_blank">00:16:29.480</a></span> | <span class="t">by defining the distribution like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=991" target="_blank">00:16:31.160</a></span> | <span class="t">So with this mean and with this variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=993" target="_blank">00:16:33.800</a></span> | <span class="t">This mean here depends on a parameter, alpha, alpha bar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=998" target="_blank">00:16:38.440</a></span> | <span class="t">which is actually depending on beta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1000" target="_blank">00:16:40.440</a></span> | <span class="t">So it's something that we know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1002" target="_blank">00:16:42.040</a></span> | <span class="t">there is nothing we have to learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1003" target="_blank">00:16:43.720</a></span> | <span class="t">And also the variance actually depends on alpha,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1006" target="_blank">00:16:46.360</a></span> | <span class="t">which is defined as in function of beta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1009" target="_blank">00:16:49.400</a></span> | <span class="t">So beta is also something we know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1011" target="_blank">00:16:51.240</a></span> | <span class="t">so there is no parameters to learn here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1013" target="_blank">00:16:53.080</a></span> | <span class="t">Now let's look at the reverse process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1015" target="_blank">00:16:55.880</a></span> | <span class="t">The reverse process means that we have something noisy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1019" target="_blank">00:16:59.240</a></span> | <span class="t">and we want to get something less noisy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1021" target="_blank">00:17:01.400</a></span> | <span class="t">So we want to remove noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1023" target="_blank">00:17:03.480</a></span> | <span class="t">And we also define it as a Gaussian,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1025" target="_blank">00:17:05.960</a></span> | <span class="t">with a mean, mu theta, and a variance, sigma theta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1030" target="_blank">00:17:10.600</a></span> | <span class="t">Now, this mean and this variance are not known to us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1036" target="_blank">00:17:16.920</a></span> | <span class="t">We have to learn them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1038" target="_blank">00:17:18.520</a></span> | <span class="t">And we will use a neural network to learn these two parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1043" target="_blank">00:17:23.000</a></span> | <span class="t">Actually, the variance, we will also set this at fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1047" target="_blank">00:17:27.800</a></span> | <span class="t">We will parameterize it in such a way that this variance actually is fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1052" target="_blank">00:17:32.360</a></span> | <span class="t">So we hypothesize, we already know the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1054" target="_blank">00:17:34.920</a></span> | <span class="t">And we let the network learn only the mean of this distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1058" target="_blank">00:17:38.680</a></span> | <span class="t">So to rehearse, we have a forward process that adds noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1062" target="_blank">00:17:42.680</a></span> | <span class="t">And we know everything about this process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1064" target="_blank">00:17:44.280</a></span> | <span class="t">We know how to add noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1065" target="_blank">00:17:45.800</a></span> | <span class="t">We have a reverse process that we don't know how to denoise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1069" target="_blank">00:17:49.640</a></span> | <span class="t">So we let a network learn the parameters on how to denoise it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1074" target="_blank">00:17:54.680</a></span> | <span class="t">And OK, now that we have defined these two processes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1078" target="_blank">00:17:58.360</a></span> | <span class="t">how do we actually train a model to do it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1081" target="_blank">00:18:01.560</a></span> | <span class="t">Because as you remember, our initial goal is actually to learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1085" target="_blank">00:18:05.000</a></span> | <span class="t">a probability distribution over our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1089" target="_blank">00:18:09.000</a></span> | <span class="t">And so this quantity here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1092" target="_blank">00:18:12.040</a></span> | <span class="t">But unlike before, when we could marginalize, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1095" target="_blank">00:18:15.880</a></span> | <span class="t">in the case of the criminal who want to generate identities,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1100" target="_blank">00:18:20.120</a></span> | <span class="t">we could marginalize over all the variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1103" target="_blank">00:18:23.320</a></span> | <span class="t">Here we cannot marginalize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1104" target="_blank">00:18:24.600</a></span> | <span class="t">Because we need to marginalize over x1, x2, xt, x4, up to xt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1108" target="_blank">00:18:28.920</a></span> | <span class="t">So over a lot of variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1110" target="_blank">00:18:30.520</a></span> | <span class="t">And to calculate this integral means to calculate it over all the possible x1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1116" target="_blank">00:18:36.600</a></span> | <span class="t">And over all the possible x2, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1118" target="_blank">00:18:38.760</a></span> | <span class="t">So it's a very complex calculation that is computationally intractable, we say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1124" target="_blank">00:18:44.040</a></span> | <span class="t">It means that it's theoretically possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1126" target="_blank">00:18:46.440</a></span> | <span class="t">But practically, it will take forever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1128" target="_blank">00:18:48.600</a></span> | <span class="t">So we cannot use this route here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1132" target="_blank">00:18:52.040</a></span> | <span class="t">So what can we do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1133" target="_blank">00:18:53.320</a></span> | <span class="t">We want to learn this quantity here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1135" target="_blank">00:18:55.080</a></span> | <span class="t">So we want to learn the parameter theta of this to maximize the likelihood we can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1140" target="_blank">00:19:00.520</a></span> | <span class="t">What we did is we found a lower bound for this quantity here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1146" target="_blank">00:19:06.520</a></span> | <span class="t">So the quantity, the likelihood.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1148" target="_blank">00:19:08.520</a></span> | <span class="t">And this lower bound is called the elbow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1151" target="_blank">00:19:11.160</a></span> | <span class="t">And if we maximize the lower bound, it will also maximize the likelihood.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1156" target="_blank">00:19:16.040</a></span> | <span class="t">So let me give you a parallel example on what it means to maximize the lower bound.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1161" target="_blank">00:19:21.800</a></span> | <span class="t">For example, imagine you have a company.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1164" target="_blank">00:19:24.920</a></span> | <span class="t">And your company has some revenue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1166" target="_blank">00:19:26.840</a></span> | <span class="t">And usually, the revenue is more than or equal to the sales of your company.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1173" target="_blank">00:19:33.560</a></span> | <span class="t">So you have some revenue coming from sales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1175" target="_blank">00:19:35.640</a></span> | <span class="t">Maybe you also have some revenue coming from interest that you get from your bank, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1181" target="_blank">00:19:41.000</a></span> | <span class="t">But we can for sure say that the revenue of your company is more than or equal to the sales of your company.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1187" target="_blank">00:19:47.240</a></span> | <span class="t">So if you want to maximize your revenue, you can maximize your sales, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1192" target="_blank">00:19:52.280</a></span> | <span class="t">which is a lower bound over your revenue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1195" target="_blank">00:19:55.480</a></span> | <span class="t">So if we maximize the sales, we will also maximize the revenue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1198" target="_blank">00:19:58.200</a></span> | <span class="t">And this is the idea here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1199" target="_blank">00:19:59.400</a></span> | <span class="t">But how do we do it on a practical level?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1203" target="_blank">00:20:03.880</a></span> | <span class="t">Well, this is the training code for the DDPM diffusion models as defined by the DDPM paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1213" target="_blank">00:20:13.240</a></span> | <span class="t">And basically, the idea is after we get the elbow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1217" target="_blank">00:20:17.000</a></span> | <span class="t">we can parameterize the loss function as this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1220" target="_blank">00:20:20.360</a></span> | <span class="t">Which says that we need to learn-- we need to train a network called epsilon theta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1227" target="_blank">00:20:27.800</a></span> | <span class="t">That given a noisy image-- so this formula here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1231" target="_blank">00:20:31.480</a></span> | <span class="t">means the noisy image at time step t and the time step at which the noise was added,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1237" target="_blank">00:20:37.800</a></span> | <span class="t">the network has to predict how much noise is in the image, the noisified image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1243" target="_blank">00:20:43.240</a></span> | <span class="t">And if we do gradient descent over this loss function here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1250" target="_blank">00:20:50.600</a></span> | <span class="t">we will maximize the elbow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1253" target="_blank">00:20:53.400</a></span> | <span class="t">And at the same time, we will also maximize the log likelihood of our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1259" target="_blank">00:20:59.880</a></span> | <span class="t">And this is how we train these kind of networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1263" target="_blank">00:21:03.000</a></span> | <span class="t">Now, I know that this is a lot of concept that you have to grasp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1266" target="_blank">00:21:06.920</a></span> | <span class="t">So don't worry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1267" target="_blank">00:21:07.960</a></span> | <span class="t">For now, just remember that there is a forward process and there is a reverse process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1271" target="_blank">00:21:11.400</a></span> | <span class="t">And to train this network to do the reverse process,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1275" target="_blank">00:21:15.000</a></span> | <span class="t">we need to train a network to detect how much noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1278" target="_blank">00:21:18.280</a></span> | <span class="t">is in a noisified version of the image at time step t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1281" target="_blank">00:21:21.560</a></span> | <span class="t">Let me show you how do we-- once we have this network that has already been trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1289" target="_blank">00:21:29.800</a></span> | <span class="t">how do we actually sample to generate new data?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1292" target="_blank">00:21:32.280</a></span> | <span class="t">So let's go here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1295" target="_blank">00:21:35.560</a></span> | <span class="t">Let's go here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1296" target="_blank">00:21:36.920</a></span> | <span class="t">So how do we generate new data?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1298" target="_blank">00:21:38.600</a></span> | <span class="t">Suppose we already have a network that was trained for detecting how much noise is in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1304" target="_blank">00:21:44.680</a></span> | <span class="t">And what we do is we start from complete noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1307" target="_blank">00:21:47.720</a></span> | <span class="t">And then we ask the network to detect how much noise is in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1312" target="_blank">00:21:52.040</a></span> | <span class="t">We remove this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1313" target="_blank">00:21:53.400</a></span> | <span class="t">And then we ask the network again how much noise is in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1316" target="_blank">00:21:56.440</a></span> | <span class="t">And we remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1317" target="_blank">00:21:57.640</a></span> | <span class="t">And then we ask the network how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1320" target="_blank">00:22:00.280</a></span> | <span class="t">OK, remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1322" target="_blank">00:22:02.040</a></span> | <span class="t">Then how much noise is here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1323" target="_blank">00:22:03.480</a></span> | <span class="t">OK, remove it, et cetera, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1325" target="_blank">00:22:05.160</a></span> | <span class="t">Until we reach this step, then here we will have something new.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1329" target="_blank">00:22:09.560</a></span> | <span class="t">So if we start from pure noise and we do this reverse process many times,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1333" target="_blank">00:22:13.720</a></span> | <span class="t">we will end up with something new.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1335" target="_blank">00:22:15.480</a></span> | <span class="t">And this is the idea behind this generative model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1339" target="_blank">00:22:19.160</a></span> | <span class="t">Now that we know how to generate new data starting from pure noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1344" target="_blank">00:22:24.520</a></span> | <span class="t">we also want to be able to control this denoisification process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1349" target="_blank">00:22:29.160</a></span> | <span class="t">so we can generate images of something that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1352" target="_blank">00:22:32.280</a></span> | <span class="t">I mean, how can we tell the model to generate a picture of a cat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1356" target="_blank">00:22:36.120</a></span> | <span class="t">or a picture of a dog or a picture of a house by starting from pure noise?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1360" target="_blank">00:22:40.840</a></span> | <span class="t">Because as of now, by starting from pure noise and keep denoising,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1366" target="_blank">00:22:46.360</a></span> | <span class="t">we will generate a new image, of course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1368" target="_blank">00:22:48.680</a></span> | <span class="t">But it's not like we can control which new image will be generated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1372" target="_blank">00:22:52.440</a></span> | <span class="t">So we need to find a way to tell the model what we want in this generational process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1377" target="_blank">00:22:57.160</a></span> | <span class="t">And the idea is that we start from pure noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1381" target="_blank">00:23:01.800</a></span> | <span class="t">And during this chain of removing noise, so denoisification,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1387" target="_blank">00:23:07.640</a></span> | <span class="t">we introduce a signal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1389" target="_blank">00:23:09.400</a></span> | <span class="t">Let's call it prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1391" target="_blank">00:23:11.400</a></span> | <span class="t">Prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1392" target="_blank">00:23:12.620</a></span> | <span class="t">Or it can also be called the conditioning signal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1396" target="_blank">00:23:16.440</a></span> | <span class="t">Or it can also be called the context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1398" target="_blank">00:23:18.920</a></span> | <span class="t">Anyway, they are the same concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1401" target="_blank">00:23:21.720</a></span> | <span class="t">In which we influence the model into how to remove the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1406" target="_blank">00:23:26.280</a></span> | <span class="t">so that the output will move towards what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1409" target="_blank">00:23:29.640</a></span> | <span class="t">To understand how this works, let's review again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1413" target="_blank">00:23:33.560</a></span> | <span class="t">how the training of this kind of networks works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1416" target="_blank">00:23:36.200</a></span> | <span class="t">Because this is very important for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1417" target="_blank">00:23:37.880</a></span> | <span class="t">To learn how the training of this kind of network goes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1420" target="_blank">00:23:40.920</a></span> | <span class="t">so that we can introduce the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1422" target="_blank">00:23:42.840</a></span> | <span class="t">Let's go back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1426" target="_blank">00:23:46.760</a></span> | <span class="t">Okay, as I told you before, our final goal is to model a distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1433" target="_blank">00:23:53.560</a></span> | <span class="t">theta, p of theta, such that we maximize the likelihood of our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1438" target="_blank">00:23:58.520</a></span> | <span class="t">And to learn this distribution, we maximize the ELBO, so the lower bound.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1447" target="_blank">00:24:07.000</a></span> | <span class="t">But how do we maximize the ELBO?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1449" target="_blank">00:24:09.240</a></span> | <span class="t">We minimize this loss, minimize this loss here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1454" target="_blank">00:24:14.840</a></span> | <span class="t">So by minimizing this loss, we maximize the ELBO,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1457" target="_blank">00:24:17.960</a></span> | <span class="t">which in turn learns this distribution here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1461" target="_blank">00:24:21.400</a></span> | <span class="t">Because this ELBO here is the lower bound</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1465" target="_blank">00:24:25.800</a></span> | <span class="t">for the likelihood of our data distribution here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1469" target="_blank">00:24:29.000</a></span> | <span class="t">And what is this loss function?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1472" target="_blank">00:24:32.440</a></span> | <span class="t">Loss function here indicates that we need to create a model, epsilon theta,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1477" target="_blank">00:24:37.160</a></span> | <span class="t">such that if we give this model a noisified image at a particular noise level,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1484" target="_blank">00:24:44.200</a></span> | <span class="t">and we also tell him what noise level we included in this image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1487" target="_blank">00:24:47.880</a></span> | <span class="t">the network has to predict how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1491" target="_blank">00:24:51.880</a></span> | <span class="t">So this epsilon is how much noise we have added.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1494" target="_blank">00:24:54.520</a></span> | <span class="t">And we can do a gradient descent on this training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1500" target="_blank">00:25:00.280</a></span> | <span class="t">This way we will learn a distribution of our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1506" target="_blank">00:25:06.040</a></span> | <span class="t">But as you can see, this distribution doesn't include anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1509" target="_blank">00:25:09.560</a></span> | <span class="t">that tells the model what is a cat, or what is a dog, or what is a house.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1514" target="_blank">00:25:14.120</a></span> | <span class="t">The model is just learning how to generate pictures that make sense,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1518" target="_blank">00:25:18.280</a></span> | <span class="t">that are similar to our initial training data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1521" target="_blank">00:25:21.000</a></span> | <span class="t">But they don't know what is the relationship between that picture and the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1524" target="_blank">00:25:24.680</a></span> | <span class="t">So one idea could be, OK, can we learn a joint distribution of our initial data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1533" target="_blank">00:25:33.400</a></span> | <span class="t">so all the images, and the conditioning signal, so the prompt?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1538" target="_blank">00:25:38.120</a></span> | <span class="t">Well, this is also something that we don't want,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1540" target="_blank">00:25:40.120</a></span> | <span class="t">because we want to actually learn this distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1542" target="_blank">00:25:42.680</a></span> | <span class="t">so that we can sample and generate new data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1545" target="_blank">00:25:45.240</a></span> | <span class="t">We don't want to learn the joint distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1547" target="_blank">00:25:47.000</a></span> | <span class="t">that will be too much influenced by the context,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1550" target="_blank">00:25:50.040</a></span> | <span class="t">and the model may not learn the generative process of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1553" target="_blank">00:25:53.320</a></span> | <span class="t">So our final goal is always this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1555" target="_blank">00:25:55.560</a></span> | <span class="t">But we also want to find some how to condition this model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1559" target="_blank">00:25:59.240</a></span> | <span class="t">into building something that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1561" target="_blank">00:26:01.160</a></span> | <span class="t">And the idea is that we modify this unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1567" target="_blank">00:26:07.000</a></span> | <span class="t">so this model here, epsilon theta,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1571" target="_blank">00:26:11.400</a></span> | <span class="t">will be built using, let me show you, this unit model here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1576" target="_blank">00:26:16.280</a></span> | <span class="t">This unit will receive as input an image that is noisified,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1581" target="_blank">00:26:21.240</a></span> | <span class="t">so for example, a cat, with a particular noise level,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1587" target="_blank">00:26:27.400</a></span> | <span class="t">and we also tell him what is the noise level that we added to this cat,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1591" target="_blank">00:26:31.240</a></span> | <span class="t">and we give them both to the input of the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1593" target="_blank">00:26:33.560</a></span> | <span class="t">and the unit has to predict how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1597" target="_blank">00:26:37.240</a></span> | <span class="t">This is the job of the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1598" target="_blank">00:26:38.600</a></span> | <span class="t">What if we introduce also the prompt signal here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1603" target="_blank">00:26:43.400</a></span> | <span class="t">so the conditioning signal here, so the prompt?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1606" target="_blank">00:26:46.120</a></span> | <span class="t">This way, if we tell the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1609" target="_blank">00:26:49.400</a></span> | <span class="t">can you remove noise from this image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1613" target="_blank">00:26:53.560</a></span> | <span class="t">which has this quantity of noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1616" target="_blank">00:26:56.760</a></span> | <span class="t">and I am also telling you that it's a cat,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1619" target="_blank">00:26:59.080</a></span> | <span class="t">so the model has more information on how to remove the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1623" target="_blank">00:27:03.080</a></span> | <span class="t">Yes, the model can learn this way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1625" target="_blank">00:27:05.080</a></span> | <span class="t">how to remove noise into building something that is more closer to the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1630" target="_blank">00:27:10.360</a></span> | <span class="t">This will make the model conditioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1634" target="_blank">00:27:14.280</a></span> | <span class="t">it means that it will act like a conditioned model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1636" target="_blank">00:27:16.760</a></span> | <span class="t">so we need to tell the model what is the condition that we want,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1639" target="_blank">00:27:19.560</a></span> | <span class="t">so that the model can remove the noise in that particular way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1643" target="_blank">00:27:23.720</a></span> | <span class="t">moving the output towards that particular prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1647" target="_blank">00:27:27.480</a></span> | <span class="t">But at the same time, when we train the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1651" target="_blank">00:27:31.400</a></span> | <span class="t">instead of only giving images along with the prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1655" target="_blank">00:27:35.960</a></span> | <span class="t">we can also sometimes, with a probability, let's say 50%,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1658" target="_blank">00:27:38.840</a></span> | <span class="t">not give any prompt and let the model remove the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1663" target="_blank">00:27:43.720</a></span> | <span class="t">without telling him anything about the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1666" target="_blank">00:27:46.040</a></span> | <span class="t">So we just give him a bunch of zero when we give him the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1670" target="_blank">00:27:50.680</a></span> | <span class="t">This way, the model will learn to act both as a conditioned model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1676" target="_blank">00:27:56.600</a></span> | <span class="t">and also as a conditioned model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1678" target="_blank">00:27:58.520</a></span> | <span class="t">so the model will learn to pay attention to the prompt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1681" target="_blank">00:28:01.080</a></span> | <span class="t">and also to not pay attention to the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1683" target="_blank">00:28:03.240</a></span> | <span class="t">And what is the advantage of this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1685" target="_blank">00:28:05.880</a></span> | <span class="t">Is that we can, once when we want to generate a new picture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1691" target="_blank">00:28:11.320</a></span> | <span class="t">we can do two steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1692" target="_blank">00:28:12.920</a></span> | <span class="t">In the first one, suppose you want to generate a picture of a cat,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1696" target="_blank">00:28:16.680</a></span> | <span class="t">we can do like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1697" target="_blank">00:28:17.560</a></span> | <span class="t">Let me delete first of all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1699" target="_blank">00:28:19.560</a></span> | <span class="t">Okay, we can do the first step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1703" target="_blank">00:28:23.000</a></span> | <span class="t">So let's call it step one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1707" target="_blank">00:28:27.160</a></span> | <span class="t">And we can start with pure noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1710" target="_blank">00:28:30.440</a></span> | <span class="t">because as I told you before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1711" target="_blank">00:28:31.720</a></span> | <span class="t">to generate a new image, we start from pure noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1714" target="_blank">00:28:34.360</a></span> | <span class="t">We indicate the model what is the noise level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1717" target="_blank">00:28:37.240</a></span> | <span class="t">So at the beginning, it will be t equal to 1000,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1720" target="_blank">00:28:40.600</a></span> | <span class="t">so maximum noise level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1722" target="_blank">00:28:42.120</a></span> | <span class="t">And we tell the model that we want a cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1724" target="_blank">00:28:44.920</a></span> | <span class="t">We give this as input to the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1729" target="_blank">00:28:49.320</a></span> | <span class="t">The unit will predict some noise that we need to remove</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1733" target="_blank">00:28:53.800</a></span> | <span class="t">in order to move the image towards what we want as output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1737" target="_blank">00:28:57.880</a></span> | <span class="t">So a cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1738" target="_blank">00:28:58.520</a></span> | <span class="t">And this is our output one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1741" target="_blank">00:29:01.160</a></span> | <span class="t">Let's call it output one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1743" target="_blank">00:29:03.720</a></span> | <span class="t">Then we do another step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1745" target="_blank">00:29:05.320</a></span> | <span class="t">So let me delete this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1746" target="_blank">00:29:06.920</a></span> | <span class="t">Then we do another step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1749" target="_blank">00:29:09.560</a></span> | <span class="t">Let's call it step two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1751" target="_blank">00:29:11.240</a></span> | <span class="t">And again, we give the same input noise as before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1757" target="_blank">00:29:17.400</a></span> | <span class="t">the same time step as the noise level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1761" target="_blank">00:29:21.720</a></span> | <span class="t">So it's the same noise with the same noise level,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1764" target="_blank">00:29:24.040</a></span> | <span class="t">but we don't give any prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1765" target="_blank">00:29:25.480</a></span> | <span class="t">This way, the model will build some output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1768" target="_blank">00:29:28.760</a></span> | <span class="t">Let's call it out two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1770" target="_blank">00:29:30.120</a></span> | <span class="t">which is how to remove the noise to generate something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1774" target="_blank">00:29:34.040</a></span> | <span class="t">We don't know what, but to generate something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1776" target="_blank">00:29:36.280</a></span> | <span class="t">that belongs to our data distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1778" target="_blank">00:29:38.040</a></span> | <span class="t">And then we combine these two output in such a way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1782" target="_blank">00:29:42.360</a></span> | <span class="t">that we can decide how much we want the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1785" target="_blank">00:29:45.960</a></span> | <span class="t">to be closer to the prompt or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1789" target="_blank">00:29:49.720</a></span> | <span class="t">This is called classifier-free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1792" target="_blank">00:29:52.760</a></span> | <span class="t">So this approach here is called classifier-free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1797" target="_blank">00:29:57.320</a></span> | <span class="t">I will not tell you why it's called classifier-free guidance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1799" target="_blank">00:29:59.640</a></span> | <span class="t">because otherwise I need to introduce the classifier guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1802" target="_blank">00:30:02.200</a></span> | <span class="t">And to talk about the classifier guidance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1803" target="_blank">00:30:03.960</a></span> | <span class="t">I need to introduce the score-based models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1806" target="_blank">00:30:06.120</a></span> | <span class="t">to understand why it's called like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1807" target="_blank">00:30:07.960</a></span> | <span class="t">But the idea is this, that we train a model that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1811" target="_blank">00:30:11.320</a></span> | <span class="t">when we train it, sometimes we give it the prompt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1814" target="_blank">00:30:14.760</a></span> | <span class="t">and sometimes we don't give it the prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1816" target="_blank">00:30:16.440</a></span> | <span class="t">so that the model learns to ignore the prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1819" target="_blank">00:30:19.080</a></span> | <span class="t">but also to pay attention to the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1821" target="_blank">00:30:21.240</a></span> | <span class="t">And when we sample from this model, we do two steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1825" target="_blank">00:30:25.480</a></span> | <span class="t">First time, we give him the prompt of what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1827" target="_blank">00:30:27.960</a></span> | <span class="t">And the second time, we give the same noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1829" target="_blank">00:30:29.800</a></span> | <span class="t">but without the prompt of what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1831" target="_blank">00:30:31.800</a></span> | <span class="t">And then we combine the two output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1835" target="_blank">00:30:35.080</a></span> | <span class="t">conditioned and unconditioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1837" target="_blank">00:30:37.960</a></span> | <span class="t">linearly with a weight that indicates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1841" target="_blank">00:30:41.560</a></span> | <span class="t">how much we want the output to be closer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1844" target="_blank">00:30:44.600</a></span> | <span class="t">to our condition, to our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1847" target="_blank">00:30:47.080</a></span> | <span class="t">The higher this value, the more the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1849" target="_blank">00:30:49.960</a></span> | <span class="t">will resemble our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1851" target="_blank">00:30:51.640</a></span> | <span class="t">The lower this value, the less it will resemble our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1855" target="_blank">00:30:55.640</a></span> | <span class="t">And this is the idea behind classifier-free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1858" target="_blank">00:30:58.760</a></span> | <span class="t">To give the prompt, actually we will give,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1861" target="_blank">00:31:01.400</a></span> | <span class="t">we need to give some kind of embedding to the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1864" target="_blank">00:31:04.360</a></span> | <span class="t">so the model needs to understand this prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1867" target="_blank">00:31:07.560</a></span> | <span class="t">To understand the prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1868" target="_blank">00:31:08.840</a></span> | <span class="t">the model needs some kind of embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1871" target="_blank">00:31:11.560</a></span> | <span class="t">Embedding means that we need some vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1874" target="_blank">00:31:14.920</a></span> | <span class="t">that represent the meaning of the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1877" target="_blank">00:31:17.640</a></span> | <span class="t">And this embedding are extracted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1879" target="_blank">00:31:19.880</a></span> | <span class="t">using the CLIP text encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1881" target="_blank">00:31:21.640</a></span> | <span class="t">So before talking about the text encoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1884" target="_blank">00:31:24.520</a></span> | <span class="t">let's talk about CLIP.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1885" target="_blank">00:31:25.640</a></span> | <span class="t">So CLIP was a model built by OpenAI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1888" target="_blank">00:31:28.760</a></span> | <span class="t">that allowed to connect text with images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1893" target="_blank">00:31:33.480</a></span> | <span class="t">And the text, basically, they took a bunch of images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1898" target="_blank">00:31:38.360</a></span> | <span class="t">So for example, this picture and its description.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1901" target="_blank">00:31:41.720</a></span> | <span class="t">Then they took another image along with its description.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1904" target="_blank">00:31:44.280</a></span> | <span class="t">So the image one is associated with the text number one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1908" target="_blank">00:31:48.120</a></span> | <span class="t">which is the description of the image one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1910" target="_blank">00:31:50.760</a></span> | <span class="t">Then the image two has the description number two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1913" target="_blank">00:31:53.720</a></span> | <span class="t">The image three has the text number three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1916" target="_blank">00:31:56.520</a></span> | <span class="t">which is the description of the image three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1918" target="_blank">00:31:58.520</a></span> | <span class="t">et cetera, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1919" target="_blank">00:31:59.800</a></span> | <span class="t">They built this matrix, you can see here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1922" target="_blank">00:32:02.280</a></span> | <span class="t">which is made up of the dot products</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1924" target="_blank">00:32:04.360</a></span> | <span class="t">of the embedding of the first image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1926" target="_blank">00:32:06.760</a></span> | <span class="t">multiplied with all the possible captions here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1929" target="_blank">00:32:09.880</a></span> | <span class="t">So the image one with the text one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1932" target="_blank">00:32:12.280</a></span> | <span class="t">Image one with the text two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1933" target="_blank">00:32:13.560</a></span> | <span class="t">Image one with the text three, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1935" target="_blank">00:32:15.080</a></span> | <span class="t">Then image two with the text one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1937" target="_blank">00:32:17.080</a></span> | <span class="t">Image two with the text two, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1938" target="_blank">00:32:18.520</a></span> | <span class="t">How they train it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1940" target="_blank">00:32:20.760</a></span> | <span class="t">Basically, we know that the correspondence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1943" target="_blank">00:32:23.320</a></span> | <span class="t">between image and the text is on the diagonal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1946" target="_blank">00:32:26.280</a></span> | <span class="t">because the image one is associated with the text one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1950" target="_blank">00:32:30.040</a></span> | <span class="t">Image two is associated with the text two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1951" target="_blank">00:32:31.880</a></span> | <span class="t">Image three is associated with the text three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1953" target="_blank">00:32:33.880</a></span> | <span class="t">So how they train it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1955" target="_blank">00:32:35.480</a></span> | <span class="t">Basically, they said they built a loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1957" target="_blank">00:32:37.960</a></span> | <span class="t">that they want this diagonal to have the maximum value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1963" target="_blank">00:32:43.400</a></span> | <span class="t">and all the other numbers here to be zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1966" target="_blank">00:32:46.040</a></span> | <span class="t">because they are not matching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1967" target="_blank">00:32:47.160</a></span> | <span class="t">They are not the corresponding description of these images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1970" target="_blank">00:32:50.680</a></span> | <span class="t">In this way, the model learned how to combine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1974" target="_blank">00:32:54.360</a></span> | <span class="t">the description of an image with the image itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1977" target="_blank">00:32:57.880</a></span> | <span class="t">And what we do in stable diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1979" target="_blank">00:32:59.960</a></span> | <span class="t">is that we take this text encoder here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1982" target="_blank">00:33:02.600</a></span> | <span class="t">so only this part of this clip,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1985" target="_blank">00:33:05.480</a></span> | <span class="t">to encode our prompt to get some embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1989" target="_blank">00:33:09.160</a></span> | <span class="t">And these embeddings are then used as conditioning signal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1993" target="_blank">00:33:13.480</a></span> | <span class="t">for our unit to denoise the image into what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=1997" target="_blank">00:33:17.880</a></span> | <span class="t">Okay, there is another thing that we need to understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2004" target="_blank">00:33:24.280</a></span> | <span class="t">So as I said before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2005" target="_blank">00:33:25.560</a></span> | <span class="t">we have a forward process that adds noise to the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2009" target="_blank">00:33:29.560</a></span> | <span class="t">Then we have a reverse process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2011" target="_blank">00:33:31.160</a></span> | <span class="t">that removes noise from the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2013" target="_blank">00:33:33.480</a></span> | <span class="t">And this reverse process can be conditioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2016" target="_blank">00:33:36.120</a></span> | <span class="t">by using the classifier-free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2019" target="_blank">00:33:39.800</a></span> | <span class="t">And this reverse process means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2023" target="_blank">00:33:43.480</a></span> | <span class="t">that we need to do many steps of denoisification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2026" target="_blank">00:33:46.840</a></span> | <span class="t">to arrive to the image, to the new image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2029" target="_blank">00:33:49.480</a></span> | <span class="t">And this also means that each of these steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2033" target="_blank">00:33:53.800</a></span> | <span class="t">involves going through the unit with a noisified image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2037" target="_blank">00:33:57.720</a></span> | <span class="t">and getting as output the amount of noise present in this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2042" target="_blank">00:34:02.200</a></span> | <span class="t">But if the image is very big,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2044" target="_blank">00:34:04.280</a></span> | <span class="t">so suppose this image here is 512 multiplied by 512,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2050" target="_blank">00:34:10.120</a></span> | <span class="t">it means every time on the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2052" target="_blank">00:34:12.680</a></span> | <span class="t">we will have a very big matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2054" target="_blank">00:34:14.200</a></span> | <span class="t">that needs to go through this unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2056" target="_blank">00:34:16.600</a></span> | <span class="t">And this may be very slow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2059" target="_blank">00:34:19.000</a></span> | <span class="t">because it's a very big matrix of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2062" target="_blank">00:34:22.120</a></span> | <span class="t">that the unit has to work on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2064" target="_blank">00:34:24.120</a></span> | <span class="t">What if we could somehow compress this image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2067" target="_blank">00:34:27.560</a></span> | <span class="t">into something smaller,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2069" target="_blank">00:34:29.160</a></span> | <span class="t">so that each step through the unit takes less time?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2073" target="_blank">00:34:33.240</a></span> | <span class="t">Well, the idea is that yes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2075" target="_blank">00:34:35.080</a></span> | <span class="t">we can compress this image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2077" target="_blank">00:34:37.000</a></span> | <span class="t">with something that is called the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2081" target="_blank">00:34:41.000</a></span> | <span class="t">Let's see how the variational autoencoder works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2083" target="_blank">00:34:43.240</a></span> | <span class="t">Okay, the stable diffusion is actually known</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2088" target="_blank">00:34:48.920</a></span> | <span class="t">as a latent diffusion model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2093" target="_blank">00:34:53.320</a></span> | <span class="t">because what we learn is not the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2096" target="_blank">00:34:56.680</a></span> | <span class="t">probability distribution Px of our data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2100" target="_blank">00:35:00.440</a></span> | <span class="t">but we learn the latent representation of the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2104" target="_blank">00:35:04.680</a></span> | <span class="t">using a variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2106" target="_blank">00:35:06.920</a></span> | <span class="t">So basically we compress our data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2109" target="_blank">00:35:09.000</a></span> | <span class="t">so let's go back,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2110" target="_blank">00:35:10.040</a></span> | <span class="t">we compress our data into something smaller,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2112" target="_blank">00:35:12.760</a></span> | <span class="t">and then we learn the noisification process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2116" target="_blank">00:35:16.040</a></span> | <span class="t">using this compressed version of the data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2118" target="_blank">00:35:18.840</a></span> | <span class="t">not the original data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2120" target="_blank">00:35:20.200</a></span> | <span class="t">And then we can decompress it to build the original data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2124" target="_blank">00:35:24.680</a></span> | <span class="t">Let me show you actually how it works on a practical level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2128" target="_blank">00:35:28.280</a></span> | <span class="t">So imagine you have some data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2131" target="_blank">00:35:31.560</a></span> | <span class="t">and you want to send it to your friend over the internet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2134" target="_blank">00:35:34.200</a></span> | <span class="t">What do you do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2135" target="_blank">00:35:35.240</a></span> | <span class="t">You can send the original file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2136" target="_blank">00:35:36.840</a></span> | <span class="t">or you can send the zipped file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2138" target="_blank">00:35:38.600</a></span> | <span class="t">So you can zip the file,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2140" target="_blank">00:35:40.200</a></span> | <span class="t">maybe with WinZip, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2141" target="_blank">00:35:41.960</a></span> | <span class="t">and then you send the file to your friend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2143" target="_blank">00:35:43.800</a></span> | <span class="t">and the friend can unzip it after receiving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2147" target="_blank">00:35:47.960</a></span> | <span class="t">and rebuild the original data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2149" target="_blank">00:35:49.400</a></span> | <span class="t">This is exactly the job of the autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2151" target="_blank">00:35:51.880</a></span> | <span class="t">The autoencoder is a network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2153" target="_blank">00:35:53.720</a></span> | <span class="t">that given an image, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2155" target="_blank">00:35:55.480</a></span> | <span class="t">will, after passing through the encoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2158" target="_blank">00:35:58.120</a></span> | <span class="t">will transform into a vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2159" target="_blank">00:35:59.800</a></span> | <span class="t">which has a dimension that is much smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2163" target="_blank">00:36:03.160</a></span> | <span class="t">than the original image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2164" target="_blank">00:36:04.760</a></span> | <span class="t">And if we use this vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2166" target="_blank">00:36:06.600</a></span> | <span class="t">and run it through the decoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2168" target="_blank">00:36:08.360</a></span> | <span class="t">it will build the original image back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2170" target="_blank">00:36:10.920</a></span> | <span class="t">And we can do it for many images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2175" target="_blank">00:36:15.000</a></span> | <span class="t">and each of them will have a representation in this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2177" target="_blank">00:36:17.560</a></span> | <span class="t">This is called a code corresponding to each image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2182" target="_blank">00:36:22.280</a></span> | <span class="t">Now, the problem with autoencoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2183" target="_blank">00:36:23.960</a></span> | <span class="t">is that the code learned by this model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2187" target="_blank">00:36:27.480</a></span> | <span class="t">doesn't make any sense from a semantic point of view.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2190" target="_blank">00:36:30.680</a></span> | <span class="t">So the code associated with the cat, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2193" target="_blank">00:36:33.480</a></span> | <span class="t">may be very similar to the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2196" target="_blank">00:36:36.040</a></span> | <span class="t">associated with pizza, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2198" target="_blank">00:36:38.120</a></span> | <span class="t">or the code associated with a building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2200" target="_blank">00:36:40.360</a></span> | <span class="t">So there is no semantic relationship</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2203" target="_blank">00:36:43.320</a></span> | <span class="t">between these codes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2204" target="_blank">00:36:44.600</a></span> | <span class="t">And to overcome this limitation of the autoencoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2207" target="_blank">00:36:47.320</a></span> | <span class="t">we introduce the variational autoencoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2209" target="_blank">00:36:49.640</a></span> | <span class="t">in which we learn to kind of compress the data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2214" target="_blank">00:36:54.600</a></span> | <span class="t">but at the same time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2216" target="_blank">00:36:56.280</a></span> | <span class="t">this data is distributed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2218" target="_blank">00:36:58.040</a></span> | <span class="t">according to a multivariate distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2220" target="_blank">00:37:00.120</a></span> | <span class="t">which most of the times is a Gaussian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2222" target="_blank">00:37:02.440</a></span> | <span class="t">And we learn the mean and the sigma of this distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2228" target="_blank">00:37:08.440</a></span> | <span class="t">this very complex distribution here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2231" target="_blank">00:37:11.240</a></span> | <span class="t">And given the latent representation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2233" target="_blank">00:37:13.480</a></span> | <span class="t">we can always pass it through the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2235" target="_blank">00:37:15.640</a></span> | <span class="t">to rebuild the original data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2237" target="_blank">00:37:17.240</a></span> | <span class="t">And this is the idea that we use also in stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2240" target="_blank">00:37:20.360</a></span> | <span class="t">Now we can finally combine all these things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2244" target="_blank">00:37:24.440</a></span> | <span class="t">that we have seen together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2245" target="_blank">00:37:25.960</a></span> | <span class="t">to see what is the architecture of the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2249" target="_blank">00:37:29.960</a></span> | <span class="t">So let's start with how the text-to-image works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2254" target="_blank">00:37:34.760</a></span> | <span class="t">Now, imagine text-to-image basically works like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2259" target="_blank">00:37:39.160</a></span> | <span class="t">Imagine you want to generate a picture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2262" target="_blank">00:37:42.280</a></span> | <span class="t">of a dog with glasses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2264" target="_blank">00:37:44.200</a></span> | <span class="t">So you start, of course, with a prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2266" target="_blank">00:37:46.120</a></span> | <span class="t">a dog with glasses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2267" target="_blank">00:37:47.640</a></span> | <span class="t">And then what do we do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2269" target="_blank">00:37:49.640</a></span> | <span class="t">We sample some noise here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2272" target="_blank">00:37:52.440</a></span> | <span class="t">some noise from the N01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2275" target="_blank">00:37:55.080</a></span> | <span class="t">We encode it with our variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2278" target="_blank">00:37:58.760</a></span> | <span class="t">This will give us a latent representation of this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2283" target="_blank">00:38:03.560</a></span> | <span class="t">Let's call it Z.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2284" target="_blank">00:38:04.600</a></span> | <span class="t">This is, of course, a pure noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2287" target="_blank">00:38:07.160</a></span> | <span class="t">but has been compressed by the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2289" target="_blank">00:38:09.880</a></span> | <span class="t">And then we send it to the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2293" target="_blank">00:38:13.960</a></span> | <span class="t">The goal of the unit is to detect how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2297" target="_blank">00:38:17.480</a></span> | <span class="t">And also, because to the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2299" target="_blank">00:38:19.320</a></span> | <span class="t">we also give the conditioning signal,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2301" target="_blank">00:38:21.480</a></span> | <span class="t">the unit has to detect the noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2304" target="_blank">00:38:24.440</a></span> | <span class="t">what noise we need to remove</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2306" target="_blank">00:38:26.920</a></span> | <span class="t">to make it into a picture that follows the prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2310" target="_blank">00:38:30.360</a></span> | <span class="t">so into a picture of a dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2312" target="_blank">00:38:32.200</a></span> | <span class="t">So the unit, we pass it through the unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2314" target="_blank">00:38:34.280</a></span> | <span class="t">along with the time step, initial time step,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2316" target="_blank">00:38:36.920</a></span> | <span class="t">so 1,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2317" target="_blank">00:38:37.720</a></span> | <span class="t">And the unit will detect at the output here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2321" target="_blank">00:38:41.800</a></span> | <span class="t">how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2323" target="_blank">00:38:43.480</a></span> | <span class="t">Our scheduler, we will see later what is the scheduler,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2326" target="_blank">00:38:46.280</a></span> | <span class="t">will remove this noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2328" target="_blank">00:38:48.200</a></span> | <span class="t">and then send it again to the unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2330" target="_blank">00:38:50.120</a></span> | <span class="t">for the second step of denoisification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2332" target="_blank">00:38:52.280</a></span> | <span class="t">And again, we send the time step,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2334" target="_blank">00:38:54.840</a></span> | <span class="t">which is in this case not 1,000,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2337" target="_blank">00:38:57.400</a></span> | <span class="t">but 980, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2339" target="_blank">00:38:59.560</a></span> | <span class="t">because we skipped some steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2341" target="_blank">00:39:01.080</a></span> | <span class="t">And then we again, with the noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2343" target="_blank">00:39:03.560</a></span> | <span class="t">we detect how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2345" target="_blank">00:39:05.240</a></span> | <span class="t">The scheduler will remove this noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2347" target="_blank">00:39:07.480</a></span> | <span class="t">and again send it back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2349" target="_blank">00:39:09.240</a></span> | <span class="t">And we do many times this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2351" target="_blank">00:39:11.560</a></span> | <span class="t">We keep doing this denoisification for many steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2355" target="_blank">00:39:15.000</a></span> | <span class="t">until there is no more noise present in the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2358" target="_blank">00:39:18.920</a></span> | <span class="t">And after we have finished this loop of steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2362" target="_blank">00:39:22.520</a></span> | <span class="t">we get the output Z prime,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2366" target="_blank">00:39:26.040</a></span> | <span class="t">which is still a latent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2367" target="_blank">00:39:27.480</a></span> | <span class="t">because this unit only works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2369" target="_blank">00:39:29.240</a></span> | <span class="t">with the latent representation of the data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2371" target="_blank">00:39:31.000</a></span> | <span class="t">not with the original data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2372" target="_blank">00:39:32.200</a></span> | <span class="t">We pass it through the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2375" target="_blank">00:39:35.000</a></span> | <span class="t">to obtain the output image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2378" target="_blank">00:39:38.440</a></span> | <span class="t">And this is why this is called a latent diffusion model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2381" target="_blank">00:39:41.880</a></span> | <span class="t">because the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2383" target="_blank">00:39:43.080</a></span> | <span class="t">so the denoisification process,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2384" target="_blank">00:39:44.840</a></span> | <span class="t">always works with the latent representation of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2387" target="_blank">00:39:47.720</a></span> | <span class="t">And this is how we generate text to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2390" target="_blank">00:39:50.600</a></span> | <span class="t">We can do the same thing for image to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2393" target="_blank">00:39:53.400</a></span> | <span class="t">Image to image means that I have,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2395" target="_blank">00:39:55.480</a></span> | <span class="t">for example, the picture of a dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2397" target="_blank">00:39:57.320</a></span> | <span class="t">and I want to modify this image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2400" target="_blank">00:40:00.040</a></span> | <span class="t">into something else by using a prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2402" target="_blank">00:40:02.440</a></span> | <span class="t">For example, I want the model to add glasses to this dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2405" target="_blank">00:40:05.480</a></span> | <span class="t">so I can give the input image here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2407" target="_blank">00:40:07.720</a></span> | <span class="t">And then I say a dog with glasses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2409" target="_blank">00:40:09.800</a></span> | <span class="t">and hopefully the model will add glasses to this dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2413" target="_blank">00:40:13.000</a></span> | <span class="t">How does it work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2413" target="_blank">00:40:13.800</a></span> | <span class="t">We encode the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2416" target="_blank">00:40:16.520</a></span> | <span class="t">with the encoder of the variational autoencoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2418" target="_blank">00:40:18.920</a></span> | <span class="t">and we get the latent representation of our image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2422" target="_blank">00:40:22.360</a></span> | <span class="t">Then we add noise to this latent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2424" target="_blank">00:40:24.760</a></span> | <span class="t">because the unit, as we saw before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2426" target="_blank">00:40:26.920</a></span> | <span class="t">his job is to denoise an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2429" target="_blank">00:40:29.000</a></span> | <span class="t">But of course, we need to have some noise to denoise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2431" target="_blank">00:40:31.640</a></span> | <span class="t">So we add noise to this image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2434" target="_blank">00:40:34.920</a></span> | <span class="t">and the amount of noise that we add to this image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2438" target="_blank">00:40:38.360</a></span> | <span class="t">so this starting image here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2440" target="_blank">00:40:40.120</a></span> | <span class="t">indicates how much freedom the unit has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2443" target="_blank">00:40:43.800</a></span> | <span class="t">into building the output image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2445" target="_blank">00:40:45.400</a></span> | <span class="t">Because the more noise we add,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2447" target="_blank">00:40:47.400</a></span> | <span class="t">the more the unit has freedom to alter the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2450" target="_blank">00:40:50.360</a></span> | <span class="t">But the less noise we add,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2451" target="_blank">00:40:51.720</a></span> | <span class="t">the less freedom the model has to alter the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2454" target="_blank">00:40:54.520</a></span> | <span class="t">because it cannot change radically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2457" target="_blank">00:40:57.320</a></span> | <span class="t">If we start from pure noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2460" target="_blank">00:41:00.680</a></span> | <span class="t">the unit can do anything it wants.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2463" target="_blank">00:41:03.240</a></span> | <span class="t">But if we start with less noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2465" target="_blank">00:41:05.000</a></span> | <span class="t">the unit is forced to modify just a little bit the output image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2469" target="_blank">00:41:09.720</a></span> | <span class="t">So the amount of noise that we start from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2472" target="_blank">00:41:12.920</a></span> | <span class="t">indicates how much we want the model to pay attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2475" target="_blank">00:41:15.880</a></span> | <span class="t">to the initial image here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2477" target="_blank">00:41:17.560</a></span> | <span class="t">And then we give the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2480" target="_blank">00:41:20.520</a></span> | <span class="t">For many steps, we keep denoising, denoising, denoising, denoising.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2484" target="_blank">00:41:24.040</a></span> | <span class="t">And after there is no more noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2486" target="_blank">00:41:26.600</a></span> | <span class="t">we take this latent representation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2488" target="_blank">00:41:28.760</a></span> | <span class="t">we pass it through the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2490" target="_blank">00:41:30.520</a></span> | <span class="t">and we get the output image here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2493" target="_blank">00:41:33.560</a></span> | <span class="t">And this is how image-to-image works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2495" target="_blank">00:41:35.560</a></span> | <span class="t">Now let's go to the last part,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2498" target="_blank">00:41:38.120</a></span> | <span class="t">which is how in-painting works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2500" target="_blank">00:41:40.280</a></span> | <span class="t">In-painting works similar way to the image-to-image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2504" target="_blank">00:41:44.600</a></span> | <span class="t">but with a mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2505" target="_blank">00:41:45.640</a></span> | <span class="t">So in-painting means, first of all,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2507" target="_blank">00:41:47.960</a></span> | <span class="t">that we have an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2509" target="_blank">00:41:49.720</a></span> | <span class="t">and we want to cut some part of this image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2511" target="_blank">00:41:51.960</a></span> | <span class="t">for example, the legs of this dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2513" target="_blank">00:41:53.880</a></span> | <span class="t">and we want the model to generate new legs for this dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2517" target="_blank">00:41:57.240</a></span> | <span class="t">that are maybe a little different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2518" target="_blank">00:41:58.760</a></span> | <span class="t">So as you can see,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2520" target="_blank">00:42:00.360</a></span> | <span class="t">these feet here are a little different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2523" target="_blank">00:42:03.000</a></span> | <span class="t">from the legs of the dog here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2525" target="_blank">00:42:05.480</a></span> | <span class="t">So what we do is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2528" target="_blank">00:42:08.120</a></span> | <span class="t">we start from our initial image of the dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2530" target="_blank">00:42:10.440</a></span> | <span class="t">We pass it through the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2532" target="_blank">00:42:12.680</a></span> | <span class="t">It becomes a latent representation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2534" target="_blank">00:42:14.520</a></span> | <span class="t">We add some noise to this latent representation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2537" target="_blank">00:42:17.480</a></span> | <span class="t">We give some prompt to tell the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2540" target="_blank">00:42:20.280</a></span> | <span class="t">what we want the model to generate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2542" target="_blank">00:42:22.440</a></span> | <span class="t">So I just say a dog running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2543" target="_blank">00:42:23.800</a></span> | <span class="t">because I want to generate new legs for this dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2546" target="_blank">00:42:26.920</a></span> | <span class="t">And then we pass the noisified input to the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2552" target="_blank">00:42:32.600</a></span> | <span class="t">The unit will produce an output here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2554" target="_blank">00:42:34.680</a></span> | <span class="t">for the first time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2555" target="_blank">00:42:35.880</a></span> | <span class="t">But then, of course, nobody told the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2559" target="_blank">00:42:39.240</a></span> | <span class="t">to only predict this area.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2561" target="_blank">00:42:41.640</a></span> | <span class="t">The model, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2562" target="_blank">00:42:42.920</a></span> | <span class="t">here at the output predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2564" target="_blank">00:42:44.680</a></span> | <span class="t">and modified the noise all the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2567" target="_blank">00:42:47.800</a></span> | <span class="t">But we take this output here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2570" target="_blank">00:42:50.920</a></span> | <span class="t">and we don't care what the noise predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2576" target="_blank">00:42:56.680</a></span> | <span class="t">for this area of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2578" target="_blank">00:42:58.200</a></span> | <span class="t">The area that we already know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2580" target="_blank">00:43:00.120</a></span> | <span class="t">We replace it with the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2582" target="_blank">00:43:02.680</a></span> | <span class="t">that we already know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2583" target="_blank">00:43:03.640</a></span> | <span class="t">And we pass it again through the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2587" target="_blank">00:43:07.560</a></span> | <span class="t">Basically, what we do is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2588" target="_blank">00:43:08.920</a></span> | <span class="t">at every step,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2590" target="_blank">00:43:10.040</a></span> | <span class="t">at every output of the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2591" target="_blank">00:43:11.720</a></span> | <span class="t">we replace the areas that are already known</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2594" target="_blank">00:43:14.600</a></span> | <span class="t">with the areas of the original image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2598" target="_blank">00:43:18.120</a></span> | <span class="t">So, basically, to fool the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2600" target="_blank">00:43:20.760</a></span> | <span class="t">into believing that it was the model itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2603" target="_blank">00:43:23.080</a></span> | <span class="t">that came up with these details of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2606" target="_blank">00:43:26.120</a></span> | <span class="t">not us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2607" target="_blank">00:43:27.160</a></span> | <span class="t">So every time here in this area,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2610" target="_blank">00:43:30.760</a></span> | <span class="t">before we send it back to the unit here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2613" target="_blank">00:43:33.160</a></span> | <span class="t">here we combine the output of the unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2616" target="_blank">00:43:36.600</a></span> | <span class="t">with the existing image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2618" target="_blank">00:43:38.440</a></span> | <span class="t">by replacing whatever output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2620" target="_blank">00:43:40.600</a></span> | <span class="t">the unit gave us for this area here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2623" target="_blank">00:43:43.880</a></span> | <span class="t">with what is the original image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2625" target="_blank">00:43:45.800</a></span> | <span class="t">And then we give it back to the unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2627" target="_blank">00:43:47.880</a></span> | <span class="t">and we keep doing it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2629" target="_blank">00:43:49.400</a></span> | <span class="t">This way the model will only be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2631" target="_blank">00:43:51.720</a></span> | <span class="t">to work on this area here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2633" target="_blank">00:43:53.560</a></span> | <span class="t">because this is the one we never replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2635" target="_blank">00:43:55.560</a></span> | <span class="t">in the output of the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2637" target="_blank">00:43:57.080</a></span> | <span class="t">And then after there is no more noise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2638" target="_blank">00:43:58.760</a></span> | <span class="t">we take the output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2640" target="_blank">00:44:00.120</a></span> | <span class="t">we send it to the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2642" target="_blank">00:44:02.440</a></span> | <span class="t">and then it will build the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2645" target="_blank">00:44:05.800</a></span> | <span class="t">we can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2646" target="_blank">00:44:06.920</a></span> | <span class="t">Okay, this is how the stable diffusion works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2651" target="_blank">00:44:11.320</a></span> | <span class="t">from an architecture point of view.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2653" target="_blank">00:44:13.080</a></span> | <span class="t">I know it has been a long journey.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2654" target="_blank">00:44:14.600</a></span> | <span class="t">I had to introduce many concepts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2656" target="_blank">00:44:16.920</a></span> | <span class="t">but it's very important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2658" target="_blank">00:44:18.120</a></span> | <span class="t">that we know these concepts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2659" target="_blank">00:44:19.640</a></span> | <span class="t">before we start building the unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2661" target="_blank">00:44:21.560</a></span> | <span class="t">because otherwise we don't even know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2666" target="_blank">00:44:26.200</a></span> | <span class="t">how to start building the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2668" target="_blank">00:44:28.600</a></span> | <span class="t">Here we are finally coding our stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2672" target="_blank">00:44:32.520</a></span> | <span class="t">And the first thing that we will code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2675" target="_blank">00:44:35.000</a></span> | <span class="t">is the variational autoencoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2676" target="_blank">00:44:36.680</a></span> | <span class="t">because it's external to the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2678" target="_blank">00:44:38.520</a></span> | <span class="t">so it's external to the diffusion model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2680" target="_blank">00:44:40.680</a></span> | <span class="t">so the one that will detect,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2682" target="_blank">00:44:42.360</a></span> | <span class="t">will predict how much noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2683" target="_blank">00:44:43.880</a></span> | <span class="t">is present in the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2685" target="_blank">00:44:45.640</a></span> | <span class="t">And let's review it actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2687" target="_blank">00:44:47.320</a></span> | <span class="t">Let's review the architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2688" target="_blank">00:44:48.600</a></span> | <span class="t">and let me go to this slide here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2692" target="_blank">00:44:52.520</a></span> | <span class="t">Okay, oops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2695" target="_blank">00:44:55.080</a></span> | <span class="t">This one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2699" target="_blank">00:44:59.000</a></span> | <span class="t">Okay, the first thing that we will build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2701" target="_blank">00:45:01.240</a></span> | <span class="t">is this part here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2702" target="_blank">00:45:02.360</a></span> | <span class="t">The encoder and the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2707" target="_blank">00:45:07.240</a></span> | <span class="t">of our variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2709" target="_blank">00:45:09.240</a></span> | <span class="t">The job of the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2710" target="_blank">00:45:10.760</a></span> | <span class="t">and the decoder of the variational autoencoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2712" target="_blank">00:45:12.440</a></span> | <span class="t">is to encode an image or noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2715" target="_blank">00:45:15.960</a></span> | <span class="t">into a compressed version of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2718" target="_blank">00:45:18.520</a></span> | <span class="t">or the noise itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2719" target="_blank">00:45:19.640</a></span> | <span class="t">such that then we can take this latent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2723" target="_blank">00:45:23.560</a></span> | <span class="t">and run it through the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2725" target="_blank">00:45:25.480</a></span> | <span class="t">And then after the last step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2728" target="_blank">00:45:28.120</a></span> | <span class="t">of the noisification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2729" target="_blank">00:45:29.320</a></span> | <span class="t">we take this compressed version or latent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2732" target="_blank">00:45:32.360</a></span> | <span class="t">and we pass it through the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2734" target="_blank">00:45:34.440</a></span> | <span class="t">and to get the original,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2735" target="_blank">00:45:35.720</a></span> | <span class="t">the output image, not the original.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2737" target="_blank">00:45:37.480</a></span> | <span class="t">And so the encoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2741" target="_blank">00:45:41.080</a></span> | <span class="t">actually his job is to reduce</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2743" target="_blank">00:45:43.640</a></span> | <span class="t">the dimension of the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2745" target="_blank">00:45:45.320</a></span> | <span class="t">into a smaller data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2746" target="_blank">00:45:46.760</a></span> | <span class="t">into the data with the smaller dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2749" target="_blank">00:45:49.480</a></span> | <span class="t">And the idea is very similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2751" target="_blank">00:45:51.240</a></span> | <span class="t">to the one of the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2752" target="_blank">00:45:52.280</a></span> | <span class="t">So we start with a picture that is very big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2754" target="_blank">00:45:54.760</a></span> | <span class="t">and at each step there are multiple levels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2757" target="_blank">00:45:57.720</a></span> | <span class="t">We keep reducing the size of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2761" target="_blank">00:46:01.080</a></span> | <span class="t">but at the same time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2762" target="_blank">00:46:02.440</a></span> | <span class="t">we keep increasing the features of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2765" target="_blank">00:46:05.400</a></span> | <span class="t">What does it mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2766" target="_blank">00:46:06.440</a></span> | <span class="t">That initially each pixel of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2768" target="_blank">00:46:08.920</a></span> | <span class="t">will be represented by three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2771" target="_blank">00:46:11.560</a></span> | <span class="t">So red, green and blue RGB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2773" target="_blank">00:46:13.800</a></span> | <span class="t">At each step by using convolutions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2777" target="_blank">00:46:17.720</a></span> | <span class="t">we will reduce the size of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2779" target="_blank">00:46:19.880</a></span> | <span class="t">but at the same time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2780" target="_blank">00:46:20.840</a></span> | <span class="t">we will increase the number of features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2783" target="_blank">00:46:23.720</a></span> | <span class="t">that each pixel represents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2786" target="_blank">00:46:26.280</a></span> | <span class="t">So each pixel will be represented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2787" target="_blank">00:46:27.800</a></span> | <span class="t">not by three channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2788" target="_blank">00:46:28.760</a></span> | <span class="t">but maybe by more channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2790" target="_blank">00:46:30.840</a></span> | <span class="t">This means that each pixel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2792" target="_blank">00:46:32.840</a></span> | <span class="t">will actually capture more data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2794" target="_blank">00:46:34.920</a></span> | <span class="t">More data of the area</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2797" target="_blank">00:46:37.640</a></span> | <span class="t">to which that pixel belongs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2799" target="_blank">00:46:39.560</a></span> | <span class="t">And this is thanks to the convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2802" target="_blank">00:46:42.040</a></span> | <span class="t">But I will show you later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2803" target="_blank">00:46:43.720</a></span> | <span class="t">with an animation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2805" target="_blank">00:46:45.400</a></span> | <span class="t">So let's start building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2807" target="_blank">00:46:47.720</a></span> | <span class="t">The first thing we do is open Visual Studio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2811" target="_blank">00:46:51.320</a></span> | <span class="t">And we create three folders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2814" target="_blank">00:46:54.600</a></span> | <span class="t">The first is called data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2816" target="_blank">00:46:56.440</a></span> | <span class="t">And later we download the pre-trained weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2819" target="_blank">00:46:59.160</a></span> | <span class="t">that you can also find on my GitHub.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2821" target="_blank">00:47:01.000</a></span> | <span class="t">Another folder called images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2823" target="_blank">00:47:03.560</a></span> | <span class="t">in which we put images as input and output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2826" target="_blank">00:47:06.920</a></span> | <span class="t">And then another folder called SD</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2828" target="_blank">00:47:08.520</a></span> | <span class="t">which is our module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2829" target="_blank">00:47:09.560</a></span> | <span class="t">Let's create two files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2831" target="_blank">00:47:11.480</a></span> | <span class="t">One called encoder.py</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2833" target="_blank">00:47:13.320</a></span> | <span class="t">and one called decoder.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2835" target="_blank">00:47:15.560</a></span> | <span class="t">These are the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2838" target="_blank">00:47:18.520</a></span> | <span class="t">and the decoder of our variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2842" target="_blank">00:47:22.600</a></span> | <span class="t">Let's start with the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2844" target="_blank">00:47:24.600</a></span> | <span class="t">And the encoder is quite simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2848" target="_blank">00:47:28.200</a></span> | <span class="t">So let's start by importing Torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2850" target="_blank">00:47:30.040</a></span> | <span class="t">and all the other stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2855" target="_blank">00:47:35.560</a></span> | <span class="t">Let me also select the interpreter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2858" target="_blank">00:47:38.360</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2862" target="_blank">00:47:42.140</a></span> | <span class="t">Then we need to import two other blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2865" target="_blank">00:47:45.880</a></span> | <span class="t">that we will define later in the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2867" target="_blank">00:47:47.800</a></span> | <span class="t">Let's call them for now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2869" target="_blank">00:47:49.080</a></span> | <span class="t">port VAE attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2874" target="_blank">00:47:54.600</a></span> | <span class="t">And this is the port VAE attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2878" target="_blank">00:47:58.280</a></span> | <span class="t">And this is the port VAE attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2880" target="_blank">00:48:00.680</a></span> | <span class="t">And this is the port VAE attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2882" target="_blank">00:48:02.680</a></span> | <span class="t">And this is the port VAE attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2884" target="_blank">00:48:04.280</a></span> | <span class="t">And VAE residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2886" target="_blank">00:48:06.840</a></span> | <span class="t">For those who are familiar with computer vision models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2889" target="_blank">00:48:09.880</a></span> | <span class="t">the residual block is very similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2891" target="_blank">00:48:11.320</a></span> | <span class="t">to the residual block that is used in the ResNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2893" target="_blank">00:48:13.800</a></span> | <span class="t">So later you will see the structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2895" target="_blank">00:48:15.160</a></span> | <span class="t">It's very similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2895" target="_blank">00:48:15.880</a></span> | <span class="t">But if those who are not familiar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2897" target="_blank">00:48:17.400</a></span> | <span class="t">don't worry, I will explain it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2899" target="_blank">00:48:19.320</a></span> | <span class="t">So let's start building this encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2901" target="_blank">00:48:21.000</a></span> | <span class="t">And this will inherit from the sequential module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2907" target="_blank">00:48:27.720</a></span> | <span class="t">which means basically our encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2909" target="_blank">00:48:29.480</a></span> | <span class="t">is a sequence of modules, submodules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2912" target="_blank">00:48:32.040</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2912" target="_blank">00:48:32.540</a></span> | <span class="t">It's a sequence of submodules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2930" target="_blank">00:48:50.760</a></span> | <span class="t">in which each module is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2933" target="_blank">00:48:53.960</a></span> | <span class="t">that reduces the dimension of the data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2936" target="_blank">00:48:56.520</a></span> | <span class="t">but at the same time increases its number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2940" target="_blank">00:49:00.760</a></span> | <span class="t">I will write the blocks one by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2947" target="_blank">00:49:07.160</a></span> | <span class="t">And as soon as we encounter a block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2949" target="_blank">00:49:09.720</a></span> | <span class="t">that we didn't define, we go to define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2951" target="_blank">00:49:11.640</a></span> | <span class="t">And then we define also the shapes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2953" target="_blank">00:49:13.480</a></span> | <span class="t">So the first thing we do, just like in the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2956" target="_blank">00:49:16.200</a></span> | <span class="t">is we define a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2958" target="_blank">00:49:18.520</a></span> | <span class="t">Convolution 2D.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2960" target="_blank">00:49:20.840</a></span> | <span class="t">Initially, our image will have three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2965" target="_blank">00:49:25.160</a></span> | <span class="t">And we convert it to 128 channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2967" target="_blank">00:49:27.480</a></span> | <span class="t">with a kernel size of 3 and a padding of 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2972" target="_blank">00:49:32.120</a></span> | <span class="t">For those who are not familiar with convolutions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2975" target="_blank">00:49:35.640</a></span> | <span class="t">let's go have a look at how convolutions work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2978" target="_blank">00:49:38.360</a></span> | <span class="t">Here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=2995" target="_blank">00:49:55.500</a></span> | <span class="t">Here we can see that a convolution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3000" target="_blank">00:50:00.940</a></span> | <span class="t">basically, it's a kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3002" target="_blank">00:50:02.300</a></span> | <span class="t">So it's made of a matrix of a size that we can decide,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3006" target="_blank">00:50:06.940</a></span> | <span class="t">which is defined by the parameter kernel size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3009" target="_blank">00:50:09.420</a></span> | <span class="t">which is run through the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3012" target="_blank">00:50:12.300</a></span> | <span class="t">as in the following animation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3015" target="_blank">00:50:15.180</a></span> | <span class="t">So block by block, as you can see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3017" target="_blank">00:50:17.980</a></span> | <span class="t">And at each block, each of the pixel below the kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3023" target="_blank">00:50:23.500</a></span> | <span class="t">is multiplied by the value of the kernel in that position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3026" target="_blank">00:50:26.700</a></span> | <span class="t">So in this, for example, this pixel here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3028" target="_blank">00:50:28.780</a></span> | <span class="t">which is in position, let's call the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3031" target="_blank">00:50:31.260</a></span> | <span class="t">let's say this one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3032" target="_blank">00:50:32.780</a></span> | <span class="t">So the first row and the first column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3034" target="_blank">00:50:34.860</a></span> | <span class="t">is multiplied by this red value of the kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3039" target="_blank">00:50:39.740</a></span> | <span class="t">The second column, first row,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3042" target="_blank">00:50:42.380</a></span> | <span class="t">is multiplied by the green value of the kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3045" target="_blank">00:50:45.420</a></span> | <span class="t">And then all of these multiplications</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3046" target="_blank">00:50:46.940</a></span> | <span class="t">are summed up to produce one output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3049" target="_blank">00:50:49.260</a></span> | <span class="t">So this output here comes from four multiplications</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3051" target="_blank">00:50:51.980</a></span> | <span class="t">that we do in this area,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3053" target="_blank">00:50:53.500</a></span> | <span class="t">each one with the corresponding number of the kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3057" target="_blank">00:50:57.420</a></span> | <span class="t">This way, basically, by running this kernel through the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3060" target="_blank">00:51:00.540</a></span> | <span class="t">we capture local information about the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3063" target="_blank">00:51:03.980</a></span> | <span class="t">And this pixel here combines somehow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3067" target="_blank">00:51:07.500</a></span> | <span class="t">the information of four pixels, not only one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3070" target="_blank">00:51:10.380</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3072" target="_blank">00:51:12.540</a></span> | <span class="t">Then we can also increase the kernel size, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3076" target="_blank">00:51:16.380</a></span> | <span class="t">And the kernel size, increasing the kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3079" target="_blank">00:51:19.180</a></span> | <span class="t">means that we capture more global information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3081" target="_blank">00:51:21.900</a></span> | <span class="t">So each pixel represents the information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3084" target="_blank">00:51:24.140</a></span> | <span class="t">of more pixel from the original picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3087" target="_blank">00:51:27.100</a></span> | <span class="t">So the output is smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3088" target="_blank">00:51:28.700</a></span> | <span class="t">And then we can introduce, for example, the stride,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3092" target="_blank">00:51:32.620</a></span> | <span class="t">which means that we don't do it every successive pixel,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3096" target="_blank">00:51:36.460</a></span> | <span class="t">but we skip some pixels, as you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3098" target="_blank">00:51:38.700</a></span> | <span class="t">So we skip every second pixel here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3101" target="_blank">00:51:41.340</a></span> | <span class="t">And if the number is, the kernel size is even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3106" target="_blank">00:51:46.780</a></span> | <span class="t">and the input size is odd,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3109" target="_blank">00:51:49.020</a></span> | <span class="t">we will also never touch, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3111" target="_blank">00:51:51.020</a></span> | <span class="t">here, the border, as you can see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3112" target="_blank">00:51:52.380</a></span> | <span class="t">We can also implement a dilation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3114" target="_blank">00:51:54.780</a></span> | <span class="t">which means that it becomes, with the same kernel size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3119" target="_blank">00:51:59.100</a></span> | <span class="t">the information becomes even more global</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3121" target="_blank">00:52:01.820</a></span> | <span class="t">because we don't watch consecutive pixel,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3124" target="_blank">00:52:04.700</a></span> | <span class="t">but we skip some pixels, et cetera, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3127" target="_blank">00:52:07.580</a></span> | <span class="t">So the kernels, basically, the convolutions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3129" target="_blank">00:52:09.580</a></span> | <span class="t">allow us to capture information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3132" target="_blank">00:52:12.060</a></span> | <span class="t">from a local area of the picture, of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3135" target="_blank">00:52:15.180</a></span> | <span class="t">and combine it using a kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3138" target="_blank">00:52:18.300</a></span> | <span class="t">And this is the idea behind convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3140" target="_blank">00:52:20.140</a></span> | <span class="t">So this convolution here, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3143" target="_blank">00:52:23.660</a></span> | <span class="t">will start with our, okay, let's define some shapes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3147" target="_blank">00:52:27.020</a></span> | <span class="t">Our variational autoencoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3149" target="_blank">00:52:29.580</a></span> | <span class="t">so the encoder of the variational autoencoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3152" target="_blank">00:52:32.060</a></span> | <span class="t">will start with batch size and three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3157" target="_blank">00:52:37.580</a></span> | <span class="t">Let's define it as channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3159" target="_blank">00:52:39.660</a></span> | <span class="t">Then this image will have a height and the width,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3163" target="_blank">00:52:43.580</a></span> | <span class="t">which will be 512 by 512, as we will see later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3167" target="_blank">00:52:47.900</a></span> | <span class="t">And this convolution will convert it into batch size 128 features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3174" target="_blank">00:52:54.140</a></span> | <span class="t">with the same height and the same width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3176" target="_blank">00:52:56.780</a></span> | <span class="t">Why, in this case, the height and the width doesn't change?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3182" target="_blank">00:53:02.540</a></span> | <span class="t">Because even if we have a kernel size of size three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3185" target="_blank">00:53:05.740</a></span> | <span class="t">because we add padding, basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3187" target="_blank">00:53:07.500</a></span> | <span class="t">we add something to the right side,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3189" target="_blank">00:53:09.820</a></span> | <span class="t">something to the top side,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3191" target="_blank">00:53:11.180</a></span> | <span class="t">something to the bottom and the left of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3192" target="_blank">00:53:12.940</a></span> | <span class="t">So the image with the padding becomes bigger,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3195" target="_blank">00:53:15.580</a></span> | <span class="t">but then the output of the convolution makes it smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3198" target="_blank">00:53:18.940</a></span> | <span class="t">and matches the original size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3201" target="_blank">00:53:21.420</a></span> | <span class="t">This is the reason we have the padding here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3204" target="_blank">00:53:24.780</a></span> | <span class="t">But we will see later that with the next blocks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3208" target="_blank">00:53:28.220</a></span> | <span class="t">the image size will start becoming smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3210" target="_blank">00:53:30.940</a></span> | <span class="t">The next block is called the residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3215" target="_blank">00:53:35.420</a></span> | <span class="t">And VAE residual block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3218" target="_blank">00:53:38.220</a></span> | <span class="t">which is from 128 channels to 128 channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3224" target="_blank">00:53:44.380</a></span> | <span class="t">This is a combination,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3225" target="_blank">00:53:45.580</a></span> | <span class="t">this residual block is a combination of convolutions and normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3232" target="_blank">00:53:52.540</a></span> | <span class="t">So it's just a bunch of convolutions that we will define later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3235" target="_blank">00:53:55.980</a></span> | <span class="t">And this one indicates how many input channels we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3240" target="_blank">00:54:00.300</a></span> | <span class="t">and how many output channels we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3242" target="_blank">00:54:02.060</a></span> | <span class="t">And the residual block will not change the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3245" target="_blank">00:54:05.100</a></span> | <span class="t">So we define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3247" target="_blank">00:54:07.580</a></span> | <span class="t">So our input image is 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3251" target="_blank">00:54:11.820</a></span> | <span class="t">So batch size 128 height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3257" target="_blank">00:54:17.900</a></span> | <span class="t">And it becomes, it remains the same basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3262" target="_blank">00:54:22.140</a></span> | <span class="t">Oops!</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3262" target="_blank">00:54:22.640</a></span> | <span class="t">Okay, we have another one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3267" target="_blank">00:54:27.580</a></span> | <span class="t">Another residual block with the same transformation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3273" target="_blank">00:54:33.100</a></span> | <span class="t">Then we have another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3275" target="_blank">00:54:35.820</a></span> | <span class="t">And this time the convolution will change the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3278" target="_blank">00:54:38.780</a></span> | <span class="t">And we will see why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3279" target="_blank">00:54:39.660</a></span> | <span class="t">So we have a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3281" target="_blank">00:54:41.740</a></span> | <span class="t">To the 128 to 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3287" target="_blank">00:54:47.100</a></span> | <span class="t">Because the output channels of the last block is 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3291" target="_blank">00:54:51.660</a></span> | <span class="t">So the input channel is 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3293" target="_blank">00:54:53.340</a></span> | <span class="t">The output is 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3294" target="_blank">00:54:54.700</a></span> | <span class="t">The kernel size is 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3297" target="_blank">00:54:57.820</a></span> | <span class="t">The stride is 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3300" target="_blank">00:55:00.140</a></span> | <span class="t">And the padding is 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3302" target="_blank">00:55:02.860</a></span> | <span class="t">This will basically introduce kernel size 3, stride 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3306" target="_blank">00:55:06.700</a></span> | <span class="t">Let's watch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3307" target="_blank">00:55:07.580</a></span> | <span class="t">So imagine the batch size is 6 by 6.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3310" target="_blank">00:55:10.460</a></span> | <span class="t">Kernel size is 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3313" target="_blank">00:55:13.020</a></span> | <span class="t">Stride is 2 without the deletion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3315" target="_blank">00:55:15.020</a></span> | <span class="t">And this is the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3316" target="_blank">00:55:16.940</a></span> | <span class="t">Let me make it bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3320" target="_blank">00:55:20.140</a></span> | <span class="t">Okay, something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3325" target="_blank">00:55:25.020</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3327" target="_blank">00:55:27.040</a></span> | <span class="t">So as you can see, with the stride of 2...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3330" target="_blank">00:55:30.220</a></span> | <span class="t">Need to make it...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3333" target="_blank">00:55:33.340</a></span> | <span class="t">Okay, with the stride of 2 and the kernel size of 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3337" target="_blank">00:55:37.660</a></span> | <span class="t">This is the behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3338" target="_blank">00:55:38.620</a></span> | <span class="t">So we skip every 2 pixels before calculating the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3343" target="_blank">00:55:43.660</a></span> | <span class="t">And this makes the output smaller than the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3346" target="_blank">00:55:46.700</a></span> | <span class="t">Because of this stride.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3348" target="_blank">00:55:48.300</a></span> | <span class="t">And also because of the kernel size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3349" target="_blank">00:55:49.900</a></span> | <span class="t">And we don't have any padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3351" target="_blank">00:55:51.260</a></span> | <span class="t">So this transformation here will have the following shapes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3357" target="_blank">00:55:57.820</a></span> | <span class="t">So we are starting from batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3359" target="_blank">00:55:59.900</a></span> | <span class="t">128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3363" target="_blank">00:56:03.260</a></span> | <span class="t">Height, width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3365" target="_blank">00:56:05.420</a></span> | <span class="t">So the original height and the width of the input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3368" target="_blank">00:56:08.540</a></span> | <span class="t">But this time it will become batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3371" target="_blank">00:56:11.980</a></span> | <span class="t">128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3376" target="_blank">00:56:16.220</a></span> | <span class="t">The height will become half.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3378" target="_blank">00:56:18.540</a></span> | <span class="t">And the width will become half.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3380" target="_blank">00:56:20.780</a></span> | <span class="t">Etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3385" target="_blank">00:56:25.580</a></span> | <span class="t">Then we have two more residual blocks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3388" target="_blank">00:56:28.460</a></span> | <span class="t">With the same...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3390" target="_blank">00:56:30.860</a></span> | <span class="t">Same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3394" target="_blank">00:56:34.540</a></span> | <span class="t">But this time by increasing the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3396" target="_blank">00:56:36.940</a></span> | <span class="t">And also here we don't increase any.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3403" target="_blank">00:56:43.420</a></span> | <span class="t">Here by increasing the feature means that we don't increase the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3408" target="_blank">00:56:48.940</a></span> | <span class="t">Or we reduce the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3410" target="_blank">00:56:50.380</a></span> | <span class="t">We just increase the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3412" target="_blank">00:56:52.620</a></span> | <span class="t">So this one becomes 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3415" target="_blank">00:56:55.500</a></span> | <span class="t">And here we start from...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3423" target="_blank">00:57:03.980</a></span> | <span class="t">Oops 256 and we remain 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3427" target="_blank">00:57:07.260</a></span> | <span class="t">Now you may be confused of why we are doing all of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3430" target="_blank">00:57:10.140</a></span> | <span class="t">Okay the idea is we start with the initial image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3432" target="_blank">00:57:12.460</a></span> | <span class="t">And we keep decreasing the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3435" target="_blank">00:57:15.180</a></span> | <span class="t">So later you will see that the image will become divided by 4, divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3439" target="_blank">00:57:19.180</a></span> | <span class="t">But at the same time we keep increasing the features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3442" target="_blank">00:57:22.220</a></span> | <span class="t">So each pixel represents more information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3445" target="_blank">00:57:25.980</a></span> | <span class="t">But the number of pixels is diminishing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3448" target="_blank">00:57:28.780</a></span> | <span class="t">Is reducing at every step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3453" target="_blank">00:57:33.180</a></span> | <span class="t">So let's go forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3454" target="_blank">00:57:34.700</a></span> | <span class="t">Then we have another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3456" target="_blank">00:57:36.780</a></span> | <span class="t">And this time the size will become divided by 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3461" target="_blank">00:57:41.500</a></span> | <span class="t">And the convolution is...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3463" target="_blank">00:57:43.900</a></span> | <span class="t">Let me copy this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3464" target="_blank">00:57:44.860</a></span> | <span class="t">256 by 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3472" target="_blank">00:57:52.300</a></span> | <span class="t">Because the previous output is 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3474" target="_blank">00:57:54.940</a></span> | <span class="t">The kernel size is 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3476" target="_blank">00:57:56.460</a></span> | <span class="t">The stride is 2 and the padding is 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3478" target="_blank">00:57:58.700</a></span> | <span class="t">So just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3479" target="_blank">00:57:59.740</a></span> | <span class="t">Also in this case the size of the image will become half of what is it now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3484" target="_blank">00:58:04.060</a></span> | <span class="t">So the image is already divided by 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3485" target="_blank">00:58:05.820</a></span> | <span class="t">So it will become divided by 4 now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3487" target="_blank">00:58:07.580</a></span> | <span class="t">Then we have another residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3498" target="_blank">00:58:18.140</a></span> | <span class="t">In which we increase the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3501" target="_blank">00:58:21.420</a></span> | <span class="t">This time from 256 to 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3506" target="_blank">00:58:26.860</a></span> | <span class="t">So we start from 256 and the image is divided by 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3511" target="_blank">00:58:31.340</a></span> | <span class="t">And we go to 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3514" target="_blank">00:58:34.780</a></span> | <span class="t">And the image size doesn't change.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3516" target="_blank">00:58:36.620</a></span> | <span class="t">Then we have another one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3521" target="_blank">00:58:41.180</a></span> | <span class="t">From 512 to 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3525" target="_blank">00:58:45.420</a></span> | <span class="t">In this case...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3528" target="_blank">00:58:48.060</a></span> | <span class="t">Oops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3529" target="_blank">00:58:49.200</a></span> | <span class="t">We will see later what is the residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3532" target="_blank">00:58:52.780</a></span> | <span class="t">But the residual block you have to think of it as just a convolution with a normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3536" target="_blank">00:58:56.940</a></span> | <span class="t">We will see later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3537" target="_blank">00:58:57.820</a></span> | <span class="t">And this one is 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3541" target="_blank">00:59:01.100</a></span> | <span class="t">And that goes into 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3542" target="_blank">00:59:02.860</a></span> | <span class="t">And then we have another convolution that will make it even smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3550" target="_blank">00:59:10.140</a></span> | <span class="t">So let's copy this convolution here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3552" target="_blank">00:59:12.060</a></span> | <span class="t">This one will go from 512 to 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3559" target="_blank">00:59:19.020</a></span> | <span class="t">The same kernel size and the same stride and the same padding as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3563" target="_blank">00:59:23.180</a></span> | <span class="t">So the image will become even smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3565" target="_blank">00:59:25.340</a></span> | <span class="t">So our last dimension was this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3568" target="_blank">00:59:28.540</a></span> | <span class="t">Let me copy it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3569" target="_blank">00:59:29.500</a></span> | <span class="t">So we start with an image that is 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3572" target="_blank">00:59:32.460</a></span> | <span class="t">4 times smaller than the original image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3576" target="_blank">00:59:36.300</a></span> | <span class="t">And with the 4 times smaller width it will become 8 times smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3581" target="_blank">00:59:41.420</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3586" target="_blank">00:59:46.220</a></span> | <span class="t">And then we have residual blocks also here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3589" target="_blank">00:59:49.740</a></span> | <span class="t">We have three of them in this case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3591" target="_blank">00:59:51.180</a></span> | <span class="t">Let me copy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3594" target="_blank">00:59:54.300</a></span> | <span class="t">One, two, three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3599" target="_blank">00:59:59.660</a></span> | <span class="t">I just write the one for the last one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3601" target="_blank">01:00:01.900</a></span> | <span class="t">So anyway the size, the shape changes here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3606" target="_blank">01:00:06.860</a></span> | <span class="t">It doesn't change the shape of the image or the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3611" target="_blank">01:00:11.020</a></span> | <span class="t">So here we are going from divide by 8 and 512 here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3616" target="_blank">01:00:16.460</a></span> | <span class="t">512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3618" target="_blank">01:00:18.460</a></span> | <span class="t">And we go to same dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3624" target="_blank">01:00:24.060</a></span> | <span class="t">512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3624" target="_blank">01:00:24.860</a></span> | <span class="t">Divide by 8 and divide by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3629" target="_blank">01:00:29.020</a></span> | <span class="t">Then we have an attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3631" target="_blank">01:00:31.340</a></span> | <span class="t">And later we will see what is the attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3634" target="_blank">01:00:34.220</a></span> | <span class="t">Basically it will run a self-attention over each pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3638" target="_blank">01:00:38.700</a></span> | <span class="t">So each pixel will become kind of,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3640" target="_blank">01:00:40.780</a></span> | <span class="t">as you remember, the attention is a way to relate tokens to each other in a sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3645" target="_blank">01:00:45.020</a></span> | <span class="t">So if we have an image made of pixels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3648" target="_blank">01:00:48.620</a></span> | <span class="t">the attention can be thought of as a sequence of pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3652" target="_blank">01:00:52.300</a></span> | <span class="t">and the attention as a way to relate the pixel to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3655" target="_blank">01:00:55.180</a></span> | <span class="t">So this is the goal of the attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3657" target="_blank">01:00:57.820</a></span> | <span class="t">And because this way each pixel is related to each other,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3664" target="_blank">01:01:04.620</a></span> | <span class="t">is not independent from each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3666" target="_blank">01:01:06.620</a></span> | <span class="t">Even if the convolution already actually relates close pixels to each other,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3672" target="_blank">01:01:12.380</a></span> | <span class="t">but the attention will be global.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3674" target="_blank">01:01:14.220</a></span> | <span class="t">So even the last pixel can be related to the first pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3677" target="_blank">01:01:17.180</a></span> | <span class="t">This is the goal of the attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3679" target="_blank">01:01:19.020</a></span> | <span class="t">And also in this case we don't reduce the size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3683" target="_blank">01:01:23.020</a></span> | <span class="t">because the attention is, the transformer's attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3686" target="_blank">01:01:26.380</a></span> | <span class="t">is a sequence-to-sequence model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3687" target="_blank">01:01:27.660</a></span> | <span class="t">So we don't reduce the size of the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3690" target="_blank">01:01:30.780</a></span> | <span class="t">And the image remains the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3695" target="_blank">01:01:35.100</a></span> | <span class="t">Finally, we have another residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3696" target="_blank">01:01:36.860</a></span> | <span class="t">Let's...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3700" target="_blank">01:01:40.800</a></span> | <span class="t">Let me copy here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3704" target="_blank">01:01:44.300</a></span> | <span class="t">Also no change in shape or size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3707" target="_blank">01:01:47.740</a></span> | <span class="t">Then we have a normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3709" target="_blank">01:01:49.420</a></span> | <span class="t">And we will see what is this normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3711" target="_blank">01:01:51.660</a></span> | <span class="t">It's the group normalization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3713" target="_blank">01:01:53.420</a></span> | <span class="t">which also doesn't change the size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3715" target="_blank">01:01:55.180</a></span> | <span class="t">Just like any normalization, by the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3718" target="_blank">01:01:58.060</a></span> | <span class="t">With the number of groups being 32</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3723" target="_blank">01:02:03.980</a></span> | <span class="t">and the number of channels being 512,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3726" target="_blank">01:02:06.460</a></span> | <span class="t">because it's the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3727" target="_blank">01:02:07.820</a></span> | <span class="t">Finally, we have an activation function called the CELU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3731" target="_blank">01:02:11.500</a></span> | <span class="t">The CELU is a function...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3733" target="_blank">01:02:13.820</a></span> | <span class="t">Okay, it's derived from the sigmoid linear unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3737" target="_blank">01:02:17.340</a></span> | <span class="t">And it's a function just like the RELU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3740" target="_blank">01:02:20.220</a></span> | <span class="t">There is nothing special.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3741" target="_blank">01:02:21.420</a></span> | <span class="t">They just saw that this one works better for this kind of application.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3745" target="_blank">01:02:25.580</a></span> | <span class="t">But there is no particular reason to choose one over another,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3751" target="_blank">01:02:31.820</a></span> | <span class="t">except that they thought that practically this one works fine for this kind of models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3756" target="_blank">01:02:36.460</a></span> | <span class="t">And if you watch my previous video about LAMA, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3760" target="_blank">01:02:40.860</a></span> | <span class="t">in which we analyzed why they chose the ZWIGLU function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3763" target="_blank">01:02:43.740</a></span> | <span class="t">If you read the paper, at the end of the paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3765" target="_blank">01:02:45.580</a></span> | <span class="t">they say that there is no particular reason they chose the ZWIGLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3768" target="_blank">01:02:48.700</a></span> | <span class="t">They just saw that practically it works better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3770" target="_blank">01:02:50.620</a></span> | <span class="t">I mean, it's very difficult to describe why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3772" target="_blank">01:02:52.460</a></span> | <span class="t">activation function works better than the others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3776" target="_blank">01:02:56.060</a></span> | <span class="t">So this is why they use the CELU here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3777" target="_blank">01:02:57.660</a></span> | <span class="t">because practically it works well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3781" target="_blank">01:03:01.100</a></span> | <span class="t">Now, we have another two convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3783" target="_blank">01:03:03.340</a></span> | <span class="t">And then we are done with the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3785" target="_blank">01:03:05.500</a></span> | <span class="t">Convolution, 512, 8, kernel size, and then padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3796" target="_blank">01:03:16.460</a></span> | <span class="t">This will not change the size of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3802" target="_blank">01:03:22.860</a></span> | <span class="t">Because just like before, we have the kernel size as 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3805" target="_blank">01:03:25.580</a></span> | <span class="t">But we have the padding that compensates for the reduction given by the kernel size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3810" target="_blank">01:03:30.220</a></span> | <span class="t">But we are decreasing the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3812" target="_blank">01:03:32.300</a></span> | <span class="t">And this is the bottleneck of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3816" target="_blank">01:03:36.060</a></span> | <span class="t">And I will show you later on the architecture what is the bottleneck.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3818" target="_blank">01:03:38.780</a></span> | <span class="t">And finally, we have another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3827" target="_blank">01:03:47.260</a></span> | <span class="t">Which is 8 by 8 with kernel size equal to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3835" target="_blank">01:03:55.980</a></span> | <span class="t">And the padding is equal to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3837" target="_blank">01:03:57.980</a></span> | <span class="t">Which also doesn't change the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3842" target="_blank">01:04:02.540</a></span> | <span class="t">Because if you watch here, if you have a kernel size of 1,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3845" target="_blank">01:04:05.740</a></span> | <span class="t">it means that each, without stride,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3848" target="_blank">01:04:08.700</a></span> | <span class="t">each kernel basically is running over each pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3853" target="_blank">01:04:13.020</a></span> | <span class="t">So each output actually captures the information of only one pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3856" target="_blank">01:04:16.620</a></span> | <span class="t">So the output has the same dimension as the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3858" target="_blank">01:04:18.860</a></span> | <span class="t">And this is why here also we don't change the...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3864" target="_blank">01:04:24.460</a></span> | <span class="t">But here we need to change the number of...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3867" target="_blank">01:04:27.500</a></span> | <span class="t">It becomes 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3872" target="_blank">01:04:32.540</a></span> | <span class="t">And here from 8 to 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3877" target="_blank">01:04:37.820</a></span> | <span class="t">And this is the list of modules that will make up our encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3884" target="_blank">01:04:44.540</a></span> | <span class="t">Before building the residual block and the attention block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3889" target="_blank">01:04:49.660</a></span> | <span class="t">so this attention block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3890" target="_blank">01:04:50.860</a></span> | <span class="t">let's write the forward method and then we build the residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3895" target="_blank">01:04:55.020</a></span> | <span class="t">So this is the init.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3897" target="_blank">01:04:57.500</a></span> | <span class="t">Define it like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3900" target="_blank">01:05:00.060</a></span> | <span class="t">Let me review it if it's correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3904" target="_blank">01:05:04.380</a></span> | <span class="t">Okay, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3905" target="_blank">01:05:05.180</a></span> | <span class="t">Now let's define the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3912" target="_blank">01:05:12.700</a></span> | <span class="t">x is the image for which we want to encode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3919" target="_blank">01:05:19.660</a></span> | <span class="t">So it's a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3921" target="_blank">01:05:21.420</a></span> | <span class="t">Torch.tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3923" target="_blank">01:05:23.020</a></span> | <span class="t">And the noise, we need some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3925" target="_blank">01:05:25.740</a></span> | <span class="t">And later I will show you why we need some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3927" target="_blank">01:05:27.740</a></span> | <span class="t">That has the same size as the output of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3931" target="_blank">01:05:31.260</a></span> | <span class="t">This returns a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3935" target="_blank">01:05:35.500</a></span> | <span class="t">Okay, our input x will be of size patch size with some channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3945" target="_blank">01:05:45.820</a></span> | <span class="t">Initially it will be 3 because it's an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3948" target="_blank">01:05:48.860</a></span> | <span class="t">Height and width which will be 512 by 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3952" target="_blank">01:05:52.540</a></span> | <span class="t">And then some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3955" target="_blank">01:05:55.100</a></span> | <span class="t">This noise has the same size as the output of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3959" target="_blank">01:05:59.660</a></span> | <span class="t">And we will see that it's jelly patch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3965" target="_blank">01:06:05.820</a></span> | <span class="t">Then output channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3968" target="_blank">01:06:08.540</a></span> | <span class="t">Height divided by 8 and width divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3976" target="_blank">01:06:16.940</a></span> | <span class="t">Then we just run sequentially all of these modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3981" target="_blank">01:06:21.340</a></span> | <span class="t">And then there is one little thing here that in the convolutions that have the stride,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3995" target="_blank">01:06:35.100</a></span> | <span class="t">we need to apply a special embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=3998" target="_blank">01:06:38.460</a></span> | <span class="t">And I will show you why and how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4006" target="_blank">01:06:46.460</a></span> | <span class="t">So if the module has a stride attribute and it's equal to 2 2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4012" target="_blank">01:06:52.460</a></span> | <span class="t">which basically means this convolution here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4017" target="_blank">01:06:57.180</a></span> | <span class="t">this convolution here and this convolution here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4019" target="_blank">01:06:59.980</a></span> | <span class="t">we don't apply the padding here because the padding here is applied to the top of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4025" target="_blank">01:07:05.180</a></span> | <span class="t">bottom, left and right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4027" target="_blank">01:07:07.180</a></span> | <span class="t">But we want to do an asymmetrical padding so we do it manually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4030" target="_blank">01:07:10.460</a></span> | <span class="t">And this is applied like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4033" target="_blank">01:07:13.420</a></span> | <span class="t">F.padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4034" target="_blank">01:07:14.380</a></span> | <span class="t">Basically this says can you add a layer of pixels on the right side of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4047" target="_blank">01:07:27.740</a></span> | <span class="t">and on the bottom side of the image only?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4050" target="_blank">01:07:30.380</a></span> | <span class="t">Because when you apply the padding, it's padding left, padding right, padding top,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4060" target="_blank">01:07:40.940</a></span> | <span class="t">padding bottom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4062" target="_blank">01:07:42.220</a></span> | <span class="t">This means add a layer of pixels in the right side of the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4067" target="_blank">01:07:47.340</a></span> | <span class="t">and on the top side of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4068" target="_blank">01:07:48.860</a></span> | <span class="t">And this is asymmetrical padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4074" target="_blank">01:07:54.380</a></span> | <span class="t">And then if we apply it only for these convolutions that have the stride equal to 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4080" target="_blank">01:08:00.140</a></span> | <span class="t">And then x is equal to module of x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4085" target="_blank">01:08:05.660</a></span> | <span class="t">OK, now you may be wondering why are we building this kind of structure?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4090" target="_blank">01:08:10.060</a></span> | <span class="t">Why it's made like this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4091" target="_blank">01:08:11.500</a></span> | <span class="t">OK, usually in deep learning communities, especially during research,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4096" target="_blank">01:08:16.620</a></span> | <span class="t">we don't reinvent the wheel every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4098" target="_blank">01:08:18.460</a></span> | <span class="t">So the people who made the stable diffusion, but also the people before them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4103" target="_blank">01:08:23.180</a></span> | <span class="t">every time we want to use a model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4105" target="_blank">01:08:25.100</a></span> | <span class="t">we check what models similar to the one we want to build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4109" target="_blank">01:08:29.260</a></span> | <span class="t">are already out there and they are working fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4112" target="_blank">01:08:32.140</a></span> | <span class="t">So very probably the people who built stable diffusion,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4115" target="_blank">01:08:35.900</a></span> | <span class="t">they saw that a model like this is working very well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4119" target="_blank">01:08:39.100</a></span> | <span class="t">for some previous project as a variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4122" target="_blank">01:08:42.700</a></span> | <span class="t">They just modified it a little bit and kept it like it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4126" target="_blank">01:08:46.780</a></span> | <span class="t">So for most choices, actually, there is no reason.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4129" target="_blank">01:08:49.740</a></span> | <span class="t">There is a historical reason, because it worked well in practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4133" target="_blank">01:08:53.340</a></span> | <span class="t">And we know that convolutions work well in practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4137" target="_blank">01:08:57.420</a></span> | <span class="t">for image segmentation, for example, or anything related to computer vision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4141" target="_blank">01:09:01.340</a></span> | <span class="t">And this is why they made the model like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4144" target="_blank">01:09:04.940</a></span> | <span class="t">So most encoders actually work like this, that we reduce the size of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4149" target="_blank">01:09:09.500</a></span> | <span class="t">but each we keep increasing the features of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4152" target="_blank">01:09:12.860</a></span> | <span class="t">the channels, the number of channels of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4154" target="_blank">01:09:14.940</a></span> | <span class="t">So the number of pixels becomes smaller,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4158" target="_blank">01:09:18.620</a></span> | <span class="t">but each pixel is represented by more than three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4162" target="_blank">01:09:22.460</a></span> | <span class="t">So more channels at every step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4163" target="_blank">01:09:23.980</a></span> | <span class="t">Now, what we do is here we are running our image into sequentially,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4170" target="_blank">01:09:30.940</a></span> | <span class="t">in one by one, through all of these modules here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4177" target="_blank">01:09:37.900</a></span> | <span class="t">So first through this convolution, then through this residual block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4181" target="_blank">01:09:41.020</a></span> | <span class="t">which is also some convolutions, then this residual block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4184" target="_blank">01:09:44.860</a></span> | <span class="t">then again convolution, convolution, convolution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4186" target="_blank">01:09:46.940</a></span> | <span class="t">until we run it through this attention block and et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4190" target="_blank">01:09:50.460</a></span> | <span class="t">This will transform the image into something smaller,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4195" target="_blank">01:09:55.260</a></span> | <span class="t">so a compressed version of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4197" target="_blank">01:09:57.500</a></span> | <span class="t">But as I showed you before, this is not an autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4200" target="_blank">01:10:00.540</a></span> | <span class="t">This is a variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4202" target="_blank">01:10:02.940</a></span> | <span class="t">So the variational autoencoder, let me show you again the picture here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4209" target="_blank">01:10:09.180</a></span> | <span class="t">We are not learning how to compress data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4211" target="_blank">01:10:11.500</a></span> | <span class="t">We are learning a latent space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4213" target="_blank">01:10:13.260</a></span> | <span class="t">And this latent space are the parameters of a multivariate Gaussian distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4219" target="_blank">01:10:19.340</a></span> | <span class="t">So actually, the variational autoencoder is trained to learn the mu and the sigma,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4225" target="_blank">01:10:25.260</a></span> | <span class="t">so the mean and the variance of this distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4230" target="_blank">01:10:30.460</a></span> | <span class="t">And this is actually what we will get from the output of this variational autoencoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4235" target="_blank">01:10:35.900</a></span> | <span class="t">not directly the compressed image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4239" target="_blank">01:10:39.020</a></span> | <span class="t">And if this is not clear, guys,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4242" target="_blank">01:10:42.140</a></span> | <span class="t">I made a previous video about the variational autoencoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4245" target="_blank">01:10:45.100</a></span> | <span class="t">in which I show you also why the history of why we do it like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4248" target="_blank">01:10:48.460</a></span> | <span class="t">all the reparameterization trick, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4251" target="_blank">01:10:51.820</a></span> | <span class="t">But for now, just remember that this is not just a compressed version of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4256" target="_blank">01:10:56.700</a></span> | <span class="t">it's actually a distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4258" target="_blank">01:10:58.300</a></span> | <span class="t">And then we can sample from this distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4261" target="_blank">01:11:01.100</a></span> | <span class="t">And I will show you how.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4262" target="_blank">01:11:02.380</a></span> | <span class="t">So the output of the variational autoencoder is actually the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4268" target="_blank">01:11:08.220</a></span> | <span class="t">And actually, it's actually not the variance, but the log variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4271" target="_blank">01:11:11.420</a></span> | <span class="t">So the mean and the log variance is equal to torch.chunk(x2, dimension equal 1).</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4282" target="_blank">01:11:22.380</a></span> | <span class="t">We will see also what is the chunk function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4285" target="_blank">01:11:25.580</a></span> | <span class="t">So I will show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4287" target="_blank">01:11:27.500</a></span> | <span class="t">So this basically converts batch size, 8 channels, height,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4292" target="_blank">01:11:32.700</a></span> | <span class="t">height divided by 8, width divided by 8,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4296" target="_blank">01:11:36.940</a></span> | <span class="t">which is the output of the last layer of this encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4300" target="_blank">01:11:40.140</a></span> | <span class="t">So this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4301" target="_blank">01:11:41.100</a></span> | <span class="t">And we divide it into two tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4304" target="_blank">01:11:44.380</a></span> | <span class="t">So this chunk basically means divide it into two tensors along this dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4309" target="_blank">01:11:49.500</a></span> | <span class="t">So along this dimension, it will become two tensors of size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4312" target="_blank">01:11:52.860</a></span> | <span class="t">along this dimension of size 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4315" target="_blank">01:11:55.980</a></span> | <span class="t">So two tensors of shape, batch size 4, then height divided by 8, and width divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4332" target="_blank">01:12:12.540</a></span> | <span class="t">And this basically, the output of this actually represents the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4341" target="_blank">01:12:21.660</a></span> | <span class="t">And what we do, we don't want the log variance, we want the variance actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4347" target="_blank">01:12:27.340</a></span> | <span class="t">So to transform the log variance into variance, we do the exponentiation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4352" target="_blank">01:12:32.540</a></span> | <span class="t">So the first thing actually we also need to do is to clamp this variance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4357" target="_blank">01:12:37.100</a></span> | <span class="t">because otherwise it will become very small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4359" target="_blank">01:12:39.100</a></span> | <span class="t">So clamping means that if the variance is too small or too big,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4362" target="_blank">01:12:42.460</a></span> | <span class="t">we want it to become within some ranges that are acceptable for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4367" target="_blank">01:12:47.820</a></span> | <span class="t">So this clamping function, log variance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4370" target="_blank">01:12:50.700</a></span> | <span class="t">tells the PyTorch that if the value is too small or too big, make it within this range.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4375" target="_blank">01:12:55.900</a></span> | <span class="t">And this doesn't change the shape of the tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4381" target="_blank">01:13:01.020</a></span> | <span class="t">So this still remains this tensor here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4384" target="_blank">01:13:04.300</a></span> | <span class="t">And then we transform the log variance into variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4389" target="_blank">01:13:09.660</a></span> | <span class="t">So the variance is equal to the log variance dot exp,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4393" target="_blank">01:13:13.820</a></span> | <span class="t">which means make the exponential of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4396" target="_blank">01:13:16.140</a></span> | <span class="t">So you delete the log and it becomes the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4398" target="_blank">01:13:18.620</a></span> | <span class="t">And this also doesn't change the size of the shape of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4405" target="_blank">01:13:25.100</a></span> | <span class="t">And then to calculate the standard deviation from the variance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4408" target="_blank">01:13:28.140</a></span> | <span class="t">as you know, the standard deviation is the square root of the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4411" target="_blank">01:13:31.180</a></span> | <span class="t">So standard deviation is the variance dot sqrt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4420" target="_blank">01:13:40.300</a></span> | <span class="t">And also this doesn't change the size of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4424" target="_blank">01:13:44.540</a></span> | <span class="t">OK, now what we want, as I told you before, this is a latent space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4431" target="_blank">01:13:51.500</a></span> | <span class="t">It's a multivariate Gaussian, which has its own mean and its own variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4436" target="_blank">01:13:56.060</a></span> | <span class="t">And we know the mean and the variance, this mean and this variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4439" target="_blank">01:13:59.500</a></span> | <span class="t">How do we convert? How do we sample from it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4443" target="_blank">01:14:03.740</a></span> | <span class="t">Well, what we can sample from is, basically, we can sample from n_01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4449" target="_blank">01:14:09.420</a></span> | <span class="t">This is, if we have a sample from n_01,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4452" target="_blank">01:14:12.620</a></span> | <span class="t">how do we convert it into a sample of a given mean and the given variance?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4459" target="_blank">01:14:19.100</a></span> | <span class="t">This, as if you remember from probability and statistics,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4463" target="_blank">01:14:23.260</a></span> | <span class="t">if you have a sample from n_01,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4465" target="_blank">01:14:25.340</a></span> | <span class="t">you can convert it into any other sample of a Gaussian</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4468" target="_blank">01:14:28.860</a></span> | <span class="t">with a given mean and a variance through this transformation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4472" target="_blank">01:14:32.140</a></span> | <span class="t">So if z, let's call it this one, z is equal to n_01,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4477" target="_blank">01:14:37.180</a></span> | <span class="t">we can transform into another n, let's call it x,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4480" target="_blank">01:14:40.940</a></span> | <span class="t">through this transformation x is equal to z.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4483" target="_blank">01:14:43.820</a></span> | <span class="t">Well, the mean of the new distribution plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4489" target="_blank">01:14:49.980</a></span> | <span class="t">the standard deviation of the new distribution multiplied by z.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4494" target="_blank">01:14:54.780</a></span> | <span class="t">This is the transformation, this is the formula from probability and statistics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4498" target="_blank">01:14:58.860</a></span> | <span class="t">Basically means transform this distribution into this one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4501" target="_blank">01:15:01.420</a></span> | <span class="t">that has this mean and this variance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4503" target="_blank">01:15:03.020</a></span> | <span class="t">which basically means sample from this distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4505" target="_blank">01:15:05.980</a></span> | <span class="t">This is why we are given also the noise as input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4509" target="_blank">01:15:09.100</a></span> | <span class="t">because the noise we want it to come from with a particular seed of the noise generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4514" target="_blank">01:15:14.700</a></span> | <span class="t">So we ask is as input and we sample from this distribution like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4519" target="_blank">01:15:19.180</a></span> | <span class="t">x is equal to mean plus standard deviation multiplied by noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4525" target="_blank">01:15:25.180</a></span> | <span class="t">Finally, there is also another step that we need to scale the output by a constant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4534" target="_blank">01:15:34.460</a></span> | <span class="t">This constant, I found it in the original repository.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4537" target="_blank">01:15:37.740</a></span> | <span class="t">So I'm just writing it here without any explanation on why,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4541" target="_blank">01:15:41.180</a></span> | <span class="t">because I actually, I also don't know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4543" target="_blank">01:15:43.260</a></span> | <span class="t">It's just a scaling constant that they use at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4546" target="_blank">01:15:46.460</a></span> | <span class="t">I don't know if it's there for historical reason,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4549" target="_blank">01:15:49.020</a></span> | <span class="t">because they use some previous model that had this constant,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4551" target="_blank">01:15:51.260</a></span> | <span class="t">or they introduced it for some particular reason.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4554" target="_blank">01:15:54.060</a></span> | <span class="t">But it's a constant that I saw it in the original repository.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4557" target="_blank">01:15:57.100</a></span> | <span class="t">And actually, if you check the original parameters of the stable diffusion model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4561" target="_blank">01:16:01.420</a></span> | <span class="t">there is also this constant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4562" target="_blank">01:16:02.460</a></span> | <span class="t">So I am also scaling the output by this constant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4565" target="_blank">01:16:05.020</a></span> | <span class="t">And then we return x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4568" target="_blank">01:16:08.140</a></span> | <span class="t">So now what we built so far,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4570" target="_blank">01:16:10.620</a></span> | <span class="t">except that we didn't build the residual block and the attention block here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4574" target="_blank">01:16:14.940</a></span> | <span class="t">we built the encoder part of the variational autoencoder and also the sampling part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4580" target="_blank">01:16:20.140</a></span> | <span class="t">So we take the image, we run it through the encoder, it becomes very small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4584" target="_blank">01:16:24.140</a></span> | <span class="t">It will tell us the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4586" target="_blank">01:16:26.940</a></span> | <span class="t">And then we sample from that distribution given the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4591" target="_blank">01:16:31.340</a></span> | <span class="t">Now we need to build the decoder along with the residual block and the attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4596" target="_blank">01:16:36.700</a></span> | <span class="t">And what we will see is that in the decoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4598" target="_blank">01:16:38.780</a></span> | <span class="t">we do the opposite of what we did in the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4602" target="_blank">01:16:42.220</a></span> | <span class="t">So we will reduce the number of channels and at the same time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4606" target="_blank">01:16:46.700</a></span> | <span class="t">we will increase the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4608" target="_blank">01:16:48.620</a></span> | <span class="t">So let's go to the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4612" target="_blank">01:16:52.620</a></span> | <span class="t">Let me review if everything is fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4615" target="_blank">01:16:55.820</a></span> | <span class="t">Looks like it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4620" target="_blank">01:17:00.380</a></span> | <span class="t">So let's go to the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4621" target="_blank">01:17:01.820</a></span> | <span class="t">Again, import torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4628" target="_blank">01:17:08.220</a></span> | <span class="t">We also need to define the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4649" target="_blank">01:17:29.260</a></span> | <span class="t">We need to define the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4650" target="_blank">01:17:30.860</a></span> | <span class="t">Later we define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4651" target="_blank">01:17:31.820</a></span> | <span class="t">Let's define first the residual block, the one we defined before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4659" target="_blank">01:17:39.900</a></span> | <span class="t">so that you understand what is this residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4662" target="_blank">01:17:42.860</a></span> | <span class="t">And then we define the attention block that we defined before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4668" target="_blank">01:17:48.220</a></span> | <span class="t">And finally, we build the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4670" target="_blank">01:17:50.860</a></span> | <span class="t">So...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4680" target="_blank">01:18:00.860</a></span> | <span class="t">Okay, this is made up of normalization and convolutions, like I said before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4689" target="_blank">01:18:09.420</a></span> | <span class="t">There is a two normalization, which is the group norm one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4694" target="_blank">01:18:14.860</a></span> | <span class="t">So...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4704" target="_blank">01:18:24.860</a></span> | <span class="t">And then there is another group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4720" target="_blank">01:18:40.860</a></span> | <span class="t">With remote channels to out channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4738" target="_blank">01:18:58.860</a></span> | <span class="t">And then we have a skip connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4745" target="_blank">01:19:05.900</a></span> | <span class="t">Skip connection basically means that you take the input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4749" target="_blank">01:19:09.660</a></span> | <span class="t">you skip some layers, and then you connect it there with the output of the last layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4753" target="_blank">01:19:13.580</a></span> | <span class="t">And we also need this residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4757" target="_blank">01:19:17.820</a></span> | <span class="t">If the two channels are different, we need to create another intermediate layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4761" target="_blank">01:19:21.740</a></span> | <span class="t">Now I create it, later I explain it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4774" target="_blank">01:19:34.860</a></span> | <span class="t">Okay, let's create the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4791" target="_blank">01:19:51.100</a></span> | <span class="t">Which is a torch.tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4802" target="_blank">01:20:02.620</a></span> | <span class="t">And returns a torch.tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4805" target="_blank">01:20:05.260</a></span> | <span class="t">Okay, the input of this residual layer, as you saw before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4810" target="_blank">01:20:10.780</a></span> | <span class="t">is something that has a batch with some channels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4815" target="_blank">01:20:15.020</a></span> | <span class="t">and then height and width, which can be different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4818" target="_blank">01:20:18.380</a></span> | <span class="t">It's not always the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4819" target="_blank">01:20:19.500</a></span> | <span class="t">Sometimes it's 512 by 512, sometimes it's half of that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4823" target="_blank">01:20:23.420</a></span> | <span class="t">sometimes it's one fourth of that, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4825" target="_blank">01:20:25.980</a></span> | <span class="t">So suppose it's x is batch size in channels height width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4836" target="_blank">01:20:36.220</a></span> | <span class="t">What we do is we create the skip connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4839" target="_blank">01:20:39.740</a></span> | <span class="t">So we save the initial input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4841" target="_blank">01:20:41.420</a></span> | <span class="t">We call it the residual or residue is equal to x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4845" target="_blank">01:20:45.500</a></span> | <span class="t">We apply the normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4848" target="_blank">01:20:48.060</a></span> | <span class="t">The first one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4853" target="_blank">01:20:53.660</a></span> | <span class="t">And this doesn't change the shape of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4856" target="_blank">01:20:56.940</a></span> | <span class="t">The normalization doesn't change.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4859" target="_blank">01:20:59.340</a></span> | <span class="t">Then we apply the silo function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4860" target="_blank">01:21:00.780</a></span> | <span class="t">And this also doesn't change the size of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4867" target="_blank">01:21:07.820</a></span> | <span class="t">Then we apply the first convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4870" target="_blank">01:21:10.300</a></span> | <span class="t">This also doesn't change the size of the tensor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4878" target="_blank">01:21:18.220</a></span> | <span class="t">because as you can see here, we have kernel size 3, yes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4881" target="_blank">01:21:21.260</a></span> | <span class="t">but with the padding of 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4882" target="_blank">01:21:22.860</a></span> | <span class="t">With the padding of 1, actually, it will not change the size of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4886" target="_blank">01:21:26.540</a></span> | <span class="t">So it will still remain this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4888" target="_blank">01:21:28.140</a></span> | <span class="t">Then we apply again the group normalization 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4892" target="_blank">01:21:32.540</a></span> | <span class="t">This again doesn't change the size of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4898" target="_blank">01:21:38.060</a></span> | <span class="t">Then we apply the silo again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4900" target="_blank">01:21:40.540</a></span> | <span class="t">Then we apply the convolution number 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4906" target="_blank">01:21:46.700</a></span> | <span class="t">And finally, we apply the residual connection,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4914" target="_blank">01:21:54.060</a></span> | <span class="t">which basically means that we take x plus the residual.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4918" target="_blank">01:21:58.940</a></span> | <span class="t">But if the number of output channels is not equal to the input channels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4925" target="_blank">01:22:05.740</a></span> | <span class="t">you cannot add this one with this one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4927" target="_blank">01:22:07.420</a></span> | <span class="t">because this dimension will not match between the two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4929" target="_blank">01:22:09.740</a></span> | <span class="t">So what we do, we create this layer here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4933" target="_blank">01:22:13.660</a></span> | <span class="t">to convert the input channels to the output channels of x,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4937" target="_blank">01:22:17.420</a></span> | <span class="t">such that this sum can be done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4939" target="_blank">01:22:19.180</a></span> | <span class="t">So what we do is, we apply this residual layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4942" target="_blank">01:22:22.380</a></span> | <span class="t">Residual layer of residual, like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4947" target="_blank">01:22:27.100</a></span> | <span class="t">And this is our residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4949" target="_blank">01:22:29.660</a></span> | <span class="t">So as I told you, it's just a bunch of convolutions and group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4953" target="_blank">01:22:33.580</a></span> | <span class="t">And for those who are familiar with the computer vision models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4956" target="_blank">01:22:36.140</a></span> | <span class="t">especially in ResNet, we use a lot of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4958" target="_blank">01:22:38.220</a></span> | <span class="t">It's a very common block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4963" target="_blank">01:22:43.180</a></span> | <span class="t">Let's go build the attention block that we used also before in the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4967" target="_blank">01:22:47.340</a></span> | <span class="t">This one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4969" target="_blank">01:22:49.100</a></span> | <span class="t">And to define the attention, we also need to define the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4973" target="_blank">01:22:53.500</a></span> | <span class="t">So let's first build the attention block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4975" target="_blank">01:22:55.660</a></span> | <span class="t">which is used in the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4977" target="_blank">01:22:57.340</a></span> | <span class="t">And then we define what is this self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=4991" target="_blank">01:23:11.500</a></span> | <span class="t">So it has a group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5008" target="_blank">01:23:28.140</a></span> | <span class="t">Again, the channel is always 32 here in stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5014" target="_blank">01:23:34.060</a></span> | <span class="t">But you also may be wondering, what is group normalization, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5017" target="_blank">01:23:37.420</a></span> | <span class="t">So let's go to review it, actually, since we are here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5020" target="_blank">01:23:40.780</a></span> | <span class="t">And, okay, if you remember from my previous slides on Lama,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5027" target="_blank">01:23:47.500</a></span> | <span class="t">let's go here, where we use a layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5032" target="_blank">01:23:52.620</a></span> | <span class="t">And also in the vanilla transformer, actually, we use layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5038" target="_blank">01:23:58.140</a></span> | <span class="t">So first of all, what is normalization?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5040" target="_blank">01:24:00.220</a></span> | <span class="t">Normalization is basically when we have a deep neural network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5043" target="_blank">01:24:03.660</a></span> | <span class="t">each layer of the network produces some output that is fed to the next layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5048" target="_blank">01:24:08.700</a></span> | <span class="t">Now, what happens is that if the output of a layer is varying in distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5054" target="_blank">01:24:14.700</a></span> | <span class="t">so sometimes, for example, the output of a layer is between 0 and 1,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5058" target="_blank">01:24:18.380</a></span> | <span class="t">but the next step, maybe it's between 3 and 5,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5062" target="_blank">01:24:22.140</a></span> | <span class="t">and the next step, maybe it's between 10 and 15, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5065" target="_blank">01:24:25.740</a></span> | <span class="t">So the distribution of the output of a layer changes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5069" target="_blank">01:24:29.180</a></span> | <span class="t">then the next layer also will see some input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5072" target="_blank">01:24:32.060</a></span> | <span class="t">that is very different from what the layer is used to see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5076" target="_blank">01:24:36.860</a></span> | <span class="t">This will basically push the output of the next layer into a new distribution itself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5082" target="_blank">01:24:42.620</a></span> | <span class="t">which, in turn, will push the loss function into,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5085" target="_blank">01:24:45.900</a></span> | <span class="t">basically, the output of the model to change very frequently in distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5093" target="_blank">01:24:53.740</a></span> | <span class="t">So sometimes it will be a very big number,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5095" target="_blank">01:24:55.500</a></span> | <span class="t">sometimes it will be a very small number,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5096" target="_blank">01:24:56.940</a></span> | <span class="t">sometimes it will be negative, sometimes it will be positive, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5099" target="_blank">01:24:59.740</a></span> | <span class="t">And this basically makes the loss function oscillate too much,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5104" target="_blank">01:25:04.060</a></span> | <span class="t">and it makes the training slower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5105" target="_blank">01:25:05.980</a></span> | <span class="t">So what we do is we normalize the values before feeding them into layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5109" target="_blank">01:25:09.740</a></span> | <span class="t">such that each layer always sees the same distribution of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5113" target="_blank">01:25:13.820</a></span> | <span class="t">So it will always see numbers that are distributed around 0 with a variance of 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5119" target="_blank">01:25:19.260</a></span> | <span class="t">And this is the job of the layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5121" target="_blank">01:25:21.580</a></span> | <span class="t">So imagine you are a layer, and you have some input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5125" target="_blank">01:25:25.180</a></span> | <span class="t">which is a batch of 10 items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5127" target="_blank">01:25:27.260</a></span> | <span class="t">Each item has some features, so feature 1, feature 2, feature 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5131" target="_blank">01:25:31.180</a></span> | <span class="t">Layer normalization calculates a mean and the variance over these features here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5136" target="_blank">01:25:36.380</a></span> | <span class="t">so over this distribution here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5138" target="_blank">01:25:38.380</a></span> | <span class="t">and then normalizes this value according to this formula.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5142" target="_blank">01:25:42.140</a></span> | <span class="t">So each value basically becomes distributed between 0 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5146" target="_blank">01:25:46.460</a></span> | <span class="t">With batch normalization, we normalize by columns,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5150" target="_blank">01:25:50.700</a></span> | <span class="t">so the statistics mean and the sigma is calculated by columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5154" target="_blank">01:25:54.380</a></span> | <span class="t">With layer normalization, it is calculated by rows,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5157" target="_blank">01:25:57.420</a></span> | <span class="t">so each item independently from the others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5160" target="_blank">01:26:00.620</a></span> | <span class="t">With group normalization, on the other hand,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5163" target="_blank">01:26:03.100</a></span> | <span class="t">it is like layer normalization, but not all of the features of the item, but grouped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5170" target="_blank">01:26:10.860</a></span> | <span class="t">So for example, imagine you have four features here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5173" target="_blank">01:26:13.500</a></span> | <span class="t">So here you have F1, F2, F3, F4, and you have two groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5178" target="_blank">01:26:18.620</a></span> | <span class="t">Then the first group will be F1 and F2, and the second group will be F3 and F4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5183" target="_blank">01:26:23.740</a></span> | <span class="t">So you will have two means and two variance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5186" target="_blank">01:26:26.860</a></span> | <span class="t">one for the first group, one for the second group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5189" target="_blank">01:26:29.900</a></span> | <span class="t">But why do we use it like this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5192" target="_blank">01:26:32.540</a></span> | <span class="t">Why do we want to group this kind of features?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5195" target="_blank">01:26:35.740</a></span> | <span class="t">Because these features actually, they come from convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5199" target="_blank">01:26:39.180</a></span> | <span class="t">And as we saw before, let's go back to the website.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5202" target="_blank">01:26:42.460</a></span> | <span class="t">Imagine you have a kernel of five here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5205" target="_blank">01:26:45.740</a></span> | <span class="t">Each output here actually comes from local area of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5211" target="_blank">01:26:51.900</a></span> | <span class="t">So the two close features, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5215" target="_blank">01:26:55.260</a></span> | <span class="t">two things that are close to each other, may be related to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5219" target="_blank">01:26:59.340</a></span> | <span class="t">So two things that are far from each other are not related to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5222" target="_blank">01:27:02.540</a></span> | <span class="t">This is why we can group, we can use group normalization in this case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5227" target="_blank">01:27:07.260</a></span> | <span class="t">Because closer features to each other will have kind of the same distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5232" target="_blank">01:27:12.860</a></span> | <span class="t">or we make them have the same distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5235" target="_blank">01:27:15.020</a></span> | <span class="t">and things that are far from each other may not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5237" target="_blank">01:27:17.580</a></span> | <span class="t">This is the basic idea behind group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5240" target="_blank">01:27:20.300</a></span> | <span class="t">But the whole idea behind the normalization is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5242" target="_blank">01:27:22.700</a></span> | <span class="t">we don't want these things to oscillate too much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5245" target="_blank">01:27:25.260</a></span> | <span class="t">Otherwise, the loss of function will oscillate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5247" target="_blank">01:27:27.420</a></span> | <span class="t">and will make the training slower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5248" target="_blank">01:27:28.860</a></span> | <span class="t">With normalization, we make the training faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5250" target="_blank">01:27:30.940</a></span> | <span class="t">So let's go back to coding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5253" target="_blank">01:27:33.100</a></span> | <span class="t">So we were coding the attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5256" target="_blank">01:27:36.300</a></span> | <span class="t">So now the attention block has this group normalization and also an attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5260" target="_blank">01:27:40.540</a></span> | <span class="t">which is a self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5263" target="_blank">01:27:43.020</a></span> | <span class="t">And later we define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5264" target="_blank">01:27:44.140</a></span> | <span class="t">And channels, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5268" target="_blank">01:27:48.140</a></span> | <span class="t">This one have a forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5274" target="_blank">01:27:54.300</a></span> | <span class="t">Torch.tensor, returns, of course, torch.tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5279" target="_blank">01:27:59.020</a></span> | <span class="t">Okay, what is the input of this block?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5282" target="_blank">01:28:02.060</a></span> | <span class="t">The input of this block is something, where is it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5286" target="_blank">01:28:06.700</a></span> | <span class="t">Here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5287" target="_blank">01:28:07.500</a></span> | <span class="t">It's something in the form of batch size, number of channels, height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5291" target="_blank">01:28:11.980</a></span> | <span class="t">But because it will be used in many positions, this attention block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5295" target="_blank">01:28:15.180</a></span> | <span class="t">we don't define a specific size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5297" target="_blank">01:28:17.500</a></span> | <span class="t">So we just say that x is something that is a batch size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5301" target="_blank">01:28:21.900</a></span> | <span class="t">features or channels, if you want, height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5305" target="_blank">01:28:25.900</a></span> | <span class="t">Again, we create a residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5308" target="_blank">01:28:28.940</a></span> | <span class="t">And the first thing we do is we extract the shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5314" target="_blank">01:28:34.860</a></span> | <span class="t">So n is the batch size, the number of channels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5318" target="_blank">01:28:38.220</a></span> | <span class="t">the height and the width is equal to x.shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5321" target="_blank">01:28:41.420</a></span> | <span class="t">Then, as I told you before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5325" target="_blank">01:28:45.340</a></span> | <span class="t">we do the self-attention between all the pixels of this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5329" target="_blank">01:28:49.580</a></span> | <span class="t">And I will show you how.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5330" target="_blank">01:28:50.700</a></span> | <span class="t">This will transform this tensor here into this tensor here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5343" target="_blank">01:29:03.660</a></span> | <span class="t">Height multiplied by width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5346" target="_blank">01:29:06.620</a></span> | <span class="t">So now we have a sequence where each item represents a pixel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5351" target="_blank">01:29:11.340</a></span> | <span class="t">because we multiplied height by width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5353" target="_blank">01:29:13.260</a></span> | <span class="t">And then we transpose it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5355" target="_blank">01:29:15.180</a></span> | <span class="t">So put it back a little before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5358" target="_blank">01:29:18.220</a></span> | <span class="t">Transpose the -1 with -2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5360" target="_blank">01:29:20.620</a></span> | <span class="t">This will transform this shape into this shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5366" target="_blank">01:29:26.940</a></span> | <span class="t">So we put back this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5371" target="_blank">01:29:31.180</a></span> | <span class="t">So this one comes before and features becomes the last one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5374" target="_blank">01:29:34.700</a></span> | <span class="t">Something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5377" target="_blank">01:29:37.420</a></span> | <span class="t">And okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5380" target="_blank">01:29:40.140</a></span> | <span class="t">So as you can see from this tensor here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5383" target="_blank">01:29:43.660</a></span> | <span class="t">this is like when we do the attention in the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5387" target="_blank">01:29:47.500</a></span> | <span class="t">So in the transformer model, we have a sequence of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5390" target="_blank">01:29:50.220</a></span> | <span class="t">Each token is representing, for example, a word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5392" target="_blank">01:29:52.700</a></span> | <span class="t">And the attention basically calculates the attention between each token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5397" target="_blank">01:29:57.180</a></span> | <span class="t">So how do two tokens are related to each other?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5400" target="_blank">01:30:00.220</a></span> | <span class="t">In this case, we can think of it as a sequence of pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5403" target="_blank">01:30:03.420</a></span> | <span class="t">Each pixel with its own embedding, which is the features of that pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5407" target="_blank">01:30:07.820</a></span> | <span class="t">And we relate pixels to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5410" target="_blank">01:30:10.060</a></span> | <span class="t">And then we do the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5412" target="_blank">01:30:12.780</a></span> | <span class="t">Which is a self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5417" target="_blank">01:30:17.260</a></span> | <span class="t">In which self-attention means that the query key and values are the same input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5420" target="_blank">01:30:20.940</a></span> | <span class="t">And this doesn't change the shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5425" target="_blank">01:30:25.500</a></span> | <span class="t">So this one remains the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5428" target="_blank">01:30:28.540</a></span> | <span class="t">Then we transpose back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5430" target="_blank">01:30:30.620</a></span> | <span class="t">And we do the inverse transformation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5436" target="_blank">01:30:36.060</a></span> | <span class="t">So because we put it in this form only to do attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5439" target="_blank">01:30:39.260</a></span> | <span class="t">So now we transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5440" target="_blank">01:30:40.940</a></span> | <span class="t">So we take this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5446" target="_blank">01:30:46.140</a></span> | <span class="t">And we convert it into features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5448" target="_blank">01:30:48.860</a></span> | <span class="t">And then height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5451" target="_blank">01:30:51.900</a></span> | <span class="t">And then again, we remove this multiplication by viewing again the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5457" target="_blank">01:30:57.500</a></span> | <span class="t">So n, c, h, w.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5461" target="_blank">01:31:01.420</a></span> | <span class="t">So we go from here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5465" target="_blank">01:31:05.980</a></span> | <span class="t">To here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5471" target="_blank">01:31:11.020</a></span> | <span class="t">Then we add the residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5475" target="_blank">01:31:15.580</a></span> | <span class="t">And we return x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5476" target="_blank">01:31:16.460</a></span> | <span class="t">That's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5477" target="_blank">01:31:17.660</a></span> | <span class="t">The residual connection will not change the size of the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5482" target="_blank">01:31:22.380</a></span> | <span class="t">And we return a tensor of this shape here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5485" target="_blank">01:31:25.900</a></span> | <span class="t">Let me check also the residual connection here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5487" target="_blank">01:31:27.660</a></span> | <span class="t">It's correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5488" target="_blank">01:31:28.460</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5489" target="_blank">01:31:29.260</a></span> | <span class="t">Now that we have also built the attention block, let's build also the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5492" target="_blank">01:31:32.700</a></span> | <span class="t">Since we are building the attentions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5495" target="_blank">01:31:35.180</a></span> | <span class="t">And the attentions, because we have two kinds of attention in the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5499" target="_blank">01:31:39.820</a></span> | <span class="t">One is called the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5501" target="_blank">01:31:41.820</a></span> | <span class="t">And one is the cross-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5503" target="_blank">01:31:43.820</a></span> | <span class="t">And we need to build both.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5504" target="_blank">01:31:44.940</a></span> | <span class="t">So let's go build it in a separate class called "Attention".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5508" target="_blank">01:31:48.300</a></span> | <span class="t">And okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5515" target="_blank">01:31:55.100</a></span> | <span class="t">So again, import torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5528" target="_blank">01:32:08.940</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5538" target="_blank">01:32:18.940</a></span> | <span class="t">I think you guys maybe want to review the attention before building it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5547" target="_blank">01:32:27.580</a></span> | <span class="t">So let's go review it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5548" target="_blank">01:32:28.860</a></span> | <span class="t">I have here opened my slides from my video about the attention model for the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5555" target="_blank">01:32:35.740</a></span> | <span class="t">So the self-attention, basically, it's a way for, especially in a language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5562" target="_blank">01:32:42.140</a></span> | <span class="t">is a way for us to relate tokens to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5565" target="_blank">01:32:45.180</a></span> | <span class="t">So we start with a sequence of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5567" target="_blank">01:32:47.420</a></span> | <span class="t">Each one of them having an embedding of size d model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5570" target="_blank">01:32:50.540</a></span> | <span class="t">And we transform it into queries, key, and values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5573" target="_blank">01:32:53.260</a></span> | <span class="t">In which query, key, and values in the self-attention are the same matrix, same sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5577" target="_blank">01:32:57.660</a></span> | <span class="t">We multiply them by wq matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5581" target="_blank">01:33:01.180</a></span> | <span class="t">So wq, wk, and wv, which are parameter matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5585" target="_blank">01:33:05.340</a></span> | <span class="t">Then we split them along the d model dimension into number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5590" target="_blank">01:33:10.540</a></span> | <span class="t">So we can specify how many heads we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5592" target="_blank">01:33:12.700</a></span> | <span class="t">In our case, the one attention that we will do here is actually only one head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5598" target="_blank">01:33:18.940</a></span> | <span class="t">I will show you later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5599" target="_blank">01:33:19.740</a></span> | <span class="t">And then we calculate the attention for each of this head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5603" target="_blank">01:33:23.580</a></span> | <span class="t">Then we combine back by concatenating this head together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5608" target="_blank">01:33:28.780</a></span> | <span class="t">We multiply this output matrix of the concatenation with another matrix called wo,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5615" target="_blank">01:33:35.260</a></span> | <span class="t">which is the output matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5616" target="_blank">01:33:36.620</a></span> | <span class="t">And then this is the output of the multi-head attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5620" target="_blank">01:33:40.700</a></span> | <span class="t">If we have only one head, instead of being a multi-head,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5624" target="_blank">01:33:44.540</a></span> | <span class="t">then we will not do this splitting operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5626" target="_blank">01:33:46.940</a></span> | <span class="t">We will just do this multiplication with the w and with the wo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5631" target="_blank">01:33:51.260</a></span> | <span class="t">And OK, this is how the self-attention works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5634" target="_blank">01:33:54.940</a></span> | <span class="t">So in a self-attention, we have this query key and values coming from the same matrix input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5639" target="_blank">01:33:59.100</a></span> | <span class="t">And this is what we are going to build.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5641" target="_blank">01:34:01.500</a></span> | <span class="t">So we have the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5652" target="_blank">01:34:12.300</a></span> | <span class="t">Then we have the embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5654" target="_blank">01:34:14.380</a></span> | <span class="t">So what is the embedding of each token?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5656" target="_blank">01:34:16.700</a></span> | <span class="t">But in our case, we are not talking about tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5659" target="_blank">01:34:19.980</a></span> | <span class="t">We will talk about pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5661" target="_blank">01:34:21.340</a></span> | <span class="t">And we can think that the number of channels of each pixel is the embedding of the pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5666" target="_blank">01:34:26.700</a></span> | <span class="t">So the embedding, just like in the original transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5670" target="_blank">01:34:30.380</a></span> | <span class="t">the embeddings are the kind of vectors that capture the meaning of the word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5675" target="_blank">01:34:35.020</a></span> | <span class="t">In this case, we have the channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5676" target="_blank">01:34:36.540</a></span> | <span class="t">Each channel, each pixel represented by many channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5679" target="_blank">01:34:39.900</a></span> | <span class="t">that capture the information about that pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5681" target="_blank">01:34:41.980</a></span> | <span class="t">Here we have also the bias for the w matrices,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5689" target="_blank">01:34:49.420</a></span> | <span class="t">which we don't have in the original transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5691" target="_blank">01:34:51.500</a></span> | <span class="t">OK, now let's define the w matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5707" target="_blank">01:35:07.900</a></span> | <span class="t">So wqwq and wv.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5709" target="_blank">01:35:09.580</a></span> | <span class="t">We will represent it as one big linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5711" target="_blank">01:35:11.980</a></span> | <span class="t">Instead of representing it as three different matrices, it's possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5717" target="_blank">01:35:17.500</a></span> | <span class="t">We just say that it's a big matrix, three by the embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5721" target="_blank">01:35:21.340</a></span> | <span class="t">And the bias is if we want it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5725" target="_blank">01:35:25.260</a></span> | <span class="t">So in projection, in projection bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5728" target="_blank">01:35:28.620</a></span> | <span class="t">So this means stands for in projection,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5730" target="_blank">01:35:30.620</a></span> | <span class="t">because it's a projection of the input before we apply the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5734" target="_blank">01:35:34.300</a></span> | <span class="t">And then there is an auto projection, which is after we apply the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5737" target="_blank">01:35:37.420</a></span> | <span class="t">So the wo matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5747" target="_blank">01:35:47.100</a></span> | <span class="t">So as you remember here, the wo matrix is actually the model by the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5751" target="_blank">01:35:51.100</a></span> | <span class="t">The input is also the model by the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5753" target="_blank">01:35:53.420</a></span> | <span class="t">And this is exactly what we did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5754" target="_blank">01:35:54.780</a></span> | <span class="t">But we have three of them here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5756" target="_blank">01:35:56.860</a></span> | <span class="t">So it's three by the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5758" target="_blank">01:35:58.220</a></span> | <span class="t">And then we save the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5768" target="_blank">01:36:08.060</a></span> | <span class="t">And then we saved the dimension of each head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5775" target="_blank">01:36:15.500</a></span> | <span class="t">The dimension of each head basically means that if we have multi head,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5778" target="_blank">01:36:18.780</a></span> | <span class="t">each head will watch a part of the embedding of each token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5781" target="_blank">01:36:21.980</a></span> | <span class="t">So we need to save how much is this size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5785" target="_blank">01:36:25.820</a></span> | <span class="t">So the model divided by the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5788" target="_blank">01:36:28.060</a></span> | <span class="t">But divide by the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5792" target="_blank">01:36:32.700</a></span> | <span class="t">Let's implement the forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5795" target="_blank">01:36:35.420</a></span> | <span class="t">We can also apply a mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5803" target="_blank">01:36:43.660</a></span> | <span class="t">As you remember, the mask is a way to avoid relating tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5807" target="_blank">01:36:47.580</a></span> | <span class="t">one particular token with the tokens that come after it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5812" target="_blank">01:36:52.540</a></span> | <span class="t">but only with the token that come before it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5814" target="_blank">01:36:54.780</a></span> | <span class="t">And this is called the causal mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5818" target="_blank">01:36:58.380</a></span> | <span class="t">If you really are not understanding what is happening here in the attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5825" target="_blank">01:37:05.500</a></span> | <span class="t">I highly recommend you watch my previous video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5827" target="_blank">01:37:07.420</a></span> | <span class="t">because it's explained very well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5829" target="_blank">01:37:09.980</a></span> | <span class="t">And if you watch it, it will take not so much time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5834" target="_blank">01:37:14.380</a></span> | <span class="t">And I think you will learn a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5836" target="_blank">01:37:16.300</a></span> | <span class="t">So the first thing we do is extract the shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5840" target="_blank">01:37:20.780</a></span> | <span class="t">Then we extract the size, the sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5851" target="_blank">01:37:31.420</a></span> | <span class="t">length and the embedding is equal to input shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5858" target="_blank">01:37:38.780</a></span> | <span class="t">And then we say that we will convert it into another shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5867" target="_blank">01:37:47.020</a></span> | <span class="t">that I will show you later why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5868" target="_blank">01:37:48.460</a></span> | <span class="t">This is called the interim shape, intermediate shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5878" target="_blank">01:37:58.140</a></span> | <span class="t">Then we apply the query key and value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5886" target="_blank">01:38:06.700</a></span> | <span class="t">We apply the in projection, so the wq, wq and wv matrix to the input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5892" target="_blank">01:38:12.540</a></span> | <span class="t">and we convert it into query key and values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5894" target="_blank">01:38:14.620</a></span> | <span class="t">So query key and values are equal to...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5896" target="_blank">01:38:16.620</a></span> | <span class="t">We multiply it, but then we divide it with chunk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5902" target="_blank">01:38:22.220</a></span> | <span class="t">As I showed you before, what is chunk?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5903" target="_blank">01:38:23.900</a></span> | <span class="t">Basically, we will multiply the input with the big matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5909" target="_blank">01:38:29.260</a></span> | <span class="t">that represents wq, wq and wq,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5911" target="_blank">01:38:31.420</a></span> | <span class="t">but then we split it back into three smaller matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5914" target="_blank">01:38:34.700</a></span> | <span class="t">This is the same as applying three different projections.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5917" target="_blank">01:38:37.740</a></span> | <span class="t">Instead of...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5918" target="_blank">01:38:38.960</a></span> | <span class="t">It's the same as applying three separate in projections,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5923" target="_blank">01:38:43.500</a></span> | <span class="t">but it's also possible to combine it in one big matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5926" target="_blank">01:38:46.860</a></span> | <span class="t">This, what we will do, basically it will convert batch size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5936" target="_blank">01:38:56.060</a></span> | <span class="t">sequence length, dimension into batch size, sequence length, dimension multiplied by three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5945" target="_blank">01:39:05.740</a></span> | <span class="t">And then by using chunk, we split it along the last dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5949" target="_blank">01:39:09.820</a></span> | <span class="t">into three different tensors of shape, batch size, sequence length and dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5963" target="_blank">01:39:23.900</a></span> | <span class="t">Okay, now we can split the query key and values in the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5971" target="_blank">01:39:31.180</a></span> | <span class="t">According to the number of heads, this is why we built this shape,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5974" target="_blank">01:39:34.220</a></span> | <span class="t">which means split the dimension, the last dimension into n heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=5982" target="_blank">01:39:42.940</a></span> | <span class="t">And the values v.view, wonderful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6002" target="_blank">01:40:02.540</a></span> | <span class="t">This will convert, okay, let's write it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6008" target="_blank">01:40:08.620</a></span> | <span class="t">batch size, sequence length, dimension into batch size, sequence length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6017" target="_blank">01:40:17.180</a></span> | <span class="t">then h, so the number of heads and each dimension divided by the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6023" target="_blank">01:40:23.260</a></span> | <span class="t">So each head will watch the full sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6026" target="_blank">01:40:26.060</a></span> | <span class="t">but only a part of the embedding of each token, in this case, pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6031" target="_blank">01:40:31.260</a></span> | <span class="t">And we'll watch this part of the head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6035" target="_blank">01:40:35.180</a></span> | <span class="t">So the full dimension, the embedding divided by the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6039" target="_blank">01:40:39.500</a></span> | <span class="t">And then this will convert it, because we are also transposing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6046" target="_blank">01:40:46.380</a></span> | <span class="t">this will convert it into batch size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6049" target="_blank">01:40:49.020</a></span> | <span class="t">h, sequence length, and then dimension h.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6055" target="_blank">01:40:55.900</a></span> | <span class="t">So each head will watch all the sequence, but only a part of the embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6063" target="_blank">01:41:03.180</a></span> | <span class="t">We then calculate the attention, just like the formula.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6067" target="_blank">01:41:07.100</a></span> | <span class="t">So query multiplied by the transpose of the keys.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6069" target="_blank">01:41:09.900</a></span> | <span class="t">So is the query, matrix multiplication with the transpose of the keys.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6075" target="_blank">01:41:15.100</a></span> | <span class="t">This will return a matrix of size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6079" target="_blank">01:41:19.740</a></span> | <span class="t">batch size, h, sequence length by sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6085" target="_blank">01:41:25.420</a></span> | <span class="t">We can then apply the mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6090" target="_blank">01:41:30.860</a></span> | <span class="t">As you remember, the mask is something that we apply when we calculate the attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6095" target="_blank">01:41:35.980</a></span> | <span class="t">if we don't want two tokens to relate to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6098" target="_blank">01:41:38.780</a></span> | <span class="t">We basically substitute their value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6101" target="_blank">01:41:41.820</a></span> | <span class="t">In this matrix, we substitute the interaction with minus infinity before applying the softmax,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6107" target="_blank">01:41:47.500</a></span> | <span class="t">so that the softmax will make it zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6109" target="_blank">01:41:49.820</a></span> | <span class="t">So this is what we are doing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6111" target="_blank">01:41:51.260</a></span> | <span class="t">We first build the mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6114" target="_blank">01:41:54.540</a></span> | <span class="t">This will create a causal mask, basically a mask where the upper triangle,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6120" target="_blank">01:42:00.700</a></span> | <span class="t">so above the principal diagonal, is made up of one ones, a lot of ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6133" target="_blank">01:42:13.740</a></span> | <span class="t">And then we can then apply the softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6137" target="_blank">01:42:17.500</a></span> | <span class="t">One ones, a lot of ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6142" target="_blank">01:42:22.540</a></span> | <span class="t">And then we fill it up with minus infinity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6145" target="_blank">01:42:25.900</a></span> | <span class="t">Masked, oops, not mask, but wait.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6152" target="_blank">01:42:32.940</a></span> | <span class="t">Masked fill, but with mask, and we put minus infinity, like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6166" target="_blank">01:42:46.220</a></span> | <span class="t">As you remember, the formula of the transformer is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6168" target="_blank">01:42:48.860</a></span> | <span class="t">query multiplied by the transpose of the keys, and then divided by the square root of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6174" target="_blank">01:42:54.220</a></span> | <span class="t">So this is what we will do now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6175" target="_blank">01:42:55.580</a></span> | <span class="t">So divided by the square root of the model, set of the head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6182" target="_blank">01:43:02.140</a></span> | <span class="t">And then we apply the softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6195" target="_blank">01:43:15.020</a></span> | <span class="t">We multiply it by the WO matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6197" target="_blank">01:43:17.180</a></span> | <span class="t">We transpose back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6204" target="_blank">01:43:24.540</a></span> | <span class="t">So we want to remove, now we want to remove the head dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6209" target="_blank">01:43:29.420</a></span> | <span class="t">So output is equal to, let me write some shapes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6215" target="_blank">01:43:35.820</a></span> | <span class="t">So what is this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6217" target="_blank">01:43:37.020</a></span> | <span class="t">This is equal to patch size, sequence by sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6225" target="_blank">01:43:45.580</a></span> | <span class="t">multiplied, so matrix multiplication with patch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6236" target="_blank">01:43:56.620</a></span> | <span class="t">This will result into patch size, H, sequence length, and dimension divided by H.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6249" target="_blank">01:44:09.820</a></span> | <span class="t">This we then multiplied by the, we then transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6255" target="_blank">01:44:15.660</a></span> | <span class="t">And this will result into, so we start with this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6263" target="_blank">01:44:23.580</a></span> | <span class="t">And it becomes, wait I put too many parentheses here, patch size, sequence length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6278" target="_blank">01:44:38.860</a></span> | <span class="t">H, and dimensions, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6284" target="_blank">01:44:44.620</a></span> | <span class="t">Then we can reshape as the input, like the initial shape, so this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6297" target="_blank">01:44:57.980</a></span> | <span class="t">And then we apply the output projection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6302" target="_blank">01:45:02.540</a></span> | <span class="t">So we multiply it by the WO matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6313" target="_blank">01:45:13.900</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6322" target="_blank">01:45:22.060</a></span> | <span class="t">This is the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6326" target="_blank">01:45:26.220</a></span> | <span class="t">Now let's go back to continue building the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6329" target="_blank">01:45:29.100</a></span> | <span class="t">For now we have built the attention block and the residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6331" target="_blank">01:45:31.900</a></span> | <span class="t">But we need to build the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6345" target="_blank">01:45:45.740</a></span> | <span class="t">And also this one is a sequence of modules that we will apply one after another.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6360" target="_blank">01:46:00.860</a></span> | <span class="t">We start with the convolution just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6363" target="_blank">01:46:03.180</a></span> | <span class="t">Now I will not write again the shapes change, but you got the idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6367" target="_blank">01:46:07.100</a></span> | <span class="t">In the encoder we, in the encoder, let me show you here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6372" target="_blank">01:46:12.860</a></span> | <span class="t">Here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6377" target="_blank">01:46:17.900</a></span> | <span class="t">In the encoder we keep reducing the size of the image until it becomes small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6382" target="_blank">01:46:22.540</a></span> | <span class="t">In the decoder we need to return to the original size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6387" target="_blank">01:46:27.180</a></span> | <span class="t">So we start with the latent dimension and we return to the original dimension of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6394" target="_blank">01:46:34.940</a></span> | <span class="t">Convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6399" target="_blank">01:46:39.100</a></span> | <span class="t">So we start with four channels and we output four channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6414" target="_blank">01:46:54.460</a></span> | <span class="t">Then we have another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6415" target="_blank">01:46:55.820</a></span> | <span class="t">We go to 500.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6423" target="_blank">01:47:03.100</a></span> | <span class="t">Then we have a residual block just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6432" target="_blank">01:47:12.220</a></span> | <span class="t">Then we have an attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6443" target="_blank">01:47:23.180</a></span> | <span class="t">Then we have a bunch of residual blocks and we have four of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6451" target="_blank">01:47:31.980</a></span> | <span class="t">Let me copy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6462" target="_blank">01:47:42.540</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6465" target="_blank">01:47:45.360</a></span> | <span class="t">Now the residual blocks, let me write some shapes here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6469" target="_blank">01:47:49.820</a></span> | <span class="t">Here we arrived to a situation in which we have batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6473" target="_blank">01:47:53.660</a></span> | <span class="t">We have 512 features and the size of the image still didn't grow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6478" target="_blank">01:47:58.700</a></span> | <span class="t">because we didn't have any convolution that will make it grow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6482" target="_blank">01:48:02.140</a></span> | <span class="t">This one of course will remain the same because it's a residual block and etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6492" target="_blank">01:48:12.700</a></span> | <span class="t">Now to increase the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6495" target="_blank">01:48:15.580</a></span> | <span class="t">So now the image is actually height divided by 8 which height as you remember is 512,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6501" target="_blank">01:48:21.740</a></span> | <span class="t">the size of the image that we are working with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6504" target="_blank">01:48:24.220</a></span> | <span class="t">So this dimension here is 64 by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6507" target="_blank">01:48:27.980</a></span> | <span class="t">How can we increase it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6509" target="_blank">01:48:29.260</a></span> | <span class="t">We use one module called upsample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6511" target="_blank">01:48:31.260</a></span> | <span class="t">The upsample, we have to think of it like when we resize an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6522" target="_blank">01:48:42.220</a></span> | <span class="t">So imagine you have an image that is 64 by 64</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6525" target="_blank">01:48:45.340</a></span> | <span class="t">and you want to transform it to 128 by 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6528" target="_blank">01:48:48.860</a></span> | <span class="t">The upsample will do it just like when we resize an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6532" target="_blank">01:48:52.620</a></span> | <span class="t">So it will replicate the pixels twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6537" target="_blank">01:48:57.580</a></span> | <span class="t">So along the dimensions right and down for example twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6542" target="_blank">01:49:02.220</a></span> | <span class="t">So that the total amount of pixels, the height and the width actually doubles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6547" target="_blank">01:49:07.180</a></span> | <span class="t">This is the upsample basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6550" target="_blank">01:49:10.860</a></span> | <span class="t">It will just replicate each pixel so that by this scale factor along each dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6556" target="_blank">01:49:16.940</a></span> | <span class="t">So this one becomes batch size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6564" target="_blank">01:49:24.060</a></span> | <span class="t">divided by 8, width divided by 8 becomes as we see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6578" target="_blank">01:49:38.460</a></span> | <span class="t">8 divided by 4 and width divided by 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6581" target="_blank">01:49:41.260</a></span> | <span class="t">Then we have a convolution, residual blocks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6587" target="_blank">01:49:47.420</a></span> | <span class="t">So we have convolutions of 2D, 512 to 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6605" target="_blank">01:50:05.180</a></span> | <span class="t">Then we have residual blocks of 512 by 500.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6609" target="_blank">01:50:09.340</a></span> | <span class="t">But in this case we have three of them, 2, 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6611" target="_blank">01:50:11.660</a></span> | <span class="t">Then we have another upsample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6614" target="_blank">01:50:14.060</a></span> | <span class="t">This will again double the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6617" target="_blank">01:50:17.660</a></span> | <span class="t">So we have another one that will double the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6620" target="_blank">01:50:20.860</a></span> | <span class="t">And by a scale factor of 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6623" target="_blank">01:50:23.340</a></span> | <span class="t">So now our image which was divided by 4 with 512 channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6629" target="_blank">01:50:29.340</a></span> | <span class="t">So let's write it like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6630" target="_blank">01:50:30.780</a></span> | <span class="t">Will become divided by 2 now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6634" target="_blank">01:50:34.300</a></span> | <span class="t">So it will double the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6637" target="_blank">01:50:37.100</a></span> | <span class="t">So now our image is 256 by 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6641" target="_blank">01:50:41.660</a></span> | <span class="t">Then again we have a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6645" target="_blank">01:50:45.980</a></span> | <span class="t">And then we have three residual blocks again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6654" target="_blank">01:50:54.940</a></span> | <span class="t">But this time we reduce the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6658" target="_blank">01:50:58.940</a></span> | <span class="t">So 256 and then it's 256 to 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6666" target="_blank">01:51:06.780</a></span> | <span class="t">Okay, then we have another upsampling which will again double the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6674" target="_blank">01:51:14.300</a></span> | <span class="t">And this time we will go from divide by 2 to divide by 2 up to the original size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6686" target="_blank">01:51:26.220</a></span> | <span class="t">And because the number of channels has changed, we are not 512 anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6691" target="_blank">01:51:31.100</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6692" target="_blank">01:51:32.480</a></span> | <span class="t">And then we have another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6695" target="_blank">01:51:35.820</a></span> | <span class="t">This case with 256 because it's the new number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6700" target="_blank">01:51:40.540</a></span> | <span class="t">Then we have another bunch of residual blocks that will decrease the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6712" target="_blank">01:51:52.380</a></span> | <span class="t">So we go to 256 to 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6720" target="_blank">01:52:00.060</a></span> | <span class="t">We have finally a group norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6727" target="_blank">01:52:07.980</a></span> | <span class="t">32 is the group size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6732" target="_blank">01:52:12.700</a></span> | <span class="t">So we group features in groups of 32 before calculating the mu and the sigma before normalizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6740" target="_blank">01:52:20.540</a></span> | <span class="t">And we define the number of channels as 128 which is the number of features that we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6745" target="_blank">01:52:25.180</a></span> | <span class="t">So this group normalization will divide these 128 features into groups of 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6752" target="_blank">01:52:32.380</a></span> | <span class="t">Then we apply the silu.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6756" target="_blank">01:52:36.220</a></span> | <span class="t">And then we have a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6761" target="_blank">01:52:41.340</a></span> | <span class="t">The final convolution that will transform into an image with the three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6767" target="_blank">01:52:47.660</a></span> | <span class="t">So RGB by applying these convolutions here which doesn't change the size of the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6774" target="_blank">01:52:54.380</a></span> | <span class="t">So we'll go from an image that is batch size 128 height width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6781" target="_blank">01:53:01.660</a></span> | <span class="t">Why height width?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6782" target="_blank">01:53:02.380</a></span> | <span class="t">Because after the last upsampling we become of the original size into an image with only three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6790" target="_blank">01:53:10.860</a></span> | <span class="t">And this is our decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6800" target="_blank">01:53:20.860</a></span> | <span class="t">Now we can write the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6816" target="_blank">01:53:36.780</a></span> | <span class="t">I'm sorry if I'm putting a lot of spaces between here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6819" target="_blank">01:53:39.580</a></span> | <span class="t">But otherwise it's easy to get lost and not understand where we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6823" target="_blank">01:53:43.580</a></span> | <span class="t">So here the input of the decoder is our latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6830" target="_blank">01:53:50.620</a></span> | <span class="t">So it's batch size 4 height divided by 8 width divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6837" target="_blank">01:53:57.500</a></span> | <span class="t">As you remember here in the encoder the last thing we do is be scaled by this constant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6842" target="_blank">01:54:02.300</a></span> | <span class="t">So we nullify this scaling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6845" target="_blank">01:54:05.180</a></span> | <span class="t">So we reverse this scaling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6847" target="_blank">01:54:07.020</a></span> | <span class="t">215 and then we run it through the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6853" target="_blank">01:54:13.980</a></span> | <span class="t">And then return x which is batch size 3 height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6871" target="_blank">01:54:31.260</a></span> | <span class="t">Let me also write the input of this decoder which is this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6875" target="_blank">01:54:35.500</a></span> | <span class="t">We already have it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6877" target="_blank">01:54:37.820</a></span> | <span class="t">Okay this is our variational auto encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6881" target="_blank">01:54:41.180</a></span> | <span class="t">So far let's go review.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6883" target="_blank">01:54:43.740</a></span> | <span class="t">We are building our architecture of the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6890" target="_blank">01:54:50.620</a></span> | <span class="t">So far we have built the encoder and the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6893" target="_blank">01:54:53.980</a></span> | <span class="t">But now we have to build the unit and then we have to build the clip text encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6901" target="_blank">01:55:01.020</a></span> | <span class="t">And finally we have to build the pipeline that will connect all of these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6905" target="_blank">01:55:05.740</a></span> | <span class="t">So it's going to be a long journey but it's fun actually to build things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6910" target="_blank">01:55:10.220</a></span> | <span class="t">Because you learn every detail of how they work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6913" target="_blank">01:55:13.180</a></span> | <span class="t">So the next thing that we are going to build is the text encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6916" target="_blank">01:55:16.780</a></span> | <span class="t">So this clip encoder here that will allow us to encode the prompt into embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6922" target="_blank">01:55:22.700</a></span> | <span class="t">that we can then feed to this unit model here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6925" target="_blank">01:55:25.660</a></span> | <span class="t">So let's build this clip encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6928" target="_blank">01:55:28.620</a></span> | <span class="t">And we will of course use a pre-trained version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6931" target="_blank">01:55:31.180</a></span> | <span class="t">So by downloading the vocabulary and I will show you how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6935" target="_blank">01:55:35.260</a></span> | <span class="t">So let's start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6936" target="_blank">01:55:36.700</a></span> | <span class="t">We go to Visual Studio Code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6939" target="_blank">01:55:39.340</a></span> | <span class="t">We create a new file in st folder called clip.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6943" target="_blank">01:55:43.260</a></span> | <span class="t">And here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6945" target="_blank">01:55:45.820</a></span> | <span class="t">And we start importing the usual stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6949" target="_blank">01:55:49.020</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6968" target="_blank">01:56:08.060</a></span> | <span class="t">And we also import self-attention because we will be using it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6970" target="_blank">01:56:10.620</a></span> | <span class="t">So basically clip is a layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6975" target="_blank">01:56:15.100</a></span> | <span class="t">It's very similar to the encoder layer of the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6978" target="_blank">01:56:18.620</a></span> | <span class="t">So as you remember the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6980" target="_blank">01:56:20.300</a></span> | <span class="t">Let me show you here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6981" target="_blank">01:56:21.580</a></span> | <span class="t">The transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6984" target="_blank">01:56:24.140</a></span> | <span class="t">This is the encoder layer of the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6986" target="_blank">01:56:26.460</a></span> | <span class="t">It's made of attention and then feed forwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6990" target="_blank">01:56:30.060</a></span> | <span class="t">And there are many blocks like this one after another that are applied one after another.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6994" target="_blank">01:56:34.140</a></span> | <span class="t">We also have something that tells the position of each token inside of the sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=6998" target="_blank">01:56:38.700</a></span> | <span class="t">And we will also have something similar in clip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7001" target="_blank">01:56:41.020</a></span> | <span class="t">So we need to build something very similar to this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7004" target="_blank">01:56:44.460</a></span> | <span class="t">And actually this is why I mean the transformer model was very successful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7008" target="_blank">01:56:48.140</a></span> | <span class="t">So that's why they use the same structure of course also for this purpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7011" target="_blank">01:56:51.420</a></span> | <span class="t">And so let's go to build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7014" target="_blank">01:56:54.140</a></span> | <span class="t">The first thing we will build.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7017" target="_blank">01:56:57.500</a></span> | <span class="t">I will build first the skeleton of the model and then we will build each block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7020" target="_blank">01:57:00.700</a></span> | <span class="t">So let's build clip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7022" target="_blank">01:57:02.860</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7033" target="_blank">01:57:13.100</a></span> | <span class="t">And this has some embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7035" target="_blank">01:57:15.820</a></span> | <span class="t">The embeddings allow us to convert the tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7039" target="_blank">01:57:19.660</a></span> | <span class="t">So as you remember in when you have a sentence made up of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7043" target="_blank">01:57:23.180</a></span> | <span class="t">First you convert it into numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7045" target="_blank">01:57:25.260</a></span> | <span class="t">Where each number indicates the position of the token inside of the vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7048" target="_blank">01:57:28.940</a></span> | <span class="t">And then you convert it into embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7051" target="_blank">01:57:31.180</a></span> | <span class="t">Where each embedding represents a vector of size 512 in the original transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7056" target="_blank">01:57:36.220</a></span> | <span class="t">But here in clip the size is 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7060" target="_blank">01:57:40.300</a></span> | <span class="t">And each vector represents kind of the meaning of the word or the token captures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7065" target="_blank">01:57:45.660</a></span> | <span class="t">So this is an embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7068" target="_blank">01:57:48.380</a></span> | <span class="t">And later we define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7071" target="_blank">01:57:51.260</a></span> | <span class="t">We need the vocabulary size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7072" target="_blank">01:57:52.620</a></span> | <span class="t">The vocabulary size is 49408.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7075" target="_blank">01:57:55.420</a></span> | <span class="t">I took it directly from the file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7076" target="_blank">01:57:56.940</a></span> | <span class="t">This is the embedding size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7079" target="_blank">01:57:59.100</a></span> | <span class="t">And the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7080" target="_blank">01:58:00.140</a></span> | <span class="t">The maximum sequence length that we can have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7082" target="_blank">01:58:02.060</a></span> | <span class="t">Because we need to use the padding is 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7085" target="_blank">01:58:05.260</a></span> | <span class="t">Because we should actually use some configuration file to save.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7089" target="_blank">01:58:09.820</a></span> | <span class="t">But because we will be using with the pre-trained stable diffusion model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7093" target="_blank">01:58:13.820</a></span> | <span class="t">The size are already fixed for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7096" target="_blank">01:58:16.060</a></span> | <span class="t">But in the future I will refactor the code to add some configuration actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7100" target="_blank">01:58:20.300</a></span> | <span class="t">To make it more extensible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7103" target="_blank">01:58:23.900</a></span> | <span class="t">This is a list of layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7111" target="_blank">01:58:31.180</a></span> | <span class="t">Each we call it the clip layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7116" target="_blank">01:58:36.060</a></span> | <span class="t">We have this 12.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7117" target="_blank">01:58:37.340</a></span> | <span class="t">Which indicates the number of head of the multihead attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7123" target="_blank">01:58:43.020</a></span> | <span class="t">And then the embedding size which is 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7127" target="_blank">01:58:47.020</a></span> | <span class="t">And we have 12 of these layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7131" target="_blank">01:58:51.020</a></span> | <span class="t">Then we have the layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7134" target="_blank">01:58:54.940</a></span> | <span class="t">Layer norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7138" target="_blank">01:58:58.460</a></span> | <span class="t">And we tell him how many features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7143" target="_blank">01:59:03.100</a></span> | <span class="t">So 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7145" target="_blank">01:59:05.180</a></span> | <span class="t">And then we define the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7147" target="_blank">01:59:07.580</a></span> | <span class="t">This is tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7154" target="_blank">01:59:14.940</a></span> | <span class="t">And this one returns float tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7158" target="_blank">01:59:18.460</a></span> | <span class="t">Why long tensor?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7160" target="_blank">01:59:20.940</a></span> | <span class="t">Because the input IDs are usually numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7165" target="_blank">01:59:25.340</a></span> | <span class="t">That indicate the position of each token inside of the vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7168" target="_blank">01:59:28.460</a></span> | <span class="t">Also this concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7169" target="_blank">01:59:29.420</a></span> | <span class="t">Please if it's not clear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7170" target="_blank">01:59:30.460</a></span> | <span class="t">Go watch my previous video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7171" target="_blank">01:59:31.980</a></span> | <span class="t">About the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7172" target="_blank">01:59:32.540</a></span> | <span class="t">Because it's very clear there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7174" target="_blank">01:59:34.460</a></span> | <span class="t">When we work with the textual models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7176" target="_blank">01:59:36.540</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7184" target="_blank">01:59:44.140</a></span> | <span class="t">First we convert each token into embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7186" target="_blank">01:59:46.140</a></span> | <span class="t">And then.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7192" target="_blank">01:59:52.380</a></span> | <span class="t">So what is the size here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7194" target="_blank">01:59:54.300</a></span> | <span class="t">We are going from batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7195" target="_blank">01:59:55.740</a></span> | <span class="t">Sequence length into.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7200" target="_blank">02:00:00.620</a></span> | <span class="t">Batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7203" target="_blank">02:00:03.260</a></span> | <span class="t">Sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7204" target="_blank">02:00:04.460</a></span> | <span class="t">And dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7205" target="_blank">02:00:05.100</a></span> | <span class="t">Where the dimension is 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7207" target="_blank">02:00:07.260</a></span> | <span class="t">Then we apply one after.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7209" target="_blank">02:00:09.580</a></span> | <span class="t">One after another.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7212" target="_blank">02:00:12.220</a></span> | <span class="t">All the layers of this encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7213" target="_blank">02:00:13.740</a></span> | <span class="t">Just like in the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7218" target="_blank">02:00:18.060</a></span> | <span class="t">And the last one we apply the layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7229" target="_blank">02:00:29.820</a></span> | <span class="t">Oh.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7230" target="_blank">02:00:30.320</a></span> | <span class="t">And finally we return the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7236" target="_blank">02:00:36.140</a></span> | <span class="t">Where the output is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7237" target="_blank">02:00:37.100</a></span> | <span class="t">Of course it's a sequence to sequence model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7241" target="_blank">02:00:41.660</a></span> | <span class="t">Just like the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7242" target="_blank">02:00:42.620</a></span> | <span class="t">So the input should match the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7244" target="_blank">02:00:44.140</a></span> | <span class="t">The shape of the input should match the shape of the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7247" target="_blank">02:00:47.740</a></span> | <span class="t">So we always obtain sequence length by the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7252" target="_blank">02:00:52.300</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7253" target="_blank">02:00:53.980</a></span> | <span class="t">Now let's define these two blocks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7255" target="_blank">02:00:55.580</a></span> | <span class="t">The first one is the clip embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7257" target="_blank">02:00:57.340</a></span> | <span class="t">So let's go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7259" target="_blank">02:00:59.660</a></span> | <span class="t">Clip embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7266" target="_blank">02:01:06.300</a></span> | <span class="t">How much is the vocabulary size?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7270" target="_blank">02:01:10.220</a></span> | <span class="t">What is the embedding size?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7272" target="_blank">02:01:12.860</a></span> | <span class="t">And number of token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7280" target="_blank">02:01:20.060</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7281" target="_blank">02:01:21.660</a></span> | <span class="t">So the sequence length basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7288" target="_blank">02:01:28.060</a></span> | <span class="t">And.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7288" target="_blank">02:01:28.560</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7296" target="_blank">02:01:36.060</a></span> | <span class="t">We define the embedding itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7298" target="_blank">02:01:38.380</a></span> | <span class="t">Using nn.embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7299" target="_blank">02:01:39.740</a></span> | <span class="t">Just like always.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7300" target="_blank">02:01:40.540</a></span> | <span class="t">We need to tell him what is the number of embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7309" target="_blank">02:01:49.740</a></span> | <span class="t">So the vocabulary size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7311" target="_blank">02:01:51.260</a></span> | <span class="t">And what is the dimension of each vector of the embedding token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7314" target="_blank">02:01:54.540</a></span> | <span class="t">Then we define some positional encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7317" target="_blank">02:01:57.420</a></span> | <span class="t">So now as you remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7319" target="_blank">02:01:59.580</a></span> | <span class="t">The positional encoding in the original transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7321" target="_blank">02:02:01.580</a></span> | <span class="t">Are given by sinusoidal functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7324" target="_blank">02:02:04.300</a></span> | <span class="t">But here in clip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7326" target="_blank">02:02:06.140</a></span> | <span class="t">They actually don't use them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7327" target="_blank">02:02:07.500</a></span> | <span class="t">They use some learned parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7330" target="_blank">02:02:10.380</a></span> | <span class="t">So they have these parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7333" target="_blank">02:02:13.260</a></span> | <span class="t">That are learned by the model during training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7335" target="_blank">02:02:15.980</a></span> | <span class="t">That tell the position of the token to the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7343" target="_blank">02:02:23.740</a></span> | <span class="t">Tokens and embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7347" target="_blank">02:02:27.740</a></span> | <span class="t">Like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7349" target="_blank">02:02:29.260</a></span> | <span class="t">We apply them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7359" target="_blank">02:02:39.180</a></span> | <span class="t">So first we apply the embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7360" target="_blank">02:02:40.620</a></span> | <span class="t">So we go from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7361" target="_blank">02:02:41.500</a></span> | <span class="t">Patch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7363" target="_blank">02:02:43.340</a></span> | <span class="t">Sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7366" target="_blank">02:02:46.460</a></span> | <span class="t">To.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7366" target="_blank">02:02:46.960</a></span> | <span class="t">Patch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7369" target="_blank">02:02:49.900</a></span> | <span class="t">Sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7371" target="_blank">02:02:51.180</a></span> | <span class="t">Dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7371" target="_blank">02:02:51.980</a></span> | <span class="t">And then just like in the original transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7382" target="_blank">02:03:02.460</a></span> | <span class="t">We add the positional encodings to each token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7387" target="_blank">02:03:07.820</a></span> | <span class="t">But in this case as I told you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7389" target="_blank">02:03:09.180</a></span> | <span class="t">The positional embeddings are not fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7392" target="_blank">02:03:12.620</a></span> | <span class="t">Like not sinusoidal functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7394" target="_blank">02:03:14.380</a></span> | <span class="t">But they are learned by the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7396" target="_blank">02:03:16.460</a></span> | <span class="t">So they are learned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7397" target="_blank">02:03:17.260</a></span> | <span class="t">And then later we will load these parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7399" target="_blank">02:03:19.740</a></span> | <span class="t">When we load the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7401" target="_blank">02:03:21.020</a></span> | <span class="t">And then we return this x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7403" target="_blank">02:03:23.420</a></span> | <span class="t">Then we have the clip layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7406" target="_blank">02:03:26.220</a></span> | <span class="t">Which is just like the layer of the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7409" target="_blank">02:03:29.100</a></span> | <span class="t">The encoder of the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7423" target="_blank">02:03:43.420</a></span> | <span class="t">So it returns nothing actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7427" target="_blank">02:03:47.420</a></span> | <span class="t">And this one is wrong in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7441" target="_blank">02:04:01.100</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7443" target="_blank">02:04:03.600</a></span> | <span class="t">We have just like in the transformer block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7446" target="_blank">02:04:06.620</a></span> | <span class="t">We have the pre norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7448" target="_blank">02:04:08.860</a></span> | <span class="t">Then we have the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7449" target="_blank">02:04:09.820</a></span> | <span class="t">Then we have a post norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7451" target="_blank">02:04:11.020</a></span> | <span class="t">And then we have the feed forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7452" target="_blank">02:04:12.300</a></span> | <span class="t">So layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7456" target="_blank">02:04:16.860</a></span> | <span class="t">Then we have the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7467" target="_blank">02:04:27.900</a></span> | <span class="t">Which is a self attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7471" target="_blank">02:04:31.980</a></span> | <span class="t">Later we will build the cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7477" target="_blank">02:04:37.580</a></span> | <span class="t">And I will show you what is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7478" target="_blank">02:04:38.780</a></span> | <span class="t">Then we have another layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7483" target="_blank">02:04:43.820</a></span> | <span class="t">Then we have two feed forward layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7503" target="_blank">02:05:03.260</a></span> | <span class="t">And finally we have the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7516" target="_blank">02:05:16.780</a></span> | <span class="t">Finally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7517" target="_blank">02:05:17.260</a></span> | <span class="t">So this one takes tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7523" target="_blank">02:05:23.500</a></span> | <span class="t">And returns a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7524" target="_blank">02:05:24.700</a></span> | <span class="t">So let me write it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7525" target="_blank">02:05:25.660</a></span> | <span class="t">Tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7527" target="_blank">02:05:27.500</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7532" target="_blank">02:05:32.300</a></span> | <span class="t">Just like the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7533" target="_blank">02:05:33.740</a></span> | <span class="t">Okay let's go have a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7535" target="_blank">02:05:35.020</a></span> | <span class="t">We have a bunch of residual connections.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7537" target="_blank">02:05:37.740</a></span> | <span class="t">As you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7538" target="_blank">02:05:38.460</a></span> | <span class="t">One residual connection here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7539" target="_blank">02:05:39.580</a></span> | <span class="t">One residual connection here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7540" target="_blank">02:05:40.780</a></span> | <span class="t">We have two normalizations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7541" target="_blank">02:05:41.980</a></span> | <span class="t">One here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7542" target="_blank">02:05:42.460</a></span> | <span class="t">One here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7542" target="_blank">02:05:42.960</a></span> | <span class="t">The feed forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7544" target="_blank">02:05:44.460</a></span> | <span class="t">As just like in the original transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7546" target="_blank">02:05:46.220</a></span> | <span class="t">We have two linear layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7548" target="_blank">02:05:48.780</a></span> | <span class="t">And then we have this multi head attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7550" target="_blank">02:05:50.700</a></span> | <span class="t">Which is actually a self attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7551" target="_blank">02:05:51.980</a></span> | <span class="t">Because it's the same input that becomes query key and values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7555" target="_blank">02:05:55.100</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7557" target="_blank">02:05:57.580</a></span> | <span class="t">The first residual connection x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7560" target="_blank">02:06:00.940</a></span> | <span class="t">So what is the input of this forward method?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7563" target="_blank">02:06:03.260</a></span> | <span class="t">It's a batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7564" target="_blank">02:06:04.300</a></span> | <span class="t">Sequence length d mod.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7567" target="_blank">02:06:07.580</a></span> | <span class="t">And the dimension of the embedding which is 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7571" target="_blank">02:06:11.980</a></span> | <span class="t">The first thing we do is we apply the self attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7575" target="_blank">02:06:15.260</a></span> | <span class="t">But before applying the self attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7578" target="_blank">02:06:18.220</a></span> | <span class="t">We apply the layer normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7580" target="_blank">02:06:20.300</a></span> | <span class="t">So layer normal 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7583" target="_blank">02:06:23.100</a></span> | <span class="t">Then we apply the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7588" target="_blank">02:06:28.940</a></span> | <span class="t">But with the causal mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7590" target="_blank">02:06:30.220</a></span> | <span class="t">As you remember here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7596" target="_blank">02:06:36.780</a></span> | <span class="t">Self attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7597" target="_blank">02:06:37.580</a></span> | <span class="t">We have the causal mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7599" target="_blank">02:06:39.180</a></span> | <span class="t">Which basically means that every token cannot watch the next tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7602" target="_blank">02:06:42.940</a></span> | <span class="t">So cannot be related to future tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7604" target="_blank">02:06:44.780</a></span> | <span class="t">But only the one on the left of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7606" target="_blank">02:06:46.860</a></span> | <span class="t">And this is what we want from a text model actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7609" target="_blank">02:06:49.900</a></span> | <span class="t">We don't want the one word to watch the words that come after it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7613" target="_blank">02:06:53.900</a></span> | <span class="t">But only the words that come before it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7615" target="_blank">02:06:55.820</a></span> | <span class="t">Then we do this residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7619" target="_blank">02:06:59.020</a></span> | <span class="t">So now we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7619" target="_blank">02:06:59.820</a></span> | <span class="t">Now we are doing this connection here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7624" target="_blank">02:07:04.380</a></span> | <span class="t">Then we do the feed forward layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7630" target="_blank">02:07:10.540</a></span> | <span class="t">Again we have a residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7634" target="_blank">02:07:14.460</a></span> | <span class="t">We apply the normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7638" target="_blank">02:07:18.300</a></span> | <span class="t">I'm not writing all the shapes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7644" target="_blank">02:07:24.220</a></span> | <span class="t">If you watch my code online.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7645" target="_blank">02:07:25.660</a></span> | <span class="t">I have written all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7647" target="_blank">02:07:27.340</a></span> | <span class="t">But mostly to save time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7648" target="_blank">02:07:28.780</a></span> | <span class="t">Because here we are already familiar with the structure of the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7652" target="_blank">02:07:32.940</a></span> | <span class="t">Hopefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7653" target="_blank">02:07:33.740</a></span> | <span class="t">So I am not repeating all the shapes here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7655" target="_blank">02:07:35.900</a></span> | <span class="t">We apply the first linear of the feed forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7663" target="_blank">02:07:43.900</a></span> | <span class="t">Then as activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7667" target="_blank">02:07:47.980</a></span> | <span class="t">We use the GLUE function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7669" target="_blank">02:07:49.740</a></span> | <span class="t">And actually we call the quick GLUE function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7673" target="_blank">02:07:53.100</a></span> | <span class="t">Which is defined like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7676" target="_blank">02:07:56.540</a></span> | <span class="t">X multiplied by torch dot sigmoid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7679" target="_blank">02:07:59.980</a></span> | <span class="t">Of 1.702 multiplied by x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7685" target="_blank">02:08:05.100</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7689" target="_blank">02:08:09.260</a></span> | <span class="t">Should be like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7690" target="_blank">02:08:10.140</a></span> | <span class="t">So this is called the quick GLUE activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7696" target="_blank">02:08:16.940</a></span> | <span class="t">Also here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7697" target="_blank">02:08:17.500</a></span> | <span class="t">There is no justification on why we should use this one and not another one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7703" target="_blank">02:08:23.420</a></span> | <span class="t">They just saw that in practice this one works better for this kind of application.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7707" target="_blank">02:08:27.100</a></span> | <span class="t">So that's why we are using this function here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7709" target="_blank">02:08:29.340</a></span> | <span class="t">So now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7711" target="_blank">02:08:31.100</a></span> | <span class="t">And then we apply the residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7717" target="_blank">02:08:37.900</a></span> | <span class="t">And finally we return x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7720" target="_blank">02:08:40.380</a></span> | <span class="t">This is exactly like the feed forward layer of the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7724" target="_blank">02:08:44.940</a></span> | <span class="t">Except that in the transformer we don't have this activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7727" target="_blank">02:08:47.580</a></span> | <span class="t">But we have the RELU function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7728" target="_blank">02:08:48.780</a></span> | <span class="t">And if you remember in LLAMA we don't have the RELU function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7732" target="_blank">02:08:52.460</a></span> | <span class="t">We have the ZWIGLUE function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7734" target="_blank">02:08:54.300</a></span> | <span class="t">But here we are using the quick GLUE function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7736" target="_blank">02:08:56.940</a></span> | <span class="t">Which I actually am not so familiar with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7738" target="_blank">02:08:58.780</a></span> | <span class="t">But I think that it works good for this model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7742" target="_blank">02:09:02.940</a></span> | <span class="t">And they just kept it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7743" target="_blank">02:09:03.820</a></span> | <span class="t">So now we have built our text encoder here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7748" target="_blank">02:09:08.060</a></span> | <span class="t">CLIP.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7748" target="_blank">02:09:08.460</a></span> | <span class="t">Which is very small as you can see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7749" target="_blank">02:09:09.980</a></span> | <span class="t">And our next thing to build is our unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7755" target="_blank">02:09:15.900</a></span> | <span class="t">So we have built the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7758" target="_blank">02:09:18.780</a></span> | <span class="t">The encoder part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7759" target="_blank">02:09:19.900</a></span> | <span class="t">And the decoder part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7761" target="_blank">02:09:21.580</a></span> | <span class="t">Now the next thing we have to build is this unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7765" target="_blank">02:09:25.340</a></span> | <span class="t">As you remember the unit is the network that will give some noisified image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7771" target="_blank">02:09:31.900</a></span> | <span class="t">And the amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7773" target="_blank">02:09:33.420</a></span> | <span class="t">And we also indicated to the network what is the amount of noise that we added to this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7778" target="_blank">02:09:38.940</a></span> | <span class="t">The model has to predict how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7783" target="_blank">02:09:43.740</a></span> | <span class="t">And how to remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7784" target="_blank">02:09:44.700</a></span> | <span class="t">And this unit is a bunch of convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7789" target="_blank">02:09:49.660</a></span> | <span class="t">That will reduce the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7792" target="_blank">02:09:52.060</a></span> | <span class="t">As you can see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7792" target="_blank">02:09:52.700</a></span> | <span class="t">With each step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7794" target="_blank">02:09:54.620</a></span> | <span class="t">But by increasing the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7798" target="_blank">02:09:58.540</a></span> | <span class="t">So we reduce the size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7799" target="_blank">02:09:59.580</a></span> | <span class="t">But we increase exactly what we did in the encoder of the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7804" target="_blank">02:10:04.700</a></span> | <span class="t">And then we do the reverse steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7807" target="_blank">02:10:07.740</a></span> | <span class="t">Just like we did with the decoder of the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7810" target="_blank">02:10:10.540</a></span> | <span class="t">So now again we will work with some convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7813" target="_blank">02:10:13.900</a></span> | <span class="t">With the residual blocks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7815" target="_blank">02:10:15.100</a></span> | <span class="t">With attentions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7816" target="_blank">02:10:16.060</a></span> | <span class="t">Etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7817" target="_blank">02:10:17.260</a></span> | <span class="t">The one big difference is that we need to tell our unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7821" target="_blank">02:10:21.100</a></span> | <span class="t">Not only the image that is already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7824" target="_blank">02:10:24.060</a></span> | <span class="t">So what is the image with noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7826" target="_blank">02:10:26.620</a></span> | <span class="t">Not only the amount of noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7829" target="_blank">02:10:29.500</a></span> | <span class="t">So the time step at which this noise was added.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7832" target="_blank">02:10:32.540</a></span> | <span class="t">But also the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7834" target="_blank">02:10:34.540</a></span> | <span class="t">Because as you remember we need to also tell this unit what is our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7840" target="_blank">02:10:40.060</a></span> | <span class="t">Because we need to tell him how we want our output image to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7844" target="_blank">02:10:44.940</a></span> | <span class="t">Because there are many ways to deny the initial noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7847" target="_blank">02:10:47.660</a></span> | <span class="t">So if we want the initial noise to become a dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7850" target="_blank">02:10:50.460</a></span> | <span class="t">We need to tell him we want a dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7852" target="_blank">02:10:52.140</a></span> | <span class="t">If we want the initial noise to become a cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7853" target="_blank">02:10:53.900</a></span> | <span class="t">We need to tell him we want a cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7856" target="_blank">02:10:56.140</a></span> | <span class="t">So the unit has to know what is the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7858" target="_blank">02:10:58.620</a></span> | <span class="t">And also he has to relate this prompt with the rest of the information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7863" target="_blank">02:11:03.180</a></span> | <span class="t">And what is the best way to combine two different stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7867" target="_blank">02:11:07.580</a></span> | <span class="t">So for example an image with text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7870" target="_blank">02:11:10.220</a></span> | <span class="t">We will use what is called the cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7873" target="_blank">02:11:13.660</a></span> | <span class="t">Cross attention basically allows us to calculate the attention between two sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7878" target="_blank">02:11:18.460</a></span> | <span class="t">In which the query is the first sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7881" target="_blank">02:11:21.980</a></span> | <span class="t">And the keys and the values are coming from another sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7885" target="_blank">02:11:25.340</a></span> | <span class="t">So let's go build it and let's see how this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7888" target="_blank">02:11:28.060</a></span> | <span class="t">Now the first thing we will do is create a new class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7893" target="_blank">02:11:33.740</a></span> | <span class="t">New file here called diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7896" target="_blank">02:11:36.140</a></span> | <span class="t">Because this will be our diffusion model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7899" target="_blank">02:11:39.900</a></span> | <span class="t">And I think also here I will build from top down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7904" target="_blank">02:11:44.860</a></span> | <span class="t">So we first define the diffusion class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7907" target="_blank">02:11:47.820</a></span> | <span class="t">And then we build each block one by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7909" target="_blank">02:11:49.740</a></span> | <span class="t">Let's start by importing the usual libraries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7913" target="_blank">02:11:53.900</a></span> | <span class="t">So import torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7923" target="_blank">02:12:03.100</a></span> | <span class="t">From torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7930" target="_blank">02:12:10.380</a></span> | <span class="t">And then we import the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7935" target="_blank">02:12:15.420</a></span> | <span class="t">The self attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7939" target="_blank">02:12:19.340</a></span> | <span class="t">But also we will need the cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7942" target="_blank">02:12:22.460</a></span> | <span class="t">Attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7944" target="_blank">02:12:24.620</a></span> | <span class="t">And later we will build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7945" target="_blank">02:12:25.740</a></span> | <span class="t">Then let's create the class diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7952" target="_blank">02:12:32.940</a></span> | <span class="t">The class diffusion is basically our unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7954" target="_blank">02:12:34.860</a></span> | <span class="t">This is made of time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7966" target="_blank">02:12:46.140</a></span> | <span class="t">So something that we will define it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7970" target="_blank">02:12:50.780</a></span> | <span class="t">Time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7972" target="_blank">02:12:52.220</a></span> | <span class="t">320 which is the size of the time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7976" target="_blank">02:12:56.140</a></span> | <span class="t">So because we need to give the unit not only the noisified image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7980" target="_blank">02:13:00.700</a></span> | <span class="t">But also the time step at which it was noisified.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7983" target="_blank">02:13:03.500</a></span> | <span class="t">So the image, the unit needs some way to understand this time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7990" target="_blank">02:13:10.300</a></span> | <span class="t">So this is why this time step which is a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7992" target="_blank">02:13:12.540</a></span> | <span class="t">Will be converted into an embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7994" target="_blank">02:13:14.620</a></span> | <span class="t">By using this particular module called time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7997" target="_blank">02:13:17.260</a></span> | <span class="t">And later we will see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=7998" target="_blank">02:13:18.220</a></span> | <span class="t">Then we build the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8001" target="_blank">02:13:21.340</a></span> | <span class="t">And then the output layer of the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8007" target="_blank">02:13:27.180</a></span> | <span class="t">And later we will see what is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8009" target="_blank">02:13:29.660</a></span> | <span class="t">This output layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8010" target="_blank">02:13:30.620</a></span> | <span class="t">Put layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8013" target="_blank">02:13:33.500</a></span> | <span class="t">Later we will see how to build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8017" target="_blank">02:13:37.100</a></span> | <span class="t">Let's do the forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8019" target="_blank">02:13:39.020</a></span> | <span class="t">As you remember the unit will receive the latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8025" target="_blank">02:13:45.740</a></span> | <span class="t">So this Z which is a latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8028" target="_blank">02:13:48.220</a></span> | <span class="t">Is the output of the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8030" target="_blank">02:13:50.460</a></span> | <span class="t">So this latent which is a torch dot tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8033" target="_blank">02:13:53.020</a></span> | <span class="t">It will receive the context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8035" target="_blank">02:13:55.260</a></span> | <span class="t">What is the context?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8036" target="_blank">02:13:56.380</a></span> | <span class="t">Is our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8037" target="_blank">02:13:57.340</a></span> | <span class="t">Which is also a torch dot tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8040" target="_blank">02:14:00.620</a></span> | <span class="t">And it will receive the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8042" target="_blank">02:14:02.460</a></span> | <span class="t">At which this latent was noisified.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8044" target="_blank">02:14:04.700</a></span> | <span class="t">Which is also.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8047" target="_blank">02:14:07.020</a></span> | <span class="t">I don't remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8047" target="_blank">02:14:07.740</a></span> | <span class="t">I think it's a tensor also.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8049" target="_blank">02:14:09.660</a></span> | <span class="t">Later I define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8052" target="_blank">02:14:12.860</a></span> | <span class="t">Okay yeah it's tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8055" target="_blank">02:14:15.580</a></span> | <span class="t">Okay let's define the sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8061" target="_blank">02:14:21.420</a></span> | <span class="t">So the latent here is batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8065" target="_blank">02:14:25.500</a></span> | <span class="t">4 because 4 is the output of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8068" target="_blank">02:14:28.380</a></span> | <span class="t">If you remember correctly here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8069" target="_blank">02:14:29.740</a></span> | <span class="t">4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8070" target="_blank">02:14:30.780</a></span> | <span class="t">Closing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8073" target="_blank">02:14:33.500</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8073" target="_blank">02:14:33.740</a></span> | <span class="t">Grid and width divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8078" target="_blank">02:14:38.620</a></span> | <span class="t">Then we have the context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8081" target="_blank">02:14:41.180</a></span> | <span class="t">Which is our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8082" target="_blank">02:14:42.300</a></span> | <span class="t">Which we already converted with the clip encoder here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8086" target="_blank">02:14:46.540</a></span> | <span class="t">Which will be batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8088" target="_blank">02:14:48.940</a></span> | <span class="t">By sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8090" target="_blank">02:14:50.140</a></span> | <span class="t">By dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8090" target="_blank">02:14:50.860</a></span> | <span class="t">Where the dimension is 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8093" target="_blank">02:14:53.020</a></span> | <span class="t">Like we defined before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8094" target="_blank">02:14:54.540</a></span> | <span class="t">And the time will be another.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8095" target="_blank">02:14:55.820</a></span> | <span class="t">We will define it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8098" target="_blank">02:14:58.460</a></span> | <span class="t">How it's defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8099" target="_blank">02:14:59.580</a></span> | <span class="t">How it's built.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8100" target="_blank">02:15:00.300</a></span> | <span class="t">But it's each embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8103" target="_blank">02:15:03.020</a></span> | <span class="t">It's a number with an embedding of size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8105" target="_blank">02:15:05.180</a></span> | <span class="t">It's a vector of a size of 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8107" target="_blank">02:15:07.820</a></span> | <span class="t">The first thing we do is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8111" target="_blank">02:15:11.260</a></span> | <span class="t">We convert this time into an embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8113" target="_blank">02:15:13.180</a></span> | <span class="t">And actually this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8117" target="_blank">02:15:17.020</a></span> | <span class="t">We will see later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8117" target="_blank">02:15:17.820</a></span> | <span class="t">That it's actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8118" target="_blank">02:15:18.700</a></span> | <span class="t">Just like the positional encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8120" target="_blank">02:15:20.940</a></span> | <span class="t">Of the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8123" target="_blank">02:15:23.180</a></span> | <span class="t">It's actually a number that is multiplied by.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8126" target="_blank">02:15:26.540</a></span> | <span class="t">Sines and cosines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8128" target="_blank">02:15:28.860</a></span> | <span class="t">Just like in the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8130" target="_blank">02:15:30.940</a></span> | <span class="t">Because they saw that it works for the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8133" target="_blank">02:15:33.500</a></span> | <span class="t">So we can also use the same positional encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8135" target="_blank">02:15:35.820</a></span> | <span class="t">To convey the information of the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8137" target="_blank">02:15:37.980</a></span> | <span class="t">Which is actually kind of an information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8139" target="_blank">02:15:39.980</a></span> | <span class="t">About position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8140" target="_blank">02:15:40.780</a></span> | <span class="t">So it tells the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8142" target="_blank">02:15:42.300</a></span> | <span class="t">At which step we arrived in the denoisification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8148" target="_blank">02:15:48.460</a></span> | <span class="t">So this one will convert tensor of one 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8153" target="_blank">02:15:53.260</a></span> | <span class="t">Into a tensor of one one two eight zero one thousand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8157" target="_blank">02:15:57.740</a></span> | <span class="t">The unit will convert our latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8163" target="_blank">02:16:03.180</a></span> | <span class="t">Into another latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8164" target="_blank">02:16:04.620</a></span> | <span class="t">So it will not change the size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8171" target="_blank">02:16:11.500</a></span> | <span class="t">Batch for height this is the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8178" target="_blank">02:16:18.780</a></span> | <span class="t">Of the variation of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8180" target="_blank">02:16:20.140</a></span> | <span class="t">Which first becomes batch 320 features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8190" target="_blank">02:16:30.060</a></span> | <span class="t">Through this the unit so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8199" target="_blank">02:16:39.900</a></span> | <span class="t">So why here we have more features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8205" target="_blank">02:16:45.020</a></span> | <span class="t">Than the starting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8205" target="_blank">02:16:45.900</a></span> | <span class="t">Because let's review here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8207" target="_blank">02:16:47.420</a></span> | <span class="t">As you can see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8208" target="_blank">02:16:48.140</a></span> | <span class="t">The last layer of the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8210" target="_blank">02:16:50.940</a></span> | <span class="t">Actually we need to go back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8213" target="_blank">02:16:53.660</a></span> | <span class="t">To the same number of the features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8217" target="_blank">02:16:57.340</a></span> | <span class="t">You can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8218" target="_blank">02:16:58.060</a></span> | <span class="t">So here we start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8219" target="_blank">02:16:59.820</a></span> | <span class="t">Actually the dimensions here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8221" target="_blank">02:17:01.260</a></span> | <span class="t">Don't match what we will be using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8222" target="_blank">02:17:02.620</a></span> | <span class="t">So this is the original unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8224" target="_blank">02:17:04.300</a></span> | <span class="t">But the one used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8225" target="_blank">02:17:05.180</a></span> | <span class="t">By stable diffusion is a modified unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8228" target="_blank">02:17:08.380</a></span> | <span class="t">So in the last.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8229" target="_blank">02:17:09.580</a></span> | <span class="t">When we build the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8231" target="_blank">02:17:11.260</a></span> | <span class="t">The decoder will not build.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8232" target="_blank">02:17:12.700</a></span> | <span class="t">The final number of features that we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8235" target="_blank">02:17:15.100</a></span> | <span class="t">Which is four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8236" target="_blank">02:17:16.140</a></span> | <span class="t">But we need an additional output layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8238" target="_blank">02:17:18.060</a></span> | <span class="t">To go back to the original size of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8240" target="_blank">02:17:20.700</a></span> | <span class="t">And this is the job of this output layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8243" target="_blank">02:17:23.100</a></span> | <span class="t">So later we will see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8245" target="_blank">02:17:25.580</a></span> | <span class="t">When we build this this layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8248" target="_blank">02:17:28.140</a></span> | <span class="t">So output is equal to self dot final.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8250" target="_blank">02:17:30.860</a></span> | <span class="t">This one will go from this size here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8255" target="_blank">02:17:35.580</a></span> | <span class="t">To back to the original size of the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8262" target="_blank">02:17:42.540</a></span> | <span class="t">Because the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8264" target="_blank">02:17:44.940</a></span> | <span class="t">His job is to take in latents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8267" target="_blank">02:17:47.900</a></span> | <span class="t">Predict how much noise is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8269" target="_blank">02:17:49.900</a></span> | <span class="t">Then take again the same latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8271" target="_blank">02:17:51.900</a></span> | <span class="t">Predict how much noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8273" target="_blank">02:17:53.020</a></span> | <span class="t">We remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8274" target="_blank">02:17:54.140</a></span> | <span class="t">We remove the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8275" target="_blank">02:17:55.020</a></span> | <span class="t">Then again we give another latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8277" target="_blank">02:17:57.020</a></span> | <span class="t">We predict how much noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8278" target="_blank">02:17:58.220</a></span> | <span class="t">We remove the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8279" target="_blank">02:17:59.180</a></span> | <span class="t">We give another latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8281" target="_blank">02:18:01.100</a></span> | <span class="t">We predict the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8281" target="_blank">02:18:01.900</a></span> | <span class="t">We remove the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8282" target="_blank">02:18:02.620</a></span> | <span class="t">Etc, etc, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8284" target="_blank">02:18:04.060</a></span> | <span class="t">So the output dimension must match the input dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8286" target="_blank">02:18:06.460</a></span> | <span class="t">And then we return the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8289" target="_blank">02:18:09.660</a></span> | <span class="t">Which is the latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8293" target="_blank">02:18:13.100</a></span> | <span class="t">Like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8295" target="_blank">02:18:15.360</a></span> | <span class="t">Let's build first the time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8298" target="_blank">02:18:18.540</a></span> | <span class="t">I think it's easy to build.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8299" target="_blank">02:18:19.740</a></span> | <span class="t">So something that encodes information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8303" target="_blank">02:18:23.580</a></span> | <span class="t">About the time step in which we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8306" target="_blank">02:18:26.060</a></span> | <span class="t">[TYPING SOUNDS]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8308" target="_blank">02:18:28.940</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8320" target="_blank">02:18:40.320</a></span> | <span class="t">It is made of two linear layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8325" target="_blank">02:18:45.740</a></span> | <span class="t">Nothing fancy here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8326" target="_blank">02:18:46.860</a></span> | <span class="t">Linear one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8334" target="_blank">02:18:54.460</a></span> | <span class="t">Which will map it to 4 by n embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8338" target="_blank">02:18:58.060</a></span> | <span class="t">And then linear two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8339" target="_blank">02:18:59.900</a></span> | <span class="t">4 by n embedding into 4 by n embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8351" target="_blank">02:19:11.180</a></span> | <span class="t">And now you understand why it becomes 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8355" target="_blank">02:19:15.180</a></span> | <span class="t">Which is 4 times 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8358" target="_blank">02:19:18.300</a></span> | <span class="t">[TYPING SOUNDS]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8361" target="_blank">02:19:21.340</a></span> | <span class="t">This one returns to a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8367" target="_blank">02:19:27.580</a></span> | <span class="t">So the input size is 1320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8372" target="_blank">02:19:32.300</a></span> | <span class="t">What we do is first we apply this first layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8376" target="_blank">02:19:36.380</a></span> | <span class="t">Linear one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8378" target="_blank">02:19:38.300</a></span> | <span class="t">Then we apply the silo function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8380" target="_blank">02:19:40.700</a></span> | <span class="t">Then we apply again the second linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8385" target="_blank">02:19:45.900</a></span> | <span class="t">[TYPING SOUNDS]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8389" target="_blank">02:19:49.900</a></span> | <span class="t">And then we return it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8391" target="_blank">02:19:51.100</a></span> | <span class="t">Nothing special here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8392" target="_blank">02:19:52.540</a></span> | <span class="t">The output dimension is 1 by 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8398" target="_blank">02:19:58.220</a></span> | <span class="t">[TYPING SOUNDS]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8401" target="_blank">02:20:01.020</a></span> | <span class="t">280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8402" target="_blank">02:20:02.220</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8404" target="_blank">02:20:04.560</a></span> | <span class="t">The next thing we need to build is the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8406" target="_blank">02:20:06.860</a></span> | <span class="t">The unit will require many blocks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8410" target="_blank">02:20:10.860</a></span> | <span class="t">So let's first build the unit itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8413" target="_blank">02:20:13.660</a></span> | <span class="t">And then we build each of the blocks that it will require.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8416" target="_blank">02:20:16.220</a></span> | <span class="t">So class unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8419" target="_blank">02:20:19.500</a></span> | <span class="t">[TYPING SOUNDS]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8436" target="_blank">02:20:36.380</a></span> | <span class="t">As you can see, the unit is made up of one encoder branch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8440" target="_blank">02:20:40.060</a></span> | <span class="t">So this is like the encoder of the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8444" target="_blank">02:20:44.140</a></span> | <span class="t">Things go down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8445" target="_blank">02:20:45.340</a></span> | <span class="t">So the image becomes smaller, smaller, smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8447" target="_blank">02:20:47.500</a></span> | <span class="t">But the channels keep increasing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8449" target="_blank">02:20:49.420</a></span> | <span class="t">The features keep increasing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8451" target="_blank">02:20:51.020</a></span> | <span class="t">Then we have this bottleneck layer here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8453" target="_blank">02:20:53.500</a></span> | <span class="t">It's called bottleneck.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8454" target="_blank">02:20:54.860</a></span> | <span class="t">And then we have a decoder part here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8457" target="_blank">02:20:57.180</a></span> | <span class="t">So it becomes original size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8458" target="_blank">02:20:58.860</a></span> | <span class="t">The image from the very small size becomes the original size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8462" target="_blank">02:21:02.700</a></span> | <span class="t">And then we have these skip connections between the encoder and the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8467" target="_blank">02:21:07.020</a></span> | <span class="t">So the output of each layer of each step of the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8472" target="_blank">02:21:12.460</a></span> | <span class="t">is connected to the same step of the decoder on the other side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8475" target="_blank">02:21:15.820</a></span> | <span class="t">And you will see this one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8479" target="_blank">02:21:19.500</a></span> | <span class="t">So we start building the left side, which is the encoders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8482" target="_blank">02:21:22.380</a></span> | <span class="t">Which is a list of modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8485" target="_blank">02:21:25.100</a></span> | <span class="t">And to build these encoders, we need to define a special layer, basically, that will apply...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8497" target="_blank">02:21:37.980</a></span> | <span class="t">Okay, let's build it and then I will describe it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8500" target="_blank">02:21:40.940</a></span> | <span class="t">SwitchSequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8508" target="_blank">02:21:48.060</a></span> | <span class="t">And basically, this switchSequential, given a list of layers, will apply them one by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8525" target="_blank">02:22:05.340</a></span> | <span class="t">So we can think of it as a sequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8527" target="_blank">02:22:07.580</a></span> | <span class="t">But it can recognize what are the parameters of each of them and will apply accordingly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8534" target="_blank">02:22:14.860</a></span> | <span class="t">So after I define it, it will be more clear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8537" target="_blank">02:22:17.180</a></span> | <span class="t">So first we have, just like before, a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8540" target="_blank">02:22:20.300</a></span> | <span class="t">Because we want to increase the number of channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8543" target="_blank">02:22:23.100</a></span> | <span class="t">So as you can see, at the beginning, we increase the number of channels of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8546" target="_blank">02:22:26.860</a></span> | <span class="t">Here it's 64, but we go directly to 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8549" target="_blank">02:22:29.900</a></span> | <span class="t">And then we have another one of this switchSequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8556" target="_blank">02:22:36.540</a></span> | <span class="t">Which is a unit residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8561" target="_blank">02:22:41.660</a></span> | <span class="t">We define it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8564" target="_blank">02:22:44.700</a></span> | <span class="t">But it's very similar to the residual block that we built already for the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8570" target="_blank">02:22:50.460</a></span> | <span class="t">And then we have an attention block, which is also very similar to the attention block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8574" target="_blank">02:22:54.300</a></span> | <span class="t">that we built for the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8583" target="_blank">02:23:03.900</a></span> | <span class="t">Then we have-- OK, I think it's better to build this switchSequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8587" target="_blank">02:23:07.740</a></span> | <span class="t">Otherwise, we have too many-- yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8589" target="_blank">02:23:09.500</a></span> | <span class="t">Let's build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8591" target="_blank">02:23:11.980</a></span> | <span class="t">It's very simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8592" target="_blank">02:23:12.700</a></span> | <span class="t">As you can see, it's a sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8601" target="_blank">02:23:21.260</a></span> | <span class="t">But given x, which is our latent, which is a torch.tensor, our context, so our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8613" target="_blank">02:23:33.580</a></span> | <span class="t">And the time, which is also a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8616" target="_blank">02:23:36.540</a></span> | <span class="t">We'll apply them one by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8622" target="_blank">02:23:42.380</a></span> | <span class="t">But based on what they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8629" target="_blank">02:23:49.340</a></span> | <span class="t">So if the layer is a unit attention block, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8632" target="_blank">02:23:52.460</a></span> | <span class="t">It will apply it like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8637" target="_blank">02:23:57.180</a></span> | <span class="t">So layer of x and context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8639" target="_blank">02:23:59.500</a></span> | <span class="t">Why?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8640" target="_blank">02:24:00.620</a></span> | <span class="t">Because this attention block basically will compute the cross-attention between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8644" target="_blank">02:24:04.060</a></span> | <span class="t">our latent and the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8645" target="_blank">02:24:05.980</a></span> | <span class="t">This is why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8646" target="_blank">02:24:06.620</a></span> | <span class="t">This residual block will compute-- will match our latent with its time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8662" target="_blank">02:24:22.860</a></span> | <span class="t">And then if it's any other layer, we just apply it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8667" target="_blank">02:24:27.100</a></span> | <span class="t">And then we return, but after the for a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8674" target="_blank">02:24:34.300</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8674" target="_blank">02:24:34.540</a></span> | <span class="t">So this is-- now we understood this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8677" target="_blank">02:24:37.020</a></span> | <span class="t">We just need to define this residual block and this attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8680" target="_blank">02:24:40.220</a></span> | <span class="t">Then we have another sequence-- sequential switch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8688" target="_blank">02:24:48.300</a></span> | <span class="t">This one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8689" target="_blank">02:24:49.020</a></span> | <span class="t">So the code I'm writing actually is based on a repository.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8695" target="_blank">02:24:55.580</a></span> | <span class="t">Upon which actually most of the code I wrote is based on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8699" target="_blank">02:24:59.100</a></span> | <span class="t">Which is in turn based on another repository,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8701" target="_blank">02:25:01.180</a></span> | <span class="t">which was originally written for TensorFlow, if I remember correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8704" target="_blank">02:25:04.460</a></span> | <span class="t">So actually, the code for stable diffusion-- because it's a model that is built by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8711" target="_blank">02:25:11.500</a></span> | <span class="t">Comfit's group at the LMU University, of course, it cannot be different from that code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8715" target="_blank">02:25:15.740</a></span> | <span class="t">So most of the code are actually similar to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8719" target="_blank">02:25:19.020</a></span> | <span class="t">I mean, you cannot create the same model and change the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8723" target="_blank">02:25:23.180</a></span> | <span class="t">Of course, the code will be similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8725" target="_blank">02:25:25.500</a></span> | <span class="t">So we again use this one-- switch sequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8731" target="_blank">02:25:31.740</a></span> | <span class="t">So here we are building the encoder side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8734" target="_blank">02:25:34.140</a></span> | <span class="t">So we are reducing the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8754" target="_blank">02:25:54.220</a></span> | <span class="t">Let me check where we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8756" target="_blank">02:25:56.220</a></span> | <span class="t">So we have the residual block of 320 to 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8760" target="_blank">02:26:00.940</a></span> | <span class="t">And then we have an attention block of 8 to 80.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8765" target="_blank">02:26:05.340</a></span> | <span class="t">And this attention block takes the number of head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8770" target="_blank">02:26:10.460</a></span> | <span class="t">This 8 indicates the number of head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8772" target="_blank">02:26:12.140</a></span> | <span class="t">And this indicates the embedding size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8774" target="_blank">02:26:14.780</a></span> | <span class="t">We will see later how we transform this, the output of this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8779" target="_blank">02:26:19.260</a></span> | <span class="t">into a sequence so that we can run attention on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8782" target="_blank">02:26:22.620</a></span> | <span class="t">OK, we have this sequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8786" target="_blank">02:26:26.460</a></span> | <span class="t">And then we have another one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8789" target="_blank">02:26:29.500</a></span> | <span class="t">Then we have another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8798" target="_blank">02:26:38.380</a></span> | <span class="t">Let me just copy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8802" target="_blank">02:26:42.140</a></span> | <span class="t">Convolution of size from 640 to 640 channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8809" target="_blank">02:26:49.660</a></span> | <span class="t">Kernel size 3, stride 2, padding 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8811" target="_blank">02:26:51.900</a></span> | <span class="t">Then we have another residual block that will again increase the features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8819" target="_blank">02:26:59.260</a></span> | <span class="t">So from 640 to 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8825" target="_blank">02:27:05.020</a></span> | <span class="t">And then we have an attention block of 8 heads and 160 is the embedding size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8835" target="_blank">02:27:15.820</a></span> | <span class="t">Then we have another residual block of 1280 and 8 and 160.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8848" target="_blank">02:27:28.860</a></span> | <span class="t">So as you can see, just like in the encoder of the variational autoencoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8851" target="_blank">02:27:31.980</a></span> | <span class="t">we, with these convolutions, we keep decreasing the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8858" target="_blank">02:27:38.940</a></span> | <span class="t">So actually here we started with the latent representation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8862" target="_blank">02:27:42.620</a></span> | <span class="t">which was height divided by 8 and height divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8867" target="_blank">02:27:47.180</a></span> | <span class="t">So let me write some shapes here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8869" target="_blank">02:27:49.100</a></span> | <span class="t">At least you need to understand the size changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8872" target="_blank">02:27:52.700</a></span> | <span class="t">So batch size for height divided by 8 and width divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8878" target="_blank">02:27:58.940</a></span> | <span class="t">When we apply this convolution, it will become divided by 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8884" target="_blank">02:28:04.460</a></span> | <span class="t">So it will become divided by 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8893" target="_blank">02:28:13.100</a></span> | <span class="t">So it will become a very small image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8897" target="_blank">02:28:17.020</a></span> | <span class="t">And after we apply the second one, it will become divided by 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8902" target="_blank">02:28:22.380</a></span> | <span class="t">So here we start from 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8907" target="_blank">02:28:27.100</a></span> | <span class="t">Here it will become divided by 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8912" target="_blank">02:28:32.380</a></span> | <span class="t">So what does it mean divided by 32?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8914" target="_blank">02:28:34.060</a></span> | <span class="t">That if the initial image was of size 512, the latent is of size 64 by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8920" target="_blank">02:28:40.220</a></span> | <span class="t">Then it becomes 32 by 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8923" target="_blank">02:28:43.340</a></span> | <span class="t">Now it has become 16 by 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8925" target="_blank">02:28:45.580</a></span> | <span class="t">And then we apply these residual connections.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8931" target="_blank">02:28:51.020</a></span> | <span class="t">And then we apply another convolutional layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8937" target="_blank">02:28:57.820</a></span> | <span class="t">which will reduce the size of the image further.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8941" target="_blank">02:29:01.660</a></span> | <span class="t">So from 32 here, divide by 32 and divide by 32 to divide by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8952" target="_blank">02:29:12.460</a></span> | <span class="t">Every time we divided the size of the image by 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8958" target="_blank">02:29:18.140</a></span> | <span class="t">And the number of features is 12801280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8965" target="_blank">02:29:25.500</a></span> | <span class="t">And then we have a unit residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8974" target="_blank">02:29:34.940</a></span> | <span class="t">So let me copy also this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8976" target="_blank">02:29:36.460</a></span> | <span class="t">Of 1280 and 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8986" target="_blank">02:29:46.060</a></span> | <span class="t">And then we have a last one, which is another one of the same size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8991" target="_blank">02:29:51.740</a></span> | <span class="t">So now we have an image that is 64 divided by 64 and divided by 64,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8997" target="_blank">02:29:57.340</a></span> | <span class="t">but with much more channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=8999" target="_blank">02:29:59.580</a></span> | <span class="t">I forgot to change the channel numbers here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9002" target="_blank">02:30:02.620</a></span> | <span class="t">So here is 1280 channels and divided by 64 divided by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9007" target="_blank">02:30:07.020</a></span> | <span class="t">And this one remains the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9009" target="_blank">02:30:09.420</a></span> | <span class="t">Because the residual connections don't change the size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9012" target="_blank">02:30:12.940</a></span> | <span class="t">Here should be 1280 to 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9020" target="_blank">02:30:20.860</a></span> | <span class="t">Here should be 640 to 640.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9025" target="_blank">02:30:25.020</a></span> | <span class="t">And here it should be 320 to 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9031" target="_blank">02:30:31.020</a></span> | <span class="t">So as I said before, we keep reducing the size of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9035" target="_blank">02:30:35.900</a></span> | <span class="t">but we keep increasing this number of features of each pixel basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9040" target="_blank">02:30:40.620</a></span> | <span class="t">Then we build the bottleneck,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9042" target="_blank">02:30:42.780</a></span> | <span class="t">which is this part here of the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9049" target="_blank">02:30:49.420</a></span> | <span class="t">This is a sequence of a residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9057" target="_blank">02:30:57.420</a></span> | <span class="t">Then we have the attention block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9066" target="_blank">02:31:06.940</a></span> | <span class="t">which will make a self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9071" target="_blank">02:31:11.100</a></span> | <span class="t">Sorry, not self-attention, cross-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9074" target="_blank">02:31:14.380</a></span> | <span class="t">And then we have another residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9076" target="_blank">02:31:16.540</a></span> | <span class="t">And then we have the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9084" target="_blank">02:31:24.140</a></span> | <span class="t">So in the decoder, we will do the opposite of what we did in the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9087" target="_blank">02:31:27.660</a></span> | <span class="t">So we will reduce the number of features, but increase the image size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9096" target="_blank">02:31:36.700</a></span> | <span class="t">Again, let's start with our beautiful switch sequential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9104" target="_blank">02:31:44.860</a></span> | <span class="t">So we have 2560 to 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9114" target="_blank">02:31:54.620</a></span> | <span class="t">Why here is 2560 even if after the bottleneck we have 1280?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9122" target="_blank">02:32:02.940</a></span> | <span class="t">So we are talking about this part here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9126" target="_blank">02:32:06.460</a></span> | <span class="t">So after the input of the decoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9131" target="_blank">02:32:11.420</a></span> | <span class="t">so this side here of the unit is the output of the bottleneck.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9136" target="_blank">02:32:16.060</a></span> | <span class="t">But the bottleneck is outputting 1280 features,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9140" target="_blank">02:32:20.140</a></span> | <span class="t">while the encoder is expecting 2560, so double the amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9145" target="_blank">02:32:25.180</a></span> | <span class="t">Why? Because we need to consider that we have this skip connection here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9149" target="_blank">02:32:29.020</a></span> | <span class="t">So this skip connection will double the amount at each layer here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9153" target="_blank">02:32:33.020</a></span> | <span class="t">And this is why the input we expect here is double the size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9156" target="_blank">02:32:36.540</a></span> | <span class="t">of what is the output of the previous layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9159" target="_blank">02:32:39.420</a></span> | <span class="t">Let me write some shapes also here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9160" target="_blank">02:32:40.940</a></span> | <span class="t">So batch size 2560.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9164" target="_blank">02:32:44.140</a></span> | <span class="t">The image is very small, so height by end width divided by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9169" target="_blank">02:32:49.660</a></span> | <span class="t">And it will become 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9179" target="_blank">02:32:59.260</a></span> | <span class="t">Then we apply another switch sequential of the same size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9189" target="_blank">02:33:09.260</a></span> | <span class="t">Then we apply another one with an upsample,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9192" target="_blank">02:33:12.060</a></span> | <span class="t">just like we did in the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9194" target="_blank">02:33:14.140</a></span> | <span class="t">So if you remember in the variational autoencoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9196" target="_blank">02:33:16.300</a></span> | <span class="t">to increase the size of the image we do upsampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9199" target="_blank">02:33:19.660</a></span> | <span class="t">And this is what we do exactly here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9201" target="_blank">02:33:21.260</a></span> | <span class="t">We do upsample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9203" target="_blank">02:33:23.420</a></span> | <span class="t">But this is not the upsample that we did exactly the same,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9208" target="_blank">02:33:28.780</a></span> | <span class="t">but the concept is similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9210" target="_blank">02:33:30.620</a></span> | <span class="t">And we will define it later also, this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9216" target="_blank">02:33:36.620</a></span> | <span class="t">So we have another residual with attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9219" target="_blank">02:33:39.100</a></span> | <span class="t">So we have a residual of 2000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9222" target="_blank">02:33:42.140</a></span> | <span class="t">And then we have an attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9225" target="_blank">02:33:45.260</a></span> | <span class="t">8 by 160.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9232" target="_blank">02:33:52.780</a></span> | <span class="t">Then we have again this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9237" target="_blank">02:33:57.020</a></span> | <span class="t">Then we have another one with an attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9243" target="_blank">02:34:03.900</a></span> | <span class="t">Then we have another one with upsampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9248" target="_blank">02:34:08.220</a></span> | <span class="t">So we have 9020.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9252" target="_blank">02:34:12.300</a></span> | <span class="t">And then we have an upsample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9259" target="_blank">02:34:19.740</a></span> | <span class="t">This one is small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9268" target="_blank">02:34:28.700</a></span> | <span class="t">So I know that I'm not writing all the shapes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9272" target="_blank">02:34:32.380</a></span> | <span class="t">but otherwise it's a really tiring job and very long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9277" target="_blank">02:34:37.180</a></span> | <span class="t">So just remember that we are keep increasing the size of the image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9281" target="_blank">02:34:41.100</a></span> | <span class="t">but we will decrease the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9284" target="_blank">02:34:44.380</a></span> | <span class="t">Later we will see that this number here will become very small,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9287" target="_blank">02:34:47.580</a></span> | <span class="t">and the size of the image will become nearly to the normal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9290" target="_blank">02:34:50.700</a></span> | <span class="t">Then we have another one with attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9297" target="_blank">02:34:57.580</a></span> | <span class="t">So as you can see, we are decreasing the features here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9305" target="_blank">02:35:05.820</a></span> | <span class="t">Then we have 8 by 80, and we are increasing also here the size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9312" target="_blank">02:35:12.380</a></span> | <span class="t">Then we have another one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9315" target="_blank">02:35:15.420</a></span> | <span class="t">And 880.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9323" target="_blank">02:35:23.180</a></span> | <span class="t">Then we have another one with upsampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9326" target="_blank">02:35:26.060</a></span> | <span class="t">So we increase the size of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9328" target="_blank">02:35:28.140</a></span> | <span class="t">So 960 to 640.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9334" target="_blank">02:35:34.540</a></span> | <span class="t">8 heads with the dimensions embedding size of 80,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9339" target="_blank">02:35:39.100</a></span> | <span class="t">and the upsampling with 640 features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9343" target="_blank">02:35:43.100</a></span> | <span class="t">And then we have another residual block with attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9347" target="_blank">02:35:47.580</a></span> | <span class="t">40.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9358" target="_blank">02:35:58.620</a></span> | <span class="t">Then we have another one, which is a 640, 320, 840.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9369" target="_blank">02:36:09.580</a></span> | <span class="t">And finally, the last one, we have 640 by 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9377" target="_blank">02:36:17.900</a></span> | <span class="t">And 8 and 40.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9379" target="_blank">02:36:19.980</a></span> | <span class="t">This dimension here is the same that will be applied by the output of the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9388" target="_blank">02:36:28.540</a></span> | <span class="t">as you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9389" target="_blank">02:36:29.340</a></span> | <span class="t">This one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9391" target="_blank">02:36:31.180</a></span> | <span class="t">And then we will give it to the final layer to build the original latent size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9394" target="_blank">02:36:34.620</a></span> | <span class="t">Okay, let's build all these blocks that we didn't build before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9402" target="_blank">02:36:42.380</a></span> | <span class="t">So first, let's build the upsample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9405" target="_blank">02:36:45.900</a></span> | <span class="t">Let's build it here, which is exactly the same as the two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9414" target="_blank">02:36:54.300</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9416" target="_blank">02:36:56.300</a></span> | <span class="t">We have this convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9430" target="_blank">02:37:10.300</a></span> | <span class="t">Without changing the number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9438" target="_blank">02:37:18.300</a></span> | <span class="t">And this is also doesn't change the size of the image, actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9448" target="_blank">02:37:28.700</a></span> | <span class="t">So we will go from batch channels or features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9456" target="_blank">02:37:36.700</a></span> | <span class="t">Let's call it features height width to batch size features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9466" target="_blank">02:37:46.380</a></span> | <span class="t">Height multiplied by 2 and width multiplied by 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9471" target="_blank">02:37:51.020</a></span> | <span class="t">Why?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9471" target="_blank">02:37:51.660</a></span> | <span class="t">Because we are going to use the upsampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9474" target="_blank">02:37:54.300</a></span> | <span class="t">This interpolation that we will do now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9478" target="_blank">02:37:58.380</a></span> | <span class="t">Interpolate x scale factor equal to mode is equal to nearest is the same operation that we did here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9488" target="_blank">02:38:08.860</a></span> | <span class="t">The same operation here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9490" target="_blank">02:38:10.940</a></span> | <span class="t">It will double the size, basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9494" target="_blank">02:38:14.540</a></span> | <span class="t">And then we apply a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9497" target="_blank">02:38:17.900</a></span> | <span class="t">Now, we have to define the final block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9506" target="_blank">02:38:26.700</a></span> | <span class="t">And we also have to define for the output layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9510" target="_blank">02:38:30.380</a></span> | <span class="t">And we also have to define the attention block and the residual block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9513" target="_blank">02:38:33.260</a></span> | <span class="t">So let's build first this output layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9516" target="_blank">02:38:36.380</a></span> | <span class="t">It's easier to build.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9527" target="_blank">02:38:47.580</a></span> | <span class="t">So let's... this one also has a group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9545" target="_blank">02:39:05.260</a></span> | <span class="t">Again, with the 32 size of the group 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9548" target="_blank">02:39:08.220</a></span> | <span class="t">Also has a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9552" target="_blank">02:39:12.620</a></span> | <span class="t">And the padding of 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9560" target="_blank">02:39:20.780</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9565" target="_blank">02:39:25.840</a></span> | <span class="t">The final layer needs to convert this shape into this shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9571" target="_blank">02:39:31.500</a></span> | <span class="t">So 320 features into 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9573" target="_blank">02:39:33.740</a></span> | <span class="t">We have... so we have an input which is batch size of 320 features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9582" target="_blank">02:39:42.060</a></span> | <span class="t">The height is divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9584" target="_blank">02:39:44.060</a></span> | <span class="t">And the width is divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9585" target="_blank">02:39:45.820</a></span> | <span class="t">We first apply a group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9588" target="_blank">02:39:48.940</a></span> | <span class="t">Then we apply the SILU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9594" target="_blank">02:39:54.860</a></span> | <span class="t">Then we apply the convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9600" target="_blank">02:40:00.060</a></span> | <span class="t">And then we return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9602" target="_blank">02:40:02.540</a></span> | <span class="t">This will basically... the convolution... let me write also why we are reducing the size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9609" target="_blank">02:40:09.660</a></span> | <span class="t">This convolution will change the number of channels from in to out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9613" target="_blank">02:40:13.180</a></span> | <span class="t">And when we will declare it, we say that we want to convert from 320 to 4 here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9618" target="_blank">02:40:18.700</a></span> | <span class="t">So this one will be of shape batch size 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9623" target="_blank">02:40:23.020</a></span> | <span class="t">Height divided by 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9625" target="_blank">02:40:25.100</a></span> | <span class="t">Height divided by 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9628" target="_blank">02:40:28.060</a></span> | <span class="t">And width divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9630" target="_blank">02:40:30.620</a></span> | <span class="t">Then we need to go build this residual block and this attention block here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9639" target="_blank">02:40:39.660</a></span> | <span class="t">So let's build it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9640" target="_blank">02:40:40.860</a></span> | <span class="t">Let's start with the residual block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9644" target="_blank">02:40:44.060</a></span> | <span class="t">which is very similar to the residual block that we built for the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9647" target="_blank">02:40:47.740</a></span> | <span class="t">So unit lock.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9661" target="_blank">02:41:01.580</a></span> | <span class="t">So this is the embedding of the time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9676" target="_blank">02:41:16.220</a></span> | <span class="t">As you remember, with the time embedding, we transform into an embedding of size 1280.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9690" target="_blank">02:41:30.460</a></span> | <span class="t">We have this group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9692" target="_blank">02:41:32.460</a></span> | <span class="t">It's always this group norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9693" target="_blank">02:41:33.660</a></span> | <span class="t">Then we have a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9717" target="_blank">02:41:57.500</a></span> | <span class="t">And we have a linear for the time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9721" target="_blank">02:42:01.020</a></span> | <span class="t">Then we have another group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9731" target="_blank">02:42:11.020</a></span> | <span class="t">We will see later what is this merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9744" target="_blank">02:42:24.860</a></span> | <span class="t">And another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9750" target="_blank">02:42:30.780</a></span> | <span class="t">Oops, kernel size 3, embedding 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9757" target="_blank">02:42:37.500</a></span> | <span class="t">Again, just like before, we have if the in channels is equal to the out channels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9765" target="_blank">02:42:45.260</a></span> | <span class="t">we can connect them directly with the residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9774" target="_blank">02:42:54.220</a></span> | <span class="t">Otherwise, we create a convolution to connect them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9777" target="_blank">02:42:57.180</a></span> | <span class="t">to convert the size of the input into the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9779" target="_blank">02:42:59.740</a></span> | <span class="t">Otherwise, we cannot add the two tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9798" target="_blank">02:43:18.540</a></span> | <span class="t">Zero, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9807" target="_blank">02:43:27.500</a></span> | <span class="t">So it takes in as input this feature tensor, which is actually the latent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9817" target="_blank">02:43:37.500</a></span> | <span class="t">batch size in channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9822" target="_blank">02:43:42.300</a></span> | <span class="t">Then we have height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9825" target="_blank">02:43:45.100</a></span> | <span class="t">And then also the time embedding, which is 1 by 1280, just like here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9830" target="_blank">02:43:50.460</a></span> | <span class="t">And we build, first of all, a residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9835" target="_blank">02:43:55.180</a></span> | <span class="t">Then we do apply the group normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9841" target="_blank">02:44:01.580</a></span> | <span class="t">So usually the residual connection, the residual blocks are more or less always the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9845" target="_blank">02:44:05.500</a></span> | <span class="t">So there is a normalization and activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9848" target="_blank">02:44:08.780</a></span> | <span class="t">Then we can have some skip connection, etc, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9852" target="_blank">02:44:12.620</a></span> | <span class="t">So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9854" target="_blank">02:44:14.620</a></span> | <span class="t">then we have the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9879" target="_blank">02:44:39.420</a></span> | <span class="t">So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9881" target="_blank">02:44:41.420</a></span> | <span class="t">here we are merging the latency with the time embedding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9903" target="_blank">02:45:03.180</a></span> | <span class="t">but the time embedding doesn't have the batch and the channels dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9907" target="_blank">02:45:07.500</a></span> | <span class="t">So we add it here with unsqueeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9909" target="_blank">02:45:09.500</a></span> | <span class="t">And we merge them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9911" target="_blank">02:45:11.900</a></span> | <span class="t">Then we normalize this merged connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9915" target="_blank">02:45:15.180</a></span> | <span class="t">This is why it's called merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9919" target="_blank">02:45:19.260</a></span> | <span class="t">We apply the activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9934" target="_blank">02:45:34.700</a></span> | <span class="t">Then we apply this convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9937" target="_blank">02:45:37.500</a></span> | <span class="t">And finally, we apply the residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9939" target="_blank">02:45:39.820</a></span> | <span class="t">So why are we doing this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9949" target="_blank">02:45:49.900</a></span> | <span class="t">Well, the idea is that here we have three inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9952" target="_blank">02:45:52.780</a></span> | <span class="t">We have the time embedding, we have the latent, we have the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9956" target="_blank">02:45:56.300</a></span> | <span class="t">We need to find a way to combine the three information together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9960" target="_blank">02:46:00.140</a></span> | <span class="t">So the unit needs to learn to detect the noise present in a noisified image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9965" target="_blank">02:46:05.100</a></span> | <span class="t">at a particular time step using a particular prompt as a condition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9969" target="_blank">02:46:09.100</a></span> | <span class="t">Which means that the model needs to recognize this time embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9974" target="_blank">02:46:14.860</a></span> | <span class="t">and needs to relate this time embedding with the latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9977" target="_blank">02:46:17.980</a></span> | <span class="t">And this is exactly what we are doing in this residual block here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9981" target="_blank">02:46:21.100</a></span> | <span class="t">We are relating the latent with the time embedding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9984" target="_blank">02:46:24.460</a></span> | <span class="t">so that the output will depend on the combination of both,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9989" target="_blank">02:46:29.020</a></span> | <span class="t">not on the single noise or in the single time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9991" target="_blank">02:46:31.820</a></span> | <span class="t">And this will also be done with the context using cross-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9995" target="_blank">02:46:35.980</a></span> | <span class="t">in the attention block that we will build now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=9997" target="_blank">02:46:37.900</a></span> | <span class="t">So, unit attention block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10018" target="_blank">02:46:58.460</a></span> | <span class="t">768, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10029" target="_blank">02:47:09.340</a></span> | <span class="t">Okay, I will define some layers that for now will not make much sense,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10038" target="_blank">02:47:18.140</a></span> | <span class="t">but later they will make sense when we make the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10043" target="_blank">02:47:23.340</a></span> | <span class="t">So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10054" target="_blank">02:47:34.220</a></span> | <span class="t">okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10063" target="_blank">02:47:43.100</a></span> | <span class="t">So, my cat is asking for food.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10080" target="_blank">02:48:00.700</a></span> | <span class="t">I think he already has food, but maybe he wants to eat something special today.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10086" target="_blank">02:48:06.540</a></span> | <span class="t">So, let me finish this attention block and the unit and then I'm all his.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10092" target="_blank">02:48:12.220</a></span> | <span class="t">Why everyone wants attention?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10096" target="_blank">02:48:16.140</a></span> | <span class="t">Self-attention and head channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10102" target="_blank">02:48:22.300</a></span> | <span class="t">Here we don't have any bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10104" target="_blank">02:48:24.940</a></span> | <span class="t">As you remember, the self-attention we can have the bias for the W matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10110" target="_blank">02:48:30.060</a></span> | <span class="t">Here we don't have any bias, just like in the vanilla transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10113" target="_blank">02:48:33.020</a></span> | <span class="t">So, we have this attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10115" target="_blank">02:48:35.660</a></span> | <span class="t">Then we have a layer normalization, self.layernorm 2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10119" target="_blank">02:48:39.980</a></span> | <span class="t">which is along the same number of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10125" target="_blank">02:48:45.740</a></span> | <span class="t">Then we have another attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10127" target="_blank">02:48:47.020</a></span> | <span class="t">We will see later why we need all this attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10129" target="_blank">02:48:49.980</a></span> | <span class="t">but this is not a self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10131" target="_blank">02:48:51.260</a></span> | <span class="t">It's a cross-attention and we will see later how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10134" target="_blank">02:48:54.780</a></span> | <span class="t">So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10140" target="_blank">02:49:00.300</a></span> | <span class="t">then we have the layer norm 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10154" target="_blank">02:49:14.540</a></span> | <span class="t">So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10163" target="_blank">02:49:23.820</a></span> | <span class="t">this is because we are using a function that is called the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10172" target="_blank">02:49:32.380</a></span> | <span class="t">JGLU activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10174" target="_blank">02:49:34.300</a></span> | <span class="t">So, we need these matrices here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10178" target="_blank">02:49:38.700</a></span> | <span class="t">So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10187" target="_blank">02:49:47.340</a></span> | <span class="t">okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10199" target="_blank">02:49:59.100</a></span> | <span class="t">Now we can build the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10200" target="_blank">02:50:00.620</a></span> | <span class="t">So, our X is our latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10203" target="_blank">02:50:03.260</a></span> | <span class="t">So, we have a batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10204" target="_blank">02:50:04.700</a></span> | <span class="t">We have features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10206" target="_blank">02:50:06.940</a></span> | <span class="t">We have height.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10207" target="_blank">02:50:07.900</a></span> | <span class="t">We have width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10208" target="_blank">02:50:08.700</a></span> | <span class="t">Then we have our context, which is our prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10211" target="_blank">02:50:11.660</a></span> | <span class="t">which is a batch size, sequence length, dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10215" target="_blank">02:50:15.980</a></span> | <span class="t">The dimension is size 768, as we saw before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10219" target="_blank">02:50:19.260</a></span> | <span class="t">So, the first thing we will do is we will do the normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10225" target="_blank">02:50:25.100</a></span> | <span class="t">So, just like in the transformer, we will take the input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10228" target="_blank">02:50:28.540</a></span> | <span class="t">so our latency, and we apply the normalization and the convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10232" target="_blank">02:50:32.700</a></span> | <span class="t">Actually, in the transformer, there is no convolution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10234" target="_blank">02:50:34.700</a></span> | <span class="t">but only the normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10236" target="_blank">02:50:36.380</a></span> | <span class="t">So, this is called the long residual,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10241" target="_blank">02:50:41.740</a></span> | <span class="t">because it will be applied at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10243" target="_blank">02:50:43.420</a></span> | <span class="t">Okay, so we have this here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10250" target="_blank">02:50:50.860</a></span> | <span class="t">We are applying the normalization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10252" target="_blank">02:50:52.140</a></span> | <span class="t">which doesn't change the size of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10254" target="_blank">02:50:54.460</a></span> | <span class="t">Then we have a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10256" target="_blank">02:50:56.540</a></span> | <span class="t">X is equal to self.com input of X,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10261" target="_blank">02:51:01.900</a></span> | <span class="t">which also doesn't change the size of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10265" target="_blank">02:51:05.580</a></span> | <span class="t">Then we take the shape,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10268" target="_blank">02:51:08.460</a></span> | <span class="t">which is the batch size, the number of features, the height, and the width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10277" target="_blank">02:51:17.340</a></span> | <span class="t">We transpose because we want to apply cross-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10282" target="_blank">02:51:22.060</a></span> | <span class="t">First, we apply self-attention, then we apply cross-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10288" target="_blank">02:51:28.460</a></span> | <span class="t">So, we do normalization plus self-attention with skip connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10300" target="_blank">02:51:40.220</a></span> | <span class="t">So, X is X dot transpose of minus one, minus two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10306" target="_blank">02:51:46.700</a></span> | <span class="t">So, we are going from this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10309" target="_blank">02:51:49.820</a></span> | <span class="t">Wait, I forgot something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10314" target="_blank">02:51:54.140</a></span> | <span class="t">Here, first of all, we need to do X is equal to X dot view.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10318" target="_blank">02:51:58.860</a></span> | <span class="t">Then C, H multiplied by W.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10322" target="_blank">02:52:02.780</a></span> | <span class="t">So, we are going from this to batch size features,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10331" target="_blank">02:52:11.980</a></span> | <span class="t">and then H multiplied by W.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10333" target="_blank">02:52:13.500</a></span> | <span class="t">So, this one multiplied by this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10334" target="_blank">02:52:14.940</a></span> | <span class="t">Then we transpose these two dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10337" target="_blank">02:52:17.500</a></span> | <span class="t">So, now we get from here to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10343" target="_blank">02:52:23.420</a></span> | <span class="t">So, the features become the last one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10346" target="_blank">02:52:26.940</a></span> | <span class="t">Now, we apply this normalization plus self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10349" target="_blank">02:52:29.500</a></span> | <span class="t">So, we have a first short residual connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10355" target="_blank">02:52:35.260</a></span> | <span class="t">that we'll apply right after the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10357" target="_blank">02:52:37.180</a></span> | <span class="t">So, we say that X is equal to layer norm one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10362" target="_blank">02:52:42.380</a></span> | <span class="t">So, X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10363" target="_blank">02:52:43.020</a></span> | <span class="t">Then we apply the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10364" target="_blank">02:52:44.940</a></span> | <span class="t">So, self dot attention one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10366" target="_blank">02:52:46.700</a></span> | <span class="t">And then we apply the residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10369" target="_blank">02:52:49.740</a></span> | <span class="t">So, X is plus equal to residual short, the first residual connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10376" target="_blank">02:52:56.060</a></span> | <span class="t">Then we say that the residual short is again equal to six,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10378" target="_blank">02:52:58.780</a></span> | <span class="t">because we are going to apply now the cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10381" target="_blank">02:53:01.740</a></span> | <span class="t">So, now we apply the normalization plus the cross attention with skip connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10391" target="_blank">02:53:11.100</a></span> | <span class="t">So, what we did here is what we do in any transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10400" target="_blank">02:53:20.060</a></span> | <span class="t">So, let me show you here what we do in any transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10403" target="_blank">02:53:23.020</a></span> | <span class="t">So, we apply some normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10404" target="_blank">02:53:24.460</a></span> | <span class="t">We calculate the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10406" target="_blank">02:53:26.140</a></span> | <span class="t">And then we combine it with a skip connection here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10408" target="_blank">02:53:28.460</a></span> | <span class="t">And now we will, instead of calculating a self-attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10411" target="_blank">02:53:31.660</a></span> | <span class="t">we will do a cross attention, which we still didn't define.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10415" target="_blank">02:53:35.020</a></span> | <span class="t">We will define it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10416" target="_blank">02:53:36.460</a></span> | <span class="t">So, short.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10419" target="_blank">02:53:39.340</a></span> | <span class="t">And then first we calculate, we apply the normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10423" target="_blank">02:53:43.020</a></span> | <span class="t">Then the cross attention between the latency and the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10433" target="_blank">02:53:53.420</a></span> | <span class="t">This is cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10434" target="_blank">02:53:54.860</a></span> | <span class="t">So, this is cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10437" target="_blank">02:53:57.420</a></span> | <span class="t">And we will see how.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10439" target="_blank">02:53:59.660</a></span> | <span class="t">And X plus or equal to residual short.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10447" target="_blank">02:54:07.260</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10449" target="_blank">02:54:09.420</a></span> | <span class="t">And then again, equal to X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10452" target="_blank">02:54:12.300</a></span> | <span class="t">Finally, just like with the attention transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10456" target="_blank">02:54:16.140</a></span> | <span class="t">we have a feedforward layer with the JGLU activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10460" target="_blank">02:54:20.780</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10466" target="_blank">02:54:26.780</a></span> | <span class="t">And this is actually, if you watch the original implementation of the transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10485" target="_blank">02:54:45.180</a></span> | <span class="t">of the stable diffusion, it's implemented exactly like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10488" target="_blank">02:54:48.620</a></span> | <span class="t">So, basically later we do element-wise multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10495" target="_blank">02:54:55.020</a></span> | <span class="t">So, these are special activation functions that involve a lot of parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10503" target="_blank">02:55:03.420</a></span> | <span class="t">But why we use one and not the other?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10509" target="_blank">02:55:09.420</a></span> | <span class="t">I told you, just like before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10511" target="_blank">02:55:11.500</a></span> | <span class="t">they just saw that this one works better for this kind of application.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10514" target="_blank">02:55:14.940</a></span> | <span class="t">There is no other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10516" target="_blank">02:55:16.940</a></span> | <span class="t">Then we apply the skip connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10522" target="_blank">02:55:22.940</a></span> | <span class="t">So, we apply the cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10524" target="_blank">02:55:24.620</a></span> | <span class="t">Then we define another one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10526" target="_blank">02:55:26.940</a></span> | <span class="t">So, this one is basically normalization plus feedforward layer with JGLU and skip connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10538" target="_blank">02:55:38.620</a></span> | <span class="t">In which the skip connection is defined here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10541" target="_blank">02:55:41.660</a></span> | <span class="t">So, at the end, we always apply the skip connection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10544" target="_blank">02:55:44.780</a></span> | <span class="t">Finally, we change back to our tensor to not be a sequence of pixels anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10550" target="_blank">02:55:50.140</a></span> | <span class="t">So, we reverse the previous transposition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10554" target="_blank">02:55:54.700</a></span> | <span class="t">Transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10557" target="_blank">02:55:57.820</a></span> | <span class="t">So, basically, we go from batch size with width multiplied by height multiplied by width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10573" target="_blank">02:56:13.980</a></span> | <span class="t">And features into batch size features height multiplied by width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10585" target="_blank">02:56:25.260</a></span> | <span class="t">Then we remove this multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10590" target="_blank">02:56:30.460</a></span> | <span class="t">So, we reverse this multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10592" target="_blank">02:56:32.700</a></span> | <span class="t">And CHW.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10596" target="_blank">02:56:36.940</a></span> | <span class="t">Finally, we apply the long skip connection that we defined here at the beginning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10603" target="_blank">02:56:43.820</a></span> | <span class="t">So, only if the size match.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10606" target="_blank">02:56:46.540</a></span> | <span class="t">If the sizes don't match, we apply the here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10609" target="_blank">02:56:49.580</a></span> | <span class="t">This one we have here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10610" target="_blank">02:56:50.620</a></span> | <span class="t">Return self.com output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10615" target="_blank">02:56:55.420</a></span> | <span class="t">And this is all of our unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10624" target="_blank">02:57:04.300</a></span> | <span class="t">We have defined everything, I think, except for the cross attention, which is very fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10629" target="_blank">02:57:09.340</a></span> | <span class="t">So, we go to the attention that we defined before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10633" target="_blank">02:57:13.100</a></span> | <span class="t">And I put it in the wrong folder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10635" target="_blank">02:57:15.180</a></span> | <span class="t">It should be skip changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10637" target="_blank">02:57:17.660</a></span> | <span class="t">Let me check if I put it correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10640" target="_blank">02:57:20.700</a></span> | <span class="t">Yeah, we only need to define this cross attention here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10648" target="_blank">02:57:28.460</a></span> | <span class="t">Okay, attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10651" target="_blank">02:57:31.660</a></span> | <span class="t">So, let's go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10653" target="_blank">02:57:33.100</a></span> | <span class="t">And let's define this cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10658" target="_blank">02:57:38.060</a></span> | <span class="t">So, class, it will be very similar to the, not very similar, actually, same as the self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10664" target="_blank">02:57:44.780</a></span> | <span class="t">attention, except that the keys come from one side and the query and, sorry, the query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10671" target="_blank">02:57:51.420</a></span> | <span class="t">come from one side and the key and the values from another side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10686" target="_blank">02:58:06.300</a></span> | <span class="t">So, this is the dimension of the embedding of the keys and the values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10695" target="_blank">02:58:15.100</a></span> | <span class="t">This is the one of the queries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10708" target="_blank">02:58:28.780</a></span> | <span class="t">This is the WQ matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10717" target="_blank">02:58:37.420</a></span> | <span class="t">In this case, we will define, instead of one big matrix made of three, WQ, WK and WV, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10722" target="_blank">02:58:42.940</a></span> | <span class="t">will define three different matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10724" target="_blank">02:58:44.540</a></span> | <span class="t">Both systems are fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10726" target="_blank">02:58:46.860</a></span> | <span class="t">You can define it as one big matrix or three separately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10730" target="_blank">02:58:50.220</a></span> | <span class="t">It doesn't change anything, actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10742" target="_blank">02:59:02.860</a></span> | <span class="t">So, the cross is from the keys and the values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10756" target="_blank">02:59:16.860</a></span> | <span class="t">Oops, linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10772" target="_blank">02:59:32.220</a></span> | <span class="t">Then, we save the number of heads of this cross attention and also the dimension of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10800" target="_blank">03:00:00.460</a></span> | <span class="t">each, how much information each head will see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10804" target="_blank">03:00:04.140</a></span> | <span class="t">And the head is equal to the embed divided by the number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10813" target="_blank">03:00:13.660</a></span> | <span class="t">Let's define the forward method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10817" target="_blank">03:00:17.100</a></span> | <span class="t">X is our query and Y is our keys and values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10827" target="_blank">03:00:27.740</a></span> | <span class="t">So, we are relating X, which is our latency, which is of size batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10836" target="_blank">03:00:36.060</a></span> | <span class="t">It will have a sequence length, its own sequence length, Q, let's call it Q, and its own dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10843" target="_blank">03:00:43.580</a></span> | <span class="t">And the Y, which is the context or the prompt, which will be batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10853" target="_blank">03:00:53.580</a></span> | <span class="t">Sequence length of the key, because the prompt will become the key and the values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10858" target="_blank">03:00:58.860</a></span> | <span class="t">And each of them will have its own embedding size, the dimension of KV.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10863" target="_blank">03:01:03.100</a></span> | <span class="t">We can already say that this will be a batch size of 77, because our sequence length of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10869" target="_blank">03:01:09.580</a></span> | <span class="t">the prompt is 77 and its embedding is of size 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10874" target="_blank">03:01:14.140</a></span> | <span class="t">So, let's build this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10879" target="_blank">03:01:19.580</a></span> | <span class="t">This is input shape is equal to x dot shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10883" target="_blank">03:01:23.740</a></span> | <span class="t">Okay, then we have the interim shape, like the same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10900" target="_blank">03:01:40.860</a></span> | <span class="t">So, this is the sequence length, then the n number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10909" target="_blank">03:01:49.980</a></span> | <span class="t">And how much information each head will see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10912" target="_blank">03:01:52.300</a></span> | <span class="t">The head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10915" target="_blank">03:01:55.260</a></span> | <span class="t">The first thing we do is multiply queries by WQ matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10925" target="_blank">03:02:05.660</a></span> | <span class="t">So, query is equal to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10927" target="_blank">03:02:07.580</a></span> | <span class="t">Then we do the same for the keys and the values, but by using the other matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10937" target="_blank">03:02:17.900</a></span> | <span class="t">And as I told you before, the key and the values are the Y and not the X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10942" target="_blank">03:02:22.140</a></span> | <span class="t">Again, we split them into H heads, so H number of heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10952" target="_blank">03:02:32.140</a></span> | <span class="t">Then we transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10958" target="_blank">03:02:38.860</a></span> | <span class="t">I will not write the shapes because they match the same transformation that we do here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10966" target="_blank">03:02:46.700</a></span> | <span class="t">Okay, again, we calculate the weight, which is the attention, as a query multiplied by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10987" target="_blank">03:03:07.580</a></span> | <span class="t">the transpose of the keys.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=10992" target="_blank">03:03:12.300</a></span> | <span class="t">And then we divide it by the dimension of each head by the square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11001" target="_blank">03:03:21.820</a></span> | <span class="t">Then we do the softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11009" target="_blank">03:03:29.420</a></span> | <span class="t">In this case, we don't have any causal mask, so we don't need to apply the mask like before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11016" target="_blank">03:03:36.300</a></span> | <span class="t">because here we are trying to relate the tokens, so the prompt with the pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11021" target="_blank">03:03:41.980</a></span> | <span class="t">So, each pixel can watch any word of the token, and any token can watch any pixel, basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11029" target="_blank">03:03:49.100</a></span> | <span class="t">So, we don't need any mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11040" target="_blank">03:04:00.940</a></span> | <span class="t">We are to obtain the output, we multiply it by the bit matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11044" target="_blank">03:04:04.140</a></span> | <span class="t">And then the output, again, is transposed, just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11050" target="_blank">03:04:10.140</a></span> | <span class="t">So, now we are doing exactly the same things that we did here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11053" target="_blank">03:04:13.900</a></span> | <span class="t">So, transpose, reshape, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11064" target="_blank">03:04:24.620</a></span> | <span class="t">And then return output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11078" target="_blank">03:04:38.780</a></span> | <span class="t">And this ends our building of the... let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11083" target="_blank">03:04:43.020</a></span> | <span class="t">Now we have built all the building blocks for the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11089" target="_blank">03:04:49.420</a></span> | <span class="t">So, now we can finally combine them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11093" target="_blank">03:04:53.420</a></span> | <span class="t">So, the next thing that we are going to do is to create the system that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11097" target="_blank">03:04:57.500</a></span> | <span class="t">taking the noise, taking the text, taking the time embedding, will run,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11103" target="_blank">03:05:03.020</a></span> | <span class="t">for example, if we want to do text to image, will run this noise many times through the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11107" target="_blank">03:05:07.900</a></span> | <span class="t">according to a schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11110" target="_blank">03:05:10.540</a></span> | <span class="t">So, we will build the scheduler, which means that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11113" target="_blank">03:05:13.340</a></span> | <span class="t">because the unit is trained to predict how much noise is there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11117" target="_blank">03:05:17.820</a></span> | <span class="t">but we then need to remove this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11120" target="_blank">03:05:20.460</a></span> | <span class="t">So, to go from a noisy version to obtain a less noisy version,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11125" target="_blank">03:05:25.180</a></span> | <span class="t">we need to remove the noise that is predicted by the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11128" target="_blank">03:05:28.140</a></span> | <span class="t">And this job is done by the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11130" target="_blank">03:05:30.460</a></span> | <span class="t">And now we will build the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11132" target="_blank">03:05:32.220</a></span> | <span class="t">We will build the code to load the weights of the pre-trained model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11135" target="_blank">03:05:35.980</a></span> | <span class="t">And then we combine all these things together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11139" target="_blank">03:05:39.580</a></span> | <span class="t">And we actually build what is called the pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11142" target="_blank">03:05:42.060</a></span> | <span class="t">So, the pipeline of text to image, image to image, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11145" target="_blank">03:05:45.180</a></span> | <span class="t">And let's go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11148" target="_blank">03:05:48.300</a></span> | <span class="t">Now that we have built all the structure of the unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11152" target="_blank">03:05:52.060</a></span> | <span class="t">or we have built the variational autoencoder, we have built a clip,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11155" target="_blank">03:05:55.500</a></span> | <span class="t">we have built the attention blocks, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11158" target="_blank">03:05:58.700</a></span> | <span class="t">Now it's time to combine it all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11161" target="_blank">03:06:01.980</a></span> | <span class="t">So, the first thing I kindly ask you to do is to actually download</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11165" target="_blank">03:06:05.500</a></span> | <span class="t">the pre-trained weights of the stable diffusion, because we need to inference it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11169" target="_blank">03:06:09.340</a></span> | <span class="t">So, if you go to the repository I shared, this one, PyTorch Stable Diffusion,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11174" target="_blank">03:06:14.220</a></span> | <span class="t">you can download the pre-trained weights of the stable diffusion 1.5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11178" target="_blank">03:06:18.380</a></span> | <span class="t">directly from the website of Hugging Face.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11180" target="_blank">03:06:20.940</a></span> | <span class="t">So, you download this file here, which is the EMA,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11184" target="_blank">03:06:24.700</a></span> | <span class="t">which means Exponentially Moving Average,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11187" target="_blank">03:06:27.020</a></span> | <span class="t">which means that it's a model that has been trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11190" target="_blank">03:06:30.460</a></span> | <span class="t">but they didn't change the weights at each iteration,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11192" target="_blank">03:06:32.860</a></span> | <span class="t">but with an Exponentially Moving Average schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11195" target="_blank">03:06:35.180</a></span> | <span class="t">So, this is good for inferencing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11197" target="_blank">03:06:37.500</a></span> | <span class="t">It means that the weights are more stable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11199" target="_blank">03:06:39.580</a></span> | <span class="t">But if you want to fine-tune later the model, you need to download this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11203" target="_blank">03:06:43.900</a></span> | <span class="t">And we also need to download the files of the tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11208" target="_blank">03:06:48.380</a></span> | <span class="t">because, of course, we will give some prompt to the model to generate an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11213" target="_blank">03:06:53.660</a></span> | <span class="t">And the prompt needs to be tokenized by a tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11216" target="_blank">03:06:56.700</a></span> | <span class="t">which will convert the words into tokens and the tokens into numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11220" target="_blank">03:07:00.620</a></span> | <span class="t">The numbers will then be mapped into embeddings by our clip embedding here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11225" target="_blank">03:07:05.420</a></span> | <span class="t">So, we need to download two files for the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11228" target="_blank">03:07:08.780</a></span> | <span class="t">So, first of all, the weights of this one file here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11232" target="_blank">03:07:12.380</a></span> | <span class="t">then on the tokenizer folder, we find the merges.txt and the vocab.json.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11237" target="_blank">03:07:17.340</a></span> | <span class="t">If we look at the vocab.json file, which I already downloaded,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11241" target="_blank">03:07:21.420</a></span> | <span class="t">it's basically vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11243" target="_blank">03:07:23.420</a></span> | <span class="t">So, each token mapped to a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11245" target="_blank">03:07:25.260</a></span> | <span class="t">That's it, just like what the tokenizer does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11247" target="_blank">03:07:27.580</a></span> | <span class="t">And then I also prepared the picture of a dog that I will be using for image-to-image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11252" target="_blank">03:07:32.140</a></span> | <span class="t">but you can use any image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11253" target="_blank">03:07:33.420</a></span> | <span class="t">You don't have to use the one I am using, of course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11256" target="_blank">03:07:36.700</a></span> | <span class="t">So, now, let's first build the pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11261" target="_blank">03:07:41.180</a></span> | <span class="t">So, how we will inference this stable diffusion model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11264" target="_blank">03:07:44.540</a></span> | <span class="t">And then, while building the pipeline,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11267" target="_blank">03:07:47.900</a></span> | <span class="t">I will also explain you how the scheduler will work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11271" target="_blank">03:07:51.420</a></span> | <span class="t">And we will build the scheduler later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11274" target="_blank">03:07:54.540</a></span> | <span class="t">I will explain all the formulas, all the mathematics behind it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11277" target="_blank">03:07:57.660</a></span> | <span class="t">So, let's start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11279" target="_blank">03:07:59.020</a></span> | <span class="t">Let's create a new file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11281" target="_blank">03:08:01.340</a></span> | <span class="t">Let's call it pipeline.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11285" target="_blank">03:08:05.980</a></span> | <span class="t">And we import the usual stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11287" target="_blank">03:08:07.900</a></span> | <span class="t">NumPy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11292" target="_blank">03:08:12.380</a></span> | <span class="t">Oops, stop, stop, stop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11295" target="_blank">03:08:15.580</a></span> | <span class="t">NumPy as empty.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11296" target="_blank">03:08:16.940</a></span> | <span class="t">We will also use a tqdm to show the progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11302" target="_blank">03:08:22.540</a></span> | <span class="t">And later, we will build this sampler, the DPM sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11308" target="_blank">03:08:28.700</a></span> | <span class="t">And we will build it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11310" target="_blank">03:08:30.220</a></span> | <span class="t">And I will also explain what is this sampler doing and how it works, etc, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11315" target="_blank">03:08:35.980</a></span> | <span class="t">So, first of all, let's define some constants.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11318" target="_blank">03:08:38.060</a></span> | <span class="t">The stable diffusion can only produce images of size 512 by 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11323" target="_blank">03:08:43.980</a></span> | <span class="t">So, height is 512 by 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11326" target="_blank">03:08:46.620</a></span> | <span class="t">The latent dimension is the size of the latent tensor of the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11335" target="_blank">03:08:55.420</a></span> | <span class="t">And as we saw before, if we go check the size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11340" target="_blank">03:09:00.300</a></span> | <span class="t">the encoder of the variational autoencoder will convert something that is 512 by 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11345" target="_blank">03:09:05.900</a></span> | <span class="t">into something that is 512 divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11349" target="_blank">03:09:09.260</a></span> | <span class="t">So, the latent dimension is 512 divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11352" target="_blank">03:09:12.780</a></span> | <span class="t">And the same goes on for the height.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11356" target="_blank">03:09:16.060</a></span> | <span class="t">512 divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11359" target="_blank">03:09:19.420</a></span> | <span class="t">We can also call it width divided by 8 and height divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11363" target="_blank">03:09:23.420</a></span> | <span class="t">Then, we create a function called the generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11367" target="_blank">03:09:27.660</a></span> | <span class="t">This will be the main function that will allow us to do text to image and also image to image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11373" target="_blank">03:09:33.900</a></span> | <span class="t">which accepts a prompt, which is a string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11376" target="_blank">03:09:36.460</a></span> | <span class="t">An unconditional prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11380" target="_blank">03:09:40.300</a></span> | <span class="t">So, unconditional prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11381" target="_blank">03:09:41.820</a></span> | <span class="t">This is also called the negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11384" target="_blank">03:09:44.620</a></span> | <span class="t">If you ever used stable diffusion, for example, with the HuggingFace library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11388" target="_blank">03:09:48.380</a></span> | <span class="t">you will know that you can also specify a negative prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11391" target="_blank">03:09:51.820</a></span> | <span class="t">which tells that you want, for example, you want a picture of a cat,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11396" target="_blank">03:09:56.620</a></span> | <span class="t">but you don't want the cat to be on the sofa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11399" target="_blank">03:09:59.900</a></span> | <span class="t">So, for example, you can put the word sofa in the negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11404" target="_blank">03:10:04.060</a></span> | <span class="t">So, it will try to go away from the concept of sofa when generating the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11408" target="_blank">03:10:08.620</a></span> | <span class="t">Something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11409" target="_blank">03:10:09.260</a></span> | <span class="t">And this is connected with the classifier free guidance that we saw before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11413" target="_blank">03:10:13.980</a></span> | <span class="t">So, but don't worry, I will repeat all the concepts while we are building it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11417" target="_blank">03:10:17.020</a></span> | <span class="t">So, this is also a string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11418" target="_blank">03:10:18.540</a></span> | <span class="t">We can have an input image in case we are building an image to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11425" target="_blank">03:10:25.580</a></span> | <span class="t">And then we have the strength.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11427" target="_blank">03:10:27.660</a></span> | <span class="t">Strength, I will show you later what is it, but it's related to if we have an input image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11433" target="_blank">03:10:33.340</a></span> | <span class="t">and how much, if we start from an image to generate another image,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11437" target="_blank">03:10:37.180</a></span> | <span class="t">how much attention we want to pay to the initial starting image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11440" target="_blank">03:10:40.780</a></span> | <span class="t">And we can also have a parameter called doCFG,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11446" target="_blank">03:10:46.300</a></span> | <span class="t">which means do classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11449" target="_blank">03:10:49.260</a></span> | <span class="t">We set it to yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11451" target="_blank">03:10:51.020</a></span> | <span class="t">CFG scale, which is the weight of how much we want the model to pay attention to our prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11456" target="_blank">03:10:56.460</a></span> | <span class="t">It's a value that goes from 1 to 14.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11458" target="_blank">03:10:58.700</a></span> | <span class="t">We start with 7.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11460" target="_blank">03:11:00.380</a></span> | <span class="t">The sampler name, we will only implement one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11463" target="_blank">03:11:03.980</a></span> | <span class="t">So, it's called edpm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11465" target="_blank">03:11:05.500</a></span> | <span class="t">How many inference steps we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11469" target="_blank">03:11:09.100</a></span> | <span class="t">And we will do 50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11472" target="_blank">03:11:12.060</a></span> | <span class="t">I think it's quite common to do 50 steps, which produces actually not bad results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11477" target="_blank">03:11:17.180</a></span> | <span class="t">The models are the pre-trained models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11480" target="_blank">03:11:20.140</a></span> | <span class="t">The seed is how we want to initialize our random number generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11483" target="_blank">03:11:23.980</a></span> | <span class="t">Let me put a new line, otherwise we become crazy reading this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11487" target="_blank">03:11:27.820</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11491" target="_blank">03:11:31.920</a></span> | <span class="t">New line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11494" target="_blank">03:11:34.300</a></span> | <span class="t">So, seed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11496" target="_blank">03:11:36.540</a></span> | <span class="t">Then we have the device where we want to create our tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11499" target="_blank">03:11:39.820</a></span> | <span class="t">We have an idle device, which means basically if we load some model on CUDA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11505" target="_blank">03:11:45.020</a></span> | <span class="t">and then we don't need the model, we move it to the CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11508" target="_blank">03:11:48.060</a></span> | <span class="t">And then the tokenizer that we will load later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11510" target="_blank">03:11:50.300</a></span> | <span class="t">Tokenizer is none.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11512" target="_blank">03:11:52.540</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11513" target="_blank">03:11:53.040</a></span> | <span class="t">This is our method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11514" target="_blank">03:11:54.860</a></span> | <span class="t">This is our main pipeline that, given all this information, will generate one picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11519" target="_blank">03:11:59.340</a></span> | <span class="t">So, it will pay attention to the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11521" target="_blank">03:12:01.340</a></span> | <span class="t">It will pay attention to the input image, if there is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11523" target="_blank">03:12:03.980</a></span> | <span class="t">according to the weights that we have specified.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11526" target="_blank">03:12:06.220</a></span> | <span class="t">So, the strength and the CFG scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11528" target="_blank">03:12:08.460</a></span> | <span class="t">I will repeat all this concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11530" target="_blank">03:12:10.540</a></span> | <span class="t">Don't worry, later I will explain them actually how they work also on the code level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11534" target="_blank">03:12:14.940</a></span> | <span class="t">So, let's start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11536" target="_blank">03:12:16.860</a></span> | <span class="t">So, the first thing we do is we disable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11541" target="_blank">03:12:21.980</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11542" target="_blank">03:12:22.480</a></span> | <span class="t">Torch.log(red) because we are inferencing the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11548" target="_blank">03:12:28.780</a></span> | <span class="t">The first thing we make sure is the strength should be between 0 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11554" target="_blank">03:12:34.220</a></span> | <span class="t">So, if...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11554" target="_blank">03:12:34.860</a></span> | <span class="t">Then we raise an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11565" target="_blank">03:12:45.020</a></span> | <span class="t">Raise value error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11567" target="_blank">03:12:47.660</a></span> | <span class="t">Must be between 0 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11575" target="_blank">03:12:55.020</a></span> | <span class="t">If idle device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11579" target="_blank">03:12:59.340</a></span> | <span class="t">If we want to move things to the CPU, we create this lambda function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11586" target="_blank">03:13:06.140</a></span> | <span class="t">Otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11594" target="_blank">03:13:14.140</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11597" target="_blank">03:13:17.440</a></span> | <span class="t">Then we create the... oops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11600" target="_blank">03:13:20.940</a></span> | <span class="t">I think I... okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11604" target="_blank">03:13:24.940</a></span> | <span class="t">Then we create the... oops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11608" target="_blank">03:13:28.940</a></span> | <span class="t">I think I... okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11613" target="_blank">03:13:33.100</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11613" target="_blank">03:13:33.600</a></span> | <span class="t">Then we create the random number generator that we will use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11618" target="_blank">03:13:38.060</a></span> | <span class="t">I think I made some mess with this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11623" target="_blank">03:13:43.260</a></span> | <span class="t">So, this one should be like here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11627" target="_blank">03:13:47.420</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11631" target="_blank">03:13:51.040</a></span> | <span class="t">And the generator is a random number generator that we will use to generate the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11641" target="_blank">03:14:01.260</a></span> | <span class="t">And if we want to start it with the seed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11644" target="_blank">03:14:04.540</a></span> | <span class="t">So, if seed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11645" target="_blank">03:14:05.580</a></span> | <span class="t">Then we generate with the random seed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11651" target="_blank">03:14:11.580</a></span> | <span class="t">Otherwise, we specify one manually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11654" target="_blank">03:14:14.140</a></span> | <span class="t">Let me fix this formatting because I don't know format document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11667" target="_blank">03:14:27.260</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11668" target="_blank">03:14:28.700</a></span> | <span class="t">Now, at least the...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11669" target="_blank">03:14:29.660</a></span> | <span class="t">Then we define clip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11673" target="_blank">03:14:33.900</a></span> | <span class="t">The clip is a model that we take from the pre-trained models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11677" target="_blank">03:14:37.900</a></span> | <span class="t">So, it will have the clip model inside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11681" target="_blank">03:14:41.180</a></span> | <span class="t">So, this model here, basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11683" target="_blank">03:14:43.580</a></span> | <span class="t">This one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11685" target="_blank">03:14:45.420</a></span> | <span class="t">We move it to our device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11689" target="_blank">03:14:49.100</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11698" target="_blank">03:14:58.160</a></span> | <span class="t">As you remember with the classifier-free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11701" target="_blank">03:15:01.520</a></span> | <span class="t">So, let me go back to my slides.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11703" target="_blank">03:15:03.280</a></span> | <span class="t">When we do classifier-free guidance, we inference the model twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11711" target="_blank">03:15:11.680</a></span> | <span class="t">First, by specifying the condition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11715" target="_blank">03:15:15.680</a></span> | <span class="t">So, the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11716" target="_blank">03:15:16.560</a></span> | <span class="t">And another time by not specifying the condition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11719" target="_blank">03:15:19.200</a></span> | <span class="t">So, without the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11720" target="_blank">03:15:20.720</a></span> | <span class="t">And then we combine the output of the model linearly with a weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11726" target="_blank">03:15:26.320</a></span> | <span class="t">This weight, W, is our...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11728" target="_blank">03:15:28.000</a></span> | <span class="t">This weight here, CFG scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11731" target="_blank">03:15:31.440</a></span> | <span class="t">It indicates how much we want to pay attention to the conditioned output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11736" target="_blank">03:15:36.320</a></span> | <span class="t">with respect to the unconditioned output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11738" target="_blank">03:15:38.320</a></span> | <span class="t">Which also means that how much we want the model to pay attention to the condition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11743" target="_blank">03:15:43.280</a></span> | <span class="t">that we have specified.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11744" target="_blank">03:15:44.400</a></span> | <span class="t">What is the condition?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11745" target="_blank">03:15:45.200</a></span> | <span class="t">The prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11746" target="_blank">03:15:46.000</a></span> | <span class="t">The textual prompt that we have written.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11747" target="_blank">03:15:47.680</a></span> | <span class="t">And the unconditioned actually is also...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11753" target="_blank">03:15:53.360</a></span> | <span class="t">Will use the negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11754" target="_blank">03:15:54.880</a></span> | <span class="t">So, the negative prompt that you use in stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11757" target="_blank">03:15:57.920</a></span> | <span class="t">Which is this parameter here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11760" target="_blank">03:16:00.160</a></span> | <span class="t">So, unconditioned prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11762" target="_blank">03:16:02.000</a></span> | <span class="t">This is the unconditional output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11763" target="_blank">03:16:03.680</a></span> | <span class="t">So, we will sample the...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11765" target="_blank">03:16:05.520</a></span> | <span class="t">We will inference from the model twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11767" target="_blank">03:16:07.600</a></span> | <span class="t">One with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11769" target="_blank">03:16:09.200</a></span> | <span class="t">One without.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11770" target="_blank">03:16:10.000</a></span> | <span class="t">With the...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11770" target="_blank">03:16:10.480</a></span> | <span class="t">One with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11771" target="_blank">03:16:11.440</a></span> | <span class="t">One with the unconditioned prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11773" target="_blank">03:16:13.040</a></span> | <span class="t">Which is usually an empty text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11774" target="_blank">03:16:14.880</a></span> | <span class="t">An empty string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11776" target="_blank">03:16:16.320</a></span> | <span class="t">And then we combine the two by this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11779" target="_blank">03:16:19.600</a></span> | <span class="t">And this will tell the model by using this weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11781" target="_blank">03:16:21.760</a></span> | <span class="t">We will combine the output in such a way that we can decide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11784" target="_blank">03:16:24.880</a></span> | <span class="t">how much we want the model to pay attention to the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11787" target="_blank">03:16:27.360</a></span> | <span class="t">So, let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11789" target="_blank">03:16:29.920</a></span> | <span class="t">If we want to do classifier-free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11792" target="_blank">03:16:32.960</a></span> | <span class="t">First, convert the prompt into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11798" target="_blank">03:16:38.080</a></span> | <span class="t">Using the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11802" target="_blank">03:16:42.320</a></span> | <span class="t">We didn't specify what is the tokenizer yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11808" target="_blank">03:16:48.480</a></span> | <span class="t">But later we will define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11810" target="_blank">03:16:50.480</a></span> | <span class="t">So, the conditional tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11811" target="_blank">03:16:51.920</a></span> | <span class="t">Tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11814" target="_blank">03:16:54.560</a></span> | <span class="t">Patch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11815" target="_blank">03:16:55.840</a></span> | <span class="t">Encode plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11818" target="_blank">03:16:58.480</a></span> | <span class="t">We want to encode the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11822" target="_blank">03:17:02.720</a></span> | <span class="t">We want to append the padding up to the maximum length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11826" target="_blank">03:17:06.880</a></span> | <span class="t">Which means that the prompt, if it's too short,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11830" target="_blank">03:17:10.000</a></span> | <span class="t">it will fill up it with paddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11831" target="_blank">03:17:11.680</a></span> | <span class="t">And the max length, as you remember, is 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11835" target="_blank">03:17:15.280</a></span> | <span class="t">Because we have also defined it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11837" target="_blank">03:17:17.520</a></span> | <span class="t">The sequence length is 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11839" target="_blank">03:17:19.360</a></span> | <span class="t">And we take the input IDs of this tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11842" target="_blank">03:17:22.960</a></span> | <span class="t">Then we convert these tokens, which are input IDs, into a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11850" target="_blank">03:17:30.960</a></span> | <span class="t">Which will be of size batch size and sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11855" target="_blank">03:17:35.920</a></span> | <span class="t">So, conditional tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11858" target="_blank">03:17:38.560</a></span> | <span class="t">So, conditional tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11861" target="_blank">03:17:41.920</a></span> | <span class="t">And we put it in the right device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11874" target="_blank">03:17:54.160</a></span> | <span class="t">Now, we run it through clip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11876" target="_blank">03:17:56.880</a></span> | <span class="t">So, it will convert batch size sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11879" target="_blank">03:17:59.840</a></span> | <span class="t">So, these input IDs will be converted into embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11885" target="_blank">03:18:05.680</a></span> | <span class="t">Of size 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11888" target="_blank">03:18:08.480</a></span> | <span class="t">Each vector of size 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11890" target="_blank">03:18:10.720</a></span> | <span class="t">So, let's call it dim.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11892" target="_blank">03:18:12.400</a></span> | <span class="t">And what we do is conditional context is equal to clip of conditional tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11902" target="_blank">03:18:22.800</a></span> | <span class="t">So, we are taking these tokens and we are running them through clips.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11905" target="_blank">03:18:25.840</a></span> | <span class="t">So, this forward method here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11907" target="_blank">03:18:27.360</a></span> | <span class="t">Which will return batch size sequence length dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11911" target="_blank">03:18:31.040</a></span> | <span class="t">And this is exactly what I have written here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11914" target="_blank">03:18:34.080</a></span> | <span class="t">We do the same for the unconditioned tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11916" target="_blank">03:18:36.480</a></span> | <span class="t">So, the negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11918" target="_blank">03:18:38.080</a></span> | <span class="t">Which, if you don't want to specify, we will use the empty string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11921" target="_blank">03:18:41.440</a></span> | <span class="t">Which means the unconditional output of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11924" target="_blank">03:18:44.240</a></span> | <span class="t">So, the model, what would the model produce without any condition?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11931" target="_blank">03:18:51.440</a></span> | <span class="t">So, if we start with random noise and we ask the model to produce an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11934" target="_blank">03:18:54.480</a></span> | <span class="t">It will produce an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11935" target="_blank">03:18:55.600</a></span> | <span class="t">But without any condition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11936" target="_blank">03:18:56.880</a></span> | <span class="t">So, the model will output anything that it wants based on the initial noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11941" target="_blank">03:19:01.920</a></span> | <span class="t">So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11943" target="_blank">03:19:03.920</a></span> | <span class="t">we convert it into tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11969" target="_blank">03:19:29.600</a></span> | <span class="t">Then we pass it through clips.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11971" target="_blank">03:19:31.360</a></span> | <span class="t">Just like the conditional tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11972" target="_blank">03:19:32.800</a></span> | <span class="t">So, it will become tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11978" target="_blank">03:19:38.320</a></span> | <span class="t">Yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11978" target="_blank">03:19:38.820</a></span> | <span class="t">So, it will also become a tensor of batch size sequence length dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11987" target="_blank">03:19:47.600</a></span> | <span class="t">Where the sequence length is actually always 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11990" target="_blank">03:19:50.560</a></span> | <span class="t">And also, in this case, it was always 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11992" target="_blank">03:19:52.480</a></span> | <span class="t">Because it's the max length here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11995" target="_blank">03:19:55.520</a></span> | <span class="t">But I forgot to write the code to convert it into.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=11999" target="_blank">03:19:59.040</a></span> | <span class="t">So, unconditional tokens is equal to tokenizer batch plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12007" target="_blank">03:20:07.680</a></span> | <span class="t">So, the unconditional prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12013" target="_blank">03:20:13.680</a></span> | <span class="t">So, also the negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12016" target="_blank">03:20:16.240</a></span> | <span class="t">The padding is the same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12019" target="_blank">03:20:19.120</a></span> | <span class="t">So, max length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12020" target="_blank">03:20:20.000</a></span> | <span class="t">And the max length is defined as 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12025" target="_blank">03:20:25.280</a></span> | <span class="t">And we take the input IDs from here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12027" target="_blank">03:20:27.280</a></span> | <span class="t">So, now we have these two prompts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12029" target="_blank">03:20:29.920</a></span> | <span class="t">What we do is we concatenate them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12031" target="_blank">03:20:31.680</a></span> | <span class="t">They will become the batch of our input to the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12043" target="_blank">03:20:43.280</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12049" target="_blank">03:20:49.140</a></span> | <span class="t">So, basically what we are doing is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12051" target="_blank">03:20:51.520</a></span> | <span class="t">We are taking the conditional and unconditional input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12054" target="_blank">03:20:54.240</a></span> | <span class="t">And we are combining them into one single tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12056" target="_blank">03:20:56.560</a></span> | <span class="t">So, they will become a tensor of batch size 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12060" target="_blank">03:21:00.640</a></span> | <span class="t">So, 2 sequence length and dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12065" target="_blank">03:21:05.200</a></span> | <span class="t">Where sequence length is actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12067" target="_blank">03:21:07.760</a></span> | <span class="t">We can already write it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12069" target="_blank">03:21:09.040</a></span> | <span class="t">It will become 2 by 77 by 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12072" target="_blank">03:21:12.800</a></span> | <span class="t">Because 77 is the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12074" target="_blank">03:21:14.400</a></span> | <span class="t">And the dimension is 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12077" target="_blank">03:21:17.840</a></span> | <span class="t">If we don't want to do conditional classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12084" target="_blank">03:21:24.880</a></span> | <span class="t">We only need to use the prompt and that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12088" target="_blank">03:21:28.080</a></span> | <span class="t">So, we do only one step through the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12091" target="_blank">03:21:31.520</a></span> | <span class="t">And only with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12093" target="_blank">03:21:33.920</a></span> | <span class="t">Without combining the unconditional input with the conditional input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12098" target="_blank">03:21:38.240</a></span> | <span class="t">But in this case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12098" target="_blank">03:21:38.880</a></span> | <span class="t">We cannot decide how much the model pays attention to the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12104" target="_blank">03:21:44.880</a></span> | <span class="t">Because we don't have anything to combine it with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12108" target="_blank">03:21:48.240</a></span> | <span class="t">So, again we take the just the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12117" target="_blank">03:21:57.920</a></span> | <span class="t">Just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12118" target="_blank">03:21:58.800</a></span> | <span class="t">You can take it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12122" target="_blank">03:22:02.560</a></span> | <span class="t">Let's call it just tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12124" target="_blank">03:22:04.480</a></span> | <span class="t">And then we transform this into a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12129" target="_blank">03:22:09.280</a></span> | <span class="t">Tensor long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12136" target="_blank">03:22:16.640</a></span> | <span class="t">We put it in the right device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12138" target="_blank">03:22:18.400</a></span> | <span class="t">We calculated the context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12142" target="_blank">03:22:22.560</a></span> | <span class="t">Which is a one big tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12144" target="_blank">03:22:24.480</a></span> | <span class="t">We pass it through clip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12146" target="_blank">03:22:26.720</a></span> | <span class="t">But this case it will be only one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12150" target="_blank">03:22:30.720</a></span> | <span class="t">Only one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12152" target="_blank">03:22:32.800</a></span> | <span class="t">So, the batch size will be one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12154" target="_blank">03:22:34.160</a></span> | <span class="t">So, the batch dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12155" target="_blank">03:22:35.440</a></span> | <span class="t">The sequence is again 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12157" target="_blank">03:22:37.520</a></span> | <span class="t">And the dimension is 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12159" target="_blank">03:22:39.520</a></span> | <span class="t">So, here we are combining two prompts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12161" target="_blank">03:22:41.360</a></span> | <span class="t">Here we are combining one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12162" target="_blank">03:22:42.960</a></span> | <span class="t">Why?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12163" target="_blank">03:22:43.200</a></span> | <span class="t">Because we will run through the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12165" target="_blank">03:22:45.040</a></span> | <span class="t">Two prompts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12165" target="_blank">03:22:45.840</a></span> | <span class="t">One unconditioned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12167" target="_blank">03:22:47.040</a></span> | <span class="t">One conditioned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12168" target="_blank">03:22:48.080</a></span> | <span class="t">So, one with the prompt that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12170" target="_blank">03:22:50.160</a></span> | <span class="t">One with the empty string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12171" target="_blank">03:22:51.520</a></span> | <span class="t">And the model will produce two outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12173" target="_blank">03:22:53.840</a></span> | <span class="t">Because the model takes care of the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12176" target="_blank">03:22:56.400</a></span> | <span class="t">That's why we have the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12177" target="_blank">03:22:57.840</a></span> | <span class="t">Since we have finished using the clip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12182" target="_blank">03:23:02.480</a></span> | <span class="t">We can move it to the idle device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12184" target="_blank">03:23:04.480</a></span> | <span class="t">This is very useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12185" target="_blank">03:23:05.520</a></span> | <span class="t">Actually, if you have a very limited GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12188" target="_blank">03:23:08.640</a></span> | <span class="t">And you want to offload the models after using them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12191" target="_blank">03:23:11.760</a></span> | <span class="t">You can offload them back to the CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12193" target="_blank">03:23:13.440</a></span> | <span class="t">By moving them to the CPU again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12195" target="_blank">03:23:15.840</a></span> | <span class="t">And then we load the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12201" target="_blank">03:23:21.920</a></span> | <span class="t">For now, we didn't define the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12203" target="_blank">03:23:23.680</a></span> | <span class="t">But we use it and later we build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12206" target="_blank">03:23:26.480</a></span> | <span class="t">Because it's better to build it after you know how it is used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12210" target="_blank">03:23:30.720</a></span> | <span class="t">If we build it before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12212" target="_blank">03:23:32.560</a></span> | <span class="t">I think it's easy to get lost in what is happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12215" target="_blank">03:23:35.200</a></span> | <span class="t">What's happening actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12216" target="_blank">03:23:36.720</a></span> | <span class="t">So, if the sampler name is ddpm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12220" target="_blank">03:23:40.960</a></span> | <span class="t">ddpm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12224" target="_blank">03:23:44.960</a></span> | <span class="t">Then we build the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12226" target="_blank">03:23:46.960</a></span> | <span class="t">ddpm sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12229" target="_blank">03:23:49.520</a></span> | <span class="t">We pass it to the noise generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12231" target="_blank">03:23:51.440</a></span> | <span class="t">And we tell the sampler how many steps we want to do for the inferencing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12235" target="_blank">03:23:55.920</a></span> | <span class="t">And I will show you later why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12240" target="_blank">03:24:00.480</a></span> | <span class="t">If the sampler is not ddpm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12243" target="_blank">03:24:03.920</a></span> | <span class="t">Then we raise an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12244" target="_blank">03:24:04.960</a></span> | <span class="t">Because we didn't implement any other sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12248" target="_blank">03:24:08.720</a></span> | <span class="t">Why we need to tell him how many steps?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12261" target="_blank">03:24:21.600</a></span> | <span class="t">Because as you remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12262" target="_blank">03:24:22.800</a></span> | <span class="t">Let's go here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12263" target="_blank">03:24:23.920</a></span> | <span class="t">Here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12266" target="_blank">03:24:26.820</a></span> | <span class="t">This scheduler needs to do many steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12270" target="_blank">03:24:30.240</a></span> | <span class="t">How many?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12270" target="_blank">03:24:30.800</a></span> | <span class="t">We tell him exactly how many we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12273" target="_blank">03:24:33.120</a></span> | <span class="t">In this case the denoisification steps will be 50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12276" target="_blank">03:24:36.960</a></span> | <span class="t">Even if during the training we have maximum 1000 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12281" target="_blank">03:24:41.120</a></span> | <span class="t">During inferencing we don't need to do 1000 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12283" target="_blank">03:24:43.600</a></span> | <span class="t">We can do less.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12284" target="_blank">03:24:44.720</a></span> | <span class="t">Of course usually the more steps you do the better the quality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12287" target="_blank">03:24:47.520</a></span> | <span class="t">Because the more noise you can remove.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12290" target="_blank">03:24:50.880</a></span> | <span class="t">But with different samplers they work in different way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12295" target="_blank">03:24:55.920</a></span> | <span class="t">And with ddpm usually 50 is good enough to get a nice result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12300" target="_blank">03:25:00.000</a></span> | <span class="t">For some other sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12300" target="_blank">03:25:00.880</a></span> | <span class="t">For example ddim you can do less steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12303" target="_blank">03:25:03.120</a></span> | <span class="t">For some other samplers that work on with differential equations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12307" target="_blank">03:25:07.600</a></span> | <span class="t">You can do even less.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12309" target="_blank">03:25:09.120</a></span> | <span class="t">Depends on which sampler you use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12310" target="_blank">03:25:10.640</a></span> | <span class="t">And how lucky you are with the particular prompt actually also.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12315" target="_blank">03:25:15.920</a></span> | <span class="t">This is the latency that will run through the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12326" target="_blank">03:25:26.400</a></span> | <span class="t">And as you know it's of size "lat_height" and "lat_width".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12332" target="_blank">03:25:32.480</a></span> | <span class="t">Which we defined before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12333" target="_blank">03:25:33.600</a></span> | <span class="t">So it's 512 divided by 8 by 512 divided by 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12337" target="_blank">03:25:37.840</a></span> | <span class="t">So 64 by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12339" target="_blank">03:25:39.360</a></span> | <span class="t">And now let's do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12343" target="_blank">03:25:43.280</a></span> | <span class="t">What happens if the user specifies an input image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12347" target="_blank">03:25:47.280</a></span> | <span class="t">So if we have a prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12349" target="_blank">03:25:49.600</a></span> | <span class="t">We can take care of the prompt by either running a classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12356" target="_blank">03:25:56.000</a></span> | <span class="t">Which means combining the output of the model with the prompt and without the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12363" target="_blank">03:26:03.520</a></span> | <span class="t">According to this scale here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12365" target="_blank">03:26:05.920</a></span> | <span class="t">Or we can directly just ask the model to output only one image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12372" target="_blank">03:26:12.480</a></span> | <span class="t">Only using the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12373" target="_blank">03:26:13.600</a></span> | <span class="t">But then we cannot combine the two output with this scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12377" target="_blank">03:26:17.360</a></span> | <span class="t">What happens however if we don't want to do text to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12380" target="_blank">03:26:20.960</a></span> | <span class="t">But we want to do image to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12382" target="_blank">03:26:22.800</a></span> | <span class="t">If we do image to image as we saw before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12385" target="_blank">03:26:25.680</a></span> | <span class="t">We start with an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12387" target="_blank">03:26:27.120</a></span> | <span class="t">We encode it with the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12389" target="_blank">03:26:29.120</a></span> | <span class="t">And then we add noise to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12390" target="_blank">03:26:30.560</a></span> | <span class="t">And then we ask the scheduler to remove noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12392" target="_blank">03:26:32.720</a></span> | <span class="t">Noise, noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12393" target="_blank">03:26:33.440</a></span> | <span class="t">But since the unit will also be conditioned by the text prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12398" target="_blank">03:26:38.400</a></span> | <span class="t">We hope that while the unit will denoise this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12403" target="_blank">03:26:43.520</a></span> | <span class="t">It will move it towards this prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12406" target="_blank">03:26:46.960</a></span> | <span class="t">So this is what we will do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12408" target="_blank">03:26:48.080</a></span> | <span class="t">First of things we load the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12410" target="_blank">03:26:50.560</a></span> | <span class="t">And we encode it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12411" target="_blank">03:26:51.760</a></span> | <span class="t">And we add noise to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12415" target="_blank">03:26:55.120</a></span> | <span class="t">So if an input image is specified.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12417" target="_blank">03:26:57.760</a></span> | <span class="t">We load the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12420" target="_blank">03:27:00.960</a></span> | <span class="t">We move it to the device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12428" target="_blank">03:27:08.080</a></span> | <span class="t">In case we are using CUDA for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12430" target="_blank">03:27:10.240</a></span> | <span class="t">Then we load the tensor of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12434" target="_blank">03:27:14.400</a></span> | <span class="t">We resize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12438" target="_blank">03:27:18.640</a></span> | <span class="t">We make sure that it's 512 by 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12441" target="_blank">03:27:21.280</a></span> | <span class="t">With 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12447" target="_blank">03:27:27.280</a></span> | <span class="t">And then we transform it into a NumPy array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12451" target="_blank">03:27:31.120</a></span> | <span class="t">And then into a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12455" target="_blank">03:27:35.040</a></span> | <span class="t">So what will be the size here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12476" target="_blank">03:27:56.400</a></span> | <span class="t">It will be height by width by channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12480" target="_blank">03:28:00.800</a></span> | <span class="t">And the channel will be 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12483" target="_blank">03:28:03.120</a></span> | <span class="t">The next thing we do is we rescale this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12486" target="_blank">03:28:06.080</a></span> | <span class="t">What does it mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12486" target="_blank">03:28:06.960</a></span> | <span class="t">That the input of this unit should be normalized between.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12492" target="_blank">03:28:12.480</a></span> | <span class="t">Should be, sorry, rescaled between -1 and +1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12496" target="_blank">03:28:16.240</a></span> | <span class="t">Because if we load the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12497" target="_blank">03:28:17.680</a></span> | <span class="t">It will have three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12499" target="_blank">03:28:19.360</a></span> | <span class="t">Each channel will be between 0 and 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12503" target="_blank">03:28:23.200</a></span> | <span class="t">So each pixel have three channels RGB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12505" target="_blank">03:28:25.920</a></span> | <span class="t">And each number is between 0 and 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12508" target="_blank">03:28:28.480</a></span> | <span class="t">But this is not what the unit wants as input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12511" target="_blank">03:28:31.200</a></span> | <span class="t">The unit wants every channel, every pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12513" target="_blank">03:28:33.760</a></span> | <span class="t">To be between -1 and +1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12515" target="_blank">03:28:35.680</a></span> | <span class="t">So we will do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12517" target="_blank">03:28:37.440</a></span> | <span class="t">We will build it later this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12523" target="_blank">03:28:43.440</a></span> | <span class="t">It's called the rescale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12524" target="_blank">03:28:44.640</a></span> | <span class="t">To transform anything from that is from between 0 and 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12532" target="_blank">03:28:52.240</a></span> | <span class="t">Into something that is between -1 and +1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12537" target="_blank">03:28:57.680</a></span> | <span class="t">And this will not change the size of the tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12542" target="_blank">03:29:02.640</a></span> | <span class="t">We add the batch dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12544" target="_blank">03:29:04.000</a></span> | <span class="t">Unsqueeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12547" target="_blank">03:29:07.840</a></span> | <span class="t">This adds the batch dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12551" target="_blank">03:29:11.600</a></span> | <span class="t">Batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12557" target="_blank">03:29:17.040</a></span> | <span class="t">Okay, and then we change the order of the dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12564" target="_blank">03:29:24.640</a></span> | <span class="t">Which is 0, 3, 1, 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12574" target="_blank">03:29:34.960</a></span> | <span class="t">Why?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12576" target="_blank">03:29:36.880</a></span> | <span class="t">Because as you know the encoder of the variation autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12581" target="_blank">03:29:41.600</a></span> | <span class="t">Wants batch size, channel, height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12585" target="_blank">03:29:45.520</a></span> | <span class="t">While we have batch size, height, width, channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12588" target="_blank">03:29:48.480</a></span> | <span class="t">So we permute them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12589" target="_blank">03:29:49.520</a></span> | <span class="t">So to obtain the correct input for the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12593" target="_blank">03:29:53.120</a></span> | <span class="t">We have this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12595" target="_blank">03:29:55.680</a></span> | <span class="t">Go into channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12598" target="_blank">03:29:58.960</a></span> | <span class="t">And height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12604" target="_blank">03:30:04.960</a></span> | <span class="t">And then this part we can delete.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12607" target="_blank">03:30:07.360</a></span> | <span class="t">Okay, this is the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12609" target="_blank">03:30:09.520</a></span> | <span class="t">Then what we do is we sample some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12613" target="_blank">03:30:13.840</a></span> | <span class="t">Because as you remember the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12615" target="_blank">03:30:15.920</a></span> | <span class="t">To run the encoder we need some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12618" target="_blank">03:30:18.640</a></span> | <span class="t">And then he will sample from this particular Gaussian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12621" target="_blank">03:30:21.280</a></span> | <span class="t">That we have defined before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12622" target="_blank">03:30:22.560</a></span> | <span class="t">So encoder noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12625" target="_blank">03:30:25.920</a></span> | <span class="t">We sample it from our generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12628" target="_blank">03:30:28.640</a></span> | <span class="t">So as you we have defined this generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12634" target="_blank">03:30:34.400</a></span> | <span class="t">So that we can define only one seed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12636" target="_blank">03:30:36.480</a></span> | <span class="t">And we can also make the output deterministic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12640" target="_blank">03:30:40.320</a></span> | <span class="t">If we never change the seed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12641" target="_blank">03:30:41.600</a></span> | <span class="t">And this is why we use the generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12645" target="_blank">03:30:45.680</a></span> | <span class="t">Latent shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12647" target="_blank">03:30:47.040</a></span> | <span class="t">Okay, and now let's run it through the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12649" target="_blank">03:30:49.760</a></span> | <span class="t">Run the image through the of the VAE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12660" target="_blank">03:31:00.160</a></span> | <span class="t">This will produce latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12663" target="_blank">03:31:03.280</a></span> | <span class="t">So input image tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12667" target="_blank">03:31:07.120</a></span> | <span class="t">And then we give it some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12670" target="_blank">03:31:10.000</a></span> | <span class="t">Now we have to run it through the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12674" target="_blank">03:31:14.000</a></span> | <span class="t">And then we give it some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12675" target="_blank">03:31:15.280</a></span> | <span class="t">Now we are exactly here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12678" target="_blank">03:31:18.240</a></span> | <span class="t">We produced this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12679" target="_blank">03:31:19.520</a></span> | <span class="t">This is our latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12680" target="_blank">03:31:20.640</a></span> | <span class="t">So we give the image to the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12682" target="_blank">03:31:22.560</a></span> | <span class="t">Along with some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12683" target="_blank">03:31:23.920</a></span> | <span class="t">It will produce a latent representation of this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12687" target="_blank">03:31:27.280</a></span> | <span class="t">Now we need to tell our...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12689" target="_blank">03:31:29.920</a></span> | <span class="t">As you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12692" target="_blank">03:31:32.080</a></span> | <span class="t">We need to add some noise to this latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12694" target="_blank">03:31:34.640</a></span> | <span class="t">How can we add noise?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12695" target="_blank">03:31:35.600</a></span> | <span class="t">We use our scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12696" target="_blank">03:31:36.800</a></span> | <span class="t">The strength basically tells us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12700" target="_blank">03:31:40.960</a></span> | <span class="t">The strength parameter that we defined here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12703" target="_blank">03:31:43.760</a></span> | <span class="t">Tells us how much we want the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12706" target="_blank">03:31:46.800</a></span> | <span class="t">To pay attention to the input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12709" target="_blank">03:31:49.120</a></span> | <span class="t">When generating the output image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12710" target="_blank">03:31:50.960</a></span> | <span class="t">The more the strength.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12713" target="_blank">03:31:53.360</a></span> | <span class="t">The more the noise we add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12715" target="_blank">03:31:55.360</a></span> | <span class="t">So the more the strength.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12717" target="_blank">03:31:57.600</a></span> | <span class="t">The more the strong the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12719" target="_blank">03:31:59.200</a></span> | <span class="t">So the model will be more creative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12722" target="_blank">03:32:02.480</a></span> | <span class="t">Because the model will have more noise to remove.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12725" target="_blank">03:32:05.440</a></span> | <span class="t">And can create a different image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12728" target="_blank">03:32:08.000</a></span> | <span class="t">But if we add less noise to this initial image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12731" target="_blank">03:32:11.200</a></span> | <span class="t">The model cannot be very creative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12733" target="_blank">03:32:13.120</a></span> | <span class="t">Because most of the image is already defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12735" target="_blank">03:32:15.920</a></span> | <span class="t">So there is not much noise to remove.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12737" target="_blank">03:32:17.680</a></span> | <span class="t">So we expect that the output will resemble more or less the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12741" target="_blank">03:32:21.840</a></span> | <span class="t">So this strength here basically means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12746" target="_blank">03:32:26.240</a></span> | <span class="t">The more noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12747" target="_blank">03:32:27.440</a></span> | <span class="t">How much noise to add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12748" target="_blank">03:32:28.960</a></span> | <span class="t">The more noise we add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12750" target="_blank">03:32:30.480</a></span> | <span class="t">The less the output will resemble the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12753" target="_blank">03:32:33.120</a></span> | <span class="t">The less noise we add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12754" target="_blank">03:32:34.400</a></span> | <span class="t">The more the output will resemble the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12757" target="_blank">03:32:37.520</a></span> | <span class="t">Because the scheduler, the unit sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12760" target="_blank">03:32:40.880</a></span> | <span class="t">Has less possibility of changing the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12764" target="_blank">03:32:44.640</a></span> | <span class="t">Because there is less noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12765" target="_blank">03:32:45.600</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12769" target="_blank">03:32:49.680</a></span> | <span class="t">First we tell the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12772" target="_blank">03:32:52.080</a></span> | <span class="t">What is the strength that we have defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12774" target="_blank">03:32:54.320</a></span> | <span class="t">And later we will see what is this method doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12777" target="_blank">03:32:57.200</a></span> | <span class="t">But for now we just write it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12779" target="_blank">03:32:59.760</a></span> | <span class="t">And then we ask the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12781" target="_blank">03:33:01.040</a></span> | <span class="t">To add noise to our latency here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12783" target="_blank">03:33:03.200</a></span> | <span class="t">According to the strength that we have defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12786" target="_blank">03:33:06.800</a></span> | <span class="t">Add noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12793" target="_blank">03:33:13.280</a></span> | <span class="t">Basically the sampler will create.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12806" target="_blank">03:33:26.240</a></span> | <span class="t">By setting the strength.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12807" target="_blank">03:33:27.280</a></span> | <span class="t">Will create a time step schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12809" target="_blank">03:33:29.440</a></span> | <span class="t">Later we will see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12810" target="_blank">03:33:30.800</a></span> | <span class="t">And by defining this time step schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12813" target="_blank">03:33:33.600</a></span> | <span class="t">It will.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12814" target="_blank">03:33:34.320</a></span> | <span class="t">We will start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12815" target="_blank">03:33:35.200</a></span> | <span class="t">What is the initial noise level we will start with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12817" target="_blank">03:33:37.920</a></span> | <span class="t">Because if we set the noise level to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12819" target="_blank">03:33:39.680</a></span> | <span class="t">For example the strength to be one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12821" target="_blank">03:33:41.280</a></span> | <span class="t">We will start with the maximum noise level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12823" target="_blank">03:33:43.440</a></span> | <span class="t">But if we set the strength to be 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12826" target="_blank">03:33:46.480</a></span> | <span class="t">We will start with half noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12828" target="_blank">03:33:48.800</a></span> | <span class="t">Not all completely noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12830" target="_blank">03:33:50.240</a></span> | <span class="t">And later this will be more clear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12833" target="_blank">03:33:53.600</a></span> | <span class="t">When we actually build the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12835" target="_blank">03:33:55.360</a></span> | <span class="t">So now just remember that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12836" target="_blank">03:33:56.800</a></span> | <span class="t">We are exactly here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12837" target="_blank">03:33:57.920</a></span> | <span class="t">So we have the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12839" target="_blank">03:33:59.120</a></span> | <span class="t">We transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12840" target="_blank">03:34:00.080</a></span> | <span class="t">We compress it with the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12842" target="_blank">03:34:02.240</a></span> | <span class="t">Became a latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12843" target="_blank">03:34:03.120</a></span> | <span class="t">We added some noise to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12844" target="_blank">03:34:04.640</a></span> | <span class="t">According to the strength level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12846" target="_blank">03:34:06.080</a></span> | <span class="t">And then we need to pass it to the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12849" target="_blank">03:34:09.680</a></span> | <span class="t">To the diffusion model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12850" target="_blank">03:34:10.720</a></span> | <span class="t">So now we don't need the encoder anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12852" target="_blank">03:34:12.400</a></span> | <span class="t">We can set it to the idle device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12855" target="_blank">03:34:15.440</a></span> | <span class="t">If the user didn't specify any image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12859" target="_blank">03:34:19.760</a></span> | <span class="t">Then how can we start the denoising?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12862" target="_blank">03:34:22.480</a></span> | <span class="t">It means that we want to do text to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12864" target="_blank">03:34:24.880</a></span> | <span class="t">So we start with random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12867" target="_blank">03:34:27.280</a></span> | <span class="t">So we start with random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12868" target="_blank">03:34:28.800</a></span> | <span class="t">Let's sample some random noise then.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12871" target="_blank">03:34:31.520</a></span> | <span class="t">Generator and device is device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12882" target="_blank">03:34:42.400</a></span> | <span class="t">So let me write some comments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12885" target="_blank">03:34:45.440</a></span> | <span class="t">If we are doing text to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12889" target="_blank">03:34:49.680</a></span> | <span class="t">Start with random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12892" target="_blank">03:34:52.160</a></span> | <span class="t">Random noise defined as N01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12896" target="_blank">03:34:56.480</a></span> | <span class="t">Or N0i actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12898" target="_blank">03:34:58.880</a></span> | <span class="t">And we then finally load the diffusion model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12905" target="_blank">03:35:05.920</a></span> | <span class="t">Which is our unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12906" target="_blank">03:35:06.880</a></span> | <span class="t">Diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12909" target="_blank">03:35:09.200</a></span> | <span class="t">It's models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12910" target="_blank">03:35:10.080</a></span> | <span class="t">Diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12912" target="_blank">03:35:12.160</a></span> | <span class="t">Later we see what is this model and how to load it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12914" target="_blank">03:35:14.640</a></span> | <span class="t">We take it to our device where we are working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12918" target="_blank">03:35:18.640</a></span> | <span class="t">So for example CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12919" target="_blank">03:35:19.840</a></span> | <span class="t">And then our sampler will define some time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12924" target="_blank">03:35:24.880</a></span> | <span class="t">Time steps basically means that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12927" target="_blank">03:35:27.840</a></span> | <span class="t">As you remember to train the model we have maximum of 1000 time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12931" target="_blank">03:35:31.680</a></span> | <span class="t">But when we inference we don't need to do 1001 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12934" target="_blank">03:35:34.640</a></span> | <span class="t">In our case we will be doing for example 50 steps of inferencing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12938" target="_blank">03:35:38.400</a></span> | <span class="t">If the maximum strength level is 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12941" target="_blank">03:35:41.840</a></span> | <span class="t">For example if the maximum level is 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12946" target="_blank">03:35:46.400</a></span> | <span class="t">The minimum level will be 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12948" target="_blank">03:35:48.720</a></span> | <span class="t">Or if the maximum level is 999.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12950" target="_blank">03:35:50.720</a></span> | <span class="t">The minimum will be 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12952" target="_blank">03:35:52.320</a></span> | <span class="t">And this is a linear time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12954" target="_blank">03:35:54.960</a></span> | <span class="t">If we do only 50 it means that we need to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12957" target="_blank">03:35:57.760</a></span> | <span class="t">For example we start with 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12959" target="_blank">03:35:59.920</a></span> | <span class="t">And then we do every 20.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12961" target="_blank">03:36:01.760</a></span> | <span class="t">So 980.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12963" target="_blank">03:36:03.280</a></span> | <span class="t">Then 960.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12964" target="_blank">03:36:04.480</a></span> | <span class="t">940.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12965" target="_blank">03:36:05.680</a></span> | <span class="t">920.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12967" target="_blank">03:36:07.040</a></span> | <span class="t">900.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12967" target="_blank">03:36:07.680</a></span> | <span class="t">Then 800.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12969" target="_blank">03:36:09.280</a></span> | <span class="t">What?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12971" target="_blank">03:36:11.920</a></span> | <span class="t">880.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12972" target="_blank">03:36:12.880</a></span> | <span class="t">860.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12974" target="_blank">03:36:14.800</a></span> | <span class="t">840.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12975" target="_blank">03:36:15.840</a></span> | <span class="t">820 etc etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12977" target="_blank">03:36:17.680</a></span> | <span class="t">Until we arrive to the 0th level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12979" target="_blank">03:36:19.280</a></span> | <span class="t">Basically each of these time steps indicates a noise level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12984" target="_blank">03:36:24.240</a></span> | <span class="t">So when we denoise the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12989" target="_blank">03:36:29.520</a></span> | <span class="t">Or the initial noise in case we are doing the text to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12992" target="_blank">03:36:32.400</a></span> | <span class="t">We can tell the scheduler to remove noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12996" target="_blank">03:36:36.000</a></span> | <span class="t">According to particular time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=12998" target="_blank">03:36:38.480</a></span> | <span class="t">Which are defined by how many inference steps we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13001" target="_blank">03:36:41.440</a></span> | <span class="t">And this is exactly what we are going to do now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13004" target="_blank">03:36:44.320</a></span> | <span class="t">When we initialize the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13007" target="_blank">03:36:47.200</a></span> | <span class="t">We tell him how many steps we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13009" target="_blank">03:36:49.520</a></span> | <span class="t">And he will create this time step schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13012" target="_blank">03:36:52.720</a></span> | <span class="t">So according to how many we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13014" target="_blank">03:36:54.640</a></span> | <span class="t">And now we just go through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13016" target="_blank">03:36:56.640</a></span> | <span class="t">So we tell the time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13018" target="_blank">03:36:58.480</a></span> | <span class="t">We create tqdm which is a progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13022" target="_blank">03:37:02.960</a></span> | <span class="t">We take the time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13024" target="_blank">03:37:04.080</a></span> | <span class="t">And for each of these time steps we denoise the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13030" target="_blank">03:37:10.000</a></span> | <span class="t">So we have 1300.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13038" target="_blank">03:37:18.560</a></span> | <span class="t">This is our...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13039" target="_blank">03:37:19.680</a></span> | <span class="t">We need to tell the unit as you remember diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13043" target="_blank">03:37:23.200</a></span> | <span class="t">The unit has as input the time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13046" target="_blank">03:37:26.560</a></span> | <span class="t">So what is the time step we want to denoise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13049" target="_blank">03:37:29.520</a></span> | <span class="t">The context which is the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13052" target="_blank">03:37:32.000</a></span> | <span class="t">Or in case we are doing a classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13055" target="_blank">03:37:35.040</a></span> | <span class="t">Also the unconditional prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13056" target="_blank">03:37:36.560</a></span> | <span class="t">And the latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13058" target="_blank">03:37:38.400</a></span> | <span class="t">The current state of the latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13060" target="_blank">03:37:40.400</a></span> | <span class="t">Because we will start with some latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13062" target="_blank">03:37:42.320</a></span> | <span class="t">And then keep denoising it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13063" target="_blank">03:37:43.600</a></span> | <span class="t">And keep denoising it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13064" target="_blank">03:37:44.800</a></span> | <span class="t">Keep denoising it according to the time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13067" target="_blank">03:37:47.360</a></span> | <span class="t">To the time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13068" target="_blank">03:37:48.160</a></span> | <span class="t">So we calculate first the time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13071" target="_blank">03:37:51.280</a></span> | <span class="t">Which is an embedding of the current time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13073" target="_blank">03:37:53.680</a></span> | <span class="t">And we will obtain it from this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13078" target="_blank">03:37:58.160</a></span> | <span class="t">Later we define it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13082" target="_blank">03:38:02.240</a></span> | <span class="t">This function basically will convert a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13084" target="_blank">03:38:04.480</a></span> | <span class="t">So the time step into a vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13086" target="_blank">03:38:06.400</a></span> | <span class="t">One of size 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13090" target="_blank">03:38:10.000</a></span> | <span class="t">That describes this particular time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13092" target="_blank">03:38:12.320</a></span> | <span class="t">And as you will see later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13095" target="_blank">03:38:15.200</a></span> | <span class="t">It's basically just equal to the positional encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13098" target="_blank">03:38:18.000</a></span> | <span class="t">That we did for the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13100" target="_blank">03:38:20.400</a></span> | <span class="t">So in the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13101" target="_blank">03:38:21.520</a></span> | <span class="t">We use the sines and the cosines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13102" target="_blank">03:38:22.960</a></span> | <span class="t">To define the position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13104" target="_blank">03:38:24.400</a></span> | <span class="t">Here we use the sines and cosines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13105" target="_blank">03:38:25.760</a></span> | <span class="t">To define the time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13106" target="_blank">03:38:26.800</a></span> | <span class="t">And let's build the model input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13110" target="_blank">03:38:30.480</a></span> | <span class="t">Which is the latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13111" target="_blank">03:38:31.440</a></span> | <span class="t">Which is of shape patch size 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13116" target="_blank">03:38:36.880</a></span> | <span class="t">Because it's the input of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13120" target="_blank">03:38:40.800</a></span> | <span class="t">Of the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13122" target="_blank">03:38:42.080</a></span> | <span class="t">Which is of size 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13123" target="_blank">03:38:43.760</a></span> | <span class="t">Sorry, which has four channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13128" target="_blank">03:38:48.160</a></span> | <span class="t">And then has latency height.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13130" target="_blank">03:38:50.320</a></span> | <span class="t">Height and the latency width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13134" target="_blank">03:38:54.240</a></span> | <span class="t">Which is 64 by 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13136" target="_blank">03:38:56.000</a></span> | <span class="t">Now if we do this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13141" target="_blank">03:39:01.760</a></span> | <span class="t">We need to send.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13144" target="_blank">03:39:04.080</a></span> | <span class="t">Basically we are sending the conditioned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13146" target="_blank">03:39:06.640</a></span> | <span class="t">Where is it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13148" target="_blank">03:39:08.240</a></span> | <span class="t">Here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13149" target="_blank">03:39:09.380</a></span> | <span class="t">We send the conditional input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13152" target="_blank">03:39:12.480</a></span> | <span class="t">But also the unconditional input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13154" target="_blank">03:39:14.080</a></span> | <span class="t">If we do the classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13156" target="_blank">03:39:16.000</a></span> | <span class="t">Which means that we need to send.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13157" target="_blank">03:39:17.760</a></span> | <span class="t">The same latent with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13160" target="_blank">03:39:20.320</a></span> | <span class="t">And without the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13161" target="_blank">03:39:21.840</a></span> | <span class="t">And so what we can do is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13163" target="_blank">03:39:23.680</a></span> | <span class="t">We can repeat this latent twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13165" target="_blank">03:39:25.760</a></span> | <span class="t">If we are doing the classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13167" target="_blank">03:39:27.600</a></span> | <span class="t">It will become model input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13172" target="_blank">03:39:32.080</a></span> | <span class="t">By repeat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13173" target="_blank">03:39:33.760</a></span> | <span class="t">On one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13177" target="_blank">03:39:37.120</a></span> | <span class="t">This will basically transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13178" target="_blank">03:39:38.640</a></span> | <span class="t">Batch size 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13183" target="_blank">03:39:43.120</a></span> | <span class="t">So this is going to be twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13197" target="_blank">03:39:57.120</a></span> | <span class="t">The size of the initial batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13198" target="_blank">03:39:58.960</a></span> | <span class="t">Which is one actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13200" target="_blank">03:40:00.000</a></span> | <span class="t">And four channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13202" target="_blank">03:40:02.720</a></span> | <span class="t">And latency height and latency width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13204" target="_blank">03:40:04.960</a></span> | <span class="t">So basically we are repeating this dimension twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13207" target="_blank">03:40:07.280</a></span> | <span class="t">We are making two copies of the latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13210" target="_blank">03:40:10.720</a></span> | <span class="t">One will be used with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13212" target="_blank">03:40:12.320</a></span> | <span class="t">One without the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13213" target="_blank">03:40:13.520</a></span> | <span class="t">So now we do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13216" target="_blank">03:40:16.160</a></span> | <span class="t">We check the model output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13218" target="_blank">03:40:18.000</a></span> | <span class="t">What is the model output?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13219" target="_blank">03:40:19.120</a></span> | <span class="t">It is the predicted noise by the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13222" target="_blank">03:40:22.000</a></span> | <span class="t">So the model output is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13224" target="_blank">03:40:24.080</a></span> | <span class="t">The predicted noise by the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13228" target="_blank">03:40:28.400</a></span> | <span class="t">We do diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13233" target="_blank">03:40:33.120</a></span> | <span class="t">Model input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13238" target="_blank">03:40:38.720</a></span> | <span class="t">Context and time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13240" target="_blank">03:40:40.720</a></span> | <span class="t">And if we do classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13245" target="_blank">03:40:45.920</a></span> | <span class="t">We need to combine the conditional output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13249" target="_blank">03:40:49.200</a></span> | <span class="t">And the unconditional output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13250" target="_blank">03:40:50.720</a></span> | <span class="t">Because we are passing the input of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13254" target="_blank">03:40:54.640</a></span> | <span class="t">If we are doing classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13256" target="_blank">03:40:56.080</a></span> | <span class="t">We are giving a batch size of two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13257" target="_blank">03:40:57.760</a></span> | <span class="t">The model will produce an output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13259" target="_blank">03:40:59.440</a></span> | <span class="t">That has batch size of two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13261" target="_blank">03:41:01.040</a></span> | <span class="t">So we can then split it into two different tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13266" target="_blank">03:41:06.160</a></span> | <span class="t">One will be the conditional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13268" target="_blank">03:41:08.000</a></span> | <span class="t">And one will be the unconditional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13270" target="_blank">03:41:10.000</a></span> | <span class="t">So the output conditional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13272" target="_blank">03:41:12.400</a></span> | <span class="t">And the output unconditional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13274" target="_blank">03:41:14.160</a></span> | <span class="t">Are split in this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13276" target="_blank">03:41:16.560</a></span> | <span class="t">Using chunk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13277" target="_blank">03:41:17.360</a></span> | <span class="t">The dimension is along the 0th dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13282" target="_blank">03:41:22.480</a></span> | <span class="t">So by default it's the 0th dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13284" target="_blank">03:41:24.400</a></span> | <span class="t">And then we combine them according to this formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13289" target="_blank">03:41:29.600</a></span> | <span class="t">Where is the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13290" target="_blank">03:41:30.960</a></span> | <span class="t">I missed out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13294" target="_blank">03:41:34.000</a></span> | <span class="t">According to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13297" target="_blank">03:41:37.600</a></span> | <span class="t">This formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13298" target="_blank">03:41:38.800</a></span> | <span class="t">So unconditional output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13300" target="_blank">03:41:40.720</a></span> | <span class="t">Minus the sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13301" target="_blank">03:41:41.840</a></span> | <span class="t">The conditioned output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13302" target="_blank">03:41:42.880</a></span> | <span class="t">Minus the unconditioned output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13304" target="_blank">03:41:44.400</a></span> | <span class="t">Multiplied by the scale that we defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13306" target="_blank">03:41:46.960</a></span> | <span class="t">Plus the unconditioned output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13309" target="_blank">03:41:49.600</a></span> | <span class="t">So the model output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13311" target="_blank">03:41:51.920</a></span> | <span class="t">Will be conditioned scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13315" target="_blank">03:41:55.280</a></span> | <span class="t">Multiplied by the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13318" target="_blank">03:41:58.160</a></span> | <span class="t">Conditioned minus the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13320" target="_blank">03:42:00.880</a></span> | <span class="t">Unconditioned plus the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13323" target="_blank">03:42:03.360</a></span> | <span class="t">Unconditioned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13326" target="_blank">03:42:06.000</a></span> | <span class="t">And then what we do is basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13330" target="_blank">03:42:10.000</a></span> | <span class="t">Okay now comes the let's say the clue part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13333" target="_blank">03:42:13.520</a></span> | <span class="t">So we have a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13336" target="_blank">03:42:16.000</a></span> | <span class="t">That is able to predict the noise in the current latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13340" target="_blank">03:42:20.560</a></span> | <span class="t">So we start for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13341" target="_blank">03:42:21.680</a></span> | <span class="t">Imagine we are doing text to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13343" target="_blank">03:42:23.600</a></span> | <span class="t">So let me go back here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13345" target="_blank">03:42:25.760</a></span> | <span class="t">We are going text to images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13352" target="_blank">03:42:32.080</a></span> | <span class="t">Here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13355" target="_blank">03:42:35.120</a></span> | <span class="t">So we start with some random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13356" target="_blank">03:42:36.960</a></span> | <span class="t">And we transform into latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13360" target="_blank">03:42:40.240</a></span> | <span class="t">Then according to some scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13363" target="_blank">03:42:43.200</a></span> | <span class="t">According to some time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13364" target="_blank">03:42:44.800</a></span> | <span class="t">We keep denoising it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13366" target="_blank">03:42:46.240</a></span> | <span class="t">Now our unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13367" target="_blank">03:42:47.200</a></span> | <span class="t">Will predict the noise in the latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13372" target="_blank">03:42:52.640</a></span> | <span class="t">But how can we remove this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13376" target="_blank">03:42:56.480</a></span> | <span class="t">From the image to obtain a less noisy image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13379" target="_blank">03:42:59.440</a></span> | <span class="t">This is done by the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13382" target="_blank">03:43:02.720</a></span> | <span class="t">So at each step we ask the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13385" target="_blank">03:43:05.280</a></span> | <span class="t">How much noise is in the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13387" target="_blank">03:43:07.360</a></span> | <span class="t">We remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13388" target="_blank">03:43:08.320</a></span> | <span class="t">And then we give it again to the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13390" target="_blank">03:43:10.160</a></span> | <span class="t">And ask how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13391" target="_blank">03:43:11.840</a></span> | <span class="t">And we remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13392" target="_blank">03:43:12.720</a></span> | <span class="t">And then ask again how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13394" target="_blank">03:43:14.800</a></span> | <span class="t">And then we remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13395" target="_blank">03:43:15.680</a></span> | <span class="t">And then how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13397" target="_blank">03:43:17.040</a></span> | <span class="t">And then we remove it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13398" target="_blank">03:43:18.000</a></span> | <span class="t">Until we finish all these time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13400" target="_blank">03:43:20.320</a></span> | <span class="t">After we have finished these time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13403" target="_blank">03:43:23.280</a></span> | <span class="t">We take the latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13405" target="_blank">03:43:25.200</a></span> | <span class="t">Give it to the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13406" target="_blank">03:43:26.320</a></span> | <span class="t">Which will build our image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13408" target="_blank">03:43:28.080</a></span> | <span class="t">And this is exactly what we are doing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13410" target="_blank">03:43:30.320</a></span> | <span class="t">So imagine we don't have any input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13412" target="_blank">03:43:32.240</a></span> | <span class="t">So we have some random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13414" target="_blank">03:43:34.000</a></span> | <span class="t">We define some time steps on this sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13417" target="_blank">03:43:37.520</a></span> | <span class="t">Based on how many inference steps we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13420" target="_blank">03:43:40.800</a></span> | <span class="t">We do all this time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13423" target="_blank">03:43:43.200</a></span> | <span class="t">We give the latency to the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13426" target="_blank">03:43:46.240</a></span> | <span class="t">The unit will tell us how much is the predicted noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13428" target="_blank">03:43:48.960</a></span> | <span class="t">But then we need to remove this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13430" target="_blank">03:43:50.960</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13431" target="_blank">03:43:51.920</a></span> | <span class="t">So let's remove this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13433" target="_blank">03:43:53.520</a></span> | <span class="t">So the latency are equal to sampler dot step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13438" target="_blank">03:43:58.320</a></span> | <span class="t">Time step, latency, model, output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13443" target="_blank">03:44:03.040</a></span> | <span class="t">This basically means take the image from a more noisy version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13451" target="_blank">03:44:11.120</a></span> | <span class="t">Okay, let me write it better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13454" target="_blank">03:44:14.000</a></span> | <span class="t">Remove noise predicted by the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13458" target="_blank">03:44:18.240</a></span> | <span class="t">Unit, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13461" target="_blank">03:44:21.520</a></span> | <span class="t">And this is our loop of denoising.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13466" target="_blank">03:44:26.400</a></span> | <span class="t">Then we can do to idle, diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13469" target="_blank">03:44:29.040</a></span> | <span class="t">Now we have our denoised image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13473" target="_blank">03:44:33.760</a></span> | <span class="t">Because we have done it for many steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13475" target="_blank">03:44:35.520</a></span> | <span class="t">Now what we do is we load the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13479" target="_blank">03:44:39.600</a></span> | <span class="t">Which is models decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13482" target="_blank">03:44:42.960</a></span> | <span class="t">And then our image is run through the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13495" target="_blank">03:44:55.760</a></span> | <span class="t">So we run the latency through the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13497" target="_blank">03:44:57.920</a></span> | <span class="t">So we do this step here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13499" target="_blank">03:44:59.120</a></span> | <span class="t">So we run this latency through the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13501" target="_blank">03:45:01.040</a></span> | <span class="t">This will give the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13502" target="_blank">03:45:02.080</a></span> | <span class="t">It actually will be only one image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13504" target="_blank">03:45:04.880</a></span> | <span class="t">Because we only specify one image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13506" target="_blank">03:45:06.640</a></span> | <span class="t">Then we do images is equal to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13513" target="_blank">03:45:13.360</a></span> | <span class="t">Because the image was initially, as you remember here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13516" target="_blank">03:45:16.960</a></span> | <span class="t">It was rescaled.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13518" target="_blank">03:45:18.000</a></span> | <span class="t">So from 0 to 255 in a new scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13523" target="_blank">03:45:23.520</a></span> | <span class="t">That is between -1 and +1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13525" target="_blank">03:45:25.840</a></span> | <span class="t">Now we do the opposite step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13527" target="_blank">03:45:27.120</a></span> | <span class="t">So rescale again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13529" target="_blank">03:45:29.840</a></span> | <span class="t">From -1 to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13532" target="_blank">03:45:32.800</a></span> | <span class="t">Into 0 to 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13536" target="_blank">03:45:36.320</a></span> | <span class="t">With clamp equal true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13537" target="_blank">03:45:37.920</a></span> | <span class="t">Later we will see this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13540" target="_blank">03:45:40.800</a></span> | <span class="t">It's very easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13541" target="_blank">03:45:41.440</a></span> | <span class="t">It's just a rescaling function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13542" target="_blank">03:45:42.880</a></span> | <span class="t">We permute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13545" target="_blank">03:45:45.120</a></span> | <span class="t">Because to save the image on the CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13547" target="_blank">03:45:47.600</a></span> | <span class="t">We want the channel dimension to be the last one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13549" target="_blank">03:45:49.840</a></span> | <span class="t">Permute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13552" target="_blank">03:45:52.400</a></span> | <span class="t">From 0 to 3.1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13556" target="_blank">03:45:56.320</a></span> | <span class="t">So this one basically will take the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13559" target="_blank">03:45:59.040</a></span> | <span class="t">Channel height width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13564" target="_blank">03:46:04.320</a></span> | <span class="t">Into batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13569" target="_blank">03:46:09.680</a></span> | <span class="t">Height width channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13575" target="_blank">03:46:15.920</a></span> | <span class="t">And then we move the image to the CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13581" target="_blank">03:46:21.840</a></span> | <span class="t">And then we need to convert it into a NumPy array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13594" target="_blank">03:46:34.400</a></span> | <span class="t">And then we return the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13595" target="_blank">03:46:35.680</a></span> | <span class="t">Voila!</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13598" target="_blank">03:46:38.320</a></span> | <span class="t">Let's build this rescale method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13600" target="_blank">03:46:40.080</a></span> | <span class="t">So what is the old scale?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13607" target="_blank">03:46:47.760</a></span> | <span class="t">Old range.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13608" target="_blank">03:46:48.320</a></span> | <span class="t">What is the new range?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13611" target="_blank">03:46:51.920</a></span> | <span class="t">And the clamp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13612" target="_blank">03:46:52.640</a></span> | <span class="t">So let's define the old minimum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13618" target="_blank">03:46:58.640</a></span> | <span class="t">Old maximum is the old range.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13620" target="_blank">03:47:00.880</a></span> | <span class="t">New minimum and new maximum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13624" target="_blank">03:47:04.160</a></span> | <span class="t">New range.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13627" target="_blank">03:47:07.680</a></span> | <span class="t">Minus equal to old min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13634" target="_blank">03:47:14.720</a></span> | <span class="t">x multiply equal to new max minus new min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13640" target="_blank">03:47:20.800</a></span> | <span class="t">Divided by old max minus old min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13648" target="_blank">03:47:28.000</a></span> | <span class="t">x plus equal to new min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13651" target="_blank">03:47:31.520</a></span> | <span class="t">We are just rescaling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13653" target="_blank">03:47:33.600</a></span> | <span class="t">So convert something that is within this range into this range.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13657" target="_blank">03:47:37.040</a></span> | <span class="t">And if it's clamp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13662" target="_blank">03:47:42.240</a></span> | <span class="t">Then x is equal to x.clamp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13664" target="_blank">03:47:44.240</a></span> | <span class="t">New min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13666" target="_blank">03:47:46.880</a></span> | <span class="t">New max.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13669" target="_blank">03:47:49.280</a></span> | <span class="t">And then we return x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13671" target="_blank">03:47:51.680</a></span> | <span class="t">Then we have the time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13675" target="_blank">03:47:55.520</a></span> | <span class="t">The method that we didn't define here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13678" target="_blank">03:47:58.320</a></span> | <span class="t">This getTimeEmbedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13679" target="_blank">03:47:59.760</a></span> | <span class="t">This means basically take the time step which is a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13682" target="_blank">03:48:02.640</a></span> | <span class="t">So which is an integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13684" target="_blank">03:48:04.640</a></span> | <span class="t">And convert it into a vector of size 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13688" target="_blank">03:48:08.320</a></span> | <span class="t">And this will be done exactly using the same system that we use for the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13692" target="_blank">03:48:12.320</a></span> | <span class="t">For the positional embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13693" target="_blank">03:48:13.520</a></span> | <span class="t">So we first define the frequencies of our cosines and the sines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13703" target="_blank">03:48:23.440</a></span> | <span class="t">Exactly using the same formula of the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13706" target="_blank">03:48:26.240</a></span> | <span class="t">So if you remember the formula is equal to the 10,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13710" target="_blank">03:48:30.560</a></span> | <span class="t">1 over 10,000 to the power of something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13713" target="_blank">03:48:33.840</a></span> | <span class="t">Of i.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13714" target="_blank">03:48:34.240</a></span> | <span class="t">I remember correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13717" target="_blank">03:48:37.840</a></span> | <span class="t">So it's power of 10,000 and minus torch.range.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13725" target="_blank">03:48:45.040</a></span> | <span class="t">So I am referring to this formula just in case you forgot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13728" target="_blank">03:48:48.000</a></span> | <span class="t">Let me find it using the slides.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13731" target="_blank">03:48:51.440</a></span> | <span class="t">I am talking about this formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13736" target="_blank">03:48:56.480</a></span> | <span class="t">So the formula that defines the positional encodings here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13739" target="_blank">03:48:59.920</a></span> | <span class="t">Here we just use a different dimension of the embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13742" target="_blank">03:49:02.960</a></span> | <span class="t">This one will produce something that is 160 numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13758" target="_blank">03:49:18.480</a></span> | <span class="t">And this one will produce something that is 200 numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13765" target="_blank">03:49:25.760</a></span> | <span class="t">And 160 numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13767" target="_blank">03:49:27.280</a></span> | <span class="t">Then we multiply it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13771" target="_blank">03:49:31.680</a></span> | <span class="t">We multiply it with the time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13775" target="_blank">03:49:35.840</a></span> | <span class="t">So we create a shape of size 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13779" target="_blank">03:49:39.040</a></span> | <span class="t">So x is equal to torch dot tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13784" target="_blank">03:49:44.480</a></span> | <span class="t">Which is a single time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13786" target="_blank">03:49:46.640</a></span> | <span class="t">Of t type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13789" target="_blank">03:49:49.200</a></span> | <span class="t">Take everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13797" target="_blank">03:49:57.520</a></span> | <span class="t">We add one dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13799" target="_blank">03:49:59.520</a></span> | <span class="t">So we add one dimension here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13802" target="_blank">03:50:02.160</a></span> | <span class="t">This is like doing an unsqueeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13803" target="_blank">03:50:03.920</a></span> | <span class="t">Multiply by the frequencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13806" target="_blank">03:50:06.720</a></span> | <span class="t">And then we multiply this by the sines and the cosine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13813" target="_blank">03:50:13.920</a></span> | <span class="t">Just like we did in the original transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13816" target="_blank">03:50:16.880</a></span> | <span class="t">This one will return a tensor of size 100 by 62.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13820" target="_blank">03:50:20.960</a></span> | <span class="t">So which is 320.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13822" target="_blank">03:50:22.480</a></span> | <span class="t">Because we are concatenating two tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13836" target="_blank">03:50:36.480</a></span> | <span class="t">Not cosine, but sine of x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13838" target="_blank">03:50:38.080</a></span> | <span class="t">And then I concatenated along the dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13842" target="_blank">03:50:42.000</a></span> | <span class="t">The last dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13847" target="_blank">03:50:47.040</a></span> | <span class="t">And this is our time embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13849" target="_blank">03:50:49.680</a></span> | <span class="t">So now let's review what we have built here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13852" target="_blank">03:50:52.000</a></span> | <span class="t">We built basically a system.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13855" target="_blank">03:50:55.360</a></span> | <span class="t">A method that takes the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13858" target="_blank">03:50:58.000</a></span> | <span class="t">The unconditional prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13859" target="_blank">03:50:59.280</a></span> | <span class="t">Also called the negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13861" target="_blank">03:51:01.360</a></span> | <span class="t">The prompt or empty string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13864" target="_blank">03:51:04.640</a></span> | <span class="t">Because if we don't want to use any negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13867" target="_blank">03:51:07.840</a></span> | <span class="t">The input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13868" target="_blank">03:51:08.800</a></span> | <span class="t">So what is the image we want to start from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13870" target="_blank">03:51:10.960</a></span> | <span class="t">In case we want to do an image to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13873" target="_blank">03:51:13.280</a></span> | <span class="t">The strength is how much attention we want to pay to this input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13877" target="_blank">03:51:17.600</a></span> | <span class="t">When we denoise the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13878" target="_blank">03:51:18.800</a></span> | <span class="t">Or how much noise we want to add to it basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13882" target="_blank">03:51:22.160</a></span> | <span class="t">And the more noise we add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13884" target="_blank">03:51:24.800</a></span> | <span class="t">The less the output will resemble the input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13887" target="_blank">03:51:27.760</a></span> | <span class="t">If we want to do classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13891" target="_blank">03:51:31.120</a></span> | <span class="t">Which means that if we want the model to output to output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13894" target="_blank">03:51:34.640</a></span> | <span class="t">One is the output with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13896" target="_blank">03:51:36.960</a></span> | <span class="t">And one without the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13898" target="_blank">03:51:38.320</a></span> | <span class="t">And then we can adjust how much we want to pay attention to the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13902" target="_blank">03:51:42.880</a></span> | <span class="t">According to this scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13904" target="_blank">03:51:44.160</a></span> | <span class="t">And then we defined the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13908" target="_blank">03:51:48.240</a></span> | <span class="t">Which is only one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13908" target="_blank">03:51:48.880</a></span> | <span class="t">The DPM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13909" target="_blank">03:51:49.440</a></span> | <span class="t">And we will define it now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13910" target="_blank">03:51:50.560</a></span> | <span class="t">And how many steps we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13912" target="_blank">03:51:52.880</a></span> | <span class="t">The first thing we do is we create a generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13915" target="_blank">03:51:55.280</a></span> | <span class="t">Which is just a random number generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13917" target="_blank">03:51:57.120</a></span> | <span class="t">Then the second thing we do is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13919" target="_blank">03:51:59.680</a></span> | <span class="t">If we want to do classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13921" target="_blank">03:52:01.520</a></span> | <span class="t">As we need to do the.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13922" target="_blank">03:52:02.960</a></span> | <span class="t">Basically we need to go through the units twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13925" target="_blank">03:52:05.600</a></span> | <span class="t">One with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13926" target="_blank">03:52:06.560</a></span> | <span class="t">One without the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13927" target="_blank">03:52:07.760</a></span> | <span class="t">The thing we do is that actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13929" target="_blank">03:52:09.040</a></span> | <span class="t">We create a batch size of two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13931" target="_blank">03:52:11.120</a></span> | <span class="t">One with the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13932" target="_blank">03:52:12.400</a></span> | <span class="t">And one without the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13933" target="_blank">03:52:13.840</a></span> | <span class="t">Or using the unconditioned prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13935" target="_blank">03:52:15.760</a></span> | <span class="t">Or the negative prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13936" target="_blank">03:52:16.800</a></span> | <span class="t">In case we don't do the classifier free guidance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13940" target="_blank">03:52:20.880</a></span> | <span class="t">We only build one tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13942" target="_blank">03:52:22.480</a></span> | <span class="t">That only includes the prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13943" target="_blank">03:52:23.840</a></span> | <span class="t">The second thing we do is we load.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13946" target="_blank">03:52:26.960</a></span> | <span class="t">If there is an input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13948" target="_blank">03:52:28.240</a></span> | <span class="t">We load it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13949" target="_blank">03:52:29.200</a></span> | <span class="t">So instead of starting from random noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13951" target="_blank">03:52:31.120</a></span> | <span class="t">We start from an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13952" target="_blank">03:52:32.400</a></span> | <span class="t">Which is to which we add the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13954" target="_blank">03:52:34.560</a></span> | <span class="t">According to the strength we have defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13957" target="_blank">03:52:37.200</a></span> | <span class="t">Then for the number of steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13959" target="_blank">03:52:39.120</a></span> | <span class="t">Defined by the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13960" target="_blank">03:52:40.400</a></span> | <span class="t">Which are actually defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13961" target="_blank">03:52:41.520</a></span> | <span class="t">By the number of inference steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13962" target="_blank">03:52:42.880</a></span> | <span class="t">We have defined here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13963" target="_blank">03:52:43.840</a></span> | <span class="t">We do a loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13965" target="_blank">03:52:45.360</a></span> | <span class="t">A for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13966" target="_blank">03:52:46.000</a></span> | <span class="t">That for each for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13968" target="_blank">03:52:48.240</a></span> | <span class="t">Let me go here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13970" target="_blank">03:52:50.720</a></span> | <span class="t">The unit will predict some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13973" target="_blank">03:52:53.360</a></span> | <span class="t">And the scheduler will remove this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13976" target="_blank">03:52:56.240</a></span> | <span class="t">And give a new latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13977" target="_blank">03:52:57.760</a></span> | <span class="t">Then this new latent is fed again to the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13980" target="_blank">03:53:00.080</a></span> | <span class="t">Which will predict some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13981" target="_blank">03:53:01.520</a></span> | <span class="t">And we remove this noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13982" target="_blank">03:53:02.880</a></span> | <span class="t">According to the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13984" target="_blank">03:53:04.320</a></span> | <span class="t">Then we again predict some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13986" target="_blank">03:53:06.080</a></span> | <span class="t">And we remove some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13987" target="_blank">03:53:07.680</a></span> | <span class="t">The only thing we need to understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13989" target="_blank">03:53:09.280</a></span> | <span class="t">Is how we remove the noise from the image now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13991" target="_blank">03:53:11.920</a></span> | <span class="t">Because we know that the unit is trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13994" target="_blank">03:53:14.480</a></span> | <span class="t">To predict the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13995" target="_blank">03:53:15.440</a></span> | <span class="t">But how do we actually remove it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=13996" target="_blank">03:53:16.960</a></span> | <span class="t">And this is the job of the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14000" target="_blank">03:53:20.320</a></span> | <span class="t">So now we need to go build this scheduler here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14003" target="_blank">03:53:23.200</a></span> | <span class="t">So let's go build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14004" target="_blank">03:53:24.960</a></span> | <span class="t">Let's start building our ddpm scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14008" target="_blank">03:53:28.400</a></span> | <span class="t">So ddpm.py</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14010" target="_blank">03:53:30.240</a></span> | <span class="t">Oops I forgot to put it inside the folder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14015" target="_blank">03:53:35.680</a></span> | <span class="t">And let me review one thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14017" target="_blank">03:53:37.920</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14019" target="_blank">03:53:39.860</a></span> | <span class="t">This is wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14023" target="_blank">03:53:43.280</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14023" target="_blank">03:53:43.780</a></span> | <span class="t">So import torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14026" target="_blank">03:53:46.800</a></span> | <span class="t">Import roompy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14029" target="_blank">03:53:49.840</a></span> | <span class="t">And let's create the class ddpm sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14035" target="_blank">03:53:55.120</a></span> | <span class="t">Okay I didn't call it scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14036" target="_blank">03:53:56.880</a></span> | <span class="t">Because I don't want you to be confused with the beta schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14040" target="_blank">03:54:00.320</a></span> | <span class="t">Which we will define later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14041" target="_blank">03:54:01.760</a></span> | <span class="t">So I call it scheduler here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14045" target="_blank">03:54:05.520</a></span> | <span class="t">Oops why I open this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14046" target="_blank">03:54:06.960</a></span> | <span class="t">I call it scheduler here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14049" target="_blank">03:54:09.600</a></span> | <span class="t">But actually I mean the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14052" target="_blank">03:54:12.240</a></span> | <span class="t">Because there is the beta schedule that we will define now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14055" target="_blank">03:54:15.360</a></span> | <span class="t">What is the beta schedule?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14056" target="_blank">03:54:16.400</a></span> | <span class="t">Which indicates the amount of noise at each time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14059" target="_blank">03:54:19.840</a></span> | <span class="t">And then there is what is known as the scheduler or the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14063" target="_blank">03:54:23.040</a></span> | <span class="t">From now on I will refer it to as sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14066" target="_blank">03:54:26.400</a></span> | <span class="t">So this scheduler here actually means a sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14069" target="_blank">03:54:29.200</a></span> | <span class="t">I'm sorry for the confusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14070" target="_blank">03:54:30.480</a></span> | <span class="t">I will update the slides when the video is out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14073" target="_blank">03:54:33.520</a></span> | <span class="t">So how much were the training steps?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14076" target="_blank">03:54:36.320</a></span> | <span class="t">Which is 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14079" target="_blank">03:54:39.520</a></span> | <span class="t">The beta is okay now I define two constants.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14084" target="_blank">03:54:44.560</a></span> | <span class="t">And later I define them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14086" target="_blank">03:54:46.560</a></span> | <span class="t">Where what are they and where they come from?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14088" target="_blank">03:54:48.800</a></span> | <span class="t">0, 85 and beta end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14093" target="_blank">03:54:53.920</a></span> | <span class="t">And I define the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14095" target="_blank">03:54:55.920</a></span> | <span class="t">So this is the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14097" target="_blank">03:54:57.600</a></span> | <span class="t">And this is the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14098" target="_blank">03:54:58.720</a></span> | <span class="t">And this is the sampler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14100" target="_blank">03:55:00.080</a></span> | <span class="t">And this is the scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14101" target="_blank">03:55:01.120</a></span> | <span class="t">And beta end is a starting point of 0.0120.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14106" target="_blank">03:55:06.640</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14109" target="_blank">03:55:09.060</a></span> | <span class="t">The parameter beta start and beta end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14111" target="_blank">03:55:11.840</a></span> | <span class="t">Basically if you go to the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14113" target="_blank">03:55:13.200</a></span> | <span class="t">If you look at the forward process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14116" target="_blank">03:55:16.160</a></span> | <span class="t">We can see that the forward process is the process that makes the image more noisy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14122" target="_blank">03:55:22.880</a></span> | <span class="t">We add noise to the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14124" target="_blank">03:55:24.800</a></span> | <span class="t">So given an image that don't have less noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14128" target="_blank">03:55:28.640</a></span> | <span class="t">How to get a more noisy image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14131" target="_blank">03:55:31.120</a></span> | <span class="t">According to this Gaussian distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14133" target="_blank">03:55:33.840</a></span> | <span class="t">Which is actually a chain of Gaussian distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14136" target="_blank">03:55:36.720</a></span> | <span class="t">Which is called a Markov chain of Gaussian distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14139" target="_blank">03:55:39.520</a></span> | <span class="t">And the noise that we add varies according to a variance schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14146" target="_blank">03:55:46.720</a></span> | <span class="t">Beta 1, beta 2, beta 3, beta 4, beta t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14149" target="_blank">03:55:49.840</a></span> | <span class="t">So beta basically it's a series of numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14152" target="_blank">03:55:52.720</a></span> | <span class="t">That indicates the variance of the noise that we add with each of these steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14159" target="_blank">03:55:59.040</a></span> | <span class="t">And as in the latent in the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14163" target="_blank">03:56:03.440</a></span> | <span class="t">They use a beta start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14165" target="_blank">03:56:05.040</a></span> | <span class="t">So the first value of beta is 0.0085.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14169" target="_blank">03:56:09.120</a></span> | <span class="t">And the last variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14170" target="_blank">03:56:10.560</a></span> | <span class="t">So this the beta that will turn the image into complete noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14174" target="_blank">03:56:14.960</a></span> | <span class="t">Is equal to 0.0120.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14177" target="_blank">03:56:17.680</a></span> | <span class="t">It's a choice made by the authors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14179" target="_blank">03:56:19.920</a></span> | <span class="t">And we will use a linear schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14185" target="_blank">03:56:25.280</a></span> | <span class="t">Actually there are other schedules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14186" target="_blank">03:56:26.880</a></span> | <span class="t">Which are for example the cosine schedule etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14189" target="_blank">03:56:29.200</a></span> | <span class="t">But we will be using the linear one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14190" target="_blank">03:56:30.880</a></span> | <span class="t">And we need to define this beta schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14195" target="_blank">03:56:35.360</a></span> | <span class="t">Which is actually 1000 numbers between beta start and beta end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14199" target="_blank">03:56:39.600</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14202" target="_blank">03:56:42.320</a></span> | <span class="t">So this is defined using the linear space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14208" target="_blank">03:56:48.240</a></span> | <span class="t">Where the starting number is beta start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14211" target="_blank">03:56:51.440</a></span> | <span class="t">Actually to the square root of beta start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14215" target="_blank">03:56:55.200</a></span> | <span class="t">So square root of beta start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14217" target="_blank">03:56:57.680</a></span> | <span class="t">Because this is how they define it in the stable diffusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14221" target="_blank">03:57:01.600</a></span> | <span class="t">If you check the official repository.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14223" target="_blank">03:57:03.600</a></span> | <span class="t">They will also have these numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14224" target="_blank">03:57:04.960</a></span> | <span class="t">And define in exactly the same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14226" target="_blank">03:57:06.640</a></span> | <span class="t">0.5 then the number of training steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14231" target="_blank">03:57:11.920</a></span> | <span class="t">So in how many pieces we want to divide this linear space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14236" target="_blank">03:57:16.000</a></span> | <span class="t">Beta end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14241" target="_blank">03:57:21.280</a></span> | <span class="t">And then the type is torch dot float 32 I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14246" target="_blank">03:57:26.720</a></span> | <span class="t">And then to the power of 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14248" target="_blank">03:57:28.560</a></span> | <span class="t">Because they divide it into 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14252" target="_blank">03:57:32.320</a></span> | <span class="t">Then to the power of 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14253" target="_blank">03:57:33.360</a></span> | <span class="t">This is in the diffusers libraries from Hugging Face.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14258" target="_blank">03:57:38.480</a></span> | <span class="t">I think this is called the scaled linear schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14260" target="_blank">03:57:40.960</a></span> | <span class="t">Now we need to define other constants.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14264" target="_blank">03:57:44.480</a></span> | <span class="t">That are needed for our forward and our backward process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14267" target="_blank">03:57:47.600</a></span> | <span class="t">So our forward process depends on this beta schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14270" target="_blank">03:57:50.720</a></span> | <span class="t">But actually this is only for the single step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14273" target="_blank">03:57:53.120</a></span> | <span class="t">So if we want to go from for example the original image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14276" target="_blank">03:57:56.320</a></span> | <span class="t">By one step forward of more noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14278" target="_blank">03:57:58.800</a></span> | <span class="t">We need to apply this formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14280" target="_blank">03:58:00.480</a></span> | <span class="t">But there is a closed formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14283" target="_blank">03:58:03.920</a></span> | <span class="t">Called this one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14285" target="_blank">03:58:05.920</a></span> | <span class="t">That allows you to go from the original image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14288" target="_blank">03:58:08.320</a></span> | <span class="t">To any noisified version of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14290" target="_blank">03:58:10.800</a></span> | <span class="t">At any time step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14292" target="_blank">03:58:12.240</a></span> | <span class="t">Between 0 and 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14293" target="_blank">03:58:13.920</a></span> | <span class="t">Using this one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14295" target="_blank">03:58:15.920</a></span> | <span class="t">Which depends on alpha bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14298" target="_blank">03:58:18.000</a></span> | <span class="t">That you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14298" target="_blank">03:58:18.880</a></span> | <span class="t">So the square root of this alpha bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14301" target="_blank">03:58:21.040</a></span> | <span class="t">And the variance also depends on this alpha bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14303" target="_blank">03:58:23.520</a></span> | <span class="t">What is alpha bar?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14304" target="_blank">03:58:24.720</a></span> | <span class="t">Alpha bar is the product of alpha.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14307" target="_blank">03:58:27.600</a></span> | <span class="t">Going from 1 up to t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14309" target="_blank">03:58:29.920</a></span> | <span class="t">So if we are for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14311" target="_blank">03:58:31.120</a></span> | <span class="t">We want to go from the time step 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14313" target="_blank">03:58:33.440</a></span> | <span class="t">Which is the image without any noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14315" target="_blank">03:58:35.440</a></span> | <span class="t">To the time step 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14317" target="_blank">03:58:37.040</a></span> | <span class="t">Which is the image with some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14318" target="_blank">03:58:38.800</a></span> | <span class="t">And remember that time step 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14321" target="_blank">03:58:41.840</a></span> | <span class="t">Means that it's only noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14323" target="_blank">03:58:43.680</a></span> | <span class="t">So we want to go to time step 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14326" target="_blank">03:58:46.240</a></span> | <span class="t">Which means that we need to calculate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14328" target="_blank">03:58:48.160</a></span> | <span class="t">This As of 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14330" target="_blank">03:58:50.880</a></span> | <span class="t">As 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14331" target="_blank">03:58:51.600</a></span> | <span class="t">As 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14332" target="_blank">03:58:52.160</a></span> | <span class="t">As 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14332" target="_blank">03:58:52.560</a></span> | <span class="t">As 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14333" target="_blank">03:58:53.040</a></span> | <span class="t">And up until As 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14334" target="_blank">03:58:54.720</a></span> | <span class="t">And we multiply them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14336" target="_blank">03:58:56.720</a></span> | <span class="t">This is the productory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14338" target="_blank">03:58:58.240</a></span> | <span class="t">And this A.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14339" target="_blank">03:58:59.440</a></span> | <span class="t">What is this alpha?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14340" target="_blank">03:59:00.880</a></span> | <span class="t">This alpha actually is 1 minus beta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14343" target="_blank">03:59:03.200</a></span> | <span class="t">So let's calculate this alphas first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14345" target="_blank">03:59:05.360</a></span> | <span class="t">So alpha is actually 1 minus beta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14347" target="_blank">03:59:07.520</a></span> | <span class="t">Beta self dot betas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14352" target="_blank">03:59:12.160</a></span> | <span class="t">So it becomes floating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14356" target="_blank">03:59:16.080</a></span> | <span class="t">And then we need to calculate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14358" target="_blank">03:59:18.080</a></span> | <span class="t">The product of this alphas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14359" target="_blank">03:59:19.760</a></span> | <span class="t">From 1 to t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14361" target="_blank">03:59:21.120</a></span> | <span class="t">And this is easily done with the PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14363" target="_blank">03:59:23.360</a></span> | <span class="t">We pre-compute them basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14366" target="_blank">03:59:26.640</a></span> | <span class="t">This is also comprod self dot alphas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14373" target="_blank">03:59:33.440</a></span> | <span class="t">This will create basically an array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14377" target="_blank">03:59:37.840</a></span> | <span class="t">Where the first element is the first alpha.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14380" target="_blank">03:59:40.080</a></span> | <span class="t">So alpha for example 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14382" target="_blank">03:59:42.480</a></span> | <span class="t">The second element is alpha 0 multiplied by alpha 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14387" target="_blank">03:59:47.360</a></span> | <span class="t">The third element is alpha 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14389" target="_blank">03:59:49.840</a></span> | <span class="t">Multiplied by alpha 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14392" target="_blank">03:59:52.240</a></span> | <span class="t">Multiplied by alpha 2 etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14394" target="_blank">03:59:54.320</a></span> | <span class="t">So it's a cumulative product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14395" target="_blank">03:59:55.840</a></span> | <span class="t">It's we say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14396" target="_blank">03:59:56.480</a></span> | <span class="t">Then we create one tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14399" target="_blank">03:59:59.760</a></span> | <span class="t">That represents the number 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14401" target="_blank">04:00:01.040</a></span> | <span class="t">And later we will use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14402" target="_blank">04:00:02.080</a></span> | <span class="t">Tensor 1.0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14407" target="_blank">04:00:07.280</a></span> | <span class="t">Okay we save the generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14412" target="_blank">04:00:12.000</a></span> | <span class="t">We save the number of training steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14413" target="_blank">04:00:13.760</a></span> | <span class="t">And then we create the time step schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14421" target="_blank">04:00:21.600</a></span> | <span class="t">The time step basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14423" target="_blank">04:00:23.840</a></span> | <span class="t">Because we want to reverse the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14427" target="_blank">04:00:27.680</a></span> | <span class="t">We want to remove noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14428" target="_blank">04:00:28.720</a></span> | <span class="t">We will start from the more noisy to less noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14431" target="_blank">04:00:31.600</a></span> | <span class="t">So we will go from 1000 to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14434" target="_blank">04:00:34.000</a></span> | <span class="t">Initially.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14436" target="_blank">04:00:36.240</a></span> | <span class="t">So let's say time steps is equal to torch from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14441" target="_blank">04:00:41.200</a></span> | <span class="t">We reverse this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14452" target="_blank">04:00:52.560</a></span> | <span class="t">So this is from 0 to 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14454" target="_blank">04:00:54.320</a></span> | <span class="t">But actually we want 1000 to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14456" target="_blank">04:00:56.240</a></span> | <span class="t">And this is our initial schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14462" target="_blank">04:01:02.400</a></span> | <span class="t">In case we want to do 1000 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14464" target="_blank">04:01:04.080</a></span> | <span class="t">But later because here we actually specify.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14467" target="_blank">04:01:07.040</a></span> | <span class="t">How many inference steps we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14470" target="_blank">04:01:10.080</a></span> | <span class="t">We will change these time steps here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14472" target="_blank">04:01:12.720</a></span> | <span class="t">So if the user later specifies less than 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14475" target="_blank">04:01:15.200</a></span> | <span class="t">We will change it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14475" target="_blank">04:01:15.920</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14478" target="_blank">04:01:18.720</a></span> | <span class="t">We let's create the method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14479" target="_blank">04:01:19.840</a></span> | <span class="t">That will change this time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14482" target="_blank">04:01:22.960</a></span> | <span class="t">Based on how many actual steps we want to make.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14485" target="_blank">04:01:25.840</a></span> | <span class="t">So set inference step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14489" target="_blank">04:01:29.680</a></span> | <span class="t">Time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14492" target="_blank">04:01:32.720</a></span> | <span class="t">As I said before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14498" target="_blank">04:01:38.480</a></span> | <span class="t">We usually perform 50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14499" target="_blank">04:01:39.920</a></span> | <span class="t">Which is also actually the one they use normally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14502" target="_blank">04:01:42.480</a></span> | <span class="t">For example in hugging face library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14505" target="_blank">04:01:45.840</a></span> | <span class="t">Let's save this value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14510" target="_blank">04:01:50.160</a></span> | <span class="t">Because we will need it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14511" target="_blank">04:01:51.680</a></span> | <span class="t">Now if we have a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14514" target="_blank">04:01:54.800</a></span> | <span class="t">For example we go from 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14517" target="_blank">04:01:57.200</a></span> | <span class="t">Actually it's not from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14518" target="_blank">04:01:58.320</a></span> | <span class="t">This is not from 0 to 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14520" target="_blank">04:02:00.560</a></span> | <span class="t">But it's from 0 to 1000 minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14522" target="_blank">04:02:02.720</a></span> | <span class="t">Because this is excluded.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14524" target="_blank">04:02:04.000</a></span> | <span class="t">So it will be from 99.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14526" target="_blank">04:02:06.080</a></span> | <span class="t">999, 998, 997, 996 etc up to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14532" target="_blank">04:02:12.640</a></span> | <span class="t">So we have 1000 numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14535" target="_blank">04:02:15.440</a></span> | <span class="t">But we don't want 1000 numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14537" target="_blank">04:02:17.040</a></span> | <span class="t">We want less.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14538" target="_blank">04:02:18.080</a></span> | <span class="t">We want 50 of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14539" target="_blank">04:02:19.680</a></span> | <span class="t">So what we do is basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14540" target="_blank">04:02:20.960</a></span> | <span class="t">We space them every 20.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14542" target="_blank">04:02:22.880</a></span> | <span class="t">So we start with 999.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14545" target="_blank">04:02:25.280</a></span> | <span class="t">Then 999 minus 20.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14547" target="_blank">04:02:27.600</a></span> | <span class="t">Then 999 minus 40 etc etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14551" target="_blank">04:02:31.120</a></span> | <span class="t">Until we arrive to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14552" target="_blank">04:02:32.320</a></span> | <span class="t">But in total here will be 1000 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14557" target="_blank">04:02:37.120</a></span> | <span class="t">And here will be 50 steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14559" target="_blank">04:02:39.440</a></span> | <span class="t">Why minus 20?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14561" target="_blank">04:02:41.600</a></span> | <span class="t">Because 20 is 1000 divided by 50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14564" target="_blank">04:02:44.800</a></span> | <span class="t">If i'm not mistaken.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14565" target="_blank">04:02:45.920</a></span> | <span class="t">So this is exactly what we are going to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14571" target="_blank">04:02:51.120</a></span> | <span class="t">So we calculate the step ratio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14572" target="_blank">04:02:52.880</a></span> | <span class="t">Which is self dot num training step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14576" target="_blank">04:02:56.160</a></span> | <span class="t">Divide by how many we actually want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14578" target="_blank">04:02:58.400</a></span> | <span class="t">And we redefine the time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14580" target="_blank">04:03:00.720</a></span> | <span class="t">According to how many we actually want to make.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14583" target="_blank">04:03:03.520</a></span> | <span class="t">0 num inference steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14595" target="_blank">04:03:15.440</a></span> | <span class="t">Multiply it by this step ratio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14597" target="_blank">04:03:17.200</a></span> | <span class="t">And round it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14604" target="_blank">04:03:24.160</a></span> | <span class="t">We reverse it just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14607" target="_blank">04:03:27.680</a></span> | <span class="t">Because this is from 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14609" target="_blank">04:03:29.120</a></span> | <span class="t">So this is actually means 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14611" target="_blank">04:03:31.360</a></span> | <span class="t">Then 20.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14612" target="_blank">04:03:32.160</a></span> | <span class="t">Then 40.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14612" target="_blank">04:03:32.880</a></span> | <span class="t">Then 60 etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14614" target="_blank">04:03:34.480</a></span> | <span class="t">Until we reach 999.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14616" target="_blank">04:03:36.080</a></span> | <span class="t">Then we reverse it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14617" target="_blank">04:03:37.200</a></span> | <span class="t">Then copy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14620" target="_blank">04:03:40.720</a></span> | <span class="t">S type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14623" target="_blank">04:03:43.760</a></span> | <span class="t">np dot int 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14628" target="_blank">04:03:48.560</a></span> | <span class="t">So a long one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14630" target="_blank">04:03:50.640</a></span> | <span class="t">And then we define as tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14634" target="_blank">04:03:54.240</a></span> | <span class="t">Now the code looks very different from each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14641" target="_blank">04:04:01.040</a></span> | <span class="t">Because actually I have been copying the code from multiple sources.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14644" target="_blank">04:04:04.560</a></span> | <span class="t">Maybe one of them I think I copied from the HuggingFace library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14648" target="_blank">04:04:08.720</a></span> | <span class="t">So I didn't change it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14650" target="_blank">04:04:10.160</a></span> | <span class="t">I kept it to the original one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14652" target="_blank">04:04:12.080</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14653" target="_blank">04:04:13.760</a></span> | <span class="t">But the idea is the one I showed you before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14656" target="_blank">04:04:16.160</a></span> | <span class="t">So we copy the code from the HuggingFace library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14659" target="_blank">04:04:19.520</a></span> | <span class="t">I showed you before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14660" target="_blank">04:04:20.480</a></span> | <span class="t">So now we set the exact number of time steps we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14663" target="_blank">04:04:23.760</a></span> | <span class="t">And we redefine this time steps array like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14666" target="_blank">04:04:26.800</a></span> | <span class="t">Let's define the next method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14671" target="_blank">04:04:31.280</a></span> | <span class="t">Which basically tells us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14673" target="_blank">04:04:33.520</a></span> | <span class="t">Let's define the method on how to add noise to something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14676" target="_blank">04:04:36.720</a></span> | <span class="t">So imagine we have the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14678" target="_blank">04:04:38.400</a></span> | <span class="t">As you remember to do image to image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14681" target="_blank">04:04:41.520</a></span> | <span class="t">We need to add noise to this latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14683" target="_blank">04:04:43.520</a></span> | <span class="t">How do we add noise to something?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14685" target="_blank">04:04:45.840</a></span> | <span class="t">Well we need to apply the formula as defined in the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14689" target="_blank">04:04:49.280</a></span> | <span class="t">Let's go in the paper here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14691" target="_blank">04:04:51.280</a></span> | <span class="t">We need to apply this formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14694" target="_blank">04:04:54.080</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14695" target="_blank">04:04:55.520</a></span> | <span class="t">This means that given this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14697" target="_blank">04:04:57.680</a></span> | <span class="t">I want to go to the noisified version of this image at time step t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14703" target="_blank">04:05:03.360</a></span> | <span class="t">Which means that I need to take.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14706" target="_blank">04:05:06.800</a></span> | <span class="t">We need to have a sample from this Gaussian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14711" target="_blank">04:05:11.600</a></span> | <span class="t">But we don't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14712" target="_blank">04:05:12.320</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14713" target="_blank">04:05:13.680</a></span> | <span class="t">Let's build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14714" target="_blank">04:05:14.320</a></span> | <span class="t">And we will apply the same trick that we did for the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14717" target="_blank">04:05:17.840</a></span> | <span class="t">As you remember in the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14719" target="_blank">04:05:19.920</a></span> | <span class="t">I actually already showed how we sample from a distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14723" target="_blank">04:05:23.040</a></span> | <span class="t">Of which we know the mean and the variance here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14725" target="_blank">04:05:25.440</a></span> | <span class="t">We will do the same here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14726" target="_blank">04:05:26.640</a></span> | <span class="t">But we of course we need to build the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14729" target="_blank">04:05:29.680</a></span> | <span class="t">What is the mean of this distribution?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14731" target="_blank">04:05:31.520</a></span> | <span class="t">It's this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14733" target="_blank">04:05:33.120</a></span> | <span class="t">And what is the variance?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14735" target="_blank">04:05:35.040</a></span> | <span class="t">It's this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14735" target="_blank">04:05:35.920</a></span> | <span class="t">So we need to build the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14737" target="_blank">04:05:37.520</a></span> | <span class="t">And then we sample from this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14738" target="_blank">04:05:38.640</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14740" target="_blank">04:05:40.480</a></span> | <span class="t">DDPM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14743" target="_blank">04:05:43.360</a></span> | <span class="t">So we take the original samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14745" target="_blank">04:05:45.360</a></span> | <span class="t">Which is the float tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14748" target="_blank">04:05:48.880</a></span> | <span class="t">And then the time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14750" target="_blank">04:05:50.080</a></span> | <span class="t">So this is actually time step, not time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14757" target="_blank">04:05:57.040</a></span> | <span class="t">It indicates at what time step we want to add the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14760" target="_blank">04:06:00.000</a></span> | <span class="t">Because you can add the time step at the noise at time step 1, 2, 3, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14764" target="_blank">04:06:04.240</a></span> | <span class="t">Up to 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14765" target="_blank">04:06:05.520</a></span> | <span class="t">And we need to add the noise at the noise at time step 1, 2, 3, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14770" target="_blank">04:06:10.160</a></span> | <span class="t">1, 2, 3, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14771" target="_blank">04:06:11.120</a></span> | <span class="t">Up to 1000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14772" target="_blank">04:06:12.240</a></span> | <span class="t">And with each level the noise increases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14775" target="_blank">04:06:15.200</a></span> | <span class="t">So the noisified version at the time step 1 will be not so noisy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14779" target="_blank">04:06:19.280</a></span> | <span class="t">But at the time step 1000 will be complete noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14782" target="_blank">04:06:22.800</a></span> | <span class="t">This returns a float tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14787" target="_blank">04:06:27.680</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14791" target="_blank">04:06:31.040</a></span> | <span class="t">Let's calculate first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14795" target="_blank">04:06:35.120</a></span> | <span class="t">Let me check what we need to calculate first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14798" target="_blank">04:06:38.640</a></span> | <span class="t">We can calculate first the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14800" target="_blank">04:06:40.400</a></span> | <span class="t">And then the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14801" target="_blank">04:06:41.360</a></span> | <span class="t">So to calculate the mean we need this alpha cum prod.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14806" target="_blank">04:06:46.000</a></span> | <span class="t">So the cumulative product of the alpha.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14808" target="_blank">04:06:48.240</a></span> | <span class="t">Which stands for alpha bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14810" target="_blank">04:06:50.160</a></span> | <span class="t">So the alpha bar as you can see is the cumulative product of all the alphas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14814" target="_blank">04:06:54.000</a></span> | <span class="t">Which is each alpha is 1 minus beta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14816" target="_blank">04:06:56.240</a></span> | <span class="t">So we take this alpha bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14819" target="_blank">04:06:59.360</a></span> | <span class="t">Which we will call alpha cum prod.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14821" target="_blank">04:07:01.280</a></span> | <span class="t">So it's already defined here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14824" target="_blank">04:07:04.560</a></span> | <span class="t">Alpha cum prod is self dot 2 device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14830" target="_blank">04:07:10.160</a></span> | <span class="t">We move it to the same device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14834" target="_blank">04:07:14.080</a></span> | <span class="t">Because we need to later combine it with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14836" target="_blank">04:07:16.080</a></span> | <span class="t">And of the same type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14841" target="_blank">04:07:21.840</a></span> | <span class="t">This is a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14850" target="_blank">04:07:30.400</a></span> | <span class="t">That we also move to the same device of the other tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14854" target="_blank">04:07:34.320</a></span> | <span class="t">Now we need to calculate the square root of alpha bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14859" target="_blank">04:07:39.280</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14860" target="_blank">04:07:40.960</a></span> | <span class="t">Square root of alpha cum prod.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14867" target="_blank">04:07:47.040</a></span> | <span class="t">Or alpha prod is alpha cum prod at the time step t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14873" target="_blank">04:07:53.280</a></span> | <span class="t">To the power of 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14876" target="_blank">04:07:56.160</a></span> | <span class="t">Why to the power of 0.5?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14877" target="_blank">04:07:57.760</a></span> | <span class="t">Because having a number to the power of 0.5 means doing it's the square root of the number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14884" target="_blank">04:08:04.240</a></span> | <span class="t">Because the square root of 1/2 which becomes the square.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14887" target="_blank">04:08:07.840</a></span> | <span class="t">Sorry to the power of 1/2 which becomes the square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14891" target="_blank">04:08:11.040</a></span> | <span class="t">And then we flatten this array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14894" target="_blank">04:08:14.800</a></span> | <span class="t">And then basically because we need to combine this alpha cum prod.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14901" target="_blank">04:08:21.360</a></span> | <span class="t">Which doesn't have dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14903" target="_blank">04:08:23.440</a></span> | <span class="t">It only has one dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14904" target="_blank">04:08:24.640</a></span> | <span class="t">Which is the number itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14905" target="_blank">04:08:25.680</a></span> | <span class="t">But we need to combine it with the latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14907" target="_blank">04:08:27.760</a></span> | <span class="t">We need to add some dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14909" target="_blank">04:08:29.040</a></span> | <span class="t">So one trick is to just keep adding dimensions with unsqueeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14912" target="_blank">04:08:32.640</a></span> | <span class="t">Until you have the same number of dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14914" target="_blank">04:08:34.480</a></span> | <span class="t">So until the n of the square of the shape is less than.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14921" target="_blank">04:08:41.440</a></span> | <span class="t">Most of this code I have taken from the Hugging Face libraries samplers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14932" target="_blank">04:08:52.080</a></span> | <span class="t">So we keep the dimension until this one and this tensor and this tensor have the same dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14947" target="_blank">04:09:07.440</a></span> | <span class="t">This is because otherwise we cannot do broadcasting when we multiply them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14951" target="_blank">04:09:11.120</a></span> | <span class="t">The other thing that we need to calculate this formula is this part here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14955" target="_blank">04:09:15.600</a></span> | <span class="t">1 minus alpha bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14956" target="_blank">04:09:16.880</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14958" target="_blank">04:09:18.800</a></span> | <span class="t">So sqrt of 1 minus alpha prod.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14964" target="_blank">04:09:24.240</a></span> | <span class="t">As the name implies is 1 minus alpha cum prod at the time step t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14970" target="_blank">04:09:30.640</a></span> | <span class="t">To the power of 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14974" target="_blank">04:09:34.480</a></span> | <span class="t">Why 0.5?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14975" target="_blank">04:09:35.680</a></span> | <span class="t">Because we don't want the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14977" target="_blank">04:09:37.520</a></span> | <span class="t">We want the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14979" target="_blank">04:09:39.440</a></span> | <span class="t">Just like we did with the encoder of the variational autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14983" target="_blank">04:09:43.920</a></span> | <span class="t">We want the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14985" target="_blank">04:09:45.680</a></span> | <span class="t">Because as you remember if you have an n01 and you want to transform into an n with the given mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14992" target="_blank">04:09:52.720</a></span> | <span class="t">The formula is x is equal to mean plus the standard deviation multiplied by the n01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=14998" target="_blank">04:09:58.240</a></span> | <span class="t">Let's go back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15000" target="_blank">04:10:00.880</a></span> | <span class="t">So this is the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15003" target="_blank">04:10:03.600</a></span> | <span class="t">And we also flatten this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15013" target="_blank">04:10:13.920</a></span> | <span class="t">Flatten and then again we keep adding the dimensions until they have the same dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15019" target="_blank">04:10:19.680</a></span> | <span class="t">Otherwise we cannot multiply them together or sum them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15027" target="_blank">04:10:27.760</a></span> | <span class="t">Unsqueeze so we keep adding dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15037" target="_blank">04:10:37.360</a></span> | <span class="t">Now as you remember our method should add noise to an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15044" target="_blank">04:10:44.080</a></span> | <span class="t">So we need to add noise means we need to sample some noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15047" target="_blank">04:10:47.280</a></span> | <span class="t">So we need to sample some noise from the n01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15060" target="_blank">04:11:00.560</a></span> | <span class="t">Using this generator that we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15067" target="_blank">04:11:07.280</a></span> | <span class="t">I think my cat is very angry today with me because I didn't play with him enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15074" target="_blank">04:11:14.000</a></span> | <span class="t">So later if you guys excuse me I need to later play with him.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15080" target="_blank">04:11:20.160</a></span> | <span class="t">I think we will be done very soon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15084" target="_blank">04:11:24.240</a></span> | <span class="t">So let's get the noisy samples using the noise and the mean and the variance that we have calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15090" target="_blank">04:11:30.720</a></span> | <span class="t">According exactly to this formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15092" target="_blank">04:11:32.880</a></span> | <span class="t">So we do the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15095" target="_blank">04:11:35.520</a></span> | <span class="t">Actually no the mean is this one multiplied by x0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15101" target="_blank">04:11:41.760</a></span> | <span class="t">So the mean is this one multiplied by x0 is the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15105" target="_blank">04:11:45.520</a></span> | <span class="t">So we need to take this square root of alpha comprod multiplied by x0 and this will be the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15110" target="_blank">04:11:50.880</a></span> | <span class="t">So the mean is square root of alpha prod multiplied by the original latency.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15116" target="_blank">04:11:56.320</a></span> | <span class="t">So x0 so the input image or whatever we want to noisify.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15120" target="_blank">04:12:00.240</a></span> | <span class="t">Plus the standard deviation which is a square root of this one multiplied by a sample of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15129" target="_blank">04:12:09.200</a></span> | <span class="t">from the n01 so the noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15131" target="_blank">04:12:11.600</a></span> | <span class="t">And this is how we noisify an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15134" target="_blank">04:12:14.720</a></span> | <span class="t">This is how we add noise to an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15139" target="_blank">04:12:19.920</a></span> | <span class="t">So this one let me write it down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15142" target="_blank">04:12:22.160</a></span> | <span class="t">So all of this is according to the equation 4 of the DDM paper and also according to this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15156" target="_blank">04:12:36.480</a></span> | <span class="t">Okay now that we know how to add noise we need to understand how to remove noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15166" target="_blank">04:12:46.400</a></span> | <span class="t">So as you remember let's review again here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15169" target="_blank">04:12:49.920</a></span> | <span class="t">Imagine we are doing text to text or text to image or image to image it doesn't matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15177" target="_blank">04:12:57.200</a></span> | <span class="t">The point is our unit as you remember is trained to only predict the amount of noise given the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15183" target="_blank">04:13:03.600</a></span> | <span class="t">latent with noise given the prompt and the time step at which this noise was added.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15192" target="_blank">04:13:12.400</a></span> | <span class="t">So what we do is we have this predicted noise from the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15197" target="_blank">04:13:17.280</a></span> | <span class="t">We need to remove this noise so the unit will predict the noise but we need some way of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15202" target="_blank">04:13:22.480</a></span> | <span class="t">removing the noise to get the next latent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15205" target="_blank">04:13:25.760</a></span> | <span class="t">What I mean by this is you can see this reverse process here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15212" target="_blank">04:13:32.960</a></span> | <span class="t">So the reverse process is defined here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15216" target="_blank">04:13:36.720</a></span> | <span class="t">We want to go from Xt so something more noisy to something less noisy based on the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15229" target="_blank">04:13:49.040</a></span> | <span class="t">that was predicted by the unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15231" target="_blank">04:13:51.440</a></span> | <span class="t">But here in this formula you don't see any relationship to the noise predicted by the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15236" target="_blank">04:13:56.800</a></span> | <span class="t">unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15237" target="_blank">04:13:57.680</a></span> | <span class="t">Actually here it just says if you have a network that can evaluate this mean and this variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15246" target="_blank">04:14:06.640</a></span> | <span class="t">you know how to remove the noise to how to go from Xt to Xt-1 but we don't have a method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15253" target="_blank">04:14:13.120</a></span> | <span class="t">that actually predicts the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15255" target="_blank">04:14:15.120</a></span> | <span class="t">We have a method that tells us how much noise is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15258" target="_blank">04:14:18.000</a></span> | <span class="t">So the formula we should be looking at is actually here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15262" target="_blank">04:14:22.800</a></span> | <span class="t">So here here because we have we trained our network our unit as a epsilon theta as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15273" target="_blank">04:14:33.600</a></span> | <span class="t">remember our training method was this we do gradient descent on this loss in which we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15280" target="_blank">04:14:40.000</a></span> | <span class="t">train a network to predict the noise in a noisy image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15285" target="_blank">04:14:45.040</a></span> | <span class="t">So we need to use this epsilon theta now to remove the noise so this predicted noise to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15291" target="_blank">04:14:51.120</a></span> | <span class="t">remove the noise and if we read the paper it's written here that to sample Xt-1 given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15298" target="_blank">04:14:58.000</a></span> | <span class="t">Xt is to compute Xt-1 is equal to this formula here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15304" target="_blank">04:15:04.640</a></span> | <span class="t">This tells us how to go from Xt to Xt-1 and this is the so basically we sample some noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15312" target="_blank">04:15:12.720</a></span> | <span class="t">we multiply it by d sigma and this basically reminds us on how to move go from the N01</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15321" target="_blank">04:15:21.440</a></span> | <span class="t">to any distribution with a particular mean and a particular variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15326" target="_blank">04:15:26.400</a></span> | <span class="t">So we will be working according to this formula here actually because we have a model that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15331" target="_blank">04:15:31.360</a></span> | <span class="t">predicts noise here this epsilon theta and this is our unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15336" target="_blank">04:15:36.080</a></span> | <span class="t">The unit is trained to predict noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15338" target="_blank">04:15:38.000</a></span> | <span class="t">So let's build this part now and I will while building it I will also tell you which formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15344" target="_blank">04:15:44.160</a></span> | <span class="t">I'm referring to at each step so you can also follow the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15347" target="_blank">04:15:47.680</a></span> | <span class="t">So now let's build the method let's call step method that given the time step at which the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15354" target="_blank">04:15:54.160</a></span> | <span class="t">noise was added or we think it was added because when we do the reverse process we can also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15360" target="_blank">04:16:00.400</a></span> | <span class="t">skip it's not we think it was other but we can skip some time steps so we need to tell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15366" target="_blank">04:16:06.000</a></span> | <span class="t">him what is the time step at which it should remove the noise the latency so as you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15372" target="_blank">04:16:12.640</a></span> | <span class="t">the unit works with the latency so with this z's here so this is z and it keeps denoising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15379" target="_blank">04:16:19.040</a></span> | <span class="t">so the latency and then what is the model output so the predicted noise of the unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15387" target="_blank">04:16:27.920</a></span> | <span class="t">so the model output is the predicted noise torch dot tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15393" target="_blank">04:16:33.520</a></span> | <span class="t">this model output corresponds to this epsilon theta of xtt so this is the predicted noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15403" target="_blank">04:16:43.680</a></span> | <span class="t">at time step t this latency is our xt and what else we need the alpha we have the beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15412" target="_blank">04:16:52.320</a></span> | <span class="t">we have we have everything okay let's go so t is equal to time step the previous t is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15422" target="_blank">04:17:02.160</a></span> | <span class="t">equal to self dot get previous time step t this is a function that given this time step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15431" target="_blank">04:17:11.040</a></span> | <span class="t">calculates the previous one later we will build it actually we can build it now it's very simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15436" target="_blank">04:17:16.160</a></span> | <span class="t">okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15451" target="_blank">04:17:31.680</a></span> | <span class="t">get previous time step self time step which is an integer we return another integer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15458" target="_blank">04:17:38.960</a></span> | <span class="t">previous time step is equal to the time step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15463" target="_blank">04:17:43.680</a></span> | <span class="t">minus self minus basically this quantity here step ratio so self dot num training steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15476" target="_blank">04:17:56.720</a></span> | <span class="t">divided by self dot num inference steps return previous t this one will return basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15486" target="_blank">04:18:06.560</a></span> | <span class="t">given for example the number 999 it will return number 999 minus 20 because the time steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15496" target="_blank">04:18:16.640</a></span> | <span class="t">for example the initial time step will be suppose it's 1000 the training steps we are doing is 1000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15504" target="_blank">04:18:24.080</a></span> | <span class="t">divided by the number of inference step which is we will be doing is 50 so this is means 1000 minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15510" target="_blank">04:18:30.000</a></span> | <span class="t">20 because 1000 divided by 50 is 20 so it will return 980 when we give him 980 as input he will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15517" target="_blank">04:18:37.760</a></span> | <span class="t">return 960 so what is the next step that we will be doing in our for loop or what is the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15525" target="_blank">04:18:45.200</a></span> | <span class="t">step of the denoising so we are going from the image noise at the time step 1000 to an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15532" target="_blank">04:18:52.320</a></span> | <span class="t">noise that time step 980 for example this is the meaning of previous stem then we retrieve some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15541" target="_blank">04:19:01.280</a></span> | <span class="t">data later we will use it so alpha pod t is equal to self dot alpha for now if you don't understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15548" target="_blank">04:19:08.240</a></span> | <span class="t">don't worry because later i will write i will just collect some data that we need to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15552" target="_blank">04:19:12.400</a></span> | <span class="t">a formula and then i will tell you exactly which formula we are going to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15560" target="_blank">04:19:20.240</a></span> | <span class="t">alpha prod t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15562" target="_blank">04:19:22.640</a></span> | <span class="t">if we don't have any previous step then we don't know which alpha to return so we just return one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15585" target="_blank">04:19:45.440</a></span> | <span class="t">and actually there is a paper that came out i think from by dance that was complaining that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15590" target="_blank">04:19:50.960</a></span> | <span class="t">this method of doing is not correct because the the last time step doesn't have this is not doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15598" target="_blank">04:19:58.720</a></span> | <span class="t">have the signal to noise ratio about equal to zero but okay this is something we don't need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15603" target="_blank">04:20:03.760</a></span> | <span class="t">to care about now actually if you're interested i will link the paper in the comments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15616" target="_blank">04:20:16.320</a></span> | <span class="t">rev current alpha t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15626" target="_blank">04:20:26.320</a></span> | <span class="t">prod t divided by alpha prod current also this code i took it from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15633" target="_blank">04:20:33.600</a></span> | <span class="t">hugging face diffusers library because i mean we are applying formulas so even if i wrote it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15643" target="_blank">04:20:43.520</a></span> | <span class="t">myself it wouldn't be any different because we are just applying formulas from the paper so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15648" target="_blank">04:20:48.240</a></span> | <span class="t">so the first thing we need to do is to compute the original sample according to the formula 15</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15655" target="_blank">04:20:55.040</a></span> | <span class="t">of the paper what do i mean by this as you can see where is it this one where is it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15665" target="_blank">04:21:05.120</a></span> | <span class="t">here so actually let me show you another formula here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15672" target="_blank">04:21:12.160</a></span> | <span class="t">as you can see we can calculate the previous step so the less noise is the the forward process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15682" target="_blank">04:21:22.080</a></span> | <span class="t">sorry the reverse process we can calculate the less noisy image given a more noisy image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15686" target="_blank">04:21:26.960</a></span> | <span class="t">and the predicted image at time step zero according to this formula here where the mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15694" target="_blank">04:21:34.560</a></span> | <span class="t">is defined in this way and the variance is defined in this way but what is the predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15704" target="_blank">04:21:44.400</a></span> | <span class="t">x0 so given an image given a noisy image at time step t how can we predict what is the x0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15713" target="_blank">04:21:53.920</a></span> | <span class="t">of course this is the predicted x0 not what will be the x0 so this predicted x0 we can also retrieve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15720" target="_blank">04:22:00.640</a></span> | <span class="t">it using the formula number 15 if i remember correctly it's here so this x0 is given as xt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15730" target="_blank">04:22:10.800</a></span> | <span class="t">minus 1 minus alpha multiplied by the predicted noise at time step t divided by the square root</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15737" target="_blank">04:22:17.200</a></span> | <span class="t">of alpha all these quantities we have so actually there are two ways which are equivalent to each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15742" target="_blank">04:22:22.800</a></span> | <span class="t">other actually numerically of going from more noisy to less noisy one way is this one this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15748" target="_blank">04:22:28.960</a></span> | <span class="t">one here which is the algorithm 2 of the sampling and one is this one here so the equation number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15756" target="_blank">04:22:36.560</a></span> | <span class="t">7 that allows you to go from more noisy to less noisy but the two are numerically equivalent they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15762" target="_blank">04:22:42.400</a></span> | <span class="t">just in the in the effect they are equivalent it's just they have different parameterization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15768" target="_blank">04:22:48.000</a></span> | <span class="t">so they have different formulas so as a matter of fact for example here in the code they say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15774" target="_blank">04:22:54.720</a></span> | <span class="t">to go from xt to xt minus 1 you need to do this calculation here but as you can see for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15782" target="_blank">04:23:02.480</a></span> | <span class="t">this is this numerator of this multiplied by this epsilon theta is different from the one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15791" target="_blank">04:23:11.120</a></span> | <span class="t">in the algorithm here but actually they are the same thing because bt is equal to 1 minus alpha t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15796" target="_blank">04:23:16.720</a></span> | <span class="t">as beta alpha is defined as 1 minus beta as you remember so there are multiple ways of obtaining</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15804" target="_blank">04:23:24.080</a></span> | <span class="t">the same thing so what we will do is we actually we will apply this formula here in which we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15809" target="_blank">04:23:29.760</a></span> | <span class="t">to calculate the mean and we need to calculate the variance according to these formulas here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15814" target="_blank">04:23:34.720</a></span> | <span class="t">in which we know alpha we know beta we know alpha bar we know all the other alphas we know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15820" target="_blank">04:23:40.320</a></span> | <span class="t">because there are parameters that depend on beta what we don't know is x0 but x0 can be calculated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15826" target="_blank">04:23:46.240</a></span> | <span class="t">as in the formula 15 here so first we will calculate this x0 predicted x0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15834" target="_blank">04:23:54.400</a></span> | <span class="t">so first compute the predicted original sample using formula 15 of the DDTM paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15853" target="_blank">04:24:13.360</a></span> | <span class="t">predicted original sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15856" target="_blank">04:24:16.960</a></span> | <span class="t">latency minus while so we do latency minus the square root of 1 minus alpha t what is the square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15868" target="_blank">04:24:28.000</a></span> | <span class="t">root of 1 minus alpha t is equal to beta so i have here beta t which is already 1 minus alpha t as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15876" target="_blank">04:24:36.160</a></span> | <span class="t">you can see alpha bar 1 minus alpha bar at the time step t because i already retrieve it from here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15883" target="_blank">04:24:43.920</a></span> | <span class="t">so 1 minus sorry beta to the power to to the power of one half or the square root of beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15892" target="_blank">04:24:52.000</a></span> | <span class="t">so we do latency minus beta rod at time step t to the power of 0.5 which it means basically square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15901" target="_blank">04:25:01.120</a></span> | <span class="t">root of beta and then we multiply this by the predicted noise of the image of the latent at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15908" target="_blank">04:25:08.640</a></span> | <span class="t">time step t so what is the predicted noise it's the model output because our unit predicts the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15915" target="_blank">04:25:15.120</a></span> | <span class="t">noise model output and then we need to divide this by let me check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15923" target="_blank">04:25:23.360</a></span> | <span class="t">square root of alpha t which we have i think here alpha t here so the square root of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15931" target="_blank">04:25:31.360</a></span> | <span class="t">alpha t alpha prod t to the power of 0.5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15936" target="_blank">04:25:36.240</a></span> | <span class="t">here i have something on this one i don't need this one i don't need okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15944" target="_blank">04:25:44.560</a></span> | <span class="t">because otherwise it's wrong right yeah before first there is a product between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15950" target="_blank">04:25:50.080</a></span> | <span class="t">these two terms and then there is the difference yeah okay this is how we compute the prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15956" target="_blank">04:25:56.160</a></span> | <span class="t">the x0 now let's go back to the formula number seven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15959" target="_blank">04:25:59.440</a></span> | <span class="t">seven seven okay now we have this x0 so we can compute this term and we can compute this term</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15966" target="_blank">04:26:06.960</a></span> | <span class="t">and this we can compute this term and all the other terms we also can compute so we calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15971" target="_blank">04:26:11.120</a></span> | <span class="t">this mean and this variance and then we sample from this distribution so compute the coefficients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15980" target="_blank">04:26:20.640</a></span> | <span class="t">for bred original sample and the current sample xt this is the same comment that you can find on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15991" target="_blank">04:26:31.280</a></span> | <span class="t">the diffusers library which basically means we need to compute this one this is the coefficient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=15996" target="_blank">04:26:36.640</a></span> | <span class="t">for the predicted sample and this is the coefficient for xt this one here so predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16003" target="_blank">04:26:43.520</a></span> | <span class="t">original sample coefficient which is equal to what alpha prod t minus one so the previous alpha</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16014" target="_blank">04:26:54.320</a></span> | <span class="t">prod t which is alpha prod t previous which means the alpha prod t but at the previous time step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16024" target="_blank">04:27:04.720</a></span> | <span class="t">under the square root so to the power of 0.5 multiplied by the current beta t so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16030" target="_blank">04:27:10.720</a></span> | <span class="t">the beta at the time step t so current beta t which is we define it here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16038" target="_blank">04:27:18.640</a></span> | <span class="t">current beta t we retrieve it from alpha we could have a okay and then we divide it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16048" target="_blank">04:27:28.720</a></span> | <span class="t">beta product t because one minus alpha bar is actually equal to beta bar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16053" target="_blank">04:27:33.120</a></span> | <span class="t">beta product t then we have the this coefficient here so this one here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16062" target="_blank">04:27:42.320</a></span> | <span class="t">so this is current sample coefficient is equal to current alpha t to the power of 0.5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16070" target="_blank">04:27:50.880</a></span> | <span class="t">which means the square root of this time this this thing here so the square root of alpha t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16078" target="_blank">04:27:58.080</a></span> | <span class="t">and then we multiply it by beta at the previous time step because it's one minus alpha at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16083" target="_blank">04:28:03.200</a></span> | <span class="t">previous time step corresponds to beta as the previous time steps time step multiplied by beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16089" target="_blank">04:28:09.280</a></span> | <span class="t">prod t prev divide by beta at the time step t so beta prod t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16097" target="_blank">04:28:17.840</a></span> | <span class="t">now we can compute the mean so the mean is the sum of these two terms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16106" target="_blank">04:28:26.160</a></span> | <span class="t">pred prev sample so let me write some here compute the predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16113" target="_blank">04:28:33.920</a></span> | <span class="t">previous sample mean mod t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16119" target="_blank">04:28:39.840</a></span> | <span class="t">is equal to predicted original sample coefficient multiplied by what by x0 what is x0 is this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16130" target="_blank">04:28:50.000</a></span> | <span class="t">that we obtained by the formula number 15 so the prediction predicted original sample so x0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16136" target="_blank">04:28:56.000</a></span> | <span class="t">plus this term here what is this term is this one here so the current sample coefficient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16142" target="_blank">04:29:02.560</a></span> | <span class="t">multiplied by xt what is xt is the latency at the time step t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16148" target="_blank">04:29:08.480</a></span> | <span class="t">now this we have computed the mean for now we need to compute also the variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16157" target="_blank">04:29:17.120</a></span> | <span class="t">let's create another method to compute the variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16159" target="_blank">04:29:19.760</a></span> | <span class="t">test get variance self time step int</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16168" target="_blank">04:29:28.480</a></span> | <span class="t">okay we obtained the previous time test t because we need to do for later calculations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16177" target="_blank">04:29:37.440</a></span> | <span class="t">again we calculate the alpha prod t so all the terms that we need to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16185" target="_blank">04:29:45.280</a></span> | <span class="t">these particular terms here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16215" target="_blank">04:30:15.040</a></span> | <span class="t">and the current beta t is equal to one minus alpha prod t divided by alpha prod this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16224" target="_blank">04:30:24.240</a></span> | <span class="t">what is current beta t is equal to one minus alpha prod t yeah one minus alpha prod t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16236" target="_blank">04:30:36.080</a></span> | <span class="t">divided by alpha prod t0 okay so the variance according to the formula number six and seven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16248" target="_blank">04:30:48.800</a></span> | <span class="t">so this formula here is given as one minus alpha prod tprev so one minus alpha prod tprev</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16264" target="_blank">04:31:04.000</a></span> | <span class="t">divided by one minus alpha prod which is one minus alpha prod why prod because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16271" target="_blank">04:31:11.760</a></span> | <span class="t">this is the alpha bar and multiplied by the current beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16275" target="_blank">04:31:15.920</a></span> | <span class="t">beta t and beta t is defined i don't remember where it's one minus alpha</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16286" target="_blank">04:31:26.320</a></span> | <span class="t">and this is our variance we clamp it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16289" target="_blank">04:31:29.840</a></span> | <span class="t">oops torch dot clamp the variance and the minimum that we want is one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16301" target="_blank">04:31:41.600</a></span> | <span class="t">equal to minus 20 to make sure that with it doesn't reach zero and then we return the variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16312" target="_blank">04:31:52.240</a></span> | <span class="t">and now that we have the mean and the variance so this variance has also been computed using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16318" target="_blank">04:31:58.960</a></span> | <span class="t">let me write here computed using formula seven of the ddpm paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16327" target="_blank">04:32:07.840</a></span> | <span class="t">and now we go back to our step function so what we do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16337" target="_blank">04:32:17.760</a></span> | <span class="t">it's equal to zero so because we only need to add the variance if we are not at the last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16344" target="_blank">04:32:24.480</a></span> | <span class="t">last time step if you are at the last time step we have no noise so we don't add any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16348" target="_blank">04:32:28.320</a></span> | <span class="t">we don't add we don't need to add any noise actually because the point is we are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16356" target="_blank">04:32:36.880</a></span> | <span class="t">to sample from this distribution and just like we did before we actually sample from the n01 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16362" target="_blank">04:32:42.240</a></span> | <span class="t">then we shift it according to the formula so the n gaussian as with the particular mean and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16372" target="_blank">04:32:52.160</a></span> | <span class="t">particular variance is equal to the the gaussian at zero one multiplied by the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16378" target="_blank">04:32:58.960</a></span> | <span class="t">plus the um the plus the mean so we sample the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16406" target="_blank">04:33:26.080</a></span> | <span class="t">okay we sample some noise compute the variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16418" target="_blank">04:33:38.000</a></span> | <span class="t">actually this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16422" target="_blank">04:33:42.640</a></span> | <span class="t">variance already multiplied by the noise so it's actually the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16428" target="_blank">04:33:48.800</a></span> | <span class="t">because we will see self dot get variance after the time step t to the power of 0.5 so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16438" target="_blank">04:33:58.240</a></span> | <span class="t">0.5 so this one becomes the standard deviation we multiply it by the n01</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16444" target="_blank">04:34:04.720</a></span> | <span class="t">so what we are doing is basically we are going from n01</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16449" target="_blank">04:34:09.520</a></span> | <span class="t">to nn with a particular mu and a particular sigma using the usual trick of going from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16458" target="_blank">04:34:18.080</a></span> | <span class="t">x is equal to the mu plus the sigma actually not yeah this is the sigma squared then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16465" target="_blank">04:34:25.520</a></span> | <span class="t">because this is the variance sigma multiplied by the z where z where z is distributed according</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16473" target="_blank">04:34:33.360</a></span> | <span class="t">to the n01 this is the same thing that we always done also for the variation of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16479" target="_blank">04:34:39.520</a></span> | <span class="t">encoder also for adding the noise the same thing that we did before this is how you sample from a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16485" target="_blank">04:34:45.840</a></span> | <span class="t">distribution how you actually shift the parameter of the gaussian distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16489" target="_blank">04:34:49.280</a></span> | <span class="t">so predicted prev sample is equal to the predicted prev sample plus the variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16499" target="_blank">04:34:59.600</a></span> | <span class="t">this variance term here already includes the sigma multiplied by z</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16503" target="_blank">04:35:03.600</a></span> | <span class="t">and then we return predicted prev sample oh okay now we have also built the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16514" target="_blank">04:35:14.000</a></span> | <span class="t">the sampler let me check if we have everything no we missed still still something which is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16519" target="_blank">04:35:19.360</a></span> | <span class="t">set strength method as you remember once we want when we want to do image to image so let's go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16526" target="_blank">04:35:26.320</a></span> | <span class="t">back to check our slides if we want to do image to image we convert the image using the vae to a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16532" target="_blank">04:35:32.560</a></span> | <span class="t">latent then we need to add noise to this latent but how much noise we can decide the more noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16538" target="_blank">04:35:38.640</a></span> | <span class="t">we add the more freedom the unit will have to change this image the less noise we add the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16543" target="_blank">04:35:43.360</a></span> | <span class="t">less freedom it will have to change the image so what we do is basically by setting the strength</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16548" target="_blank">04:35:48.640</a></span> | <span class="t">we make our sampler start from a particular noise level and this is exactly what the method we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16555" target="_blank">04:35:55.600</a></span> | <span class="t">to implement so i made some mess okay so for example as soon as we load the image we set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16562" target="_blank">04:36:02.640</a></span> | <span class="t">the strength which will shift the noise level from which we start from and then we add noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16568" target="_blank">04:36:08.240</a></span> | <span class="t">to our latent to create the image to image here so let's go here and we create this method called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16576" target="_blank">04:36:16.480</a></span> | <span class="t">set strength</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16580" target="_blank">04:36:20.720</a></span> | <span class="t">okay in the start step because we will skip some steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16589" target="_blank">04:36:29.840</a></span> | <span class="t">is equal to self.num inference steps minus int of self.num inference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16597" target="_blank">04:36:37.920</a></span> | <span class="t">this basically means that if we have 50 inference steps and then we set the strength to let's say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16608" target="_blank">04:36:48.000</a></span> | <span class="t">0.8 it means that we will skip 20% of the steps so when we will add we will start from image to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16615" target="_blank">04:36:55.200</a></span> | <span class="t">image for example we will not start from a pure noise image but we will start from 80% of noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16621" target="_blank">04:37:01.760</a></span> | <span class="t">in this image so the unit will still have freedom to change this image but not as much as with 100%</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16628" target="_blank">04:37:08.160</a></span> | <span class="t">noise we redefine the time steps because we are altering the schedule so basically we skip some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16637" target="_blank">04:37:17.920</a></span> | <span class="t">time steps and self.start step is equal to start step so actually what we do here is suppose we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16649" target="_blank">04:37:29.840</a></span> | <span class="t">have the strength of 80% we are actually fooling the method the the unit into believing that he</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16655" target="_blank">04:37:35.440</a></span> | <span class="t">came up with this image which is now with this level of strength and now he needs to keep denoising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16661" target="_blank">04:37:41.280</a></span> | <span class="t">it this is how we do image to image so we start with an image we noise it and then we make the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16667" target="_blank">04:37:47.280</a></span> | <span class="t">unit believe that he came up with this image with this particular noise level and now he has to keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16673" target="_blank">04:37:53.760</a></span> | <span class="t">denoising it until according of course also to the prompt until we reach the clean image without any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16681" target="_blank">04:38:01.120</a></span> | <span class="t">noise now we have the pipeline that we can call we have the ddpm sampler we have the model built</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16692" target="_blank">04:38:12.080</a></span> | <span class="t">of course we need to create the function to load the weights of this model so let's create another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16698" target="_blank">04:38:18.000</a></span> | <span class="t">file we will call it the model loader here model loader because now we are nearly close to sampling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16707" target="_blank">04:38:27.760</a></span> | <span class="t">from this finally from this table diffusion so now we need to create the method to load the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16712" target="_blank">04:38:32.160</a></span> | <span class="t">pre-trained the pre-trained weights that we have downloaded before so let's create it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16720" target="_blank">04:38:40.800</a></span> | <span class="t">import clip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16722" target="_blank">04:38:42.240</a></span> | <span class="t">decoder va encoder then from decoder import va decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16735" target="_blank">04:38:55.600</a></span> | <span class="t">fusion import diffusion our diffusion model which is our unit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16745" target="_blank">04:39:05.040</a></span> | <span class="t">now let me first define it then i tell you what we need to do so preload preload models from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16754" target="_blank">04:39:14.800</a></span> | <span class="t">standard weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16757" target="_blank">04:39:17.280</a></span> | <span class="t">okay as usual we load the weights using torch but we use we will create another function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16772" target="_blank">04:39:32.720</a></span> | <span class="t">model converter dot load from standard weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16777" target="_blank">04:39:37.280</a></span> | <span class="t">this is a method that we will create later to to load the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16789" target="_blank">04:39:49.360</a></span> | <span class="t">the pre-trained weights and i will show you why we need this method then we create our encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16798" target="_blank">04:39:58.880</a></span> | <span class="t">and we load the state addict load state addict from our state addict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16804" target="_blank">04:40:04.160</a></span> | <span class="t">and we also set strict to two oops don't strict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16812" target="_blank">04:40:12.400</a></span> | <span class="t">strict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16826" target="_blank">04:40:26.960</a></span> | <span class="t">true then we have the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16837" target="_blank">04:40:37.040</a></span> | <span class="t">and strict also so this strict parameter here basically tells that when you load a model from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16852" target="_blank">04:40:52.000</a></span> | <span class="t">pytorch this for example this ckp ckpt file here it is a dictionary that contains many keys</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16859" target="_blank">04:40:59.680</a></span> | <span class="t">and each key corresponds to one matrix of our model so for example this uh self this group</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16866" target="_blank">04:41:06.320</a></span> | <span class="t">normalization has some parameters and the the how can torch load this parameter is exactly in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16872" target="_blank">04:41:12.720</a></span> | <span class="t">group norm by using the name of the variables that we have defined here and he will when we load a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16880" target="_blank">04:41:20.480</a></span> | <span class="t">model from pytorch he will actually load the dictionary and then we load this dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16885" target="_blank">04:41:25.680</a></span> | <span class="t">into our models and he will match by names now the problem is the pre-trained model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16890" target="_blank">04:41:30.960</a></span> | <span class="t">actually they don't use the same name that i have used and actually this code is based on another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16896" target="_blank">04:41:36.720</a></span> | <span class="t">code that i have seen so actually the the names that we use are not the same as the pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16902" target="_blank">04:41:42.560</a></span> | <span class="t">model also because the names in the pre-trained model not always uh very friendly for learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16909" target="_blank">04:41:49.120</a></span> | <span class="t">this is why i changed the names and also other people changed the names of the methods but this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16915" target="_blank">04:41:55.200</a></span> | <span class="t">also means that the automatic mapping between the names of the pre-trained model and the names</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16921" target="_blank">04:42:01.440</a></span> | <span class="t">defined in our classes here cannot happen because it cannot happen automatically because the names</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16926" target="_blank">04:42:06.400</a></span> | <span class="t">do not match for this reason there is a script that i have created in my github library here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16934" target="_blank">04:42:14.320</a></span> | <span class="t">that you need to download to convert these names it's just a script that maps one name into another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16940" target="_blank">04:42:20.160</a></span> | <span class="t">so if the name is this one map it into this if the name is this one mapping into this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16944" target="_blank">04:42:24.560</a></span> | <span class="t">there is nothing special about this script it's just a very big mapping of the names and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16950" target="_blank">04:42:30.560</a></span> | <span class="t">actually done by most models because if you want to change the name of the classes and or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16956" target="_blank">04:42:36.960</a></span> | <span class="t">variables then you need to do this kind of mapping so i will also i will basically copy it i don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16963" target="_blank">04:42:43.920</a></span> | <span class="t">need to download the file so this will call the model converter.py model converter.py</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16972" target="_blank">04:42:52.320</a></span> | <span class="t">and that's it it's just a very big mapping of names and i take it from this comment here on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16980" target="_blank">04:43:00.480</a></span> | <span class="t">github so this is model converter so we need to import this model converter import model converter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16992" target="_blank">04:43:12.560</a></span> | <span class="t">import this model converter basically will convert the names and then we can use the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=16997" target="_blank">04:43:17.840</a></span> | <span class="t">load state dict and this will actually map all the names it's now now the names will map with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17002" target="_blank">04:43:22.720</a></span> | <span class="t">each other and this trick makes sure that if there is even one name that doesn't map</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17006" target="_blank">04:43:26.880</a></span> | <span class="t">then throw an exception which is what i want because i want to make sure that all the names map</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17018" target="_blank">04:43:38.240</a></span> | <span class="t">so we define the diffusion and we load it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17020" target="_blank">04:43:40.480</a></span> | <span class="t">state dict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17023" target="_blank">04:43:43.280</a></span> | <span class="t">diffusion and strict equal to true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17032" target="_blank">04:43:52.480</a></span> | <span class="t">and let me check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17047" target="_blank">04:44:07.440</a></span> | <span class="t">then we do clip is equal to clip dot to device so we move it to device where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17053" target="_blank">04:44:13.360</a></span> | <span class="t">want to work and then we load also his state dict so the parameters of the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17057" target="_blank">04:44:17.840</a></span> | <span class="t">and then we return a dictionary clip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17075" target="_blank">04:44:35.760</a></span> | <span class="t">clip and then we have the encoder is the encoder we have the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17082" target="_blank">04:44:42.960</a></span> | <span class="t">is the decoder and then we have the diffusion we have the diffusion etc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17091" target="_blank">04:44:51.600</a></span> | <span class="t">now we have all the ingredients to run finally the inference guys so thank you for being patient so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17098" target="_blank">04:44:58.800</a></span> | <span class="t">much and it's really finally we have we can see the light coming so let's build our notebook so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17107" target="_blank">04:45:07.680</a></span> | <span class="t">can visualize the image that we will build okay let's select the kernel stable diffusion i already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17116" target="_blank">04:45:16.640</a></span> | <span class="t">created it in my repository you will also find the requirements that you need to install in order to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17123" target="_blank">04:45:23.360</a></span> | <span class="t">run this so let's import everything we need so the model loader the pipeline</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17130" target="_blank">04:45:30.000</a></span> | <span class="t">peel import image this is how to load the image from python so patlib import actually this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17141" target="_blank">04:45:41.040</a></span> | <span class="t">we don't need transformers this is the only library that we will be using because there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17148" target="_blank">04:45:48.000</a></span> | <span class="t">is the tokenizer of the clip so how to tokenize the the text into tokens before sending it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17154" target="_blank">04:45:54.080</a></span> | <span class="t">the clip embeddings otherwise we also need to build the tokenizer and it's really a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17159" target="_blank">04:45:59.120</a></span> | <span class="t">job i don't allow cuda and i also don't allow mps but you can activate these two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17177" target="_blank">04:46:17.680</a></span> | <span class="t">variables if you want to use cuda or mps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17179" target="_blank">04:46:19.920</a></span> | <span class="t">valuable and low cuda then the device becomes cuda of course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17203" target="_blank">04:46:43.200</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17214" target="_blank">04:46:54.720</a></span> | <span class="t">and then we printed the device we are using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17231" target="_blank">04:47:11.680</a></span> | <span class="t">okay let's load the tokenizer tokenizer is the clip tokenizer we need to tell him what is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17237" target="_blank">04:47:17.760</a></span> | <span class="t">vocabulary file so which is already saved here in the data data vocabulary.json and then also the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17245" target="_blank">04:47:25.440</a></span> | <span class="t">merges file maybe one day i will make a video on how the tokenizer works so we can build also the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17252" target="_blank">04:47:32.320</a></span> | <span class="t">tokenizer but this is something that requires a lot of time i mean and it's not really related</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17258" target="_blank">04:47:38.880</a></span> | <span class="t">to the diffusion model so that's why i didn't want to build it the model file is i will use the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17265" target="_blank">04:47:45.920</a></span> | <span class="t">and then this file here then we load the model so the models are model loader dot preload model from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17274" target="_blank">04:47:54.480</a></span> | <span class="t">the model file into this device that we have selected okay let's build from text to image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17282" target="_blank">04:48:02.640</a></span> | <span class="t">what we need to define the prompt for example i want a cat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17288" target="_blank">04:48:08.160</a></span> | <span class="t">sitting or stretching let's say stretching on the floor highly detailed we need to create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17298" target="_blank">04:48:18.560</a></span> | <span class="t">prompt that will create a good image so we need to add some a lot of details ultra sharp cinematic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17305" target="_blank">04:48:25.360</a></span> | <span class="t">etc etc 8k resolution the unconditioned prompt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17312" target="_blank">04:48:32.720</a></span> | <span class="t">i keep it blank this you can also use it as a negative number you can use it as a negative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17322" target="_blank">04:48:42.720</a></span> | <span class="t">prompt so if you don't want the sum you don't want the output to have some how to say some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17330" target="_blank">04:48:50.800</a></span> | <span class="t">characteristics you can define it in the negative prompt of course i like to do cfg so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17337" target="_blank">04:48:57.120</a></span> | <span class="t">classifier free guidance which we set to true cfg scale is a number between 1 and 14 which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17345" target="_blank">04:49:05.760</a></span> | <span class="t">indicates how much attention we want the model to pay to this prompt 14 means pay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17350" target="_blank">04:49:10.560</a></span> | <span class="t">very much attention or 1 means we pay very little attention i use 7</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17357" target="_blank">04:49:17.920</a></span> | <span class="t">then we can define also the parameters for image to image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17360" target="_blank">04:49:20.480</a></span> | <span class="t">so input image is equal to none image path is equal to i will define it with my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17371" target="_blank">04:49:31.440</a></span> | <span class="t">image of the dog which i already have here and um but for now i don't want to load it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17378" target="_blank">04:49:38.960</a></span> | <span class="t">so if we want to load it we need to do input image is equal to image.open</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17386" target="_blank">04:49:46.320</a></span> | <span class="t">image path but for now i will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17388" target="_blank">04:49:48.480</a></span> | <span class="t">i will not use it so now let's comment it and if we use it we need to define the strength</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17396" target="_blank">04:49:56.960</a></span> | <span class="t">so how much noise we want to add to this image but for now let's not use it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17400" target="_blank">04:50:00.080</a></span> | <span class="t">the sampler we will be using of course is the only one we have is the ddpm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17404" target="_blank">04:50:04.640</a></span> | <span class="t">the number of inference steps is equal to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17410" target="_blank">04:50:10.880</a></span> | <span class="t">50 and the seed is equal to 42 because it's a lucky number at least according to some books</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17419" target="_blank">04:50:19.280</a></span> | <span class="t">output image is equal to pipeline generate okay the prompt is the prompt that we have defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17431" target="_blank">04:50:31.280</a></span> | <span class="t">the unconditioned prompt is the unconditioned prompt that we have defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17436" target="_blank">04:50:36.240</a></span> | <span class="t">input image is the input image that we have defined if it's not commented of course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17442" target="_blank">04:50:42.000</a></span> | <span class="t">the strength for the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17444" target="_blank">04:50:44.000</a></span> | <span class="t">and the cfg scale is the one we have defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17453" target="_blank">04:50:53.200</a></span> | <span class="t">the sampler name is the sampler name we have defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17461" target="_blank">04:51:01.760</a></span> | <span class="t">the number of inference steps is the number of inference steps the seed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17467" target="_blank">04:51:07.200</a></span> | <span class="t">models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17470" target="_blank">04:51:10.000</a></span> | <span class="t">device</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17474" target="_blank">04:51:14.720</a></span> | <span class="t">idle device is our cpu so when we don't want to use something we move it to the cpu</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17482" target="_blank">04:51:22.720</a></span> | <span class="t">and the tokenizer is the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17487" target="_blank">04:51:27.200</a></span> | <span class="t">and then image dot from array output image if everything is done well if all the code has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17497" target="_blank">04:51:37.680</a></span> | <span class="t">been written correctly you can always go back to my repository and download the code if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17503" target="_blank">04:51:43.280</a></span> | <span class="t">don't want to write it by yourself let's run the code and let's see what is the result my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17508" target="_blank">04:51:48.880</a></span> | <span class="t">computer will take a while so it will take some time so let's run it so if we run the code it will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17516" target="_blank">04:51:56.800</a></span> | <span class="t">generate an image according to our prompt in my computer it took really a long time so i cut the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17521" target="_blank">04:52:01.520</a></span> | <span class="t">video and i actually already replaced the code with the one from my github because now i want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17528" target="_blank">04:52:08.240</a></span> | <span class="t">to actually explain you the code without while showing you all the code together how does it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17534" target="_blank">04:52:14.320</a></span> | <span class="t">work so now we we generated an image using only the prompt i use the cpu that's why it's very slow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17540" target="_blank">04:52:20.400</a></span> | <span class="t">because my gpu is not powerful enough and we set a unconditioned prompt to zero we are using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17545" target="_blank">04:52:25.840</a></span> | <span class="t">classifier free guidance and with a scale of seven so let's go in the pipeline and let's see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17550" target="_blank">04:52:30.880</a></span> | <span class="t">what happens so basically because we are doing the classifier free guidance we will generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17556" target="_blank">04:52:36.400</a></span> | <span class="t">two conditioning signals one with the prompt and one with empty text which is the unconditioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17563" target="_blank">04:52:43.280</a></span> | <span class="t">prompt which is also called the negative prompt this will result in a batch size of two that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17570" target="_blank">04:52:50.560</a></span> | <span class="t">run through the unit so let's go back to here suppose we are doing text to image so now our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17576" target="_blank">04:52:56.240</a></span> | <span class="t">unit has two latents that he's doing at the same time because we have the batch size equal to two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17581" target="_blank">04:53:01.680</a></span> | <span class="t">and for each of them it is predicting the noise level but how can we move remove this noise from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17590" target="_blank">04:53:10.160</a></span> | <span class="t">the predicted noise from the initial noise so because to generate an image we start from random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17597" target="_blank">04:53:17.680</a></span> | <span class="t">noise and the prompt initially we encode it with our vae so it becomes a latent which is still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17604" target="_blank">04:53:24.960</a></span> | <span class="t">noise and with the unit we predict we predict how much noise is it according to a schedule so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17611" target="_blank">04:53:31.040</a></span> | <span class="t">according to 50 steps that of inferencing that we will be doing at the beginning the first step will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17617" target="_blank">04:53:37.360</a></span> | <span class="t">be 1000 the next step will be 980 the next step will be 960 etc so this time will change according</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17624" target="_blank">04:53:44.720</a></span> | <span class="t">to this schedule so that at the 50th step we are at the time step 0 and how can we then with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17635" target="_blank">04:53:55.440</a></span> | <span class="t">predicted noise go to the next latent so we remove this noise that was predicted by the unit well we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17641" target="_blank">04:54:01.840</a></span> | <span class="t">do it with the sampler and in particular we do it with the sample method of the sampler step method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17649" target="_blank">04:54:09.040</a></span> | <span class="t">sorry of the sampler which basically will calculate the previous sample given the current sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17654" target="_blank">04:54:14.640</a></span> | <span class="t">according to the formula number 7 here so which basically calculates the previous sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17661" target="_blank">04:54:21.120</a></span> | <span class="t">given the current one so the less noisy one given the current one and the predicted x0 so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17667" target="_blank">04:54:27.840</a></span> | <span class="t">not x0 because we don't have x0 so we don't have the noise the sample without any noise so but we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17674" target="_blank">04:54:34.880</a></span> | <span class="t">can predict it given the values of the current noise and the beta schedule another way of denoising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17682" target="_blank">04:54:42.480</a></span> | <span class="t">is to do the sampling like this if you watch my other repository about the ddbm paper i actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17688" target="_blank">04:54:48.000</a></span> | <span class="t">implemented it like this if you want to see this version here and this is how we remove the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17694" target="_blank">04:54:54.160</a></span> | <span class="t">to get a less noisy version so once we get the less noisy version we keep doing this process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17699" target="_blank">04:54:59.920</a></span> | <span class="t">until there is no more noise so we are at the time step zero in which we have no more noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17704" target="_blank">04:55:04.800</a></span> | <span class="t">we give this latent to the decoder which will turn it into an image this is how the text to image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17709" target="_blank">04:55:09.920</a></span> | <span class="t">works the image to image on the other side so let's try to do the image to image so to do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17715" target="_blank">04:55:15.200</a></span> | <span class="t">image to image we need to go here and we uncomment this code here this allows us to start with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17725" target="_blank">04:55:25.680</a></span> | <span class="t">dog and then give for example some prompt for example we want this dog here we want to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17731" target="_blank">04:55:31.840</a></span> | <span class="t">okay we want a dog stretching on the floor highly detailed etc we can run it i will not run it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17738" target="_blank">04:55:38.560</a></span> | <span class="t">because it will take another five minutes and if we do this we can set a strength of let's say 0.6</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17745" target="_blank">04:55:45.760</a></span> | <span class="t">which means that let's go here so we set a strength of 0.6 so we have this input image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17754" target="_blank">04:55:54.000</a></span> | <span class="t">strength of 0.6 means that we will add we will encode it with the variation auto encoder will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17759" target="_blank">04:55:59.680</a></span> | <span class="t">become a latent will add some noise but how much noise not all the noise so that it becomes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17766" target="_blank">04:56:06.560</a></span> | <span class="t">completely noise but less noise than that so at let's let's say 60 percent noise is not really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17774" target="_blank">04:56:14.080</a></span> | <span class="t">true because because it depends on the schedule in our case it's linear so it can be considered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17781" target="_blank">04:56:21.040</a></span> | <span class="t">60 percent of noise we then give this image to the scheduler which will start not from the 1000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17788" target="_blank">04:56:28.240</a></span> | <span class="t">step it will start before so if we set the strength to 0.6 it will start from the 600</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17794" target="_blank">04:56:34.800</a></span> | <span class="t">step and then move by 20 we'll keep going 600 then 580 then 560 then 540 etc until it reaches 20</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17806" target="_blank">04:56:46.640</a></span> | <span class="t">so in total it will do less steps because we start from a less noisy example but at the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17812" target="_blank">04:56:52.560</a></span> | <span class="t">time because we start with less noise the the unit also has less freedom to change the to alter the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17820" target="_blank">04:57:00.720</a></span> | <span class="t">image because he already have the image so he cannot change it too much so how do you adjust</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17827" target="_blank">04:57:07.040</a></span> | <span class="t">the noise the the noise level depends if you want the unit to pay very much attention to the input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17833" target="_blank">04:57:13.440</a></span> | <span class="t">image and not change it too much then you add less noise if you want to change completely the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17840" target="_blank">04:57:20.800</a></span> | <span class="t">original image then you can add all the possible noise so you set the strength to one and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17845" target="_blank">04:57:25.280</a></span> | <span class="t">how the image to image works i didn't implement the inpainting because the reason is that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17852" target="_blank">04:57:32.880</a></span> | <span class="t">pre-trained model here so the model that we are using is not fine-tuned for inpainting so if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17858" target="_blank">04:57:38.080</a></span> | <span class="t">go on the website and you look at the model card they have another model for inpainting which has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17865" target="_blank">04:57:45.280</a></span> | <span class="t">different weights here the this one here but this the structure of this model is also a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17873" target="_blank">04:57:53.120</a></span> | <span class="t">different because they have in the unit they have five additional input channels for the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17878" target="_blank">04:57:58.800</a></span> | <span class="t">i will of course implement it in my repository directly so i will modify the code and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17887" target="_blank">04:58:07.440</a></span> | <span class="t">also implement the code for inpainting so that we can support this model but unfortunately i don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17892" target="_blank">04:58:12.960</a></span> | <span class="t">have the time now because in china here is guoqing and i'm going to laojia with my my wife so we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17899" target="_blank">04:58:19.760</a></span> | <span class="t">a little short of time but i hope that with my video guys you you got really into stable diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17906" target="_blank">04:58:26.240</a></span> | <span class="t">and you understood what is happening under the hood instead of just using the hugging face library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17911" target="_blank">04:58:31.440</a></span> | <span class="t">and also notice that the model itself is not so particularly sophisticated if you check the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17919" target="_blank">04:58:39.520</a></span> | <span class="t">decoder and the encoder they are just a bunch of convolutions and upsampling and the normalizations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17927" target="_blank">04:58:47.200</a></span> | <span class="t">just like any other computer vision model and the same goes on for the unit of course there are very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17933" target="_blank">04:58:53.280</a></span> | <span class="t">smart choices in how they do it okay but that's not the important thing of the diffusion and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17939" target="_blank">04:58:59.440</a></span> | <span class="t">actually if we study the diffusion models like score models you will see that it doesn't even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17943" target="_blank">04:59:03.680</a></span> | <span class="t">matter the structure of the model as long as the model is expressive it will actually learn the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17949" target="_blank">04:59:09.040</a></span> | <span class="t">score function in the same way but this is not our case in this video i will talk about score model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17954" target="_blank">04:59:14.000</a></span> | <span class="t">in future videos what i want you to understand is that how this all mechanism works together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17960" target="_blank">04:59:20.400</a></span> | <span class="t">so how can we just learn a model that predicts the noise and then we come up with images and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17968" target="_blank">04:59:28.160</a></span> | <span class="t">let me rehearse again the idea so we started by training a model that needs to learn a probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17975" target="_blank">04:59:35.760</a></span> | <span class="t">distribution as you remember p of theta here we we cannot learn this one directly because we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17983" target="_blank">04:59:43.120</a></span> | <span class="t">know how to marginalize here so what we did is we find some lower bound for this quantity here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17989" target="_blank">04:59:49.120</a></span> | <span class="t">we maximize this lower bound how do we maximize this lower bound by training a model by running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=17994" target="_blank">04:59:54.800</a></span> | <span class="t">the gradient descent on this loss this loss produces a model that allow us to predict the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18003" target="_blank">05:00:03.760</a></span> | <span class="t">noise then how do we actually use this model with the predicted noise to go back in time with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18010" target="_blank">05:00:10.880</a></span> | <span class="t">noise because the forward process we know how to go it's defined by us how to add noise but in back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18015" target="_blank">05:00:15.680</a></span> | <span class="t">in time so how to remove noise we don't know and we do it according to the formulas that i have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18020" target="_blank">05:00:20.880</a></span> | <span class="t">described in the sampler so the formula number seven and the formula number also this one actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18027" target="_blank">05:00:27.360</a></span> | <span class="t">we can use actually i will show you in my other um here i have another repository i think it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18033" target="_blank">05:00:33.760</a></span> | <span class="t">called python ddpm in which i implemented the ddpm paper but by using this algorithm here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18039" target="_blank">05:00:39.840</a></span> | <span class="t">if you are interested in this version of the denoising you can check my other uh repository</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18044" target="_blank">05:00:44.720</a></span> | <span class="t">here this one ddpm and i also wanted to show you how the inpainting works how the how the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18052" target="_blank">05:00:52.720</a></span> | <span class="t">image to image and how the text to image works of course the possibilities are limitless it all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18059" target="_blank">05:00:59.600</a></span> | <span class="t">depends on the powerfulness of the model and how you use it and i hope you use it in a clever way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18067" target="_blank">05:01:07.200</a></span> | <span class="t">to build amazing products i also want to thank very much many repositories that i have used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18073" target="_blank">05:01:13.600</a></span> | <span class="t">as a self-studying material so because of course i didn't make up all this by myself i studied a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18078" target="_blank">05:01:18.720</a></span> | <span class="t">lot of papers i read i think to study this diffusion models i read more than 30 papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18083" target="_blank">05:01:23.600</a></span> | <span class="t">in the last few weeks so it took me a lot of time but i was really passionate about this kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18090" target="_blank">05:01:30.240</a></span> | <span class="t">models because they're complicated and i really like to study things that can generate new stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18095" target="_blank">05:01:35.600</a></span> | <span class="t">so i want to really thank in particularly some resources that i have used let me see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18102" target="_blank">05:01:42.880</a></span> | <span class="t">this one's here so the official code the this guy divam gupta this other repository from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18109" target="_blank">05:01:49.200</a></span> | <span class="t">this person here which i used very much actually as a base and the diffusers library from this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18116" target="_blank">05:01:56.640</a></span> | <span class="t">hugging face upon which i based most of the code of my sampler because i think it's better to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18123" target="_blank">05:02:03.040</a></span> | <span class="t">because we are actually just applying some formulas there is no point in writing it from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18126" target="_blank">05:02:06.960</a></span> | <span class="t">zero the point is actually understanding what is happening with these formulas and why we are doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18131" target="_blank">05:02:11.200</a></span> | <span class="t">it the things we are doing and as usual the full code is available i will also make all the slides</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18136" target="_blank">05:02:16.480</a></span> | <span class="t">available for you guys and i hope if you are in china you also have a great holiday with me and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18141" target="_blank">05:02:21.920</a></span> | <span class="t">if you're not in china i hope you have a great time with your family and friends and everyone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18145" target="_blank">05:02:25.840</a></span> | <span class="t">else so welcome back to my channel anytime and please feel free to comment on send me a comment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18151" target="_blank">05:02:31.840</a></span> | <span class="t">or if you didn't understand something or if you want me to explain something better because i'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18157" target="_blank">05:02:37.520</a></span> | <span class="t">always available for explanation and guys i do this not as my full-time job of course i do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18163" target="_blank">05:02:43.920</a></span> | <span class="t">as a part-time and lately i'm doing consulting so i'm very busy but sometime i take time to record</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18171" target="_blank">05:02:51.040</a></span> | <span class="t">videos and so please share my channel share my video with people if you like it and so that my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18177" target="_blank">05:02:57.680</a></span> | <span class="t">channel can grow and i have more motivation to keep doing this kind of videos which take really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18182" target="_blank">05:03:02.800</a></span> | <span class="t">a lot of time because to prepare a video like this i spend around many weeks of research but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18188" target="_blank">05:03:08.560</a></span> | <span class="t">this is okay i do it for as a passion i don't do it as a job and i spend really a lot of time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18194" target="_blank">05:03:14.640</a></span> | <span class="t">preparing all the slides and preparing all the speeches and preparing the code and cleaning it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18200" target="_blank">05:03:20.080</a></span> | <span class="t">and commenting it etc etc i always do it for free so if you would like to support me the best way is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZBKpAp_6TGI&t=18206" target="_blank">05:03:26.400</a></span> | <span class="t">to subscribe like my video and share it with other people thank you guys and have a nice day</span></div></div></body></html>