<html><head><title>How-to Decode Outputs From NLP Models (Python)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>How-to Decode Outputs From NLP Models (Python)</h2><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE"><img src="https://i.ytimg.com/vi_webp/QJq9RTp_OVE/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=77">1:17</a> Generate Method<br><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=212">3:32</a> Random Sampling Method<br><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=281">4:41</a> Random Sampling<br><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=429">7:9</a> Beam Search Explained<br><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=461">7:41</a> Adding Beam Search<br><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=509">8:29</a> Temperature<br><br><div style="text-align: left;"><a href="./QJq9RTp_OVE.html">Whisper Transcript</a> | <a href="./transcript_QJq9RTp_OVE.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi, welcome to this video on decoding methods for text generation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=3" target="_blank">00:00:03.840</a></span> | <span class="t">So when we're performing a lot of different NLP tasks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=9" target="_blank">00:00:09.000</a></span> | <span class="t">a lot of people focus very much on the actual model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=13" target="_blank">00:00:13.600</a></span> | <span class="t">which is fair enough. The model is very important,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=16" target="_blank">00:00:16.800</a></span> | <span class="t">but a lot of people, at least when they're self-learning,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=20" target="_blank">00:00:20.160</a></span> | <span class="t">they miss the fact that you can make a big impact on your output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=24" target="_blank">00:00:24.360</a></span> | <span class="t">depending on how you're decoding your texts or your tokens at the end of your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=29" target="_blank">00:00:29.320</a></span> | <span class="t">model. What I mean by that is you have your model here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=33" target="_blank">00:00:33.000</a></span> | <span class="t">and then when you're outputting that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=35" target="_blank">00:00:35.840</a></span> | <span class="t">you typically have a probability distribution across your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=40" target="_blank">00:00:40.040</a></span> | <span class="t">vocabulary or output vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=42" target="_blank">00:00:42.000</a></span> | <span class="t">And it is that probability distribution that allows you to choose what token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=47" target="_blank">00:00:47.000</a></span> | <span class="t">you're going to output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=47" target="_blank">00:00:47.960</a></span> | <span class="t">So we're going to focus on a few different ways of doing that because there are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=51" target="_blank">00:00:51.520</a></span> | <span class="t">quite a few different ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=52" target="_blank">00:00:52.560</a></span> | <span class="t">The three ways that we're going to look at include greedy decoding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=58" target="_blank">00:00:58.880</a></span> | <span class="t">random sampling, and beam search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=61" target="_blank">00:01:01.560</a></span> | <span class="t">Generally, I think once you know these three, you're pretty good to go,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=66" target="_blank">00:01:06.880</a></span> | <span class="t">and you can make a really big difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=68" target="_blank">00:01:08.680</a></span> | <span class="t">You'll see in this video in the actual outputs of your models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=73" target="_blank">00:01:13.520</a></span> | <span class="t">So let's just jump straight into it. Here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=77" target="_blank">00:01:17.840</a></span> | <span class="t">we just have the setup. So we have our model setup,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=81" target="_blank">00:01:21.400</a></span> | <span class="t">and it's just generating texts based on this input here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=86" target="_blank">00:01:26.200</a></span> | <span class="t">which is just an extract from the Wikipedia page about Winston Churchill.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=90" target="_blank">00:01:30.880</a></span> | <span class="t">We have this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=93" target="_blank">00:01:33.000</a></span> | <span class="t">we've encoded our input here and all we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=97" target="_blank">00:01:37.920</a></span> | <span class="t">to do to actually generate our outputs from this is we'll output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=102" target="_blank">00:01:42.920</a></span> | <span class="t">the generated tokens to outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=105" target="_blank">00:01:45.520</a></span> | <span class="t">And we just call the generate method on our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=110" target="_blank">00:01:50.400</a></span> | <span class="t">And then we pass in the inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=113" target="_blank">00:01:53.560</a></span> | <span class="t">And then we just pass in the length that we want to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=116" target="_blank">00:01:56.360</a></span> | <span class="t">So the number of tokens that we actually want to output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=118" target="_blank">00:01:58.960</a></span> | <span class="t">So I'm just going to go 200. Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=124" target="_blank">00:02:04.280</a></span> | <span class="t">And then to actually read that we need to decode it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=127" target="_blank">00:02:07.800</a></span> | <span class="t">Okay. And that is our text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=137" target="_blank">00:02:17.520</a></span> | <span class="t">So I just want to point out here that when we're calling this decode method,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=142" target="_blank">00:02:22.760</a></span> | <span class="t">that is not when we are using these decoding methods that this video is about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=147" target="_blank">00:02:27.360</a></span> | <span class="t">that that is just decoding using our tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=151" target="_blank">00:02:31.440</a></span> | <span class="t">So taking the token IDs that we do have our predicted token IDs and decoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=156" target="_blank">00:02:36.360</a></span> | <span class="t">them into English,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=157" target="_blank">00:02:37.400</a></span> | <span class="t">the decoding methods that we're talking about take place at the end of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=162" target="_blank">00:02:42.240</a></span> | <span class="t">generate method here. So by default,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=165" target="_blank">00:02:45.280</a></span> | <span class="t">this is greedy decoding and greedy decoding is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=169" target="_blank">00:02:49.200</a></span> | <span class="t">I would say the simplest approach and it's the one that you would probably think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=173" target="_blank">00:02:53.240</a></span> | <span class="t">of when you try and just figure this out through intuition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=176" target="_blank">00:02:56.640</a></span> | <span class="t">So obviously we have our probability distribution and we have our output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=182" target="_blank">00:03:02.520</a></span> | <span class="t">vocabulary and each value within that output distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=187" target="_blank">00:03:07.400</a></span> | <span class="t">represents a mapping to one of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=192" target="_blank">00:03:12.680</a></span> | <span class="t">words or tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=193" target="_blank">00:03:13.920</a></span> | <span class="t">What greedy decoding does is simply chooses the token that has the highest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=198" target="_blank">00:03:18.840</a></span> | <span class="t">probability, which obviously makes a lot of sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=201" target="_blank">00:03:21.200</a></span> | <span class="t">And for shorter sequences, this is perfectly fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=205" target="_blank">00:03:25.960</a></span> | <span class="t">But then when we start applying this to longer sequences,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=210" target="_blank">00:03:30.160</a></span> | <span class="t">it causes a lot of issues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=211" target="_blank">00:03:31.560</a></span> | <span class="t">If you've ever seen a output that looks like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=215" target="_blank">00:03:35.480</a></span> | <span class="t">where you have a lot of repetition,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=218" target="_blank">00:03:38.520</a></span> | <span class="t">it just keeps repeating itself over and over again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=221" target="_blank">00:03:41.080</a></span> | <span class="t">This is typically because of greedy decoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=224" target="_blank">00:03:44.480</a></span> | <span class="t">So when we're looking at longer sequences,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=227" target="_blank">00:03:47.960</a></span> | <span class="t">what we will find is that it creates kind of like a loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=232" target="_blank">00:03:52.000</a></span> | <span class="t">So it sees, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=235" target="_blank">00:03:55.120</a></span> | <span class="t">the best match for one word and then it reads the best match for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=240" target="_blank">00:04:00.040</a></span> | <span class="t">the next word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=241" target="_blank">00:04:01.360</a></span> | <span class="t">And then as soon as it sees that first word again as the next best match,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=246" target="_blank">00:04:06.360</a></span> | <span class="t">it's just going to create a loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=248" target="_blank">00:04:08.080</a></span> | <span class="t">So that's why we want to avoid greedy decoding for longer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=253" target="_blank">00:04:13.920</a></span> | <span class="t">sequences. So the next option we have is random sampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=258" target="_blank">00:04:18.040</a></span> | <span class="t">Like before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=259" target="_blank">00:04:19.640</a></span> | <span class="t">we still have our outputs and we have that probability distribution across all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=264" target="_blank">00:04:24.240</a></span> | <span class="t">of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=265" target="_blank">00:04:25.080</a></span> | <span class="t">And what random sampling does differently is it chooses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=269" target="_blank">00:04:29.360</a></span> | <span class="t">one of these tokens based on that probability at random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=274" target="_blank">00:04:34.120</a></span> | <span class="t">So what I mean by that is it will choose a token at random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=278" target="_blank">00:04:38.800</a></span> | <span class="t">So it can choose any of those,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=280" target="_blank">00:04:40.880</a></span> | <span class="t">but the probability of choosing that token is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=285" target="_blank">00:04:45.160</a></span> | <span class="t">weighted based on the probability of that token being the next token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=289" target="_blank">00:04:49.800</a></span> | <span class="t">from the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=290" target="_blank">00:04:50.880</a></span> | <span class="t">It's very similar to greedy decoding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=295" target="_blank">00:04:55.480</a></span> | <span class="t">but it just adds that sort of layer of randomness where every now and again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=300" target="_blank">00:05:00.320</a></span> | <span class="t">it's going to choose something other than the most probable token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=304" target="_blank">00:05:04.560</a></span> | <span class="t">And all we do to actually use random sampling is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=309" target="_blank">00:05:09.760</a></span> | <span class="t">add a do sample argument here and set this to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=314" target="_blank">00:05:14.360</a></span> | <span class="t">true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=315" target="_blank">00:05:15.200</a></span> | <span class="t">And this will switch our decoding method from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=320" target="_blank">00:05:20.160</a></span> | <span class="t">greedy decoding to random sampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=322" target="_blank">00:05:22.160</a></span> | <span class="t">And we will see that the output of this is not as repetitive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=326" target="_blank">00:05:26.920</a></span> | <span class="t">So if we just decode this here. Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=332" target="_blank">00:05:32.840</a></span> | <span class="t">And we can see that it's a lot more random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=337" target="_blank">00:05:37.920</a></span> | <span class="t">So this solves our problem of getting stuck in a repeating loop of the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=342" target="_blank">00:05:42.480</a></span> | <span class="t">words over and over again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=343" target="_blank">00:05:43.600</a></span> | <span class="t">because we just add this randomness to our predictions. However,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=347" target="_blank">00:05:47.800</a></span> | <span class="t">this does introduce another problem,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=350" target="_blank">00:05:50.400</a></span> | <span class="t">which is we will often find that the outputs we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=355" target="_blank">00:05:55.040</a></span> | <span class="t">producing are too random and they're just not coherent because of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=359" target="_blank">00:05:59.800</a></span> | <span class="t">This one is reasonably coherent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=362" target="_blank">00:06:02.720</a></span> | <span class="t">It's so talking about UK politics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=367" target="_blank">00:06:07.200</a></span> | <span class="t">Sometimes it gets super weird.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=368" target="_blank">00:06:08.640</a></span> | <span class="t">It will start talking about chameleons and game sales and stuff like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=373" target="_blank">00:06:13.880</a></span> | <span class="t">within, you know, a few sentences, it was actually talking about Churchill.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=378" target="_blank">00:06:18.440</a></span> | <span class="t">So on one side, we have greedy search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=380" target="_blank">00:06:20.920</a></span> | <span class="t">which is too strict and it just causes a loop of the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=385" target="_blank">00:06:25.800</a></span> | <span class="t">words over and over again. And on the other side, we have random sampling,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=389" target="_blank">00:06:29.920</a></span> | <span class="t">which is too random and ends up just producing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=394" target="_blank">00:06:34.960</a></span> | <span class="t">gibberish almost all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=396" target="_blank">00:06:36.920</a></span> | <span class="t">So what we need is something in the middle,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=401" target="_blank">00:06:41.520</a></span> | <span class="t">and that is why we use beam search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=405" target="_blank">00:06:45.320</a></span> | <span class="t">So beam search allows us to explore multiple levels of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=411" target="_blank">00:06:51.200</a></span> | <span class="t">our output before selecting the best option.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=414" target="_blank">00:06:54.400</a></span> | <span class="t">Whereas greedy decoding and random sampling is just looking at the very next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=419" target="_blank">00:06:59.960</a></span> | <span class="t">token and then calculates, you know, which one to choose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=423" target="_blank">00:07:03.680</a></span> | <span class="t">What beam search does is it goes ahead in time and it searches through multiple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=428" target="_blank">00:07:08.560</a></span> | <span class="t">potential paths and then finds the best option based on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=433" target="_blank">00:07:13.120</a></span> | <span class="t">the full sequence rather than just the next token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=437" target="_blank">00:07:17.320</a></span> | <span class="t">And this just allows us to assess multiple different options</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=443" target="_blank">00:07:23.160</a></span> | <span class="t">and assess a longer length of time than just one token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=445" target="_blank">00:07:25.840</a></span> | <span class="t">which means typically we're going to see more coherent language from these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=450" target="_blank">00:07:30.880</a></span> | <span class="t">outputs as well. And the beam in beam search is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=455" target="_blank">00:07:35.000</a></span> | <span class="t">all that's referring to is the number of paths that we assess</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=460" target="_blank">00:07:40.320</a></span> | <span class="t">and we consider. To add beam search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=463" target="_blank">00:07:43.680</a></span> | <span class="t">all we need to do is add number of beams.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=466" target="_blank">00:07:46.840</a></span> | <span class="t">And we just set that to a value that is more than one because a beam of one is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=471" target="_blank">00:07:51.560</a></span> | <span class="t">actually just the default. So if we set this to two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=475" target="_blank">00:07:55.760</a></span> | <span class="t">we then search two different beams or two different options</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=480" target="_blank">00:08:00.960</a></span> | <span class="t">at once. And this usually is pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=485" target="_blank">00:08:05.240</a></span> | <span class="t">However,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=486" target="_blank">00:08:06.040</a></span> | <span class="t">because we're now back to ranking sequences and selecting the most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=490" target="_blank">00:08:10.720</a></span> | <span class="t">probable beam search can quite easily fall back into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=495" target="_blank">00:08:15.680</a></span> | <span class="t">this repetitive nature that we get with greedy decoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=499" target="_blank">00:08:19.040</a></span> | <span class="t">So what we need to do to counteract that is add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=504" target="_blank">00:08:24.920</a></span> | <span class="t">the temperature argument to our code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=508" target="_blank">00:08:28.280</a></span> | <span class="t">So the temperature essentially controls the amount of randomness</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=513" target="_blank">00:08:33.160</a></span> | <span class="t">within the beam search choice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=516" target="_blank">00:08:36.680</a></span> | <span class="t">And by default, this is set to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=519" target="_blank">00:08:39.400</a></span> | <span class="t">We can add more randomness to the output by increasing this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=525" target="_blank">00:08:45.480</a></span> | <span class="t">So say to 1.2 and this will just make the outputs more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=530" target="_blank">00:08:50.200</a></span> | <span class="t">random, but because we're using beam search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=533" target="_blank">00:08:53.800</a></span> | <span class="t">it will still remain reasonably coherent unless we really turn the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=538" target="_blank">00:08:58.440</a></span> | <span class="t">temperature up to a very high number, like five or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=541" target="_blank">00:09:01.880</a></span> | <span class="t">And if we want to reduce the randomness in our outputs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=544" target="_blank">00:09:04.960</a></span> | <span class="t">we just reduce the temperature to something below one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=548" target="_blank">00:09:08.800</a></span> | <span class="t">So 0.8, for example. So with this, I mean, we,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=553" target="_blank">00:09:13.560</a></span> | <span class="t">we have our beam search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=554" target="_blank">00:09:14.880</a></span> | <span class="t">We have some good outputs and somewhat peculiar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=559" target="_blank">00:09:19.040</a></span> | <span class="t">but they're pretty coherent. So it's pretty good. I mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=561" target="_blank">00:09:21.960</a></span> | <span class="t">I think that's everything for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=564" target="_blank">00:09:24.240</a></span> | <span class="t">I think these three decoding methods are pretty important to know and they can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=568" target="_blank">00:09:28.880</a></span> | <span class="t">make a big difference in the quality of your outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=QJq9RTp_OVE&t=571" target="_blank">00:09:31.040</a></span> | <span class="t">So thank you very much for watching and I will see you again next time.</span></div></div></body></html>