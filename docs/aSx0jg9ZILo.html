<html><head><title>Fine-tune Sentence Transformers the OG Way (with NLI Softmax loss)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Fine-tune Sentence Transformers the OG Way (with NLI Softmax loss)</h2><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo"><img src="https://i.ytimg.com/vi/aSx0jg9ZILo/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=42">0:42</a> NLI Fine-tuning<br><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=104">1:44</a> Softmax Loss Training Overview<br><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=347">5:47</a> Preprocessing NLI Data<br><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=768">12:48</a> PyTorch Process<br><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1188">19:48</a> Using Sentence-Transformers<br><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1845">30:45</a> Results<br><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2149">35:49</a> Outro<br><br><div style="text-align: left;"><a href="./aSx0jg9ZILo.html">Whisper Transcript</a> | <a href="./transcript_aSx0jg9ZILo.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi, welcome to the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2" target="_blank">00:00:02.160</a></span> | <span class="t">We're going to be covering how we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=4" target="_blank">00:00:04.200</a></span> | <span class="t">can train a SBERT model, or a Sentence Transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=7" target="_blank">00:00:07.720</a></span> | <span class="t">or SentenceBERT model, using what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=12" target="_blank">00:00:12.240</a></span> | <span class="t">is kind of like the original way of training these models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=15" target="_blank">00:00:15.320</a></span> | <span class="t">or fine-tuning these models, which is using Softmax Loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=19" target="_blank">00:00:19.940</a></span> | <span class="t">So let's start with just a quick overview</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=22" target="_blank">00:00:22.520</a></span> | <span class="t">of the training approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=24" target="_blank">00:00:24.840</a></span> | <span class="t">[MUSIC PLAYING]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=28" target="_blank">00:00:28.320</a></span> | <span class="t">[MUSIC PLAYING]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=31" target="_blank">00:00:31.760</a></span> | <span class="t">Now, using the Softmax training approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=47" target="_blank">00:00:47.320</a></span> | <span class="t">is part of what we could call the natural language inference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=52" target="_blank">00:00:52.440</a></span> | <span class="t">approach to fine-tuning these models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=55" target="_blank">00:00:55.280</a></span> | <span class="t">And within that sort of category of training,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=59" target="_blank">00:00:59.560</a></span> | <span class="t">we have two approaches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=61" target="_blank">00:01:01.520</a></span> | <span class="t">We have Softmax Loss or Softmax Classification Loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=65" target="_blank">00:01:05.360</a></span> | <span class="t">which we're going to cover.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=66" target="_blank">00:01:06.600</a></span> | <span class="t">And then we also have something called a Multiple Negatives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=70" target="_blank">00:01:10.600</a></span> | <span class="t">Ranking Loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=72" target="_blank">00:01:12.040</a></span> | <span class="t">Now, in reality, you probably wouldn't use Softmax Loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=77" target="_blank">00:01:17.840</a></span> | <span class="t">because it's just nowhere near as good as using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=82" target="_blank">00:01:22.120</a></span> | <span class="t">the other form of Loss, the Multiple Negatives Ranking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=85" target="_blank">00:01:25.760</a></span> | <span class="t">I'm going to call it MNR from now on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=88" target="_blank">00:01:28.480</a></span> | <span class="t">So MNR is more effective, but Softmax Loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=92" target="_blank">00:01:32.240</a></span> | <span class="t">is sort of the original, and that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=93" target="_blank">00:01:33.840</a></span> | <span class="t">why we're covering it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=95" target="_blank">00:01:35.560</a></span> | <span class="t">So we're just going to go through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=97" target="_blank">00:01:37.160</a></span> | <span class="t">We're not going to go into too much depth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=102" target="_blank">00:01:42.360</a></span> | <span class="t">I'm going to just kind of go through it very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=105" target="_blank">00:01:45.960</a></span> | <span class="t">So when we're training these models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=107" target="_blank">00:01:47.520</a></span> | <span class="t">we can either use what is called a Siamese network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=111" target="_blank">00:01:51.480</a></span> | <span class="t">or a triplet network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=112" target="_blank">00:01:52.880</a></span> | <span class="t">Now, what you can see right now is a Siamese network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=115" target="_blank">00:01:55.760</a></span> | <span class="t">So we have almost like two copies of the same BERT,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=119" target="_blank">00:01:59.640</a></span> | <span class="t">so they're like Siamese twins.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=123" target="_blank">00:02:03.360</a></span> | <span class="t">And the idea is we would have two sentences, sentence A</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=127" target="_blank">00:02:07.480</a></span> | <span class="t">and sentence B, and we would feed both of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=130" target="_blank">00:02:10.680</a></span> | <span class="t">through our BERT model and produce the token embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=134" target="_blank">00:02:14.880</a></span> | <span class="t">that we usually get from BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=136" target="_blank">00:02:16.400</a></span> | <span class="t">And then we use a pooling operation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=138" target="_blank">00:02:18.440</a></span> | <span class="t">so like a mean average pooling, and then from that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=142" target="_blank">00:02:22.640</a></span> | <span class="t">we get our sentence embedding in U and V.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=146" target="_blank">00:02:26.080</a></span> | <span class="t">And what we would be doing is optimizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=149" target="_blank">00:02:29.920</a></span> | <span class="t">to try and get those sentence embeddings as close as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=154" target="_blank">00:02:34.320</a></span> | <span class="t">possible for similar sentences, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=158" target="_blank">00:02:38.280</a></span> | <span class="t">for dissimilar sentences, we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=159" target="_blank">00:02:39.720</a></span> | <span class="t">them to be as far away from each other as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=166" target="_blank">00:02:46.560</a></span> | <span class="t">So that's kind of like the start of the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=170" target="_blank">00:02:50.880</a></span> | <span class="t">but it's not the full model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=172" target="_blank">00:02:52.640</a></span> | <span class="t">We continue, and what we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=177" target="_blank">00:02:57.040</a></span> | <span class="t">is concatenate those two together, so U plus V here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=183" target="_blank">00:03:03.480</a></span> | <span class="t">And then we're also going to do this other operation here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=186" target="_blank">00:03:06.800</a></span> | <span class="t">So we're going to take U and V, and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=188" target="_blank">00:03:08.520</a></span> | <span class="t">going to get difference between them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=190" target="_blank">00:03:10.920</a></span> | <span class="t">So this is just a positive number here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=193" target="_blank">00:03:13.080</a></span> | <span class="t">We're taking the magnitude here, these bars.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=197" target="_blank">00:03:17.480</a></span> | <span class="t">So we're just getting a positive number, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=199" target="_blank">00:03:19.880</a></span> | <span class="t">is a difference between the two vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=202" target="_blank">00:03:22.680</a></span> | <span class="t">and we also concatenate that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=204" target="_blank">00:03:24.080</a></span> | <span class="t">And we create this big vector, which is U, V,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=209" target="_blank">00:03:29.560</a></span> | <span class="t">and then we have U minus V at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=211" target="_blank">00:03:31.240</a></span> | <span class="t">And we take that vector, so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=218" target="_blank">00:03:38.120</a></span> | <span class="t">what you can see over here, and we feed it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=220" target="_blank">00:03:40.680</a></span> | <span class="t">into a very simple feed-forward neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=224" target="_blank">00:03:44.880</a></span> | <span class="t">So to feed-forward neural network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=227" target="_blank">00:03:47.000</a></span> | <span class="t">each one of these sentence embeddings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=229" target="_blank">00:03:49.520</a></span> | <span class="t">we're going to have the dimensionality of 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=235" target="_blank">00:03:55.040</a></span> | <span class="t">So obviously, the dimensionality or input dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=238" target="_blank">00:03:58.000</a></span> | <span class="t">of our feed-forward neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=239" target="_blank">00:03:59.880</a></span> | <span class="t">is 768 with pipeline 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=245" target="_blank">00:04:05.120</a></span> | <span class="t">And then the output are our three output activations here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=251" target="_blank">00:04:11.240</a></span> | <span class="t">Now, if you watched the last video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=253" target="_blank">00:04:13.520</a></span> | <span class="t">or you read the last article, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=255" target="_blank">00:04:15.800</a></span> | <span class="t">will remember that we had three labels in our training data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=262" target="_blank">00:04:22.960</a></span> | <span class="t">So in our NLI training data, we had its entailment, neutral,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=272" target="_blank">00:04:32.520</a></span> | <span class="t">and contradiction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=274" target="_blank">00:04:34.400</a></span> | <span class="t">So those sentence pairs, and we're trying to classify,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=276" target="_blank">00:04:36.960</a></span> | <span class="t">are they relevant to each other or not?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=280" target="_blank">00:04:40.440</a></span> | <span class="t">And then we have the true label over here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=283" target="_blank">00:04:43.920</a></span> | <span class="t">and then we just optimize using cross-entropy loss, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=287" target="_blank">00:04:47.280</a></span> | <span class="t">is what you can see over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=289" target="_blank">00:04:49.480</a></span> | <span class="t">The reason why this is called softmax loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=291" target="_blank">00:04:51.880</a></span> | <span class="t">is because there is a softmax function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=294" target="_blank">00:04:54.760</a></span> | <span class="t">within the cross-entropy loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=300" target="_blank">00:05:00.240</a></span> | <span class="t">So that's the process at high level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=306" target="_blank">00:05:06.640</a></span> | <span class="t">So let's jump in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=308" target="_blank">00:05:08.520</a></span> | <span class="t">We're going to first--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=311" target="_blank">00:05:11.640</a></span> | <span class="t">we're mainly going to focus on how we form our data to put it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=315" target="_blank">00:05:15.280</a></span> | <span class="t">into here, and then we're going to move on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=317" target="_blank">00:05:17.400</a></span> | <span class="t">to how we actually train all of this using the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=323" target="_blank">00:05:23.360</a></span> | <span class="t">transformers library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=324" target="_blank">00:05:24.560</a></span> | <span class="t">That's going to be our main focus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=326" target="_blank">00:05:26.400</a></span> | <span class="t">But we'll just very quickly run through the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=329" target="_blank">00:05:29.680</a></span> | <span class="t">in PyTorch, so you can just see how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=334" target="_blank">00:05:34.800</a></span> | <span class="t">And if you really want to dive into it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=336" target="_blank">00:05:36.720</a></span> | <span class="t">you can obviously just take a look at the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=339" target="_blank">00:05:39.000</a></span> | <span class="t">and figure out how it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=340" target="_blank">00:05:40.720</a></span> | <span class="t">It's not hard to read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=342" target="_blank">00:05:42.320</a></span> | <span class="t">So let's jump into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=344" target="_blank">00:05:44.720</a></span> | <span class="t">OK, so the first thing that we want to do--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=350" target="_blank">00:05:50.680</a></span> | <span class="t">I've added a little note up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=352" target="_blank">00:05:52.060</a></span> | <span class="t">This is just an information of what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=354" target="_blank">00:05:54.720</a></span> | <span class="t">is in our data or the labels of our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=358" target="_blank">00:05:58.120</a></span> | <span class="t">We're going to have a look at our data anyway now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=360" target="_blank">00:06:00.560</a></span> | <span class="t">So I'm going to use the HuggingFace data sets library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=364" target="_blank">00:06:04.680</a></span> | <span class="t">So we're just going to import data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=367" target="_blank">00:06:07.280</a></span> | <span class="t">And we're actually using two different data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=370" target="_blank">00:06:10.160</a></span> | <span class="t">We're using the Stanford Natural Language Inference,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=372" target="_blank">00:06:12.520</a></span> | <span class="t">or SNLI data set, and also the multi-genre NLI data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=376" target="_blank">00:06:16.840</a></span> | <span class="t">as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=379" target="_blank">00:06:19.960</a></span> | <span class="t">So SNLI, we just put that in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=382" target="_blank">00:06:22.920</a></span> | <span class="t">So it's data sets load data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=389" target="_blank">00:06:29.520</a></span> | <span class="t">And then it's called SNLI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=391" target="_blank">00:06:31.160</a></span> | <span class="t">And we want the training subset of that, so train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=398" target="_blank">00:06:38.080</a></span> | <span class="t">It's also-- sorry, not subset--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=400" target="_blank">00:06:40.040</a></span> | <span class="t">split.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=400" target="_blank">00:06:40.540</a></span> | <span class="t">And then we can have a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=405" target="_blank">00:06:45.520</a></span> | <span class="t">What do we have inside the data?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=409" target="_blank">00:06:49.080</a></span> | <span class="t">OK, so we have these three features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=412" target="_blank">00:06:52.120</a></span> | <span class="t">So these are columns, or you can call them columns if you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=416" target="_blank">00:06:56.280</a></span> | <span class="t">So we have the premise, hypothesis, and label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=419" target="_blank">00:06:59.000</a></span> | <span class="t">Now, in those previous diagrams we saw,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=422" target="_blank">00:07:02.040</a></span> | <span class="t">we saw sentence A, which is the premise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=425" target="_blank">00:07:05.320</a></span> | <span class="t">and sentence B, which is the hypothesis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=428" target="_blank">00:07:08.920</a></span> | <span class="t">And then we saw labels at the end, so it's just the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=434" target="_blank">00:07:14.360</a></span> | <span class="t">Now, if you want to have a quick look at one of those,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=437" target="_blank">00:07:17.480</a></span> | <span class="t">we just have this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=438" target="_blank">00:07:18.280</a></span> | <span class="t">So we just get what you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=442" target="_blank">00:07:22.680</a></span> | <span class="t">So what label do we have here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=445" target="_blank">00:07:25.680</a></span> | <span class="t">We have label 1, so we can appear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=448" target="_blank">00:07:28.120</a></span> | <span class="t">That's neutral, so the premise and the hypothesis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=450" target="_blank">00:07:30.280</a></span> | <span class="t">could both be true, but they are not necessarily related.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=453" target="_blank">00:07:33.720</a></span> | <span class="t">And then here, we see a person's jumping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=455" target="_blank">00:07:35.840</a></span> | <span class="t">over a broken down airplane.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=457" target="_blank">00:07:37.120</a></span> | <span class="t">The person is training his horse for the competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=459" target="_blank">00:07:39.360</a></span> | <span class="t">So they could both be about the same topic,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=462" target="_blank">00:07:42.600</a></span> | <span class="t">but it's not necessarily about the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=464" target="_blank">00:07:44.680</a></span> | <span class="t">They don't infer each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=466" target="_blank">00:07:46.720</a></span> | <span class="t">So if we maybe try and find one that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=470" target="_blank">00:07:50.040</a></span> | <span class="t">is a contradiction or something else, why did I spawn again?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=476" target="_blank">00:07:56.840</a></span> | <span class="t">OK, so this one is a contradiction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=479" target="_blank">00:07:59.240</a></span> | <span class="t">So a person on a horse jumps over a broken down airplane.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=483" target="_blank">00:08:03.680</a></span> | <span class="t">A person's at a diner ordering an omelet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=485" target="_blank">00:08:05.440</a></span> | <span class="t">So those two things aren't about the same topic,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=487" target="_blank">00:08:07.560</a></span> | <span class="t">so they're a contradiction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=489" target="_blank">00:08:09.520</a></span> | <span class="t">And then the other one, we have just, I think, if I do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=494" target="_blank">00:08:14.200</a></span> | <span class="t">we should find one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=496" target="_blank">00:08:16.680</a></span> | <span class="t">We have this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=497" target="_blank">00:08:17.360</a></span> | <span class="t">So a person on a horse jumps over a broken down airplane.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=500" target="_blank">00:08:20.840</a></span> | <span class="t">A person is outdoors on a horse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=503" target="_blank">00:08:23.920</a></span> | <span class="t">So this here would infer--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=508" target="_blank">00:08:28.440</a></span> | <span class="t">sorry, this here, this premise infers this hypothesis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=514" target="_blank">00:08:34.400</a></span> | <span class="t">So that's the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=516" target="_blank">00:08:36.120</a></span> | <span class="t">And like I said, we have two of those data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=518" target="_blank">00:08:38.480</a></span> | <span class="t">We have SMLI and MNLI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=521" target="_blank">00:08:41.960</a></span> | <span class="t">So MNLI, we load it the same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=525" target="_blank">00:08:45.520</a></span> | <span class="t">So data sets, load data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=529" target="_blank">00:08:49.080</a></span> | <span class="t">It's from the glue data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=534" target="_blank">00:08:54.280</a></span> | <span class="t">And then the subset is MNLI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=538" target="_blank">00:08:58.520</a></span> | <span class="t">And again, we want to split to be equal to train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=543" target="_blank">00:09:03.080</a></span> | <span class="t">OK, and if we just have a look, we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=546" target="_blank">00:09:06.120</a></span> | <span class="t">see a very similar format, but not exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=550" target="_blank">00:09:10.760</a></span> | <span class="t">So see, we have premise, hypothesis, label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=553" target="_blank">00:09:13.480</a></span> | <span class="t">Then we also have this index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=555" target="_blank">00:09:15.120</a></span> | <span class="t">We need to merge these two data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=557" target="_blank">00:09:17.280</a></span> | <span class="t">We need to reformat our MNLI data set a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=561" target="_blank">00:09:21.200</a></span> | <span class="t">So first thing we do, we write MNLI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=563" target="_blank">00:09:23.760</a></span> | <span class="t">And we want to remove that column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=565" target="_blank">00:09:25.840</a></span> | <span class="t">So MNLI, remove columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=570" target="_blank">00:09:30.560</a></span> | <span class="t">And we are doing IDX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=574" target="_blank">00:09:34.240</a></span> | <span class="t">OK, and let's make sure it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=576" target="_blank">00:09:36.400</a></span> | <span class="t">And we see now we don't have that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=578" target="_blank">00:09:38.520</a></span> | <span class="t">And if we try to merge these, we still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=580" target="_blank">00:09:40.240</a></span> | <span class="t">get an error, which is annoying, but it's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=583" target="_blank">00:09:43.480</a></span> | <span class="t">So I'm going to call it data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=586" target="_blank">00:09:46.080</a></span> | <span class="t">because data sets adopt to concatenate data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=592" target="_blank">00:09:52.560</a></span> | <span class="t">And we just pass them both as a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=595" target="_blank">00:09:55.440</a></span> | <span class="t">So SMI, MNI, and we're going to get this error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=599" target="_blank">00:09:59.240</a></span> | <span class="t">OK, so the schema, so the format of the data set is different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=604" target="_blank">00:10:04.480</a></span> | <span class="t">Even though they both contain the same columns,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=607" target="_blank">00:10:07.720</a></span> | <span class="t">I think one of them has a slightly different format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=611" target="_blank">00:10:11.120</a></span> | <span class="t">Like one of them allows you to have nulls.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=613" target="_blank">00:10:13.400</a></span> | <span class="t">In fact, it does say here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=615" target="_blank">00:10:15.840</a></span> | <span class="t">So they both have slightly different formats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=620" target="_blank">00:10:20.440</a></span> | <span class="t">So to fix that, we just want to change the schema</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=624" target="_blank">00:10:24.840</a></span> | <span class="t">of one of those data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=627" target="_blank">00:10:27.120</a></span> | <span class="t">And all we do for that is we're going to change the SMI data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=632" target="_blank">00:10:32.120</a></span> | <span class="t">set and say SMI cast features, just cast maybe,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=639" target="_blank">00:10:39.240</a></span> | <span class="t">and MNI.features here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=644" target="_blank">00:10:44.920</a></span> | <span class="t">Yeah, and then we can actually do this now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=651" target="_blank">00:10:51.360</a></span> | <span class="t">OK, so now we have our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=653" target="_blank">00:10:53.400</a></span> | <span class="t">We can look and see, OK, we now have 943, basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=661" target="_blank">00:11:01.280</a></span> | <span class="t">1,000 rows there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=663" target="_blank">00:11:03.280</a></span> | <span class="t">Now, inside this data, we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=666" target="_blank">00:11:06.080</a></span> | <span class="t">have some rows that we don't want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=668" target="_blank">00:11:08.000</a></span> | <span class="t">So we should have the labels 0, 1, and 2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=672" target="_blank">00:11:12.320</a></span> | <span class="t">which we have up at the top here, 0, 1, and 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=675" target="_blank">00:11:15.840</a></span> | <span class="t">But there's actually some rows that have the label minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=679" target="_blank">00:11:19.760</a></span> | <span class="t">And all these are just erroneous rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=682" target="_blank">00:11:22.680</a></span> | <span class="t">We don't actually want those in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=684" target="_blank">00:11:24.280</a></span> | <span class="t">It's where someone couldn't figure out what to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=687" target="_blank">00:11:27.480</a></span> | <span class="t">rate that sentence there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=689" target="_blank">00:11:29.760</a></span> | <span class="t">So what we're going to do is just remove those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=691" target="_blank">00:11:31.720</a></span> | <span class="t">So we write data set equals data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=695" target="_blank">00:11:35.920</a></span> | <span class="t">And we're going to use filter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=699" target="_blank">00:11:39.000</a></span> | <span class="t">And then we just write lambda function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=701" target="_blank">00:11:41.240</a></span> | <span class="t">This lambda function is going to select rows where the label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=707" target="_blank">00:11:47.960</a></span> | <span class="t">value is not minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=709" target="_blank">00:11:49.800</a></span> | <span class="t">So we're going to say false if the label value, so label,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=719" target="_blank">00:11:59.040</a></span> | <span class="t">is equal to minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=720" target="_blank">00:12:00.960</a></span> | <span class="t">So we're going to filter those out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=722" target="_blank">00:12:02.720</a></span> | <span class="t">And then obviously, we want to put else true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=724" target="_blank">00:12:04.960</a></span> | <span class="t">to keep the other columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=728" target="_blank">00:12:08.720</a></span> | <span class="t">So let me just print out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=732" target="_blank">00:12:12.760</a></span> | <span class="t">And we can see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=733" target="_blank">00:12:13.800</a></span> | <span class="t">So we have 942.8 there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=737" target="_blank">00:12:17.560</a></span> | <span class="t">And here, we have 942.0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=740" target="_blank">00:12:20.240</a></span> | <span class="t">So removed, I think it's like 700 or so rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=744" target="_blank">00:12:24.600</a></span> | <span class="t">So if we're using the sentence transformers way of training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=752" target="_blank">00:12:32.080</a></span> | <span class="t">the models, this is pretty much all we have to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=754" target="_blank">00:12:34.520</a></span> | <span class="t">There's one more step that we have to take,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=758" target="_blank">00:12:38.240</a></span> | <span class="t">which is to convert the data into input examples or a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=764" target="_blank">00:12:44.440</a></span> | <span class="t">of input examples, which we'll move on to in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=767" target="_blank">00:12:47.920</a></span> | <span class="t">We won't cover it now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=768" target="_blank">00:12:48.880</a></span> | <span class="t">I'm going to quickly just cover the other training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=772" target="_blank">00:12:52.440</a></span> | <span class="t">approach using PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=775" target="_blank">00:12:55.200</a></span> | <span class="t">But I mean, it's quite complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=778" target="_blank">00:12:58.000</a></span> | <span class="t">And at least when I was training,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=780" target="_blank">00:13:00.280</a></span> | <span class="t">using that approach, the model was nowhere near as good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=783" target="_blank">00:13:03.680</a></span> | <span class="t">as when I trained it using sentence transformers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=787" target="_blank">00:13:07.680</a></span> | <span class="t">So I wouldn't recommend it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=789" target="_blank">00:13:09.480</a></span> | <span class="t">But if you're interested, this is how we do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=793" target="_blank">00:13:13.480</a></span> | <span class="t">So let me switch over to that notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=797" target="_blank">00:13:17.200</a></span> | <span class="t">So if I come over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=799" target="_blank">00:13:19.240</a></span> | <span class="t">And OK, we're going to see it's basically doing the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=806" target="_blank">00:13:26.000</a></span> | <span class="t">We're loading the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=807" target="_blank">00:13:27.240</a></span> | <span class="t">And we come down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=809" target="_blank">00:13:29.320</a></span> | <span class="t">Now, is there a difference?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=811" target="_blank">00:13:31.360</a></span> | <span class="t">So the difference here, so we're importing mainly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=815" target="_blank">00:13:35.320</a></span> | <span class="t">the BERT tokenizer is what we're focusing on here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=818" target="_blank">00:13:38.000</a></span> | <span class="t">We come down, and then here, so we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=822" target="_blank">00:13:42.480</a></span> | <span class="t">filtering, which is what we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=824" target="_blank">00:13:44.320</a></span> | <span class="t">Nothing new there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=825" target="_blank">00:13:45.800</a></span> | <span class="t">But here, we're doing something different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=827" target="_blank">00:13:47.600</a></span> | <span class="t">So here, we're actually tokenizing our text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=833" target="_blank">00:13:53.120</a></span> | <span class="t">So we're using this map function here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=838" target="_blank">00:13:58.520</a></span> | <span class="t">We're tokenizing both the premise sentences and also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=842" target="_blank">00:14:02.040</a></span> | <span class="t">the hypothesis sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=844" target="_blank">00:14:04.080</a></span> | <span class="t">And we get the input IDs and the attention mask out of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=847" target="_blank">00:14:07.880</a></span> | <span class="t">And if we have a look down here, we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=851" target="_blank">00:14:11.840</a></span> | <span class="t">see that this is what we end up with at the end there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=854" target="_blank">00:14:14.640</a></span> | <span class="t">So I've removed all the other features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=857" target="_blank">00:14:17.040</a></span> | <span class="t">And all we have are the labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=859" target="_blank">00:14:19.120</a></span> | <span class="t">And then we also have the input IDs and attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=861" target="_blank">00:14:21.200</a></span> | <span class="t">mask both our premise, or sentence A,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=864" target="_blank">00:14:24.120</a></span> | <span class="t">and also our hypothesis, or sentence B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=868" target="_blank">00:14:28.960</a></span> | <span class="t">And then after that, we need to do this as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=871" target="_blank">00:14:31.200</a></span> | <span class="t">It's dataset.setformat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=873" target="_blank">00:14:33.760</a></span> | <span class="t">And we use, because we're using PyTorch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=875" target="_blank">00:14:35.680</a></span> | <span class="t">we set it into a Torch format, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=880" target="_blank">00:14:40.680</a></span> | <span class="t">From there, typical PyTorch stuff here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=883" target="_blank">00:14:43.680</a></span> | <span class="t">So we're setting up a data loader using batch size 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=887" target="_blank">00:14:47.520</a></span> | <span class="t">That's what we use in the SBERT paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=890" target="_blank">00:14:50.600</a></span> | <span class="t">And then if we come down, this is all just examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=897" target="_blank">00:14:57.440</a></span> | <span class="t">So I'm actually going to go a little further down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=900" target="_blank">00:15:00.680</a></span> | <span class="t">So to here, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=908" target="_blank">00:15:08.120</a></span> | <span class="t">So here, I'm defining the-- you remember before in that graph,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=912" target="_blank">00:15:12.080</a></span> | <span class="t">we had the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=914" target="_blank">00:15:14.800</a></span> | <span class="t">we just passed sentence A, sentence B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=917" target="_blank">00:15:17.160</a></span> | <span class="t">They both went into the BERT, or the Siamese BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=920" target="_blank">00:15:20.720</a></span> | <span class="t">And then there was this pooling method,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=924" target="_blank">00:15:24.120</a></span> | <span class="t">which took our token embeddings, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=926" target="_blank">00:15:26.320</a></span> | <span class="t">are 512, 768 dimensional vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=931" target="_blank">00:15:31.840</a></span> | <span class="t">and compressed them into just a single 768 dimensional vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=938" target="_blank">00:15:38.240</a></span> | <span class="t">That's what this function here does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=940" target="_blank">00:15:40.920</a></span> | <span class="t">When we're using Sentence Transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=942" target="_blank">00:15:42.720</a></span> | <span class="t">we don't need to worry about this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=945" target="_blank">00:15:45.000</a></span> | <span class="t">Sentence Transformers, the library, by the way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=947" target="_blank">00:15:47.400</a></span> | <span class="t">the framework, that's probably a bit confusing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=951" target="_blank">00:15:51.680</a></span> | <span class="t">But I mean, when I say Sentence Transformers, or using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=954" target="_blank">00:15:54.920</a></span> | <span class="t">Sentence Transformers, I mean the framework or library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=958" target="_blank">00:15:58.120</a></span> | <span class="t">which we're going to cover soon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=960" target="_blank">00:16:00.400</a></span> | <span class="t">But obviously, they're also the models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=962" target="_blank">00:16:02.760</a></span> | <span class="t">That's the name of the models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=964" target="_blank">00:16:04.360</a></span> | <span class="t">So here, I'm taking the mean pooling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=969" target="_blank">00:16:09.040</a></span> | <span class="t">It's taking the average of those values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=971" target="_blank">00:16:11.160</a></span> | <span class="t">and excluding values that are padded,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=974" target="_blank">00:16:14.000</a></span> | <span class="t">which is why we're not just taking the average straight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=978" target="_blank">00:16:18.440</a></span> | <span class="t">We are removing those attention mass values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=984" target="_blank">00:16:24.080</a></span> | <span class="t">We go down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=984" target="_blank">00:16:24.720</a></span> | <span class="t">We move our device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=987" target="_blank">00:16:27.040</a></span> | <span class="t">So we check if we have a CUDA-enabled GPU</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=989" target="_blank">00:16:29.880</a></span> | <span class="t">and move our model to it, if we can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=992" target="_blank">00:16:32.680</a></span> | <span class="t">And then here, these are the layers we use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=994" target="_blank">00:16:34.800</a></span> | <span class="t">So I told you before, we had that--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=998" target="_blank">00:16:38.480</a></span> | <span class="t">well, we concatenate our U and V vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1001" target="_blank">00:16:41.200</a></span> | <span class="t">the sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1002" target="_blank">00:16:42.880</a></span> | <span class="t">And then we pass them to a Feedforward Neural Network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1005" target="_blank">00:16:45.760</a></span> | <span class="t">And that Feedforward Neural Network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1007" target="_blank">00:16:47.160</a></span> | <span class="t">is the size of our sentence embeddings multiplied by 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1013" target="_blank">00:16:53.080</a></span> | <span class="t">And it outputs three labels or classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1018" target="_blank">00:16:58.040</a></span> | <span class="t">And then we also use a cross-entropy loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1022" target="_blank">00:17:02.760</a></span> | <span class="t">between what the Feedforward Neural Network outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1026" target="_blank">00:17:06.760</a></span> | <span class="t">and our actual labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1030" target="_blank">00:17:10.160</a></span> | <span class="t">So after that, this is what I mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1034" target="_blank">00:17:14.560</a></span> | <span class="t">There's quite a bit of code when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1036" target="_blank">00:17:16.880</a></span> | <span class="t">go to the very manual PyTorch approach,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1040" target="_blank">00:17:20.280</a></span> | <span class="t">rather than using the Sentence Transformers library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1042" target="_blank">00:17:22.960</a></span> | <span class="t">So here, we're getting this get linear schedule with warmup.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1050" target="_blank">00:17:30.360</a></span> | <span class="t">So that's just saying, for the first 10% of our sets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1054" target="_blank">00:17:34.280</a></span> | <span class="t">we're going to warm up the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1057" target="_blank">00:17:37.000</a></span> | <span class="t">So I'm not going to go full-on training at 1e to the minus 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1062" target="_blank">00:17:42.480</a></span> | <span class="t">So we're going to warm it up a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1065" target="_blank">00:17:45.040</a></span> | <span class="t">Now, in the SPET paper, they used 2e to the minus 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1070" target="_blank">00:17:50.000</a></span> | <span class="t">For me, it just bounced around a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1071" target="_blank">00:17:51.720</a></span> | <span class="t">So I halved it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1074" target="_blank">00:17:54.960</a></span> | <span class="t">But if you can get it working with 2e to the minus 5,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1080" target="_blank">00:18:00.360</a></span> | <span class="t">that's what they use in the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1081" target="_blank">00:18:01.780</a></span> | <span class="t">So it's probably better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1085" target="_blank">00:18:05.400</a></span> | <span class="t">And then they only train for 1e park as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1089" target="_blank">00:18:09.360</a></span> | <span class="t">And then also here, I'm using the add and move weighted k.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1093" target="_blank">00:18:13.800</a></span> | <span class="t">And then this is the training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1095" target="_blank">00:18:15.620</a></span> | <span class="t">So TQDM is just a progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1099" target="_blank">00:18:19.440</a></span> | <span class="t">We do 1e park.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1100" target="_blank">00:18:20.840</a></span> | <span class="t">We make sure our model is on training mode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1104" target="_blank">00:18:24.320</a></span> | <span class="t">We initialize a loop, which is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1106" target="_blank">00:18:26.120</a></span> | <span class="t">to get all the batches from our data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1111" target="_blank">00:18:31.600</a></span> | <span class="t">And then we're just getting all the data out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1113" target="_blank">00:18:33.840</a></span> | <span class="t">This is just PyTorch stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1116" target="_blank">00:18:36.400</a></span> | <span class="t">Getting our U and V, sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1121" target="_blank">00:18:41.640</a></span> | <span class="t">Then here, we're getting the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1123" target="_blank">00:18:43.680</a></span> | <span class="t">actually, sorry, so U and V here are actually token embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1127" target="_blank">00:18:47.600</a></span> | <span class="t">Here, we're converting them into sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1131" target="_blank">00:18:51.360</a></span> | <span class="t">And then we're getting the U, the absolute value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1134" target="_blank">00:18:54.320</a></span> | <span class="t">or the difference vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1137" target="_blank">00:18:57.800</a></span> | <span class="t">Here, concatenate it all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1139" target="_blank">00:18:59.640</a></span> | <span class="t">So we're creating that concatenated vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1144" target="_blank">00:19:04.160</a></span> | <span class="t">that we then feed into the feedforward neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1147" target="_blank">00:19:07.160</a></span> | <span class="t">And then we optimize based on the loss here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1152" target="_blank">00:19:12.520</a></span> | <span class="t">And that's pretty much it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1155" target="_blank">00:19:15.160</a></span> | <span class="t">And then we're saving the model down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1158" target="_blank">00:19:18.600</a></span> | <span class="t">So yeah, that's how we train it in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1167" target="_blank">00:19:27.800</a></span> | <span class="t">You can see here I was messing around,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1170" target="_blank">00:19:30.760</a></span> | <span class="t">seeing if I could see what happened if I did two EPUBs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1174" target="_blank">00:19:34.200</a></span> | <span class="t">It's better to just stick with one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1177" target="_blank">00:19:37.680</a></span> | <span class="t">Even though the loss was lower, in the end,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1181" target="_blank">00:19:41.760</a></span> | <span class="t">the performance wasn't any different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1184" target="_blank">00:19:44.320</a></span> | <span class="t">So I would train for one EPUB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1189" target="_blank">00:19:49.480</a></span> | <span class="t">OK, so let's go back to the code and we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1191" target="_blank">00:19:51.680</a></span> | <span class="t">work through the actual training with sentence transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1194" target="_blank">00:19:54.600</a></span> | <span class="t">which is what I would recommend doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1197" target="_blank">00:19:57.040</a></span> | <span class="t">OK, so I said before we had the list of input examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1202" target="_blank">00:20:02.480</a></span> | <span class="t">So input example is just a data format</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1205" target="_blank">00:20:05.560</a></span> | <span class="t">that sentence transformers library uses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1208" target="_blank">00:20:08.160</a></span> | <span class="t">So we just want to write from sentence transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1212" target="_blank">00:20:12.520</a></span> | <span class="t">I'm going to import input example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1214" target="_blank">00:20:14.720</a></span> | <span class="t">And then all I'm going to do here is write from tqdm or--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1222" target="_blank">00:20:22.000</a></span> | <span class="t">from tqdm.auto, I want to import tqdm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1226" target="_blank">00:20:26.800</a></span> | <span class="t">So this is just for our progress bar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1228" target="_blank">00:20:28.360</a></span> | <span class="t">so we can see what is happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1231" target="_blank">00:20:31.920</a></span> | <span class="t">And then in here, we just want to--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1234" target="_blank">00:20:34.960</a></span> | <span class="t">actually, we want to create our training examples first,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1237" target="_blank">00:20:37.840</a></span> | <span class="t">or training samples, whichever you want to--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1240" target="_blank">00:20:40.720</a></span> | <span class="t">whatever you want to call it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1243" target="_blank">00:20:43.000</a></span> | <span class="t">It's going to be empty list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1244" target="_blank">00:20:44.600</a></span> | <span class="t">And then we literally just for loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1246" target="_blank">00:20:46.280</a></span> | <span class="t">through all of our training data, through our data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1249" target="_blank">00:20:49.160</a></span> | <span class="t">and extracting what we need from it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1251" target="_blank">00:20:51.560</a></span> | <span class="t">which is just sentence A, sentence B, and the label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1255" target="_blank">00:20:55.200</a></span> | <span class="t">So write for row in--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1260" target="_blank">00:21:00.520</a></span> | <span class="t">I'm going to put tqdm training samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1263" target="_blank">00:21:03.200</a></span> | <span class="t">So just adding tqdm in there so we have a progress bar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1266" target="_blank">00:21:06.280</a></span> | <span class="t">so we can see where we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1269" target="_blank">00:21:09.880</a></span> | <span class="t">All we need to do is write train samples, append input example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1277" target="_blank">00:21:17.320</a></span> | <span class="t">And before you get confused, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1279" target="_blank">00:21:19.720</a></span> | <span class="t">should be data set, not train samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1283" target="_blank">00:21:23.600</a></span> | <span class="t">So data set is where we're looping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1287" target="_blank">00:21:27.360</a></span> | <span class="t">through our data set, not the empty list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1292" target="_blank">00:21:32.200</a></span> | <span class="t">And then inside our input example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1295" target="_blank">00:21:35.320</a></span> | <span class="t">we have two variables, text and labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1299" target="_blank">00:21:39.280</a></span> | <span class="t">So you have to pass your text, which is the input text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1303" target="_blank">00:21:43.800</a></span> | <span class="t">that you're going to process into your model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1306" target="_blank">00:21:46.080</a></span> | <span class="t">So we go row, premise, and also row hypothesis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1314" target="_blank">00:21:54.720</a></span> | <span class="t">So they're just our two text features from our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1321" target="_blank">00:22:01.000</a></span> | <span class="t">And then here, we also want a label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1323" target="_blank">00:22:03.200</a></span> | <span class="t">So label is just row label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1327" target="_blank">00:22:07.160</a></span> | <span class="t">It's just the feature names from our data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1329" target="_blank">00:22:09.840</a></span> | <span class="t">which you can still see up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1332" target="_blank">00:22:12.200</a></span> | <span class="t">Now, we process that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1334" target="_blank">00:22:14.640</a></span> | <span class="t">It can take a little bit of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1336" target="_blank">00:22:16.400</a></span> | <span class="t">So I won't take too long, unfortunately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1338" target="_blank">00:22:18.960</a></span> | <span class="t">And then from there, we need to-- you remember before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1342" target="_blank">00:22:22.520</a></span> | <span class="t">or when we very quickly went through,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1344" target="_blank">00:22:24.840</a></span> | <span class="t">we had the PyTorch data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1347" target="_blank">00:22:27.040</a></span> | <span class="t">We also need a data loader here as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1350" target="_blank">00:22:30.160</a></span> | <span class="t">Sometimes you can use special data loaders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1352" target="_blank">00:22:32.600</a></span> | <span class="t">from the Sentence Transformers library, which are quite good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1355" target="_blank">00:22:35.560</a></span> | <span class="t">But for this, we're just using a normal PyTorch data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1358" target="_blank">00:22:38.520</a></span> | <span class="t">So we need to import torch for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1361" target="_blank">00:22:41.760</a></span> | <span class="t">So we can just write from torch utils data, import data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1368" target="_blank">00:22:48.920</a></span> | <span class="t">Same as the paper, we're using batch size of 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1377" target="_blank">00:22:57.880</a></span> | <span class="t">And the data loader or loader is just data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1386" target="_blank">00:23:06.000</a></span> | <span class="t">We pass in those train samples, specify our batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1393" target="_blank">00:23:13.200</a></span> | <span class="t">And if you'd like to shuffle, which in this case we will,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1397" target="_blank">00:23:17.120</a></span> | <span class="t">you also put shuffle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1398" target="_blank">00:23:18.720</a></span> | <span class="t">So shuffle equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1402" target="_blank">00:23:22.280</a></span> | <span class="t">And that should work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1404" target="_blank">00:23:24.760</a></span> | <span class="t">So now we have our data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1406" target="_blank">00:23:26.400</a></span> | <span class="t">And what we do now is initialize our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1411" target="_blank">00:23:31.320</a></span> | <span class="t">using Sentence Transformers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1412" target="_blank">00:23:32.800</a></span> | <span class="t">Now, Sentence Transformers uses modules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1416" target="_blank">00:23:36.400</a></span> | <span class="t">to set up the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1419" target="_blank">00:23:39.520</a></span> | <span class="t">So we're going to have a transformer module, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1422" target="_blank">00:23:42.400</a></span> | <span class="t">I'll just leave out a bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1424" target="_blank">00:23:44.080</a></span> | <span class="t">And then we're also going to have a pooling module, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1428" target="_blank">00:23:48.440</a></span> | <span class="t">is for our mean pooling layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1431" target="_blank">00:23:51.880</a></span> | <span class="t">So from Sentence Transformers, again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1435" target="_blank">00:23:55.160</a></span> | <span class="t">we're going to import models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1438" target="_blank">00:23:58.040</a></span> | <span class="t">And what is this one?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1440" target="_blank">00:24:00.880</a></span> | <span class="t">Sentence Transformer, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1445" target="_blank">00:24:05.280</a></span> | <span class="t">We initialize those two modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1448" target="_blank">00:24:08.600</a></span> | <span class="t">So we have a BERT module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1452" target="_blank">00:24:12.400</a></span> | <span class="t">So models, transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1455" target="_blank">00:24:15.760</a></span> | <span class="t">And then here, it's using the Hugging Face models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1460" target="_blank">00:24:20.400</a></span> | <span class="t">So we can put anything from Hugging Face on here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1463" target="_blank">00:24:23.920</a></span> | <span class="t">I'm going to use BERT base on case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1466" target="_blank">00:24:26.960</a></span> | <span class="t">And then we also want our pooler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1469" target="_blank">00:24:29.320</a></span> | <span class="t">So our pooler models again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1473" target="_blank">00:24:33.320</a></span> | <span class="t">Pooler, pooling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1476" target="_blank">00:24:36.160</a></span> | <span class="t">And then we have BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1477" target="_blank">00:24:37.640</a></span> | <span class="t">And we want to get the word embedding dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1482" target="_blank">00:24:42.440</a></span> | <span class="t">So get word embedding dimension, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1486" target="_blank">00:24:46.600</a></span> | <span class="t">is the 768 of our token embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1490" target="_blank">00:24:50.920</a></span> | <span class="t">And then, of course, of our sentence embedding as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1495" target="_blank">00:24:55.560</a></span> | <span class="t">And then we also want to set the type of pooling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1500" target="_blank">00:25:00.280</a></span> | <span class="t">that we are going to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1501" target="_blank">00:25:01.360</a></span> | <span class="t">So pooling mode, you can see that we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1505" target="_blank">00:25:05.040</a></span> | <span class="t">these different ways of pooling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1508" target="_blank">00:25:08.000</a></span> | <span class="t">So we have CLS token, maximum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1510" target="_blank">00:25:10.440</a></span> | <span class="t">This one, I've never actually seen use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1513" target="_blank">00:25:13.920</a></span> | <span class="t">Square root, the length, it's interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1517" target="_blank">00:25:17.440</a></span> | <span class="t">And then we also have this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1519" target="_blank">00:25:19.000</a></span> | <span class="t">This is the mean pooling, and we're going to use that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1521" target="_blank">00:25:21.560</a></span> | <span class="t">So that is-- there are two modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1534" target="_blank">00:25:34.560</a></span> | <span class="t">And then we just want to initialize our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1536" target="_blank">00:25:36.760</a></span> | <span class="t">So we write sentence transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1540" target="_blank">00:25:40.880</a></span> | <span class="t">And what you can do, by the way, is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1543" target="_blank">00:25:43.600</a></span> | <span class="t">this is how you would actually--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1545" target="_blank">00:25:45.800</a></span> | <span class="t">say you have a sentence transform model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1547" target="_blank">00:25:47.560</a></span> | <span class="t">that you want to load.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1548" target="_blank">00:25:48.560</a></span> | <span class="t">You'd write the sentence transformer name in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1551" target="_blank">00:25:51.640</a></span> | <span class="t">So like all MP net, whatever it's called.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1556" target="_blank">00:25:56.600</a></span> | <span class="t">You'd do that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1558" target="_blank">00:25:58.800</a></span> | <span class="t">But you can also load or initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1561" target="_blank">00:26:01.680</a></span> | <span class="t">the model using the modules that we just initialized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1565" target="_blank">00:26:05.680</a></span> | <span class="t">So write BERT followed by the pooler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1569" target="_blank">00:26:09.120</a></span> | <span class="t">And then keep details of that model in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1574" target="_blank">00:26:14.360</a></span> | <span class="t">OK, so ignore that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1577" target="_blank">00:26:17.120</a></span> | <span class="t">So this bit here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1578" target="_blank">00:26:18.920</a></span> | <span class="t">So this is our sentence transformer structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1585" target="_blank">00:26:25.560</a></span> | <span class="t">You can think of it as a structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1587" target="_blank">00:26:27.680</a></span> | <span class="t">So our transformer, we're using BERT model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1589" target="_blank">00:26:29.920</a></span> | <span class="t">the maximum sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1592" target="_blank">00:26:32.640</a></span> | <span class="t">And then in here, we have a pooler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1594" target="_blank">00:26:34.120</a></span> | <span class="t">And we have the word embedding dimension that we'll expect,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1597" target="_blank">00:26:37.000</a></span> | <span class="t">768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1598" target="_blank">00:26:38.080</a></span> | <span class="t">And then you see here, we have those different pooling modes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1600" target="_blank">00:26:40.580</a></span> | <span class="t">And we are using pooling mode mean tokens, which is true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1605" target="_blank">00:26:45.280</a></span> | <span class="t">The rest of them are false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1607" target="_blank">00:26:47.800</a></span> | <span class="t">And then from there, so we also need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1610" target="_blank">00:26:50.320</a></span> | <span class="t">to initialize our loss function, which is pretty straightforward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1615" target="_blank">00:26:55.720</a></span> | <span class="t">as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1616" target="_blank">00:26:56.600</a></span> | <span class="t">So again, from sentence transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1619" target="_blank">00:26:59.800</a></span> | <span class="t">I want to import losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1622" target="_blank">00:27:02.320</a></span> | <span class="t">And there are plenty of different losses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1625" target="_blank">00:27:05.620</a></span> | <span class="t">that you can use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1626" target="_blank">00:27:06.520</a></span> | <span class="t">You can just look on that documentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1629" target="_blank">00:27:09.200</a></span> | <span class="t">But we're using softmax loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1631" target="_blank">00:27:11.040</a></span> | <span class="t">So what we want to do is write loss equals losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1635" target="_blank">00:27:15.060</a></span> | <span class="t">And we write softmax loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1640" target="_blank">00:27:20.360</a></span> | <span class="t">And then in here, so you think, OK, our loss function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1643" target="_blank">00:27:23.360</a></span> | <span class="t">what does it need?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1644" target="_blank">00:27:24.560</a></span> | <span class="t">So we pass in the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1647" target="_blank">00:27:27.120</a></span> | <span class="t">So it can get the model parameters from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1651" target="_blank">00:27:31.760</a></span> | <span class="t">So firstly, model equals model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1655" target="_blank">00:27:35.720</a></span> | <span class="t">And then it also needs the embedding dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1658" target="_blank">00:27:38.920</a></span> | <span class="t">So it's 768 again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1661" target="_blank">00:27:41.360</a></span> | <span class="t">So it needs on this sentence embedding dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1667" target="_blank">00:27:47.240</a></span> | <span class="t">And there, we just want--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1669" target="_blank">00:27:49.400</a></span> | <span class="t">what do we-- what is it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1673" target="_blank">00:27:53.120</a></span> | <span class="t">So the model get embedding dimension again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1676" target="_blank">00:27:56.600</a></span> | <span class="t">get sentence embedding dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1680" target="_blank">00:28:00.800</a></span> | <span class="t">And then we also need to pass--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1682" target="_blank">00:28:02.800</a></span> | <span class="t">OK, how many labels are we going to have in our model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1686" target="_blank">00:28:06.200</a></span> | <span class="t">We already know it's the number of labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1688" target="_blank">00:28:08.800</a></span> | <span class="t">We already know it's three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1690" target="_blank">00:28:10.960</a></span> | <span class="t">So I'm sure you can get that dynamically from the data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1694" target="_blank">00:28:14.240</a></span> | <span class="t">if you want as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1695" target="_blank">00:28:15.960</a></span> | <span class="t">But I'm just going to put three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1698" target="_blank">00:28:18.320</a></span> | <span class="t">And I think that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1700" target="_blank">00:28:20.720</a></span> | <span class="t">So we have our loss model and our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1705" target="_blank">00:28:25.200</a></span> | <span class="t">So I think we should be OK to start training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1710" target="_blank">00:28:30.600</a></span> | <span class="t">So I'm going to say we go for, OK, one epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1714" target="_blank">00:28:34.640</a></span> | <span class="t">We want to say how many warm-up steps do we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1717" target="_blank">00:28:37.400</a></span> | <span class="t">So again, it's the 10% warming up that we use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1723" target="_blank">00:28:43.120</a></span> | <span class="t">So we just want 0.1 multiplied by the length of our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1730" target="_blank">00:28:50.240</a></span> | <span class="t">So length of the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1734" target="_blank">00:28:54.680</a></span> | <span class="t">Yeah, and I'm just going to--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1736" target="_blank">00:28:56.000</a></span> | <span class="t">we need that to be an integer value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1739" target="_blank">00:28:59.840</a></span> | <span class="t">So I'm just-- it's quite rough, rounding very roughly there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1744" target="_blank">00:29:04.920</a></span> | <span class="t">But that's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1746" target="_blank">00:29:06.960</a></span> | <span class="t">And then we want to just start training our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1751" target="_blank">00:29:11.320</a></span> | <span class="t">So we write model.fit, it's like TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1754" target="_blank">00:29:14.680</a></span> | <span class="t">And we use our train objectives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1757" target="_blank">00:29:17.360</a></span> | <span class="t">So in here, we need to pass a list which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1760" target="_blank">00:29:20.920</a></span> | <span class="t">contains a single tuple, which is our loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1765" target="_blank">00:29:25.920</a></span> | <span class="t">So the data loader and the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1768" target="_blank">00:29:28.560</a></span> | <span class="t">So I think with this, you can, if you have multiple train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1771" target="_blank">00:29:31.920</a></span> | <span class="t">objects, you can put another loader, another loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1775" target="_blank">00:29:35.040</a></span> | <span class="t">and keep going through that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1776" target="_blank">00:29:36.240</a></span> | <span class="t">So that's why we have a tuple within a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1781" target="_blank">00:29:41.760</a></span> | <span class="t">Then you have your epochs, the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1786" target="_blank">00:29:46.120</a></span> | <span class="t">of warm-up steps, which is just warm-up steps again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1791" target="_blank">00:29:51.080</a></span> | <span class="t">So warm-up steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1794" target="_blank">00:29:54.200</a></span> | <span class="t">We also need the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1796" target="_blank">00:29:56.480</a></span> | <span class="t">what do we need?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1797" target="_blank">00:29:57.320</a></span> | <span class="t">Output path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1798" target="_blank">00:29:58.720</a></span> | <span class="t">So where are we going to save the model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1802" target="_blank">00:30:02.360</a></span> | <span class="t">So I'd just put like SBIRT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1806" target="_blank">00:30:06.120</a></span> | <span class="t">Now, what did I call it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1807" target="_blank">00:30:07.120</a></span> | <span class="t">I think testB is what I've called it later on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1812" target="_blank">00:30:12.640</a></span> | <span class="t">And oh, last one is show progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1818" target="_blank">00:30:18.240</a></span> | <span class="t">Now, this is automatically true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1821" target="_blank">00:30:21.800</a></span> | <span class="t">But when I zoom that, it just printed out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1824" target="_blank">00:30:24.440</a></span> | <span class="t">loads of lines that it's printing to a new line</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1827" target="_blank">00:30:27.600</a></span> | <span class="t">every single update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1829" target="_blank">00:30:29.880</a></span> | <span class="t">So I'll just set to false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1832" target="_blank">00:30:32.120</a></span> | <span class="t">So I wouldn't do that because that's obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1834" target="_blank">00:30:34.080</a></span> | <span class="t">quite annoying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1836" target="_blank">00:30:36.000</a></span> | <span class="t">So yeah, that's how you train the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1838" target="_blank">00:30:38.960</a></span> | <span class="t">I'm not going to do it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1840" target="_blank">00:30:40.160</a></span> | <span class="t">I've already done it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1841" target="_blank">00:30:41.120</a></span> | <span class="t">I've already trained this SBIRT testB model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1846" target="_blank">00:30:46.600</a></span> | <span class="t">So what I'm going to do is switch over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1848" target="_blank">00:30:48.600</a></span> | <span class="t">to that notebook where I trained it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1851" target="_blank">00:30:51.040</a></span> | <span class="t">and show you those results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1853" target="_blank">00:30:53.520</a></span> | <span class="t">So this is a notebook, pretty much just covered.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1857" target="_blank">00:30:57.520</a></span> | <span class="t">I'm going through that again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1860" target="_blank">00:31:00.080</a></span> | <span class="t">And then here, so we have the training, the training time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1865" target="_blank">00:31:05.800</a></span> | <span class="t">as well, something I didn't mention just now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1869" target="_blank">00:31:09.280</a></span> | <span class="t">is one hour and 15 minutes for me on an RTX 3090.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1873" target="_blank">00:31:13.680</a></span> | <span class="t">So reasonably fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1876" target="_blank">00:31:16.400</a></span> | <span class="t">It depends on what you're training on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1880" target="_blank">00:31:20.400</a></span> | <span class="t">Yeah, so yeah, it's quick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1882" target="_blank">00:31:22.840</a></span> | <span class="t">So I define these sentences just below random sentences,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1888" target="_blank">00:31:28.760</a></span> | <span class="t">like complete nonsense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1890" target="_blank">00:31:30.600</a></span> | <span class="t">But some of them do align.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1893" target="_blank">00:31:33.040</a></span> | <span class="t">So see this one, one thinks she saw her raw fish and rice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1898" target="_blank">00:31:38.520</a></span> | <span class="t">change position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1901" target="_blank">00:31:41.120</a></span> | <span class="t">And this one, seeing her sushi move, weaving with spaghetti,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1907" target="_blank">00:31:47.240</a></span> | <span class="t">and where is the other, knit with noodles,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1910" target="_blank">00:31:50.080</a></span> | <span class="t">and dental specialist with construction materials,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1914" target="_blank">00:31:54.280</a></span> | <span class="t">and same again, dentist with chewing bricks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1918" target="_blank">00:31:58.600</a></span> | <span class="t">So there's some that are kind of similar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1920" target="_blank">00:32:00.320</a></span> | <span class="t">but they don't share any of the same descriptive words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1924" target="_blank">00:32:04.720</a></span> | <span class="t">But they kind of mean the same thing, roundabouts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1934" target="_blank">00:32:14.280</a></span> | <span class="t">So with our model, so we have loaded the model here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1943" target="_blank">00:32:23.120</a></span> | <span class="t">which we can just do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1944" target="_blank">00:32:24.640</a></span> | <span class="t">So if you've saved the model, which it does automatically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1948" target="_blank">00:32:28.480</a></span> | <span class="t">here, you just take this, you take that, you come down here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1954" target="_blank">00:32:34.440</a></span> | <span class="t">and you write sentence transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1957" target="_blank">00:32:37.800</a></span> | <span class="t">And then in here, you do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1961" target="_blank">00:32:41.040</a></span> | <span class="t">And then you would put that in the model variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1966" target="_blank">00:32:46.160</a></span> | <span class="t">So that's all I've done there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1969" target="_blank">00:32:49.280</a></span> | <span class="t">So remove that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1970" target="_blank">00:32:50.840</a></span> | <span class="t">So loading the model, I'm going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1974" target="_blank">00:32:54.040</a></span> | <span class="t">it to encode those sentences, which is just in the list,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1976" target="_blank">00:32:56.560</a></span> | <span class="t">and create our embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1977" target="_blank">00:32:57.640</a></span> | <span class="t">So the sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1979" target="_blank">00:32:59.720</a></span> | <span class="t">And then from there, I'm getting the cosine similarity,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1983" target="_blank">00:33:03.240</a></span> | <span class="t">again, using sentence transformers for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1985" target="_blank">00:33:05.120</a></span> | <span class="t">This makes it a bit easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1986" target="_blank">00:33:06.920</a></span> | <span class="t">And I'm just comparing all those sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1989" target="_blank">00:33:09.880</a></span> | <span class="t">So I'm just a very qualitative view</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1993" target="_blank">00:33:13.840</a></span> | <span class="t">on how these embeddings are doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=1997" target="_blank">00:33:17.600</a></span> | <span class="t">And you see that we get these results here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2002" target="_blank">00:33:22.120</a></span> | <span class="t">So it's pretty good, actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2008" target="_blank">00:33:28.440</a></span> | <span class="t">It's getting the right ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2009" target="_blank">00:33:29.600</a></span> | <span class="t">So this 7 and 5, 9 and 1, and I think 4 and 3</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2017" target="_blank">00:33:37.240</a></span> | <span class="t">are the ones that we wanted to get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2019" target="_blank">00:33:39.680</a></span> | <span class="t">And they are, in fact, the highest three-rated scores.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2024" target="_blank">00:33:44.040</a></span> | <span class="t">But a lot of these other non-pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2026" target="_blank">00:33:46.560</a></span> | <span class="t">are still rated kind of high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2028" target="_blank">00:33:48.640</a></span> | <span class="t">And like I said before, softmax loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2031" target="_blank">00:33:51.800</a></span> | <span class="t">is not the best way of training your model anymore,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2034" target="_blank">00:33:54.960</a></span> | <span class="t">or fine-tuning your model anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2036" target="_blank">00:33:56.920</a></span> | <span class="t">There's other ways, like MNR loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2040" target="_blank">00:34:00.520</a></span> | <span class="t">So let me show you some of the charts from MNR loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2045" target="_blank">00:34:05.960</a></span> | <span class="t">and you'll see the difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2048" target="_blank">00:34:08.600</a></span> | <span class="t">So we have-- this one is just for BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2051" target="_blank">00:34:11.640</a></span> | <span class="t">You see they're all very flat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2053" target="_blank">00:34:13.160</a></span> | <span class="t">It does actually get--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2054" target="_blank">00:34:14.760</a></span> | <span class="t">almost, it gets two of the correct answers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2057" target="_blank">00:34:17.440</a></span> | <span class="t">within its top three, but not all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2060" target="_blank">00:34:20.400</a></span> | <span class="t">But it's very flat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2061" target="_blank">00:34:21.560</a></span> | <span class="t">Like, all the values are very near the same value, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2064" target="_blank">00:34:24.320</a></span> | <span class="t">makes it hard to differentiate between similar and not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2067" target="_blank">00:34:27.800</a></span> | <span class="t">similar, which is not what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2069" target="_blank">00:34:29.800</a></span> | <span class="t">But obviously, BERT hasn't been trained for this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2071" target="_blank">00:34:31.840</a></span> | <span class="t">so you can't expect it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2074" target="_blank">00:34:34.440</a></span> | <span class="t">And this is my PyTorch model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2077" target="_blank">00:34:37.680</a></span> | <span class="t">It's getting better than the BERT model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2079" target="_blank">00:34:39.720</a></span> | <span class="t">but the performance still isn't there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2081" target="_blank">00:34:41.160</a></span> | <span class="t">compared to the Sentence Transformer's trained model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2086" target="_blank">00:34:46.040</a></span> | <span class="t">which is not here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2088" target="_blank">00:34:48.840</a></span> | <span class="t">This is the actual-- the one that they trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2092" target="_blank">00:34:52.400</a></span> | <span class="t">Sentence Transformer's themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2094" target="_blank">00:34:54.640</a></span> | <span class="t">You can see there's better differentiation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2097" target="_blank">00:34:57.360</a></span> | <span class="t">between general values here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2100" target="_blank">00:35:00.640</a></span> | <span class="t">But then if we compare that to--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2102" target="_blank">00:35:02.360</a></span> | <span class="t">so this is an MNR model that I have trained using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2106" target="_blank">00:35:06.720</a></span> | <span class="t">the same Sentence Transformer's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2108" target="_blank">00:35:08.480</a></span> | <span class="t">We use Sentence Transformer's here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2110" target="_blank">00:35:10.080</a></span> | <span class="t">We come down, we see a big difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2112" target="_blank">00:35:12.200</a></span> | <span class="t">So these are our similar pairs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2114" target="_blank">00:35:14.560</a></span> | <span class="t">And they stick out so much more than they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2118" target="_blank">00:35:18.000</a></span> | <span class="t">did with the other models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2119" target="_blank">00:35:19.040</a></span> | <span class="t">Everything else is rated--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2120" target="_blank">00:35:20.360</a></span> | <span class="t">is scored very lowly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2122" target="_blank">00:35:22.840</a></span> | <span class="t">But these stick out a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2125" target="_blank">00:35:25.760</a></span> | <span class="t">And that's really the difference between models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2131" target="_blank">00:35:31.960</a></span> | <span class="t">This is much better because it separates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2134" target="_blank">00:35:34.520</a></span> | <span class="t">those similar and dissimilar pairs very well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2138" target="_blank">00:35:38.120</a></span> | <span class="t">It's just a lot more accurate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2140" target="_blank">00:35:40.720</a></span> | <span class="t">So that is-- I mean, that's my MNR model as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2146" target="_blank">00:35:46.160</a></span> | <span class="t">The actual Sentence Transformer's MNR model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2148" target="_blank">00:35:48.040</a></span> | <span class="t">is much better than this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2150" target="_blank">00:35:50.400</a></span> | <span class="t">But yeah, I think that's pretty much it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2152" target="_blank">00:35:52.640</a></span> | <span class="t">That's it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2154" target="_blank">00:35:54.680</a></span> | <span class="t">So in the next one, we are going to--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2157" target="_blank">00:35:57.960</a></span> | <span class="t">as you probably have guessed, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2160" target="_blank">00:36:00.560</a></span> | <span class="t">going to have a look at how we can use MNR loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2163" target="_blank">00:36:03.040</a></span> | <span class="t">or multiple negative ranking loss to build a model, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2167" target="_blank">00:36:07.800</a></span> | <span class="t">I think, personally, is a lot more interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2171" target="_blank">00:36:11.400</a></span> | <span class="t">Sentence-- sorry, Softmax loss is pretty interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2175" target="_blank">00:36:15.880</a></span> | <span class="t">But it's not particularly intuitive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2178" target="_blank">00:36:18.880</a></span> | <span class="t">And even the Sentence Transformer's authors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2183" target="_blank">00:36:23.240</a></span> | <span class="t">the expert authors, said the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2185" target="_blank">00:36:25.720</a></span> | <span class="t">That's actually where I got it from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2187" target="_blank">00:36:27.400</a></span> | <span class="t">It isn't very intuitive when you think about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2189" target="_blank">00:36:29.640</a></span> | <span class="t">It's kind of hard to understand why it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2193" target="_blank">00:36:33.680</a></span> | <span class="t">Because we have that weird concatenation at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2195" target="_blank">00:36:35.880</a></span> | <span class="t">It's classifying, and it seems strange.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2198" target="_blank">00:36:38.360</a></span> | <span class="t">MNR loss is much more intuitive, and it makes a lot more sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2201" target="_blank">00:36:41.560</a></span> | <span class="t">And I think it's more interesting,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2203" target="_blank">00:36:43.520</a></span> | <span class="t">and you get way better results with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2205" target="_blank">00:36:45.200</a></span> | <span class="t">So we're going to cover that in the next video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2208" target="_blank">00:36:48.920</a></span> | <span class="t">So I think that should be pretty interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2211" target="_blank">00:36:51.040</a></span> | <span class="t">But for now, that's it on Softmax loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2215" target="_blank">00:36:55.280</a></span> | <span class="t">Thank you very much for watching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2217" target="_blank">00:36:57.120</a></span> | <span class="t">I hope it's been useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aSx0jg9ZILo&t=2218" target="_blank">00:36:58.880</a></span> | <span class="t">And I will see you in the next one.</span></div></div></body></html>