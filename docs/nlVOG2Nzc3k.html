<html><head><title>Lesson 18: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 18: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k"><img src="https://i.ytimg.com/vi/nlVOG2Nzc3k/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=0">0:0</a> Accelerated SGD done in Excel<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=95">1:35</a> Basic SGD<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=656">10:56</a> Momentum<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=937">15:37</a> RMSProp<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=995">16:35</a> Adam<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1211">20:11</a> Adam with annealing tab<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1382">23:2</a> Learning Rate Annealing in PyTorch<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1594">26:34</a> How PyTorch’s Optimizers work?<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1964">32:44</a> How schedulers work?<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2072">34:32</a> Plotting learning rates from a scheduler<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2196">36:36</a> Creating a scheduler callback<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2403">40:3</a> Training with Cosine Annealing<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2538">42:18</a> 1-Cycle learning rate<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2906">48:26</a> HasLearnCB - passing learn as parameter<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3061">51:1</a> Changes from last week, /compare in GitHub<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3160">52:40</a> fastcore’s patch to the Learner with lr_find<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3311">55:11</a> New fit() parameters<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3398">56:38</a> ResNets<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4664">77:44</a> Training the ResNet<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4877">81:17</a> ResNets from timm<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5028">83:48</a> Going wider<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5162">86:2</a> Pooling<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5475">91:15</a> Reducing the number of parameters and megaFLOPS<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5734">95:34</a> Training for longer<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5886">98:6</a> Data Augmentation<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6356">105:56</a> Test Time Augmentation<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6562">109:22</a> Random Erasing<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6955">115:55</a> Random Copying<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7132">118:52</a> Ensembling<br><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7254">120:54</a> Wrap-up and homework<br><br><div style="text-align: left;"><a href="./nlVOG2Nzc3k.html">Whisper Transcript</a> | <a href="./transcript_nlVOG2Nzc3k.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi folks thanks for joining me for lesson 18. We're going to start today in Microsoft Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=8" target="_blank">00:00:08.640</a></span> | <span class="t">You'll see there's an excel folder actually in the course 22 p2 repo and in there there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=17" target="_blank">00:00:17.840</a></span> | <span class="t">spreadsheet called grad desk as in gradient descent which I guess we should zoom in a bit here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=28" target="_blank">00:00:28.800</a></span> | <span class="t">So there's some instructions here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=31" target="_blank">00:00:31.600</a></span> | <span class="t">but this is basically describing what's in each sheet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=37" target="_blank">00:00:37.760</a></span> | <span class="t">We're going to be looking at the various SGD accelerated approaches we saw last time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=45" target="_blank">00:00:45.280</a></span> | <span class="t">but done in a spreadsheet. We're going to do something very very simple which is to try to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=53" target="_blank">00:00:53.680</a></span> | <span class="t">solve a linear regression. So the actual data was generated with y equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=61" target="_blank">00:01:01.120</a></span> | <span class="t">ax plus b where a which is the slope was 2 and b which is the intercept or constant was 30.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=69" target="_blank">00:01:09.600</a></span> | <span class="t">And so you can see we've got some random numbers here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=77" target="_blank">00:01:17.520</a></span> | <span class="t">and then over here we've got the ax plus b calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=83" target="_blank">00:01:23.440</a></span> | <span class="t">So then what I did is I copied and pasted as values just one one set of those random numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=92" target="_blank">00:01:32.960</a></span> | <span class="t">into the next sheet called basic. This is the basic SGD sheet so that that's what x and y are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=98" target="_blank">00:01:38.560</a></span> | <span class="t">And so the idea is we're going to try to use SGD to learn that the intercept</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=107" target="_blank">00:01:47.120</a></span> | <span class="t">is 30 and the slope is 2. So the way we do SGD is we so those are those are our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=119" target="_blank">00:01:59.520</a></span> | <span class="t">those are our weights or parameters. So the way we do SGD is we start out at some random kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=123" target="_blank">00:02:03.360</a></span> | <span class="t">of guess so my random guess is going to be 1 and 1 for the intercept and slope. And so if we look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=128" target="_blank">00:02:08.560</a></span> | <span class="t">at the very first data point which is x is 14 and y is 58 the intercept and slope are both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=136" target="_blank">00:02:16.240</a></span> | <span class="t">1 then we can make a prediction. And so our prediction is just equal to slope times x plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=148" target="_blank">00:02:28.560</a></span> | <span class="t">the intercept so the prediction will be 15. Now actually the answer was 58 so we're a long way off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=156" target="_blank">00:02:36.400</a></span> | <span class="t">so we're going to use mean squared error. So the mean squared error is just the error so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=164" target="_blank">00:02:44.080</a></span> | <span class="t">difference squared. Okay so one way to calculate how much would the prediction sorry how much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=174" target="_blank">00:02:54.720</a></span> | <span class="t">would the error change so how much would the the squared error I should say change if we changed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=181" target="_blank">00:03:01.120</a></span> | <span class="t">the intercept which is b would be just to change b by a little bit change the intercept by a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=189" target="_blank">00:03:09.920</a></span> | <span class="t">bit and see what the error is. So here that's what I've done is I've just added 0.01 to the intercept</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=197" target="_blank">00:03:17.040</a></span> | <span class="t">and then calculated y and then calculated the difference squared. And so this is what I mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=204" target="_blank">00:03:24.320</a></span> | <span class="t">by b1 this is this is the error squared I get if I change b by 0.01 so it's made the error go down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=212" target="_blank">00:03:32.240</a></span> | <span class="t">a little bit. So that suggests that we should probably increase b increase the intercept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=220" target="_blank">00:03:40.000</a></span> | <span class="t">So we can calculate the estimated derivative by simply taking the change from when we use the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=230" target="_blank">00:03:50.800</a></span> | <span class="t">actual intercept using the the intercept plus 0.01 so that's the rise and we divide it by the run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=237" target="_blank">00:03:57.280</a></span> | <span class="t">which is as we said is 0.01 and that gives us the estimated derivative of the squared error with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=244" target="_blank">00:04:04.080</a></span> | <span class="t">respect to b the intercept. Okay so it's about negative 86 85.99 so we can do exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=254" target="_blank">00:04:14.240</a></span> | <span class="t">thing for a so change the slope by 0.01 calculate y calculate the difference and square it and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=263" target="_blank">00:04:23.920</a></span> | <span class="t">can calculate the estimated derivative in the same way rise which is the difference divided by run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=270" target="_blank">00:04:30.960</a></span> | <span class="t">which is 0.01 and that's quite a big number minus 1200. In both cases the estimated derivatives are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=279" target="_blank">00:04:39.600</a></span> | <span class="t">negative so that suggests we should increase the intercept and the slope and we know that that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=285" target="_blank">00:04:45.120</a></span> | <span class="t">true because actually the intercept and the slope are both bigger than one the intercept is 30 should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=290" target="_blank">00:04:50.000</a></span> | <span class="t">be 30 and the slope should be 2. So there's one way to calculate the derivatives another way is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=296" target="_blank">00:04:56.640</a></span> | <span class="t">analytically and the the derivative of squared is two times so here it is here I've just written it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=310" target="_blank">00:05:10.000</a></span> | <span class="t">down for you so here's the analytic derivative it's just two times the difference and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=320" target="_blank">00:05:20.320</a></span> | <span class="t">derivative for the slope is here and you can see that the estimated version using the rise over run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=330" target="_blank">00:05:30.240</a></span> | <span class="t">and the little 0.01 change and the actual they're pretty similar okay and same thing here they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=337" target="_blank">00:05:37.280</a></span> | <span class="t">pretty similar so anytime I calculate gradients kind of analytically but by hand I always like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=345" target="_blank">00:05:45.120</a></span> | <span class="t">to test them against doing the actual rise over run calculation with some small number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=349" target="_blank">00:05:49.760</a></span> | <span class="t">and this is called using the finite differencing approach we only use it for testing because it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=355" target="_blank">00:05:55.600</a></span> | <span class="t">slow because you have to do a separate calculation for every single weight but it's good for testing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=365" target="_blank">00:06:05.200</a></span> | <span class="t">we use analytic derivatives all the time in real life anyway so however we calculate the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=370" target="_blank">00:06:10.960</a></span> | <span class="t">derivatives we can now calculate a new slope so our new slope will be equal to the previous slope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=378" target="_blank">00:06:18.000</a></span> | <span class="t">minus the derivative times the learning rate which we just set here at 0.0001</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=385" target="_blank">00:06:25.440</a></span> | <span class="t">and we can do the same thing for the intercept</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=390" target="_blank">00:06:30.560</a></span> | <span class="t">as you see and so here's our new slope intercept so we can use that for the second row of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=397" target="_blank">00:06:37.760</a></span> | <span class="t">so the second row of data is x equals 86 y equals 202 so our intercept is not 1 1 anymore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=403" target="_blank">00:06:43.120</a></span> | <span class="t">the intercept and slope are not 1 1 but they're 1.01 and 1.12 so here's we're just using a formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=411" target="_blank">00:06:51.920</a></span> | <span class="t">just to point at the old at the new intercept and slope we can get a new prediction and squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=419" target="_blank">00:06:59.920</a></span> | <span class="t">error and derivatives and then we can get another new slope and intercept and so that was a pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=429" target="_blank">00:07:09.760</a></span> | <span class="t">good one actually it really helped our slope head in the right direction although the intercepts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=434" target="_blank">00:07:14.880</a></span> | <span class="t">moving pretty slowly and so we can do that for every row of data now strictly speaking this is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=442" target="_blank">00:07:22.480</a></span> | <span class="t">mini batch gradient descent that we normally do in deep learning it's a simpler version where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=449" target="_blank">00:07:29.200</a></span> | <span class="t">every batch is a size one so I mean it's still stochastic gradient descent it's just not it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=455" target="_blank">00:07:35.360</a></span> | <span class="t">just a batch size of one but I think sometimes it's called online gradient descent if I remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=462" target="_blank">00:07:42.240</a></span> | <span class="t">correctly so we go through every data point in our very small data set until we get to the very end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=468" target="_blank">00:07:48.320</a></span> | <span class="t">and so at the end of the first epoch we've got an intercept of 1.06 and a slope of 2.57</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=476" target="_blank">00:07:56.080</a></span> | <span class="t">and those indeed are better estimates than our starting estimates of 1 1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=479" target="_blank">00:07:59.760</a></span> | <span class="t">so what I would do is I would copy our slope 2.57 up to here 2.57 I'll just type it for now and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=491" target="_blank">00:08:11.040</a></span> | <span class="t">I'll copy our intercept up to here and then it goes through the entire epoch again then we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=502" target="_blank">00:08:22.320</a></span> | <span class="t">another interception slope and so we could keep copying and pasting and copying and pasting again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=508" target="_blank">00:08:28.080</a></span> | <span class="t">and again and we can watch the root mean squared error going down now that's pretty boring doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=514" target="_blank">00:08:34.560</a></span> | <span class="t">that copying and pasting so what we could do is fire up visual basic for applications</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=529" target="_blank">00:08:49.520</a></span> | <span class="t">and sorry this might be a bit small I'm not sure how to increase the font size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=533" target="_blank">00:08:53.520</a></span> | <span class="t">and what it shows here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=541" target="_blank">00:09:01.040</a></span> | <span class="t">so sorry this is a bit small so you might want to just open it on your own computer be able to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=544" target="_blank">00:09:04.880</a></span> | <span class="t">it clearly but basically it shows I've created a little macro where if you click on the reset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=551" target="_blank">00:09:11.120</a></span> | <span class="t">button it's just going to set the slope and constant to one and calculate and if you click</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=560" target="_blank">00:09:20.080</a></span> | <span class="t">the run button it's going to go through five times calling one step and what one step's going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=568" target="_blank">00:09:28.000</a></span> | <span class="t">is it's going to copy the slope last slope to the new slope and the last constant intercept</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=574" target="_blank">00:09:34.800</a></span> | <span class="t">to the new constant intercept and also do the same for the RMSE and it's actually going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=582" target="_blank">00:09:42.160</a></span> | <span class="t">paste it down to the bottom for reasons I'll show you in a moment so if I now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=585" target="_blank">00:09:45.520</a></span> | <span class="t">run this I'll reset and then run there we go you can see it's run it five times and each time it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=596" target="_blank">00:09:56.960</a></span> | <span class="t">pasted the RMSE and here's a chart of it showing it going down and so you can see the new slope is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=603" target="_blank">00:10:03.520</a></span> | <span class="t">2.57 new intercept is 1.27 I could keep running it another five so this is just doing copy paste</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=609" target="_blank">00:10:09.440</a></span> | <span class="t">copy paste copy paste five times and you can see that the RMSE is very very very slowly going down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=617" target="_blank">00:10:17.600</a></span> | <span class="t">and the intercept and slope are very very very slowly getting closer to where they want to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=624" target="_blank">00:10:24.080</a></span> | <span class="t">the big issue really is that the intercept is meant to be 30 it looks like it's going to take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=628" target="_blank">00:10:28.240</a></span> | <span class="t">a very very long time to get there but it will get there eventually if you click run enough times or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=633" target="_blank">00:10:33.440</a></span> | <span class="t">maybe set the VBA macro to more than five steps at a time but you can see it's it's very slowly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=641" target="_blank">00:10:41.360</a></span> | <span class="t">and and importantly though you can see like it's kind of taking this linear route every time these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=647" target="_blank">00:10:47.920</a></span> | <span class="t">are increasing so why not increase it by more and more and more and so you'll remember from last week</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=654" target="_blank">00:10:54.960</a></span> | <span class="t">that that is what momentum does so on the next sheet we show momentum and so everything's exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=663" target="_blank">00:11:03.040</a></span> | <span class="t">the same as the previous sheet but this sheet we didn't bother with the finite differencing we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=668" target="_blank">00:11:08.000</a></span> | <span class="t">have the analytic derivatives which are exactly the same as last time the data is the same as last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=672" target="_blank">00:11:12.720</a></span> | <span class="t">time the slope and intercept are the same starting points as last time and this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=680" target="_blank">00:11:20.480</a></span> | <span class="t">new b and new a that we get but what we do this time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=688" target="_blank">00:11:28.400</a></span> | <span class="t">is that we've added a momentum term which we're calling beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=699" target="_blank">00:11:39.360</a></span> | <span class="t">and so the beta is going to these cells here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=704" target="_blank">00:11:44.320</a></span> | <span class="t">and what are these cells what what these cells are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=711" target="_blank">00:11:51.200</a></span> | <span class="t">is that they're maybe it's most interesting to take this one here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=715" target="_blank">00:11:55.440</a></span> | <span class="t">what it's doing is it's taking the gradient and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=728" target="_blank">00:12:08.240</a></span> | <span class="t">it's taking the gradient and it's using that to update the weights but it's also taking the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=737" target="_blank">00:12:17.680</a></span> | <span class="t">previous update so you can see here the blue one minus 25 so that is going to get multiplied by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=745" target="_blank">00:12:25.600</a></span> | <span class="t">0.9 the momentum and then the derivative is then multiplied by 0.1 so this is momentum which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=756" target="_blank">00:12:36.320</a></span> | <span class="t">getting a little bit of each and so then what we do is we then use that instead of the derivative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=766" target="_blank">00:12:46.560</a></span> | <span class="t">to multiply by our learning rate so we keep doing that again and again and again as per usual and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=777" target="_blank">00:12:57.440</a></span> | <span class="t">so we've got one column which is calculating the next which is calculating the momentum you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=782" target="_blank">00:13:02.640</a></span> | <span class="t">lerped version of the gradient for both b and for a and so you can see that for this one it's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=789" target="_blank">00:13:09.040</a></span> | <span class="t">same thing you look at what was the previous move and that's going to be 0.9 of what you're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=797" target="_blank">00:13:17.360</a></span> | <span class="t">to use for your momentum version gradient and 0.1 is for this version the momentum gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=803" target="_blank">00:13:23.840</a></span> | <span class="t">and so then that's again what we're going to use to multiply by the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=810" target="_blank">00:13:30.800</a></span> | <span class="t">and so you can see what happens is when you keep moving in the same direction which here is we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=816" target="_blank">00:13:36.720</a></span> | <span class="t">saying the derivative is negative again and again and again so it gets higher and higher and higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=822" target="_blank">00:13:42.240</a></span> | <span class="t">and get over here and so particularly with this big jump we get we keep getting big jumps because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=830" target="_blank">00:13:50.560</a></span> | <span class="t">still we want to then there's still negative gradient negative gradient negative gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=834" target="_blank">00:13:54.720</a></span> | <span class="t">so if we at so at the end of this our new our b and our a have jumped ahead and so we can click run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=845" target="_blank">00:14:05.040</a></span> | <span class="t">and we can click clicking it and you can see that it's moving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=851" target="_blank">00:14:11.120</a></span> | <span class="t">you know not super fast but certainly faster than it was before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=859" target="_blank">00:14:19.200</a></span> | <span class="t">so if you haven't used vba visual basic for applications before you can hit alt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=864" target="_blank">00:14:24.480</a></span> | <span class="t">alt f11 or option f11 to to open it and you may need to go into your preferences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=873" target="_blank">00:14:33.440</a></span> | <span class="t">and turn on the developer tools so that you can see it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=877" target="_blank">00:14:37.760</a></span> | <span class="t">you can also right click and choose assign macro on a button and you can see what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=886" target="_blank">00:14:46.400</a></span> | <span class="t">macro has been assigned so if i hit alt f11 and i can just double or you can just double</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=893" target="_blank">00:14:53.520</a></span> | <span class="t">click on the sheet name and it'll open it up and you can see that this is exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=899" target="_blank">00:14:59.760</a></span> | <span class="t">as the previous one there's no difference here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=903" target="_blank">00:15:03.680</a></span> | <span class="t">oh one difference is that to keep track of momentum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=909" target="_blank">00:15:09.280</a></span> | <span class="t">at the very very end so i've got my momentum values going all the way down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=915" target="_blank">00:15:15.360</a></span> | <span class="t">the very last momentum i copy back up to the top h epoch so that we don't lose track of our kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=922" target="_blank">00:15:22.800</a></span> | <span class="t">of optimizer state if you like okay so that's what momentum looks like so yeah if you're kind of a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=928" target="_blank">00:15:28.800</a></span> | <span class="t">more of a visual person like me you like to see everything laid out in front of you and like to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=932" target="_blank">00:15:32.720</a></span> | <span class="t">be able to experiment which i think is a good idea this can be really helpful so rms prop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=944" target="_blank">00:15:44.080</a></span> | <span class="t">we've seen and it's very similar to momentum but in this case instead of keeping track of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=949" target="_blank">00:15:49.680</a></span> | <span class="t">kind of a lerped moving average an exponential moving average of gradients we're keeping track</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=954" target="_blank">00:15:54.400</a></span> | <span class="t">of a moving average of gradient squared and then rather than simply adding that you know using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=964" target="_blank">00:16:04.560</a></span> | <span class="t">that as the gradient what instead we're doing is we are dividing our gradient by the square root of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=973" target="_blank">00:16:13.680</a></span> | <span class="t">that and so remember the reason we were doing that is to say if you know if if the there's very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=983" target="_blank">00:16:23.040</a></span> | <span class="t">little variation very little going on in your gradients then you probably want to jump further</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=989" target="_blank">00:16:29.120</a></span> | <span class="t">so that's rms prop and then finally atom remember was a combination of both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1001" target="_blank">00:16:41.440</a></span> | <span class="t">so in atom we've got both the lerped version of the gradient and we've got the lerped version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1009" target="_blank">00:16:49.360</a></span> | <span class="t">of the gradient squared and then we do both when we update we're both dividing the gradient by the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1020" target="_blank">00:17:00.960</a></span> | <span class="t">square root of the lerped the moving exponentially weighting average moving averages and we're also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1027" target="_blank">00:17:07.920</a></span> | <span class="t">using the momentumized version and so again we just go through that each time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1035" target="_blank">00:17:15.120</a></span> | <span class="t">and so if i reset run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1040" target="_blank">00:17:20.960</a></span> | <span class="t">and so oh wow look at that it jumped up there very quickly because remember we wanted to get to 2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1049" target="_blank">00:17:29.680</a></span> | <span class="t">and 30 so just two sets so that's five that's 10 epochs now if i keep running it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1059" target="_blank">00:17:39.280</a></span> | <span class="t">it's kind of now not getting closer it's kind of jumping up and down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1065" target="_blank">00:17:45.200</a></span> | <span class="t">between pretty much the same values so probably what we'd need to do is decrease the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1069" target="_blank">00:17:49.600</a></span> | <span class="t">rate at that point and yeah that's pretty good and now it's jumping up and down between the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1078" target="_blank">00:17:58.480</a></span> | <span class="t">two values again so maybe decrease the learning rate a little bit more and i kind of like playing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1082" target="_blank">00:18:02.960</a></span> | <span class="t">around like this because it gives me a really intuitive feeling for what training looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1088" target="_blank">00:18:08.320</a></span> | <span class="t">so i've got a question from our youtube chat which is how is j 33 being initialized so it's it's this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1097" target="_blank">00:18:17.520</a></span> | <span class="t">is just what happens is we take the very last cell here well these actually all these last four cells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1104" target="_blank">00:18:24.320</a></span> | <span class="t">and we copy them to here as values so this is what those looked like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1109" target="_blank">00:18:29.680</a></span> | <span class="t">in the last epoch so if i basically we're going we go copy and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1118" target="_blank">00:18:38.080</a></span> | <span class="t">paste as values and then they this here just refers back to them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1129" target="_blank">00:18:49.120</a></span> | <span class="t">as you see and it's interesting that they're kind of you can see how they're exact opposites of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1135" target="_blank">00:18:55.840</a></span> | <span class="t">each other which is really you can really see how they're it's it's just fluctuating around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1141" target="_blank">00:19:01.520</a></span> | <span class="t">the actual optimum at this point um okay thank you to sam whatkins we've now got a nicer sized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1150" target="_blank">00:19:10.960</a></span> | <span class="t">editor that's great um where are we adam</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1158" target="_blank">00:19:18.080</a></span> | <span class="t">okay so with um so with adam basically it all looks pretty much the same except now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1167" target="_blank">00:19:27.760</a></span> | <span class="t">we have to copy and paste our both our momentums and our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1174" target="_blank">00:19:34.800</a></span> | <span class="t">um squared gradients and of course the slopes and intercepts at the end of each step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1182" target="_blank">00:19:42.080</a></span> | <span class="t">but other than that it's just doing the same thing and when we reset it it just sets everything back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1186" target="_blank">00:19:46.720</a></span> | <span class="t">to their default values now one thing that occurred to me you know when i first wrote this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1193" target="_blank">00:19:53.200</a></span> | <span class="t">spreadsheet a few years ago was that manually changing the learning rate seems pretty annoying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1201" target="_blank">00:20:01.360</a></span> | <span class="t">now of course we can use a scheduler but a scheduler is something we set up ahead of time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1206" target="_blank">00:20:06.640</a></span> | <span class="t">and i did wonder if it's possible to create an automatic scheduler and so i created this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1212" target="_blank">00:20:12.000</a></span> | <span class="t">adam annealing tab which honestly i've never really got back to experimenting with so if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1216" target="_blank">00:20:16.880</a></span> | <span class="t">anybody's interested they should check this out um what i did here was i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1222" target="_blank">00:20:22.800</a></span> | <span class="t">used exactly the same spreadsheet as the adam spreadsheet but i added an extra after i do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1232" target="_blank">00:20:32.560</a></span> | <span class="t">step i added an extra thing which is i automatically decreased the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1238" target="_blank">00:20:38.240</a></span> | <span class="t">in a certain situation and the situation in which i in which i decreased it was i kept track of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1245" target="_blank">00:20:45.120</a></span> | <span class="t">average of the um squared gradients and anytime the average of the squared gradients decreased</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1252" target="_blank">00:20:52.960</a></span> | <span class="t">during an epoch i stored it so i basically kept track of the the lowest squared gradients we had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1262" target="_blank">00:21:02.560</a></span> | <span class="t">and then what i did was if we got a if that resulted in the gradients the squared gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1277" target="_blank">00:21:17.520</a></span> | <span class="t">average halving then i would decrease the learning rate by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1288" target="_blank">00:21:28.640</a></span> | <span class="t">then i would decrease the learning rate by a factor of four so i was keeping track of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1293" target="_blank">00:21:33.280</a></span> | <span class="t">gradient ratio now when you see a range like this you can find what that's referring to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1298" target="_blank">00:21:38.400</a></span> | <span class="t">by just clicking up here and finding gradient ratio and there it is and you can see that it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1306" target="_blank">00:21:46.640</a></span> | <span class="t">equal to the ratio between the average of the squared gradients versus the minimum that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1312" target="_blank">00:21:52.640</a></span> | <span class="t">seen so far um so this is kind of like my theory here was thinking that yeah basically as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1322" target="_blank">00:22:02.000</a></span> | <span class="t">train you kind of get into flatter more stable areas and as you do that that's a sign</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1331" target="_blank">00:22:11.200</a></span> | <span class="t">that you know you might want to decrease your learning rate so uh yeah if i try that if i hit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1339" target="_blank">00:22:19.040</a></span> | <span class="t">run again it jumps straight to a pretty good value but i'm not going to change the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1344" target="_blank">00:22:24.000</a></span> | <span class="t">manually i just press run and because it's changed the learning rate automatically now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1347" target="_blank">00:22:27.600</a></span> | <span class="t">and if i keep hitting run without doing anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1351" target="_blank">00:22:31.520</a></span> | <span class="t">look at that it's got pretty good hasn't it and the learning rates got lower and lower</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1358" target="_blank">00:22:38.080</a></span> | <span class="t">and we basically got almost exactly the right answer so yeah that's a little experiment i tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1364" target="_blank">00:22:44.800</a></span> | <span class="t">so maybe some of you should try experiments around whether you can create a an automatic annealer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1373" target="_blank">00:22:53.360</a></span> | <span class="t">using the um using mini ai i think that would be fun</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1378" target="_blank">00:22:58.560</a></span> | <span class="t">so that is an excellent segue into our notebook because we are going to talk about annealing now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1390" target="_blank">00:23:10.240</a></span> | <span class="t">so we've seen it manually before um where we've just where we've just decreased the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1397" target="_blank">00:23:17.760</a></span> | <span class="t">in a notebook and like ran a second cell um and we've seen something in excel um but let's look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1405" target="_blank">00:23:25.360</a></span> | <span class="t">at what we generally do in pytorch so we're still in the same notebook as last time the accelerated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1412" target="_blank">00:23:32.960</a></span> | <span class="t">SGD notebook um and now that we've reimplemented all the main optimizers that t equal tend to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1421" target="_blank">00:23:41.680</a></span> | <span class="t">most of the time from scratch we can use pytorches of course um so let's see look look now at how we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1432" target="_blank">00:23:52.080</a></span> | <span class="t">can do our own learning rate scheduling or annealing within the mini ai framework</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1440" target="_blank">00:24:00.960</a></span> | <span class="t">now we've seen when we implemented the learning rate finder um that that we saw how to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1449" target="_blank">00:24:09.280</a></span> | <span class="t">create something that adjusts the learning rate so just to remind you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1454" target="_blank">00:24:14.560</a></span> | <span class="t">this was all we had to do so we had to go through the optimizers parameter groups and in each group</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1464" target="_blank">00:24:24.480</a></span> | <span class="t">set the learning rate to times equals some model player if we're just that was for the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1469" target="_blank">00:24:29.040</a></span> | <span class="t">rate finder um so since we know how to do that we're not going to bother reimplementing all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1477" target="_blank">00:24:37.120</a></span> | <span class="t">schedulers from scratch um because we know the basic idea now so instead what we're going to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1482" target="_blank">00:24:42.320</a></span> | <span class="t">do is have a look inside the torch dot optim dot lr scheduler module and see what's defined in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1489" target="_blank">00:24:49.440</a></span> | <span class="t">so the lr scheduler module you know you can hit dot tab and see what's in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1498" target="_blank">00:24:58.240</a></span> | <span class="t">but something that i quite like to do is to use dir because dir lr scheduler is a nice little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1506" target="_blank">00:25:06.640</a></span> | <span class="t">function that tells you everything inside a python object and this particular object is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1514" target="_blank">00:25:14.640</a></span> | <span class="t">a module object and it tells you all the stuff in the module um when you use the dot version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1521" target="_blank">00:25:21.120</a></span> | <span class="t">tab it doesn't show you stuff that starts with an underscore by the way because that stuff's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1526" target="_blank">00:25:26.800</a></span> | <span class="t">considered private or else dir does show you that stuff now i can kind of see from here that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1531" target="_blank">00:25:31.760</a></span> | <span class="t">things that start with a capital and then a small letter look like the things we care about we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1539" target="_blank">00:25:39.120</a></span> | <span class="t">probably don't care about this we probably don't care about these um so we can just do a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1544" target="_blank">00:25:44.080</a></span> | <span class="t">list comprehension that checks that the first letter is an uppercase and the second letter is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1548" target="_blank">00:25:48.240</a></span> | <span class="t">lowercase and then join those all together with a space and so here is a nice way to get a list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1554" target="_blank">00:25:54.160</a></span> | <span class="t">all of the schedulers that pytorch has available and actually um i didn't couldn't find such a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1560" target="_blank">00:26:00.640</a></span> | <span class="t">on the pytorch website in the documentation um so this is actually a handy thing to have available</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1566" target="_blank">00:26:06.240</a></span> | <span class="t">so here's various schedulers we can use and so i thought we might experiment with using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1578" target="_blank">00:26:18.240</a></span> | <span class="t">cosine annealing um so before we do we have to recognize that these um pytorch schedulers work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1589" target="_blank">00:26:29.600</a></span> | <span class="t">with pytorch optimizers not with of course with our custom sgd class and pytorch optimizers have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1595" target="_blank">00:26:35.600</a></span> | <span class="t">a slightly different api and so we might learn how they work so to learn how they work we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1600" target="_blank">00:26:40.880</a></span> | <span class="t">an optimizer um so some one easy way to just grab an optimizer would be to create a learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1607" target="_blank">00:26:47.840</a></span> | <span class="t">just kind of pretty much any old random learner and pass in that single batch callback that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1613" target="_blank">00:26:53.760</a></span> | <span class="t">created do you remember that single batch callback single batch it just after batch it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1621" target="_blank">00:27:01.600</a></span> | <span class="t">cancels the fit so it literally just does one batch um and we could fit and from that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1629" target="_blank">00:27:09.920</a></span> | <span class="t">now got a learner and an optimizer and so we can do the same thing we can do our optimizer to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1637" target="_blank">00:27:17.040</a></span> | <span class="t">what attributes it has this is a nice way or of course just read the documentation in pytorch this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1641" target="_blank">00:27:21.280</a></span> | <span class="t">one is documented um i think showing all the things it can do um as you would expect it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1646" target="_blank">00:27:26.480</a></span> | <span class="t">got the step and the zero grad like we're familiar with um or you can just if you just hit um opt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1654" target="_blank">00:27:34.720</a></span> | <span class="t">um so you can uh the optimizers in pytorch do actually have a a repra as it's called which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1662" target="_blank">00:27:42.480</a></span> | <span class="t">means you can just type it in and hit shift enter and you can also see the information about it this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1666" target="_blank">00:27:46.720</a></span> | <span class="t">way now an optimizer it'll tell you what kind of optimizer it is and so in this case the default</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1673" target="_blank">00:27:53.280</a></span> | <span class="t">optimizer um for a learner when we created it we decided was uh optim.sgd.sgd so we've got an sgd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1682" target="_blank">00:28:02.960</a></span> | <span class="t">optimizer and it's got these things called parameter groups um what are parameter groups well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1689" target="_blank">00:28:09.280</a></span> | <span class="t">parameter groups are as it suggests they're groups of parameters and in fact we only have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1695" target="_blank">00:28:15.440</a></span> | <span class="t">one parameter group here which means all of our parameters are in this group um so let me kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1702" target="_blank">00:28:22.720</a></span> | <span class="t">try and show you it's a little bit confusing but it's kind of quite neat so let's grab all of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1708" target="_blank">00:28:28.320</a></span> | <span class="t">parameters um and that's actually a generator so we have to turn that into an iterator and call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1714" target="_blank">00:28:34.960</a></span> | <span class="t">next and that will just give us our first parameter okay now what we can do is we can then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1722" target="_blank">00:28:42.880</a></span> | <span class="t">check the state of the optimizer and the state is a dictionary and the keys are parameter tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1733" target="_blank">00:28:53.200</a></span> | <span class="t">so this is kind of pretty interesting because you might be i'm sure you're familiar with dictionaries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1737" target="_blank">00:28:57.120</a></span> | <span class="t">i hope you're familiar with dictionaries but normally you probably use um numbers or strings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1743" target="_blank">00:29:03.120</a></span> | <span class="t">as keys but actually you can use tensors as keys and indeed that's what happens here if we look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1748" target="_blank">00:29:08.640</a></span> | <span class="t">param it's a tensor it's actually a parameter which remember is a tensor which it knows to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1756" target="_blank">00:29:16.960</a></span> | <span class="t">to require grad and to to list in the parameters of the module and so we're actually using that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1765" target="_blank">00:29:25.680</a></span> | <span class="t">to index into the state so if you look at up.state it's a dictionary where the keys are parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1775" target="_blank">00:29:35.520</a></span> | <span class="t">now what's this for well what we want to be able to do is if you think back to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1780" target="_blank">00:29:40.880</a></span> | <span class="t">this we actually had each parameter we have state for it we have the average of the gradients or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1789" target="_blank">00:29:49.840</a></span> | <span class="t">exponentially way to moving average gradients and of squared averages and we actually stored them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1794" target="_blank">00:29:54.240</a></span> | <span class="t">as attributes um so pytorch does it a bit differently it doesn't store them as attributes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1800" target="_blank">00:30:00.400</a></span> | <span class="t">but instead it it the the optimizer has a dictionary where you can look at where you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1806" target="_blank">00:30:06.480</a></span> | <span class="t">index into it using a parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1809" target="_blank">00:30:09.920</a></span> | <span class="t">and that gives you the state and so you can see here it's got a this is the this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1820" target="_blank">00:30:20.960</a></span> | <span class="t">exponentially weighted moving averages and both because we haven't done any training yet and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1826" target="_blank">00:30:26.000</a></span> | <span class="t">because we're using non-momentum std it's none but that's that's how it would be stored so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1832" target="_blank">00:30:32.160</a></span> | <span class="t">is really important to understand pytorch optimizers i quite liked our way of doing it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1838" target="_blank">00:30:38.080</a></span> | <span class="t">of just storing the state directly as attributes but this works as well and it's it's it's fine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1845" target="_blank">00:30:45.840</a></span> | <span class="t">you just have to know it's there and then as i said rather than just having parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1853" target="_blank">00:30:53.760</a></span> | <span class="t">so we in sgd stored the parameters directly but in pytorch those parameters can be put into groups</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1866" target="_blank">00:31:06.560</a></span> | <span class="t">and so since we haven't put them into groups the length of param groups is one there's just one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1872" target="_blank">00:31:12.720</a></span> | <span class="t">group so here is the param groups and that group contains all of our parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1883" target="_blank">00:31:23.200</a></span> | <span class="t">okay so pg just to clarify here what's going on pg is a dictionary it's a parameter group</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1894" target="_blank">00:31:34.320</a></span> | <span class="t">and to get the keys from a dictionary you can just listify it that gives you back the keys</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1901" target="_blank">00:31:41.760</a></span> | <span class="t">and so this is one quick way of finding out all the keys in a dictionary so that you can see all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1906" target="_blank">00:31:46.880</a></span> | <span class="t">the parameters in the group and you can see all of the hyper parameters the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1912" target="_blank">00:31:52.880</a></span> | <span class="t">the momentum weight decay and so forth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1915" target="_blank">00:31:55.760</a></span> | <span class="t">so that gives you some background about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1922" target="_blank">00:32:02.400</a></span> | <span class="t">about what's what's going on inside an optimizer so seva asks isn't indexing by a tensor just like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1933" target="_blank">00:32:13.840</a></span> | <span class="t">passing a tensor argument to a method and no it's not quite the same because this is this is state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1940" target="_blank">00:32:20.640</a></span> | <span class="t">so this is how the optimizer stores state about the parameters it has to be stored somewhere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1948" target="_blank">00:32:28.800</a></span> | <span class="t">for our homemade mini ii version we stored it as attributes on the parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1953" target="_blank">00:32:33.920</a></span> | <span class="t">but in the pytorch optimizers they store it as a dictionary so it's just how it's stored</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1962" target="_blank">00:32:42.640</a></span> | <span class="t">okay so with that in mind let's look at how schedulers work so let's create a cosine annealing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1969" target="_blank">00:32:49.600</a></span> | <span class="t">scheduler so a scheduler in pytorch you have to pass it the optimizer and the reason for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1976" target="_blank">00:32:56.240</a></span> | <span class="t">is we want to be able to tell it to change the learning rates of our optimizer so it needs to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1981" target="_blank">00:33:01.360</a></span> | <span class="t">know what optimizer to change the learning rates of so it can then do that for each set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1986" target="_blank">00:33:06.560</a></span> | <span class="t">parameters and the reason that it does it by parameter group is that as we'll learn in a later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1991" target="_blank">00:33:11.360</a></span> | <span class="t">lesson for things like transfer learning we often want to adjust the learning rates of the later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=1998" target="_blank">00:33:18.080</a></span> | <span class="t">layers differently to the earlier layers and actually have different learning rates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2002" target="_blank">00:33:22.080</a></span> | <span class="t">and so that's why we can have different groups and the different groups have the different learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2008" target="_blank">00:33:28.320</a></span> | <span class="t">rates mementums and so forth okay so we pass in the optimizer and then if i hit shift tab a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2016" target="_blank">00:33:36.480</a></span> | <span class="t">couple of times it'll tell me all of the things that you can pass in and so it needs to know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2021" target="_blank">00:33:41.680</a></span> | <span class="t">t max how many iterations you're going to do and that's because it's trying to do one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2028" target="_blank">00:33:48.000</a></span> | <span class="t">you know half a wave if you like of the cosine curve so it needs to know how many iterations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2036" target="_blank">00:33:56.080</a></span> | <span class="t">you're going to do so it needs to know how far to step each time so if we're going to do 100</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2039" target="_blank">00:33:59.680</a></span> | <span class="t">iterations so the scheduler is going to store the base learning rate and where did it get that from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2046" target="_blank">00:34:06.720</a></span> | <span class="t">it got it from our optimizer which we set a learning rate okay so it's going to steal the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2054" target="_blank">00:34:14.880</a></span> | <span class="t">optimizer's learning rate and that's going to be the starting learning rate the base learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2060" target="_blank">00:34:20.640</a></span> | <span class="t">and it's a list because there could be a different one for each parameter group we only have one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2064" target="_blank">00:34:24.160</a></span> | <span class="t">parameter group you can also get the most recent learning rate from a scheduler which of course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2070" target="_blank">00:34:30.720</a></span> | <span class="t">is the same and so i couldn't find any method in pytorch to actually plot a scheduler's learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2079" target="_blank">00:34:39.040</a></span> | <span class="t">rates so i just made a tiny little thing that just created a list set it to the last learning rate of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2086" target="_blank">00:34:46.240</a></span> | <span class="t">the scheduler which is going to start at 0.06 and then goes through however many steps you ask for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2091" target="_blank">00:34:51.680</a></span> | <span class="t">steps the optimizer steps the scheduler so this is the thing that causes the scheduler to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2098" target="_blank">00:34:58.400</a></span> | <span class="t">to adjust its learning rate and then just append that new learning rate to a list of learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2104" target="_blank">00:35:04.240</a></span> | <span class="t">rates and then plot it so that's here's and what i've done here is i've intentionally gone over 100</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2111" target="_blank">00:35:11.120</a></span> | <span class="t">because i had told it i'm going to do 100 so i'm going over 100 and you can see the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2116" target="_blank">00:35:16.480</a></span> | <span class="t">if we did 100 iterations would start high for a while it would then go down and then it would stay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2123" target="_blank">00:35:23.520</a></span> | <span class="t">low for a while and if we intentionally go past the maximum it's actually start going up again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2128" target="_blank">00:35:28.720</a></span> | <span class="t">because this is a cosine curve so um one of the main things i guess i wanted to show here is like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2137" target="_blank">00:35:37.680</a></span> | <span class="t">what it looks like to really investigate in a repl environment like a notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2147" target="_blank">00:35:47.520</a></span> | <span class="t">how you know how an object behaves you know what's in it and you know this is something i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2154" target="_blank">00:35:54.160</a></span> | <span class="t">would always want to do when i'm using something from an api i'm not very familiar with i really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2159" target="_blank">00:35:59.200</a></span> | <span class="t">want to like see what's in it see what they do run it totally independently plot anything i can plot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2166" target="_blank">00:36:06.560</a></span> | <span class="t">this is how i yeah like to learn about the stuff i'm working with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2174" target="_blank">00:36:14.000</a></span> | <span class="t">um you know data scientists don't spend all of their time just coding you know so that means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2181" target="_blank">00:36:21.040</a></span> | <span class="t">we need we can't just rely on using the same classes and apis every day so we have to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2188" target="_blank">00:36:28.880</a></span> | <span class="t">very good at exploring them and learning about them and so that's why i think this is a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2193" target="_blank">00:36:33.440</a></span> | <span class="t">good approach okay so um let's create a scheduler callback so a scheduler callback is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2203" target="_blank">00:36:43.440</a></span> | <span class="t">we're going to pass in the scheduling class but remember then when we go the scheduling callable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2211" target="_blank">00:36:51.200</a></span> | <span class="t">actually and remember that when we create the scheduler</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2214" target="_blank">00:36:54.480</a></span> | <span class="t">we have to pass in the optimizer to to schedule and so before fit that's the point at which we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2225" target="_blank">00:37:05.520</a></span> | <span class="t">have an optimizer we will create the scheduling object i like this ghetto it's very australian</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2231" target="_blank">00:37:11.680</a></span> | <span class="t">so the scheduling object we will create by passing the optimizer into the scheduler callable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2236" target="_blank">00:37:16.320</a></span> | <span class="t">and then when we do step then we'll check if we're training and if so we'll step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2254" target="_blank">00:37:34.640</a></span> | <span class="t">okay so then what's going to call step is after batch so after batch we'll call step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2262" target="_blank">00:37:42.400</a></span> | <span class="t">and that would be if you want your scheduler to update the learning rate every batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2267" target="_blank">00:37:47.760</a></span> | <span class="t">um we could also have a um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2275" target="_blank">00:37:55.280</a></span> | <span class="t">an epoch scheduler callback which we'll see later and that's just going to be after epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2284" target="_blank">00:38:04.560</a></span> | <span class="t">so in order to actually see what the schedule is doing we're going to need to create a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2294" target="_blank">00:38:14.800</a></span> | <span class="t">callback to keep track of what's going on in our learner and i figured we could create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2300" target="_blank">00:38:20.640</a></span> | <span class="t">recorder callback and what we're going to do is we're going to be passing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2306" target="_blank">00:38:26.400</a></span> | <span class="t">the name of the thing that we want to record that we want to keep track of in each batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2313" target="_blank">00:38:33.840</a></span> | <span class="t">and a function which is going to be responsible for grabbing the thing that we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2318" target="_blank">00:38:38.400</a></span> | <span class="t">and so in this case the function here is going to grab from the callback look up its param groups</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2327" target="_blank">00:38:47.200</a></span> | <span class="t">property and grab the learning rate um where does the pg property come from attribute well before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2334" target="_blank">00:38:54.560</a></span> | <span class="t">fit the recorder callback is going to grab just the first parameter group um just so it's like you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2342" target="_blank">00:39:02.320</a></span> | <span class="t">got to pick some parameter group to track so we'll just grab the first one and so then um also we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2348" target="_blank">00:39:08.880</a></span> | <span class="t">going to create a dictionary of all the things that we're recording so we'll get all the names</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2354" target="_blank">00:39:14.560</a></span> | <span class="t">so that's going to be in this case just lr and initially it's just going to be an empty list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2359" target="_blank">00:39:19.520</a></span> | <span class="t">and then after batch we'll go through each of the items in that dictionary which in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2365" target="_blank">00:39:25.120</a></span> | <span class="t">case is just lr as the key and underscore lr function as the value and we will append to that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2371" target="_blank">00:39:31.120</a></span> | <span class="t">list call that method call that function or callable and pass in this callback and that's why this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2380" target="_blank">00:39:40.000</a></span> | <span class="t">is going to get the callback and so that's going to basically then have a whole bunch of you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2386" target="_blank">00:39:46.160</a></span> | <span class="t">dictionary of the results you know of each of these functions uh after each batch um during</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2395" target="_blank">00:39:55.200</a></span> | <span class="t">training um so we'll just go through and plot them all and so let me show you what that's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2401" target="_blank">00:40:01.360</a></span> | <span class="t">look like if we um let's create a cosine annealing callable um so we're going to have to use a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2413" target="_blank">00:40:13.680</a></span> | <span class="t">partial to say that this callable is going to have t max equal to three times however many many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2421" target="_blank">00:40:21.600</a></span> | <span class="t">batches we have in our data loader that's because we're going to do three epochs um and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2428" target="_blank">00:40:28.800</a></span> | <span class="t">we will set it running and we're passing in the batch scheduler with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2440" target="_blank">00:40:40.080</a></span> | <span class="t">scheduler callable and we're also going to pass in our recorder callback saying we want to check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2448" target="_blank">00:40:48.640</a></span> | <span class="t">the learning rate using the underscore lr function we're going to call fit um and oh this is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2455" target="_blank">00:40:55.040</a></span> | <span class="t">a pretty good accuracy we're getting you know close to 90 percent now in only three epochs which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2460" target="_blank">00:41:00.000</a></span> | <span class="t">impressive and so when we then call rec dot plot it's going to call remember the rec is the recorder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2468" target="_blank">00:41:08.320</a></span> | <span class="t">callback so it plots the learning rate isn't that sweet so we could as i said we would can do exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2479" target="_blank">00:41:19.120</a></span> | <span class="t">the same thing but replace after batch with after epoch and this will now become a scheduler which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2485" target="_blank">00:41:25.360</a></span> | <span class="t">steps at the end of each epoch rather than the end of each batch so i can do exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2491" target="_blank">00:41:31.120</a></span> | <span class="t">thing now using an epoch scheduler so this time t max is three because we're only going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2496" target="_blank">00:41:36.400</a></span> | <span class="t">stepping three times we're not stepping at the end of each batch just at the end of each epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2500" target="_blank">00:41:40.320</a></span> | <span class="t">so that trains and then we can call rec dot plot after trains and as you can see there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2508" target="_blank">00:41:48.400</a></span> | <span class="t">it's just stepping three times so you can see here we're really digging in deeply to understanding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2519" target="_blank">00:41:59.200</a></span> | <span class="t">what's happening in everything in our models what are all the activations look like what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2523" target="_blank">00:42:03.920</a></span> | <span class="t">are the losses look like what do our learning rates look like and we've built all this from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2530" target="_blank">00:42:10.720</a></span> | <span class="t">so yeah hopefully that gives you a sense that we can really yeah do a lot ourselves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2538" target="_blank">00:42:18.480</a></span> | <span class="t">now if you've done the fastai part one course you'll be very aware of one cycle training which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2547" target="_blank">00:42:27.520</a></span> | <span class="t">was from a terrific paper by leslie smith which i'm not sure it ever got published actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2558" target="_blank">00:42:38.080</a></span> | <span class="t">and one cycle training is well let's take a look at it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2565" target="_blank">00:42:45.920</a></span> | <span class="t">so we can just replace our scheduler with one cycle learning rate scheduler so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2576" target="_blank">00:42:56.720</a></span> | <span class="t">in pytorch and of course if it wasn't in pytorch we could very easily just write our own</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2580" target="_blank">00:43:00.800</a></span> | <span class="t">we're going to make it a batch scheduler and we're going to train this time we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2587" target="_blank">00:43:07.520</a></span> | <span class="t">five epochs so we're going to train a bit longer and so the first thing i'll point out is hooray</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2592" target="_blank">00:43:12.880</a></span> | <span class="t">we have got a new record for us 90.6 so that's great so and then b you can see here's the plot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2604" target="_blank">00:43:24.720</a></span> | <span class="t">and now look two things are being plotted and that's because i've now passed into the recorder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2609" target="_blank">00:43:29.200</a></span> | <span class="t">callback a plot of learning rates and also a plot of momentums and momentums it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2615" target="_blank">00:43:35.120</a></span> | <span class="t">grip the beta's zero because remember for adam it's called beta zero and beta one is momentum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2622" target="_blank">00:43:42.960</a></span> | <span class="t">of the gradients and the momentum of the gradient squared and you can see what the one cycle is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2630" target="_blank">00:43:50.880</a></span> | <span class="t">doing is the learning rate is starting very low and going up to high and then down again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2640" target="_blank">00:44:00.320</a></span> | <span class="t">but the momentum is starting high and then going down and then up again so what's the theory here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2649" target="_blank">00:44:09.360</a></span> | <span class="t">well the the the starting out at a low learning rate is particularly important if you have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2657" target="_blank">00:44:17.760</a></span> | <span class="t">not perfectly initialized model which almost everybody almost always does even though we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2667" target="_blank">00:44:27.600</a></span> | <span class="t">spent a lot of time learning to initialize models you know we use a lot of models that get more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2673" target="_blank">00:44:33.920</a></span> | <span class="t">complicated and after a while people after a while people learn or figure out how to initialize more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2687" target="_blank">00:44:47.040</a></span> | <span class="t">complex models properly so for example this is a very very cool paper in 2019 this team figured out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2699" target="_blank">00:44:59.200</a></span> | <span class="t">how to initialize resnets properly we'll be looking at resnets very shortly and they discovered when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2705" target="_blank">00:45:05.120</a></span> | <span class="t">they did that they did not need batch norm they could train networks of 10 000 layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2712" target="_blank">00:45:12.720</a></span> | <span class="t">and they could get state-of-the-art performance with no batch norm and there's actually been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2718" target="_blank">00:45:18.000</a></span> | <span class="t">something similar for transformers called tfixup that does a similar kind of thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2730" target="_blank">00:45:30.240</a></span> | <span class="t">but anyway it is quite difficult to initialize models correctly most people fail to most people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2738" target="_blank">00:45:38.720</a></span> | <span class="t">fail to realize that they generally don't need tricks like warm up and batch norm if they do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2745" target="_blank">00:45:45.520</a></span> | <span class="t">initialize them correctly in fact tfixup explicitly looks at this it looks at the difference between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2749" target="_blank">00:45:49.920</a></span> | <span class="t">no warm up versus with warm up with their correct initialization versus with normal initialization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2756" target="_blank">00:45:56.160</a></span> | <span class="t">and you can see these pictures they're showing are pretty similar actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2760" target="_blank">00:46:00.080</a></span> | <span class="t">log scale histograms of gradients they're very similar to the colorful dimension plots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2765" target="_blank">00:46:05.280</a></span> | <span class="t">i kind of like our colorful dimension plots better in some ways because i think they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2768" target="_blank">00:46:08.640</a></span> | <span class="t">easier to read although i think theirs are probably prettier so there you go stufano</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2772" target="_blank">00:46:12.880</a></span> | <span class="t">there's something to inspire you if you want to try more things with our colorful dimension plots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2778" target="_blank">00:46:18.000</a></span> | <span class="t">i think it's interesting that some papers are actually starting to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2781" target="_blank">00:46:21.280</a></span> | <span class="t">use a similar idea i don't know if they got it from us or they came up with it independently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2787" target="_blank">00:46:27.120</a></span> | <span class="t">doesn't really matter but so that so we do a warm up if our if our if our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2795" target="_blank">00:46:35.680</a></span> | <span class="t">network's not quite initialized correctly then starting at a very low learning rate means it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2801" target="_blank">00:46:41.200</a></span> | <span class="t">not going to jump off way outside the area where the weights even make sense and so then you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2807" target="_blank">00:46:47.440</a></span> | <span class="t">gradually increase them as the weights move into a part of the space that does make sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2813" target="_blank">00:46:53.360</a></span> | <span class="t">and then during that time while we have low learning rates if they keep moving in the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2818" target="_blank">00:46:58.640</a></span> | <span class="t">direction then with it it's very high momentum they'll move more and more quickly but if they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2823" target="_blank">00:47:03.040</a></span> | <span class="t">keep moving in different directions it's just the momentum is going to kind of look at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2827" target="_blank">00:47:07.840</a></span> | <span class="t">underlying direction they're moving and then once you have got to a good part of the weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2833" target="_blank">00:47:13.600</a></span> | <span class="t">space you can use a very high learning rate and with a very high learning rate you wouldn't want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2837" target="_blank">00:47:17.920</a></span> | <span class="t">so much momentum so that's why there's low momentum during the time when there's high learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2843" target="_blank">00:47:23.200</a></span> | <span class="t">and then as we saw in our spreadsheet which did this automatically as you get closer to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2850" target="_blank">00:47:30.000</a></span> | <span class="t">the optimal you generally want to decrease the learning rate and since we're decreasing it again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2855" target="_blank">00:47:35.840</a></span> | <span class="t">we can increase the momentum so you can see that starting from random weights we've got a pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2862" target="_blank">00:47:42.160</a></span> | <span class="t">good accuracy on fashion MNIST with a totally standard convolutional neural network no resonance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2868" target="_blank">00:47:48.400</a></span> | <span class="t">nothing else everything built from scratch by hand artisanal neural network training and we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2875" target="_blank">00:47:55.120</a></span> | <span class="t">90.6 percent fashion MNIST so there you go all right let's take a seven minute break</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2886" target="_blank">00:48:06.480</a></span> | <span class="t">and i'll see you back shortly i should warn you you've got a lot more to cover so i hope you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2895" target="_blank">00:48:15.120</a></span> | <span class="t">okay with a long lesson today</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2898" target="_blank">00:48:18.880</a></span> | <span class="t">okay we're back um i just wanted to mention also something we skipped over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2909" target="_blank">00:48:29.840</a></span> | <span class="t">which uh is this has learn callback um this is more important for the people doing the live</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2917" target="_blank">00:48:37.840</a></span> | <span class="t">course than the recordings if you're doing the recording you will have already seen this but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2921" target="_blank">00:48:41.840</a></span> | <span class="t">since i created learner actually uh peter zappa i don't know how to pronounce your surname sorry peter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2929" target="_blank">00:48:49.440</a></span> | <span class="t">um uh pointed out that there's actually kind of a nicer way of of handling learner that um previously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2938" target="_blank">00:48:58.960</a></span> | <span class="t">we were putting the learner object itself into self.learn in each callback and that meant we were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2945" target="_blank">00:49:05.280</a></span> | <span class="t">using self.learn.model and self.learn.opt and self.learn.all this you know all over the place it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2950" target="_blank">00:49:10.400</a></span> | <span class="t">kind of ugly um so we've modified learner this week um to instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2959" target="_blank">00:49:19.360</a></span> | <span class="t">um pass in when it calls the callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2967" target="_blank">00:49:27.040</a></span> | <span class="t">when in run cbs which is what it calls uh learner calls you might remember is it passes the learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2980" target="_blank">00:49:40.720</a></span> | <span class="t">as a parameter to the method um so now um the learner no longer goes through the callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2988" target="_blank">00:49:48.640</a></span> | <span class="t">and sets their dot learn attribute um but instead in your callbacks you have to put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=2995" target="_blank">00:49:55.200</a></span> | <span class="t">learn as a parameter in all of the method in all of the callback methods so for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3006" target="_blank">00:50:06.560</a></span> | <span class="t">device cb has a before fit so now it's got comma learn here so now this is not self.learn it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3013" target="_blank">00:50:13.760</a></span> | <span class="t">learn um so it does make a lot of the code um less less yucky to not have all this self.learn.pred</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3023" target="_blank">00:50:23.840</a></span> | <span class="t">equals self.learn.model self.learn.batch is now just learn. it also is good because you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3029" target="_blank">00:50:29.440</a></span> | <span class="t">generally want to have um both have the learner um has a reference to the callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3038" target="_blank">00:50:38.400</a></span> | <span class="t">but also the callbacks having a reference back to the learner it creates something called a cycle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3044" target="_blank">00:50:44.080</a></span> | <span class="t">so there's a couple of benefits there um and that reminds me there's a few other little changes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3055" target="_blank">00:50:55.120</a></span> | <span class="t">we've made to the code and i want to show you a cool little trick i want to show you a cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3062" target="_blank">00:51:02.080</a></span> | <span class="t">little trick for how i'm going to find quickly all of the changes that we've made to the code in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3067" target="_blank">00:51:07.600</a></span> | <span class="t">last week so to do that we can go to the course repo and on any repo you can add slash compare</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3077" target="_blank">00:51:17.280</a></span> | <span class="t">in github and then you can compare across um you know all kinds of different things but one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3085" target="_blank">00:51:25.120</a></span> | <span class="t">examples they've got here is to compare across different times look at the master branch now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3089" target="_blank">00:51:29.920</a></span> | <span class="t">versus one day ago so i actually want the master branch now versus seven days ago so i just hit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3096" target="_blank">00:51:36.400</a></span> | <span class="t">this change this to seven and there we go there's all my commits and i can immediately see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3105" target="_blank">00:51:45.280</a></span> | <span class="t">the changes from last week um and so you can basically see what are the things i had to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3112" target="_blank">00:51:52.080</a></span> | <span class="t">when i change things so for example you can see here all of my self.learns became learns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3118" target="_blank">00:51:58.880</a></span> | <span class="t">i added the nearly that's right i made augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3124" target="_blank">00:52:04.400</a></span> | <span class="t">and so in learner i added an lr find oh yes i will show you that one that's pretty fun</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3134" target="_blank">00:52:14.880</a></span> | <span class="t">so here's the changes we made to run cbs to fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3140" target="_blank">00:52:20.160</a></span> | <span class="t">so this is a nice way i can quickly yeah find out um what i've changed since last time and make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3148" target="_blank">00:52:28.480</a></span> | <span class="t">that i don't forget to tell you folks about any of them oh yes clean up fit i have to tell you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3154" target="_blank">00:52:34.080</a></span> | <span class="t">about that as well okay that's a useful reminder so um the main other change to mention is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3163" target="_blank">00:52:43.520</a></span> | <span class="t">calling the learning rate finder is now easier because i added what's called a patch to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3171" target="_blank">00:52:51.360</a></span> | <span class="t">learner um fast cause patch decorator that's you take a function and it will turn that function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3180" target="_blank">00:53:00.160</a></span> | <span class="t">into a method of this class of whatever class you put after the colon so this has created a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3187" target="_blank">00:53:07.920</a></span> | <span class="t">method called lr find or learner dot lr find and what it does is it calls self.fit where self is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3200" target="_blank">00:53:20.480</a></span> | <span class="t">learner passing in however many epochs you set as the maximum you want to check for your learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3205" target="_blank">00:53:25.360</a></span> | <span class="t">rate finder what to start the learning rate at and then it says to use as callbacks the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3213" target="_blank">00:53:33.680</a></span> | <span class="t">rate finder callback now this is new as well um self dot learn.fit didn't used to have a callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3221" target="_blank">00:53:41.120</a></span> | <span class="t">parameter um so that's very convenient because what it does is it adds those callbacks just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3229" target="_blank">00:53:49.680</a></span> | <span class="t">during the fit so if you pass in callbacks then it goes through each one and appends it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3237" target="_blank">00:53:57.840</a></span> | <span class="t">to self.cb's and when it's finished fitting it removes them again so these are callbacks that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3244" target="_blank">00:54:04.960</a></span> | <span class="t">are just added for the period of this one fit which is what we want for a learning rate finder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3249" target="_blank">00:54:09.200</a></span> | <span class="t">it should just be added for that one fit um so with this patch in place it says this is all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3256" target="_blank">00:54:16.800</a></span> | <span class="t">it's required to do the learning rate finder is now to create your learner and call dot lr find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3263" target="_blank">00:54:23.040</a></span> | <span class="t">and there you go bang so patch is a very convenient thing it's um one of these things which you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3270" target="_blank">00:54:30.320</a></span> | <span class="t">python has a lot of kind of like folk wisdom about what is and isn't considered pythonic or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3278" target="_blank">00:54:38.800</a></span> | <span class="t">good and a lot of people uh really don't like patching um in other languages it's used very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3286" target="_blank">00:54:46.720</a></span> | <span class="t">widely and is considered very good um so i i don't tend to have strong opinions either way about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3293" target="_blank">00:54:53.680</a></span> | <span class="t">what's good or what's bad in fact instead i just you know figure out what's useful in a particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3298" target="_blank">00:54:58.080</a></span> | <span class="t">situation um so in this situation obviously it's very nice to be able to add in this additional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3304" target="_blank">00:55:04.720</a></span> | <span class="t">functionality to our class so that's what lr find is um and then the only other thing we added to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3312" target="_blank">00:55:12.560</a></span> | <span class="t">the learner uh this week was we added a few more parameters to fit fit used to just take the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3318" target="_blank">00:55:18.480</a></span> | <span class="t">of epochs um as well as the callbacks parameter it now also has a learning rate parameter and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3325" target="_blank">00:55:25.120</a></span> | <span class="t">so you've always been able to provide a learning rate to um the constructor but you can override</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3331" target="_blank">00:55:31.600</a></span> | <span class="t">the learning rate for one fit so if you pass in the learning rate it will use it if you pass it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3339" target="_blank">00:55:39.840</a></span> | <span class="t">in and if you don't it'll use the learning rate passed into the constructor and then i also added</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3346" target="_blank">00:55:46.000</a></span> | <span class="t">these two booleans to say when you fit do you want to do the training loop and do you want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3352" target="_blank">00:55:52.080</a></span> | <span class="t">do the validation loop so by default it'll do both and you can see here there's just an if train do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3357" target="_blank">00:55:57.760</a></span> | <span class="t">the training loop if valid do the validation loop um i'm not even going to talk about this but if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3365" target="_blank">00:56:05.600</a></span> | <span class="t">you're interested in testing your understanding of decorators you might want to think about why it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3370" target="_blank">00:56:10.960</a></span> | <span class="t">is that i didn't have to say with torch.nograd but instead i called torch.nograd parentheses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3377" target="_blank">00:56:17.360</a></span> | <span class="t">function that will be a very if you can get to a point that you understand why that works and what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3382" target="_blank">00:56:22.880</a></span> | <span class="t">it does you'll be on your way to understanding decorators better okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3391" target="_blank">00:56:31.280</a></span> | <span class="t">so that is the end of excel sgd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3396" target="_blank">00:56:36.640</a></span> | <span class="t">resnets okay so we are up to 90 point what was it three percent uh yeah let's keep track of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3410" target="_blank">00:56:50.080</a></span> | <span class="t">oh yeah 90.6 percent is what we're up to okay so to remind you the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3420" target="_blank">00:57:00.880</a></span> | <span class="t">um actually so we're going to open 13 resnet now um and we're going to do the usual important setup</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3431" target="_blank">00:57:11.840</a></span> | <span class="t">initially and the model that we've been using is the same one we've been using for a while</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3444" target="_blank">00:57:24.160</a></span> | <span class="t">which is that it's a convolution and an activation and an optimal optional batch norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3453" target="_blank">00:57:33.600</a></span> | <span class="t">and uh in our models we were using batch norm and applying our weight initialization the kiming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3464" target="_blank">00:57:44.880</a></span> | <span class="t">weight initialization and then we've got comms that take the channels from 1 to 8 to 16 to 32 to 64</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3472" target="_blank">00:57:52.560</a></span> | <span class="t">and each one's dried two and at the end we then do a flatten and so that ended up with a one by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3479" target="_blank">00:57:59.440</a></span> | <span class="t">so that's been the model we've been using for a while so the number of layers is one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3487" target="_blank">00:58:07.600</a></span> | <span class="t">two three four so four four convolutional layers with a maximum of 64 channels in the last one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3500" target="_blank">00:58:20.480</a></span> | <span class="t">so can we beat 90.9 about 90 and a half</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3504" target="_blank">00:58:24.400</a></span> | <span class="t">90.6 can we beat 90.6 percent so before we do a resnet i thought well let's just see if we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3513" target="_blank">00:58:33.760</a></span> | <span class="t">improve the architecture thoughtfully so generally speaking um more depth and more channels gives the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3523" target="_blank">00:58:43.440</a></span> | <span class="t">neural net more opportunity to learn and since we're pretty good at initializing our neural nets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3528" target="_blank">00:58:48.000</a></span> | <span class="t">and using batch norm we should be able to handle deeper so um one thing we could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3535" target="_blank">00:58:55.680</a></span> | <span class="t">is we could let's just remind ourselves of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3540" target="_blank">00:59:00.160</a></span> | <span class="t">previous version so we can compare</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3548" target="_blank">00:59:08.080</a></span> | <span class="t">is we could have our go up to 128 parameters now the way we do that is we could make our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3558" target="_blank">00:59:18.800</a></span> | <span class="t">very first convolutional layer have a stride of one so that would be one that goes from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3565" target="_blank">00:59:25.040</a></span> | <span class="t">the one input channel to eight output channels or eight filters if you like so if we make it a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3572" target="_blank">00:59:32.640</a></span> | <span class="t">stride of one then that allows us to have one extra layer and then that one extra layer could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3579" target="_blank">00:59:39.840</a></span> | <span class="t">again double the number of channels and take us up to 128 so that would make it uh deeper and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3585" target="_blank">00:59:45.840</a></span> | <span class="t">effectively wider as a result um so we can do our normal batch norm 2d and our new one cycle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3594" target="_blank">00:59:54.320</a></span> | <span class="t">learning rate with our scheduler um and the callbacks we're going to use is the device call back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3601" target="_blank">01:00:01.840</a></span> | <span class="t">our metrics our progress bar and our activation stats looking for general values and i won't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3609" target="_blank">01:00:09.600</a></span> | <span class="t">what have you watched them train because that would be kind of boring but if i do this with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3614" target="_blank">01:00:14.080</a></span> | <span class="t">this deeper and eventually wider network this is pretty amazing we get up to 91.7 percent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3622" target="_blank">01:00:22.000</a></span> | <span class="t">so that's like quite a big difference and literally the only difference to our previous model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3627" target="_blank">01:00:27.840</a></span> | <span class="t">is this one line of code which allowed us to take this instead of going from one to 64 it goes from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3636" target="_blank">01:00:36.080</a></span> | <span class="t">eight to 128 so that's a very small change but it massively improved so the error rate's gone down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3641" target="_blank">01:00:41.840</a></span> | <span class="t">by a temp you know about well over 10 percent relatively speaking um in terms of the error rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3647" target="_blank">01:00:47.840</a></span> | <span class="t">so there's a huge impact we've already had um again five epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3656" target="_blank">01:00:56.240</a></span> | <span class="t">so now what we're going to do is we're going to make it deeper still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3659" target="_blank">01:00:59.040</a></span> | <span class="t">but it gets there becomes a point um so chiming her at our noted that there comes a point where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3668" target="_blank">01:01:08.800</a></span> | <span class="t">making neural nets deeper stops working well and remember this is the guy who created the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3675" target="_blank">01:01:15.520</a></span> | <span class="t">initializer that we know and love and he pointed out that even with that good initialization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3683" target="_blank">01:01:23.440</a></span> | <span class="t">there comes a time where adding more layers becomes problematic and he pointed out something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3689" target="_blank">01:01:29.520</a></span> | <span class="t">particularly interesting he said let's take a 20-layer neural network this is in a paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3696" target="_blank">01:01:36.240</a></span> | <span class="t">called deep deep residue learning for image recognition that introduced resnets so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3700" target="_blank">01:01:40.480</a></span> | <span class="t">take a 20-layer network and train it for a few what's that tens of thousands of iterations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3710" target="_blank">01:01:50.000</a></span> | <span class="t">and track its test error okay and now let's do exactly the same thing on a 56-layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3716" target="_blank">01:01:56.400</a></span> | <span class="t">identical otherwise identical but deeper 56-layer network and he pointed out that the 56-layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3722" target="_blank">01:02:02.400</a></span> | <span class="t">network had a worse error than the 20-layer and it wasn't just a problem of generalization because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3728" target="_blank">01:02:08.080</a></span> | <span class="t">it was worse on the training set as well now the insight that he had is if you just set the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3744" target="_blank">01:02:24.000</a></span> | <span class="t">additional 36 layers to just identity you know identity matrices they should they would do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3751" target="_blank">01:02:31.920</a></span> | <span class="t">nothing at all and so a 56-layer network is a superset of a 20-layer network so it should be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3760" target="_blank">01:02:40.320</a></span> | <span class="t">at least as good but it's not it's worse so clearly the problem here is something about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3767" target="_blank">01:02:47.200</a></span> | <span class="t">training it and so him and his team came up with a really clever insight which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3776" target="_blank">01:02:56.800</a></span> | <span class="t">can we create a 56-layer network which has the same training dynamics as a 20-layer network or even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3786" target="_blank">01:03:06.080</a></span> | <span class="t">less and they realized yes you can what you could do is you could add something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3796" target="_blank">01:03:16.880</a></span> | <span class="t">a shortcut connection and basically the idea is that normally when we have you know our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3808" target="_blank">01:03:28.640</a></span> | <span class="t">inputs coming into our convolution so let's say that's that was our inputs and here's our convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3818" target="_blank">01:03:38.560</a></span> | <span class="t">and here's our outputs now if we do this 56 times that's a lot of stacked up convolutions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3830" target="_blank">01:03:50.640</a></span> | <span class="t">which are effectively matrix multiplications with a lot of opportunity for you know gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3835" target="_blank">01:03:55.200</a></span> | <span class="t">explosions and all that fun stuff so how could we make it so that we have convolutions but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3845" target="_blank">01:04:05.840</a></span> | <span class="t">with the training dynamics of a much shallower network and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3850" target="_blank">01:04:10.080</a></span> | <span class="t">here's what he did he said let's actually put two comms in here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3864" target="_blank">01:04:24.720</a></span> | <span class="t">to make it twice as deep because we are trying to make things deeper but then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3874" target="_blank">01:04:34.080</a></span> | <span class="t">let's add what's called a skip connection where instead of just being out equals so this is conv1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3884" target="_blank">01:04:44.240</a></span> | <span class="t">this is conv2 instead of being out equals and there's a you know assume that these include</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3890" target="_blank">01:04:50.080</a></span> | <span class="t">activation functions equals conv2 of conv1 of in right instead of just doing that let's make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3902" target="_blank">01:05:02.560</a></span> | <span class="t">it conv2 of conv1 of in plus in now if we initialize these at the first to have weights of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3918" target="_blank">01:05:18.480</a></span> | <span class="t">zero then initially this will do nothing at all it will output zero and therefore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3929" target="_blank">01:05:29.440</a></span> | <span class="t">at first you'll just get out equals in which is exactly what we wanted right we actually want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3937" target="_blank">01:05:37.680</a></span> | <span class="t">to to to for it to be as if there is no extra layers and so this way we actually end up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3948" target="_blank">01:05:48.720</a></span> | <span class="t">with a network which can which can be deep but also at least when you start training behaves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3956" target="_blank">01:05:56.560</a></span> | <span class="t">as if it's shallow it's called a residual connection because if we subtract in from both sides</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3965" target="_blank">01:06:05.440</a></span> | <span class="t">out then we would get out minus in equals conv1 of conv2 of in in other words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3976" target="_blank">01:06:16.800</a></span> | <span class="t">the difference between the end point and the starting point which is the residual and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3985" target="_blank">01:06:25.280</a></span> | <span class="t">another way of thinking about it is that this is calculating a residual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3992" target="_blank">01:06:32.000</a></span> | <span class="t">so there's a couple of ways of thinking about it and so this this thing here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=3999" target="_blank">01:06:39.840</a></span> | <span class="t">is called the res block or res net block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4010" target="_blank">01:06:50.080</a></span> | <span class="t">okay so Sam Watkins has just pointed out the confusion here which is that this only works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4018" target="_blank">01:06:58.720</a></span> | <span class="t">if let's put the minus in back and put it back over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4025" target="_blank">01:07:05.600</a></span> | <span class="t">this only works if you can add these together now if conv1 and conv2 both have the same number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4036" target="_blank">01:07:16.160</a></span> | <span class="t">channels as in the same number of filters same number of filters and they also have stride1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4045" target="_blank">01:07:25.120</a></span> | <span class="t">then that will work fine you'll end up that will be exactly the same output shape as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4053" target="_blank">01:07:33.760</a></span> | <span class="t">input shape and you can add them together but if they are not the same then you're in a bit of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4064" target="_blank">01:07:44.240</a></span> | <span class="t">trouble so what do you do and the answer which um timing her et al came up with is to add a conv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4075" target="_blank">01:07:55.120</a></span> | <span class="t">on in as well but to make it as simple as possible we call this the identity conv it's not really an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4086" target="_blank">01:08:06.080</a></span> | <span class="t">identity anymore but we're trying to make it as simple as possible so that we do as little to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4091" target="_blank">01:08:11.840</a></span> | <span class="t">mess up these training dynamics as we can and the simplest possible convolution is a one by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4098" target="_blank">01:08:18.960</a></span> | <span class="t">filter block a one by one kernel i guess we should call it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4103" target="_blank">01:08:23.360</a></span> | <span class="t">a one by one kernel size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4107" target="_blank">01:08:27.760</a></span> | <span class="t">and using that and we can also add a stride or whatever if we want to so let me show you the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4119" target="_blank">01:08:39.440</a></span> | <span class="t">so we're going to create something called a conv block okay and the conv block is going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4125" target="_blank">01:08:45.600</a></span> | <span class="t">the two comms that's going to be a conv block okay so we've got some number of input filters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4132" target="_blank">01:08:52.320</a></span> | <span class="t">some number of output filters some stride some activation functions possibly a normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4139" target="_blank">01:08:59.520</a></span> | <span class="t">and possibly and some some kernel shape some kernel size so um the second conv is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4150" target="_blank">01:09:10.320</a></span> | <span class="t">going to go from output filters to output filters because the first conv is going to be from input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4158" target="_blank">01:09:18.000</a></span> | <span class="t">filters to output filters so by the time we get to the second conv it's going to be nf to nf</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4165" target="_blank">01:09:25.440</a></span> | <span class="t">the first conv we will set stride one and then the second conv will have the requested stride</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4172" target="_blank">01:09:32.080</a></span> | <span class="t">and so that way the two comms back to back are going to overall have the requested stride</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4176" target="_blank">01:09:36.960</a></span> | <span class="t">so this way the combination of these two comms is going to eventually is going to take us from ni</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4182" target="_blank">01:09:42.640</a></span> | <span class="t">to nf in terms of the number of filters and it's going to have the stride that we requested</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4187" target="_blank">01:09:47.360</a></span> | <span class="t">so it's going to be a the conv block is a sequential block consisting of a convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4194" target="_blank">01:09:54.800</a></span> | <span class="t">followed by another convolution each one with a requested kernel size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4198" target="_blank">01:09:58.720</a></span> | <span class="t">and requested activation function and the requested normalization layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4206" target="_blank">01:10:06.400</a></span> | <span class="t">the second conv won't have an activation function i'll explain why in a moment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4210" target="_blank">01:10:10.880</a></span> | <span class="t">and so i mentioned that one way to make this as if it didn't exist would be to set the convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4222" target="_blank">01:10:22.320</a></span> | <span class="t">weights to zero and the biases to zero but actually we would we would like to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4227" target="_blank">01:10:27.200</a></span> | <span class="t">you know correctly randomly initialized weights so instead what we can do is if you're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4234" target="_blank">01:10:34.800</a></span> | <span class="t">batch norm we can initialize this conv two one will be the batch norm layer we can initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4241" target="_blank">01:10:41.360</a></span> | <span class="t">the batch norm weights to zero now if you've forgotten what that means go back and have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4246" target="_blank">01:10:46.880</a></span> | <span class="t">look at our implementation from scratch of batch norm because the batch norm weights is the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4251" target="_blank">01:10:51.360</a></span> | <span class="t">we multiply by so do you remember the batch norm we we subtract the exponential moving average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4260" target="_blank">01:11:00.640</a></span> | <span class="t">mean we divide by the exponential moving average standard deviation but then we add back the the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4268" target="_blank">01:11:08.240</a></span> | <span class="t">kind of the the the batch norms bias layer and we multiply by the batch norms weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4273" target="_blank">01:11:13.680</a></span> | <span class="t">well the way around multiplied by weights first so if we set the batch norm layers weights to zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4279" target="_blank">01:11:19.840</a></span> | <span class="t">we're multiplying by zero and so this will cause the initial conv block output to be just all zeros</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4287" target="_blank">01:11:27.360</a></span> | <span class="t">and so that's going to give us what we wanted is that nothing's happening here so we just end up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4295" target="_blank">01:11:35.120</a></span> | <span class="t">with the input with this possible id conv so a res block is going to contain those convolutions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4305" target="_blank">01:11:45.600</a></span> | <span class="t">in the convolution block we just discussed right and then we're going to need this id conv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4310" target="_blank">01:11:50.560</a></span> | <span class="t">so the id conv is going to be a no op so that's nothing at all if the number of channels in is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4318" target="_blank">01:11:58.800</a></span> | <span class="t">equal to the number of channels out but otherwise we're going to use a convolution with a kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4324" target="_blank">01:12:04.080</a></span> | <span class="t">size of one and a stride of one and so that is going to you know is as with as little work as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4331" target="_blank">01:12:11.520</a></span> | <span class="t">possible change the number of filters so that they match also what if the stride's not one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4339" target="_blank">01:12:19.760</a></span> | <span class="t">well if the stride is two actually i'm actually this isn't going to work for any stride this only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4345" target="_blank">01:12:25.040</a></span> | <span class="t">works for a stride of two if there's a stride of two we will simply average using average pooling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4351" target="_blank">01:12:31.280</a></span> | <span class="t">so this is just saying take the mean of every set of two items in the grid so we'll just take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4363" target="_blank">01:12:43.920</a></span> | <span class="t">mean so we we so we basically have here pool of id conv of in if the if the stride is two and if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4377" target="_blank">01:12:57.280</a></span> | <span class="t">the filtered number is changed and so that's the minimum amount of work so here it is here is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4383" target="_blank">01:13:03.760</a></span> | <span class="t">forward pass we get our input and on the identity connection we call pool and if stride is one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4392" target="_blank">01:13:12.480</a></span> | <span class="t">that's a no op so do nothing at all we do id conv and if the number of filters has not changed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4398" target="_blank">01:13:18.960</a></span> | <span class="t">that's also a no op so this is this is just the input in that situation and then we add that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4406" target="_blank">01:13:26.640</a></span> | <span class="t">to the result of the convs and here's something interesting we then apply the activation function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4412" target="_blank">01:13:32.400</a></span> | <span class="t">to the whole thing okay so that way i wouldn't say this is like the only way you can do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4420" target="_blank">01:13:40.000</a></span> | <span class="t">but this is this is a way that works pretty well is to apply the activation function to the result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4426" target="_blank">01:13:46.400</a></span> | <span class="t">of the whole the whole res net block and that's why i didn't add activation function to the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4435" target="_blank">01:13:55.760</a></span> | <span class="t">conv so that's a res block so it's not a huge amount of code right and so now i've literally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4444" target="_blank">01:14:04.960</a></span> | <span class="t">copied and pasted our get model but everywhere that previously we had a conv i've just replaced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4449" target="_blank">01:14:09.680</a></span> | <span class="t">it with res block in fact let's have a look get model okay so previously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4465" target="_blank">01:14:25.040</a></span> | <span class="t">we started with conv one to eight now we do res block one to eight stride one stride one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4472" target="_blank">01:14:32.240</a></span> | <span class="t">then we added con from number of filters i and number of filters i plus one now it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4476" target="_blank">01:14:36.640</a></span> | <span class="t">res block from number of filters number of filters i plus one okay so it's exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4480" target="_blank">01:14:40.560</a></span> | <span class="t">one change i have made though is i mean it doesn't actually make any difference at all i think it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4491" target="_blank">01:14:51.280</a></span> | <span class="t">mathematically identical is previously the very last conv at the end went from the you know 128</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4498" target="_blank">01:14:58.960</a></span> | <span class="t">channels down to the 10 channels followed by flatten but this conv is actually working on a one by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4508" target="_blank">01:15:08.000</a></span> | <span class="t">input so you know an alternate way but i think makes it clearer is flatten first and then use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4514" target="_blank">01:15:14.720</a></span> | <span class="t">a linear layer because a conv on a one by one input is identical to a linear layer and if that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4521" target="_blank">01:15:21.600</a></span> | <span class="t">doesn't immediately make sense that's totally fine but this is one of those places where you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4526" target="_blank">01:15:26.000</a></span> | <span class="t">should pause and have a little stop and think about why a conv on a one by one is the same and maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4532" target="_blank">01:15:32.240</a></span> | <span class="t">go back to the excel spreadsheet if you like or the the python from scratch conv we did because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4538" target="_blank">01:15:38.480</a></span> | <span class="t">this is a very important insight so i think it's very useful with a more complex model like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4544" target="_blank">01:15:44.400</a></span> | <span class="t">to take a good old look at it to see exactly what the inputs and outputs of each layer is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4551" target="_blank">01:15:51.280</a></span> | <span class="t">so here's a little function called print shape which takes the things that a hook takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4555" target="_blank">01:15:55.520</a></span> | <span class="t">and we will print out for each layer the name of the class the shape of the input and the shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4564" target="_blank">01:16:04.560</a></span> | <span class="t">of the output so we can get our model create our learner and use our handy little hooks context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4571" target="_blank">01:16:11.840</a></span> | <span class="t">manager we built an earlier lesson and call the print shape function and then we will call fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4578" target="_blank">01:16:18.720</a></span> | <span class="t">for one epoch just doing the evaluation of the training and if we use the single batch callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4585" target="_blank">01:16:25.200</a></span> | <span class="t">it'll just do a single batch put put pass it through and that hook will as you see print out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4591" target="_blank">01:16:31.760</a></span> | <span class="t">each layer the inputs shape and the output shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4602" target="_blank">01:16:42.320</a></span> | <span class="t">so you can see we're starting with an input of batch size of 1024 one channel 28 by 28</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4609" target="_blank">01:16:49.920</a></span> | <span class="t">our first res block was dried one so we still end up with 28 by 28 but now we've got eight channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4614" target="_blank">01:16:54.880</a></span> | <span class="t">and then we gradually decrease the grid size to 14 to 7 to 4 to 2 to 1 as we gradually increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4623" target="_blank">01:17:03.520</a></span> | <span class="t">the number of channels we then flatten it which gets rid of that one by one which allows us then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4631" target="_blank">01:17:11.280</a></span> | <span class="t">to do linear to go under the 10 and then there's some discussion about whether you want a batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4640" target="_blank">01:17:20.880</a></span> | <span class="t">norm at the end or not i was finding it quite useful in this case so we've got a batch norm at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4646" target="_blank">01:17:26.000</a></span> | <span class="t">the end i think this is very useful so i decided to create a patch for learner called summary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4655" target="_blank">01:17:35.760</a></span> | <span class="t">that would do basically exactly the same thing but it would do it as a markdown table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4661" target="_blank">01:17:41.840</a></span> | <span class="t">okay so if we create a train learner with our model and um call dot summary this method is now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4677" target="_blank">01:17:57.840</a></span> | <span class="t">available because it's been patched that method into the learner and it's going to do exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4684" target="_blank">01:18:04.880</a></span> | <span class="t">same thing as our print but it does it more prettily by using a markdown table if it's in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4690" target="_blank">01:18:10.400</a></span> | <span class="t">a notebook otherwise it'll just print it um so fast call has a handy thing for keeping track if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4695" target="_blank">01:18:15.520</a></span> | <span class="t">you're in a notebook and in a notebook to make something markdown you can just use ipython dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4700" target="_blank">01:18:20.800</a></span> | <span class="t">display dot markdown as you see um and the other thing that i added as well as the input and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4707" target="_blank">01:18:27.280</a></span> | <span class="t">output is i thought let's also add in the number of parameters so we can calculate that as we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4714" target="_blank">01:18:34.080</a></span> | <span class="t">seen before by summing up the number of elements for each parameter in that module and so then i've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4722" target="_blank">01:18:42.880</a></span> | <span class="t">kind of kept track of that as well so that at the end i can also print out the total number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4727" target="_blank">01:18:47.520</a></span> | <span class="t">parameters so we've got a 1.2 million parameter model and you can see that there's very few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4736" target="_blank">01:18:56.080</a></span> | <span class="t">parameters here in the input nearly all the parameters are actually in the last layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4742" target="_blank">01:19:02.800</a></span> | <span class="t">why is that well you might want to go back to our excel convolutional spreadsheet to see this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4747" target="_blank">01:19:07.920</a></span> | <span class="t">you have a parameter for every input channel you have a set of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4758" target="_blank">01:19:18.160</a></span> | <span class="t">they're all going to get added up across each of the three by three in the kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4767" target="_blank">01:19:27.200</a></span> | <span class="t">and then that's going to be done for every output filter every output channel that you want so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4773" target="_blank">01:19:33.760</a></span> | <span class="t">that's why you're going to end up with um in fact let's take a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4779" target="_blank">01:19:39.600</a></span> | <span class="t">maybe let's create let's just grab some particular one so create our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4792" target="_blank">01:19:52.720</a></span> | <span class="t">and so we'll just have a look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4800" target="_blank">01:20:00.240</a></span> | <span class="t">the sizes and so you can see here there is this 256 by 256 by three by three so that's a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4818" target="_blank">01:20:18.960</a></span> | <span class="t">parameters okay so we can call lrfind on that and get a sense of what kind of learning rate to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4831" target="_blank">01:20:31.280</a></span> | <span class="t">so i chose 2enag2 so 0.02 this is our standard learning thing you don't have to watch it train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4839" target="_blank">01:20:39.280</a></span> | <span class="t">i've just trained it and so look at this by using resnet we've gone up from 91.7</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4848" target="_blank">01:20:48.160</a></span> | <span class="t">this just keeps getting better 92.2 in 5 epochs so that's pretty nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4854" target="_blank">01:20:54.320</a></span> | <span class="t">and you know this resnet is not anything fancy it's it's the simplest possible res block right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4865" target="_blank">01:21:05.600</a></span> | <span class="t">the model is literally copied and pasted from before and replaced each place it said conv with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4870" target="_blank">01:21:10.560</a></span> | <span class="t">res block but we've just been thoughtful about it you know and here's something very interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4876" target="_blank">01:21:16.960</a></span> | <span class="t">we can actually try lots of other resnets by grabbing tim so that's ross weitman's pie torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4882" target="_blank">01:21:22.960</a></span> | <span class="t">image model library and if you call tim.listmodels star resnet star there's a lot of resnets and i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4895" target="_blank">01:21:35.680</a></span> | <span class="t">tried quite a few of them now one thing that's interesting is if you actually look at the source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4903" target="_blank">01:21:43.440</a></span> | <span class="t">code for tim you'll see that the various different resnets like resnet 18 resnet 18 d resnet 10 d</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4916" target="_blank">01:21:56.720</a></span> | <span class="t">they're defined in a very nice way using this very elegant configuration you can see exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4923" target="_blank">01:22:03.920</a></span> | <span class="t">what's different so there's basically only if one line of code different between each different type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4928" target="_blank">01:22:08.880</a></span> | <span class="t">of resnet for the main resnets and so what i did was i tried all the tim models i could find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4936" target="_blank">01:22:16.400</a></span> | <span class="t">and i even tried importing the underlying things and building my own resnets from those pieces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4944" target="_blank">01:22:24.480</a></span> | <span class="t">and the best i found was the resnet 18 d and if i train it in exactly the same way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4954" target="_blank">01:22:34.560</a></span> | <span class="t">i got to 92 percent and so the interesting thing is you'll see that's less than our 92.2 and it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4961" target="_blank">01:22:41.040</a></span> | <span class="t">not like i tried lots of things to get here this is the very first thing i tried where else this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4965" target="_blank">01:22:45.760</a></span> | <span class="t">resnet 18 d was after trying lots lots of different tim models and so what this shows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4971" target="_blank">01:22:51.200</a></span> | <span class="t">is that the just thoughtfully designed kind of basic architecture goes a very long way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4980" target="_blank">01:23:00.400</a></span> | <span class="t">it's actually better for this problem than any of the pytorch image model models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4988" target="_blank">01:23:08.640</a></span> | <span class="t">resnets that i could try that i could find so i think that's quite quite amazing actually it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=4998" target="_blank">01:23:18.320</a></span> | <span class="t">really cool you know and it shows that you can create a state-of-the-art architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5004" target="_blank">01:23:24.560</a></span> | <span class="t">just by using some common sense you know so i hope that's uh i hope that's yeah hope that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5011" target="_blank">01:23:31.040</a></span> | <span class="t">encouraging so anyway so we're up to 92.2 percent we're not done yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5019" target="_blank">01:23:39.520</a></span> | <span class="t">because we haven't even talked about data augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5027" target="_blank">01:23:47.440</a></span> | <span class="t">all right so let's keep going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5032" target="_blank">01:23:52.640</a></span> | <span class="t">so we're going to make everything the same as before but before we do data augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5039" target="_blank">01:23:59.440</a></span> | <span class="t">we're going to try to improve our model even further if we can so i said it was kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5046" target="_blank">01:24:06.480</a></span> | <span class="t">not constructed with any great care and thought really like in terms of like this resnet we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5053" target="_blank">01:24:13.440</a></span> | <span class="t">took the convnet and replaced it with a resnet so it's effectively twice as deep because each conv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5060" target="_blank">01:24:20.240</a></span> | <span class="t">block has two convolutions but resnets train better than convnets so surely we could go deeper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5069" target="_blank">01:24:29.840</a></span> | <span class="t">and wider still so i thought okay how could we go wider and i thought well let's take our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5083" target="_blank">01:24:43.120</a></span> | <span class="t">and previously we were going from eight up to 256 what if we could get up to 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5090" target="_blank">01:24:50.000</a></span> | <span class="t">and i thought okay well one way to do that would be to make our very first res block not have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5098" target="_blank">01:24:58.240</a></span> | <span class="t">kernel size of three but a kernel size of five so that means that each grid is going to be five by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5104" target="_blank">01:25:04.800</a></span> | <span class="t">five that's going to be 25 inputs so i think it's fair enough then to have 16 outputs so if i use a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5111" target="_blank">01:25:11.360</a></span> | <span class="t">kernel size of five 16 outputs then that means if i keep doubling as before i'm going to end up at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5118" target="_blank">01:25:18.000</a></span> | <span class="t">512 rather than 256 okay so that's the only change i made was to add k equals five here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5130" target="_blank">01:25:30.240</a></span> | <span class="t">and then change to double all the sizes um and so if i train that wow look at this 92.7 percent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5142" target="_blank">01:25:42.560</a></span> | <span class="t">so we're getting better still um and again it wasn't with lots of like trying and failing and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5151" target="_blank">01:25:51.040</a></span> | <span class="t">whatever it was just like saying well this just makes sense and the first thing i tried it just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5155" target="_blank">01:25:55.120</a></span> | <span class="t">it just worked you know we're just trying to use these sensible thoughtful approaches okay next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5162" target="_blank">01:26:02.160</a></span> | <span class="t">thing i'm going to try isn't necessarily something to make it better but it's something to make our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5166" target="_blank">01:26:06.640</a></span> | <span class="t">res net more flexible our current res net is a bit awkward in that the number of stride two layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5175" target="_blank">01:26:15.440</a></span> | <span class="t">has to be exactly big enough that the last of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5184" target="_blank">01:26:24.160</a></span> | <span class="t">that the last of them ends up with a one by one output so you can flatten it and do the linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5190" target="_blank">01:26:30.800</a></span> | <span class="t">so that's not very flexible because you know what if you've got something you know for different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5195" target="_blank">01:26:35.680</a></span> | <span class="t">size uh 28 by 28 is a pretty small image so to to kind of make that necessary i've created a get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5205" target="_blank">01:26:45.120</a></span> | <span class="t">model two um which goes less far it has one less layer so it only goes up to 256 despite starting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5213" target="_blank">01:26:53.920</a></span> | <span class="t">at 16 and so because it's got one less layer that means that it's going to end up at the two by two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5221" target="_blank">01:27:01.600</a></span> | <span class="t">not the one by one so what do we do um well we can do something very straightforward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5228" target="_blank">01:27:08.000</a></span> | <span class="t">which is we can take the mean over the two by two and so if we take the mean over the two by two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5236" target="_blank">01:27:16.560</a></span> | <span class="t">that's going to give us a mean over the two by two it's going to give us batch size by channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5243" target="_blank">01:27:23.360</a></span> | <span class="t">output which is what we can then put into our linear layer so this is called this ridiculously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5250" target="_blank">01:27:30.960</a></span> | <span class="t">simple thing is called a global average pooling layer and that's the that's the keras term uh in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5257" target="_blank">01:27:37.360</a></span> | <span class="t">pie torch it's basically the same it's called an adaptive average pooling layer um but in it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5263" target="_blank">01:27:43.440</a></span> | <span class="t">pie torch you can cause it to have an output other than one by one um but nobody ever really uses it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5271" target="_blank">01:27:51.360</a></span> | <span class="t">that way um so they're basically the same thing um this is actually a little bit more convenient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5276" target="_blank">01:27:56.080</a></span> | <span class="t">than the pie torch version because you don't have to flatten it um so this is global average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5281" target="_blank">01:28:01.680</a></span> | <span class="t">pooling so you can see here after our last res block which gives us a two by two output we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5287" target="_blank">01:28:07.280</a></span> | <span class="t">global average pool and that's just going to take the mean and then we can do the linear batch norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5295" target="_blank">01:28:15.120</a></span> | <span class="t">as usual so um i wanted to improve my summary patch to include not only the number of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5306" target="_blank">01:28:26.480</a></span> | <span class="t">but also the approximate number of mega flops so a flop is a floating operation per second a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5315" target="_blank">01:28:35.520</a></span> | <span class="t">floating point operation per second um i'm not going to promise my calculation is exactly right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5321" target="_blank">01:28:41.440</a></span> | <span class="t">i think the basic idea is right um i just basically actually calculated it's not really flops actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5328" target="_blank">01:28:48.000</a></span> | <span class="t">counted the number of multiplications um so this is not perfectly accurate but it's pretty indicative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5334" target="_blank">01:28:54.240</a></span> | <span class="t">i think um so this is the same summary i had before but i had an added an extra thing which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5340" target="_blank">01:29:00.160</a></span> | <span class="t">is a flops function where you pass in the weight matrix and the height and the width of your grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5347" target="_blank">01:29:07.840</a></span> | <span class="t">now if the number of dimensions of the weight matrix is less than three then we're just doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5354" target="_blank">01:29:14.560</a></span> | <span class="t">like a linear layer or something so actually just the number of elements is the number of flops</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5359" target="_blank">01:29:19.600</a></span> | <span class="t">because it's just a matrix multiply but if you're doing a convolution so the dimension is four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5367" target="_blank">01:29:27.440</a></span> | <span class="t">then you actually do that matrix multiply for everything in the height by width grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5372" target="_blank">01:29:32.400</a></span> | <span class="t">so that's how i calculate this kind of flops uh equivalent number so um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5380" target="_blank">01:29:40.480</a></span> | <span class="t">okay so if i run that on this model we can now see our number of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5392" target="_blank">01:29:52.320</a></span> | <span class="t">compared to the resnet model has gone from uh 1.2 million up to 4.9 million and the reason why is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5402" target="_blank">01:30:02.720</a></span> | <span class="t">because we've got this um we've got this res block it gets all the way up to 512 and the way we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5416" target="_blank">01:30:16.560</a></span> | <span class="t">this um is we made that a stride one layer um so that's why you can see here it's gone two two and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5424" target="_blank">01:30:24.560</a></span> | <span class="t">it stayed at two two so i wanted to make it as similar as possible to the last ones it's got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5428" target="_blank">01:30:28.480</a></span> | <span class="t">you know the same 512 final number of channels and so most of the parameters are in that last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5434" target="_blank">01:30:34.640</a></span> | <span class="t">block for the reason we just discussed um interestingly though it's not as clear for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5442" target="_blank">01:30:42.560</a></span> | <span class="t">the mega flops you know it it is the greatest of them but you know in terms of number of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5449" target="_blank">01:30:49.520</a></span> | <span class="t">i think this has more parameters than the other ones added together by a lot but that's not true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5453" target="_blank">01:30:53.840</a></span> | <span class="t">of mega flops and that's because this first layer has to be done 28 by 28 times whereas this layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5462" target="_blank">01:31:02.880</a></span> | <span class="t">only has to be done two by two times anyway so i tried uh training that uh and got pretty similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5471" target="_blank">01:31:11.120</a></span> | <span class="t">result 92.6 um and that kind of made me think oh let's fiddle around with this a little bit more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5479" target="_blank">01:31:19.520</a></span> | <span class="t">um to see like what kind of things would reduce the number of parameters and the mega flops</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5485" target="_blank">01:31:25.440</a></span> | <span class="t">the reason you care about reducing the number of parameters is that it has uh lower memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5490" target="_blank">01:31:30.400</a></span> | <span class="t">requirements and the reason you require want to reduce the number of flops is it's less compute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5500" target="_blank">01:31:40.160</a></span> | <span class="t">so in this case what i've done here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5504" target="_blank">01:31:44.880</a></span> | <span class="t">is i've removed this line of code so i've removed the line of code that takes it up to 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5517" target="_blank">01:31:57.040</a></span> | <span class="t">so that means we don't have this layer anymore and so the number of parameters has gone down from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5522" target="_blank">01:32:02.560</a></span> | <span class="t">4.9 million down to 1.2 million um not a huge impact on the mega flops but a huge impact on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5530" target="_blank">01:32:10.400</a></span> | <span class="t">the parameters we've reduced it by like two-thirds or three-quarters or something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5534" target="_blank">01:32:14.400</a></span> | <span class="t">by getting rid of that and you can see that the um if we take the very first resnet block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5548" target="_blank">01:32:28.560</a></span> | <span class="t">the number of parameters is you know um why is it this 5.3 mega flops it's because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5554" target="_blank">01:32:34.960</a></span> | <span class="t">although the very first one starts with just one channel the first conv remember our resnet blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5560" target="_blank">01:32:40.720</a></span> | <span class="t">have two comms so the second conv is going to be a 16 by 16 by 5 by 5 and again i'm partly doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5566" target="_blank">01:32:46.960</a></span> | <span class="t">this to show you the actual details of this architecture but i'm partly showing it so that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5571" target="_blank">01:32:51.200</a></span> | <span class="t">you can see how to investigate exactly what's going on in your models i really want you to try these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5578" target="_blank">01:32:58.240</a></span> | <span class="t">so if we train that one interestingly even though it's only a quarter or something of the size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5585" target="_blank">01:33:05.440</a></span> | <span class="t">we get the same accuracy 92.7</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5589" target="_blank">01:33:09.920</a></span> | <span class="t">so that's interesting um can we make it faster well at this point this is the obvious place to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5601" target="_blank">01:33:21.280</a></span> | <span class="t">look at is this first resnet block because that's where the mega flops are and as i said the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5607" target="_blank">01:33:27.280</a></span> | <span class="t">is because it's got two comms the second one is 16 by 16 um channels 16 channels in 16 channels out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5617" target="_blank">01:33:37.440</a></span> | <span class="t">and it's doing these five by five kernels um and it's having to do it across the whole 28 by 28</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5625" target="_blank">01:33:45.360</a></span> | <span class="t">grid so that's the bulk of the the biggest compute so what we could do is we could replace this res</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5633" target="_blank">01:33:53.600</a></span> | <span class="t">block with just one convolution um and if we do that then you'll see that we've now got rid of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5643" target="_blank">01:34:03.600</a></span> | <span class="t">the 16 by 16 by 5 by 5 we just got the 16 by 1 by 5 by 5 so the number of mega flops has gone down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5654" target="_blank">01:34:14.960</a></span> | <span class="t">from 18.3 to 13.3 the number of parameters hasn't really changed at all right because the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5662" target="_blank">01:34:22.800</a></span> | <span class="t">parameters was only 6 6 6 800 right so be very careful that when you see people talk about oh my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5670" target="_blank">01:34:30.160</a></span> | <span class="t">my model has less parameters that doesn't mean it's faster okay really doesn't necessarily i mean it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5675" target="_blank">01:34:35.760</a></span> | <span class="t">doesn't doesn't mean that at all there's no particular relationship between parameters and speed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5680" target="_blank">01:34:40.000</a></span> | <span class="t">even counting mega flops doesn't always work that well because it doesn't take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5685" target="_blank">01:34:45.120</a></span> | <span class="t">account of the amount of things moving through memory um but you know it's not a it's not a bad</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5693" target="_blank">01:34:53.840</a></span> | <span class="t">approximation here um so here's one which has got much less mega flops and in this case it's about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5702" target="_blank">01:35:02.000</a></span> | <span class="t">the same accuracy as well so i think this is really interesting we've managed to build a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5708" target="_blank">01:35:08.080</a></span> | <span class="t">that has far less parameters and far less mega flops and has basically exactly the same accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5716" target="_blank">01:35:16.400</a></span> | <span class="t">so i think that's a really important thing to keep in mind and remember this is still way better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5721" target="_blank">01:35:21.520</a></span> | <span class="t">than the resnet 18d from tim um so we've built something that is fast small and accurate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5734" target="_blank">01:35:34.160</a></span> | <span class="t">so the obvious question is what if we train for longer and the answer is if we train for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5739" target="_blank">01:35:39.600</a></span> | <span class="t">longer if we train for 20 epochs i'm not going to wait for have you wait for it the training accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5745" target="_blank">01:35:45.280</a></span> | <span class="t">gets up to 0.999 but the validation accuracy is worse it's 0.924 um and the reason for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5757" target="_blank">01:35:57.360</a></span> | <span class="t">is that after 20 epochs it's seen the same picture so many times it's just memorizing them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5763" target="_blank">01:36:03.360</a></span> | <span class="t">and so once you start memorizing things actually go downhill</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5767" target="_blank">01:36:07.280</a></span> | <span class="t">so we need to regularize now something that we have claimed in the past can regularize is to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5776" target="_blank">01:36:16.480</a></span> | <span class="t">weight decay but here's where i'm going to point out that weight decay doesn't regularize at all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5782" target="_blank">01:36:22.800</a></span> | <span class="t">if you use batch norm um and it's fascinating for years people didn't even seem to notice this and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5789" target="_blank">01:36:29.360</a></span> | <span class="t">then somebody i think finally wrote a paper that pointed this out and people like oh wow that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5793" target="_blank">01:36:33.760</a></span> | <span class="t">weird um but it's really obvious when you think about it a batch norm layer has a single set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5801" target="_blank">01:36:41.760</a></span> | <span class="t">coefficients which multiplies an entire layer right so that set of coefficients could just be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5809" target="_blank">01:36:49.600</a></span> | <span class="t">you know the number 100 in every place and that's going to multiply the entire previous weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5816" target="_blank">01:36:56.240</a></span> | <span class="t">matrix you know a convolution kernel matrix by 100 as far as weight decay is concerned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5824" target="_blank">01:37:04.000</a></span> | <span class="t">that's not much of an impact at all because the batch norm layer has very few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5829" target="_blank">01:37:09.120</a></span> | <span class="t">weights so it doesn't really have a huge impact on weight decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5833" target="_blank">01:37:13.600</a></span> | <span class="t">but it massively increases the effective scale of the weight matrix so batch norm basically lets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5843" target="_blank">01:37:23.280</a></span> | <span class="t">the the neural net cheat by increasing the coefficients the parameters even nearly as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5851" target="_blank">01:37:31.520</a></span> | <span class="t">much as it wants indirectly just by changing the batch norm layers weights so weight decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5858" target="_blank">01:37:38.960</a></span> | <span class="t">is not going to save us um and that's something really important to recognize weight decay is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5866" target="_blank">01:37:46.640</a></span> | <span class="t">i mean with batch norm layers i don't see the point of it at all it does have some like there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5873" target="_blank">01:37:53.040</a></span> | <span class="t">has been some studies of what it does and it does have some weird kind of second order effects on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5878" target="_blank">01:37:58.160</a></span> | <span class="t">the learning rate but i don't think you should rely on them you should use a scheduler for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5882" target="_blank">01:38:02.080</a></span> | <span class="t">changing the learning rate rather than weird second order effects caused by weight decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5885" target="_blank">01:38:05.760</a></span> | <span class="t">so instead we're going to do data augmentation which is where we're going to modify every image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5893" target="_blank">01:38:13.040</a></span> | <span class="t">a little bit by random change so that it doesn't see the same image each time so there's not any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5903" target="_blank">01:38:23.520</a></span> | <span class="t">particular reason to implement these from scratch to be honest we have implemented them all from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5909" target="_blank">01:38:29.360</a></span> | <span class="t">scratch in fastai so you can certainly look them up if you're interested but it's actually a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5916" target="_blank">01:38:36.000</a></span> | <span class="t">bit separate to what we're meant to be learning about so i'm not going to go through it but yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5921" target="_blank">01:38:41.200</a></span> | <span class="t">if you're interested go into fastai vision augment and you'll be able to see for example how do we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5931" target="_blank">01:38:51.440</a></span> | <span class="t">do flip and you know it's just like x dot transpose okay which is not really yeah it's not that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5940" target="_blank">01:39:00.880</a></span> | <span class="t">interesting yeah how do we do cropping and padding how do we do random crops so on and so forth okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5954" target="_blank">01:39:14.080</a></span> | <span class="t">so we're just going to actually you know fastai has probably got the best implementation of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5958" target="_blank">01:39:18.240</a></span> | <span class="t">but torch visions are fine so we'll just use them and so we've created before a batch transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5974" target="_blank">01:39:34.240</a></span> | <span class="t">callback and we used it for normalization if you remember so what we could do is we could create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5985" target="_blank">01:39:45.360</a></span> | <span class="t">transform batch function which transforms the inputs and transforms the outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5994" target="_blank">01:39:54.800</a></span> | <span class="t">using two different functions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=5998" target="_blank">01:39:58.400</a></span> | <span class="t">so that would be an augmentation callback and so then you would say okay for the transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6005" target="_blank">01:40:05.440</a></span> | <span class="t">batch function for example in this case we want to transform our x's and how do we want to transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6010" target="_blank">01:40:10.800</a></span> | <span class="t">our x's and the answer is we want to transform them using this module which is a sequential</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6020" target="_blank">01:40:20.880</a></span> | <span class="t">module or first of all doing a random crop and then a random horizontal flip now it seems weird</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6027" target="_blank">01:40:27.920</a></span> | <span class="t">to randomly crop a 28 by 28 image to get a 28 by 28 image but we can add padding to it and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6034" target="_blank">01:40:34.160</a></span> | <span class="t">effectively it's going to randomly add padding on one or both sides to do this kind of random crop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6040" target="_blank">01:40:40.720</a></span> | <span class="t">one thing i did to to change the batch transform callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6044" target="_blank">01:40:44.080</a></span> | <span class="t">i can't remember if i've mentioned this before but something i changed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6049" target="_blank">01:40:49.760</a></span> | <span class="t">slightly since we first wrote it is i added this untrain and on validate so that it only does it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6058" target="_blank">01:40:58.240</a></span> | <span class="t">if you said i want to do it on training and it's training or i want to do it on validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6063" target="_blank">01:41:03.120</a></span> | <span class="t">and it's not training and then this is this is all the code is um so um data augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6072" target="_blank">01:41:12.080</a></span> | <span class="t">generally speaking shouldn't be done on validation so he said on validation false okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6079" target="_blank">01:41:19.520</a></span> | <span class="t">what i'm going to do first of all is i'm going to use our classic single batch cb trick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6089" target="_blank">01:41:29.840</a></span> | <span class="t">and um fit in fact even better oh yeah fit fit one uh just doing training um and what i'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6098" target="_blank">01:41:38.880</a></span> | <span class="t">to do then is after i fit i can grab the batch out of the learner and this is a way this is quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6107" target="_blank">01:41:47.680</a></span> | <span class="t">cool right this is a way that i can see exactly what the model sees right so this is not relying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6114" target="_blank">01:41:54.720</a></span> | <span class="t">on on any you know approximations remember when we fit it puts it in the batch that it looks at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6122" target="_blank">01:42:02.480</a></span> | <span class="t">into learn.batch so if we fit for a single batch we can then grab that batch back out of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6128" target="_blank">01:42:08.880</a></span> | <span class="t">and we can call show images and so here you can see this little crop it's added now something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6137" target="_blank">01:42:17.840</a></span> | <span class="t">you'll notice is that every single image in this batch notice grab the first 16 so i don't want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6141" target="_blank">01:42:21.840</a></span> | <span class="t">show you 1024 has exactly the same augmentation and that makes sense right because we're applying a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6151" target="_blank">01:42:31.680</a></span> | <span class="t">batch transform now why is this good and why is it bad it's good because this is running on the GPU</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6160" target="_blank">01:42:40.080</a></span> | <span class="t">right which is great because nowadays very often it's really hard to get enough cpu to feed your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6168" target="_blank">01:42:48.560</a></span> | <span class="t">fast GPU fast enough particularly if you use something like kaggle or colab that are really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6173" target="_blank">01:42:53.600</a></span> | <span class="t">underpowered for cpu particularly kaggle um so this way all of our transformations all of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6178" target="_blank">01:42:58.560</a></span> | <span class="t">augmentation is happening on the GPU um on the downside it means that there's a little bit less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6186" target="_blank">01:43:06.480</a></span> | <span class="t">variety every mini batch has the same augmentation i don't think the downside matters though because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6191" target="_blank">01:43:11.760</a></span> | <span class="t">it's going to see lots of mini batches so the fact that each mini batch is going to have a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6196" target="_blank">01:43:16.080</a></span> | <span class="t">augmentation is actually all i care about so we can see that if we run this multiple times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6202" target="_blank">01:43:22.000</a></span> | <span class="t">you can see it's got a different augmentation in each mini batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6207" target="_blank">01:43:27.040</a></span> | <span class="t">um okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6211" target="_blank">01:43:31.600</a></span> | <span class="t">i decided actually i'm just going to use one padding so i'm just going to do a very very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6217" target="_blank">01:43:37.920</a></span> | <span class="t">small amount of data augmentation and i'm going to do 20 epochs using one cycle learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6226" target="_blank">01:43:46.160</a></span> | <span class="t">um and so this takes quite a while to train so we won't watch it but check this out we get to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6235" target="_blank">01:43:55.280</a></span> | <span class="t">93.8 that's pretty wild um yeah that's pretty wild so um i actually went on twitter and i said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6251" target="_blank">01:44:11.760</a></span> | <span class="t">to the entire world on twitter you know which if you're watching this in 2023 if twitter doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6258" target="_blank">01:44:18.960</a></span> | <span class="t">exist yet ask somebody tell you about what twitter used to be it still does um uh can anybody beat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6266" target="_blank">01:44:26.080</a></span> | <span class="t">this in 20 epochs you can use any model you like uh any library you like and nobody's got anywhere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6274" target="_blank">01:44:34.960</a></span> | <span class="t">close um so this is um this is pretty amazing and actually you know when i had a look at papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6284" target="_blank">01:44:44.160</a></span> | <span class="t">with code there are you know well i mean you can see it's right up there right with the kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6292" target="_blank">01:44:52.080</a></span> | <span class="t">best models that are listed certainly better than these ones um and the the better models all use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6300" target="_blank">01:45:00.800</a></span> | <span class="t">you know 250 or more epochs um so yeah if anybody i i'm hoping that some somebody watching this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6311" target="_blank">01:45:11.360</a></span> | <span class="t">will find a way to beat this in 20 epochs that would be really great because as you can see we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6316" target="_blank">01:45:16.240</a></span> | <span class="t">haven't really done anything very amazingly weirdly clever it's all very very basic um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6323" target="_blank">01:45:23.440</a></span> | <span class="t">and actually we can uh go even a bit further than 93.8 um um just before we do i mentioned that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6332" target="_blank">01:45:32.560</a></span> | <span class="t">since this is actually taking a while to train now i can't remember it takes like 10 to 15 seconds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6338" target="_blank">01:45:38.480</a></span> | <span class="t">per epoch so you know you're waiting a few minutes you may as well save it so you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6344" target="_blank">01:45:44.800</a></span> | <span class="t">just call torch.save on a model and then you can load that back later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6354" target="_blank">01:45:54.400</a></span> | <span class="t">um so something that can um make things even better is something called test time augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6362" target="_blank">01:46:02.720</a></span> | <span class="t">i guess i should write this out properly here test text test time augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6374" target="_blank">01:46:14.240</a></span> | <span class="t">um now test time augmentation actually does our batch transform callback on validation as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6382" target="_blank">01:46:22.560</a></span> | <span class="t">and then what we're going to do is we're actually in this case we're going to do just a very very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6389" target="_blank">01:46:29.680</a></span> | <span class="t">very simple test time augmentation which is we're going to um add a batch transform callback that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6396" target="_blank">01:46:36.880</a></span> | <span class="t">runs on validate and it's not random but it actually just does a horizontal flip non-random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6404" target="_blank">01:46:44.320</a></span> | <span class="t">so it always does a horizontal flip and so check this out what we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6407" target="_blank">01:46:47.760</a></span> | <span class="t">is we're going to create a new callback called capture preds um and after each batch it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6415" target="_blank">01:46:55.840</a></span> | <span class="t">going to append to a list the predictions and it's going to append to a different list the targets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6424" target="_blank">01:47:04.000</a></span> | <span class="t">and that way we can just call learn.fit train equals false and it will show us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6430" target="_blank">01:47:10.480</a></span> | <span class="t">the accuracy okay and this is just the same number that we saw before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6435" target="_blank">01:47:15.920</a></span> | <span class="t">but then what we can do is we can call that the same thing but this time with a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6441" target="_blank">01:47:21.520</a></span> | <span class="t">callback which is with the horizontal flip callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6450" target="_blank">01:47:30.320</a></span> | <span class="t">and that way it's going to do exactly the same thing as before but in every time it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6454" target="_blank">01:47:34.160</a></span> | <span class="t">do a horizontal flip and weirdly enough that accuracy is slightly higher which that's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6459" target="_blank">01:47:39.040</a></span> | <span class="t">the interesting bit the interesting bit is that we've now got two sets of predictions we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6465" target="_blank">01:47:45.680</a></span> | <span class="t">the sets of predictions with the non-flipped version we've got the set of predictions with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6470" target="_blank">01:47:50.080</a></span> | <span class="t">the flipped version and what we could do is we could stack those together and take the mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6479" target="_blank">01:47:59.280</a></span> | <span class="t">so we're going to take the average of the flipped and unflipped predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6482" target="_blank">01:48:02.480</a></span> | <span class="t">and that gives us a better result still 94.2 percent so why is it better it's because looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6493" target="_blank">01:48:13.440</a></span> | <span class="t">at the image from kind of like multiple different directions gives it more opportunities to try to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6499" target="_blank">01:48:19.360</a></span> | <span class="t">understand what this is a picture of and so in this case i'm just giving it two different directions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6503" target="_blank">01:48:23.440</a></span> | <span class="t">which is the flipped and unflipped version and then just taking their average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6509" target="_blank">01:48:29.760</a></span> | <span class="t">so yeah this is like a really nice little trick. Sam's pointed out it's a bit like random forests</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6523" target="_blank">01:48:43.120</a></span> | <span class="t">which is true it's a kind of bagging that we're doing we're kind of getting multiple predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6527" target="_blank">01:48:47.840</a></span> | <span class="t">and bringing them together and so we can actually so 94.2 i think is my best 20 epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6540" target="_blank">01:49:00.960</a></span> | <span class="t">result and notice i didn't have to do any additional training so it still counts as a 20 epoch result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6547" target="_blank">01:49:07.360</a></span> | <span class="t">you can do test time augmentation where you do you know a much wider range of different augmentations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6554" target="_blank">01:49:14.560</a></span> | <span class="t">that you trained with and then you can use them at test time as well you know more more crops or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6559" target="_blank">01:49:19.600</a></span> | <span class="t">rotations or warps or whatever i want to show you one of my favorite data augmentation approaches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6566" target="_blank">01:49:26.560</a></span> | <span class="t">which is called random erasing um so random erasing i'll show you what it's going to look like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6574" target="_blank">01:49:34.000</a></span> | <span class="t">random erasing we're going to add a little we're going to basically delete a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6582" target="_blank">01:49:42.880</a></span> | <span class="t">of each picture and we're going to replace it with some random Gaussian noise now in this case we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6589" target="_blank">01:49:49.440</a></span> | <span class="t">just got one patch but eventually we're going to do more than one patch so i wanted to implement</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6595" target="_blank">01:49:55.760</a></span> | <span class="t">this because remember we have to implement everything from scratch and this one's a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6599" target="_blank">01:49:59.520</a></span> | <span class="t">less trivial than the previous transforms so we should do it from scratch and also not sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6605" target="_blank">01:50:05.200</a></span> | <span class="t">there's that many good implementations ross whiteman's tem i think has one and so and it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6610" target="_blank">01:50:10.240</a></span> | <span class="t">also a very good exercise to see how to implement this from scratch um so let's grab a batch out of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6617" target="_blank">01:50:17.920</a></span> | <span class="t">the training set um and let's just grab the first 16 images and so then let's grab the mean and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6626" target="_blank">01:50:26.080</a></span> | <span class="t">standard deviation okay and so what we want to do is we wanted to delete a patch from each image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6636" target="_blank">01:50:36.080</a></span> | <span class="t">but rather than deleting it deleting it would change the statistics right if we set those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6642" target="_blank">01:50:42.240</a></span> | <span class="t">order zero the mean and standard deviation and now not going to be zero one anymore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6647" target="_blank">01:50:47.120</a></span> | <span class="t">but if we replace them with exactly the same mean and standard deviation pixels that the picture has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6654" target="_blank">01:50:54.960</a></span> | <span class="t">or that our data set has then it won't change the statistics so that's why we've grabbed the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6661" target="_blank">01:51:01.120</a></span> | <span class="t">mean and standard deviation and so we could then try grabbing let's say we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6666" target="_blank">01:51:06.240</a></span> | <span class="t">delete 0.2 so 20 percent of the height and width</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6671" target="_blank">01:51:11.440</a></span> | <span class="t">then let's find out how big that size is so 0.2 of the shape of the height and of the width that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6680" target="_blank">01:51:20.720</a></span> | <span class="t">the size of the x and y and then the starting point we're just going to randomly grab some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6687" target="_blank">01:51:27.040</a></span> | <span class="t">starting point right so in this case we've got the starting point for x is 14 starting point for y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6694" target="_blank">01:51:34.080</a></span> | <span class="t">is zero and then it's going to be a five by five spot and then we're going to do a Gaussian or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6700" target="_blank">01:51:40.800</a></span> | <span class="t">normal initialization of our mini batch everything in the batch every channel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6706" target="_blank">01:51:46.480</a></span> | <span class="t">for this x slice this y slice and we're going to initialize it with this mean and standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6716" target="_blank">01:51:56.720</a></span> | <span class="t">normal random noise and so that's what this is so it's just that tiny little bit of code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6723" target="_blank">01:52:03.920</a></span> | <span class="t">so you'll see i don't start by writing a function i start by writing single lines of code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6731" target="_blank">01:52:11.600</a></span> | <span class="t">that i can run independently and make sure that they all work and that i look at the pictures and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6736" target="_blank">01:52:16.160</a></span> | <span class="t">make sure it's working now one thing that's wrong here is that you see how the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6741" target="_blank">01:52:21.440</a></span> | <span class="t">you know this looks black and this looks gray now first this was confusing me as to what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6746" target="_blank">01:52:26.000</a></span> | <span class="t">going on what's it changed because the original images didn't look like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6749" target="_blank">01:52:29.680</a></span> | <span class="t">and i realized the problem is that the minimum and the maximum have changed it used to be from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6755" target="_blank">01:52:35.520</a></span> | <span class="t">negative point eight to two that was the previous min and max now it goes from negative three to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6761" target="_blank">01:52:41.680</a></span> | <span class="t">three so the noise we've added has the same mean and standard deviation but it doesn't have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6769" target="_blank">01:52:49.600</a></span> | <span class="t">same range because the pixels were not normally distributed originally so normally distributed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6775" target="_blank">01:52:55.600</a></span> | <span class="t">noise actually is wrong so to fix that i created a new version and i'm putting in a function now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6783" target="_blank">01:53:03.440</a></span> | <span class="t">does all the same stuff as before as i just did before but it clamps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6789" target="_blank">01:53:09.760</a></span> | <span class="t">the random pixels to be between min and max and so it's going to be exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6798" target="_blank">01:53:18.560</a></span> | <span class="t">but it's going to make sure that it doesn't change the the range that's really important i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6805" target="_blank">01:53:25.280</a></span> | <span class="t">because changing the range really impacts your you know your activations quite a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6810" target="_blank">01:53:30.000</a></span> | <span class="t">so here's what that looks like and so as you can see now all of the backgrounds have that nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6815" target="_blank">01:53:35.680</a></span> | <span class="t">black and it's still giving me random pixels and i can check and because i've done the clamping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6824" target="_blank">01:53:44.000</a></span> | <span class="t">you know and stuff the main and standard deviation aren't quite zero one but they're very very close</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6827" target="_blank">01:53:47.840</a></span> | <span class="t">so i'm going to call that good enough and of course the min and max haven't changed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6832" target="_blank">01:53:52.000</a></span> | <span class="t">because i clamped them to ensure they didn't change so that's my random erasing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6835" target="_blank">01:53:55.840</a></span> | <span class="t">so that randomly erases one block and so i could create a random erase which will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6842" target="_blank">01:54:02.960</a></span> | <span class="t">randomly choose up to in this case four blocks so with that function oh that's annoying it happened</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6854" target="_blank">01:54:14.000</a></span> | <span class="t">to be zero this time okay i'll just run it again this time it's got three so that's good so you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6861" target="_blank">01:54:21.920</a></span> | <span class="t">see it's got oh maybe that's four one two three four blocks okay so that's what this data augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6870" target="_blank">01:54:30.000</a></span> | <span class="t">looks like so we can create a class to do this data augmentation so you'll pass in what percentage</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6879" target="_blank">01:54:39.120</a></span> | <span class="t">to do in each block what the maximum number of blocks to have is store that away and then in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6885" target="_blank">01:54:45.600</a></span> | <span class="t">the forward we're just going to call our random arrays function passing in the input and passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6889" target="_blank">01:54:49.840</a></span> | <span class="t">in the parameters great so now we can use random crop random flip and random rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6907" target="_blank">01:55:07.360</a></span> | <span class="t">make sure it looks okay and so now we're going to go all the way up to 50 epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6911" target="_blank">01:55:11.280</a></span> | <span class="t">and so if i run this for 50 epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6916" target="_blank">01:55:16.000</a></span> | <span class="t">i get 94.6 isn't that crazy um so we're really right up there now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6929" target="_blank">01:55:29.120</a></span> | <span class="t">up we're even above this one so we're somewhere up here and this is like stuff people write papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6935" target="_blank">01:55:35.920</a></span> | <span class="t">about from 2019 2020 oh look here's the random erasing paper that's cool um so they were way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6946" target="_blank">01:55:46.160</a></span> | <span class="t">ahead of their time in 2017 but yeah that would have uh trained for a lot longer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6950" target="_blank">01:55:50.640</a></span> | <span class="t">now i was having a think and i realized something which is like why like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6963" target="_blank">01:56:03.920</a></span> | <span class="t">how do we actually get the correct distribution right like in some ways it shouldn't matter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6969" target="_blank">01:56:09.600</a></span> | <span class="t">but i was kind of like bothered by this thing of like well we don't actually end up with zero one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6973" target="_blank">01:56:13.600</a></span> | <span class="t">and there's kind of like clamping it all feels a bit weird like how do we actually replace these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6980" target="_blank">01:56:20.000</a></span> | <span class="t">pixels with something that is guaranteed to be the correct distribution and i realized there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6985" target="_blank">01:56:25.840</a></span> | <span class="t">actually a very simple answer to this which is we could copy another part of the picture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6991" target="_blank">01:56:31.600</a></span> | <span class="t">over to here if we copy part of the picture we're guaranteed to have the correct distribution of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=6997" target="_blank">01:56:37.120</a></span> | <span class="t">pixels and so it wouldn't exactly be random erasing anymore that would be random copying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7002" target="_blank">01:56:42.160</a></span> | <span class="t">now i'm sure somebody else has invented this i mean you know um i'm not saying this nobody's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7010" target="_blank">01:56:50.320</a></span> | <span class="t">ever thought of this before um so if anybody has knows a paper that's done this please tell me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7014" target="_blank">01:56:54.960</a></span> | <span class="t">about it um but i you know i think it's um it's a very sensible approach um and it's very very easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7026" target="_blank">01:57:06.800</a></span> | <span class="t">to implement so again we're going to implement it all manually right so that's great get our x mini</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7030" target="_blank">01:57:10.880</a></span> | <span class="t">batch and let's get our again our size and again let's get the x y that we're going to be erasing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7040" target="_blank">01:57:20.960</a></span> | <span class="t">by this time we're not erasing they're copying so we'll then randomly get a different x y to copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7044" target="_blank">01:57:24.960</a></span> | <span class="t">from and so now it's just instead of in a random noise we just say replace this slice of the batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7052" target="_blank">01:57:32.960</a></span> | <span class="t">with this slice of the batch and we end up with you know you can see here it's kind of copied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7061" target="_blank">01:57:41.440</a></span> | <span class="t">little bits across some of them you can't really see at all and some of you can because i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7067" target="_blank">01:57:47.200</a></span> | <span class="t">some of them are black and it's replaced black but i guess it's knocked off the end of this shoe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7070" target="_blank">01:57:50.880</a></span> | <span class="t">added a little bit extra here a little bit extra here um so we can now again we turn it into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7076" target="_blank">01:57:56.720</a></span> | <span class="t">function once i've tested it in the ripple make sure the function works and obviously this in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7084" target="_blank">01:58:04.400</a></span> | <span class="t">this case it's copying it largely from something that's largely black for a lot of them and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7090" target="_blank">01:58:10.320</a></span> | <span class="t">again we can do the thing where we do it multiple times and here we go now it's got a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7099" target="_blank">01:58:19.840</a></span> | <span class="t">random copies and so again turn that into a class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7104" target="_blank">01:58:24.400</a></span> | <span class="t">create our transforms and again we okay so again we can have a look at a batch to make sure it looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7114" target="_blank">01:58:34.000</a></span> | <span class="t">sensible and do it for just do it for 25 epochs here and gets to 94 percent um now why did i do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7132" target="_blank">01:58:52.800</a></span> | <span class="t">it for 25 epochs because i was trying to think about how do i beat my 50 epoch record which was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7139" target="_blank">01:58:59.840</a></span> | <span class="t">94.6 and i thought well what i could do is i could train for 25 epochs and then i'll train a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7148" target="_blank">01:59:08.800</a></span> | <span class="t">new model for a different 25 epochs and i'm going to put it a different learner learn2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7154" target="_blank">01:59:14.240</a></span> | <span class="t">right this one is 94.1 so one of the models was 94.1 one of them was 94 maybe you can guess what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7163" target="_blank">01:59:23.760</a></span> | <span class="t">we're going to do next it's a bit like test time augmentation but rather than that we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7169" target="_blank">01:59:29.360</a></span> | <span class="t">grab the predictions of our first learner and grab the predictions of our second learner and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7179" target="_blank">01:59:39.600</a></span> | <span class="t">stack them up and take their mean and this is called ensembling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7185" target="_blank">01:59:45.120</a></span> | <span class="t">and not surprisingly the ensemble is better than either of the two individual models at 94.4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7195" target="_blank">01:59:55.760</a></span> | <span class="t">although unfortunately i'm afraid to say we didn't beat our best but it's a useful trick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7203" target="_blank">02:00:03.920</a></span> | <span class="t">and particularly useful trick in this case i was kind of like trying something a bit interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7209" target="_blank">02:00:09.280</a></span> | <span class="t">to see if using the exact same number of epochs can i get a better result by using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7214" target="_blank">02:00:14.400</a></span> | <span class="t">ensembling instead of training for longer and the answer was i couldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7219" target="_blank">02:00:19.040</a></span> | <span class="t">maybe it's because the random copy is not as good or maybe i'm using too much augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7224" target="_blank">02:00:24.880</a></span> | <span class="t">who knows but it's something that you could experiment with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7228" target="_blank">02:00:28.320</a></span> | <span class="t">so shall one mentions in the chat that cut mix is similar to this which is actually that's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7237" target="_blank">02:00:37.200</a></span> | <span class="t">good point i'd forgotten cut mix but cut mix yes copies it from different images rather than from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7242" target="_blank">02:00:42.640</a></span> | <span class="t">the same image but yeah it's pretty much the same thing i guess ish well similar yeah very similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7254" target="_blank">02:00:54.560</a></span> | <span class="t">all right so that brings us to the end of the lesson and you know i am</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7260" target="_blank">02:01:00.480</a></span> | <span class="t">yeah so pumped and excited to share this with you because you know i don't know that this has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7268" target="_blank">02:01:08.560</a></span> | <span class="t">never been done before you know to be able to to go from from i mean even in our previous courses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7273" target="_blank">02:01:13.680</a></span> | <span class="t">we've never done this before go from scratch step by step to an absolute state-of-the-art model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7281" target="_blank">02:01:21.040</a></span> | <span class="t">where we build everything ourselves and it runs this quickly and we're even using our own custom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7287" target="_blank">02:01:27.360</a></span> | <span class="t">resnet and everything you know just using common sense at every stage and so hopefully that shows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7296" target="_blank">02:01:36.320</a></span> | <span class="t">that deep learning is not magic you know that we can actually build the pieces ourselves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7305" target="_blank">02:01:45.680</a></span> | <span class="t">and yeah as you'll see going up to larger data sets absolutely nothing changes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7312" target="_blank">02:01:52.880</a></span> | <span class="t">and so it's exactly these techniques and this is actually i do 99 percent of my research on very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7321" target="_blank">02:02:01.200</a></span> | <span class="t">small data sets because you can iterate much more quickly you can understand them much better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7326" target="_blank">02:02:06.400</a></span> | <span class="t">and i don't think there's ever been a time where i've then gone up to a bigger data set and my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7330" target="_blank">02:02:10.800</a></span> | <span class="t">findings didn't continue to hold true now homework what i would really like you to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7339" target="_blank">02:02:19.280</a></span> | <span class="t">is to actually do the thing that i didn't do which is to do the create your own</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7351" target="_blank">02:02:31.280</a></span> | <span class="t">um create your own schedulers that work with python's optimizers so i mean it's the tricky</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7362" target="_blank">02:02:42.960</a></span> | <span class="t">bit we'll be making sure that you understand the pytorch api well which i've really laid out here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7369" target="_blank">02:02:49.840</a></span> | <span class="t">so study this carefully so create your own cosine annealing scheduler from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7378" target="_blank">02:02:58.240</a></span> | <span class="t">and then create your own one cycle scheduler from scratch and make sure that they work correctly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7387" target="_blank">02:03:07.360</a></span> | <span class="t">with this batch scheduler callback this will be a very good exercise for you in you know hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7396" target="_blank">02:03:16.000</a></span> | <span class="t">getting extremely frustrated as things don't work the way you hope they would and being mystified</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7402" target="_blank">02:03:22.560</a></span> | <span class="t">for a while and then working through it you know using this very step-by-step approach lots of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7407" target="_blank">02:03:27.680</a></span> | <span class="t">experimentation lots of exploration and then figuring it out um that's that's the journey</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7413" target="_blank">02:03:33.680</a></span> | <span class="t">i'm hoping you you have if it's all super easy and and you get it first go then you know you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7420" target="_blank">02:03:40.720</a></span> | <span class="t">have to find something else to do um but um yeah i'm i'm hoping you'll find it actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7426" target="_blank">02:03:46.640</a></span> | <span class="t">you know surprisingly tricky to get it all working properly and in the process of doing so you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7432" target="_blank">02:03:52.640</a></span> | <span class="t">going to have to do a lot of exploration and experimentation but you'll realize that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7437" target="_blank">02:03:57.040</a></span> | <span class="t">requires no um like prerequisite knowledge at all okay so um if it doesn't work first time it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7446" target="_blank">02:04:06.640</a></span> | <span class="t">because there's something that you didn't learn in graduate school if only you had done a phd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7450" target="_blank">02:04:10.720</a></span> | <span class="t">whatever it's just that you need to dig through you know slowly and carefully to see how it all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7456" target="_blank">02:04:16.240</a></span> | <span class="t">works um and you know then see how neat and concise you can get it um then the other homework</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7464" target="_blank">02:04:24.880</a></span> | <span class="t">is to try and beat me um i really really want people to beat me uh try to beat me on the 5 epoc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7471" target="_blank">02:04:31.760</a></span> | <span class="t">or the 20 epoc or the 50 epoc fashion eminist um ideally using um mini ai uh with things that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7484" target="_blank">02:04:44.000</a></span> | <span class="t">you've added yourself um uh but you know you can try grabbing other libraries if you like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7493" target="_blank">02:04:53.760</a></span> | <span class="t">well ideally if you do grab another library and you find you can beat my approach try to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7498" target="_blank">02:04:58.720</a></span> | <span class="t">re-implement that library um that way you are um still within the spirit of the game</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7507" target="_blank">02:05:07.200</a></span> | <span class="t">okay so in our next lesson um uh jonno and tanish and i are going to be putting this all together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7516" target="_blank">02:05:16.320</a></span> | <span class="t">to um create a diffusion model from scratch and we're actually going to be taking a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7524" target="_blank">02:05:24.400</a></span> | <span class="t">lessons for this i'm not just a diffusion model but a variety of of interesting generative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7530" target="_blank">02:05:30.160</a></span> | <span class="t">approaches um so we've kind of starting to come um full circle so thank you um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7538" target="_blank">02:05:38.640</a></span> | <span class="t">so much for joining me on this very extensive journey and um i look forward to hearing what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=nlVOG2Nzc3k&t=7546" target="_blank">02:05:46.560</a></span> | <span class="t">you come up with please do come and join us on forums.fast.ai and share your your progress bye</span></div></div></body></html>