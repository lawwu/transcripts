<html><head><title>2+2=5 in Java</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">Back to Index</a><h2>2+2=5 in Java</h2><a href="https://www.youtube.com/watch?v=amXXYgu0eFY" target="_blank"><img src="https://i.ytimg.com/vi_webp/amXXYgu0eFY/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Transcript</h3><div class='max-width'><p>This video is about how we can hack Java by using reflection of its own source code to make this 2+2 statement, output 5. Just as George Orwell, one of my favorite writers, warned us about in 1984, about propaganda machines that sublimate the nature of truth. This video is not about politics, philosophy, nor is it about the apparent, as I have just learned, woke Twitter madness around 2+2=5.</p><p>Though perhaps if we're living in the simulation and it's written in Java, this might be a way to make the simulation just a bit more dystopian. So here's what the full source code looks like, and it uses Java's ability to do reflection, which is the ability of a programming language to inspect itself.</p><p>So if we look at the code, it actually dives into the implementation of the integer class, pulls out the integer cache class from that implementation, makes it accessible and writable, pulls it into an array of integer object of size 256, and modifies that array. Now what does this array contain?</p><p>So interestingly, if we look at the integer cache class inside the integer object implementation in Java, it defines a hard-coded low of -128 and a high that's passed in as a parameter, that's 127 as a default. And what that does is create a cache of integer objects from -128 to 127, and then reuses this cache every time an integer object with a value in this range is used.</p><p>This is exactly the cache with reflection that we pull out and modify. It so happens that the 132nd element in the cache is where the 4 resides, and so by way of obfuscation, it takes the 133rd element, which has the number 5 in it, and it sizes it to 132nd, but you can just assign value 5 here.</p><p>And then the result, and you are else in the code, if you use integer objects and the number 4 comes up, it will instead output the number 5. There you go, 2+2=5. Check out the link in the description that points to the Stack Exchange Code Golf, has a bunch of interesting discussions around this, including the possibility of taking the entire 256 element array and shuffling it, thereby not only making 2+2=5, but messing with the entirety of low value arithmetic in Java.</p><p>So there you go, that's how you hack the simulation. Let me quickly thank the sponsors that somehow amazingly support the podcast and the videos I make. This time it's Asleep Mattress, click the link to get a discount in the description. And by the way, I have a conversation with James Gosling, the creator of Java, coming up on the podcast, so check that out.</p><p>And remember, try to learn something new every day. Bye!</p></div></div></body></html>