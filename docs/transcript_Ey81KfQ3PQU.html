<html><head><title>Sentence Similarity With Sentence-Transformers in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">Back to Index</a><h2>Sentence Similarity With Sentence-Transformers in Python</h2><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU" target="_blank"><img src="https://i.ytimg.com/vi/Ey81KfQ3PQU/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=0 target="_blank"">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=120 target="_blank"">2:0</a> initialize a sentence transformer model<br><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=160 target="_blank"">2:40</a> create our sentence vectors or sentence embeddings<br><a href="https://www.youtube.com/watch?v=Ey81KfQ3PQU&t=254 target="_blank"">4:14</a> calculate our cosine similarity<br><h3>Transcript</h3><div class='max-width'><p>I welcome to this video on using the sentence transformers library to compare similarity between different sentences. So this is going to be a pretty short video, I'm not going to go really into depth, I'm just going to show you how to actually use the library. Now if you do want to go into a little more depth, I have another video that I'll be releasing just before this one and that will go into what is actually happening here, how we are calculating similarity or pulling how the BERT model that we'll be using is actually creating those embeddings and then how we're actually calculating similarity there.</p><p>So if you're interested in that, go check it out. Otherwise, if you just want to get a quick similarity score between two sentences, this is probably the way to go. So we have these six sentences up here and this one, three years later the coffin was still full of jello and this one, the person box was packed with jelly many dozens of months later.</p><p>They're saying the same thing but the second one is saying it in a way that most of us wouldn't normally say it. Instead of saying coffin, we're saying person box. Instead of jello, we're saying jelly. I think that's kind of normal actually and instead of years, we're saying dozens of months.</p><p>So it's not really sharing the same words but we're going to see that we can actually find that these two sentences are the most similar out of all of these. So we're taking those and we're going to be importing the sentence transformers library. And we want to import the sentence transformer.</p><p>And then from that, we want to initialize a sentence transformer model. So we write sentence transformer. And then in here, we're going to be using this model that I've already defined a model name for which is the BERT base MLI mean tokens model. So initialize that. I need to rerun that.</p><p>So we have our model and I'll just show you really quickly. This model is coming from the HuggingFace transformers library behind sentence transformers. So this is the actual model we are using. Now, first thing we do here is create our sentence vectors or sentence embeddings. So we'll call a sentence vects equals model and code.</p><p>And all we need to do here is pass our sentences. So we can pass a single sentence or a list of sentences. It's completely fine. And then let's just have a quick look at what we have here. So you see that we have this big array. And if we look at the shape, we see that we have a six by 768 array.</p><p>So the six refers to our six sentences here. And the 768 refers to the hidden state size within the BERT model that we're using. So each one of these sentences is now being represented by a dense vector containing 768 values. And that means that we are ready to take those and compare similarity between them.</p><p>So to do that, we're going to be using the sklearn implementation of cosine similarity, which we can import like this. So sklearn pairwise or metrics pairwise. And we import cosine similarity. And to calculate our cosine similarity, all we do is take that function. And inside here, we pass our first sentence.</p><p>So this three years later, the coffin is still full of jello. I want to pass that sentence vector, which is just an index zero of our sentence vects array. And because we are extracting that single array value. So if we just have a look at this, you see that we have a almost like a list of lists here.</p><p>If we just extract this, we only get a list. So what we want to do is actually keep that inside a list. Otherwise, we'll get dimension error. And then we do sentence vects one onwards. So this will be the remaining sentences. Okay, so let's take these, or let's just bring them down here.</p><p>Calculate this. And we can see that our highest similarity by quite a bit is this 0.72. Now, that means that between this sentence, and this sentence, we have a similarity score of 0.72. So clearly, it's working, it's scoring high similarity. And you can play around this and, and test multiple different words and sentences and just see how it works.</p><p>But that's the easy way putting all this together. So I think it's really cool that we can do that so easily. But I don't think there's really anything else to say about it. So thank you for watching, and I'll see you in the next one.</p></div></div></body></html>