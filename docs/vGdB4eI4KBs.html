<html><head><title>Lesson 13: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 13: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs"><img src="https://i.ytimg.com/vi/vGdB4eI4KBs/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=174">2:54</a> Linear models & rectified lines (ReLU) diagram<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=615">10:15</a> Multi Layer Perceptron (MLP) from scratch<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1095">18:15</a> Loss function from scratch - Mean Squared Error (MSE)<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1394">23:14</a> Gradients and backpropagation diagram<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1890">31:30</a> Matrix calculus resources<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2007">33:27</a> Gradients and backpropagation code<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2295">38:15</a> Chain rule visualized + how it applies<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2948">49:8</a> Using Pythonâ€™s built in debugger<br><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3647">60:47</a> Refactoring the code<br><br><div style="text-align: left;"><a href="./vGdB4eI4KBs.html">Whisper Transcript</a> | <a href="./transcript_vGdB4eI4KBs.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi everybody, and welcome to lesson 13, where we're going to start talking about back propagation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=10" target="_blank">00:00:10.120</a></span> | <span class="t">Before we do, I'll just mention that there was some great success amongst the folks in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=13" target="_blank">00:00:13.880</a></span> | <span class="t">the class during the week on working with flexing their tensor manipulation muscles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=26" target="_blank">00:00:26.920</a></span> | <span class="t">So far the fastest main shift algorithm, which has a similar accuracy to the one I displayed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=36" target="_blank">00:00:36.160</a></span> | <span class="t">is one that actually randomly chooses data points as subset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=42" target="_blank">00:00:42.000</a></span> | <span class="t">And I actually think that's a great approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=43" target="_blank">00:00:43.520</a></span> | <span class="t">Very often random sampling and random projections are two excellent ways of speeding up algorithms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=55" target="_blank">00:00:55.060</a></span> | <span class="t">So it'd be interesting to see if anybody during the rest of the course comes up with anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=60" target="_blank">00:01:00.160</a></span> | <span class="t">faster than random sampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=64" target="_blank">00:01:04.920</a></span> | <span class="t">Also been seeing some good Einstein summation examples and implementations and continuing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=70" target="_blank">00:01:10.440</a></span> | <span class="t">to see lots of good diff edit implementations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=76" target="_blank">00:01:16.480</a></span> | <span class="t">So congratulations to all the students and I hope those of you following along the videos</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=80" target="_blank">00:01:20.840</a></span> | <span class="t">in the MOOC will be working on the same homework as well and sharing your results on the fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=87" target="_blank">00:01:27.760</a></span> | <span class="t">AI forums.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=91" target="_blank">00:01:31.520</a></span> | <span class="t">So now we're going to take a look at notebook number three in the normal repo, course 22p1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=106" target="_blank">00:01:46.680</a></span> | <span class="t">repo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=110" target="_blank">00:01:50.560</a></span> | <span class="t">And we're going to be looking at the forward and backward passes of a simple multi-layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=117" target="_blank">00:01:57.640</a></span> | <span class="t">perceptron and neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=122" target="_blank">00:02:02.080</a></span> | <span class="t">The initial stuff up here is just importing things and just settings and stuff that just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=128" target="_blank">00:02:08.560</a></span> | <span class="t">copying and pasting some stuff from previous notebooks around paths and parameters and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=132" target="_blank">00:02:12.600</a></span> | <span class="t">stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=134" target="_blank">00:02:14.600</a></span> | <span class="t">So we'll skip over this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=136" target="_blank">00:02:16.520</a></span> | <span class="t">So we'll often be kind of copying and pasting stuff from one notebook to another's kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=141" target="_blank">00:02:21.240</a></span> | <span class="t">of first cell to get things set up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=144" target="_blank">00:02:24.720</a></span> | <span class="t">And I'm also loading in our data for MNIST as tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=151" target="_blank">00:02:31.440</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=153" target="_blank">00:02:33.480</a></span> | <span class="t">So we, to start with, need to create the basic architecture of our neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=162" target="_blank">00:02:42.680</a></span> | <span class="t">And I did mention at the start of the course that we will briefly review everything that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=167" target="_blank">00:02:47.840</a></span> | <span class="t">we need to cover.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=168" target="_blank">00:02:48.840</a></span> | <span class="t">So we should briefly review what basic neural networks are and why they are what they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=175" target="_blank">00:02:55.840</a></span> | <span class="t">So to start with, let's consider a linear model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=197" target="_blank">00:03:17.440</a></span> | <span class="t">So let's start by considering a linear model of, well, let's take the most simple example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=209" target="_blank">00:03:29.040</a></span> | <span class="t">possible, which is we're going to pick a single pixel from our MNIST pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=216" target="_blank">00:03:36.720</a></span> | <span class="t">And so that will be our X. And for our Y values, then we'll have some loss function of how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=231" target="_blank">00:03:51.120</a></span> | <span class="t">good is this model, sorry, not some loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=239" target="_blank">00:03:59.080</a></span> | <span class="t">That's created even simpler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=240" target="_blank">00:04:00.200</a></span> | <span class="t">For our Y value, we're going to be looking at how likely is it that this is, say, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=247" target="_blank">00:04:07.280</a></span> | <span class="t">number three based on the value of this one pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=252" target="_blank">00:04:12.880</a></span> | <span class="t">So the pixel, its value will be X and the probability of being the number three, we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=260" target="_blank">00:04:20.280</a></span> | <span class="t">call Y. And if we just have a linear model, then it's going to look like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=269" target="_blank">00:04:29.840</a></span> | <span class="t">And so in this case, it's saying that the brighter this pixel is, the more likely it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=274" target="_blank">00:04:34.720</a></span> | <span class="t">is that it's the number three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=278" target="_blank">00:04:38.280</a></span> | <span class="t">And so there's a few problems with this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=284" target="_blank">00:04:44.080</a></span> | <span class="t">The first one, obviously, is that as a linear model, it's very limiting because maybe we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=291" target="_blank">00:04:51.360</a></span> | <span class="t">actually are trying to draw something that looks more like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=299" target="_blank">00:04:59.520</a></span> | <span class="t">So how would you do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=302" target="_blank">00:05:02.120</a></span> | <span class="t">Well, there's actually a neat trick we can use to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=306" target="_blank">00:05:06.920</a></span> | <span class="t">What we could do is, well, let's first talk about something we can't do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=314" target="_blank">00:05:14.440</a></span> | <span class="t">Something we can't do is to add a bunch of additional lines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=320" target="_blank">00:05:20.000</a></span> | <span class="t">So consider what happens if we say, OK, well, let's add a few different lines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=323" target="_blank">00:05:23.800</a></span> | <span class="t">So let's also add this line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=329" target="_blank">00:05:29.200</a></span> | <span class="t">So what would be the sum of our two lines?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=336" target="_blank">00:05:36.320</a></span> | <span class="t">Well, the answer is, of course, that the sum of the two lines will itself be a line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=340" target="_blank">00:05:40.280</a></span> | <span class="t">So it's not going to help us at all match the actual curve that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=346" target="_blank">00:05:46.600</a></span> | <span class="t">So here's the trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=348" target="_blank">00:05:48.240</a></span> | <span class="t">Instead, we could create a line like this that actually we could create this line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=373" target="_blank">00:06:13.240</a></span> | <span class="t">And now consider what happens if we add this original line with this new-- well, it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=377" target="_blank">00:06:17.400</a></span> | <span class="t">a line, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=378" target="_blank">00:06:18.720</a></span> | <span class="t">It's two line segments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=381" target="_blank">00:06:21.000</a></span> | <span class="t">So what we would get is this-- everything to the left of this point is going to not be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=394" target="_blank">00:06:34.800</a></span> | <span class="t">changed if I add these two lines together, because this is zero all the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=399" target="_blank">00:06:39.520</a></span> | <span class="t">And everything to the right of it is going to be reduced.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=401" target="_blank">00:06:41.720</a></span> | <span class="t">It looks like they've got similar slopes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=404" target="_blank">00:06:44.280</a></span> | <span class="t">So we might end up with instead-- so this would all disappear here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=412" target="_blank">00:06:52.520</a></span> | <span class="t">And instead, we would end up with something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=421" target="_blank">00:07:01.680</a></span> | <span class="t">And then we could do that again, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=423" target="_blank">00:07:03.340</a></span> | <span class="t">We could add an additional line that looks a bit like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=429" target="_blank">00:07:09.280</a></span> | <span class="t">So it would go-- but this time, it could go even further out here, and it could be something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=438" target="_blank">00:07:18.480</a></span> | <span class="t">like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=441" target="_blank">00:07:21.600</a></span> | <span class="t">So what if we added that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=443" target="_blank">00:07:23.280</a></span> | <span class="t">Well, again, at the point underneath here, it's always zero, so it won't do anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=449" target="_blank">00:07:29.440</a></span> | <span class="t">at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=450" target="_blank">00:07:30.440</a></span> | <span class="t">But after that, it's going to make it even more negatively sloped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=456" target="_blank">00:07:36.360</a></span> | <span class="t">And if you can see, using this approach, we could add up lots of these rectified lines,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=464" target="_blank">00:07:44.040</a></span> | <span class="t">these lines that truncate at zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=466" target="_blank">00:07:46.200</a></span> | <span class="t">And we could create any shape we want with enough of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=470" target="_blank">00:07:50.680</a></span> | <span class="t">And these lines are very easy to create, because actually, all we need to do is to create just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=478" target="_blank">00:07:58.840</a></span> | <span class="t">a regular line, which we can move up, down, left, right, change its angle, whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=493" target="_blank">00:08:13.180</a></span> | <span class="t">And then just say, if it's greater than zero, truncate it to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=498" target="_blank">00:08:18.080</a></span> | <span class="t">Or we could do the opposite for a line going the opposite direction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=500" target="_blank">00:08:20.480</a></span> | <span class="t">If it's less than zero, we could say, truncate it to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=504" target="_blank">00:08:24.520</a></span> | <span class="t">And that would get rid of, as we want, this whole section here, and make it flat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=513" target="_blank">00:08:33.760</a></span> | <span class="t">OK, so these are rectified lines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=518" target="_blank">00:08:38.560</a></span> | <span class="t">And so we can sum up a bunch of these together to basically match any arbitrary curve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=531" target="_blank">00:08:51.000</a></span> | <span class="t">So let's start by doing that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=532" target="_blank">00:08:52.840</a></span> | <span class="t">Well, the other thing we should mention, of course, is that we're going to have not just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=536" target="_blank">00:08:56.960</a></span> | <span class="t">one pixel, but we're going to have lots of pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=542" target="_blank">00:09:02.680</a></span> | <span class="t">So to start with the kind of most slightly-- the only slightly less simple approach, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=558" target="_blank">00:09:18.160</a></span> | <span class="t">could have something where we've got pixel number one and pixel number two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=562" target="_blank">00:09:22.800</a></span> | <span class="t">We're looking at two different pixels to see how likely they are to be the number three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=568" target="_blank">00:09:28.880</a></span> | <span class="t">And so that would allow us to draw more complex shapes that have some kind of surface between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=584" target="_blank">00:09:44.640</a></span> | <span class="t">them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=589" target="_blank">00:09:49.040</a></span> | <span class="t">OK, and then we can do exactly the same thing is to create these surfaces, we can add up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=597" target="_blank">00:09:57.760</a></span> | <span class="t">lots of these rectified lines together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=601" target="_blank">00:10:01.400</a></span> | <span class="t">But now they're going to be kind of rectified planes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=606" target="_blank">00:10:06.400</a></span> | <span class="t">But it's going to be exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=608" target="_blank">00:10:08.360</a></span> | <span class="t">We're going to be adding together a bunch of lines, each one of which is truncated at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=612" target="_blank">00:10:12.440</a></span> | <span class="t">zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=613" target="_blank">00:10:13.440</a></span> | <span class="t">OK, so that's the quick review.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=616" target="_blank">00:10:16.680</a></span> | <span class="t">And so to do that, we'll start out by just defining a few variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=622" target="_blank">00:10:22.520</a></span> | <span class="t">So n is the number of training examples, m is the number of pixels, c is the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=636" target="_blank">00:10:36.480</a></span> | <span class="t">possible values of our digits, and so here they are, 50,000 samples, 784 pixels, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=643" target="_blank">00:10:43.400</a></span> | <span class="t">10 possible outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=646" target="_blank">00:10:46.320</a></span> | <span class="t">OK, so what we do is we basically decide ahead of time how many of these line segment thingies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=657" target="_blank">00:10:57.760</a></span> | <span class="t">to add up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=659" target="_blank">00:10:59.640</a></span> | <span class="t">And so the number that we create in a layer is called the number of hidden nodes or activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=665" target="_blank">00:11:05.760</a></span> | <span class="t">So we'll call that nh.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=667" target="_blank">00:11:07.100</a></span> | <span class="t">So let's just arbitrarily decide on creating 50 of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=671" target="_blank">00:11:11.520</a></span> | <span class="t">So in order to create lots of lines, which we're going to truncate at zero, we can do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=678" target="_blank">00:11:18.840</a></span> | <span class="t">a matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=681" target="_blank">00:11:21.520</a></span> | <span class="t">So with a matrix multiplication, we're going to have something where we've got 50,000 rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=700" target="_blank">00:11:40.240</a></span> | <span class="t">by 784 columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=710" target="_blank">00:11:50.600</a></span> | <span class="t">And we're going to multiply that by something with 784 rows and 10 columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=725" target="_blank">00:12:05.520</a></span> | <span class="t">And why is that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=727" target="_blank">00:12:07.600</a></span> | <span class="t">Well, that's because if we take this very first line of this first vector here, row one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=733" target="_blank">00:12:13.560</a></span> | <span class="t">have 784 values, they're the pixel values of the first image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=737" target="_blank">00:12:17.560</a></span> | <span class="t">OK, so this is our first image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=740" target="_blank">00:12:20.280</a></span> | <span class="t">And so each of those 784 values will be multiplied by each of these 784 values in the first column,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=749" target="_blank">00:12:29.240</a></span> | <span class="t">the zero index column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=751" target="_blank">00:12:31.480</a></span> | <span class="t">And that's going to give us a number in our output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=755" target="_blank">00:12:35.720</a></span> | <span class="t">So our output is going to be 50,000 images by 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=770" target="_blank">00:12:50.640</a></span> | <span class="t">And so that result, we'll multiply those together and we'll add them up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=774" target="_blank">00:12:54.520</a></span> | <span class="t">And that result is going to end up over here in this first cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=779" target="_blank">00:12:59.520</a></span> | <span class="t">And so each of these columns is going to eventually represent, if this is a linear model, in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=787" target="_blank">00:13:07.120</a></span> | <span class="t">case, this is just the example of doing a linear model, each of these cells is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=791" target="_blank">00:13:11.160</a></span> | <span class="t">to represent the probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=792" target="_blank">00:13:12.720</a></span> | <span class="t">So this first column will be the probability of being a zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=795" target="_blank">00:13:15.480</a></span> | <span class="t">And the second column will be the probability of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=797" target="_blank">00:13:17.640</a></span> | <span class="t">The third column will be the probability of being a two and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=801" target="_blank">00:13:21.280</a></span> | <span class="t">So that's why we're going to have these 10 columns, each one allowing us to weight the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=806" target="_blank">00:13:26.560</a></span> | <span class="t">784 inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=808" target="_blank">00:13:28.040</a></span> | <span class="t">Now, of course, we're going to do something a bit more tricky than that, which is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=811" target="_blank">00:13:31.760</a></span> | <span class="t">we're going to have a 784 by 50 input going into a 784 by 50 output to create the 50 hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=820" target="_blank">00:13:40.280</a></span> | <span class="t">layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=821" target="_blank">00:13:41.280</a></span> | <span class="t">Then we're going to truncate those at zero and then multiply that by a 50 by 10 to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=827" target="_blank">00:13:47.360</a></span> | <span class="t">our 10 output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=828" target="_blank">00:13:48.360</a></span> | <span class="t">So we'll do it in two steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=831" target="_blank">00:13:51.320</a></span> | <span class="t">So the way SGD works is we start with just this is our weight matrix here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=841" target="_blank">00:14:01.640</a></span> | <span class="t">And this is our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=843" target="_blank">00:14:03.560</a></span> | <span class="t">This is our outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=846" target="_blank">00:14:06.160</a></span> | <span class="t">The way it works is that this weight matrix is initially filled with random values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=853" target="_blank">00:14:13.000</a></span> | <span class="t">Also, of course, this contains our pixel values, this contains the results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=857" target="_blank">00:14:17.080</a></span> | <span class="t">So W is going to start with random values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=864" target="_blank">00:14:24.520</a></span> | <span class="t">So here's our weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=866" target="_blank">00:14:26.100</a></span> | <span class="t">It's going to have, as we discussed, 50,000 by 50 random values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=875" target="_blank">00:14:35.540</a></span> | <span class="t">And it's not enough just to multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=877" target="_blank">00:14:37.760</a></span> | <span class="t">We also have to add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=879" target="_blank">00:14:39.120</a></span> | <span class="t">So that's what makes it a linear function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=882" target="_blank">00:14:42.060</a></span> | <span class="t">So we call those the biases, the things we add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=885" target="_blank">00:14:45.720</a></span> | <span class="t">We can just start those at zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=888" target="_blank">00:14:48.560</a></span> | <span class="t">So we'll need one for each output, so 50 of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=891" target="_blank">00:14:51.720</a></span> | <span class="t">And so that'll be layer one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=892" target="_blank">00:14:52.720</a></span> | <span class="t">And then as we just mentioned, layer two will be a matrix that goes from 50 hidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=900" target="_blank">00:15:00.920</a></span> | <span class="t">And now I'm going to do something totally cheating to simplify some of the calculations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=905" target="_blank">00:15:05.160</a></span> | <span class="t">for the calculus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=906" target="_blank">00:15:06.160</a></span> | <span class="t">I'm only going to create one output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=907" target="_blank">00:15:07.760</a></span> | <span class="t">Why am I going to create one output?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=911" target="_blank">00:15:11.400</a></span> | <span class="t">That's because I'm not going to use cross entropy just yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=914" target="_blank">00:15:14.800</a></span> | <span class="t">I'm going to use MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=918" target="_blank">00:15:18.380</a></span> | <span class="t">So actually, I'm going to create one output, which will literally just be what number do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=931" target="_blank">00:15:31.440</a></span> | <span class="t">I think it is from 0 to 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=940" target="_blank">00:15:40.880</a></span> | <span class="t">And so then we're going to compare those to the actual-- so these will be our y-predictors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=945" target="_blank">00:15:45.480</a></span> | <span class="t">We normally use a little hat for that, and we're going to compare that to our actuals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=952" target="_blank">00:15:52.680</a></span> | <span class="t">And yeah, in this very hacky approach, let's say we predict over here the number 9, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=957" target="_blank">00:15:57.920</a></span> | <span class="t">the actual is the number 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=959" target="_blank">00:15:59.880</a></span> | <span class="t">And we'll compare those together using MSE, which will be a stupid way to do it, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=967" target="_blank">00:16:07.120</a></span> | <span class="t">it's saying that 9 is further away from being 2 than 2-- 9 is further away from 2 than it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=972" target="_blank">00:16:12.640</a></span> | <span class="t">is from 4 in terms of how correct it is, which is not what we want at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=977" target="_blank">00:16:17.480</a></span> | <span class="t">But this is what we're going to do just to simplify our starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=980" target="_blank">00:16:20.560</a></span> | <span class="t">So that's why we're going to have a single output for this weight matrix and a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=985" target="_blank">00:16:25.720</a></span> | <span class="t">output for this bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=988" target="_blank">00:16:28.720</a></span> | <span class="t">So a linear-- let's create a function for putting x through a linear layer with these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=995" target="_blank">00:16:35.400</a></span> | <span class="t">weights and these biases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=997" target="_blank">00:16:37.160</a></span> | <span class="t">So it's a matrix multiply and an add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1000" target="_blank">00:16:40.440</a></span> | <span class="t">All right, so we can now try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1003" target="_blank">00:16:43.560</a></span> | <span class="t">So if we multiply our x-- oh, we're doing x valid this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1008" target="_blank">00:16:48.680</a></span> | <span class="t">So just to clarify, x valid is 10,000 by 784.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1016" target="_blank">00:16:56.520</a></span> | <span class="t">So if we put x valid through our weights and biases with a linear layer, we end up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1021" target="_blank">00:17:01.680</a></span> | <span class="t">a 10,000 by 50, so 10,050 long hidden activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1029" target="_blank">00:17:09.000</a></span> | <span class="t">They're not quite ready yet, because we have to put them through ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1032" target="_blank">00:17:12.360</a></span> | <span class="t">And so we're going to clamp at 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1034" target="_blank">00:17:14.460</a></span> | <span class="t">So everything under 0 will become 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1038" target="_blank">00:17:18.720</a></span> | <span class="t">And so here's what it looks like when we go through the linear layer and then the ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1043" target="_blank">00:17:23.420</a></span> | <span class="t">And you can see here's a tensor with a bunch of things, some of which are 0 or they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1047" target="_blank">00:17:27.480</a></span> | <span class="t">positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1048" target="_blank">00:17:28.480</a></span> | <span class="t">So that's the result of this matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1052" target="_blank">00:17:32.200</a></span> | <span class="t">OK, so to create our basic MLP multi-layer perceptron from scratch, we will take our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1062" target="_blank">00:17:42.080</a></span> | <span class="t">mini-batch of x's-- xb is a x match.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1065" target="_blank">00:17:45.440</a></span> | <span class="t">We will create our first layer's output with a linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1068" target="_blank">00:17:48.120</a></span> | <span class="t">And then we will put that through a ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1070" target="_blank">00:17:50.240</a></span> | <span class="t">And then that will go through the second linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1071" target="_blank">00:17:51.820</a></span> | <span class="t">So the first one uses the w1b one, these ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1076" target="_blank">00:17:56.680</a></span> | <span class="t">And the second one uses the w2b2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1081" target="_blank">00:18:01.200</a></span> | <span class="t">And so we've now got a simple model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1085" target="_blank">00:18:05.560</a></span> | <span class="t">And as we hoped, when we pass in the validation set, we get back 10,000 digits, so 10,000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1091" target="_blank">00:18:11.840</a></span> | <span class="t">by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1092" target="_blank">00:18:12.840</a></span> | <span class="t">Great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1093" target="_blank">00:18:13.840</a></span> | <span class="t">So that's a good start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1094" target="_blank">00:18:14.840</a></span> | <span class="t">OK, so let's use our ridiculous loss function of MSC.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1100" target="_blank">00:18:20.800</a></span> | <span class="t">So our results is 10,000 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1106" target="_blank">00:18:26.800</a></span> | <span class="t">And our x valid-- sorry, our y valid is just a vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1112" target="_blank">00:18:32.160</a></span> | <span class="t">Now what's going to happen if I do res minus y valid?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1119" target="_blank">00:18:39.240</a></span> | <span class="t">So before you continue in the video, have a think about that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1123" target="_blank">00:18:43.400</a></span> | <span class="t">What's going to happen if I do res minus y valid by thinking about the NumPy broadcasting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1128" target="_blank">00:18:48.400</a></span> | <span class="t">rules we've learned?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1132" target="_blank">00:18:52.240</a></span> | <span class="t">OK, let's try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1136" target="_blank">00:18:56.640</a></span> | <span class="t">Oh, terrible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1139" target="_blank">00:18:59.120</a></span> | <span class="t">We've ended up with a 10,000 by 10,000 matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1145" target="_blank">00:19:05.280</a></span> | <span class="t">So 100 million points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1146" target="_blank">00:19:06.520</a></span> | <span class="t">Now we would expect an MSC to just contain 1,000 points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1150" target="_blank">00:19:10.720</a></span> | <span class="t">Why did that happen?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1157" target="_blank">00:19:17.800</a></span> | <span class="t">The reason it happened is because we have to start out at the last dimension and go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1166" target="_blank">00:19:26.560</a></span> | <span class="t">right to left.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1168" target="_blank">00:19:28.680</a></span> | <span class="t">And we compare the 10,000 to the 1 and say, are they compatible?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1175" target="_blank">00:19:35.240</a></span> | <span class="t">And the answer is-- that's right, Alexei in the chat's got it right-- broadcasting rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1179" target="_blank">00:19:39.620</a></span> | <span class="t">So the answer is that this 1 will be broadcast over these 10,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1184" target="_blank">00:19:44.120</a></span> | <span class="t">So this pair here will give us 10,000 outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1187" target="_blank">00:19:47.720</a></span> | <span class="t">And then we'll move to the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1193" target="_blank">00:19:53.840</a></span> | <span class="t">And we'll also move here to the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1195" target="_blank">00:19:55.880</a></span> | <span class="t">Uh-oh, there is no next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1197" target="_blank">00:19:57.880</a></span> | <span class="t">What happens?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1198" target="_blank">00:19:58.880</a></span> | <span class="t">Now, if you remember the rules, it inserts a unit axis for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1202" target="_blank">00:20:02.680</a></span> | <span class="t">So we now have 10,000 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1204" target="_blank">00:20:04.640</a></span> | <span class="t">So that means each of the 10,000 outputs from here will end up being broadcast across the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1211" target="_blank">00:20:11.480</a></span> | <span class="t">10,000 rows here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1214" target="_blank">00:20:14.080</a></span> | <span class="t">So that means that will end up-- for each of those 10,000, we'll have another 10,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1217" target="_blank">00:20:17.560</a></span> | <span class="t">So we'll end up with a 10,000 by 10,000 output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1223" target="_blank">00:20:23.080</a></span> | <span class="t">So that's not what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1225" target="_blank">00:20:25.040</a></span> | <span class="t">So how could we fix that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1226" target="_blank">00:20:26.840</a></span> | <span class="t">Well, what we really would want would we want this to be 10,000 comma 1 here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1235" target="_blank">00:20:35.000</a></span> | <span class="t">If that was 10,000 comma 1, then we'd compare these two right to left.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1240" target="_blank">00:20:40.200</a></span> | <span class="t">And they're both 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1241" target="_blank">00:20:41.820</a></span> | <span class="t">So those match.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1243" target="_blank">00:20:43.720</a></span> | <span class="t">And there's nothing to broadcast because they're the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1246" target="_blank">00:20:46.160</a></span> | <span class="t">And then we'll go to the next one, 10,000 to 10,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1248" target="_blank">00:20:48.440</a></span> | <span class="t">Those match.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1249" target="_blank">00:20:49.600</a></span> | <span class="t">So they just go element wise for those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1251" target="_blank">00:20:51.800</a></span> | <span class="t">And we'd end up with exactly what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1253" target="_blank">00:20:53.440</a></span> | <span class="t">We'd end up with 10,000 results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1255" target="_blank">00:20:55.680</a></span> | <span class="t">Or alternatively, we could remove this dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1260" target="_blank">00:21:00.300</a></span> | <span class="t">And then again, same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1261" target="_blank">00:21:01.960</a></span> | <span class="t">We're then going to add right to left, compatible 10,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1266" target="_blank">00:21:06.160</a></span> | <span class="t">So they'll get element wise operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1276" target="_blank">00:21:16.760</a></span> | <span class="t">So in this case, I got rid of the trailing comma 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1280" target="_blank">00:21:20.520</a></span> | <span class="t">There's a couple of ways you could do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1281" target="_blank">00:21:21.720</a></span> | <span class="t">One is just to say, OK, grab every row and the zeroth column of res.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1287" target="_blank">00:21:27.720</a></span> | <span class="t">And that's going to turn it from a 10,000 by 1 into a 10,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1293" target="_blank">00:21:33.040</a></span> | <span class="t">Or alternatively, we can say dot squeeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1295" target="_blank">00:21:35.280</a></span> | <span class="t">Now, dot squeeze removes all trailing unit vectors and possibly also prefix unit vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1303" target="_blank">00:21:43.640</a></span> | <span class="t">I can't quite recall.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1307" target="_blank">00:21:47.180</a></span> | <span class="t">I guess we should try.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1308" target="_blank">00:21:48.560</a></span> | <span class="t">So let's say res none comma colon comma none.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1323" target="_blank">00:22:03.760</a></span> | <span class="t">Q dot shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1327" target="_blank">00:22:07.440</a></span> | <span class="t">OK, so if I go Q dot squeeze dot shape, OK, so all the unit vectors get removed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1344" target="_blank">00:22:24.840</a></span> | <span class="t">Sorry, all the unit dimensions get removed, I should say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1349" target="_blank">00:22:29.000</a></span> | <span class="t">OK, so now that we've got a way to remove that axis that we didn't want, we can use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1355" target="_blank">00:22:35.800</a></span> | <span class="t">And if we do that subtraction, now we get 10,000 just like we wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1360" target="_blank">00:22:40.720</a></span> | <span class="t">So now let's get our training and validation wise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1365" target="_blank">00:22:45.920</a></span> | <span class="t">We'll turn them into floats because we're using MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1370" target="_blank">00:22:50.200</a></span> | <span class="t">So let's calculate our predictions for the training set, which is 50,000 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1375" target="_blank">00:22:55.880</a></span> | <span class="t">And so if we create an MSE function that just does what we just said we wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1380" target="_blank">00:23:00.160</a></span> | <span class="t">So it does the subtraction and then squares it and then takes the mean, that's MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1388" target="_blank">00:23:08.080</a></span> | <span class="t">So there we go, we now have a loss function being applied to our training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1395" target="_blank">00:23:15.120</a></span> | <span class="t">OK, now we need gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1402" target="_blank">00:23:22.480</a></span> | <span class="t">So as we briefly discussed last time, gradients are slopes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1413" target="_blank">00:23:33.760</a></span> | <span class="t">And in fact, maybe it would even be easier to look at last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1421" target="_blank">00:23:41.480</a></span> | <span class="t">So this was last time's notebook. And so we saw how the gradient at this point is the slope here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1443" target="_blank">00:24:03.280</a></span> | <span class="t">And so it's the, as we discussed, rise over run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1450" target="_blank">00:24:10.000</a></span> | <span class="t">Now, so that means as we increase, in this case, time by one, the distance increases by how much?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1463" target="_blank">00:24:23.560</a></span> | <span class="t">That's what the slope is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1469" target="_blank">00:24:29.400</a></span> | <span class="t">So why is this interesting?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1475" target="_blank">00:24:35.160</a></span> | <span class="t">The reason it's interesting is because let's consider our neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1482" target="_blank">00:24:42.960</a></span> | <span class="t">Our neural network is some function that takes two things, two groups of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1489" target="_blank">00:24:49.360</a></span> | <span class="t">It contains a matrix of our inputs and it contains our weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1501" target="_blank">00:25:01.320</a></span> | <span class="t">And we want to and let's assume we're also putting it through a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1511" target="_blank">00:25:11.040</a></span> | <span class="t">So let's say, well, I mean, I guess we can be explicit about that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1514" target="_blank">00:25:14.800</a></span> | <span class="t">So we could say we then take the result of that and we put it through some loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1520" target="_blank">00:25:20.480</a></span> | <span class="t">So these are the predictions and we compare it to our actual dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1535" target="_blank">00:25:35.920</a></span> | <span class="t">So that's our neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1542" target="_blank">00:25:42.360</a></span> | <span class="t">And that's our loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1548" target="_blank">00:25:48.320</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1553" target="_blank">00:25:53.280</a></span> | <span class="t">So if we can get the derivative of the loss with respect to, let's say, one particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1566" target="_blank">00:26:06.960</a></span> | <span class="t">weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1567" target="_blank">00:26:07.960</a></span> | <span class="t">So let's say weight number zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1570" target="_blank">00:26:10.680</a></span> | <span class="t">What is that doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1571" target="_blank">00:26:11.680</a></span> | <span class="t">Well, it's saying as I increase the weight by a little bit, what happens to the loss?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1581" target="_blank">00:26:21.320</a></span> | <span class="t">And if it says, oh, well, that would make the loss go down, then obviously I want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1587" target="_blank">00:26:27.120</a></span> | <span class="t">increase the weight by a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1589" target="_blank">00:26:29.300</a></span> | <span class="t">And if it says, oh, it makes the loss go up, then obviously I want to do the opposite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1594" target="_blank">00:26:34.320</a></span> | <span class="t">So the derivative of the loss with respect to the weights, each one of those tells us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1602" target="_blank">00:26:42.040</a></span> | <span class="t">how to change the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1603" target="_blank">00:26:43.700</a></span> | <span class="t">And so to remind you, we then change each weight by that derivative of times a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1609" target="_blank">00:26:49.760</a></span> | <span class="t">bit and subtract it from the original weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1615" target="_blank">00:26:55.920</a></span> | <span class="t">And we do that a bunch of times and that's called SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1625" target="_blank">00:27:05.280</a></span> | <span class="t">Now there's something interesting going on here, which is that in this case, there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1632" target="_blank">00:27:12.320</a></span> | <span class="t">a single input and a single output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1636" target="_blank">00:27:16.340</a></span> | <span class="t">And so the derivative is a single number at any point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1640" target="_blank">00:27:20.320</a></span> | <span class="t">It's the speed in this case, the vehicle's going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1644" target="_blank">00:27:24.560</a></span> | <span class="t">But consider a more complex function like say this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1655" target="_blank">00:27:35.160</a></span> | <span class="t">Now in this case, there's one output, but there's two inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1659" target="_blank">00:27:39.700</a></span> | <span class="t">And so if we want to take the derivative of this function, then we actually need to say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1666" target="_blank">00:27:46.120</a></span> | <span class="t">well, what happens if we increase X by a little bit?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1669" target="_blank">00:27:49.080</a></span> | <span class="t">And also what happens if we increase Y by a little bit?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1672" target="_blank">00:27:52.360</a></span> | <span class="t">And in each case, what happens to Z?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1675" target="_blank">00:27:55.680</a></span> | <span class="t">And so in that case, the derivative is actually going to contain two numbers, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1682" target="_blank">00:28:02.080</a></span> | <span class="t">It's going to contain the derivative of Z with respect to Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1688" target="_blank">00:28:08.640</a></span> | <span class="t">And it's going to contain the derivative of Z with respect to X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1692" target="_blank">00:28:12.520</a></span> | <span class="t">What happens if we change each of these two numbers?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1694" target="_blank">00:28:14.640</a></span> | <span class="t">So for example, these could be, as we discussed, two different weights in our neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1699" target="_blank">00:28:19.800</a></span> | <span class="t">and Z could be our loss, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1705" target="_blank">00:28:25.240</a></span> | <span class="t">Now we've got actually 784 inputs, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1709" target="_blank">00:28:29.140</a></span> | <span class="t">So we would actually have 784 of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1713" target="_blank">00:28:33.840</a></span> | <span class="t">So we don't normally write them all like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1716" target="_blank">00:28:36.160</a></span> | <span class="t">We would just say, use this little squiggly symbol to say the derivative of the loss across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1723" target="_blank">00:28:43.160</a></span> | <span class="t">all of them with respect to all of the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1728" target="_blank">00:28:48.240</a></span> | <span class="t">OK, and that's just saying that there's a whole bunch of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1732" target="_blank">00:28:52.160</a></span> | <span class="t">It's a shorthand way of writing this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1736" target="_blank">00:28:56.560</a></span> | <span class="t">OK, so it gets more complicated still, though, because think about what happens if, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1748" target="_blank">00:29:08.880</a></span> | <span class="t">you're in the first layer where we've got a weight matrix that's going to end up giving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1753" target="_blank">00:29:13.440</a></span> | <span class="t">us 50 outputs, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1755" target="_blank">00:29:15.400</a></span> | <span class="t">So for every image, we're going to have 784 inputs to our function, and we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1762" target="_blank">00:29:22.080</a></span> | <span class="t">have 50 outputs to our function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1766" target="_blank">00:29:26.520</a></span> | <span class="t">And so in that case, I can't even draw it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1771" target="_blank">00:29:31.880</a></span> | <span class="t">Because like for every-- even if I had two inputs and two outputs, then as I increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1776" target="_blank">00:29:36.620</a></span> | <span class="t">my first input, I'd actually need to say, how does that change both of the two outputs?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1784" target="_blank">00:29:44.260</a></span> | <span class="t">And as I change my second input, how does that change both of my two outputs?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1790" target="_blank">00:29:50.320</a></span> | <span class="t">So for the full thing, you actually are going to end up with a matrix of derivatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1797" target="_blank">00:29:57.640</a></span> | <span class="t">It basically says, for every input that you change by a little bit, how much does it change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1805" target="_blank">00:30:05.580</a></span> | <span class="t">every output of that function?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1808" target="_blank">00:30:08.700</a></span> | <span class="t">So you're going to end up with a matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1811" target="_blank">00:30:11.980</a></span> | <span class="t">So that's what we're going to be doing, is we're going to be calculating these derivatives,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1818" target="_blank">00:30:18.480</a></span> | <span class="t">but rather than being single numbers, they're going to actually contain matrices with a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1824" target="_blank">00:30:24.480</a></span> | <span class="t">row for every input and a column for every output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1828" target="_blank">00:30:28.480</a></span> | <span class="t">And a single cell in that matrix will tell us, as I change this input by a little bit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1835" target="_blank">00:30:35.840</a></span> | <span class="t">how does it change this output?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1839" target="_blank">00:30:39.600</a></span> | <span class="t">Now eventually, we will end up with a single number for every input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1849" target="_blank">00:30:49.280</a></span> | <span class="t">And that's because our loss in the end is going to be a single number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1853" target="_blank">00:30:53.800</a></span> | <span class="t">And this is like a requirement that you'll find when you try to use SGD, is that your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1858" target="_blank">00:30:58.440</a></span> | <span class="t">loss has to be a single number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1861" target="_blank">00:31:01.880</a></span> | <span class="t">And so we generally get it by either doing the sum or a mean or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1869" target="_blank">00:31:09.480</a></span> | <span class="t">But as you'll see on the way there, we're going to have to be dealing with these matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1874" target="_blank">00:31:14.440</a></span> | <span class="t">of derivatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1878" target="_blank">00:31:18.600</a></span> | <span class="t">So I just want to mention, as I might have said before, I can't even remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1892" target="_blank">00:31:32.420</a></span> | <span class="t">There is this paper that Terrence Parr and I wrote a while ago, which goes through all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1900" target="_blank">00:31:40.040</a></span> | <span class="t">this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1902" target="_blank">00:31:42.400</a></span> | <span class="t">And it basically assumes that you only know high school calculus, and if you don't check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1910" target="_blank">00:31:50.400</a></span> | <span class="t">out Khan Academy, but then it describes matrix calculus in those terms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1915" target="_blank">00:31:55.680</a></span> | <span class="t">So it's going to explain to you exactly, and it works through lots and lots of examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1924" target="_blank">00:32:04.440</a></span> | <span class="t">So for example, as it mentions here, when you have this matrix of derivatives, we call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1934" target="_blank">00:32:14.680</a></span> | <span class="t">that a Jacobian matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1937" target="_blank">00:32:17.320</a></span> | <span class="t">So there's all these words, it doesn't matter too much if you know them or not, but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1942" target="_blank">00:32:22.540</a></span> | <span class="t">convenient to be able to talk about the matrix of all of the derivatives if somebody just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1949" target="_blank">00:32:29.080</a></span> | <span class="t">says the Jacobian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1950" target="_blank">00:32:30.920</a></span> | <span class="t">It's a little convenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1951" target="_blank">00:32:31.920</a></span> | <span class="t">It's a bit easier than saying the matrix of all of the derivatives, where all of the rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1956" target="_blank">00:32:36.520</a></span> | <span class="t">are things that are all the inputs and all the columns are the outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1963" target="_blank">00:32:43.160</a></span> | <span class="t">So yeah, if you want to really understand, get to a point where papers are easier to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1970" target="_blank">00:32:50.040</a></span> | <span class="t">read in particular, it's quite useful to know this notation and definitions of words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1979" target="_blank">00:32:59.600</a></span> | <span class="t">You can certainly get away without it, it's just something to consider.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1986" target="_blank">00:33:06.360</a></span> | <span class="t">Okay, so we need to be able to calculate derivatives, at least of a single variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1994" target="_blank">00:33:14.480</a></span> | <span class="t">And I am not going to worry too much about that, a, because that is something you do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=1999" target="_blank">00:33:19.100</a></span> | <span class="t">in high school math, and b, because your computer can do it for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2005" target="_blank">00:33:25.360</a></span> | <span class="t">And so you can do it symbolically, using something called SYMPY, which is really great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2011" target="_blank">00:33:31.480</a></span> | <span class="t">So if you create two symbols called x and y, you can say please differentiate x squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2021" target="_blank">00:33:41.240</a></span> | <span class="t">with respect to x, and if you do that, SYMPY will tell you the answer is 2x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2028" target="_blank">00:33:48.240</a></span> | <span class="t">If you say differentiate 3x squared plus 9 with respect to x, SYMPY will tell you that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2037" target="_blank">00:33:57.480</a></span> | <span class="t">is 6x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2038" target="_blank">00:33:58.480</a></span> | <span class="t">And a lot of you probably will have used Wolfram Alpha, that does something very similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2045" target="_blank">00:34:05.760</a></span> | <span class="t">I kind of quite like this because I can quickly do it inside my notebook and include it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2050" target="_blank">00:34:10.280</a></span> | <span class="t">my prose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2053" target="_blank">00:34:13.180</a></span> | <span class="t">So I think SYMPY is pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2054" target="_blank">00:34:14.720</a></span> | <span class="t">So basically, yeah, you can quickly calculate derivatives on a computer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2065" target="_blank">00:34:25.280</a></span> | <span class="t">Having said that, I do want to talk about why the derivative of 3x squared plus 9 equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2071" target="_blank">00:34:31.680</a></span> | <span class="t">6x, because that is going to be very important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2079" target="_blank">00:34:39.540</a></span> | <span class="t">So 3x squared plus 9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2086" target="_blank">00:34:46.440</a></span> | <span class="t">So we're going to start with the information that the derivative of a to the b with respect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2103" target="_blank">00:35:03.980</a></span> | <span class="t">to a equals b times a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2110" target="_blank">00:35:10.260</a></span> | <span class="t">So for example, the derivative of x squared with respect to x equals 2x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2117" target="_blank">00:35:17.140</a></span> | <span class="t">So that's just something I'm hoping you'll remember from high school or refresh your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2121" target="_blank">00:35:21.160</a></span> | <span class="t">memory using Card Academy or similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2123" target="_blank">00:35:23.560</a></span> | <span class="t">So that is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2126" target="_blank">00:35:26.080</a></span> | <span class="t">So what we could now do is we could rewrite this derivative as 3u plus 9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2140" target="_blank">00:35:40.600</a></span> | <span class="t">And then we'll write u equals x squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2145" target="_blank">00:35:45.080</a></span> | <span class="t">OK, now this is getting easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2150" target="_blank">00:35:50.920</a></span> | <span class="t">The derivative of two things being added together is simply the sum of their derivatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2159" target="_blank">00:35:59.000</a></span> | <span class="t">Oh, forgot b minus 1 in the exponent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2162" target="_blank">00:36:02.000</a></span> | <span class="t">Thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2163" target="_blank">00:36:03.000</a></span> | <span class="t">Sorry, ba to the power of b minus 1 is what it should be, which would be 2x to the power</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2169" target="_blank">00:36:09.080</a></span> | <span class="t">of 1, and the 1 is not needed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2173" target="_blank">00:36:13.640</a></span> | <span class="t">Thank you for fixing that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2175" target="_blank">00:36:15.840</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2177" target="_blank">00:36:17.840</a></span> | <span class="t">So we just sum them up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2179" target="_blank">00:36:19.480</a></span> | <span class="t">So we get the derivative of 3u is actually just-- well, it's going to be the derivative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2188" target="_blank">00:36:28.100</a></span> | <span class="t">of that plus the derivative of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2192" target="_blank">00:36:32.480</a></span> | <span class="t">Now the derivative of any constant with respect to a variable is 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2196" target="_blank">00:36:36.800</a></span> | <span class="t">Because if I change something, an input, it doesn't change the constant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2200" target="_blank">00:36:40.680</a></span> | <span class="t">It's always 9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2201" target="_blank">00:36:41.840</a></span> | <span class="t">So that's going to end up as 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2204" target="_blank">00:36:44.480</a></span> | <span class="t">And so we're going to end up with dy/du equals something plus 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2212" target="_blank">00:36:52.280</a></span> | <span class="t">And the derivative of 3u with respect to u is just 3 because it's just a line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2216" target="_blank">00:36:56.680</a></span> | <span class="t">So that's its slope.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2218" target="_blank">00:36:58.680</a></span> | <span class="t">OK, but that's not dy/dx.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2221" target="_blank">00:37:01.200</a></span> | <span class="t">We weren't doing up to dy/dx.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2222" target="_blank">00:37:02.880</a></span> | <span class="t">Well, the cool thing is that dy/dx is actually just equal to dy/du du/dx.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2234" target="_blank">00:37:14.080</a></span> | <span class="t">So I'll explain why in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2239" target="_blank">00:37:19.080</a></span> | <span class="t">But for now then, let's recognize we've got dy-- sorry, du/dx.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2244" target="_blank">00:37:24.600</a></span> | <span class="t">We know that one, 2x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2246" target="_blank">00:37:26.840</a></span> | <span class="t">So we can now multiply these two bits together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2251" target="_blank">00:37:31.140</a></span> | <span class="t">And we will end up with 2x times 3, which is 6x, which is what Simpai told us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2258" target="_blank">00:37:38.760</a></span> | <span class="t">So fantastic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2260" target="_blank">00:37:40.840</a></span> | <span class="t">OK, this is something we need to know really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2264" target="_blank">00:37:44.240</a></span> | <span class="t">And it's called the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2266" target="_blank">00:37:46.680</a></span> | <span class="t">And it's best to understand it intuitively.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2270" target="_blank">00:37:50.080</a></span> | <span class="t">So to understand it intuitively, we're going to take a look at an interactive animation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2280" target="_blank">00:38:00.900</a></span> | <span class="t">So I found this nice interactive animation on this page here, webspace.ship.edu/msreadow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2289" target="_blank">00:38:09.720</a></span> | <span class="t">And it's read-- oh, georgebra calculus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2294" target="_blank">00:38:14.800</a></span> | <span class="t">OK, and the idea here is that we've got a wheel spinning around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2301" target="_blank">00:38:21.040</a></span> | <span class="t">And each time it spins around, this is x going up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2305" target="_blank">00:38:25.800</a></span> | <span class="t">OK, so at the moment, there's some change in x dx over a period of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2314" target="_blank">00:38:34.480</a></span> | <span class="t">All right, now, this wheel is eight times bigger than this wheel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2323" target="_blank">00:38:43.440</a></span> | <span class="t">So each time this goes around once, if we connect the two together, this wheel would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2329" target="_blank">00:38:49.560</a></span> | <span class="t">be going around four times faster because the difference between-- the multiple between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2338" target="_blank">00:38:58.760</a></span> | <span class="t">eight and two is four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2341" target="_blank">00:39:01.000</a></span> | <span class="t">Maybe I'll bring this up to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2343" target="_blank">00:39:03.360</a></span> | <span class="t">So now that this wheel has got twice as big a circumference as the u wheel, each time this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2349" target="_blank">00:39:09.620</a></span> | <span class="t">goes around once, this is going around two times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2355" target="_blank">00:39:15.920</a></span> | <span class="t">So the change in u, each time x goes around once, the change in u will be two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2363" target="_blank">00:39:23.960</a></span> | <span class="t">So that's what du dx is saying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2365" target="_blank">00:39:25.760</a></span> | <span class="t">The change in u for each change in x is two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2371" target="_blank">00:39:31.520</a></span> | <span class="t">Now we could make this interesting by connecting this wheel to this wheel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2376" target="_blank">00:39:36.920</a></span> | <span class="t">Now this wheel is twice as small as this wheel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2384" target="_blank">00:39:44.020</a></span> | <span class="t">So now we can see that, again, each time this spins around once, this spins around twice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2390" target="_blank">00:39:50.600</a></span> | <span class="t">because this has twice the circumference of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2393" target="_blank">00:39:53.700</a></span> | <span class="t">So therefore, dy du equals two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2397" target="_blank">00:39:57.560</a></span> | <span class="t">Now that means every time this goes around once, this goes around twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2402" target="_blank">00:40:02.440</a></span> | <span class="t">Every time this one goes around once, this gun goes around twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2405" target="_blank">00:40:05.760</a></span> | <span class="t">So therefore, every time this one goes around once, this one goes around four times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2413" target="_blank">00:40:13.820</a></span> | <span class="t">So dy dx equals four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2416" target="_blank">00:40:16.560</a></span> | <span class="t">So you can see here how the two-- well, how the du dx has to be multiplied with the dy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2425" target="_blank">00:40:25.840</a></span> | <span class="t">du to get the total.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2428" target="_blank">00:40:28.440</a></span> | <span class="t">So this is what's going on in the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2431" target="_blank">00:40:31.760</a></span> | <span class="t">And this is what you want to be thinking about is this idea that you've got one function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2438" target="_blank">00:40:38.040</a></span> | <span class="t">that is kind of this intermediary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2441" target="_blank">00:40:41.480</a></span> | <span class="t">And so you have to multiply the two impacts to get the impact of the x wheel on the y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2447" target="_blank">00:40:47.520</a></span> | <span class="t">wheel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2449" target="_blank">00:40:49.160</a></span> | <span class="t">So I hope you find that useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2451" target="_blank">00:40:51.600</a></span> | <span class="t">I find this-- personally, I find this intuition quite useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2458" target="_blank">00:40:58.840</a></span> | <span class="t">So why do we care about this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2460" target="_blank">00:41:00.240</a></span> | <span class="t">Well, the reason we care about this is because we want to calculate the gradient of our MSE</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2474" target="_blank">00:41:14.840</a></span> | <span class="t">applied to our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2479" target="_blank">00:41:19.520</a></span> | <span class="t">And so our inputs are going through a linear, they're going through a ReLU, they're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2484" target="_blank">00:41:24.600</a></span> | <span class="t">through another linear, and then they're going through an MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2488" target="_blank">00:41:28.080</a></span> | <span class="t">So there's four different steps going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2490" target="_blank">00:41:30.000</a></span> | <span class="t">And so we're going to have to combine those all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2493" target="_blank">00:41:33.080</a></span> | <span class="t">And so we can do that with the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2496" target="_blank">00:41:36.120</a></span> | <span class="t">So if our steps are that loss function is-- so we've got the loss function, which is some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2510" target="_blank">00:41:50.280</a></span> | <span class="t">function of the predictions and the actuals, and then we've got the second layer is a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2528" target="_blank">00:42:08.760</a></span> | <span class="t">of-- actually, let's call this the output of the second layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2537" target="_blank">00:42:17.280</a></span> | <span class="t">It's slightly weird notation, but hopefully it's not too bad-- is going to be a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2542" target="_blank">00:42:22.600</a></span> | <span class="t">of the ReLU activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2550" target="_blank">00:42:30.960</a></span> | <span class="t">And the ReLU activations are a function of the first layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2556" target="_blank">00:42:36.640</a></span> | <span class="t">And the first layer is a function of the inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2559" target="_blank">00:42:39.640</a></span> | <span class="t">Oh, and of course, this also has weights and biases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2566" target="_blank">00:42:46.520</a></span> | <span class="t">So we're basically going to have to calculate the derivative of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2574" target="_blank">00:42:54.640</a></span> | <span class="t">But then remember that this is itself a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2577" target="_blank">00:42:57.640</a></span> | <span class="t">So then we'll need to multiply that derivative by the derivative of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2581" target="_blank">00:43:01.880</a></span> | <span class="t">But that's also a function, so we have to multiply that derivative by this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2585" target="_blank">00:43:05.800</a></span> | <span class="t">But that's also a function, so we have to multiply that derivative by this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2589" target="_blank">00:43:09.240</a></span> | <span class="t">So that's going to be our approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2590" target="_blank">00:43:10.880</a></span> | <span class="t">We're going to start at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2593" target="_blank">00:43:13.600</a></span> | <span class="t">And we're going to take its derivative, and then we're going to gradually keep multiplying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2598" target="_blank">00:43:18.720</a></span> | <span class="t">as we go each step through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2601" target="_blank">00:43:21.320</a></span> | <span class="t">And this is called backpropagation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2605" target="_blank">00:43:25.000</a></span> | <span class="t">So backpropagation sounds pretty fancy, but it's actually just using the chain rule--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2611" target="_blank">00:43:31.640</a></span> | <span class="t">gosh, I didn't spell that very well-- prop-gation-- it's just using the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2619" target="_blank">00:43:39.200</a></span> | <span class="t">And as you'll see, it's also just taking advantage of a computational trick of memorizing some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2623" target="_blank">00:43:43.180</a></span> | <span class="t">things on the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2626" target="_blank">00:43:46.000</a></span> | <span class="t">And in our chat, Siva made a very good point about understanding nonlinear functions in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2634" target="_blank">00:43:54.440</a></span> | <span class="t">this case, which is just to consider that the wheels could be growing and shrinking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2639" target="_blank">00:43:59.600</a></span> | <span class="t">all the time as they're moving.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2641" target="_blank">00:44:01.400</a></span> | <span class="t">But you're still going to have this same compound effect, which I really like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2645" target="_blank">00:44:05.600</a></span> | <span class="t">Thank you, Siva.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2652" target="_blank">00:44:12.800</a></span> | <span class="t">There's also a question in the chat about why is this colon, comma, zero being placed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2658" target="_blank">00:44:18.020</a></span> | <span class="t">in the function, given that we can do it outside the function?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2661" target="_blank">00:44:21.520</a></span> | <span class="t">Well, the point is we want an MSE function that will apply to any output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2666" target="_blank">00:44:26.600</a></span> | <span class="t">We're not using it once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2667" target="_blank">00:44:27.600</a></span> | <span class="t">We want it to work any time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2668" target="_blank">00:44:28.800</a></span> | <span class="t">So we haven't actually modified preds or anything like that, or Y_train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2679" target="_blank">00:44:39.320</a></span> | <span class="t">So we want this to be able to apply to anything without us having to pre-process it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2684" target="_blank">00:44:44.880</a></span> | <span class="t">It's basically the idea here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2687" target="_blank">00:44:47.680</a></span> | <span class="t">OK, so let's take a look at the basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2695" target="_blank">00:44:55.800</a></span> | <span class="t">So here's going to do a forward pass and a backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2698" target="_blank">00:44:58.200</a></span> | <span class="t">So the forward pass is where we calculate the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2700" target="_blank">00:45:00.960</a></span> | <span class="t">So the loss is-- oh, I've got an error here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2708" target="_blank">00:45:08.640</a></span> | <span class="t">That should be diff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2710" target="_blank">00:45:10.800</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2715" target="_blank">00:45:15.420</a></span> | <span class="t">So the loss is going to be the output of our neural net minus our target squared, then take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2726" target="_blank">00:45:26.240</a></span> | <span class="t">the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2727" target="_blank">00:45:27.640</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2729" target="_blank">00:45:29.200</a></span> | <span class="t">And then our output is going to be the output of the second linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2737" target="_blank">00:45:37.280</a></span> | <span class="t">The second linear layer's input will be the value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2739" target="_blank">00:45:39.980</a></span> | <span class="t">The value's input will be the first layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2741" target="_blank">00:45:41.840</a></span> | <span class="t">So we're going to take our input, put it through a linear layer, put that through a value, put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2745" target="_blank">00:45:45.480</a></span> | <span class="t">that through a linear layer, and calculate the MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2750" target="_blank">00:45:50.280</a></span> | <span class="t">OK, that bit hopefully is pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2755" target="_blank">00:45:55.040</a></span> | <span class="t">So what about the backward pass?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2757" target="_blank">00:45:57.780</a></span> | <span class="t">So the backward pass, what I'm going to do-- and you'll see why in a moment-- is I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2763" target="_blank">00:46:03.600</a></span> | <span class="t">to store the gradients of each layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2768" target="_blank">00:46:08.000</a></span> | <span class="t">So for example, the gradients of the loss with respect to its inputs in the layer itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2778" target="_blank">00:46:18.240</a></span> | <span class="t">So I'm going to create a new attribute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2779" target="_blank">00:46:19.560</a></span> | <span class="t">I could call it anything I like, and I'm just going to call it .g.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2783" target="_blank">00:46:23.200</a></span> | <span class="t">So I'm going to create a new attribute called out.g, which is going to contain the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2789" target="_blank">00:46:29.200</a></span> | <span class="t">You don't have to do it this way, but as you'll see, it turns out pretty convenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2794" target="_blank">00:46:34.000</a></span> | <span class="t">So that's just going to be 2 times the difference, because we've got difference squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2799" target="_blank">00:46:39.160</a></span> | <span class="t">So that's just the derivative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2801" target="_blank">00:46:41.860</a></span> | <span class="t">And then we have taken the mean here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2810" target="_blank">00:46:50.480</a></span> | <span class="t">So we have to do the same thing here, divided by the input shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2815" target="_blank">00:46:55.320</a></span> | <span class="t">And so that's those gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2817" target="_blank">00:46:57.400</a></span> | <span class="t">That's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2818" target="_blank">00:46:58.400</a></span> | <span class="t">And now what we need to do is multiply by the gradients of the previous layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2823" target="_blank">00:47:03.120</a></span> | <span class="t">So here's our previous layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2824" target="_blank">00:47:04.720</a></span> | <span class="t">So what are the gradients of a linear layer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2827" target="_blank">00:47:07.080</a></span> | <span class="t">I've created a function for that here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2831" target="_blank">00:47:11.280</a></span> | <span class="t">So the gradient of a linear layer, we're going to need to know the weights of the layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2837" target="_blank">00:47:17.480</a></span> | <span class="t">We're going to need to know the biases of the layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2841" target="_blank">00:47:21.800</a></span> | <span class="t">And then we're also going to know the input to the linear layer, because that's the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2847" target="_blank">00:47:27.600</a></span> | <span class="t">that's actually being manipulated here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2851" target="_blank">00:47:31.440</a></span> | <span class="t">And then we're also going to need the output, because we have to multiply by the gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2857" target="_blank">00:47:37.800</a></span> | <span class="t">because we've got the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2860" target="_blank">00:47:40.240</a></span> | <span class="t">So again, we're going to store the gradients of our input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2866" target="_blank">00:47:46.660</a></span> | <span class="t">So this would be the gradients of our output with respect to the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2870" target="_blank">00:47:50.320</a></span> | <span class="t">And that's simply the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2872" target="_blank">00:47:52.800</a></span> | <span class="t">Because the weights, so a matrix multiplier is just a whole bunch of linear functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2877" target="_blank">00:47:57.220</a></span> | <span class="t">So each one slope is just its weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2880" target="_blank">00:48:00.640</a></span> | <span class="t">But you have to multiply it by the gradient of the outputs because of the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2886" target="_blank">00:48:06.100</a></span> | <span class="t">And then the gradient of the outputs with respect to the weights is going to be the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2894" target="_blank">00:48:14.880</a></span> | <span class="t">output times the output summed up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2899" target="_blank">00:48:19.720</a></span> | <span class="t">I'll talk more about that in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2902" target="_blank">00:48:22.440</a></span> | <span class="t">The derivatives of the bias is very straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2907" target="_blank">00:48:27.440</a></span> | <span class="t">It's the gradients of the output added together because the bias is just a constant value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2917" target="_blank">00:48:37.040</a></span> | <span class="t">So for the chain rule, we simply just use output times 1, which is output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2924" target="_blank">00:48:44.560</a></span> | <span class="t">So for this one here, again, we have to do the same thing we've been doing before, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2928" target="_blank">00:48:48.920</a></span> | <span class="t">is multiply by the output gradients because of the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2933" target="_blank">00:48:53.980</a></span> | <span class="t">And then we've got the input weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2938" target="_blank">00:48:58.200</a></span> | <span class="t">So every single one of those has to be multiplied by the outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2945" target="_blank">00:49:05.440</a></span> | <span class="t">And so that's why we have to do an unsqueezed minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2948" target="_blank">00:49:08.520</a></span> | <span class="t">So what I'm going to do now is I'm going to show you how I would experiment with this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2955" target="_blank">00:49:15.360</a></span> | <span class="t">code in order to understand it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2957" target="_blank">00:49:17.040</a></span> | <span class="t">And I would encourage you to do the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2959" target="_blank">00:49:19.440</a></span> | <span class="t">It's a little harder to do this one cell by cell because we kind of want to put it all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2963" target="_blank">00:49:23.960</a></span> | <span class="t">into this function like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2965" target="_blank">00:49:25.880</a></span> | <span class="t">So we need a way to explore the calculations interactively.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2971" target="_blank">00:49:31.640</a></span> | <span class="t">And the way we do that is by using the Python debugger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2976" target="_blank">00:49:36.160</a></span> | <span class="t">Here is how you-- let me see a few ways to do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2980" target="_blank">00:49:40.200</a></span> | <span class="t">Here's one way to use the Python debugger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2983" target="_blank">00:49:43.440</a></span> | <span class="t">The Python debugger is called pdb.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2985" target="_blank">00:49:45.920</a></span> | <span class="t">So if you say pdb.settrace in your code, then that tells the debugger to stop execution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2995" target="_blank">00:49:55.400</a></span> | <span class="t">when it reaches this line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2996" target="_blank">00:49:56.560</a></span> | <span class="t">So it sets a breakpoint.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=2998" target="_blank">00:49:58.660</a></span> | <span class="t">So if I call forward and backward, you can see here it's stopped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3003" target="_blank">00:50:03.520</a></span> | <span class="t">And the interactive Python debugger, ipdb, has popped up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3007" target="_blank">00:50:07.640</a></span> | <span class="t">With an arrow pointing at the line of code, it's about to run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3011" target="_blank">00:50:11.840</a></span> | <span class="t">And at this point, there's a whole range of things we can do to find out what they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3014" target="_blank">00:50:14.840</a></span> | <span class="t">We hit H for help.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3018" target="_blank">00:50:18.360</a></span> | <span class="t">Understanding how to use the Python debugger is one of the most powerful things I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3022" target="_blank">00:50:22.420</a></span> | <span class="t">you can do to improve your coding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3027" target="_blank">00:50:27.400</a></span> | <span class="t">So one of the most useful things you can do is to print something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3031" target="_blank">00:50:31.040</a></span> | <span class="t">You see all these single-letter things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3033" target="_blank">00:50:33.200</a></span> | <span class="t">They're just shortcuts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3034" target="_blank">00:50:34.200</a></span> | <span class="t">But in a debugger, you want to be able to do things quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3036" target="_blank">00:50:36.000</a></span> | <span class="t">So instead of typing print, I'll just type p.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3039" target="_blank">00:50:39.160</a></span> | <span class="t">So for example, let's take a look at the shape of the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3046" target="_blank">00:50:46.240</a></span> | <span class="t">So I type p for print, input.shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3053" target="_blank">00:50:53.780</a></span> | <span class="t">So I've got a 50,000 by 50 input to the last layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3056" target="_blank">00:50:56.520</a></span> | <span class="t">That makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3057" target="_blank">00:50:57.600</a></span> | <span class="t">These are the hidden activations coming into the last layer for every one of our images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3063" target="_blank">00:51:03.840</a></span> | <span class="t">What about the output gradients?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3072" target="_blank">00:51:12.120</a></span> | <span class="t">And there's that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3073" target="_blank">00:51:13.200</a></span> | <span class="t">And actually, a little trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3075" target="_blank">00:51:15.760</a></span> | <span class="t">You can ignore that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3076" target="_blank">00:51:16.760</a></span> | <span class="t">You don't have to use the p at all if your variable name is not the same as any of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3083" target="_blank">00:51:23.040</a></span> | <span class="t">commands.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3084" target="_blank">00:51:24.580</a></span> | <span class="t">So I could have just typed out.g.shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3092" target="_blank">00:51:32.020</a></span> | <span class="t">Get the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3094" target="_blank">00:51:34.040</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3095" target="_blank">00:51:35.200</a></span> | <span class="t">So you can also put in expressions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3099" target="_blank">00:51:39.400</a></span> | <span class="t">So let's have a look at the shape of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3106" target="_blank">00:51:46.140</a></span> | <span class="t">So the output of this is-- let's see if it makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3109" target="_blank">00:51:49.400</a></span> | <span class="t">We've got the input, 50,000 by 50.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3112" target="_blank">00:51:52.200</a></span> | <span class="t">We put a new axis on the end, unsqueezed minus 1 is the same as indexing it with dot dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3118" target="_blank">00:51:58.480</a></span> | <span class="t">dot comma none.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3119" target="_blank">00:51:59.480</a></span> | <span class="t">So let's put a new axis at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3121" target="_blank">00:52:01.160</a></span> | <span class="t">So that would have become 50,000 by 50 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3130" target="_blank">00:52:10.720</a></span> | <span class="t">And then the outg dot unsqueezed we're putting in the first dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3134" target="_blank">00:52:14.440</a></span> | <span class="t">So we're going to have 50,000 by 50 by 1 times 50,000 by 1 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3141" target="_blank">00:52:21.280</a></span> | <span class="t">And so we're only going to end up getting this broadcasting happening over these last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3145" target="_blank">00:52:25.320</a></span> | <span class="t">two dimensions, which is why we end up with 50,000 by 50 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3150" target="_blank">00:52:30.600</a></span> | <span class="t">And then with summing up-- this makes sense, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3153" target="_blank">00:52:33.960</a></span> | <span class="t">We want to sum up over all of the inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3156" target="_blank">00:52:36.960</a></span> | <span class="t">Each image is individually contributing to the derivative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3162" target="_blank">00:52:42.920</a></span> | <span class="t">And so we want to add them all up to find their total impact, because remember the sum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3166" target="_blank">00:52:46.680</a></span> | <span class="t">of a bunch of-- the derivative of the sum of functions is the sum of the derivatives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3171" target="_blank">00:52:51.000</a></span> | <span class="t">of the functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3172" target="_blank">00:52:52.000</a></span> | <span class="t">So we can just sum them up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3174" target="_blank">00:52:54.680</a></span> | <span class="t">Now this is one of these situations where if you see a times and a sum and an unsqueeze,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3180" target="_blank">00:53:00.400</a></span> | <span class="t">it's not a bad idea to think about Einstein summation notation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3186" target="_blank">00:53:06.240</a></span> | <span class="t">Maybe there's a way to simplify this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3189" target="_blank">00:53:09.280</a></span> | <span class="t">So first of all, let's just see how we can do some more stuff in the debugger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3195" target="_blank">00:53:15.280</a></span> | <span class="t">I'm going to continue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3196" target="_blank">00:53:16.840</a></span> | <span class="t">So just continue running.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3197" target="_blank">00:53:17.920</a></span> | <span class="t">So press C for continue, and it keeps running until it comes back again to the same spot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3205" target="_blank">00:53:25.040</a></span> | <span class="t">And the reason we've come to the same spot twice is because lin grad is called two times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3211" target="_blank">00:53:31.640</a></span> | <span class="t">So we would expect that the second time, we're going to get a different bunch of inputs and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3222" target="_blank">00:53:42.320</a></span> | <span class="t">outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3225" target="_blank">00:53:45.760</a></span> | <span class="t">And so I can print out a tuple of the inputs and output gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3229" target="_blank">00:53:49.100</a></span> | <span class="t">So now, yeah, so this is the first layer going into the second layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3234" target="_blank">00:53:54.680</a></span> | <span class="t">So that's exactly what we would expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3238" target="_blank">00:53:58.000</a></span> | <span class="t">To find out what called this function, you just type w.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3241" target="_blank">00:54:01.600</a></span> | <span class="t">w is where am I?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3244" target="_blank">00:54:04.120</a></span> | <span class="t">And so you can see here where am I?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3246" target="_blank">00:54:06.080</a></span> | <span class="t">Oh, forward and backward was called-- see the arrow?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3249" target="_blank">00:54:09.280</a></span> | <span class="t">That called lin grad the second time, and now we're here in w.g equals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3255" target="_blank">00:54:15.600</a></span> | <span class="t">If we want to find out what w.g ends up being equal to, I can press N to say, go to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3261" target="_blank">00:54:21.560</a></span> | <span class="t">next line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3263" target="_blank">00:54:23.560</a></span> | <span class="t">And so now we've moved from line five to nine six.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3266" target="_blank">00:54:26.480</a></span> | <span class="t">So the instruction point is now looking at line six.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3268" target="_blank">00:54:28.640</a></span> | <span class="t">So I could now print out, for example, w.g.shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3273" target="_blank">00:54:33.000</a></span> | <span class="t">And there's the shape of our weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3277" target="_blank">00:54:37.800</a></span> | <span class="t">One person on the chat has pointed out that you can use breakpoint instead of this import</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3284" target="_blank">00:54:44.680</a></span> | <span class="t">pdb business.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3286" target="_blank">00:54:46.240</a></span> | <span class="t">Unfortunately, the breakpoint keyword doesn't currently work in Jupyter or in IPython.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3294" target="_blank">00:54:54.080</a></span> | <span class="t">So we actually can't, sadly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3296" target="_blank">00:54:56.840</a></span> | <span class="t">That's why I'm doing it the old fashioned way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3298" target="_blank">00:54:58.800</a></span> | <span class="t">So this way, maybe they'll fix the bug at some point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3301" target="_blank">00:55:01.800</a></span> | <span class="t">But for now, you have to type all this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3305" target="_blank">00:55:05.600</a></span> | <span class="t">OK, so those are a few things to know about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3309" target="_blank">00:55:09.120</a></span> | <span class="t">But I would definitely suggest looking up a Python pdb tutorial to become very familiar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3314" target="_blank">00:55:14.480</a></span> | <span class="t">with this incredibly powerful tool because it really is so very handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3321" target="_blank">00:55:21.960</a></span> | <span class="t">So if I just press continue again, it keeps running all the way to the end and it's now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3325" target="_blank">00:55:25.960</a></span> | <span class="t">finished running forward and backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3329" target="_blank">00:55:29.880</a></span> | <span class="t">So when it's finished, we would find that there will now be, for example, a w1.g because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3340" target="_blank">00:55:40.480</a></span> | <span class="t">this is the gradients that it just calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3347" target="_blank">00:55:47.400</a></span> | <span class="t">And there would also be a xtrain.g and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3354" target="_blank">00:55:54.440</a></span> | <span class="t">OK, so let's see if we can simplify this a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3358" target="_blank">00:55:58.880</a></span> | <span class="t">So I would be inclined to take these out and give them their own variable names just to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3365" target="_blank">00:56:05.080</a></span> | <span class="t">make life a bit easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3366" target="_blank">00:56:06.080</a></span> | <span class="t">Would have been better if I'd actually done this before the debugging, so it'd be a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3372" target="_blank">00:56:12.160</a></span> | <span class="t">easier to type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3374" target="_blank">00:56:14.240</a></span> | <span class="t">So let's set I and O equal to input and output dot g dot unsqueeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3380" target="_blank">00:56:20.960</a></span> | <span class="t">OK, so we'll get rid of our breakpoint and double check that we've got our gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3395" target="_blank">00:56:35.160</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3402" target="_blank">00:56:42.560</a></span> | <span class="t">And I guess before we run it, we should probably set those to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3410" target="_blank">00:56:50.920</a></span> | <span class="t">What I would do here to try things out is I'd put my breakpoint there and then I would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3418" target="_blank">00:56:58.400</a></span> | <span class="t">try things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3419" target="_blank">00:56:59.400</a></span> | <span class="t">So let's go next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3421" target="_blank">00:57:01.280</a></span> | <span class="t">And so I realize here that what we're actually doing is we're basically doing exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3430" target="_blank">00:57:10.720</a></span> | <span class="t">same thing as an insum would do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3435" target="_blank">00:57:15.720</a></span> | <span class="t">So I could test that out by trying an insum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3443" target="_blank">00:57:23.280</a></span> | <span class="t">Because I've just got this is being replicated and then I'm summing over that dimension,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3451" target="_blank">00:57:31.680</a></span> | <span class="t">because that's the multiplication that I'm doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3453" target="_blank">00:57:33.280</a></span> | <span class="t">So I'm basically multiplying the first dimension of each and then summing over that dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3459" target="_blank">00:57:39.080</a></span> | <span class="t">So I could try running that and it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3466" target="_blank">00:57:46.840</a></span> | <span class="t">So that's interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3472" target="_blank">00:57:52.640</a></span> | <span class="t">And I've got zeros because I did x_train dot zero, that was silly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3478" target="_blank">00:57:58.960</a></span> | <span class="t">That should be dot gradients dot zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3482" target="_blank">00:58:02.200</a></span> | <span class="t">OK, so let's try doing an insum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3491" target="_blank">00:58:11.560</a></span> | <span class="t">And there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3492" target="_blank">00:58:12.560</a></span> | <span class="t">That seems to be working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3493" target="_blank">00:58:13.920</a></span> | <span class="t">That's pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3494" target="_blank">00:58:14.920</a></span> | <span class="t">So we've we've multiplied this repeating index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3497" target="_blank">00:58:17.740</a></span> | <span class="t">So we were just multiplying the first dimensions together and then summing over them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3502" target="_blank">00:58:22.040</a></span> | <span class="t">So there's no i here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3503" target="_blank">00:58:23.840</a></span> | <span class="t">Now that's not quite the same thing as a matrix multiplication, but we could turn it into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3508" target="_blank">00:58:28.120</a></span> | <span class="t">the same thing as a matrix multiplication just by swapping i and j so that they're the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3513" target="_blank">00:58:33.240</a></span> | <span class="t">other way around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3514" target="_blank">00:58:34.240</a></span> | <span class="t">And that way we'd have ji comma ik.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3519" target="_blank">00:58:39.000</a></span> | <span class="t">And we can swap into dimensions very easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3522" target="_blank">00:58:42.720</a></span> | <span class="t">That's what's called the transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3524" target="_blank">00:58:44.640</a></span> | <span class="t">So that would become a matrix multiplication if we just use the transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3529" target="_blank">00:58:49.080</a></span> | <span class="t">And in numpy, the transpose is the capital T attribute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3533" target="_blank">00:58:53.920</a></span> | <span class="t">So here is exactly the same thing using a matrix multiply and a transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3541" target="_blank">00:59:01.360</a></span> | <span class="t">And let's check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3543" target="_blank">00:59:03.360</a></span> | <span class="t">Yeah, that's the same thing as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3546" target="_blank">00:59:06.680</a></span> | <span class="t">OK, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3548" target="_blank">00:59:08.840</a></span> | <span class="t">So that tells us that now we've checked in our debugger that we can actually replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3556" target="_blank">00:59:16.240</a></span> | <span class="t">all this with a matrix multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3560" target="_blank">00:59:20.280</a></span> | <span class="t">We don't need that anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3566" target="_blank">00:59:26.720</a></span> | <span class="t">Let's see if it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3572" target="_blank">00:59:32.280</a></span> | <span class="t">It does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3573" target="_blank">00:59:33.280</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3577" target="_blank">00:59:37.600</a></span> | <span class="t">X train dot g.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3578" target="_blank">00:59:38.800</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3579" target="_blank">00:59:39.800</a></span> | <span class="t">OK, so hopefully that's convinced you that the debugger is a really handy thing for playing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3587" target="_blank">00:59:47.120</a></span> | <span class="t">around with numeric programming ideas or coding in general.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3592" target="_blank">00:59:52.680</a></span> | <span class="t">And so I think now is a good time to take a break.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3595" target="_blank">00:59:55.280</a></span> | <span class="t">So let's take a eight minute break.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3597" target="_blank">00:59:57.760</a></span> | <span class="t">And I'll see you back here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3598" target="_blank">00:59:58.760</a></span> | <span class="t">Actually, seven minute break.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3599" target="_blank">00:59:59.760</a></span> | <span class="t">I'll see you back here in seven minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3602" target="_blank">01:00:02.840</a></span> | <span class="t">Thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3604" target="_blank">01:00:04.960</a></span> | <span class="t">OK, welcome back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3607" target="_blank">01:00:07.800</a></span> | <span class="t">So we've calculated our derivatives and we want to test them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3613" target="_blank">01:00:13.200</a></span> | <span class="t">Luckily PyTorch already has derivatives implemented.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3617" target="_blank">01:00:17.080</a></span> | <span class="t">So I've got to totally cheat and use PyTorch to calculate the same derivatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3624" target="_blank">01:00:24.160</a></span> | <span class="t">So don't worry about how this works yet, because we're actually going to be doing all this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3627" target="_blank">01:00:27.520</a></span> | <span class="t">from scratch anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3628" target="_blank">01:00:28.520</a></span> | <span class="t">For now, I'm just going to run it all through PyTorch and check that their derivatives are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3633" target="_blank">01:00:33.240</a></span> | <span class="t">the same as ours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3634" target="_blank">01:00:34.840</a></span> | <span class="t">And they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3635" target="_blank">01:00:35.840</a></span> | <span class="t">So we're on the right track.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3637" target="_blank">01:00:37.240</a></span> | <span class="t">OK, so this is all pretty clunky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3640" target="_blank">01:00:40.480</a></span> | <span class="t">I think we can all agree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3642" target="_blank">01:00:42.480</a></span> | <span class="t">And obviously, it's clunky than what we do in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3644" target="_blank">01:00:44.360</a></span> | <span class="t">So how do we simplify things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3646" target="_blank">01:00:46.160</a></span> | <span class="t">There's some really cool refactoring that we can do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3651" target="_blank">01:00:51.240</a></span> | <span class="t">So what we're going to do is we're going to create a whole class for each of our functions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3655" target="_blank">01:00:55.760</a></span> | <span class="t">for the value function and for the linear function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3660" target="_blank">01:01:00.920</a></span> | <span class="t">So the way that we're going to do this is we're going to create a dunder call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3671" target="_blank">01:01:11.040</a></span> | <span class="t">What does dunder call do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3672" target="_blank">01:01:12.200</a></span> | <span class="t">Let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3673" target="_blank">01:01:13.640</a></span> | <span class="t">So if I create a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3682" target="_blank">01:01:22.280</a></span> | <span class="t">And we're just going to set that to print hello.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3688" target="_blank">01:01:28.340</a></span> | <span class="t">So if I create an instance of that class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3692" target="_blank">01:01:32.720</a></span> | <span class="t">And then I call it as if it was a function, oops, missing the dunder bit here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3702" target="_blank">01:01:42.320</a></span> | <span class="t">Call it as if it's a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3703" target="_blank">01:01:43.960</a></span> | <span class="t">It says hi.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3705" target="_blank">01:01:45.560</a></span> | <span class="t">So in other words, you know, everything can be changed in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3708" target="_blank">01:01:48.840</a></span> | <span class="t">You can change how a class behaves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3710" target="_blank">01:01:50.680</a></span> | <span class="t">You can make it look like a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3714" target="_blank">01:01:54.320</a></span> | <span class="t">And to do that, you simply define dunder call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3717" target="_blank">01:01:57.800</a></span> | <span class="t">You could pass it an argument like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3728" target="_blank">01:02:08.120</a></span> | <span class="t">OK, so that's what dunder call does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3731" target="_blank">01:02:11.240</a></span> | <span class="t">It just says it's just a little bit of syntax, sugary kind of stuff to say I want to be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3736" target="_blank">01:02:16.280</a></span> | <span class="t">to treat it as if it's a function without any method at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3741" target="_blank">01:02:21.000</a></span> | <span class="t">You can still do it the method way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3742" target="_blank">01:02:22.320</a></span> | <span class="t">You could have done this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3743" target="_blank">01:02:23.320</a></span> | <span class="t">Don't know why you'd want to, but you can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3746" target="_blank">01:02:26.080</a></span> | <span class="t">But because it's got this special magic named under call, you don't have to write the dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3750" target="_blank">01:02:30.640</a></span> | <span class="t">dunder call at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3752" target="_blank">01:02:32.920</a></span> | <span class="t">So here, if we create an instance of the relu class, we can treat it as a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3759" target="_blank">01:02:39.280</a></span> | <span class="t">And what it's going to do is it's going to take its input and do the relu on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3764" target="_blank">01:02:44.400</a></span> | <span class="t">But if you look back at the forward and backward, there's something very interesting about the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3769" target="_blank">01:02:49.280</a></span> | <span class="t">backward pass, which is that it has to know about, for example, this intermediate calculation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3777" target="_blank">01:02:57.640</a></span> | <span class="t">gets passed over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3780" target="_blank">01:03:00.200</a></span> | <span class="t">This intermediate calculation gets passed over here because of the chain rule, we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3785" target="_blank">01:03:05.120</a></span> | <span class="t">to need some of the intermediate calculations and not just the chain rule because of actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3790" target="_blank">01:03:10.640</a></span> | <span class="t">how the derivatives are calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3792" target="_blank">01:03:12.920</a></span> | <span class="t">So we need to actually store each of the layer intermediate calculations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3799" target="_blank">01:03:19.880</a></span> | <span class="t">And so that's why relu doesn't just calculate and return the output, but it also stores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3807" target="_blank">01:03:27.800</a></span> | <span class="t">its output and it also stores its input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3812" target="_blank">01:03:32.120</a></span> | <span class="t">So that way, then, when we call backward, we know how to calculate that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3818" target="_blank">01:03:38.840</a></span> | <span class="t">We set the inputs gradient because remember we stored the input, so we can do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3825" target="_blank">01:03:45.200</a></span> | <span class="t">And it's going to just be, oh, import greater than zero dot float.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3829" target="_blank">01:03:49.960</a></span> | <span class="t">So that's the definition of the derivative of a relu and then chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3841" target="_blank">01:04:01.500</a></span> | <span class="t">So that's how we can calculate the forward pass and the backward pass for relu.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3847" target="_blank">01:04:07.640</a></span> | <span class="t">And we're not going to have to then store all this intermediate stuff separately, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3851" target="_blank">01:04:11.080</a></span> | <span class="t">going to happen automatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3852" target="_blank">01:04:12.680</a></span> | <span class="t">So we can do the same thing for a linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3854" target="_blank">01:04:14.800</a></span> | <span class="t">Now linear layer needs some additional state, weights and biases, relu doesn't, so there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3861" target="_blank">01:04:21.780</a></span> | <span class="t">no edit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3863" target="_blank">01:04:23.360</a></span> | <span class="t">So when we create a linear layer, we have to say, what are its weights?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3866" target="_blank">01:04:26.340</a></span> | <span class="t">What are its biases?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3867" target="_blank">01:04:27.340</a></span> | <span class="t">We store them away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3869" target="_blank">01:04:29.300</a></span> | <span class="t">And then when we call it on the forward pass, just like before, we store the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3873" target="_blank">01:04:33.520</a></span> | <span class="t">So that's exactly the same line here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3876" target="_blank">01:04:36.320</a></span> | <span class="t">And just like before, we calculate the output and store it and then return it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3881" target="_blank">01:04:41.440</a></span> | <span class="t">And this time, of course, we just call lin.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3884" target="_blank">01:04:44.960</a></span> | <span class="t">And then for the backward pass, it's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3890" target="_blank">01:04:50.040</a></span> | <span class="t">So the input gradients we calculate just like before, oh, dot t brackets is exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3897" target="_blank">01:04:57.080</a></span> | <span class="t">same with a little t as big T is as a property.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3901" target="_blank">01:05:01.440</a></span> | <span class="t">So that's the same thing, that's just the transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3906" target="_blank">01:05:06.680</a></span> | <span class="t">Calculate the gradients of the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3910" target="_blank">01:05:10.440</a></span> | <span class="t">Again with the chain rule and the bias, just like we did it before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3914" target="_blank">01:05:14.120</a></span> | <span class="t">And they're all being stored in the appropriate places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3917" target="_blank">01:05:17.960</a></span> | <span class="t">And then for MSE, we can do the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3919" target="_blank">01:05:19.680</a></span> | <span class="t">We don't just calculate the MSE, but we also store it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3923" target="_blank">01:05:23.260</a></span> | <span class="t">And we also, now the MSE needs two things, an input and a target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3927" target="_blank">01:05:27.960</a></span> | <span class="t">So we'll store those as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3930" target="_blank">01:05:30.020</a></span> | <span class="t">So then in the backward pass, we can calculate its gradient of the input as being two times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3938" target="_blank">01:05:38.940</a></span> | <span class="t">the difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3942" target="_blank">01:05:42.740</a></span> | <span class="t">And there it all is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3944" target="_blank">01:05:44.560</a></span> | <span class="t">So our model now, it's much easier to define.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3949" target="_blank">01:05:49.480</a></span> | <span class="t">We can just create a bunch of layers, linear w1b1, relu, linear w2b2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3957" target="_blank">01:05:57.680</a></span> | <span class="t">And then we can store an instance of the MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3961" target="_blank">01:06:01.080</a></span> | <span class="t">This is not calling MSE, it's creating an instance of the MSE class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3964" target="_blank">01:06:04.900</a></span> | <span class="t">And this is an instance of the ln class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3966" target="_blank">01:06:06.680</a></span> | <span class="t">This is an instance of the relu class, so they're just being stored.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3969" target="_blank">01:06:09.760</a></span> | <span class="t">So then when we call the model, we pass it our inputs and our target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3976" target="_blank">01:06:16.720</a></span> | <span class="t">We go through each layer, set x equal to the result of calling that layer, and then pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3983" target="_blank">01:06:23.780</a></span> | <span class="t">that to the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3985" target="_blank">01:06:25.080</a></span> | <span class="t">So there's something kind of interesting here that you might've noticed, which is that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=3989" target="_blank">01:06:29.840</a></span> | <span class="t">don't have-- where do we do it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4005" target="_blank">01:06:45.620</a></span> | <span class="t">Something interesting here is that we don't have two separate functions inside our model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4011" target="_blank">01:06:51.040</a></span> | <span class="t">the loss function being applied to a separate neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4016" target="_blank">01:06:56.720</a></span> | <span class="t">But we've actually integrated the loss function directly into the neural net, into the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4022" target="_blank">01:07:02.320</a></span> | <span class="t">See how the loss is being calculated inside the model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4026" target="_blank">01:07:06.520</a></span> | <span class="t">Now that's neither better nor worse than having it separately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4029" target="_blank">01:07:09.340</a></span> | <span class="t">It's just different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4030" target="_blank">01:07:10.440</a></span> | <span class="t">And so generally, a lot of hugging face stuff does it this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4033" target="_blank">01:07:13.120</a></span> | <span class="t">They actually put the loss inside the forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4037" target="_blank">01:07:17.100</a></span> | <span class="t">That stuff in fast.ai and a lot of other libraries does it separately, which is the loss is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4042" target="_blank">01:07:22.600</a></span> | <span class="t">whole separate function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4043" target="_blank">01:07:23.800</a></span> | <span class="t">And the model only returns the result of putting it through the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4047" target="_blank">01:07:27.000</a></span> | <span class="t">So for this model, we're going to actually do the loss function inside the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4052" target="_blank">01:07:32.460</a></span> | <span class="t">So for backward, we just do each thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4054" target="_blank">01:07:34.760</a></span> | <span class="t">So self.loss.backwards-- so self.loss is the MSE object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4058" target="_blank">01:07:38.840</a></span> | <span class="t">So that's going to call backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4062" target="_blank">01:07:42.400</a></span> | <span class="t">And it's stored when it was called here, it was storing, remember, the inputs, the targets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4068" target="_blank">01:07:48.960</a></span> | <span class="t">the outputs, so it can calculate the backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4072" target="_blank">01:07:52.920</a></span> | <span class="t">And then we go through each layer is in reverse, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4075" target="_blank">01:07:55.960</a></span> | <span class="t">This is back propagation, backwards reversed, calling backward on each one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4082" target="_blank">01:08:02.920</a></span> | <span class="t">So that's pretty interesting, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4091" target="_blank">01:08:11.740</a></span> | <span class="t">So now we can calculate the model, we can calculate the loss, we can call backward,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4101" target="_blank">01:08:21.080</a></span> | <span class="t">and then we can check that each of the gradients that we stored earlier are equal to each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4112" target="_blank">01:08:32.640</a></span> | <span class="t">our new gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4115" target="_blank">01:08:35.080</a></span> | <span class="t">OK, so William's asked a very good question, that is, if you do put the loss inside here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4124" target="_blank">01:08:44.520</a></span> | <span class="t">how on earth do you actually get predictions?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4128" target="_blank">01:08:48.920</a></span> | <span class="t">So generally, what happens is, in practice, hugging face models do something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4135" target="_blank">01:08:55.520</a></span> | <span class="t">I'll say self.preds equals x, and then they'll say self.finalloss equals that, and then return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4154" target="_blank">01:09:14.140</a></span> | <span class="t">self.finalloss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4156" target="_blank">01:09:16.720</a></span> | <span class="t">And that way-- I guess you don't even need that last bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4160" target="_blank">01:09:20.120</a></span> | <span class="t">Well, that's really the-- anyway, that is what they do, so I'll leave it there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4163" target="_blank">01:09:23.920</a></span> | <span class="t">And so that way, you can kind of check, like, model.preds, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4172" target="_blank">01:09:32.040</a></span> | <span class="t">So it'll be something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4173" target="_blank">01:09:33.520</a></span> | <span class="t">Or alternatively, you can return not just the loss, but both as a dictionary, stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4178" target="_blank">01:09:38.140</a></span> | <span class="t">like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4179" target="_blank">01:09:39.140</a></span> | <span class="t">So there's a few different ways you could do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4180" target="_blank">01:09:40.680</a></span> | <span class="t">Actually, now I think about it, I think that's what they do, is they actually return both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4185" target="_blank">01:09:45.480</a></span> | <span class="t">as a dictionary, so it would be like return dictionary loss equals that, comma, preds equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4208" target="_blank">01:10:08.200</a></span> | <span class="t">that, something like that, I guess, is what they would do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4212" target="_blank">01:10:12.360</a></span> | <span class="t">Anyway, there's a few different ways to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4215" target="_blank">01:10:15.520</a></span> | <span class="t">OK, so hopefully you can see that this is really making it nice and easy for us to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4224" target="_blank">01:10:24.000</a></span> | <span class="t">our forward pass and our backward pass without all of this manual fiddling around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4231" target="_blank">01:10:31.760</a></span> | <span class="t">Every class now can be totally, separately considered and can be combined however we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4240" target="_blank">01:10:40.440</a></span> | <span class="t">want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4241" target="_blank">01:10:41.440</a></span> | <span class="t">So you could try creating a bigger neural net if you want to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4245" target="_blank">01:10:45.840</a></span> | <span class="t">But we can refactor it more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4247" target="_blank">01:10:47.080</a></span> | <span class="t">So basically, as a rule of thumb, when you see repeated code, self.mp equals imp, self.mp</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4253" target="_blank">01:10:53.800</a></span> | <span class="t">equals imp, self.ax equals return self.out, self.out equals return self.out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4259" target="_blank">01:10:59.680</a></span> | <span class="t">That's a sign you can refactor things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4261" target="_blank">01:11:01.740</a></span> | <span class="t">And so what we can do is, a simple refactoring is to create a new class called module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4268" target="_blank">01:11:08.600</a></span> | <span class="t">And module's going to do those things we just said.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4270" target="_blank">01:11:10.240</a></span> | <span class="t">It's going to store the inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4273" target="_blank">01:11:13.800</a></span> | <span class="t">And it's going to call something called self.forward in order to create our self.out, because remember,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4279" target="_blank">01:11:19.800</a></span> | <span class="t">that was one of the things we had again and again and again, self.out, self.out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4284" target="_blank">01:11:24.280</a></span> | <span class="t">And then return it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4287" target="_blank">01:11:27.040</a></span> | <span class="t">And so now, there's going to be a thing called forward, which actually, in this, it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4293" target="_blank">01:11:33.700</a></span> | <span class="t">do anything, because the whole purpose of this module is to be inherited.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4297" target="_blank">01:11:37.800</a></span> | <span class="t">When we call backward, it's going to call self.backward passing in self.out, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4303" target="_blank">01:11:43.480</a></span> | <span class="t">notice, all of our backwards always wanted to get hold of self.out, self.out, self.out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4312" target="_blank">01:11:52.860</a></span> | <span class="t">because we need it for the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4315" target="_blank">01:11:55.760</a></span> | <span class="t">So let's pass that in, and pass in those arguments that we stored earlier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4321" target="_blank">01:12:01.280</a></span> | <span class="t">And so star means take all of the arguments, regardless whether it's 0, 1, 2, or more,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4327" target="_blank">01:12:07.320</a></span> | <span class="t">and put them into a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4329" target="_blank">01:12:09.800</a></span> | <span class="t">And then that's what happens when it's inside the actual signature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4333" target="_blank">01:12:13.240</a></span> | <span class="t">And then when you call a function using star, it says take this list and expand them into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4338" target="_blank">01:12:18.160</a></span> | <span class="t">separate arguments, calling backward with each one separately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4342" target="_blank">01:12:22.880</a></span> | <span class="t">So now, for relu, look how much simpler it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4345" target="_blank">01:12:25.280</a></span> | <span class="t">Let's copy the old relu to the new relu.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4349" target="_blank">01:12:29.420</a></span> | <span class="t">So the old relu had to do all this storing stuff manually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4354" target="_blank">01:12:34.080</a></span> | <span class="t">And it had all the self.stuff as well, but now we can get rid of all of that and just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4359" target="_blank">01:12:39.040</a></span> | <span class="t">implement forward, because that's the thing that's being called, and that's the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4363" target="_blank">01:12:43.400</a></span> | <span class="t">that we need to implement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4367" target="_blank">01:12:47.740</a></span> | <span class="t">And so now the forward of relu just does the one thing we want, which also makes the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4371" target="_blank">01:12:51.320</a></span> | <span class="t">much cleaner and more understandable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4373" target="_blank">01:12:53.920</a></span> | <span class="t">Did over backward, it just does the one thing we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4377" target="_blank">01:12:57.880</a></span> | <span class="t">So that's nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4378" target="_blank">01:12:58.880</a></span> | <span class="t">Now, we still have to multiply it, but I still have to do the chain rule manually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4383" target="_blank">01:13:03.880</a></span> | <span class="t">But the same thing for linear, same thing for MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4387" target="_blank">01:13:07.200</a></span> | <span class="t">So these all look a lot nicer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4389" target="_blank">01:13:09.520</a></span> | <span class="t">And one thing to point out here is that there's often opportunities to manually speed things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4399" target="_blank">01:13:19.920</a></span> | <span class="t">up when you create custom autograd functions in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4404" target="_blank">01:13:24.440</a></span> | <span class="t">And here's an example, look, this calculation is being done twice, which seems like a waste,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4412" target="_blank">01:13:32.280</a></span> | <span class="t">doesn't it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4413" target="_blank">01:13:33.280</a></span> | <span class="t">So at the cost of some memory, we could instead store that calculation as diff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4427" target="_blank">01:13:47.560</a></span> | <span class="t">Right, and I guess we'd have to store it for use later, so it'll need to be self.diff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4437" target="_blank">01:13:57.920</a></span> | <span class="t">And at the cost of that memory, we could now remove this redundant calculation because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4448" target="_blank">01:14:08.280</a></span> | <span class="t">we've done it once before already and stored it and just use it directly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4458" target="_blank">01:14:18.960</a></span> | <span class="t">And this is something that you can often do in neural nets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4462" target="_blank">01:14:22.080</a></span> | <span class="t">So there's this compromise between storing things, the memory use of that, and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4472" target="_blank">01:14:32.880</a></span> | <span class="t">computational speed up of not having to recalculate it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4476" target="_blank">01:14:36.160</a></span> | <span class="t">This is something we come across a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4478" target="_blank">01:14:38.360</a></span> | <span class="t">And so now we can call it in the same way, create our model, passing in all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4482" target="_blank">01:14:42.360</a></span> | <span class="t">layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4483" target="_blank">01:14:43.360</a></span> | <span class="t">So you can see with our model, so the model hasn't changed at this point, the definition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4490" target="_blank">01:14:50.680</a></span> | <span class="t">was up here, we just pass in the layers, sorry, not the layers, the weights for the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4503" target="_blank">01:15:03.640</a></span> | <span class="t">Create the loss, call backward, and look, it's the same, hooray.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4511" target="_blank">01:15:11.800</a></span> | <span class="t">Okay, so thankfully PyTorch has written all this for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4519" target="_blank">01:15:19.320</a></span> | <span class="t">And remember, according to rules of our game, once we've reimplemented it, we're allowed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4522" target="_blank">01:15:22.280</a></span> | <span class="t">to use PyTorch's version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4523" target="_blank">01:15:23.560</a></span> | <span class="t">So PyTorch calls their version nn.module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4530" target="_blank">01:15:30.320</a></span> | <span class="t">And so it's exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4532" target="_blank">01:15:32.480</a></span> | <span class="t">We inherit from nn.module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4534" target="_blank">01:15:34.280</a></span> | <span class="t">So if we want to create a linear layer, just like this one, rather than inheriting from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4538" target="_blank">01:15:38.160</a></span> | <span class="t">our module, we will inherit from that module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4542" target="_blank">01:15:42.960</a></span> | <span class="t">But everything's exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4545" target="_blank">01:15:45.200</a></span> | <span class="t">So we create our, we can create our random numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4549" target="_blank">01:15:49.280</a></span> | <span class="t">So in this case, rather than passing in the already randomized weights, we're actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4552" target="_blank">01:15:52.720</a></span> | <span class="t">going to generate the random weights ourselves and the zeroed biases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4557" target="_blank">01:15:57.400</a></span> | <span class="t">And then here's our linear layer, which you could also use Lin for that, of course, to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4563" target="_blank">01:16:03.920</a></span> | <span class="t">find our forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4565" target="_blank">01:16:05.640</a></span> | <span class="t">And why don't we need to define backward?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4570" target="_blank">01:16:10.240</a></span> | <span class="t">Because PyTorch already knows the derivatives of all of the functions in PyTorch, and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4578" target="_blank">01:16:18.520</a></span> | <span class="t">knows how to use the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4580" target="_blank">01:16:20.400</a></span> | <span class="t">So we don't have to do the backward at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4583" target="_blank">01:16:23.000</a></span> | <span class="t">It'll actually do that entirely for us, which is very cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4587" target="_blank">01:16:27.920</a></span> | <span class="t">So we only need forward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4589" target="_blank">01:16:29.080</a></span> | <span class="t">We don't need backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4591" target="_blank">01:16:31.320</a></span> | <span class="t">So let's create a model that is a zn.module, otherwise it's exactly the same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4597" target="_blank">01:16:37.120</a></span> | <span class="t">And now we're going to use PyTorch's MSE loss because we've already implemented ourselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4602" target="_blank">01:16:42.200</a></span> | <span class="t">It's very common to use torch.nn.functional as capital F. This is where lots of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4608" target="_blank">01:16:48.720</a></span> | <span class="t">handy functions live, including MSE loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4613" target="_blank">01:16:53.720</a></span> | <span class="t">And so now you know why we need the colon, colon, none, because you saw the problem if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4617" target="_blank">01:16:57.160</a></span> | <span class="t">we don't have it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4619" target="_blank">01:16:59.760</a></span> | <span class="t">And so create the model, call backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4623" target="_blank">01:17:03.120</a></span> | <span class="t">And remember, we stored our gradients in something called dot G. PyTorch stores them in something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4629" target="_blank">01:17:09.520</a></span> | <span class="t">called dot grad, but it's doing exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4633" target="_blank">01:17:13.080</a></span> | <span class="t">So there is the exact same values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4640" target="_blank">01:17:20.480</a></span> | <span class="t">So let's take stock of where we're up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4642" target="_blank">01:17:22.520</a></span> | <span class="t">So we've created a matrix multiplication from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4647" target="_blank">01:17:27.280</a></span> | <span class="t">We've created linear layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4649" target="_blank">01:17:29.940</a></span> | <span class="t">We've created a complete backprop system of modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4654" target="_blank">01:17:34.480</a></span> | <span class="t">We can now calculate both the forward pass and the backward pass for linear layers and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4660" target="_blank">01:17:40.440</a></span> | <span class="t">values so we can create a multi-layer perceptron.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4664" target="_blank">01:17:44.120</a></span> | <span class="t">So we're now up to a point where we can train a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4669" target="_blank">01:17:49.000</a></span> | <span class="t">So let's do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4674" target="_blank">01:17:54.560</a></span> | <span class="t">Mini batch training, notebook number four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4677" target="_blank">01:17:57.320</a></span> | <span class="t">So same first cell as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4679" target="_blank">01:17:59.160</a></span> | <span class="t">We won't go through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4680" target="_blank">01:18:00.840</a></span> | <span class="t">This cell's also the same as before, so we won't go through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4683" target="_blank">01:18:03.920</a></span> | <span class="t">Here's the same model that we had before, so we won't go through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4687" target="_blank">01:18:07.400</a></span> | <span class="t">So just running all that to see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4690" target="_blank">01:18:10.840</a></span> | <span class="t">OK, so the first thing we should do, I think, is to improve our loss function so it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4697" target="_blank">01:18:17.040</a></span> | <span class="t">total rubbish anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4701" target="_blank">01:18:21.180</a></span> | <span class="t">So if you watched part one, you might recall that there are some Excel notebooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4708" target="_blank">01:18:28.360</a></span> | <span class="t">One of those Excel notebooks is entropy example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4713" target="_blank">01:18:33.680</a></span> | <span class="t">OK, so this is what we looked at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4717" target="_blank">01:18:37.120</a></span> | <span class="t">So just to remind you, what we're doing now is which we're saying, OK, rather than outputting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4730" target="_blank">01:18:50.400</a></span> | <span class="t">a single number for each image, we're going to instead output 10 numbers for each image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4743" target="_blank">01:19:03.400</a></span> | <span class="t">And so that's going to be a one hot encoded set of-- it'll be like 1, 0, 0, 0, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4755" target="_blank">01:19:15.080</a></span> | <span class="t">And so then that's going to be-- well, actually, the outputs won't be 1, 0, 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4759" target="_blank">01:19:19.280</a></span> | <span class="t">They'll be basically probabilities, won't they?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4761" target="_blank">01:19:21.320</a></span> | <span class="t">So it'll be like 0.99 comma 0.01, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4769" target="_blank">01:19:29.600</a></span> | <span class="t">And the targets will be one hot encoded.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4772" target="_blank">01:19:32.940</a></span> | <span class="t">So if it's the digit 0, for example, it might be 1, 0, 0, 0, 0, dot, dot, dot for all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4781" target="_blank">01:19:41.040</a></span> | <span class="t">10 possibilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4783" target="_blank">01:19:43.560</a></span> | <span class="t">And so to see how good is it-- so in this case, it's really good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4787" target="_blank">01:19:47.560</a></span> | <span class="t">It had a 0.99 probability prediction that it's 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4791" target="_blank">01:19:51.360</a></span> | <span class="t">And indeed, it is because this is the 100 encoded version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4795" target="_blank">01:19:55.840</a></span> | <span class="t">And so the way we implement that is we don't even need to actually do the one hot encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4805" target="_blank">01:20:05.440</a></span> | <span class="t">thanks to some tricks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4806" target="_blank">01:20:06.760</a></span> | <span class="t">We can actually just directly store the integer, but we can treat it as if it's one hot encoded.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4812" target="_blank">01:20:12.080</a></span> | <span class="t">So we can just store the actual target 0 as an integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4819" target="_blank">01:20:19.440</a></span> | <span class="t">So the way we do that is we say, for example, for a single output, oh, it could be, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4827" target="_blank">01:20:27.760</a></span> | <span class="t">say, cat dog plane fish building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4831" target="_blank">01:20:31.280</a></span> | <span class="t">The neural nets bits out a bunch of outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4834" target="_blank">01:20:34.840</a></span> | <span class="t">What we do for Softmax is we go e to the power of each of those outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4843" target="_blank">01:20:43.820</a></span> | <span class="t">We sum up all of those e to the power ofs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4846" target="_blank">01:20:46.160</a></span> | <span class="t">So here's the e to the power of each of those outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4848" target="_blank">01:20:48.840</a></span> | <span class="t">This is the sum of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4850" target="_blank">01:20:50.880</a></span> | <span class="t">And then we divide each one by the sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4856" target="_blank">01:20:56.000</a></span> | <span class="t">So divide each one by the sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4860" target="_blank">01:21:00.500</a></span> | <span class="t">That gives us our Softmaxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4863" target="_blank">01:21:03.040</a></span> | <span class="t">And then for the loss function, we then compare those Softmaxes to the one hot encoded version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4871" target="_blank">01:21:11.060</a></span> | <span class="t">So let's say it was a dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4872" target="_blank">01:21:12.320</a></span> | <span class="t">Then it's going to have a 1 for dog and 0 everywhere else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4878" target="_blank">01:21:18.280</a></span> | <span class="t">And then Softmax, this is from this nice blog post here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4887" target="_blank">01:21:27.520</a></span> | <span class="t">This is the calculation sum of the ones and zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4892" target="_blank">01:21:32.840</a></span> | <span class="t">So each of the ones and zeros multiplied by the log of the probabilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4897" target="_blank">01:21:37.920</a></span> | <span class="t">So here is the log probability times the actuals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4904" target="_blank">01:21:44.520</a></span> | <span class="t">And since the actuals are either 0 or 1, and only one of them is going to be a 1, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4908" target="_blank">01:21:48.280</a></span> | <span class="t">only going to end up with one value here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4911" target="_blank">01:21:51.120</a></span> | <span class="t">And so if we add them up, it's all 0 except for one of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4916" target="_blank">01:21:56.040</a></span> | <span class="t">So that's cross entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4919" target="_blank">01:21:59.800</a></span> | <span class="t">So in this special case where the output's one hot encoded, then doing the one hot encoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4927" target="_blank">01:22:07.480</a></span> | <span class="t">multiplied by the log Softmax is actually identical to simply saying, oh, dog is in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4936" target="_blank">01:22:16.040</a></span> | <span class="t">this row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4937" target="_blank">01:22:17.640</a></span> | <span class="t">Let's just look it up directly and take its log Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4940" target="_blank">01:22:20.840</a></span> | <span class="t">We can just index directly into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4943" target="_blank">01:22:23.460</a></span> | <span class="t">So it's exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4950" target="_blank">01:22:30.000</a></span> | <span class="t">So that's just review.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4951" target="_blank">01:22:31.600</a></span> | <span class="t">So if you haven't seen that before, then yeah, go and watch the part one video where we went</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4956" target="_blank">01:22:36.560</a></span> | <span class="t">into that in a lot more detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4960" target="_blank">01:22:40.340</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4963" target="_blank">01:22:43.080</a></span> | <span class="t">So here's our Softmax calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4965" target="_blank">01:22:45.440</a></span> | <span class="t">It's a to the power of each output divided by the sum of them, or we can use sigma notation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4971" target="_blank">01:22:51.840</a></span> | <span class="t">to say exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4974" target="_blank">01:22:54.880</a></span> | <span class="t">And as you can see, Tupler Notebook lets us use LaTeX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4980" target="_blank">01:23:00.800</a></span> | <span class="t">If you haven't used LaTeX before, it's actually surprisingly easy to learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4985" target="_blank">01:23:05.320</a></span> | <span class="t">You just put dollar signs around your equations like this and your equations backslash is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4992" target="_blank">01:23:12.280</a></span> | <span class="t">going to be kind of like your functions, if you like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=4995" target="_blank">01:23:15.400</a></span> | <span class="t">And curly parentheses, curly curlies are used to kind of for arguments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5002" target="_blank">01:23:22.040</a></span> | <span class="t">So you can see here, here is e to the power of and then underscore is used for subscript.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5007" target="_blank">01:23:27.240</a></span> | <span class="t">So this is X subscript I and power of is used for superscripts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5013" target="_blank">01:23:33.100</a></span> | <span class="t">So here's dots.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5017" target="_blank">01:23:37.080</a></span> | <span class="t">You can see here it is dots.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5019" target="_blank">01:23:39.760</a></span> | <span class="t">So it's actually, yeah, learning LaTeX is easier than you might expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5023" target="_blank">01:23:43.720</a></span> | <span class="t">It can be quite convenient for writing these functions when you want to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5027" target="_blank">01:23:47.520</a></span> | <span class="t">So anyway, that's what Softmax is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5030" target="_blank">01:23:50.080</a></span> | <span class="t">As we'll see in a moment, well, actually, as you've already seen, in cross entropy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5035" target="_blank">01:23:55.480</a></span> | <span class="t">we don't really want Softmax, we want log of Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5039" target="_blank">01:23:59.960</a></span> | <span class="t">So log of Softmax is, here it is, so we've got x dot exp, so e to the x, divided by x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5049" target="_blank">01:24:09.240</a></span> | <span class="t">dot exp dot sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5052" target="_blank">01:24:12.520</a></span> | <span class="t">And we're going to sum up over the last dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5056" target="_blank">01:24:16.420</a></span> | <span class="t">And then we actually want to keep that dimension so that when we do the divided by, we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5062" target="_blank">01:24:22.560</a></span> | <span class="t">to be trailing unit axis for exactly the same reason we saw when we did our MSE loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5068" target="_blank">01:24:28.420</a></span> | <span class="t">So if you sum with keep dim equals true, it leaves a unit axis in that last position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5075" target="_blank">01:24:35.720</a></span> | <span class="t">So we don't have to put it back to avoid that horrible out of product issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5080" target="_blank">01:24:40.520</a></span> | <span class="t">So this is the equivalent of this and then dot log.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5087" target="_blank">01:24:47.320</a></span> | <span class="t">So that's log of Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5090" target="_blank">01:24:50.200</a></span> | <span class="t">So there is the log of the Softmax with the predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5095" target="_blank">01:24:55.160</a></span> | <span class="t">Now in terms of high school math that you may have forgotten, but you definitely are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5101" target="_blank">01:25:01.160</a></span> | <span class="t">going to want to know, a key piece that in that list of things is log and exponent rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5112" target="_blank">01:25:12.680</a></span> | <span class="t">So check out Khan Academy or similar if you've forgotten them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5117" target="_blank">01:25:17.700</a></span> | <span class="t">But a quick reminder is, for example, the one we mentioned here, log of A over B equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5133" target="_blank">01:25:33.600</a></span> | <span class="t">log of A minus log of B and equivalently log of A times B equals log of A plus log of B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5156" target="_blank">01:25:56.600</a></span> | <span class="t">And these are very handy because for example, division can take a long time, multiply can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5163" target="_blank">01:26:03.100</a></span> | <span class="t">create really big numbers that have lots of floating point error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5167" target="_blank">01:26:07.600</a></span> | <span class="t">Being able to replace these things with pluses and minuses is very handy indeed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5172" target="_blank">01:26:12.420</a></span> | <span class="t">In fact, I used to give people an interview question 20 years ago, a company which I did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5179" target="_blank">01:26:19.320</a></span> | <span class="t">a lot of stuff with SQL and math.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5181" target="_blank">01:26:21.840</a></span> | <span class="t">SQL actually only has a sum function for group by clauses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5188" target="_blank">01:26:28.960</a></span> | <span class="t">And I used to ask people how you would deal with calculating a compound interest column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5195" target="_blank">01:26:35.040</a></span> | <span class="t">where the answer is basically that you have to say, because this compound interest is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5200" target="_blank">01:26:40.320</a></span> | <span class="t">taking products.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5201" target="_blank">01:26:41.320</a></span> | <span class="t">So it has to be the sum of the log of the column and then e to the power of all that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5208" target="_blank">01:26:48.800</a></span> | <span class="t">So it's like all kinds of little places that these things come in handy, but they come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5211" target="_blank">01:26:51.840</a></span> | <span class="t">into neural nets all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5222" target="_blank">01:27:02.200</a></span> | <span class="t">So we're going to take advantage of that because we've got a divided by that's being logged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5230" target="_blank">01:27:10.280</a></span> | <span class="t">And also rather handily, we're going to have therefore the log of exp.exp minus the log</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5241" target="_blank">01:27:21.640</a></span> | <span class="t">of this, but exp and log opposites.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5244" target="_blank">01:27:24.840</a></span> | <span class="t">So that is going to end up just being x minus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5249" target="_blank">01:27:29.220</a></span> | <span class="t">So log softmax is just x minus all this logged and here it is all this logged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5257" target="_blank">01:27:37.760</a></span> | <span class="t">So that's nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5262" target="_blank">01:27:42.740</a></span> | <span class="t">So here's our simplified version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5264" target="_blank">01:27:44.640</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5265" target="_blank">01:27:45.640</a></span> | <span class="t">Now there's another very cool trick, which is one of these things I figured out myself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5273" target="_blank">01:27:53.760</a></span> | <span class="t">and then discovered other people had known it for years.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5277" target="_blank">01:27:57.800</a></span> | <span class="t">So not my trick, but it's always nice to rediscover things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5282" target="_blank">01:28:02.880</a></span> | <span class="t">The trick is what's written here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5284" target="_blank">01:28:04.360</a></span> | <span class="t">Let me explain what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5287" target="_blank">01:28:07.560</a></span> | <span class="t">This piece here, the log of this sum, right, this sum here, we've got x.exp.sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5296" target="_blank">01:28:16.480</a></span> | <span class="t">Now x could be some pretty big numbers and e to the power of that's going to be really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5300" target="_blank">01:28:20.560</a></span> | <span class="t">big numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5302" target="_blank">01:28:22.160</a></span> | <span class="t">And e to the power of things creating really big numbers, well, really big numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5306" target="_blank">01:28:26.800</a></span> | <span class="t">There's much less precision in your computer's floating point handling the further you get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5312" target="_blank">01:28:32.600</a></span> | <span class="t">away from zero basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5315" target="_blank">01:28:35.120</a></span> | <span class="t">So we don't want really big numbers, particularly because we're going to be taking derivatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5319" target="_blank">01:28:39.800</a></span> | <span class="t">And so if you're in an area that's not very precise as far as floating point math is concerned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5325" target="_blank">01:28:45.840</a></span> | <span class="t">then the derivatives are going to be a disaster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5327" target="_blank">01:28:47.320</a></span> | <span class="t">They might even be zero because you've got two numbers that the computer can't even recognize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5331" target="_blank">01:28:51.920</a></span> | <span class="t">as different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5333" target="_blank">01:28:53.720</a></span> | <span class="t">So this is bad, but there's a nice trick we can do to make it a lot better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5339" target="_blank">01:28:59.360</a></span> | <span class="t">What we can do is we can calculate the max of x, right, and we'll call that a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5347" target="_blank">01:29:07.000</a></span> | <span class="t">And so then rather than doing the log of the sum of e to the xi, we're instead going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5364" target="_blank">01:29:24.440</a></span> | <span class="t">define a as being the minimum, sorry, the maximum of all of our x values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5374" target="_blank">01:29:34.520</a></span> | <span class="t">It's our biggest number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5376" target="_blank">01:29:36.440</a></span> | <span class="t">Now if we then subtract that from every number, that means none of the numbers are going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5384" target="_blank">01:29:44.800</a></span> | <span class="t">be big by definition because we've subtracted it from all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5389" target="_blank">01:29:49.360</a></span> | <span class="t">Now the problem is that's given us a different result, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5393" target="_blank">01:29:53.640</a></span> | <span class="t">But if you think about it, let's expand this sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5397" target="_blank">01:29:57.200</a></span> | <span class="t">It's e to the power of x1, if we don't include our minus a, plus e to the power of x2, plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5406" target="_blank">01:30:06.520</a></span> | <span class="t">e to the power of x3 and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5410" target="_blank">01:30:10.600</a></span> | <span class="t">Okay, now we just subtracted a from our exponents, which has made, meant we're now wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5423" target="_blank">01:30:23.760</a></span> | <span class="t">But I've got good news.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5424" target="_blank">01:30:24.760</a></span> | <span class="t">I've got good news and bad news.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5427" target="_blank">01:30:27.360</a></span> | <span class="t">The bad news is that you've got more high school math to remember, which is exponent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5432" target="_blank">01:30:32.640</a></span> | <span class="t">rules. So x to the a plus b equals x to the a times x to the b.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5444" target="_blank">01:30:44.440</a></span> | <span class="t">And similarly, x to the a minus b equals x to the a divided by x to the b.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5454" target="_blank">01:30:54.800</a></span> | <span class="t">And to convince yourself that's true, consider, for example, 2 to the power of 2 plus 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5462" target="_blank">01:31:02.480</a></span> | <span class="t">What is that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5463" target="_blank">01:31:03.480</a></span> | <span class="t">Well, you've got 2 to the power of 2 is just 2 times 2, and 2 to the power of 2 plus 3,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5470" target="_blank">01:31:10.360</a></span> | <span class="t">well, it's 2 times 2 times, is 2 to the power of 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5475" target="_blank">01:31:15.280</a></span> | <span class="t">So you've got 2 to the power of 2, you've got 2 of them here, and you've got another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5478" target="_blank">01:31:18.480</a></span> | <span class="t">3 of them here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5479" target="_blank">01:31:19.580</a></span> | <span class="t">So we're just adding up the number to get the total index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5483" target="_blank">01:31:23.880</a></span> | <span class="t">So we can take advantage of this here and say like, oh, well, this is equal to e to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5488" target="_blank">01:31:28.600</a></span> | <span class="t">the x1 over e to the a plus e to the x2 over e to the a plus e to the x3 over e to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5504" target="_blank">01:31:44.680</a></span> | <span class="t">a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5505" target="_blank">01:31:45.680</a></span> | <span class="t">And this is a common denominator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5509" target="_blank">01:31:49.440</a></span> | <span class="t">So we can put all that together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5511" target="_blank">01:31:51.600</a></span> | <span class="t">And why did we do all that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5519" target="_blank">01:31:59.780</a></span> | <span class="t">Because if we now multiply that all by e to the a, these would cancel out and we get the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5525" target="_blank">01:32:05.920</a></span> | <span class="t">thing we originally wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5528" target="_blank">01:32:08.060</a></span> | <span class="t">So that means we simply have to multiply this by that, and this gives us exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5536" target="_blank">01:32:16.440</a></span> | <span class="t">thing as we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5539" target="_blank">01:32:19.160</a></span> | <span class="t">That with, critically, this is no longer ever going to be a giant number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5544" target="_blank">01:32:24.200</a></span> | <span class="t">So this might seem a bit weird, we're doing extra calculations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5547" target="_blank">01:32:27.080</a></span> | <span class="t">It's not a simplification, it's a complexification, but it's one that's going to make it easier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5553" target="_blank">01:32:33.280</a></span> | <span class="t">for our floating point unit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5555" target="_blank">01:32:35.460</a></span> | <span class="t">So that's our trick, is rather than doing log of this sum, what we actually do is log</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5560" target="_blank">01:32:40.560</a></span> | <span class="t">of e to the a times the sum of e to the x minus a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5566" target="_blank">01:32:46.640</a></span> | <span class="t">And since we've got log of a product, that's just the sum of the logs, and log of e to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5572" target="_blank">01:32:52.960</a></span> | <span class="t">the a is just a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5573" target="_blank">01:32:53.960</a></span> | <span class="t">So it's a plus that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5576" target="_blank">01:32:56.880</a></span> | <span class="t">So this here is called the log sum exp trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5589" target="_blank">01:33:09.960</a></span> | <span class="t">Oops, people pointing out that I've made a mistake, thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5597" target="_blank">01:33:17.280</a></span> | <span class="t">That, of course, should have been inside the log, you can't just go sticking it on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5604" target="_blank">01:33:24.280</a></span> | <span class="t">outside like a crazy person, that's what I meant to say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5612" target="_blank">01:33:32.480</a></span> | <span class="t">OK, so here is the log sum exp trick, I'll call it m instead of a, which is a bit silly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5619" target="_blank">01:33:39.000</a></span> | <span class="t">should have called it a.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5620" target="_blank">01:33:40.000</a></span> | <span class="t">But anyway, so we find the maximum on the last dimension, and then here is the m plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5628" target="_blank">01:33:48.600</a></span> | <span class="t">that exact thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5630" target="_blank">01:33:50.160</a></span> | <span class="t">OK, so that's just another way of doing that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5634" target="_blank">01:33:54.480</a></span> | <span class="t">OK, so that's the log sum exp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5643" target="_blank">01:34:03.160</a></span> | <span class="t">So now we can rewrite log softmax as x minus log sum exp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5650" target="_blank">01:34:10.080</a></span> | <span class="t">And we're not going to use our version because pytorch already has one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5652" target="_blank">01:34:12.920</a></span> | <span class="t">So we'll just use pytorches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5657" target="_blank">01:34:17.200</a></span> | <span class="t">And if we check, here we go, here's our results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5666" target="_blank">01:34:26.520</a></span> | <span class="t">And so then as we've discussed, the cross entropy loss is the sum of the outputs times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5672" target="_blank">01:34:32.000</a></span> | <span class="t">the log probabilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5673" target="_blank">01:34:33.860</a></span> | <span class="t">And as we discussed, our outputs are one hot encoded, or actually they're just the integers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5679" target="_blank">01:34:39.960</a></span> | <span class="t">better still.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5681" target="_blank">01:34:41.360</a></span> | <span class="t">So what we can do is we can, I guess I should make that more clear, actually there, just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5691" target="_blank">01:34:51.680</a></span> | <span class="t">the integer indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5700" target="_blank">01:35:00.720</a></span> | <span class="t">So we can simply rewrite that as negative log of the target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5709" target="_blank">01:35:09.600</a></span> | <span class="t">So that's what we have in our Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5712" target="_blank">01:35:12.440</a></span> | <span class="t">And so how do we do that in pytorch?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5715" target="_blank">01:35:15.920</a></span> | <span class="t">So this is quite interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5717" target="_blank">01:35:17.840</a></span> | <span class="t">There's a lot of cool things you can do with array indexing in pytorch and numpy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5722" target="_blank">01:35:22.480</a></span> | <span class="t">So basically they use the same approaches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5725" target="_blank">01:35:25.960</a></span> | <span class="t">Let's take a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5727" target="_blank">01:35:27.120</a></span> | <span class="t">Here is the first three actual values in YTrain, they're 5, 0, and 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5735" target="_blank">01:35:35.760</a></span> | <span class="t">Now what we want to do is we want to find in our softmax predictions, we want to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5742" target="_blank">01:35:42.680</a></span> | <span class="t">5, the fifth prediction in the zeroth row, the zeroth prediction in the first row, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5754" target="_blank">01:35:54.080</a></span> | <span class="t">the fourth prediction in the index 2 row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5759" target="_blank">01:35:59.120</a></span> | <span class="t">So these are the numbers that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5760" target="_blank">01:36:00.720</a></span> | <span class="t">This is going to be what we add up for the first two rows of our loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5766" target="_blank">01:36:06.020</a></span> | <span class="t">So how do we do that in all in one go?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5767" target="_blank">01:36:07.520</a></span> | <span class="t">Well, here's a cool trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5769" target="_blank">01:36:09.240</a></span> | <span class="t">See here, I've got 0, 1, 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5773" target="_blank">01:36:13.960</a></span> | <span class="t">If we index using a two lists, we can put here 0, 1, 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5781" target="_blank">01:36:21.480</a></span> | <span class="t">And for the second list, we can put YTrain, 3, 5, 0, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5785" target="_blank">01:36:25.640</a></span> | <span class="t">And this is actually going to return 0, 0, 1, 0, 0, 0, 0, 5, 1, 0, and 2, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5799" target="_blank">01:36:39.940</a></span> | <span class="t">Which is, as you see, exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5804" target="_blank">01:36:44.840</a></span> | <span class="t">So therefore, this is actually giving us what we need for the cross entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5815" target="_blank">01:36:55.500</a></span> | <span class="t">So if we take range of our target's first dimension, or zero index dimension, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5823" target="_blank">01:37:03.680</a></span> | <span class="t">is all this is, and the target, and then take the negative of that dot mean, that gives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5831" target="_blank">01:37:11.080</a></span> | <span class="t">us our cross entropy loss, which is pretty neat, in my opinion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5838" target="_blank">01:37:18.420</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5842" target="_blank">01:37:22.800</a></span> | <span class="t">So PyTorch calls this negative log likelihood loss, but that's all it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5852" target="_blank">01:37:32.800</a></span> | <span class="t">And so if we take the negative log likelihood, and we pass that to that, the log soft max,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5861" target="_blank">01:37:41.560</a></span> | <span class="t">then we get the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5864" target="_blank">01:37:44.920</a></span> | <span class="t">And this particular combination in PyTorch is called F dot cross entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5870" target="_blank">01:37:50.400</a></span> | <span class="t">So just check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5871" target="_blank">01:37:51.400</a></span> | <span class="t">Yep, F dot cross entropy gives us exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5875" target="_blank">01:37:55.400</a></span> | <span class="t">So that's cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5876" target="_blank">01:37:56.400</a></span> | <span class="t">So we have now re-implemented the cross entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5880" target="_blank">01:38:00.080</a></span> | <span class="t">And there's a lot of confusing things going on there, a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5886" target="_blank">01:38:06.320</a></span> | <span class="t">And so this is one of those places where you should pause the video and go back and look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5891" target="_blank">01:38:11.000</a></span> | <span class="t">at each step and think not just like, what is it doing, but why is it doing it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5896" target="_blank">01:38:16.600</a></span> | <span class="t">And also try typing in lots of different values yourself to see if you can see what's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5901" target="_blank">01:38:21.940</a></span> | <span class="t">on, and then put this aside and test yourself by re-implementing log soft max, and cross</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5912" target="_blank">01:38:32.300</a></span> | <span class="t">entropy yourself, and compare them to PyTorch's values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5916" target="_blank">01:38:36.680</a></span> | <span class="t">And so that's a piece of homework for you for this week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5923" target="_blank">01:38:43.800</a></span> | <span class="t">So now that we've got that, we can actually create a training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5926" target="_blank">01:38:46.480</a></span> | <span class="t">So let's set our loss function to be cross entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5929" target="_blank">01:38:49.760</a></span> | <span class="t">Let's create a batch size of 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5932" target="_blank">01:38:52.440</a></span> | <span class="t">And so here's our first mini batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5934" target="_blank">01:38:54.080</a></span> | <span class="t">OK, so xB is the x mini batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5937" target="_blank">01:38:57.520</a></span> | <span class="t">It's going to be from 0 up to 64 from our training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5943" target="_blank">01:39:03.000</a></span> | <span class="t">So we can now calculate our predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5946" target="_blank">01:39:06.480</a></span> | <span class="t">So that's 64 by 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5948" target="_blank">01:39:08.400</a></span> | <span class="t">So for each of the 64 images in the mini batch, we have 10 probabilities, one for each digit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5954" target="_blank">01:39:14.920</a></span> | <span class="t">And our y is just-- in fact, let's print those out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5964" target="_blank">01:39:24.320</a></span> | <span class="t">So there's our first 64 target values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5967" target="_blank">01:39:27.680</a></span> | <span class="t">So these are the actual digits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5969" target="_blank">01:39:29.800</a></span> | <span class="t">And so our loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5971" target="_blank">01:39:31.800</a></span> | <span class="t">So we're going to start with a bad loss because it's entirely random at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5978" target="_blank">01:39:38.080</a></span> | <span class="t">OK, so for each of the predictions we made-- so those are our predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5989" target="_blank">01:39:49.640</a></span> | <span class="t">And so remember, those predictions are a 64 by 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5994" target="_blank">01:39:54.320</a></span> | <span class="t">What did we predict?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=5996" target="_blank">01:39:56.120</a></span> | <span class="t">So for each one of these 64 rows, we have to go in and see where is the highest number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6005" target="_blank">01:40:05.480</a></span> | <span class="t">So if we go through here, we can go through each one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6009" target="_blank">01:40:09.920</a></span> | <span class="t">Here's a 0.1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6013" target="_blank">01:40:13.840</a></span> | <span class="t">OK, it looks like this is the highest number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6015" target="_blank">01:40:15.400</a></span> | <span class="t">So it's 0, 1, 2, 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6016" target="_blank">01:40:16.840</a></span> | <span class="t">So the highest number is this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6018" target="_blank">01:40:18.520</a></span> | <span class="t">So you've got to find the index of the highest number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6020" target="_blank">01:40:20.880</a></span> | <span class="t">The function to find the index of the highest number is called argmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6025" target="_blank">01:40:25.480</a></span> | <span class="t">And yep, here it is, 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6028" target="_blank">01:40:28.760</a></span> | <span class="t">And I guess we could have also written this probably as preds.argmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6033" target="_blank">01:40:33.440</a></span> | <span class="t">Normally, you can do them either way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6035" target="_blank">01:40:35.840</a></span> | <span class="t">I actually prefer normally to do it this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6038" target="_blank">01:40:38.120</a></span> | <span class="t">Yep, there's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6039" target="_blank">01:40:39.120</a></span> | <span class="t">OK, and the reason we want this is because we want to be able to calculate accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6045" target="_blank">01:40:45.600</a></span> | <span class="t">We don't need it for the actual neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6047" target="_blank">01:40:47.360</a></span> | <span class="t">But we just like to be able to see how we're going because it's like it's a metric.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6051" target="_blank">01:40:51.720</a></span> | <span class="t">It's something that we use for understanding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6055" target="_blank">01:40:55.680</a></span> | <span class="t">So we take the argmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6058" target="_blank">01:40:58.640</a></span> | <span class="t">We compare it to the actual.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6060" target="_blank">01:41:00.960</a></span> | <span class="t">So that's going to give us a bunch of balls.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6063" target="_blank">01:41:03.040</a></span> | <span class="t">If you turn those into floats, they'll be ones and zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6065" target="_blank">01:41:05.280</a></span> | <span class="t">And the mean of those floats is the accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6067" target="_blank">01:41:07.840</a></span> | <span class="t">So our current accuracy, not surprisingly, is around 10%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6071" target="_blank">01:41:11.400</a></span> | <span class="t">It's 9% because it's random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6073" target="_blank">01:41:13.240</a></span> | <span class="t">That's what you would expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6074" target="_blank">01:41:14.920</a></span> | <span class="t">So let's train our first neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6077" target="_blank">01:41:17.200</a></span> | <span class="t">So we'll set a learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6079" target="_blank">01:41:19.120</a></span> | <span class="t">We'll do a few epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6080" target="_blank">01:41:20.640</a></span> | <span class="t">So we're going to go through each epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6083" target="_blank">01:41:23.680</a></span> | <span class="t">And we're going to go through from 0 up to n.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6087" target="_blank">01:41:27.680</a></span> | <span class="t">That's the 50,000 training rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6090" target="_blank">01:41:30.920</a></span> | <span class="t">And skipping by 64, the batch size each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6094" target="_blank">01:41:34.600</a></span> | <span class="t">And so we're going to create a slice that starts at i.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6098" target="_blank">01:41:38.840</a></span> | <span class="t">So starting at 0 and goes up to 64, unless we've gone past the end,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6106" target="_blank">01:41:46.040</a></span> | <span class="t">in which case we'll just go up to n.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6108" target="_blank">01:41:48.240</a></span> | <span class="t">And so then we will slice into our training set for the x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6111" target="_blank">01:41:51.600</a></span> | <span class="t">and for the y to get our x and y batches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6115" target="_blank">01:41:55.840</a></span> | <span class="t">We will then calculate our predictions, our loss function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6119" target="_blank">01:41:59.920</a></span> | <span class="t">and do our backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6120" target="_blank">01:42:00.960</a></span> | <span class="t">So the way I did this originally was I had all of these in separate cells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6130" target="_blank">01:42:10.200</a></span> | <span class="t">And I just typed in i equals 0 and then went through one cell at a time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6141" target="_blank">01:42:21.160</a></span> | <span class="t">calculating each one until they all worked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6143" target="_blank">01:42:23.440</a></span> | <span class="t">And so then I can put them in a loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6149" target="_blank">01:42:29.560</a></span> | <span class="t">OK, so once we've got done backward, we can then, with torch.co.grad,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6159" target="_blank">01:42:39.720</a></span> | <span class="t">go through each layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6162" target="_blank">01:42:42.040</a></span> | <span class="t">And if that's a layer that has weights,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6165" target="_blank">01:42:45.320</a></span> | <span class="t">we'll update them to the existing weights minus the gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6171" target="_blank">01:42:51.240</a></span> | <span class="t">times the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6173" target="_blank">01:42:53.840</a></span> | <span class="t">And then 0 out, so the weights and biases for the gradients,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6179" target="_blank">01:42:59.800</a></span> | <span class="t">the gradients with the weights and biases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6181" target="_blank">01:43:01.600</a></span> | <span class="t">This underscore means do it in place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6185" target="_blank">01:43:05.120</a></span> | <span class="t">So that sets this to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6188" target="_blank">01:43:08.760</a></span> | <span class="t">So if I run that--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6191" target="_blank">01:43:11.920</a></span> | <span class="t">oops, got to run all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6193" target="_blank">01:43:13.360</a></span> | <span class="t">I guess I skipped cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6197" target="_blank">01:43:17.440</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6198" target="_blank">01:43:18.440</a></span> | <span class="t">It's finished.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6203" target="_blank">01:43:23.160</a></span> | <span class="t">So you can see that our accuracy on the training set--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6208" target="_blank">01:43:28.040</a></span> | <span class="t">it's a bit unfair, but it's only three epochs--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6210" target="_blank">01:43:30.440</a></span> | <span class="t">is nearly 97%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6212" target="_blank">01:43:32.520</a></span> | <span class="t">So we now have a digit recognizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6216" target="_blank">01:43:36.600</a></span> | <span class="t">Trains pretty quickly and is not terrible at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6221" target="_blank">01:43:41.080</a></span> | <span class="t">So that's a pretty good starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6222" target="_blank">01:43:42.680</a></span> | <span class="t">All right, so what we're going to do next time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6230" target="_blank">01:43:50.120</a></span> | <span class="t">is we're going to refactor this training loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6235" target="_blank">01:43:55.240</a></span> | <span class="t">to make it dramatically, dramatically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6236" target="_blank">01:43:56.960</a></span> | <span class="t">dramatically simpler step by step until eventually we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6244" target="_blank">01:44:04.200</a></span> | <span class="t">will get it down to something much, much shorter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6252" target="_blank">01:44:12.440</a></span> | <span class="t">And then we're going to add a validation set to it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6255" target="_blank">01:44:15.840</a></span> | <span class="t">and a multiprocessing data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6259" target="_blank">01:44:19.240</a></span> | <span class="t">And then, yeah, we'll be in a pretty good position,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6261" target="_blank">01:44:21.960</a></span> | <span class="t">I think, to start training some more interesting models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6267" target="_blank">01:44:27.160</a></span> | <span class="t">All right, hopefully you found that useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6273" target="_blank">01:44:33.160</a></span> | <span class="t">and learned some interesting things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6275" target="_blank">01:44:35.160</a></span> | <span class="t">And so what I'd really like you to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6284" target="_blank">01:44:44.760</a></span> | <span class="t">is, at this point, now that you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6287" target="_blank">01:44:47.040</a></span> | <span class="t">kind of got all these key basic pieces in place,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6291" target="_blank">01:44:51.840</a></span> | <span class="t">is to really try to recreate them without peaking as much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6298" target="_blank">01:44:58.400</a></span> | <span class="t">as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6299" target="_blank">01:44:59.560</a></span> | <span class="t">So recreate your matrix multiply,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6303" target="_blank">01:45:03.920</a></span> | <span class="t">recreate those forward and backward passes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6307" target="_blank">01:45:07.480</a></span> | <span class="t">recreate something that steps through layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6310" target="_blank">01:45:10.120</a></span> | <span class="t">and even see if you can recreate the idea of the dot forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6314" target="_blank">01:45:14.880</a></span> | <span class="t">and the dot backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6318" target="_blank">01:45:18.200</a></span> | <span class="t">Make sure it's all in your head really clearly so that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6322" target="_blank">01:45:22.960</a></span> | <span class="t">fully understand what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6326" target="_blank">01:45:26.280</a></span> | <span class="t">At the very least, if you don't have time for that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6328" target="_blank">01:45:28.440</a></span> | <span class="t">because that's a big job, you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6329" target="_blank">01:45:29.520</a></span> | <span class="t">pick out a smaller part of that, the piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6331" target="_blank">01:45:31.520</a></span> | <span class="t">that you're more interested in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6333" target="_blank">01:45:33.280</a></span> | <span class="t">Or you could just go through and look really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6337" target="_blank">01:45:37.120</a></span> | <span class="t">closely at these notebooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6339" target="_blank">01:45:39.040</a></span> | <span class="t">So if you go to kernel restart and clear output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6343" target="_blank">01:45:43.160</a></span> | <span class="t">it will delete all the outputs and try to think,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6345" target="_blank">01:45:45.720</a></span> | <span class="t">what are the shapes of things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6347" target="_blank">01:45:47.280</a></span> | <span class="t">Can you guess what they are?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6348" target="_blank">01:45:48.600</a></span> | <span class="t">Can you check them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6350" target="_blank">01:45:50.440</a></span> | <span class="t">And so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6351" target="_blank">01:45:51.280</a></span> | <span class="t">OK, thanks, everybody.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6355" target="_blank">01:45:55.880</a></span> | <span class="t">Hope you have a great week, and I will see you next time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=vGdB4eI4KBs&t=6358" target="_blank">01:45:58.920</a></span> | <span class="t">Bye.</span></div></div></body></html>