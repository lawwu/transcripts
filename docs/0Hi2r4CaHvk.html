<html><head><title>Lesson 15: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 15: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk"><img src="https://i.ytimg.com/vi/0Hi2r4CaHvk/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=51">0:51</a> What are convolutions?<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=412">6:52</a> Visualizing convolutions<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=531">8:51</a> Creating a convolution with MNIST<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1078">17:58</a> Speeding up the matrix multiplication when calculating convolutions<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1347">22:27</a> Pythorchâ€™s F.unfold and F.conv2d<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1641">27:21</a> Padding and Stride<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1863">31:3</a> Creating the ConvNet<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2312">38:32</a> Convolution Arithmetic. NCHW and NHWC<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2387">39:47</a> Parameters in MLP vs CNN<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2547">42:27</a> CNNs and image size<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2592">43:12</a> Receptive fields<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2769">46:9</a> Convolutions in Excel: conv-example.xlsx<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3364">56:4</a> Autoencoders<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3600">60:0</a> Speeding up fitting and improving accuracy<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3956">65:56</a> Reminding what an auto-encoder is<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4552">75:52</a> Creating a Learner<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4968">82:48</a> Metric class<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5320">88:40</a> Decorator with callbacks<br><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5565">92:45</a> Python recap<br><br><div style="text-align: left;"><a href="./0Hi2r4CaHvk.html">Whisper Transcript</a> | <a href="./transcript_0Hi2r4CaHvk.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi all and welcome to Lesson 15 and what we're going to endeavor to do today is to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=7" target="_blank">00:00:07.680</a></span> | <span class="t">a convolutional autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=13" target="_blank">00:00:13.200</a></span> | <span class="t">And in the process we will see why doing that well is a tricky thing to do and time permitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=22" target="_blank">00:00:22.060</a></span> | <span class="t">we will begin to work on a framework, a deep learning framework to make life a lot easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=29" target="_blank">00:00:29.920</a></span> | <span class="t">Not sure how far we'll get on that today, time wise, so let's see how we go and get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=34" target="_blank">00:00:34.360</a></span> | <span class="t">straight into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=37" target="_blank">00:00:37.000</a></span> | <span class="t">So okay, so today let's start by talking before we can create a convolutional autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=45" target="_blank">00:00:45.140</a></span> | <span class="t">We need to talk about convolutions and what are they and what are they for?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=52" target="_blank">00:00:52.480</a></span> | <span class="t">Generally speaking, convolutions are something that allows us to tell our neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=60" target="_blank">00:01:00.560</a></span> | <span class="t">a little bit about the structure of the problem that's going to make it a lot easier for it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=65" target="_blank">00:01:05.160</a></span> | <span class="t">to solve the problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=66" target="_blank">00:01:06.640</a></span> | <span class="t">And in particular the structure of our problem is we're doing things with images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=71" target="_blank">00:01:11.280</a></span> | <span class="t">Images are laid out on a grid, a 2D grid for black and white or a 3D for color or a 4D</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=81" target="_blank">00:01:21.680</a></span> | <span class="t">for a color video or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=84" target="_blank">00:01:24.720</a></span> | <span class="t">And so we would say, you know, there's a relationship between the pixels going across and the pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=90" target="_blank">00:01:30.280</a></span> | <span class="t">going down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=91" target="_blank">00:01:31.280</a></span> | <span class="t">They tend to be similar to each other, differences in those pixels across those dimensions tend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=95" target="_blank">00:01:35.980</a></span> | <span class="t">to have meaning, patterns of pixels that appear in different places often represent the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=103" target="_blank">00:01:43.240</a></span> | <span class="t">thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=104" target="_blank">00:01:44.240</a></span> | <span class="t">So for example, a cat in the top left is still a cat even if it's in the bottom right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=109" target="_blank">00:01:49.520</a></span> | <span class="t">These kinds of this kind of prior information is something that is naturally captured by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=116" target="_blank">00:01:56.760</a></span> | <span class="t">a convolutional neural network, something that uses convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=121" target="_blank">00:02:01.760</a></span> | <span class="t">Generally speaking, this is a good thing because it means that we will be able to use less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=126" target="_blank">00:02:06.040</a></span> | <span class="t">parameters and less computation because more of that information about the problem we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=131" target="_blank">00:02:11.640</a></span> | <span class="t">solving is kind of encoded directly into our architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=137" target="_blank">00:02:17.320</a></span> | <span class="t">There are other architectures that don't encode that prior information as strongly such as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=144" target="_blank">00:02:24.880</a></span> | <span class="t">a multilayer perceptron, which we've been looking at so far or a transformers network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=148" target="_blank">00:02:28.920</a></span> | <span class="t">which we haven't looked at yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=152" target="_blank">00:02:32.040</a></span> | <span class="t">Those kinds of architectures could potentially give us what they do give us more flexibility</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=158" target="_blank">00:02:38.520</a></span> | <span class="t">and given enough time, compute and data, they could potentially find things that maybe CNNs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=165" target="_blank">00:02:45.240</a></span> | <span class="t">would struggle to find.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=168" target="_blank">00:02:48.640</a></span> | <span class="t">So we're not always going to use convolutional neural networks, but they're a pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=173" target="_blank">00:02:53.000</a></span> | <span class="t">starting point and certainly something important to understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=177" target="_blank">00:02:57.300</a></span> | <span class="t">They're not just used for images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=179" target="_blank">00:02:59.360</a></span> | <span class="t">We can also take advantage of one-dimensional convolutions for language-based tasks, for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=185" target="_blank">00:03:05.680</a></span> | <span class="t">instance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=186" target="_blank">00:03:06.680</a></span> | <span class="t">So convolutions come up a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=191" target="_blank">00:03:11.580</a></span> | <span class="t">So in this notebook, one thing you'll notice that might be of interest is we are importing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=198" target="_blank">00:03:18.160</a></span> | <span class="t">stuff from MiniAI now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=200" target="_blank">00:03:20.520</a></span> | <span class="t">Now MiniAI is this little library that we're starting to create and we're creating it using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=205" target="_blank">00:03:25.880</a></span> | <span class="t">nbdev.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=207" target="_blank">00:03:27.280</a></span> | <span class="t">So we've now got a MiniAI.training and a MiniAI.datasets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=211" target="_blank">00:03:31.480</a></span> | <span class="t">And so if we look, for example, at the datasets notebook, it starts with something that says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=216" target="_blank">00:03:36.440</a></span> | <span class="t">that the default export module is called datasets and some of the cells have a export directive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=226" target="_blank">00:03:46.080</a></span> | <span class="t">on them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=227" target="_blank">00:03:47.280</a></span> | <span class="t">And at the very bottom, we had something that called nbdev export.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=232" target="_blank">00:03:52.720</a></span> | <span class="t">Now what that's going to do is it's going to create a file called datasets.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=243" target="_blank">00:04:03.840</a></span> | <span class="t">Next here, datasets.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=248" target="_blank">00:04:08.660</a></span> | <span class="t">And it contains those cells that we exported.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=257" target="_blank">00:04:17.440</a></span> | <span class="t">And why is it called MiniAI.datasets?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=261" target="_blank">00:04:21.880</a></span> | <span class="t">That's because everything for nbdev is stored in settings.ini and there's something here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=266" target="_blank">00:04:26.200</a></span> | <span class="t">saying create a library libname called MiniAI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=272" target="_blank">00:04:32.460</a></span> | <span class="t">You can't use this library until you install it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=275" target="_blank">00:04:35.420</a></span> | <span class="t">Now we haven't uploaded it to PyPy, like we've made it a pip installable package from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=281" target="_blank">00:04:41.900</a></span> | <span class="t">public server.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=283" target="_blank">00:04:43.620</a></span> | <span class="t">But you can actually install a local directory as if it's a Python module that you've kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=292" target="_blank">00:04:52.160</a></span> | <span class="t">of installed from the internet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=293" target="_blank">00:04:53.880</a></span> | <span class="t">And to do that, you say pip install in the usual way, but you say -e, this down to editable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=300" target="_blank">00:05:00.100</a></span> | <span class="t">And that means set up the current directory as a Python module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=303" target="_blank">00:05:03.720</a></span> | <span class="t">Well, current directory, actually any directory you like, I just put dot to mean the current</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=307" target="_blank">00:05:07.600</a></span> | <span class="t">directory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=308" target="_blank">00:05:08.600</a></span> | <span class="t">And so you'll see that's going to go ahead and actually install my library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=315" target="_blank">00:05:15.480</a></span> | <span class="t">And so after I've done that, I can now import things from that library, as you see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=327" target="_blank">00:05:27.720</a></span> | <span class="t">Okay, so this is just the same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=331" target="_blank">00:05:31.200</a></span> | <span class="t">We're going to grab our MNIST dataset and we're going to create a convolutional neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=335" target="_blank">00:05:35.260</a></span> | <span class="t">network on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=336" target="_blank">00:05:36.260</a></span> | <span class="t">So before we do that, we're going to talk about what are convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=340" target="_blank">00:05:40.600</a></span> | <span class="t">And one of my favorite descriptions of convolutions comes from the student in our, I think it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=344" target="_blank">00:05:44.920</a></span> | <span class="t">was our very first course, Matt Kleinsmith, who wrote this really nice Medium article,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=353" target="_blank">00:05:53.040</a></span> | <span class="t">CNNs from different viewpoints, which I'm going to steal from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=356" target="_blank">00:05:56.200</a></span> | <span class="t">And here's the basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=357" target="_blank">00:05:57.320</a></span> | <span class="t">Say that this is our image, it's a three by three image with nine pixels labeled from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=365" target="_blank">00:06:05.320</a></span> | <span class="t">A to J as capital letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=368" target="_blank">00:06:08.080</a></span> | <span class="t">Now a convolution uses something called a kernel and a kernel is just another tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=375" target="_blank">00:06:15.920</a></span> | <span class="t">In this case, it's a two by two matrix again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=378" target="_blank">00:06:18.760</a></span> | <span class="t">So this one's we're going to have alpha, beta, gamma, delta as our four values in this convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=386" target="_blank">00:06:26.960</a></span> | <span class="t">Now in this kernel, oh, now one thing I'll mention, I can't remember if I've said this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=391" target="_blank">00:06:31.760</a></span> | <span class="t">before, is the Greek letters are things that you want to be able to, I think I have mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=397" target="_blank">00:06:37.480</a></span> | <span class="t">this, you want to be able to pronounce them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=399" target="_blank">00:06:39.280</a></span> | <span class="t">So if you don't know how to read these and say what these names are, make sure you head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=404" target="_blank">00:06:44.240</a></span> | <span class="t">over to Wikipedia or whatever and learn the names of all the Greek letters so that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=409" target="_blank">00:06:49.080</a></span> | <span class="t">can, because they come up all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=411" target="_blank">00:06:51.600</a></span> | <span class="t">So, what happens when we apply a convolution with this two by two kernel to this three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=418" target="_blank">00:06:58.400</a></span> | <span class="t">by three image, I mean, it doesn't have to be an image, it's in this case, it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=424" target="_blank">00:07:04.720</a></span> | <span class="t">a rank two tensor, but it might represent an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=429" target="_blank">00:07:09.160</a></span> | <span class="t">What happens is we take the kernel and we overlay it over the first little two by two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=435" target="_blank">00:07:15.780</a></span> | <span class="t">sub grid, like so, and specifically what we do is we match color to color.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=442" target="_blank">00:07:22.760</a></span> | <span class="t">So the output of this first two by two overlay would be alpha times A plus beta times B plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=451" target="_blank">00:07:31.280</a></span> | <span class="t">gamma times D plus delta times E and that would yield some value P and that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=457" target="_blank">00:07:37.720</a></span> | <span class="t">to end up in the top left of a two by two output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=462" target="_blank">00:07:42.420</a></span> | <span class="t">So the top right of the two by two output, we're going to slide, it's like a sliding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=466" target="_blank">00:07:46.760</a></span> | <span class="t">window, we're going to slide our kernel over to here and apply each of our coefficients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=472" target="_blank">00:07:52.720</a></span> | <span class="t">to these respectively colored squares and then ditto for the bottom left and then ditto</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=481" target="_blank">00:08:01.120</a></span> | <span class="t">for the bottom right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=483" target="_blank">00:08:03.520</a></span> | <span class="t">So we end up with this equation, P as we discussed is alpha A plus beta B plus gamma D plus delta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=490" target="_blank">00:08:10.400</a></span> | <span class="t">E plus some bias term, Q to the top right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=499" target="_blank">00:08:19.280</a></span> | <span class="t">As you can see, it's just alpha in this test times B and so we're just multiplying them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=504" target="_blank">00:08:24.600</a></span> | <span class="t">together and adding them up, multiply together, add them up, multiply together and add them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=508" target="_blank">00:08:28.080</a></span> | <span class="t">up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=509" target="_blank">00:08:29.080</a></span> | <span class="t">So we're basically, you can imagine that we're basically flattening these out into rank one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=514" target="_blank">00:08:34.360</a></span> | <span class="t">tensors into vectors and then doing a dot product would be one way of thinking about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=518" target="_blank">00:08:38.240</a></span> | <span class="t">what's happening as we slide this kernel over these windows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=521" target="_blank">00:08:41.880</a></span> | <span class="t">And so this is called a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=526" target="_blank">00:08:46.260</a></span> | <span class="t">So let's try and create a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=532" target="_blank">00:08:52.080</a></span> | <span class="t">So for example, let's grab our training images and take a look at one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=545" target="_blank">00:09:05.480</a></span> | <span class="t">And let's create a three by three kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=549" target="_blank">00:09:09.320</a></span> | <span class="t">So remember, a kernel is just, we've already, a kernel appears a lot of times in computer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=554" target="_blank">00:09:14.640</a></span> | <span class="t">science and math.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=555" target="_blank">00:09:15.840</a></span> | <span class="t">We've already seen the term kernel to mean a piece of code that we run on a GPU across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=564" target="_blank">00:09:24.240</a></span> | <span class="t">lots of parallel kind of virtual devices or potentially in a grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=570" target="_blank">00:09:30.480</a></span> | <span class="t">There's a similar idea here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=571" target="_blank">00:09:31.880</a></span> | <span class="t">We've got a computation, which is in this case, kind of this dot product or something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=575" target="_blank">00:09:35.520</a></span> | <span class="t">like a dot product, sliding over, occurring lots of times over a grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=580" target="_blank">00:09:40.800</a></span> | <span class="t">But it's, yeah, it's a bit different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=585" target="_blank">00:09:45.680</a></span> | <span class="t">That's kind of another use of the word kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=587" target="_blank">00:09:47.480</a></span> | <span class="t">So in this case, a kernel is a, in this case, it's going to be a rank two tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=592" target="_blank">00:09:52.520</a></span> | <span class="t">And so let's create a kernel with these values in the three by three matrix, rank two tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=599" target="_blank">00:09:59.280</a></span> | <span class="t">And we could draw what that looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=601" target="_blank">00:10:01.840</a></span> | <span class="t">Not surprising.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=602" target="_blank">00:10:02.840</a></span> | <span class="t">It just looks like a bunch of lines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=604" target="_blank">00:10:04.760</a></span> | <span class="t">Oops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=605" target="_blank">00:10:05.760</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=606" target="_blank">00:10:06.760</a></span> | <span class="t">So what would happen if we slide this over just these nine pixels over this 28 by 28?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=617" target="_blank">00:10:17.240</a></span> | <span class="t">Well, what's going to happen is if we've got some, the top left, for example, three by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=623" target="_blank">00:10:23.360</a></span> | <span class="t">three section has these names, then we're going to end up with negative A1 because the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=629" target="_blank">00:10:29.160</a></span> | <span class="t">three are all negative, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=630" target="_blank">00:10:30.920</a></span> | <span class="t">Negative A1, minus A2, minus A3, the next to just zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=636" target="_blank">00:10:36.000</a></span> | <span class="t">So that won't do anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=637" target="_blank">00:10:37.500</a></span> | <span class="t">And then plus A7, plus A8, plus A9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=643" target="_blank">00:10:43.360</a></span> | <span class="t">Why is that interesting?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=647" target="_blank">00:10:47.080</a></span> | <span class="t">That's interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=648" target="_blank">00:10:48.080</a></span> | <span class="t">Well, let's try here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=650" target="_blank">00:10:50.880</a></span> | <span class="t">What I've done here is I've grabbed just the first 13 rows and first 23 columns of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=658" target="_blank">00:10:58.300</a></span> | <span class="t">image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=660" target="_blank">00:11:00.440</a></span> | <span class="t">And I'm actually showing the numbers and also using gray kind of conditional formatting,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=668" target="_blank">00:11:08.260</a></span> | <span class="t">if you like, or the equivalent in pandas to show this top bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=672" target="_blank">00:11:12.080</a></span> | <span class="t">So we're looking at just this top bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=678" target="_blank">00:11:18.400</a></span> | <span class="t">So what happens if we take rows three, four, and five?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=683" target="_blank">00:11:23.880</a></span> | <span class="t">Remember this is not inclusive, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=686" target="_blank">00:11:26.620</a></span> | <span class="t">So it's rows three, four, and five, columns 14, 15, 16, 14, 15, 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=691" target="_blank">00:11:31.920</a></span> | <span class="t">So we're looking at this, these three here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=695" target="_blank">00:11:35.560</a></span> | <span class="t">What's that going to give us if we multiply it by this kernel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=702" target="_blank">00:11:42.040</a></span> | <span class="t">It gives us a fairly large positive value because the three that we have negatives on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=709" target="_blank">00:11:49.960</a></span> | <span class="t">is the top row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=710" target="_blank">00:11:50.960</a></span> | <span class="t">Well, they're all zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=712" target="_blank">00:11:52.480</a></span> | <span class="t">And the three that we have positives on, they're all close to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=717" target="_blank">00:11:57.760</a></span> | <span class="t">So we end up with quite a large number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=720" target="_blank">00:12:00.720</a></span> | <span class="t">What about the same columns, but for rows 789, 789 here, the top is all positive and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=731" target="_blank">00:12:11.840</a></span> | <span class="t">the bottom is all zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=733" target="_blank">00:12:13.900</a></span> | <span class="t">So that means that we're going to get a lot of negative terms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=738" target="_blank">00:12:18.200</a></span> | <span class="t">And not surprisingly, that's exactly what we see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=740" target="_blank">00:12:20.760</a></span> | <span class="t">If we do this kind of a dot product equivalent, which all you need a NumPy to do that is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=749" target="_blank">00:12:29.000</a></span> | <span class="t">an element-wise multiplication followed by a sum, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=752" target="_blank">00:12:32.720</a></span> | <span class="t">So that's going to be quite a large negative number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=755" target="_blank">00:12:35.620</a></span> | <span class="t">And so perhaps you're seeing what this is doing, and maybe you got a hint from the name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=759" target="_blank">00:12:39.320</a></span> | <span class="t">of the tensor we created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=761" target="_blank">00:12:41.480</a></span> | <span class="t">It's something that is going to find the top edge, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=765" target="_blank">00:12:45.780</a></span> | <span class="t">So this one is a top edge, so it's a positive, and this one is a bottom edge, so it's a negative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=772" target="_blank">00:12:52.880</a></span> | <span class="t">So we would like to apply that, this kernel, to every single 3x3 section in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=782" target="_blank">00:13:02.860</a></span> | <span class="t">So we could do that by creating a little apply kernel function that takes some particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=788" target="_blank">00:13:08.400</a></span> | <span class="t">row, and some particular column, and some particular tensor as a kernel, and does that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=796" target="_blank">00:13:16.080</a></span> | <span class="t">multiplication dot sum that we just saw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=801" target="_blank">00:13:21.820</a></span> | <span class="t">So for example, we could replicate this one by calling apply kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=808" target="_blank">00:13:28.000</a></span> | <span class="t">And this here is the center of that 3x3 grid area.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=813" target="_blank">00:13:33.280</a></span> | <span class="t">And so there's that same number, 2.97.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=816" target="_blank">00:13:36.940</a></span> | <span class="t">So now we could apply that kernel to every one of the 3x3 windows in this 28x28 image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=826" target="_blank">00:13:46.520</a></span> | <span class="t">So we're going to be sliding over, like this red bit sliding over here, but we've actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=831" target="_blank">00:13:51.120</a></span> | <span class="t">got a 28x28 input, not just a 5x5 input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=835" target="_blank">00:13:55.600</a></span> | <span class="t">So to get all of the coordinates-- let's just simplify it to do this 5x5-- we can create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=842" target="_blank">00:14:02.220</a></span> | <span class="t">a list comprehension. We can take i through every value in range 5, and then for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=848" target="_blank">00:14:08.680</a></span> | <span class="t">of those, we can take j for every value in range 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=854" target="_blank">00:14:14.200</a></span> | <span class="t">And so if we just look at that tuple, you can see we get a list of lists containing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=861" target="_blank">00:14:21.280</a></span> | <span class="t">all of those coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=865" target="_blank">00:14:25.340</a></span> | <span class="t">So this is a list comprehension in a list comprehension, which when you first say it, may be surprising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=875" target="_blank">00:14:35.000</a></span> | <span class="t">or confusing, but it's a really helpful idiom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=879" target="_blank">00:14:39.520</a></span> | <span class="t">And I certainly recommend getting used to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=883" target="_blank">00:14:43.800</a></span> | <span class="t">Now what we're going to do is we're not just going to create this tuple, but we're actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=890" target="_blank">00:14:50.480</a></span> | <span class="t">going to call apply kernel for each of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=894" target="_blank">00:14:54.620</a></span> | <span class="t">So if we go through from 1 to 27-- well, actually, 1 to 26, because 27 is exclusive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=903" target="_blank">00:15:03.860</a></span> | <span class="t">So we're going to go through everything from 1 to 26, and then for each of those, go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=908" target="_blank">00:15:08.720</a></span> | <span class="t">from 1 to 26 again and call apply kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=912" target="_blank">00:15:12.880</a></span> | <span class="t">And that's going to give us the result of applying that convolutional kernel to every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=917" target="_blank">00:15:17.320</a></span> | <span class="t">one of those coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=920" target="_blank">00:15:20.380</a></span> | <span class="t">And there's the result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=921" target="_blank">00:15:21.980</a></span> | <span class="t">And you can see what it's done, as we hoped, is it is highlighting the top edges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=928" target="_blank">00:15:28.360</a></span> | <span class="t">So yeah, you might find that kind of surprising that it's that easy to do this kind of image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=935" target="_blank">00:15:35.440</a></span> | <span class="t">processing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=936" target="_blank">00:15:36.440</a></span> | <span class="t">We're literally just doing an element-wise multiplication and a sum for each window.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=946" target="_blank">00:15:46.020</a></span> | <span class="t">OK, so that is called a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=954" target="_blank">00:15:54.580</a></span> | <span class="t">So we can do another convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=956" target="_blank">00:15:56.140</a></span> | <span class="t">This time, we could do one with a left edge tensor, so as you can see, it looks just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=960" target="_blank">00:16:00.940</a></span> | <span class="t">rotated version or transposed version, I guess, of our top edge tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=965" target="_blank">00:16:05.940</a></span> | <span class="t">Here's what it looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=967" target="_blank">00:16:07.320</a></span> | <span class="t">And so if we apply that kernel-- so this time, we're going to apply the left edge kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=973" target="_blank">00:16:13.240</a></span> | <span class="t">And so notice here that we're actually passing in a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=977" target="_blank">00:16:17.020</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=978" target="_blank">00:16:18.020</a></span> | <span class="t">We're passing in a function-- sorry, actually, not a function, is it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=982" target="_blank">00:16:22.440</a></span> | <span class="t">It's just a tensor, actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=987" target="_blank">00:16:27.740</a></span> | <span class="t">So we're going to pass in the left edge tensor for the same list comprehension in a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=995" target="_blank">00:16:35.620</a></span> | <span class="t">comprehension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=997" target="_blank">00:16:37.060</a></span> | <span class="t">And this time, we're getting back at the left edges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1000" target="_blank">00:16:40.180</a></span> | <span class="t">Highlighting all of the left edges in the digit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1005" target="_blank">00:16:45.320</a></span> | <span class="t">So yeah, this is basically what's happening here, is that a 2 by 2 can be looped over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1012" target="_blank">00:16:52.800</a></span> | <span class="t">an image, creating these outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1017" target="_blank">00:16:57.420</a></span> | <span class="t">Now you'll see here that in the process of doing so, we are losing the outermost pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1029" target="_blank">00:17:09.480</a></span> | <span class="t">of our image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1030" target="_blank">00:17:10.480</a></span> | <span class="t">We'll learn about how to fix that later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1032" target="_blank">00:17:12.060</a></span> | <span class="t">But just for now, notice that as we are putting our 3 by 3 through, for example, in this 5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1038" target="_blank">00:17:18.840</a></span> | <span class="t">by 5, there's only one, two, three places that we can put it going across, not five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1044" target="_blank">00:17:24.800</a></span> | <span class="t">places, because we need some kind of edge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1047" target="_blank">00:17:27.340</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1048" target="_blank">00:17:28.740</a></span> | <span class="t">So that's cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1050" target="_blank">00:17:30.300</a></span> | <span class="t">That's a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1051" target="_blank">00:17:31.300</a></span> | <span class="t">And hopefully, if you remember back to kind of the Zeiler and Fergus pictures from lesson</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1056" target="_blank">00:17:36.540</a></span> | <span class="t">1, you might recognize that the kind of first layer of a convolutional network is often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1061" target="_blank">00:17:41.040</a></span> | <span class="t">looking for kind of edges and gradients and things like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1063" target="_blank">00:17:43.860</a></span> | <span class="t">And this is how it does it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1066" target="_blank">00:17:46.080</a></span> | <span class="t">And then the convolutions on top of convolutions with nonlinear activations between them can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1071" target="_blank">00:17:51.380</a></span> | <span class="t">combine those into curves or corners or stuff like that, and so on and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1078" target="_blank">00:17:58.180</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1079" target="_blank">00:17:59.340</a></span> | <span class="t">So how do we do this quickly?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1081" target="_blank">00:18:01.100</a></span> | <span class="t">Because currently, this is going to be super, super slow doing this in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1085" target="_blank">00:18:05.180</a></span> | <span class="t">So one of the very earliest or probably the earliest publicly available general purpose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1093" target="_blank">00:18:13.300</a></span> | <span class="t">deep learning, GPU accelerated deep learning thing I saw, it was called CAFE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1098" target="_blank">00:18:18.500</a></span> | <span class="t">That was created by somebody called Yang Qingjia.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1102" target="_blank">00:18:22.540</a></span> | <span class="t">And he actually described how CAFE went about implementing a fast convolution on a GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1117" target="_blank">00:18:37.860</a></span> | <span class="t">And basically, he said, "Well, I had two months to do it, and I had to finish my thesis."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1124" target="_blank">00:18:44.660</a></span> | <span class="t">And so I ended up doing something where I said, "Well, there was some other code out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1132" target="_blank">00:18:52.180</a></span> | <span class="t">there."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1133" target="_blank">00:18:53.180</a></span> | <span class="t">Kojewski, who you might have come across him and Hinton, set up a little startup, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1141" target="_blank">00:19:01.040</a></span> | <span class="t">Google bought, and that kind of became the start of Google's deep learning, the Google</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1145" target="_blank">00:19:05.700</a></span> | <span class="t">brain basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1146" target="_blank">00:19:06.700</a></span> | <span class="t">So Kojewski had all this fancy stuff in his library, but Yang Qingjia said, "Oh, I didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1152" target="_blank">00:19:12.760</a></span> | <span class="t">know how to do all that stuff."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1154" target="_blank">00:19:14.700</a></span> | <span class="t">So I said, "Well, I already know how to multiply matrices, so maybe I can convert a convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1159" target="_blank">00:19:19.900</a></span> | <span class="t">into a matrix multiplication."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1163" target="_blank">00:19:23.060</a></span> | <span class="t">And so that became known as IM2COAL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1169" target="_blank">00:19:29.940</a></span> | <span class="t">IM2COAL is a way of converting a convolution into a matrix multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1178" target="_blank">00:19:38.700</a></span> | <span class="t">And so actually, I don't know if I suspect Yang Qingjia kind of accidentally reinvented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1185" target="_blank">00:19:45.180</a></span> | <span class="t">it, because it actually had been around for a while, even at the point that he was writing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1191" target="_blank">00:19:51.220</a></span> | <span class="t">his thesis, I believe.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1196" target="_blank">00:19:56.060</a></span> | <span class="t">So it was actually, this is the place I believe it was created in this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1202" target="_blank">00:20:02.340</a></span> | <span class="t">So that was in 2006, which is a while ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1209" target="_blank">00:20:09.580</a></span> | <span class="t">And so this is actually from that paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1212" target="_blank">00:20:12.820</a></span> | <span class="t">And what they describe is, let's say you are putting this two by two kernel over this three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1223" target="_blank">00:20:23.100</a></span> | <span class="t">by three bit of an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1224" target="_blank">00:20:24.700</a></span> | <span class="t">So here you've got this window needs to match to this bit of this window, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1229" target="_blank">00:20:29.740</a></span> | <span class="t">What you could do is you could unwrap this to one, one, two, sorry, one, two, one, two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1235" target="_blank">00:20:35.820</a></span> | <span class="t">downwards to here, one, two, one, two. So unroll it like so. And you could unroll the kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1242" target="_blank">00:20:42.580</a></span> | <span class="t">here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1244" target="_blank">00:20:44.580</a></span> | <span class="t">Yeah, sorry, this is one, two, one, one. So this bit is here, one, two, one, one. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1251" target="_blank">00:20:51.860</a></span> | <span class="t">then you could unroll the kernel one, one, two, two to here, one, one, two, two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1257" target="_blank">00:20:57.780</a></span> | <span class="t">And then once they've been flattened out and moved in that way, and then you'll do exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1262" target="_blank">00:21:02.940</a></span> | <span class="t">the same thing for this next patch here, two, oh, one, three. You flatten it out and put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1267" target="_blank">00:21:07.700</a></span> | <span class="t">it here, two, oh, one, three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1269" target="_blank">00:21:09.580</a></span> | <span class="t">So if you basically take those kernels and flatten them out in this format, then you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1274" target="_blank">00:21:14.420</a></span> | <span class="t">end up with a matrix multiply. If you multiply this matrix by this matrix, you'll end up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1281" target="_blank">00:21:21.420</a></span> | <span class="t">with the output that you want from the convolution. So this is basically a way of unrolling your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1290" target="_blank">00:21:30.180</a></span> | <span class="t">kernels and your input features into matrices, such as when you do the matrix multiply, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1295" target="_blank">00:21:35.460</a></span> | <span class="t">get the right answer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1296" target="_blank">00:21:36.780</a></span> | <span class="t">So it's a kind of a nifty trick. And so that is called I am to call. I guess we're kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1305" target="_blank">00:21:45.180</a></span> | <span class="t">of cheating a little bit. Implementing that is kind of boring. It's just a bunch of copying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1309" target="_blank">00:21:49.100</a></span> | <span class="t">and tensor manipulation. So I actually haven't done it. Instead, I've linked to a numpy implementation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1318" target="_blank">00:21:58.700</a></span> | <span class="t">which is here. And it also part of it is this get indices, which is here. And as you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1330" target="_blank">00:22:10.020</a></span> | <span class="t">see, it's a little bit tedious with repeats and tiles and reshapes and whatnot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1334" target="_blank">00:22:14.980</a></span> | <span class="t">So I'm not going to call it homework. But if you want to practice your tensor indexing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1341" target="_blank">00:22:21.860</a></span> | <span class="t">manipulation skills, try creating a PyTorch version from scratch. I got to admit I didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1347" target="_blank">00:22:27.260</a></span> | <span class="t">bother. Instead, I use the one that's built into PyTorch. And in PyTorch it's called unfold.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1355" target="_blank">00:22:35.860</a></span> | <span class="t">So if we take our image and PyTorch expects there to be a batch axis and a dimension and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1365" target="_blank">00:22:45.500</a></span> | <span class="t">a channel dimension. So we'll add two unit leading dimensions to it. Then we can unfold</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1372" target="_blank">00:22:52.900</a></span> | <span class="t">our input for a three by three. And that will give us a nine by six, 76 input. And so then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1387" target="_blank">00:23:07.780</a></span> | <span class="t">we can take that and we can take that and then we will make our we will take our kernel and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1400" target="_blank">00:23:20.680</a></span> | <span class="t">just flatten it out into a vector. So view changes the shape and minus one just says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1406" target="_blank">00:23:26.460</a></span> | <span class="t">dump everything into this dimension. So that's going to create a nine long vector length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1416" target="_blank">00:23:36.140</a></span> | <span class="t">nine vector. And so now we can do the matrix model play just like they've done here of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1422" target="_blank">00:23:42.740</a></span> | <span class="t">the kernel matrix. That's our weights by the unrolled input features. And so that gives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1432" target="_blank">00:23:52.660</a></span> | <span class="t">us a six, 76 long. We can then view that as 26 by 26. And we get back, as we hoped, our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1441" target="_blank">00:24:01.700</a></span> | <span class="t">left edge result. And so this is how we can kind of from scratch create a better implementation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1456" target="_blank">00:24:16.340</a></span> | <span class="t">of convolutions. The reason I'm cheating, I'm allowed to cheat here, is because we did actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1461" target="_blank">00:24:21.180</a></span> | <span class="t">create convolutions from scratch. We're not always creating the GPU optimized versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1465" target="_blank">00:24:25.500</a></span> | <span class="t">from scratch, which was never something I promised. So I think that's fair. But it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1469" target="_blank">00:24:29.620</a></span> | <span class="t">cool that we can kind of hack out a GPU optimized version in the same way that the kind of original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1474" target="_blank">00:24:34.820</a></span> | <span class="t">deep learning library did. So if we use apply a kernel, we get nearly nine milliseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1486" target="_blank">00:24:46.980</a></span> | <span class="t">If we use unfold with matrix model play, we get 20 microseconds. So that's what about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1496" target="_blank">00:24:56.580</a></span> | <span class="t">400 times faster. So that's pretty cool. Now, of course, we don't have to use unfold and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1503" target="_blank">00:25:03.100</a></span> | <span class="t">matrix model play because PyTorch has a conv2d. So we can run that. And that interestingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1511" target="_blank">00:25:11.860</a></span> | <span class="t">is about the same speed, at least on GPU. But this would also work on GPU on GPU just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1519" target="_blank">00:25:19.100</a></span> | <span class="t">as well. Yeah, I'm not sure this will always be the case. In this case, it's a pretty small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1525" target="_blank">00:25:25.220</a></span> | <span class="t">image. I haven't experimented a whole lot to see whereabouts there's a big difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1532" target="_blank">00:25:32.260</a></span> | <span class="t">in speeds between these. Obviously, I always just use f.com2d. But if there's some more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1537" target="_blank">00:25:37.500</a></span> | <span class="t">tricky convolution you need to do with some weird thing around channels or dimensions or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1542" target="_blank">00:25:42.820</a></span> | <span class="t">something, you can always try this unfold trick. It's nice to know it's there, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1548" target="_blank">00:25:48.660</a></span> | <span class="t">So we could do the same thing for diagonal edges. So here's our diagonal edge kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1556" target="_blank">00:25:56.980</a></span> | <span class="t">or the other diagonal. So if we just grab the first 16 images, then we can do a convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1576" target="_blank">00:26:16.140</a></span> | <span class="t">on our whole batch with all of our kernels at once. So this is a nice optimized thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1584" target="_blank">00:26:24.580</a></span> | <span class="t">that we can do. And you end up with your 26 by 26. You've got your four kernels and you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1596" target="_blank">00:26:36.460</a></span> | <span class="t">got your 16 images. And so that's summarized here. So that's generally what we're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1601" target="_blank">00:26:41.980</a></span> | <span class="t">to get good GPU acceleration is we're doing a bunch of kernels and a bunch of images all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1607" target="_blank">00:26:47.180</a></span> | <span class="t">at once across all of their pixels. And so here we go. That's what happens when we take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1615" target="_blank">00:26:55.580</a></span> | <span class="t">a look at our various kernels for a particular image. Left edge, I guess top edge, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1626" target="_blank">00:27:06.980</a></span> | <span class="t">diagonal top left and top right. OK, so that is optimized convolutions on and that works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1636" target="_blank">00:27:16.260</a></span> | <span class="t">just as well on CPU or GPU. Obviously, GPU will be faster if you have one. Now, how do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1642" target="_blank">00:27:22.740</a></span> | <span class="t">we deal with the problem that we're losing one pixel on each side? What we can do is we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1650" target="_blank">00:27:30.380</a></span> | <span class="t">can add something called padding. And for padding, what we basically do is rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1656" target="_blank">00:27:36.500</a></span> | <span class="t">starting our window here, we start it right over here. And we actually would be up one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1663" target="_blank">00:27:43.500</a></span> | <span class="t">as well. And so these three on the left here, we just take the input for each of those as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1677" target="_blank">00:27:57.340</a></span> | <span class="t">zero. So we're basically just assuming that they're all zero. I mean, there's other options</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1682" target="_blank">00:28:02.420</a></span> | <span class="t">we could choose. We could assume they're the same as the one next to them. There's various</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1687" target="_blank">00:28:07.980</a></span> | <span class="t">things we can do, but the simplest and the one we normally do is just assume that there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1690" target="_blank">00:28:10.740</a></span> | <span class="t">zero. So now, so let's say, for example, this is called one pixel padding. Let's say we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1702" target="_blank">00:28:22.820</a></span> | <span class="t">did two pixel padding. So we had two pixel padding with a five by five input and a four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1712" target="_blank">00:28:32.020</a></span> | <span class="t">by four kernel. So that grays our kernel. Then we're going to start right up way over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1718" target="_blank">00:28:38.580</a></span> | <span class="t">here on the corner. And then you can see what happens as we slide the kernel over. There's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1726" target="_blank">00:28:46.300</a></span> | <span class="t">all the spots that it's going to take. And so that this dotted line area is the area</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1731" target="_blank">00:28:51.580</a></span> | <span class="t">that we're kind of effectively going through. But all of these white bits, we're just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1736" target="_blank">00:28:56.860</a></span> | <span class="t">to treat as zero. And so, and then this is this green as the output size we end up with,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1741" target="_blank">00:29:01.460</a></span> | <span class="t">which is going to be six by six for a five by five input. I should mention even numbered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1752" target="_blank">00:29:12.060</a></span> | <span class="t">edge kernels are not used very often. We normally used odd numbered kernels. If you use, for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1756" target="_blank">00:29:16.420</a></span> | <span class="t">example, a three by three kernel and one pixel of padding, you will get back the same size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1762" target="_blank">00:29:22.260</a></span> | <span class="t">you start with. If you use five by five with three pixels of padding, you'll end up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1768" target="_blank">00:29:28.580</a></span> | <span class="t">the same size you start with. So generally, odd numbered edge size kernels are easier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1773" target="_blank">00:29:33.820</a></span> | <span class="t">to deal with, to make sure you end up with the same thing you start with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1777" target="_blank">00:29:37.100</a></span> | <span class="t">OK, so, yeah, so as it says here with you've got a odd numbered size KS by KS size kernel,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1787" target="_blank">00:29:47.660</a></span> | <span class="t">then KS truncate divide two, that's what slash slash means, will give you the right size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1797" target="_blank">00:29:57.060</a></span> | <span class="t">And so another trick you can do is you don't always have to just move your window across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1805" target="_blank">00:30:05.140</a></span> | <span class="t">by one each time. You could move it by a different amount each time. The amount you move it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1810" target="_blank">00:30:10.960</a></span> | <span class="t">is called the stride. So, for example, here's a case of doing a stride two. So with stride</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1816" target="_blank">00:30:16.460</a></span> | <span class="t">two padding one, so we start out here and then we jump across two and then we jump across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1821" target="_blank">00:30:21.380</a></span> | <span class="t">two and then we go to the next row. So that's called a stride two convolution. Stride two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1826" target="_blank">00:30:26.720</a></span> | <span class="t">convolutions are handy because they actually reduce the dimensionality of your input by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1834" target="_blank">00:30:34.620</a></span> | <span class="t">a factor of two. And that's actually what we want to do a lot. For example, with an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1842" target="_blank">00:30:42.860</a></span> | <span class="t">autoencoder, we want to do that. And in fact, for most classification architectures, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1849" target="_blank">00:30:49.220</a></span> | <span class="t">do exactly that. We keep on reducing the kind of the grid size by a factor of two again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1856" target="_blank">00:30:56.140</a></span> | <span class="t">and again and again using stride two convolutions with padding of one. So that's strides in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1862" target="_blank">00:31:02.740</a></span> | <span class="t">padding. So let's go ahead and create a conf net using these approaches. So we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1870" target="_blank">00:31:10.180</a></span> | <span class="t">to put get our size of our training set. This is all the same as before, number of categories,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1876" target="_blank">00:31:16.460</a></span> | <span class="t">number of digits, size of our hidden layer. So, previously with our sequential linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1897" target="_blank">00:31:37.220</a></span> | <span class="t">models with our MLPs, we basically went from the number of pixels to the number of hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1910" target="_blank">00:31:50.060</a></span> | <span class="t">and then a value and then the number of hidden to the number of outputs. So here's the equivalent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1917" target="_blank">00:31:57.300</a></span> | <span class="t">with a convolution. Now the problem is that you can't just do that because the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1922" target="_blank">00:32:02.460</a></span> | <span class="t">is not now 10 probabilities for each item in our batch, but it's 10 probabilities for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1928" target="_blank">00:32:08.620</a></span> | <span class="t">each item in our batch for each of 28 by 28 pixels because we don't even have a stride</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1933" target="_blank">00:32:13.180</a></span> | <span class="t">or anything. So you can't just use the same simple approach that we had for MLP. We have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1939" target="_blank">00:32:19.140</a></span> | <span class="t">to be a bit more careful. So to make life easier, let's create a little conv function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1946" target="_blank">00:32:26.020</a></span> | <span class="t">that does a conv2D with a stride of 2, optionally followed by an activation. So if act is true,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1954" target="_blank">00:32:34.940</a></span> | <span class="t">we will add in a value activation. So this is going to either return a conv2D or a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1964" target="_blank">00:32:44.500</a></span> | <span class="t">sequential containing a conv2D followed by a value. And so now we can create a CNN from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1973" target="_blank">00:32:53.580</a></span> | <span class="t">scratch as a sequential model. And so since activation is true by default, this is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1980" target="_blank">00:33:00.000</a></span> | <span class="t">to take out 28 by 28 image starting with one channel and creating an output of four channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1988" target="_blank">00:33:08.420</a></span> | <span class="t">So this is the number of in, this is the number of filters. Sometimes we'll say filters to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1993" target="_blank">00:33:13.080</a></span> | <span class="t">describe the number of kind of channels that our convolution has. That's the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=1998" target="_blank">00:33:18.060</a></span> | <span class="t">outputs. And it's very similar to the idea of the number of outputs in a linear layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2003" target="_blank">00:33:23.540</a></span> | <span class="t">except this is the number of outputs in your convolution. So what I like to do when I create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2010" target="_blank">00:33:30.180</a></span> | <span class="t">stuff like this is I add a little comment just to remind myself what is my grid size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2014" target="_blank">00:33:34.980</a></span> | <span class="t">after this. So I had a 28 by 28 input. So then I've then put it through a stride2 conv.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2021" target="_blank">00:33:41.020</a></span> | <span class="t">So the output of this will be 14 by 14. So then we'll do the same thing again, but this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2026" target="_blank">00:33:46.500</a></span> | <span class="t">time we'll go from a four channel input to an eight channel output and then from eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2031" target="_blank">00:33:51.740</a></span> | <span class="t">to 16. So by this point, we're now down to a four by four and then down to a two by two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2041" target="_blank">00:34:01.360</a></span> | <span class="t">And then finally, we're down to a one by one. So on the very last layer, we won't add an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2047" target="_blank">00:34:07.580</a></span> | <span class="t">activation. And the very last layer is going to create and create 10 outputs. And since</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2053" target="_blank">00:34:13.220</a></span> | <span class="t">we're now down to a one by one, we can just call flatten and that's going to remove those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2059" target="_blank">00:34:19.380</a></span> | <span class="t">unnecessary unit axes. So if we take that, pop a mini batch through it, we end up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2066" target="_blank">00:34:26.900</a></span> | <span class="t">exactly what we want, 16 by 10. So for each of our 16 images, we've got 10 probabilities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2075" target="_blank">00:34:35.060</a></span> | <span class="t">of 10 probabilities of each possible digit. So if we take our training set and make it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2083" target="_blank">00:34:43.180</a></span> | <span class="t">into 28 by 28 images, and we do the same thing for a validation set. And then we create two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2090" target="_blank">00:34:50.020</a></span> | <span class="t">data sets, one for each, which record train data set and valid data set. And we're now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2096" target="_blank">00:34:56.900</a></span> | <span class="t">going to train this on the GPU. Now, if you've got a Mac, you can use a device called, well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2106" target="_blank">00:35:06.220</a></span> | <span class="t">if you've got an Apple Silicon Mac, you've got a device called MPS, which is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2111" target="_blank">00:35:11.460</a></span> | <span class="t">use your Mac's GPU. Where if you've got an Nvidia, you can use CUDA, which will use your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2117" target="_blank">00:35:17.780</a></span> | <span class="t">Nvidia GPU. CUDA is 10 times or more, possibly much more faster than a Mac. So you definitely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2125" target="_blank">00:35:25.340</a></span> | <span class="t">want to use Nvidia if you can. But if you're just running it on a Mac laptop or whatever,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2131" target="_blank">00:35:31.100</a></span> | <span class="t">you can use MPS. So basically you want to know what device to use. Do we want to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2135" target="_blank">00:35:35.300</a></span> | <span class="t">CUDA or MPS? You can check. If you can check torch.backends.nps.is available to see if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2141" target="_blank">00:35:41.780</a></span> | <span class="t">you're running on a Mac with MPS, you can check torch.cuda.is available to see if you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2147" target="_blank">00:35:47.500</a></span> | <span class="t">got an Nvidia GPU, in which case you've got CUDA. And if you've got neither, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2151" target="_blank">00:35:51.540</a></span> | <span class="t">you'll have to use the CPU to do computation. So I've created a little function here to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2158" target="_blank">00:35:58.780</a></span> | <span class="t">device which takes a tensor or a dictionary or a list of tensors or whatever, and a device</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2166" target="_blank">00:36:06.460</a></span> | <span class="t">to move it to. And it just goes through and moves everything onto that device. Or if it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2173" target="_blank">00:36:13.220</a></span> | <span class="t">a dictionary, a dictionary of things, values moved onto that device. So there's a handy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2178" target="_blank">00:36:18.060</a></span> | <span class="t">little function. And so we can create a custom collate function, which calls the PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2187" target="_blank">00:36:27.900</a></span> | <span class="t">default collation function and then puts those tensors onto our device. And so with that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2194" target="_blank">00:36:34.900</a></span> | <span class="t">we've now got enough to run, train this neural net on the GPU. We created this get deals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2204" target="_blank">00:36:44.420</a></span> | <span class="t">function in the last lesson. So we're going to use that passing in the datasets that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2210" target="_blank">00:36:50.420</a></span> | <span class="t">just created and our default collation function. We're going to create our optimizer using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2217" target="_blank">00:36:57.740</a></span> | <span class="t">our CNNs parameters. And then we call fit. Now fit remember, we also created in our last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2226" target="_blank">00:37:06.900</a></span> | <span class="t">lesson and it's done. So I then what I did then was I reduced the learning rate by a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2233" target="_blank">00:37:13.860</a></span> | <span class="t">factor of four and ran it again. And eventually, yeah, I got to a fairly similar accuracy to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2241" target="_blank">00:37:21.660</a></span> | <span class="t">what we did on our multi on our MLP. So yeah, we've got a convolutional network working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2252" target="_blank">00:37:32.300</a></span> | <span class="t">I think that's pretty encouraging. And it's nice that to train it, we didn't have to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2257" target="_blank">00:37:37.140</a></span> | <span class="t">much code, right? We were able to use code that we already built. We were able to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2261" target="_blank">00:37:41.940</a></span> | <span class="t">the dataset class that we made, the get deals function that we made and the fit function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2268" target="_blank">00:37:48.220</a></span> | <span class="t">that we made. And you know, because those things are written in a fairly general way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2275" target="_blank">00:37:55.900</a></span> | <span class="t">they work just as well for a ConvNet as they did for an MLP, nothing had to change. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2280" target="_blank">00:38:00.260</a></span> | <span class="t">that was nice. Notice we I had to take the model and put it on the device as well. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2287" target="_blank">00:38:07.940</a></span> | <span class="t">that will go through and basically put all of the tenses that are in that model onto</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2293" target="_blank">00:38:13.020</a></span> | <span class="t">the MPS or CUDA device, if appropriate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2301" target="_blank">00:38:21.980</a></span> | <span class="t">So if we've got a batch size of 64, and as we do one channel, 28 by 28. So then our axes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2309" target="_blank">00:38:29.860</a></span> | <span class="t">are batch channel height, width. So normally, this is referred to as NCHW. So N, generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2318" target="_blank">00:38:38.400</a></span> | <span class="t">when you see N in a paper or whatever, in this way, it's referring to the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2324" target="_blank">00:38:44.540</a></span> | <span class="t">N being the number, that's the mnemonic, the number of items in the batch. C is the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2330" target="_blank">00:38:50.620</a></span> | <span class="t">of channels, height by width, NCHW. TensorFlow doesn't use that, TensorFlow uses NHWC. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2342" target="_blank">00:39:02.180</a></span> | <span class="t">we generally call these that channels last, since channels are at the end. And this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2350" target="_blank">00:39:10.120</a></span> | <span class="t">we normally call channels first. Now, of course, it's not actually channels first. It's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2359" target="_blank">00:39:19.300</a></span> | <span class="t">channel second, but we ignore the batch bit. In some models, particularly some more modern</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2367" target="_blank">00:39:27.180</a></span> | <span class="t">models, it turns out the channels last is faster. So PyTorch has recently added support for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2373" target="_blank">00:39:33.740</a></span> | <span class="t">channels last. And so you'll see that being used more and more as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2379" target="_blank">00:39:39.940</a></span> | <span class="t">All right, so a couple of comments and questions from our chat. The first is Sam Watkins pointing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2390" target="_blank">00:39:50.380</a></span> | <span class="t">out that we've actually had a bit of a win here, which is that the number of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2396" target="_blank">00:39:56.380</a></span> | <span class="t">in our CNN is pretty small by comparison. So the number in the MLP version, the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2404" target="_blank">00:40:04.740</a></span> | <span class="t">of parameters is equal to basically the size of this matrix. So M times NH. Oh, plus the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2421" target="_blank">00:40:21.540</a></span> | <span class="t">number in this, which will be NH times 10. And, you know, something that at some point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2431" target="_blank">00:40:31.780</a></span> | <span class="t">we probably should do is actually create something that allows us to automatically calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2438" target="_blank">00:40:38.420</a></span> | <span class="t">the number of parameters. And I'm ignoring the bias there, of course. Let's see what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2456" target="_blank">00:40:56.820</a></span> | <span class="t">would be a good way to do that. Maybe NP dot product. There we go. So what we could do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2475" target="_blank">00:41:15.900</a></span> | <span class="t">what we could do is just calculate this automatically by doing a little list comprehension here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2484" target="_blank">00:41:24.360</a></span> | <span class="t">So there's the number of parameters across all of the different layers, so both bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2489" target="_blank">00:41:29.180</a></span> | <span class="t">and weights. And then we could, I guess, just, well, we could just use, well, let's use PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2498" target="_blank">00:41:38.320</a></span> | <span class="t">So we could turn that into a tensor and sum it up. Oops. So that's the number in our MLP.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2509" target="_blank">00:41:49.900</a></span> | <span class="t">And then the number in our simple CNN. So that's pretty cool. We've gone down from 40,000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2519" target="_blank">00:41:59.780</a></span> | <span class="t">to 5,000 and got about the same number there. Oh, thank you, Jonathan. Jonathan's reminding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2527" target="_blank">00:42:07.420</a></span> | <span class="t">me that there's a better way than NP dot product O dot shape, which is just to say O dot number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2536" target="_blank">00:42:16.260</a></span> | <span class="t">of elements, num EL. Same thing. Very nice. Now, one person asked a very good question,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2550" target="_blank">00:42:30.980</a></span> | <span class="t">which is I thought convolutional neural networks can handle any sized image. And actually, no,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2560" target="_blank">00:42:40.960</a></span> | <span class="t">this convolutional network cannot handle any sized image. This convolutional neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2565" target="_blank">00:42:45.780</a></span> | <span class="t">only handles images that once they go through these tried to comms end up with a one by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2570" target="_blank">00:42:50.180</a></span> | <span class="t">one because otherwise you can't dot flatten it and end up with 16 by 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2579" target="_blank">00:42:59.020</a></span> | <span class="t">So we will learn how to create conv nets that can handle any sized input. But there's nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2586" target="_blank">00:43:06.680</a></span> | <span class="t">particularly about a common net that necessitates that it has to be any sized input that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2590" target="_blank">00:43:10.700</a></span> | <span class="t">can handle. Okay, so just let's briefly finish this section off by talking about this. Yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2602" target="_blank">00:43:22.840</a></span> | <span class="t">this particularly on to talk about the idea of receptive field. Consider this one input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2609" target="_blank">00:43:29.860</a></span> | <span class="t">channel for output channel three by three kernel. Right. So that's just to show you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2617" target="_blank">00:43:37.520</a></span> | <span class="t">what we're doing here. Conve one, well, actually, so a simple CNN, simple CNN. This is the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2625" target="_blank">00:43:45.860</a></span> | <span class="t">we created. Remember, it was like a sequential model containing sequential models because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2629" target="_blank">00:43:49.260</a></span> | <span class="t">that's how our con function worked. So simple CNN zero is our first layer. It contains both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2635" target="_blank">00:43:55.500</a></span> | <span class="t">the convenor value. So simple CNN zero zero is the actual con. So if we grab that, call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2642" target="_blank">00:44:02.280</a></span> | <span class="t">it con one. It's a four by one by three by three. So number of outputs, number of input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2652" target="_blank">00:44:12.380</a></span> | <span class="t">channels and height by width of their kernel. And then it's got its bias as well. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2658" target="_blank">00:44:18.940</a></span> | <span class="t">how we could kind of deconstruct what's going on with our weight matrices or parameters inside</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2666" target="_blank">00:44:26.820</a></span> | <span class="t">a convolution. Now, I'm going to switch over to Excel. So in the lesson notes on the course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2678" target="_blank">00:44:38.140</a></span> | <span class="t">website or on the forum, you'll find we've got an Excel. You'll see we've got an Excel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2684" target="_blank">00:44:44.460</a></span> | <span class="t">workbook. Oh, what seemed reminded me that there is a nice trick we can do. I do want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2689" target="_blank">00:44:49.500</a></span> | <span class="t">to do that actually because I love this trick. Oh, I just deleted everything though. Let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2696" target="_blank">00:44:56.740</a></span> | <span class="t">put them all back. Here we go. Which is you actually don't need square brackets. The square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2700" target="_blank">00:45:00.460</a></span> | <span class="t">brackets is a list comprehension. Without the square brackets, it's called a generator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2705" target="_blank">00:45:05.700</a></span> | <span class="t">and it. Oh, no, you can't use it there. Maybe that only works with num. Maybe that only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2712" target="_blank">00:45:12.980</a></span> | <span class="t">works with NumPy. Ah, okay. So wait, that's the list. No, that doesn't work either. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2729" target="_blank">00:45:29.300</a></span> | <span class="t">much for that. I'm kind of curious now. Maybe torch.sum. Nope. Just some. Oh, okay. I don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2755" target="_blank">00:45:55.420</a></span> | <span class="t">want to use Python some. That's interesting. I feel like all of them should handle generators,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2762" target="_blank">00:46:02.260</a></span> | <span class="t">but there you go. Okay. So open up the conv example spreadsheet and what you'll see on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2777" target="_blank">00:46:17.260</a></span> | <span class="t">the conv example pay a worksheet page is something that looks a lot like the number seven. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2784" target="_blank">00:46:24.780</a></span> | <span class="t">this is the number seven that I got straight from MNIST. Okay. So you can see over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2794" target="_blank">00:46:34.620</a></span> | <span class="t">we have a number seven. This is a number seven from MNIST that I have copied into Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2801" target="_blank">00:46:41.460</a></span> | <span class="t">And then you can see over here we've got like a top edge kernel being applied and over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2806" target="_blank">00:46:46.340</a></span> | <span class="t">we've got a right edge kernel being applied. This might be surprising you because you might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2811" target="_blank">00:46:51.100</a></span> | <span class="t">be thinking where did tick Jeremy Microsoft Excel doesn't do convolutional neural networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2817" target="_blank">00:46:57.500</a></span> | <span class="t">Well actually it does. So if I zoom in in Excel, you'll see actually these numbers are in fact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2830" target="_blank">00:47:10.340</a></span> | <span class="t">conditional formatting applied to a bunch of spreadsheet cells. And so what I did was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2835" target="_blank">00:47:15.660</a></span> | <span class="t">I copied the actual pixel values into Excel and then applied conditional formatting. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2841" target="_blank">00:47:21.700</a></span> | <span class="t">so now you can see what the digit is actually made of. So you can see here I've created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2852" target="_blank">00:47:32.260</a></span> | <span class="t">our top edge filter and here I've created our left edge filter. And so here I am applying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2864" target="_blank">00:47:44.980</a></span> | <span class="t">that filter to that window. And so here you can see it looks a lot like NumPy. It's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2875" target="_blank">00:47:55.260</a></span> | <span class="t">a sum product. And you might not be aware of this but in Excel you can actually do broadcasting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2886" target="_blank">00:48:06.700</a></span> | <span class="t">You have to hit Apple shift enter or control shift enter and it puts these little curly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2892" target="_blank">00:48:12.100</a></span> | <span class="t">brackets around it. It's called an array formula. It basically lets you do broadcasting or simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2896" target="_blank">00:48:16.660</a></span> | <span class="t">broadcasting in Excel. And so here's how you could say this is how I created this top edge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2902" target="_blank">00:48:22.500</a></span> | <span class="t">filtered version in Excel. And the left edge version is exactly the same just a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2909" target="_blank">00:48:29.380</a></span> | <span class="t">kernel. And as you can see if I click on it it's applying this filter to this input area</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2918" target="_blank">00:48:38.260</a></span> | <span class="t">and so forth. OK. So we can then I just arbitrarily picked some different values here. And so something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2930" target="_blank">00:48:50.300</a></span> | <span class="t">to notice now in my second layer. So here's con one is con two. It's got a bit more work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2937" target="_blank">00:48:57.940</a></span> | <span class="t">to do. We actually need two filters because we need to add together this bit here applied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2949" target="_blank">00:49:09.500</a></span> | <span class="t">to this with this kernel applied and this bit here with this kernel applied. So you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2958" target="_blank">00:49:18.180</a></span> | <span class="t">actually need one set of three by three for each input. And also I want to set two separate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2966" target="_blank">00:49:26.900</a></span> | <span class="t">outputs. So I actually end up needing a two by two by three by three weights matrix or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2977" target="_blank">00:49:37.340</a></span> | <span class="t">weights a tensor I should say which you might remember is exactly what we had in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2981" target="_blank">00:49:41.780</a></span> | <span class="t">We had a rank for tensor. So if I have a look at this one you see exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2989" target="_blank">00:49:49.220</a></span> | <span class="t">This input is using this kernel applied to here and this kernel applied to here. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=2996" target="_blank">00:49:56.180</a></span> | <span class="t">important to remember that you have these rank for tensors. And so then rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3003" target="_blank">00:50:03.360</a></span> | <span class="t">doing stride to con I did something else which is actually a bit out of favor nowadays but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3009" target="_blank">00:50:09.900</a></span> | <span class="t">it's another option which is to do something called max pooling to reduce my dimensionality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3015" target="_blank">00:50:15.500</a></span> | <span class="t">So you can see here I've got 28 by 28. I've reduced it down here to 14 by 14. And the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3021" target="_blank">00:50:21.420</a></span> | <span class="t">way I did it was simply to take the max of each little two by two area. OK. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3030" target="_blank">00:50:30.640</a></span> | <span class="t">all that's been done there. So that's called max pooling. And so max pooling has the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3036" target="_blank">00:50:36.940</a></span> | <span class="t">effect as a stride to conf not mathematically identical the same effect which it does a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3041" target="_blank">00:50:41.640</a></span> | <span class="t">convolution and reduces the grid size by two on each dimension. OK. So then how do we create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3050" target="_blank">00:50:50.420</a></span> | <span class="t">a single output if we don't keep doing this until we get to one by one which I'm too lazy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3055" target="_blank">00:50:55.180</a></span> | <span class="t">to do in Excel. Well one approach and again this is a little bit out of favor as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3059" target="_blank">00:50:59.700</a></span> | <span class="t">but one approach we can do is we can take every one of these we've now got 14 by 14</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3067" target="_blank">00:51:07.340</a></span> | <span class="t">and apply a dense layer to it. And so what I've done here is I've got a big imagine this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3075" target="_blank">00:51:15.580</a></span> | <span class="t">is basically all been flattened out into a vector. And so here we've got some product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3084" target="_blank">00:51:24.740</a></span> | <span class="t">of this by this plus the sum product of this by this. And that gives us a single number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3094" target="_blank">00:51:34.940</a></span> | <span class="t">And so that is how we could then optimize that in order to optimize our weight matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3102" target="_blank">00:51:42.820</a></span> | <span class="t">Now and then you know that the more modern approach we don't use this kind of dense layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3110" target="_blank">00:51:50.180</a></span> | <span class="t">much anymore it still appears a bit. The main place that you see this used is in a network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3118" target="_blank">00:51:58.940</a></span> | <span class="t">called VGG which is very old now. I thought it might be 2013 or something. But it's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3125" target="_blank">00:52:05.180</a></span> | <span class="t">still used. And that's because for certain things like something called style transfer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3131" target="_blank">00:52:11.940</a></span> | <span class="t">or in general perceptual losses people still find VGG seems to work better. So you still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3140" target="_blank">00:52:20.180</a></span> | <span class="t">actually see this approach nowadays sometimes. The more common approach however nowadays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3145" target="_blank">00:52:25.660</a></span> | <span class="t">is we take the penultimate layer and we just simply take the average of all of the activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3155" target="_blank">00:52:35.100</a></span> | <span class="t">So the nowadays we would simply the Excel way of doing it would be literally simply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3160" target="_blank">00:52:40.340</a></span> | <span class="t">say average of the penultimate layer and that is called global average pooling. Everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3172" target="_blank">00:52:52.420</a></span> | <span class="t">has to has a fancy word a fancy phrase but that's all it is take the average is called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3176" target="_blank">00:52:56.700</a></span> | <span class="t">global average pooling or you could take the you could take the max whatever that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3181" target="_blank">00:53:01.380</a></span> | <span class="t">be global max pooling. So anyway the main reason I wanted to show you this was to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3186" target="_blank">00:53:06.220</a></span> | <span class="t">something which I think is pretty interesting which is to take something in our zoom out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3193" target="_blank">00:53:13.780</a></span> | <span class="t">a little bit here let's take something in our max pool here and I'm going to say trace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3207" target="_blank">00:53:27.220</a></span> | <span class="t">precedence to show you here it is the area that it's coming from. OK. So it's coming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3213" target="_blank">00:53:33.020</a></span> | <span class="t">from these four numbers. Now if I trace precedence again saying what's actually impacting this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3220" target="_blank">00:53:40.780</a></span> | <span class="t">obviously the kernels impacting it and then you can see that the input area here is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3227" target="_blank">00:53:47.100</a></span> | <span class="t">bit bigger and then if I trace precedence again then you can see the input area is bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3235" target="_blank">00:53:55.300</a></span> | <span class="t">still. So this number here is calculated from all of these numbers in the input. This area</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3246" target="_blank">00:54:06.180</a></span> | <span class="t">in the input is called the receptive field of this unit. And so the receptive field in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3255" target="_blank">00:54:15.380</a></span> | <span class="t">this case is 1 2 3 4 5 6 by 6. Right. And that means that a pixel way up here in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3264" target="_blank">00:54:24.140</a></span> | <span class="t">top right has literally no ability to impact that activation. It's not part of its receptive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3271" target="_blank">00:54:31.260</a></span> | <span class="t">field. If you have a whole bunch of stride to comms each time you have one the receptive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3277" target="_blank">00:54:37.300</a></span> | <span class="t">field is going to get twice as big. So the receptive field at the end of a deep network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3282" target="_blank">00:54:42.660</a></span> | <span class="t">is actually very large. But the the inputs closest to the middle of the receptive field</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3290" target="_blank">00:54:50.220</a></span> | <span class="t">have the biggest kind of say in the output because they they implicitly appear the most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3297" target="_blank">00:54:57.420</a></span> | <span class="t">often in all of these kind of dot products that are inside this this this convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3304" target="_blank">00:55:04.220</a></span> | <span class="t">window. So the receptive field is not just like a single binary on off thing. Certainly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3310" target="_blank">00:55:10.900</a></span> | <span class="t">all the stuff that's not got precedence here is not part of it at all. But the closer to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3316" target="_blank">00:55:16.980</a></span> | <span class="t">the center of the receptive field the more impact it's going to have the more ability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3321" target="_blank">00:55:21.340</a></span> | <span class="t">it's got to change this number. So the receptive field is a really important concept. And yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3329" target="_blank">00:55:29.620</a></span> | <span class="t">fiddling playing around with Excel's precedent arrows I think is a nice way to to say that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3335" target="_blank">00:55:35.980</a></span> | <span class="t">at least in my opinion. And apart from anything else it's great fun creating a convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3342" target="_blank">00:55:42.520</a></span> | <span class="t">neural network in Excel. I thought so anyway. OK. So let's take a seven minute break. I'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3353" target="_blank">00:55:53.860</a></span> | <span class="t">see you back after that to talk about a convolutional auto encoder. All right. OK. Welcome back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3366" target="_blank">00:56:06.500</a></span> | <span class="t">We're going to have a look now at the auto encoder notebook. So we're just going to import</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3373" target="_blank">00:56:13.140</a></span> | <span class="t">all of our usual stuff and we've got one more of our own modules to import now as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3382" target="_blank">00:56:22.060</a></span> | <span class="t">And this time we are going to switch to a different we're going to switch to a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3389" target="_blank">00:56:29.540</a></span> | <span class="t">data set which is the fashion MNIST data set. We can take advantage of the stuff that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3398" target="_blank">00:56:38.660</a></span> | <span class="t">did in 0 5 data sets and the hugging face stuff to load it. So we've seen this a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3406" target="_blank">00:56:46.900</a></span> | <span class="t">bit before back in our data sets one here and we never actually built any models with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3417" target="_blank">00:56:57.700</a></span> | <span class="t">it. So let's first of all do that. So this is just going to convert each thing each image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3427" target="_blank">00:57:07.340</a></span> | <span class="t">into a tensor and it's going to be an in place transform. Remember we created this decorator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3433" target="_blank">00:57:13.940</a></span> | <span class="t">and so we can call data set dictionary with transform. This is all stuff we've done before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3442" target="_blank">00:57:22.180</a></span> | <span class="t">And so here we have our example of a sneaker. All right. And we will create our collation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3453" target="_blank">00:57:33.540</a></span> | <span class="t">function collating the dictionary for that data set. That's something to remind you should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3459" target="_blank">00:57:39.660</a></span> | <span class="t">remind yourself we built that ourselves in the data sets notebook. And let's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3466" target="_blank">00:57:46.180</a></span> | <span class="t">make our collate function something that does to device which we wrote in our in our last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3473" target="_blank">00:57:53.260</a></span> | <span class="t">notebook and we'll get a little data loaders function here which is going to go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3479" target="_blank">00:57:59.820</a></span> | <span class="t">each item in the data set dictionary and get a data loader for it and give us a dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3486" target="_blank">00:58:06.900</a></span> | <span class="t">of data loaders. OK. So OK. So now we've got a data loader for training and a data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3499" target="_blank">00:58:19.700</a></span> | <span class="t">for validation. So we can grab the X and Y batch by just calling next on that iterator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3508" target="_blank">00:58:28.860</a></span> | <span class="t">as we've done before. We can grab the let's look at each of these in turn. Actually we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3518" target="_blank">00:58:38.020</a></span> | <span class="t">done all this before but it's a couple of weeks ago. So just to remind you we can get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3522" target="_blank">00:58:42.860</a></span> | <span class="t">the names of the features. And so we can then get create an item getter for our wise and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3532" target="_blank">00:58:52.340</a></span> | <span class="t">we can call that the label getter. We can apply that to our labels to get the titles</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3538" target="_blank">00:58:58.060</a></span> | <span class="t">of everything in our mini batch and we can then call our show images that we created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3545" target="_blank">00:59:05.620</a></span> | <span class="t">with that mini batch with those titles. And here we have our fashion MNIST mini batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3559" target="_blank">00:59:19.380</a></span> | <span class="t">OK. So let's create a classifier and we're just going to use exactly the same code copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3564" target="_blank">00:59:24.460</a></span> | <span class="t">and pasted from the previous notebook. So here is our sequential model. And we are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3581" target="_blank">00:59:41.340</a></span> | <span class="t">to grab the parameters of the CNN and the CNN I've actually moved it over to the device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3595" target="_blank">00:59:55.180</a></span> | <span class="t">The default device was what we created in our last notebook. And as you can see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3598" target="_blank">00:59:58.460</a></span> | <span class="t">fitting. Now our first problem is it's getting very slowly which is kind of annoying. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3610" target="_blank">01:00:10.740</a></span> | <span class="t">why is it running pretty slowly. Let's think about let's have a look at our data set. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3618" target="_blank">01:00:18.820</a></span> | <span class="t">when it's finally finished let's take a look at an item from the data set. Actually let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3627" target="_blank">01:00:27.460</a></span> | <span class="t">look at the data set. Let's actually go all the way back to the data set dictionary. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3635" target="_blank">01:00:35.580</a></span> | <span class="t">before it gets transformed data set dictionary and let's grab the training part of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3645" target="_blank">01:00:45.180</a></span> | <span class="t">And let's grab one item. And actually we can see here the problem for MNIST. We had all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3656" target="_blank">01:00:56.140</a></span> | <span class="t">of the data loaded into memory into a single big tensor. But this hugging face one is created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3663" target="_blank">01:01:03.380</a></span> | <span class="t">in a much more kind of normal way which is each image is a totally separate PNG image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3669" target="_blank">01:01:09.320</a></span> | <span class="t">It's not all pre converted into a single thing. Why is that a problem. Well the reason it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3677" target="_blank">01:01:17.940</a></span> | <span class="t">a problem is that our data loader is spending all of its time decoding these PNGs. So if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3692" target="_blank">01:01:32.580</a></span> | <span class="t">I train here. OK. So while I'm training I can type H top and you can see that basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3702" target="_blank">01:01:42.900</a></span> | <span class="t">my CPU is 100 percent used. Now that's weird because I've actually got 64 CPUs. Why is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3709" target="_blank">01:01:49.260</a></span> | <span class="t">it using just one of them is the first problem. But why does it matter that it's using 100</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3714" target="_blank">01:01:54.100</a></span> | <span class="t">percent CPU. Well the reason it matters. Let's run it again so you can see. Why does it matter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3721" target="_blank">01:02:01.940</a></span> | <span class="t">that our CPU is 100 percent. And why is it making it so slow. Well the reason why is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3727" target="_blank">01:02:07.740</a></span> | <span class="t">if we look at Nvidia SMI demon that will monitor our our GPUs utilization. I've got three GPUs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3737" target="_blank">01:02:17.380</a></span> | <span class="t">I say to choose just the zeroth index one. And you'll see this column here SM. This stands</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3743" target="_blank">01:02:23.400</a></span> | <span class="t">for symmetric model processor. It's like the equivalent of like CPU usage. And generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3748" target="_blank">01:02:28.660</a></span> | <span class="t">we're only using up one percent of our one GPU. So no wonder it's so slow. So the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3758" target="_blank">01:02:38.140</a></span> | <span class="t">thing we want to do then is try to make things faster. Now to make things faster we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3764" target="_blank">01:02:44.900</a></span> | <span class="t">to be using more than one CPU to decode our PNGs. And as it turns out that's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3770" target="_blank">01:02:50.500</a></span> | <span class="t">pretty easy to do. You just have to add a extra argument to your data loaders. Which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3788" target="_blank">01:03:08.900</a></span> | <span class="t">is here num underscore workers. And so I can say use eight CPUs for example. Now if I create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3799" target="_blank">01:03:19.540</a></span> | <span class="t">a recreator data loaders and then try to create get the next one. Oh now I've got an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3805" target="_blank">01:03:25.620</a></span> | <span class="t">And the error is rather quirky. And what it's saying is oh you're you're now trying to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3814" target="_blank">01:03:34.980</a></span> | <span class="t">multiple processes and generally in Python and PyTorch using multiple processes things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3820" target="_blank">01:03:40.160</a></span> | <span class="t">that get complicated. And one of the things that absolutely just doesn't work is you can't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3825" target="_blank">01:03:45.980</a></span> | <span class="t">actually have your data loader put things onto the GPU in your in your separate processes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3836" target="_blank">01:03:56.960</a></span> | <span class="t">It just doesn't work. So the reason for this error is actually because of the fact that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3845" target="_blank">01:04:05.140</a></span> | <span class="t">we used a collate function that put things on the device. That's incompatible unfortunately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3852" target="_blank">01:04:12.220</a></span> | <span class="t">with using multiple workers. So that's that's a problem. And the answer to that problem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3865" target="_blank">01:04:25.100</a></span> | <span class="t">sadly is that we would have to actually rewrite our fit function entirely. So there's annoying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3877" target="_blank">01:04:37.300</a></span> | <span class="t">thing number one. And we don't want to be rewriting our fit function again and again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3881" target="_blank">01:04:41.900</a></span> | <span class="t">We want to have a single fit function. So OK so there's a problem that we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3887" target="_blank">01:04:47.260</a></span> | <span class="t">have to think about. Problem number two is that this is not very accurate. Eighty seven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3897" target="_blank">01:04:57.100</a></span> | <span class="t">percent. Well I mean is it accurate. It's easy enough to find out. There's a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3901" target="_blank">01:05:01.260</a></span> | <span class="t">nice website called papers with code and it will tell you a little leaderboard and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3916" target="_blank">01:05:16.860</a></span> | <span class="t">can see whether we're any good. And the answer is we're not very good at all. So these papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3924" target="_blank">01:05:24.180</a></span> | <span class="t">had ninety six percent ninety four percent ninety two percent. So yeah we're not looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3935" target="_blank">01:05:35.700</a></span> | <span class="t">great. So how do we improve that. There's a lot of things we could try but pretty much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3945" target="_blank">01:05:45.540</a></span> | <span class="t">all of them are going to involve modifying our fit function again and in reasonably complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3953" target="_blank">01:05:53.540</a></span> | <span class="t">ways. So we still got a bit of an issue there. Let's put that aside because what we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3958" target="_blank">01:05:58.660</a></span> | <span class="t">wanted to do is create an auto encoder. So to remind you about what an auto encoder is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3969" target="_blank">01:06:09.500</a></span> | <span class="t">and we're going to be able to go into a bit more detail now we're going to start with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3973" target="_blank">01:06:13.580</a></span> | <span class="t">our input image which is going to be twenty eight by twenty eight. So it's the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3977" target="_blank">01:06:17.660</a></span> | <span class="t">three right. And it's a twenty eight by twenty eight and we're going to put it through for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3984" target="_blank">01:06:24.100</a></span> | <span class="t">example a Stride 2 Conv Stride 2 and that's going to have an output of a fourteen by fourteen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=3997" target="_blank">01:06:37.380</a></span> | <span class="t">and we can have more channels. So say maybe four. So this is twenty eight by twenty eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4002" target="_blank">01:06:42.020</a></span> | <span class="t">by one. That's two fourteen by fourteen by two. So we've reduced the height and width</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4008" target="_blank">01:06:48.100</a></span> | <span class="t">by two but added an extra channel. So overall this is a two X decrease in parameters and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4016" target="_blank">01:06:56.860</a></span> | <span class="t">then we could do another Stride 2 Conv and that would give us a seven by seven. And again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4024" target="_blank">01:07:04.220</a></span> | <span class="t">we can choose however many channels we want but let's say we choose four. So now compared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4029" target="_blank">01:07:09.140</a></span> | <span class="t">to our original we've now got a times four reduction. And so we could do that a few times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4036" target="_blank">01:07:16.300</a></span> | <span class="t">or we could just stay there. And so this is compressing. And so then what we could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4047" target="_blank">01:07:27.300</a></span> | <span class="t">is then somehow have a convolution layer or group of layers which does a convolution and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4056" target="_blank">01:07:36.220</a></span> | <span class="t">also increases the size. There is actually something called a transposed convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4068" target="_blank">01:07:48.140</a></span> | <span class="t">which I'll leave you to look up if you're interested which can do that. Also known as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4073" target="_blank">01:07:53.660</a></span> | <span class="t">a rather weirdly a Stride one half convolution. But there's actually a really simple way to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4080" target="_blank">01:08:00.580</a></span> | <span class="t">do this which is to say let's say you've got a bunch of pixels is that say we've got a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4086" target="_blank">01:08:06.100</a></span> | <span class="t">three by three pixels that looks like this one zero one one say we could make that into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4095" target="_blank">01:08:15.540</a></span> | <span class="t">a six by six very easily which is we could simply get these out. We could simply copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4110" target="_blank">01:08:30.340</a></span> | <span class="t">that pixel there into the first four. Copy that pixel there into these four. And so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4119" target="_blank">01:08:39.140</a></span> | <span class="t">can see and then copy this pixel here into these four. And so we're simply turning each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4125" target="_blank">01:08:45.540</a></span> | <span class="t">pixel into four pixels. And so this is called nearest neighbor up sampling. Now that's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4141" target="_blank">01:09:01.660</a></span> | <span class="t">a convolution that's just copying. But what we could then do is we could then apply a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4147" target="_blank">01:09:07.700</a></span> | <span class="t">Stride one convolution to that right. And that would allow us to double the grid size with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4157" target="_blank">01:09:17.860</a></span> | <span class="t">a convolution. And that's what we're going to do. So our autoencoder is going to need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4163" target="_blank">01:09:23.260</a></span> | <span class="t">a deconvolutional layer and that's going to contain two layers up sampling nearest neighbor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4171" target="_blank">01:09:31.140</a></span> | <span class="t">scale factor of two followed by a conv2d with a Stride of one. OK. And you can see for padding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4180" target="_blank">01:09:40.100</a></span> | <span class="t">I just put kernel size slash slash two. So that's a truncating division because that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4184" target="_blank">01:09:44.260</a></span> | <span class="t">always works for any odd sized kernel. As before we will have an optional activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4190" target="_blank">01:09:50.400</a></span> | <span class="t">function and then we will create a sequential using star layers. So that's going to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4197" target="_blank">01:09:57.460</a></span> | <span class="t">in each layer as a separate argument which is what sequential expects. OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4209" target="_blank">01:10:09.940</a></span> | <span class="t">So let's write a new fitness function goes through. I just basically copied it over from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4217" target="_blank">01:10:17.620</a></span> | <span class="t">our previous one going through each epoch. But I've pulled out a vowel into a separate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4223" target="_blank">01:10:23.740</a></span> | <span class="t">function but it's basically doing the same thing. OK. So here is our autoencoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4241" target="_blank">01:10:41.340</a></span> | <span class="t">And so we're going to it's a bit tricky because I wanted to go down by one to three to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4251" target="_blank">01:10:51.300</a></span> | <span class="t">to a four by four by eight. But starting at twenty eight by twenty eight you can't divide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4258" target="_blank">01:10:58.700</a></span> | <span class="t">that three times and get an integer. So what I first do is I zero pad so add padding of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4265" target="_blank">01:11:05.700</a></span> | <span class="t">two on each side to get a 32 by 32 input. So if I then do a conv with two channel output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4271" target="_blank">01:11:11.980</a></span> | <span class="t">that gives us 16 by 16 by 2 and then again to get an 8 by 8 by 4 and then again to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4277" target="_blank">01:11:17.900</a></span> | <span class="t">a 4 by 4 by 8. So this is doing an 8 X compression and then we can call D conv to do exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4284" target="_blank">01:11:24.860</a></span> | <span class="t">the same thing in reverse. The final one with no activation. And then we can truncate off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4290" target="_blank">01:11:30.140</a></span> | <span class="t">those two pixels off the edge slightly surprisingly PyTorch lets you pass negative two to zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4296" target="_blank">01:11:36.100</a></span> | <span class="t">padding to crop off the final two pixels. And then we'll add a sigmoid which will force</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4302" target="_blank">01:11:42.780</a></span> | <span class="t">everything to go between zero and one which of course is what we need. And then we will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4308" target="_blank">01:11:48.580</a></span> | <span class="t">use MSE loss to compare those pixels to our input pixels. And so a big difference we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4316" target="_blank">01:11:56.620</a></span> | <span class="t">got here now is that our loss function is being applied to the output of the model and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4322" target="_blank">01:12:02.820</a></span> | <span class="t">itself. Right. We don't have YB here. We have XB. So we're trying to recreate our original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4337" target="_blank">01:12:17.060</a></span> | <span class="t">and again this is a bit annoying that we have to create our own fit function. Anyway so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4343" target="_blank">01:12:23.900</a></span> | <span class="t">we can now see what is the MSE loss and it's not like going to be particularly human readable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4350" target="_blank">01:12:30.060</a></span> | <span class="t">but it's it's it's a number we can see if it goes down. And so then we can create then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4363" target="_blank">01:12:43.780</a></span> | <span class="t">we can do our SGD with the parameters of our auto encoder with MSE loss call that fit function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4370" target="_blank">01:12:50.140</a></span> | <span class="t">we just wrote and I won't wait for it to run. As you can see it's really slow for reasons</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4382" target="_blank">01:13:02.780</a></span> | <span class="t">we've discussed. I've got it before. And what we want is to see that the original which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4392" target="_blank">01:13:12.020</a></span> | <span class="t">is which is here gets recreated. And the answer is oh not really. I mean roughly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4410" target="_blank">01:13:30.340</a></span> | <span class="t">things but there's no point having an auto encoder which can't even recreate the originals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4419" target="_blank">01:13:39.000</a></span> | <span class="t">The idea would be that if this if these looked almost identical to these they would say wow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4423" target="_blank">01:13:43.740</a></span> | <span class="t">this is a fantastic network at compressing things by eight times. So I found this like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4434" target="_blank">01:13:54.940</a></span> | <span class="t">very fiddly to try and get this to work at all. Something that I discovered can get it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4439" target="_blank">01:13:59.580</a></span> | <span class="t">to start training is to start with a really low learning rate for a few epochs and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4446" target="_blank">01:14:06.120</a></span> | <span class="t">increase the learning rate after a few epochs. I mean at least it gets it to train and show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4454" target="_blank">01:14:14.740</a></span> | <span class="t">something vaguely sensible. But let's see. Yeah it still looks pretty crummy. This one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4463" target="_blank">01:14:23.680</a></span> | <span class="t">here I got actually by switching to Adam and I actually removed the tricky bit I removed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4471" target="_blank">01:14:31.980</a></span> | <span class="t">these two as well. But yeah I couldn't get this to like recreate anything very reasonable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4479" target="_blank">01:14:39.100</a></span> | <span class="t">or any reasonable amount of time. And you know why is this not working very well. There's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4487" target="_blank">01:14:47.420</a></span> | <span class="t">so many reasons it could be. You know like we do we need a better optimizer do we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4492" target="_blank">01:14:52.620</a></span> | <span class="t">a better architecture. Do we need to use a variational auto encoder. You know there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4498" target="_blank">01:14:58.740</a></span> | <span class="t">a thousand things we could try but you know doing it like this is going to drive us crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4506" target="_blank">01:15:06.060</a></span> | <span class="t">We need to be able to really rapidly try things and all kinds of different things. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4512" target="_blank">01:15:12.620</a></span> | <span class="t">what I often see you know in projects or on Kaggle or whatever people's code looks kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4519" target="_blank">01:15:19.780</a></span> | <span class="t">of like this. It's all like manual and then their iteration speed is is too slow. We need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4529" target="_blank">01:15:29.620</a></span> | <span class="t">to be able to really rapidly try things. So we're not going to keep doing stuff manually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4534" target="_blank">01:15:34.480</a></span> | <span class="t">anymore. This is where we take a halt and we say OK let's build up a framework that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4544" target="_blank">01:15:44.220</a></span> | <span class="t">we can use to rapidly try things and understand when things are working and when things aren't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4550" target="_blank">01:15:50.780</a></span> | <span class="t">working. So we're going to start creating a learner. So what is a learner. It's basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4561" target="_blank">01:16:01.500</a></span> | <span class="t">the idea is this this learner is going to be something that we build which will allow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4565" target="_blank">01:16:05.900</a></span> | <span class="t">us to try like anything that we can imagine very quickly. And we will build that on top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4572" target="_blank">01:16:12.820</a></span> | <span class="t">of that learner things that will allow us to introspect what's going on inside a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4577" target="_blank">01:16:17.420</a></span> | <span class="t">will allow us to do multiprocess CUDA to go fast. It will allow us to add things like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4583" target="_blank">01:16:23.140</a></span> | <span class="t">data augmentation. It will allow us to try a wide variety of architectures quickly and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4587" target="_blank">01:16:27.980</a></span> | <span class="t">so forth. So that's going to be the idea. And of course we're going to create it from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4592" target="_blank">01:16:32.060</a></span> | <span class="t">scratch. And so let's start with fashion. And this does before and let's create a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4603" target="_blank">01:16:43.660</a></span> | <span class="t">loaders class which is going to look a bit like what we had before where we're just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4608" target="_blank">01:16:48.900</a></span> | <span class="t">to pass in. This is just couldn't be simpler right. We're just going to pass in two data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4615" target="_blank">01:16:55.900</a></span> | <span class="t">loaders and store them away. And I'm going to create a class method from data set dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4626" target="_blank">01:17:06.140</a></span> | <span class="t">And what that's going to do is it's going to call data loader on each of the data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4631" target="_blank">01:17:11.660</a></span> | <span class="t">dictionary items with our batch side batch size and instantiate our class. So if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4638" target="_blank">01:17:18.420</a></span> | <span class="t">haven't seen class method before it's what allows us to say data loaders dot something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4644" target="_blank">01:17:24.460</a></span> | <span class="t">in order to construct this. We could have put this in it just as well but we'll be building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4649" target="_blank">01:17:29.780</a></span> | <span class="t">more complex data loaders things later. So I thought we might start by getting the basic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4655" target="_blank">01:17:35.180</a></span> | <span class="t">structure right. So this is all pretty much the same as what we've had before. I'm not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4659" target="_blank">01:17:39.100</a></span> | <span class="t">doing anything on the device here because as we know that didn't really work. OK. Oh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4671" target="_blank">01:17:51.500</a></span> | <span class="t">this is an old thing that I need to Kuda anymore. So we're going to use to device which I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4679" target="_blank">01:17:59.180</a></span> | <span class="t">came from. Here we go. So here's a here's an example of a very simple learner that fits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4695" target="_blank">01:18:15.380</a></span> | <span class="t">on one screen and this is basically going to replace our fit function. So a learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4701" target="_blank">01:18:21.300</a></span> | <span class="t">is going to be something that is going to train or learn a particular model using a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4707" target="_blank">01:18:27.220</a></span> | <span class="t">particular set of data loaders a particular loss function some particular learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4714" target="_blank">01:18:34.060</a></span> | <span class="t">and some particular optimizer or some particular optimization function. Now normally I know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4721" target="_blank">01:18:41.140</a></span> | <span class="t">most people would often kind of store each of these away separately by writing like self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4725" target="_blank">01:18:45.700</a></span> | <span class="t">dot model equals model blah blah blah. Right. And as I think we've talked about before that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4732" target="_blank">01:18:52.260</a></span> | <span class="t">you know that kind of huge amounts of boilerplate. It just it's more stuff that you can get wrong</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4737" target="_blank">01:18:57.220</a></span> | <span class="t">and it's more stuff to mean that you have to read to understand the code. And yeah don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4742" target="_blank">01:19:02.260</a></span> | <span class="t">like that kind of repetition. So instead we just call fastcore dot store atra to do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4747" target="_blank">01:19:07.620</a></span> | <span class="t">all in one line. OK. So that's basically the idea with a class is to think about what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4752" target="_blank">01:19:12.940</a></span> | <span class="t">the information it's going to need. So you pass that all to the constructor store it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4756" target="_blank">01:19:16.980</a></span> | <span class="t">away and then our fit function is going to we've got the basic stuff that we have for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4771" target="_blank">01:19:31.340</a></span> | <span class="t">keeping track of accuracy. This is only work for stuff that's a classification where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4777" target="_blank">01:19:37.220</a></span> | <span class="t">can use accuracy put the model on our device create the optimizer store how many epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4788" target="_blank">01:19:48.740</a></span> | <span class="t">we're going through then for each epoch we'll call the one epoch function and the one epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4794" target="_blank">01:19:54.940</a></span> | <span class="t">function we're going to either do train or evaluation. So we pass in true if we're training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4801" target="_blank">01:20:01.260</a></span> | <span class="t">and false if we're evaluating and they're basically almost the same. We basically set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4807" target="_blank">01:20:07.580</a></span> | <span class="t">the model to training mode or not. We then decide whether to use a validation set or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4814" target="_blank">01:20:14.220</a></span> | <span class="t">the training set based on whether we're training. And then we go through each batch in the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4822" target="_blank">01:20:22.380</a></span> | <span class="t">loader and call one batch and one batch is then the thing which is going to put our batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4830" target="_blank">01:20:30.260</a></span> | <span class="t">onto the device call our model call our loss function. And then if we're training then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4839" target="_blank">01:20:39.300</a></span> | <span class="t">do our backward step our optimizer step in our zero gradient and then finally calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4845" target="_blank">01:20:45.220</a></span> | <span class="t">our metrics or stats. And so here's where we calculate our metrics. So that's basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4851" target="_blank">01:20:51.780</a></span> | <span class="t">what we have there. So let's go back to using an MLP we call fit and the way it goes. This</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4873" target="_blank">01:21:13.980</a></span> | <span class="t">is an error here pointed out by Kevin. Thank you. Self dot model dot two. One thing I guess</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4881" target="_blank">01:21:21.580</a></span> | <span class="t">we could try now is we think that maybe we can use more than one process. So let's try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4891" target="_blank">01:21:31.540</a></span> | <span class="t">that. Oh it's so fast. I didn't even see. There goes. You can see all four CPUs being used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4904" target="_blank">01:21:44.740</a></span> | <span class="t">at once. Bang. It's done. OK. So that's pretty great. Let's see how fast it looks here. Bump</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4912" target="_blank">01:21:52.300</a></span> | <span class="t">bump. All right. Lovely. OK. So that's a good sign. We've got a learner that can fit things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4922" target="_blank">01:22:02.620</a></span> | <span class="t">but it's not very flexible. It's not going to help us for example with our autoencoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4929" target="_blank">01:22:09.820</a></span> | <span class="t">because there's no way of like to say you know changing which which things are used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4934" target="_blank">01:22:14.740</a></span> | <span class="t">for predicting with or for calculating with. We can't use it for anything except things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4938" target="_blank">01:22:18.780</a></span> | <span class="t">that involve accuracy with a binary classification. Sorry. Right. Sorry. Yeah. A multi class classification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4950" target="_blank">01:22:30.580</a></span> | <span class="t">It's not flexible at all but it's a start. And so I wanted to basically put this all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4954" target="_blank">01:22:34.140</a></span> | <span class="t">on one screen so you can see what the basic learner looks like. All right. So how do we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4961" target="_blank">01:22:41.780</a></span> | <span class="t">do things other than multi class accuracy. I decided to create a metric class and basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4975" target="_blank">01:22:55.460</a></span> | <span class="t">a metric class is a something where we are going to define subclasses of it that calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4984" target="_blank">01:23:04.100</a></span> | <span class="t">particular metrics. So for example here I've got a subclass of a metric called accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4990" target="_blank">01:23:10.300</a></span> | <span class="t">So if you haven't done subclasses before you can basically think of this as saying please</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=4997" target="_blank">01:23:17.460</a></span> | <span class="t">copy and paste all the code from here into here for me but the bit that says def calc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5005" target="_blank">01:23:25.500</a></span> | <span class="t">replace it with this version. So in fact this would be identical to copying and pasting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5011" target="_blank">01:23:31.100</a></span> | <span class="t">this whole thing typing accuracy here and replacing the definition of calc with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5023" target="_blank">01:23:43.140</a></span> | <span class="t">That's what is happening here when we do subclassing. So it's basically copying and pasting all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5028" target="_blank">01:23:48.420</a></span> | <span class="t">that code in there for us. It's actually more powerful than that. There's more we can do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5033" target="_blank">01:23:53.500</a></span> | <span class="t">with it. But in this case this is all that's happening with this subclassing and that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5038" target="_blank">01:23:58.460</a></span> | <span class="t">this is called I'll leave that that's fine. OK. So the accuracy metric is here and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5047" target="_blank">01:24:07.900</a></span> | <span class="t">this is kind of our really basic metric which is we're going to use for just for loss. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5053" target="_blank">01:24:13.460</a></span> | <span class="t">so what happens is we're going to let's for example create an accuracy metric object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5062" target="_blank">01:24:22.220</a></span> | <span class="t">We're basically going to add in many batches of data. Right. So for example here's a many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5068" target="_blank">01:24:28.060</a></span> | <span class="t">batches of inputs and predictions. Here's another many batch of inputs and predictions. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5074" target="_blank">01:24:34.060</a></span> | <span class="t">then we're going to call dot value and it will calculate the accuracy. Now dot value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5081" target="_blank">01:24:41.300</a></span> | <span class="t">is a neat little thing. It doesn't require parentheses after it because it's called a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5085" target="_blank">01:24:45.060</a></span> | <span class="t">property. And so a property is something that just calculates automatically without putting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5091" target="_blank">01:24:51.620</a></span> | <span class="t">having to put parentheses. That's all a property is. Well property getter anyway. And so they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5097" target="_blank">01:24:57.140</a></span> | <span class="t">look like this. You give it a name. And so we are going to be each time we call add we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5105" target="_blank">01:25:05.100</a></span> | <span class="t">are going to be storing that input and that target. And also the number of items in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5114" target="_blank">01:25:14.420</a></span> | <span class="t">mini batch optionally. For now that's just always going to be one. And you can see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5122" target="_blank">01:25:22.340</a></span> | <span class="t">that we then call dot calc which is going to call the accuracy calc. So just see how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5129" target="_blank">01:25:29.860</a></span> | <span class="t">often they equal. And then we're going to append to the list of values that calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5143" target="_blank">01:25:43.180</a></span> | <span class="t">And we're also going to append to the list of ends in this case just one. And so then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5148" target="_blank">01:25:48.060</a></span> | <span class="t">to calculate the value we just do that. So that's all that's happening for accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5155" target="_blank">01:25:55.460</a></span> | <span class="t">And then we can do for loss. We can just use metric directly because metric directly will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5160" target="_blank">01:26:00.740</a></span> | <span class="t">just calculate the average of whatever it's past. So we can say oh add the number zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5165" target="_blank">01:26:05.260</a></span> | <span class="t">point six. So the target's optional. And we're saying this is a mini batch of size 32. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5171" target="_blank">01:26:11.500</a></span> | <span class="t">that's going to be the end. And then add the value 0.9 with a mini batch size of 2 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5177" target="_blank">01:26:17.940</a></span> | <span class="t">then get the value. And as you can see that's exactly the same as the weighted average of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5183" target="_blank">01:26:23.860</a></span> | <span class="t">0.6 and 0.9 with weights of 32 and 2. So we've created a metric class. And so that's something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5191" target="_blank">01:26:31.480</a></span> | <span class="t">that we can use to create any metric we like just by overriding calc. Or we could create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5199" target="_blank">01:26:39.980</a></span> | <span class="t">totally things from scratch as long as they have an add and a value. OK. So we're now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5208" target="_blank">01:26:48.180</a></span> | <span class="t">going to change our learner. And what we're going to do is we're going to keep the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5216" target="_blank">01:26:56.500</a></span> | <span class="t">basic structure. So there's going to be fit. It's going to go through each epoch. It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5223" target="_blank">01:27:03.380</a></span> | <span class="t">going to call one epoch passing in true and false as for training invalidation. One epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5231" target="_blank">01:27:11.300</a></span> | <span class="t">is going to go through each batch in the data loader and call one batch. One batch is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5238" target="_blank">01:27:18.060</a></span> | <span class="t">to do the prediction get loss. And if it's training it's going to do the backward step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5244" target="_blank">01:27:24.740</a></span> | <span class="t">and zero grad. But there's a few other things going on. So let's take a look. Actually let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5254" target="_blank">01:27:34.380</a></span> | <span class="t">just look at it in use first. So when we use it we're going to be creating a learner with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5260" target="_blank">01:27:40.740</a></span> | <span class="t">the model data loaders loss function learning rate and some callbacks which we'll learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5265" target="_blank">01:27:45.300</a></span> | <span class="t">about in a moment. And we call fit and it's going to do our thing. And look we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5268" target="_blank">01:27:48.940</a></span> | <span class="t">to have charts and stuff. All right so the basic idea is going to look very similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5274" target="_blank">01:27:54.940</a></span> | <span class="t">So we're going to call fit. So when we construct it we're going to be passing in exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5280" target="_blank">01:28:00.540</a></span> | <span class="t">same things as before. But we've got one extra thing callbacks which we'll see in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5286" target="_blank">01:28:06.700</a></span> | <span class="t">Store the attributes as before and we're going to be doing some stuff with the callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5291" target="_blank">01:28:11.820</a></span> | <span class="t">So when we call fit for this number of epochs we're going to store away how many epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5298" target="_blank">01:28:18.420</a></span> | <span class="t">we're going to do. We're also going to store away the actual range that we're going to loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5304" target="_blank">01:28:24.340</a></span> | <span class="t">through as soft epochs. So here's that looping through soft epochs. We're going to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5310" target="_blank">01:28:30.380</a></span> | <span class="t">the optimizer using the optimizer function and the parameters. And then we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5320" target="_blank">01:28:40.180</a></span> | <span class="t">call underscore fit. Now what on earth is underscore fit. Why didn't we just copy and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5324" target="_blank">01:28:44.460</a></span> | <span class="t">paste this into here? Why do this? It's because we've created this special decorator with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5333" target="_blank">01:28:53.100</a></span> | <span class="t">callbacks. What does that do? So it's up here with callbacks. With callbacks is a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5343" target="_blank">01:29:03.780</a></span> | <span class="t">It's going to just store one thing which is the name. In this case the name is fit. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5352" target="_blank">01:29:12.660</a></span> | <span class="t">what it's going to do is now this is the decorator right. So when we call it remember decorators</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5363" target="_blank">01:29:23.100</a></span> | <span class="t">get past a function. So it's going to get past this whole function. And that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5369" target="_blank">01:29:29.420</a></span> | <span class="t">to be called f. So done to call remember is what happens when a class is treated an object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5375" target="_blank">01:29:35.540</a></span> | <span class="t">is treated as if it's a function. So it's going to get past this function. So this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5380" target="_blank">01:29:40.020</a></span> | <span class="t">is underscore fit. And so what we want to do is we want to return a different function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5386" target="_blank">01:29:46.520</a></span> | <span class="t">It's going to of course call the function that we were asked to call using the arguments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5393" target="_blank">01:29:53.060</a></span> | <span class="t">and keyword arguments we were asked to use. But before it calls that function it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5399" target="_blank">01:29:59.180</a></span> | <span class="t">to call a special method called callback passing in the string before in this case before underscore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5406" target="_blank">01:30:06.460</a></span> | <span class="t">fit. After it's completed it's going to call that method called callback and passing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5413" target="_blank">01:30:13.660</a></span> | <span class="t">string after underscore fit. And it's going to wrap the whole thing in a try accept block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5421" target="_blank">01:30:21.220</a></span> | <span class="t">And it's going to be looking for an exception called cancel fit exception. And if it gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5430" target="_blank">01:30:30.260</a></span> | <span class="t">one it's not going to complain. So let me explain what's going on with all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5434" target="_blank">01:30:34.660</a></span> | <span class="t">things. Let's look at an example of a callback. So for example here is a callback called device</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5449" target="_blank">01:30:49.420</a></span> | <span class="t">cb device callback. And before fit will be called automatically before that underscore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5456" target="_blank">01:30:56.060</a></span> | <span class="t">fit method is called. And it's going to put the model onto our device CUDA or MPS if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5466" target="_blank">01:31:06.380</a></span> | <span class="t">have one otherwise it will just be on GPU. So what's going to happen here. So it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5473" target="_blank">01:31:13.600</a></span> | <span class="t">to call we're going to call fit. It's going to go through these lines of code. It's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5478" target="_blank">01:31:18.660</a></span> | <span class="t">to call underscore fit underscore fit is not this function underscore fit is this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5486" target="_blank">01:31:26.900</a></span> | <span class="t">with F is this function. So it's going to call our learner dot callback passing in before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5496" target="_blank">01:31:36.740</a></span> | <span class="t">underscore fit and callback is defined here. What's callback going to do. It's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5505" target="_blank">01:31:45.660</a></span> | <span class="t">be past the string before underscore fit. It's going to then go through each of our callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5514" target="_blank">01:31:54.620</a></span> | <span class="t">sorted based on their order. And you can see here our callbacks can have an order. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5521" target="_blank">01:32:01.900</a></span> | <span class="t">it's going to look at that callback and try to get an attribute called before underscore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5529" target="_blank">01:32:09.740</a></span> | <span class="t">fit and it will find one. And so then it's going to call that method. Now if that method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5542" target="_blank">01:32:22.740</a></span> | <span class="t">doesn't exist it doesn't appear at all then get acher will return this instead. Identity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5550" target="_blank">01:32:30.020</a></span> | <span class="t">is a function just here. This is an identity function. All it does is whatever arguments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5557" target="_blank">01:32:37.780</a></span> | <span class="t">it gets passed it returns them. And if it's not passed any arguments it just returns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5567" target="_blank">01:32:47.420</a></span> | <span class="t">So there's a lot of Python going on here. And that is why we did that foundations lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5579" target="_blank">01:32:59.220</a></span> | <span class="t">And so for people who haven't done a lot of this Python there's going to be a lot of stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5586" target="_blank">01:33:06.860</a></span> | <span class="t">to experiment with and learn about. And so do ask on the forums if any of these bits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5598" target="_blank">01:33:18.180</a></span> | <span class="t">get confusing. But the best way to learn about these things is to open up this Jupyter notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5603" target="_blank">01:33:23.740</a></span> | <span class="t">and try and create really simple versions of things. So for example let's try identity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5614" target="_blank">01:33:34.980</a></span> | <span class="t">How exactly does identity work? I could call it and it gets nothing. I can call it with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5623" target="_blank">01:33:43.660</a></span> | <span class="t">one. It gets back one. I could call it with a. It gets back a. I can call it with a one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5635" target="_blank">01:33:55.300</a></span> | <span class="t">Call it with a one and get a one. And how is it doing that exactly? So remember we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5644" target="_blank">01:34:04.180</a></span> | <span class="t">add a breakpoint. And this would be a great time to really test your debugging skills.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5652" target="_blank">01:34:12.220</a></span> | <span class="t">So remember in our debugger we can hit H to find out what the commands are. But you really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5656" target="_blank">01:34:16.180</a></span> | <span class="t">should do a tutorial on the debugger if you're not familiar with it. And then we can step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5659" target="_blank">01:34:19.980</a></span> | <span class="t">through each one. So I can now print args. And there's actually a trick which I like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5667" target="_blank">01:34:27.820</a></span> | <span class="t">is that args is actually a command funnily enough which will just tell you the arguments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5672" target="_blank">01:34:32.540</a></span> | <span class="t">to any function regardless of what they're called. Which is kind of nice. And so then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5678" target="_blank">01:34:38.660</a></span> | <span class="t">we can step through by pressing N. And after this we can check like OK what is X now. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5688" target="_blank">01:34:48.820</a></span> | <span class="t">what is args now. Right. So remember to really experiment with these things. So anyway we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5701" target="_blank">01:35:01.660</a></span> | <span class="t">going to talk about this a lot more in the next lesson. But before that if you're not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5713" target="_blank">01:35:13.460</a></span> | <span class="t">familiar with try accept blocks you know spend some time practicing them. If you're not familiar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5719" target="_blank">01:35:19.380</a></span> | <span class="t">with decorators well we've seen them before. So go back and look at them again really carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5726" target="_blank">01:35:26.340</a></span> | <span class="t">If you're not familiar with the debugger practice with that. If you haven't spent much time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5731" target="_blank">01:35:31.160</a></span> | <span class="t">with getatra remind yourself about that. So try to get yourself really familiar and comfortable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5739" target="_blank">01:35:39.620</a></span> | <span class="t">as much as possible with the pieces because if you're not comfortable with the pieces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5744" target="_blank">01:35:44.100</a></span> | <span class="t">and the way we put the pieces together is going to be confusing. There's actually something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5748" target="_blank">01:35:48.700</a></span> | <span class="t">in education in kind of the theory of education called cognitive load theory and the theory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5754" target="_blank">01:35:54.620</a></span> | <span class="t">of cognitive basically cognitive load theory says if you're trying to learn something but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5761" target="_blank">01:36:01.660</a></span> | <span class="t">your cognitive load is really high because of all lots of other things going on at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5765" target="_blank">01:36:05.740</a></span> | <span class="t">same time you're not going to learn it. So it's going to be hard for you to learn this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5772" target="_blank">01:36:12.900</a></span> | <span class="t">framework that we're building if you have too much cognitive load of like what the hell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5777" target="_blank">01:36:17.380</a></span> | <span class="t">is a decorator or what the hell is getatra or what does sort of do or what's partial.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5783" target="_blank">01:36:23.580</a></span> | <span class="t">You know all these things now I actually spent quite a bit of time trying to make this as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5788" target="_blank">01:36:28.380</a></span> | <span class="t">simple as possible. But but also as flexible as it needs to be for the rest of the course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5796" target="_blank">01:36:36.940</a></span> | <span class="t">and this is this is this is as simple as I could get it. So these are kind of things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5801" target="_blank">01:36:41.940</a></span> | <span class="t">that you actually do have to learn. But in doing so you're going to be able to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5807" target="_blank">01:36:47.940</a></span> | <span class="t">some really you know powerful and general code yourself. So hopefully you'll find this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5816" target="_blank">01:36:56.940</a></span> | <span class="t">a really valuable and mind expanding exercise in bringing high level software engineering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5824" target="_blank">01:37:04.180</a></span> | <span class="t">skills to your data science work. OK. So with that this looks like a good place to leave</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5831" target="_blank">01:37:11.380</a></span> | <span class="t">it and look forward to seeing you next time. Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0Hi2r4CaHvk&t=5835" target="_blank">01:37:15.420</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>