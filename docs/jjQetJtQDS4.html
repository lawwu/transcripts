<html><head><title>Bag of *Visual* Words for Image Classification and Retrieval</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Bag of *Visual* Words for Image Classification and Retrieval</h2><a href="https://www.youtube.com/watch?v=jjQetJtQDS4"><img src="https://i.ytimg.com/vi_webp/jjQetJtQDS4/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=27">0:27</a> The Theory of Bag of Visual Words<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=592">9:52</a> Vector Quantization<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=915">15:15</a> Frequency Vectors<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=920">15:20</a> Frequency Vector<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=974">16:14</a> Cosine Similarity<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1814">30:14</a> Data Set of Images<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2588">43:8</a> Frequency Count<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2803">46:43</a> Tf Idf Formula<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2924">48:44</a> Inverse Document Frequency<br><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3067">51:7</a> Minimum and Maximum Cosine Similarities<br><br><div style="text-align: left;"><a href="./jjQetJtQDS4.html">Whisper Transcript</a> | <a href="./transcript_jjQetJtQDS4.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we are going to talk about something called Bag of Visual Words. Now Bag of Visual Words,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=6" target="_blank">00:00:06.480</a></span> | <span class="t">we can use it for essentially converting images into vector embeddings or image embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=14" target="_blank">00:00:14.720</a></span> | <span class="t">and using those image embeddings in image classification and image retrieval. Now this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=23" target="_blank">00:00:23.280</a></span> | <span class="t">video is going to be split into two parts. First part we are going to look at the theory of Bag of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=29" target="_blank">00:00:29.680</a></span> | <span class="t">Visual Words and how it works and then in the second half of the video we will actually look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=34" target="_blank">00:00:34.400</a></span> | <span class="t">at an implementation of it and see how we can implement something like Bag of Visual Words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=40" target="_blank">00:00:40.160</a></span> | <span class="t">in Python. So let's get started with trying to understand what exactly is Bag of Visual Words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=48" target="_blank">00:00:48.320</a></span> | <span class="t">Now for those of you that are coming from NLP, you may have heard of Bag of Words before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=56" target="_blank">00:00:56.000</a></span> | <span class="t">It's a very common technique used in using NLP and information retrieval but it focuses on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=62" target="_blank">00:01:02.880</a></span> | <span class="t">sentences, it focuses on language and text. So we can pretty much visualize it as this. So we take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=70" target="_blank">00:01:10.160</a></span> | <span class="t">a sentence and we pull out all of the individual words from that sentence and then we put them into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=77" target="_blank">00:01:17.040</a></span> | <span class="t">a bag. This bag is unordered so imagine it's just like an unordered list and that's what Bag of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=84" target="_blank">00:01:24.080</a></span> | <span class="t">Words is. Bag of Visual Words is pretty much the same thing but applied to images which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=91" target="_blank">00:01:31.680</a></span> | <span class="t">quite interesting. So how does that possibly make sense? How do we extract words or visual words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=101" target="_blank">00:01:41.680</a></span> | <span class="t">from an image? Well at a very high level it's pretty much what you can see here. So we take a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=108" target="_blank">00:01:48.080</a></span> | <span class="t">load of images and we extract almost like patches from those images and this is not exactly what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=117" target="_blank">00:01:57.600</a></span> | <span class="t">happens. We don't just put those patches into a bag, we actually convert these patches into what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=123" target="_blank">00:02:03.200</a></span> | <span class="t">are called the visual words. So these patches here we would call visual features and then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=130" target="_blank">00:02:10.480</a></span> | <span class="t">do some pre-processing in the middle here. You can't see it right now but we'll fill all that in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=136" target="_blank">00:02:16.240</a></span> | <span class="t">throughout the video and what we get out of that processing is a load of what we call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=143" target="_blank">00:02:23.840</a></span> | <span class="t">visual words. Now as with language there are a limited number of visual words. There are so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=152" target="_blank">00:02:32.960</a></span> | <span class="t">many words in the English language and there are also so many visual words in our image data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=160" target="_blank">00:02:40.480</a></span> | <span class="t">Now a visual feature, let's say this over here is a visual feature, it consists of two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=169" target="_blank">00:02:49.520</a></span> | <span class="t">Consists of a key point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=171" target="_blank">00:02:51.760</a></span> | <span class="t">and a descriptor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=176" target="_blank">00:02:56.560</a></span> | <span class="t">Now key points are the points in an image that the visual feature is located at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=187" target="_blank">00:03:07.200</a></span> | <span class="t">So slider coordinates and they do not change or they should not change as an image is rotated,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=195" target="_blank">00:03:15.280</a></span> | <span class="t">scaled or transformed in some way. And descriptors as you might have guessed are almost like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=203" target="_blank">00:03:23.040</a></span> | <span class="t">description of that particular visual feature. There are multiple algorithms for extracting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=210" target="_blank">00:03:30.240</a></span> | <span class="t">these features and creating these descriptors. You can use algorithms like SIFT, ORB or SURF.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=218" target="_blank">00:03:38.400</a></span> | <span class="t">Now we're not going to go into detail on what those algorithms are doing right now at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=224" target="_blank">00:03:44.240</a></span> | <span class="t">but we'll just understand that they are pretty much looking at these images, they're finding edges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=231" target="_blank">00:03:51.600</a></span> | <span class="t">changes in color, changes in light and just identifying those and running us through a set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=238" target="_blank">00:03:58.640</a></span> | <span class="t">algorithm to create what we call the descriptor. Now the most common of these and the one that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=247" target="_blank">00:04:07.120</a></span> | <span class="t">are going to use is called SIFT. Now SIFT is pretty useful because it's invariant to scale,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=252" target="_blank">00:04:12.480</a></span> | <span class="t">rotation, translation, illumination and blur to an extent. Of course it's not perfect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=260" target="_blank">00:04:20.320</a></span> | <span class="t">but it can deal with all of these things. Now SIFT first looks through the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=266" target="_blank">00:04:26.240</a></span> | <span class="t">and it identifies a key point. So something that it believes is of relevance. So just as one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=272" target="_blank">00:04:32.640</a></span> | <span class="t">example it will probably look up here and there's not really anything in that image. There's no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=280" target="_blank">00:04:40.400</a></span> | <span class="t">difference, it's just one flat color. So it probably won't extract a feature from here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=289" target="_blank">00:04:49.760</a></span> | <span class="t">But when it comes over here it's going to see some edges, you're going to see some changes in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=295" target="_blank">00:04:55.680</a></span> | <span class="t">color and it's going to be like okay well there's something there. So we put a key point there and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=300" target="_blank">00:05:00.480</a></span> | <span class="t">then it's going to go through all of its like algorithmic magic and based on the edges, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=307" target="_blank">00:05:07.600</a></span> | <span class="t">colors, whatever else in that particular patch it is going to produce a 128 dimensional vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=317" target="_blank">00:05:17.680</a></span> | <span class="t">Now it doesn't stop there, it doesn't just find the first patch, it goes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=324" target="_blank">00:05:24.240</a></span> | <span class="t">through an image, it's going to find like a load of patches especially for this image. There's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=329" target="_blank">00:05:29.120</a></span> | <span class="t">lot of information everywhere, it's going to be like okay look there's a window, there's this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=333" target="_blank">00:05:33.440</a></span> | <span class="t">edge over here, something interesting over here, there's all these colors and edges. It's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=338" target="_blank">00:05:38.480</a></span> | <span class="t">find these key points, these visual features everywhere throughout this image and we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=346" target="_blank">00:05:46.240</a></span> | <span class="t">actually see what these look like a little bit later on. So what we get is a load of these visual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=353" target="_blank">00:05:53.840</a></span> | <span class="t">features, the order of those visual features doesn't matter, they're all just kind of placed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=358" target="_blank">00:05:58.960</a></span> | <span class="t">or they're suspended in the air over here. We can almost imagine there's like another bag here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=366" target="_blank">00:06:06.720</a></span> | <span class="t">which is our bag of visual features before it becomes a bag of visual words. So we're kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=372" target="_blank">00:06:12.320</a></span> | <span class="t">at this point right now, so every image just becomes this massive essentially an array with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=377" target="_blank">00:06:17.760</a></span> | <span class="t">all these 128 dimensional sift vectors. Now once we have pulled out all of our visual features from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=385" target="_blank">00:06:25.440</a></span> | <span class="t">an image, we move on to the next step which is how do we go from visual feature to visual word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=392" target="_blank">00:06:32.720</a></span> | <span class="t">Well we have to use what's called a codebook. So a codebook is essentially, it's going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=401" target="_blank">00:06:41.440</a></span> | <span class="t">like our vocabulary. If you come from NLP again, you'll recognize vocabulary is essentially like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=407" target="_blank">00:06:47.200</a></span> | <span class="t">big list of all the words in your data set. This codebook is going to be a big list of all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=417" target="_blank">00:06:57.440</a></span> | <span class="t">visual words from our images but of course we don't have our visual words yet, we need to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=424" target="_blank">00:07:04.240</a></span> | <span class="t">them. So that's what we're going to do next, we're going to build our codebook which is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=430" target="_blank">00:07:10.080</a></span> | <span class="t">going to create all of our visual words at the same time. So how do we construct this codebook?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=436" target="_blank">00:07:16.240</a></span> | <span class="t">Well the idea is that we take a load of similar visual features and we actually cluster them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=446" target="_blank">00:07:26.160</a></span> | <span class="t">together and we get a centroid out of that cluster. Now that centroid is what we would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=454" target="_blank">00:07:34.080</a></span> | <span class="t">call a visual word. So we look at this image here right, on the left over here, these are visual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=464" target="_blank">00:07:44.560</a></span> | <span class="t">features right. We have multiple visual features, there's all these things that look kind of like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=470" target="_blank">00:07:50.320</a></span> | <span class="t">dog's nose from a slightly different position but you know they pretty much look like super similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=479" target="_blank">00:07:59.040</a></span> | <span class="t">Okay and what we do is we process all of these, we use k-means clustering and we get a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=489" target="_blank">00:08:09.840</a></span> | <span class="t">centroid out of this cluster of points that all look very similar. Okay so we go from what is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=497" target="_blank">00:08:17.680</a></span> | <span class="t">this, this is 5, 128 dimensional visual features to 1, still 128 dimensional centroid or visual word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=514" target="_blank">00:08:34.080</a></span> | <span class="t">Okay and we do that using k-means clustering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=518" target="_blank">00:08:38.720</a></span> | <span class="t">Now this does not just happen for a single image. We actually feed in all of our images from our,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=529" target="_blank">00:08:49.760</a></span> | <span class="t">let's call it a training data set. So we'll actually have loads and loads of these images,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=536" target="_blank">00:08:56.240</a></span> | <span class="t">not just one. It's very very bad drawing and okay we have like a dog's nose over here but maybe we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=544" target="_blank">00:09:04.080</a></span> | <span class="t">have another dog over here, another image of a dog and he has a nose obviously, maybe. So these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=551" target="_blank">00:09:11.840</a></span> | <span class="t">centroids here are also going to be very similar to the centroids of this other dog's nose that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=558" target="_blank">00:09:18.640</a></span> | <span class="t">are over here. So in reality we don't just have these five visual features that create our single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=564" target="_blank">00:09:24.960</a></span> | <span class="t">our single cluster over here, our dog nose visual word. We actually probably have quite a lot. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=574" target="_blank">00:09:34.320</a></span> | <span class="t">that's that's the process of creating code but we basically go through all of the visual features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=581" target="_blank">00:09:41.200</a></span> | <span class="t">that we create. We're going to create a lot of them and we compress them into a set of particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=588" target="_blank">00:09:48.320</a></span> | <span class="t">points which become our visual words. Now this process is called vector quantization. It's where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=594" target="_blank">00:09:54.640</a></span> | <span class="t">you take a whole range of vectors and you do something like clustering in order to convert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=607" target="_blank">00:10:07.920</a></span> | <span class="t">this massive range of vectors into just a select few vectors. So again we can use the example or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=617" target="_blank">00:10:17.760</a></span> | <span class="t">the parallel of language. There are pretty much an infinite number of sentences out there in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=624" target="_blank">00:10:24.560</a></span> | <span class="t">world but if we perform bag of words, we extract every word from let's leave stick with the English</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=632" target="_blank">00:10:32.160</a></span> | <span class="t">language sentences at the moment. If we extract every single word and we put them all in a bag</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=637" target="_blank">00:10:37.840</a></span> | <span class="t">and we remove all duplicates we're going to end up with far less than an infinite number of items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=646" target="_blank">00:10:46.000</a></span> | <span class="t">there. That's quantization. I suppose quantization of language. We're going from an infinite number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=653" target="_blank">00:10:53.040</a></span> | <span class="t">of possible sentences to a limited number of possible words that make up those sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=659" target="_blank">00:10:59.760</a></span> | <span class="t">That's exactly what we're doing here. So just taking this one example we have like a church</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=668" target="_blank">00:11:08.000</a></span> | <span class="t">building. Over on the left we have these two visual features. These two dots are visual features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=676" target="_blank">00:11:16.000</a></span> | <span class="t">Maybe we can also have another visual feature over here, over here. All of those should kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=682" target="_blank">00:11:22.800</a></span> | <span class="t">of be very similar. They're like this green window. They have all these similar edges and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=687" target="_blank">00:11:27.600</a></span> | <span class="t">similar colors. So they probably all end up being clustered together into this single visual word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=694" target="_blank">00:11:34.000</a></span> | <span class="t">which is a window. This one over here, we have this kind of like bell tower thing and we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=702" target="_blank">00:11:42.720</a></span> | <span class="t">take different parts of this bell tower and they would probably all feed into a single visual word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=710" target="_blank">00:11:50.080</a></span> | <span class="t">Now one thing I should point out here is this is just one image. Now imagine we took another image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=715" target="_blank">00:11:55.040</a></span> | <span class="t">with other windows inside it. That other image with windows. Let's say the window is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=724" target="_blank">00:12:04.320</a></span> | <span class="t">We would take the visual features from that and they would also be translated into this over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=732" target="_blank">00:12:12.560</a></span> | <span class="t">So what we get out of that is rather than our image being represented by all of these 128</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=743" target="_blank">00:12:23.280</a></span> | <span class="t">dimensional visual features, they are actually represented by these technically 128 dimensional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=751" target="_blank">00:12:31.120</a></span> | <span class="t">visual words. But because there's a limited number of these visual words we can number them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=756" target="_blank">00:12:36.080</a></span> | <span class="t">So for example this one would be zero. This one we selected here would be one, two, three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=764" target="_blank">00:12:44.320</a></span> | <span class="t">and four. Let's for now pretend this is our entire codebook. That means that this image here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=772" target="_blank">00:12:52.080</a></span> | <span class="t">would now be represented by the number of visual words that we found. So the like the frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=779" target="_blank">00:12:59.920</a></span> | <span class="t">of these visual words. So at position zero we have a dog's nose. We didn't see any of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=785" target="_blank">00:13:05.200</a></span> | <span class="t">in this image so that would be zero. This number one here, so we found like these two visual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=791" target="_blank">00:13:11.600</a></span> | <span class="t">features over here. Another one, another one here. So we found four of these. So then this would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=799" target="_blank">00:13:19.120</a></span> | <span class="t">become four. Again we don't have like a I think it's a dog's leg there. In this case we found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=805" target="_blank">00:13:25.600</a></span> | <span class="t">two of these features. So this is a this one we selected here and then here we have zero again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=811" target="_blank">00:13:31.360</a></span> | <span class="t">So what we've done just there is we've gone from this representing this image with a very large</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=820" target="_blank">00:13:40.720</a></span> | <span class="t">number of visual features. So 128 dimensional and also there was six of them in this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=829" target="_blank">00:13:49.120</a></span> | <span class="t">In reality there'd be a lot more. Okay so quite a few values there and then we've kind of compressed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=836" target="_blank">00:13:56.640</a></span> | <span class="t">it down into this five dimensional sparse vector. Now in reality we're not going to just have five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=846" target="_blank">00:14:06.640</a></span> | <span class="t">possible visual words. In the later examples we're going to use around 200 visual words to represent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=853" target="_blank">00:14:13.680</a></span> | <span class="t">just over 9000 images. Okay but that's still a big improvement over you know what we're doing here. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=862" target="_blank">00:14:22.160</a></span> | <span class="t">this massive matrix that we have has now just been translated into a 200 dimensional vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=868" target="_blank">00:14:28.640</a></span> | <span class="t">And as well I should say the images that we that we take later when we actually process for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=875" target="_blank">00:14:35.680</a></span> | <span class="t">this image we won't just get around six visual features we'll get more like say 800 visual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=882" target="_blank">00:14:42.720</a></span> | <span class="t">features. So in reality it'd be something like this 128 dimensions and then we would compress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=889" target="_blank">00:14:49.520</a></span> | <span class="t">that down into a single 200 dimensional vector. Okay that's what we're going to do. Now if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=896" target="_blank">00:14:56.320</a></span> | <span class="t">consider okay how how is this useful to us. So we're going to focus on you know the information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=900" target="_blank">00:15:00.960</a></span> | <span class="t">retrieval side of things but it works as well with image classification where we basically look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=907" target="_blank">00:15:07.440</a></span> | <span class="t">at so for now we're going to add another step in in a moment but for now we're creating what are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=915" target="_blank">00:15:15.520</a></span> | <span class="t">these frequency vectors. So this thing that you saw here it's a frequency vector and that frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=924" target="_blank">00:15:24.320</a></span> | <span class="t">vector is basically telling us okay we have you know in it we have this many I'm just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=931" target="_blank">00:15:31.440</a></span> | <span class="t">use this example this is I think okay two or something like that we have two windows in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=936" target="_blank">00:15:36.960</a></span> | <span class="t">image. In this image we also have these two crosses on top of a bell tower whereas this image of a dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=945" target="_blank">00:15:45.520</a></span> | <span class="t">we have we have a nose of a leg we have a ear right. So if you were to plot these in a high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=953" target="_blank">00:15:53.440</a></span> | <span class="t">dimensional space we'll just you know for for the sake of simplicity we'll pretend okay this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=960" target="_blank">00:16:00.960</a></span> | <span class="t">actually a two-dimensional vector. So our our dog image could be like here okay and our church image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=970" target="_blank">00:16:10.240</a></span> | <span class="t">could be over here. Now they're not similar okay we'll use cosine similarity so that basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=977" target="_blank">00:16:17.120</a></span> | <span class="t">means we're going to measure the angle between vectors. So if we maybe we had another dog image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=983" target="_blank">00:16:23.040</a></span> | <span class="t">and because it has many of the similar visual words it'll be plotted in a similar space in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=989" target="_blank">00:16:29.040</a></span> | <span class="t">similar vector space. So that means that the angle between these two here will be a lot smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=997" target="_blank">00:16:37.440</a></span> | <span class="t">right when you compare it to the angle between either of those and this one here okay and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1003" target="_blank">00:16:43.280</a></span> | <span class="t">we're going to calculate cosine similarity between them and we'll see that the cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1007" target="_blank">00:16:47.760</a></span> | <span class="t">between our more similar images with similar visual words they are more similar. Okay so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1015" target="_blank">00:16:55.280</a></span> | <span class="t">have our our sparse vectors but this is you know there's another step that we need to we need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1021" target="_blank">00:17:01.200</a></span> | <span class="t">take and I'll return to the language example. In language we in NLP we have something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1030" target="_blank">00:17:10.640</a></span> | <span class="t">stop words. Now stop words are basically super common words that don't really tell you much about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1039" target="_blank">00:17:19.040</a></span> | <span class="t">what it is you're looking at. So the word the or the word a the word and all of these words appear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1045" target="_blank">00:17:25.440</a></span> | <span class="t">in language all over the place but they don't necessarily tell you what the topic of whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1052" target="_blank">00:17:32.480</a></span> | <span class="t">it is you're talking about is. Okay and in natural language processing these stop words can be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1062" target="_blank">00:17:42.960</a></span> | <span class="t">overpowering that you know you can get 200 instances of the in a in an article and if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1071" target="_blank">00:17:51.040</a></span> | <span class="t">for example you are reading an article about like Roman history you want to be looking for things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1077" target="_blank">00:17:57.360</a></span> | <span class="t">like the word Rome or the word Julius Caesar or the words Julius and Caesar you don't want to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1085" target="_blank">00:18:05.360</a></span> | <span class="t">looking for the word the it doesn't tell you anything. So these stop words are usually they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1091" target="_blank">00:18:11.840</a></span> | <span class="t">either removed from your sentences or we can use something called TFIDF which allows us to look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1099" target="_blank">00:18:19.600</a></span> | <span class="t">the relevance of words based on how common they are across different documents. So in the example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1107" target="_blank">00:18:27.520</a></span> | <span class="t">I just mentioned we let's say we have articles about a lot of different things and one of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1114" target="_blank">00:18:34.800</a></span> | <span class="t">happens to be this Roman history article and it has the word Rome in it right. So as a user when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1123" target="_blank">00:18:43.280</a></span> | <span class="t">I'm when I'm searching imagine I search something like the history of Rome right. So we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1130" target="_blank">00:18:50.240</a></span> | <span class="t">history of Rome four words there when we're searching we don't want to give equal relevance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1137" target="_blank">00:18:57.200</a></span> | <span class="t">to the word the as we do to Rome and we don't want to give equal relevance to the word of as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1142" target="_blank">00:19:02.880</a></span> | <span class="t">we do to history right. We basically want to just ignore of and ignore the and just focus on Rome</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1149" target="_blank">00:19:09.840</a></span> | <span class="t">and history right. So TFIDF allows us to do that by looking at a frequency of words across all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1157" target="_blank">00:19:17.920</a></span> | <span class="t">these different documents and basically scaling the score of our the frequency scores that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1166" target="_blank">00:19:26.160</a></span> | <span class="t">we've just retrieved based on the frequency of these words throughout all the all your other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1171" target="_blank">00:19:31.600</a></span> | <span class="t">documents and the same is possible with visual words. So we have all of our images they are the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1178" target="_blank">00:19:38.960</a></span> | <span class="t">documents and we have all the visual words in all those all of those images. We use TFIDF to look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1187" target="_blank">00:19:47.920</a></span> | <span class="t">the visual words found in each frequency vector and we use that to essentially lower the score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1198" target="_blank">00:19:58.960</a></span> | <span class="t">of visual words that appear all the time and increase the score of visual words that are very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1204" target="_blank">00:20:04.960</a></span> | <span class="t">rare and very unique to a particular image. So in the church image that you see here in a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1212" target="_blank">00:20:12.400</a></span> | <span class="t">cases SIFT isn't going to pick up patch number one but let's say it did in in this example so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1217" target="_blank">00:20:17.680</a></span> | <span class="t">it's picked up a patch of sky a patch of sky is probably pretty common in a lot of pictures. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1225" target="_blank">00:20:25.280</a></span> | <span class="t">we would want to bring the score of that patch of sky down we'd want to lower it whereas this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1233" target="_blank">00:20:33.920</a></span> | <span class="t">patch number two we want the score of that to be increased or at least just maintained okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1240" target="_blank">00:20:40.720</a></span> | <span class="t">So this is how we do that this is a typical TFIDF formula now TFIDF typically you know we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1248" target="_blank">00:20:48.720</a></span> | <span class="t">think of it with documents and terms which is just words so the notation maybe it's a bit a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1255" target="_blank">00:20:55.040</a></span> | <span class="t">bit weird to translate over into image images here but we'll do it anyway. T refers to term</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1263" target="_blank">00:21:03.440</a></span> | <span class="t">in in typical TFIDF lingo but we are using it to represent visual word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1270" target="_blank">00:21:10.080</a></span> | <span class="t">D usually means document</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1280" target="_blank">00:21:20.000</a></span> | <span class="t">in this case our documents are images so it's an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1282" target="_blank">00:21:22.720</a></span> | <span class="t">Okay and then we have tf td and that refers to the term frequency of a so the frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1299" target="_blank">00:21:39.040</a></span> | <span class="t">of a particular visual word in a particular image. Okay so the frequency or term frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1308" target="_blank">00:21:48.160</a></span> | <span class="t">of visual word in image okay let's say we took over here we have visual word one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1316" target="_blank">00:21:56.480</a></span> | <span class="t">so tf of visual word one in image we'll call this image like image zero in image zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1327" target="_blank">00:22:07.760</a></span> | <span class="t">would be equal to two okay because there are two of these patches or if we want to include the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1335" target="_blank">00:22:15.040</a></span> | <span class="t">other ones it would actually be four. N that you can see over here that is the total number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1342" target="_blank">00:22:22.080</a></span> | <span class="t">images so number of images df t here so that stands for document frequency of term so essentially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1358" target="_blank">00:22:38.480</a></span> | <span class="t">how many documents does our particular visual word appear in or how many images does our visual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1364" target="_blank">00:22:44.560</a></span> | <span class="t">word appear in and all of this is so we we take both of those and we take the log of them. Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1372" target="_blank">00:22:52.160</a></span> | <span class="t">so this here becomes the this is the inverse document frequency this this whole sort of part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1380" target="_blank">00:23:00.240</a></span> | <span class="t">here this is a term frequency we multiply those together and we get this and that gives us the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1390" target="_blank">00:23:10.000</a></span> | <span class="t">tf idf. Now the idf part if you if you look at this so just consider this is useful to understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1399" target="_blank">00:23:19.840</a></span> | <span class="t">we have a number of images number of images does not change based on which image you're looking at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1405" target="_blank">00:23:25.760</a></span> | <span class="t">and the document frequency for a particular term that also does not change depending on whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1412" target="_blank">00:23:32.800</a></span> | <span class="t">you're looking at a particular image or not so this idf vector is actually the same across our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1419" target="_blank">00:23:39.760</a></span> | <span class="t">entire data set okay it is not going to change the only thing that changes is the tf idf which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1426" target="_blank">00:23:46.720</a></span> | <span class="t">is the term frequency so using this we can go from what we have here so all of these all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1433" target="_blank">00:23:53.920</a></span> | <span class="t">these visual words are kind of on the same level there's not really any variation there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1438" target="_blank">00:23:58.000</a></span> | <span class="t">to something more like this so maybe we've decided that a nose is a pretty good indicator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1448" target="_blank">00:24:08.240</a></span> | <span class="t">of something relevant okay whereas like this leg thing here it's not a very good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1454" target="_blank">00:24:14.560</a></span> | <span class="t">indicator or anything okay so they've been adjusted in accordance with their their relevance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1462" target="_blank">00:24:22.320</a></span> | <span class="t">okay so we've just been through how to create our visual words how to create a it's like a sparse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1469" target="_blank">00:24:29.200</a></span> | <span class="t">vector representation of our images based on those visual words and then how to scale the values in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1477" target="_blank">00:24:37.680</a></span> | <span class="t">those sparse vectors based on the relevance of each of each visual word that the values represent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1484" target="_blank">00:24:44.880</a></span> | <span class="t">so after we've done all of that we're sort of ready to move on to the next step which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1489" target="_blank">00:24:49.440</a></span> | <span class="t">maybe you want to feed all these vector representations into a classifier model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1496" target="_blank">00:24:56.560</a></span> | <span class="t">in order to perform some classification or what we're going to go through is how we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1503" target="_blank">00:25:03.360</a></span> | <span class="t">actually retrieve similar images based on these vectors now there are different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1511" target="_blank">00:25:11.840</a></span> | <span class="t">distance or similarity metrics that we can use when we're comparing vectors you have dot product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1518" target="_blank">00:25:18.880</a></span> | <span class="t">similarity you have euclidean distance but we're going to focus on using cosine similarity now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1526" target="_blank">00:25:26.160</a></span> | <span class="t">this is really useful because the tf idf scores that we've output here the magnitude of those of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1533" target="_blank">00:25:33.280</a></span> | <span class="t">those vectors can vary significantly so by using cosine similarity it means that we don't need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1538" target="_blank">00:25:38.960</a></span> | <span class="t">normalize anything so we can just take these vectors and we can compare them immediately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1545" target="_blank">00:25:45.440</a></span> | <span class="t">which is really useful so cosine similarity is calculated like this so let's say we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1553" target="_blank">00:25:53.600</a></span> | <span class="t">i'm gonna draw another one these uh 2d 2d graphs right let's say we have vector a here and we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1562" target="_blank">00:26:02.320</a></span> | <span class="t">vector b over here okay the dot product on the top here this is going to this is going to increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1573" target="_blank">00:26:13.440</a></span> | <span class="t">as these two vectors are are more similar but that by itself this uh this dot product value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1582" target="_blank">00:26:22.800</a></span> | <span class="t">it works poorly when we have other vectors of different magnitude in here so if we had all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1588" target="_blank">00:26:28.000</a></span> | <span class="t">these different vectors let's say we had one over here although we might say that we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1593" target="_blank">00:26:33.520</a></span> | <span class="t">call this one um c c i'm going to call this one d to me it seems like b and c are probably more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1601" target="_blank">00:26:41.920</a></span> | <span class="t">similar than c and d but because d and c have a greater magnitude the dot product which considers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1610" target="_blank">00:26:50.000</a></span> | <span class="t">both angle and magnitude is going to produce a higher score okay and that's even true if maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1618" target="_blank">00:26:58.160</a></span> | <span class="t">let's say we had like b and another item here um even though these are basically the same vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1625" target="_blank">00:27:05.760</a></span> | <span class="t">they would score lower than d and c purely because d and c have a larger magnitude okay so what we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1634" target="_blank">00:27:14.400</a></span> | <span class="t">is we add this item here which looks at the magnitude of a and b together and we we divide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1642" target="_blank">00:27:22.080</a></span> | <span class="t">by that so we're essentially normalizing everything in this in this calculation and that's how we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1648" target="_blank">00:27:28.800</a></span> | <span class="t">calculate the the cosine here so we're actually just calculating the cosine between um between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1653" target="_blank">00:27:33.680</a></span> | <span class="t">angles okay and that gives us our our cosine similarity so um let's have a look at another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1662" target="_blank">00:27:42.080</a></span> | <span class="t">example so here if we had two exactly matching vectors the cosine similarity between those would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1671" target="_blank">00:27:51.360</a></span> | <span class="t">be equal to one if we had two vectors that were a 90 degree angle so vector a is perpendicular to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1678" target="_blank">00:27:58.960</a></span> | <span class="t">vector b we would return a value of zero now because we're using tf idf all of our vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1688" target="_blank">00:28:08.800</a></span> | <span class="t">values are positive so in reality all of our vectors would have to be placed within this space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1695" target="_blank">00:28:15.680</a></span> | <span class="t">here so within like the i'm assuming this is the positive of the y-axis and this is the positive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1701" target="_blank">00:28:21.600</a></span> | <span class="t">of the x-axis so all of our vectors would actually appear in this space here so this vector a down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1708" target="_blank">00:28:28.640</a></span> | <span class="t">here would not happen but just using it for the sake of showing you that we can have a cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1715" target="_blank">00:28:35.600</a></span> | <span class="t">similarity at zero now in this image here i'm just trying to point out the fact okay again it's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1721" target="_blank">00:28:41.920</a></span> | <span class="t">same thing um where we have two images that are exactly the same okay so these uh appear in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1728" target="_blank">00:28:48.640</a></span> | <span class="t">middle here the cosine similarity for those is going to be is going to be one okay and here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1735" target="_blank">00:28:55.280</a></span> | <span class="t">here uh this image there's maybe there's like a building in the background there's some trees so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1740" target="_blank">00:29:00.880</a></span> | <span class="t">it's kind of maybe halfway in between the the church image and the dog image now because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1747" target="_blank">00:29:07.440</a></span> | <span class="t">dog image has some trees the church image has some it's a building so it shares some similarities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1754" target="_blank">00:29:14.560</a></span> | <span class="t">both of them with this this image so it would probably be somewhere in the middle of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1759" target="_blank">00:29:19.520</a></span> | <span class="t">similarity scale okay somewhere around here and then images like the church and the dog they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1768" target="_blank">00:29:28.560</a></span> | <span class="t">there's not already any similarity there so they have a lower closer to zero cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1773" target="_blank">00:29:33.600</a></span> | <span class="t">okay so that is the the theory behind bag of visual words and how we actually retrieve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1783" target="_blank">00:29:43.120</a></span> | <span class="t">similar images using bag of visual words now like i said the two parts of this video now onto the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1790" target="_blank">00:29:50.720</a></span> | <span class="t">second part which is where we're going to have a look at the implementation this all this in python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1796" target="_blank">00:29:56.000</a></span> | <span class="t">now if you want to follow along with this there will be a link to a colab notebook with all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1802" target="_blank">00:30:02.000</a></span> | <span class="t">this in in the description or if you're reading this on pine cone in the resources at the bottom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1809" target="_blank">00:30:09.600</a></span> | <span class="t">of the article so what we first need to consider okay we need a data set of images so we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1817" target="_blank">00:30:17.920</a></span> | <span class="t">to keep this super quick light and simple first we we get a we're not uploading so we download</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1829" target="_blank">00:30:29.600</a></span> | <span class="t">the hug and face data set we're using this one so it's it's like what they describe it as a french</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1836" target="_blank">00:30:36.800</a></span> | <span class="t">image net i'm not sure what makes it french but it's just how they have described this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1844" target="_blank">00:30:44.320</a></span> | <span class="t">but it's a almost 10 000 pretty high resolution images that we can we can just download</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1854" target="_blank">00:30:54.720</a></span> | <span class="t">immediately like this is all we do and we can see straight where we have that church image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1859" target="_blank">00:30:59.440</a></span> | <span class="t">okay and yeah we can see all the images just by printing them like this so first thing we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1867" target="_blank">00:31:07.920</a></span> | <span class="t">want to do is translate these images so these are what are called pill image objects at the moment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1875" target="_blank">00:31:15.280</a></span> | <span class="t">we want to translate those into numpy arrays so we can do that we just go through the entire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1883" target="_blank">00:31:23.600</a></span> | <span class="t">data set and we create this array or this list sorry of items which is going to be a list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1894" target="_blank">00:31:34.720</a></span> | <span class="t">numpy array versions of our pill objects now these images some of them are gray scale some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1900" target="_blank">00:31:40.960</a></span> | <span class="t">of them are color we're going to drop the color from these images and we're just going to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1906" target="_blank">00:31:46.000</a></span> | <span class="t">gray scale so we can do that here so we use the opencv library okay and we just go through and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1924" target="_blank">00:32:04.000</a></span> | <span class="t">convert all of these images if they are rgb images to gray scale if they're already gray</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1932" target="_blank">00:32:12.960</a></span> | <span class="t">scale we don't need to transform them now how do we tell if they're gray scale or not well the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1937" target="_blank">00:32:17.840</a></span> | <span class="t">shape of a of an image that is gray scale is different so let me show you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1949" target="_blank">00:32:29.840</a></span> | <span class="t">images okay so we see here that we have this two-dimensional array okay whereas if we had a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1960" target="_blank">00:32:40.480</a></span> | <span class="t">look at so in images training these are all the color images that we still have if we have a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1967" target="_blank">00:32:47.280</a></span> | <span class="t">at beforehand it's a three-dimensional image because you also have the red green and blue</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1973" target="_blank">00:32:53.200</a></span> | <span class="t">color channels included in that array so that's how we can tell that's why the the length of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1978" target="_blank">00:32:58.000</a></span> | <span class="t">image shape here when it is two we know that if it's greater than two sorry we know that it is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1984" target="_blank">00:33:04.880</a></span> | <span class="t">red rgb image whereas if not it's gray scale</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=1990" target="_blank">00:33:10.960</a></span> | <span class="t">so we can see okay these are the new gray scale images now the next step now that we have our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2002" target="_blank">00:33:22.880</a></span> | <span class="t">however images and they're ready and they're pre-processed we need to go through that process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2006" target="_blank">00:33:26.720</a></span> | <span class="t">of creating our eventually creating our sparse vectors so we start by creating the visual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2011" target="_blank">00:33:31.920</a></span> | <span class="t">features then we move on to visual words then we create the frequency vectors and then we create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2017" target="_blank">00:33:37.200</a></span> | <span class="t">the tf-idf vectors okay so number one visual visual features we do that like so so it's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2024" target="_blank">00:33:44.960</a></span> | <span class="t">pretty simple we are using the using sift from opencv and what we're doing here is just initializing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2034" target="_blank">00:33:54.640</a></span> | <span class="t">lists where we're going to store all of our key points and descriptors so remember we have both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2038" target="_blank">00:33:58.640</a></span> | <span class="t">key point is kind of pointing to where the where the visual feature is and the descriptor is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2046" target="_blank">00:34:06.160</a></span> | <span class="t">description of visual feature 128 dimensional vector and yeah we would so we initialize this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2055" target="_blank">00:34:15.280</a></span> | <span class="t">extractor the sift extractor and here we're just for every image in our black and white images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2061" target="_blank">00:34:21.360</a></span> | <span class="t">we're going through we're extracting the key points and the descriptors and we're adding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2067" target="_blank">00:34:27.760</a></span> | <span class="t">those key points and descriptors to our big list of key points and descriptors here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2075" target="_blank">00:34:35.680</a></span> | <span class="t">now you notice that we're doing this image by image so in here we're actually going to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2082" target="_blank">00:34:42.160</a></span> | <span class="t">so for example the descriptors we're going to have maybe I'll show you in a moment actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2088" target="_blank">00:34:48.400</a></span> | <span class="t">I'm sure I will show you later why don't I show you now so let's have a look at the descriptors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2096" target="_blank">00:34:56.320</a></span> | <span class="t">for I know say image 100 I'm going to look at the shape so for image 100 you see that we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2105" target="_blank">00:35:05.600</a></span> | <span class="t">436 descriptors and each of those descriptors is of dimensionality 128 because it's a sift</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2115" target="_blank">00:35:15.600</a></span> | <span class="t">descriptor okay now this won't happen with this sample but just be aware that some images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2125" target="_blank">00:35:25.200</a></span> | <span class="t">um for example imagine you have like a picture of the sky and there's not really anything there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2130" target="_blank">00:35:30.560</a></span> | <span class="t">it's just like the color of the sky um your the sift algorithm might just return nothing because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2137" target="_blank">00:35:37.120</a></span> | <span class="t">there's no nothing for it to there's no key points for it to look at there's like no change just flat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2142" target="_blank">00:35:42.400</a></span> | <span class="t">image um in that case the the image the sift descriptors will just be none um so we have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2152" target="_blank">00:35:52.880</a></span> | <span class="t">be careful in the next step and just avoid those and so that's what we're doing here if there are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2159" target="_blank">00:35:59.280</a></span> | <span class="t">no descriptors in a particular image descriptor list um we just drop it we just drop that image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2166" target="_blank">00:36:06.880</a></span> | <span class="t">okay but for this sample it's not really a problem but um just letting you know because in other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2172" target="_blank">00:36:12.960</a></span> | <span class="t">data sets you might come into this problem okay so um yeah all we're doing now we're just dropping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2182" target="_blank">00:36:22.320</a></span> | <span class="t">any of those descriptors that don't have any descript any of those images that don't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2189" target="_blank">00:36:29.440</a></span> | <span class="t">any descriptors um as i said not an issue for this for this sample now let's have a look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2196" target="_blank">00:36:36.480</a></span> | <span class="t">what these what these key points and descriptors actually look for look like um so these here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2205" target="_blank">00:36:45.120</a></span> | <span class="t">these are the key points so in each in the middle of each of these circles um we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2211" target="_blank">00:36:51.520</a></span> | <span class="t">we have a descriptor okay so we have the sift algorithm as identified a visual feature in each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2220" target="_blank">00:37:00.160</a></span> | <span class="t">one of these circles okay and we see here and here and and so all right so the the center of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2232" target="_blank">00:37:12.080</a></span> | <span class="t">these circles is the position of the key point uh the line that you can see is like the direction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2238" target="_blank">00:37:18.720</a></span> | <span class="t">of the the feature that was detected and the size of the circles are essentially like the scale of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2245" target="_blank">00:37:25.360</a></span> | <span class="t">the feature that was uh was detected so with all of our we have all of our visual features now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2253" target="_blank">00:37:33.120</a></span> | <span class="t">remember in that list we had visual features visual words um frequency vectors and tf-idf vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2260" target="_blank">00:37:40.560</a></span> | <span class="t">now we're on to the visual words part so first um all we're doing is creating 1000 random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2270" target="_blank">00:37:50.400</a></span> | <span class="t">items a random we're going to use this to select 1000 random images we've added this random seed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2276" target="_blank">00:37:56.320</a></span> | <span class="t">in here so you can reproduce what we what we do here now the reason that we are taking a sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2281" target="_blank">00:38:01.760</a></span> | <span class="t">in the first place is just to speed up the k-means part of this the training part you can leave this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2289" target="_blank">00:38:09.040</a></span> | <span class="t">if you want and just train everything it just it will take longer and so we extract the descriptors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2295" target="_blank">00:38:15.440</a></span> | <span class="t">and the key points for our training sample and we put everything together all the all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2303" target="_blank">00:38:23.120</a></span> | <span class="t">descriptors when we're training k-means we don't care which image a descriptor is in all we care</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2309" target="_blank">00:38:29.120</a></span> | <span class="t">is that the descriptors are there so we take all of our descriptors and we put them all into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2315" target="_blank">00:38:35.120</a></span> | <span class="t">single numpy array um we can check the shape so we have is it one point 1.1 million of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2324" target="_blank">00:38:44.160</a></span> | <span class="t">descriptors it's quite a lot um for less than 10 000 10 000 um images i think i think it's fairly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2332" target="_blank">00:38:52.800</a></span> | <span class="t">large and yeah so um here i'm just showing you okay number of descriptors contained in each image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2346" target="_blank">00:39:06.160</a></span> | <span class="t">sorry each image um so we have like image zero here it has 544 descriptors second one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2356" target="_blank">00:39:16.560</a></span> | <span class="t">quite a lot more quite a lot less and so it's kind of you know each image has a different set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2362" target="_blank">00:39:22.000</a></span> | <span class="t">items in it so that's normal now you have to set the number of visual words that you would like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2370" target="_blank">00:39:30.800</a></span> | <span class="t">from your from your images so it's like the vocab size in nlp were in nlp terms nlp lingo</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2378" target="_blank">00:39:38.000</a></span> | <span class="t">for this i just set k equal to 200 so we're going to have 200 visual words from this we don't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2386" target="_blank">00:39:46.880</a></span> | <span class="t">that many images if you have more images you should probably increase this particularly if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2392" target="_blank">00:39:52.080</a></span> | <span class="t">they're very varied in what they are if they are not varied they're all kind of like the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2396" target="_blank">00:39:56.960</a></span> | <span class="t">you can probably use less um visual words and yeah so we are performing k means here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2405" target="_blank">00:40:05.600</a></span> | <span class="t">we just do for one iteration and that outputs our codebook which is essentially just a big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2412" target="_blank">00:40:12.080</a></span> | <span class="t">list of all of our all of our clusters now uh if you are i don't know maybe you're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2418" target="_blank">00:40:18.720</a></span> | <span class="t">you're creating your codebook on on a machine and then you're going to be using it later on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2423" target="_blank">00:40:23.040</a></span> | <span class="t">like over and over again i figured it's probably pretty important to show you how to actually save</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2427" target="_blank">00:40:27.680</a></span> | <span class="t">and load that codebook now it's pretty easy anyway it's not it's not like it's difficult</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2432" target="_blank">00:40:32.560</a></span> | <span class="t">so we use jobleb here and we just dump k which is you know the the number of visual words that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2441" target="_blank">00:40:41.680</a></span> | <span class="t">have you don't even necessarily need to put that in there you could just use the codebook alone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2445" target="_blank">00:40:45.520</a></span> | <span class="t">and we're going to save it into this pickle file and then when you're loading it at a later later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2450" target="_blank">00:40:50.480</a></span> | <span class="t">point we just use jobleb load there's nothing else to it now at this point we have here we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2458" target="_blank">00:40:58.160</a></span> | <span class="t">we've constructed our codebook um so we have gone we've finished we've created our visual features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2465" target="_blank">00:41:05.600</a></span> | <span class="t">we've created our visual words um and they're all just stored in this codebook and now what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2470" target="_blank">00:41:10.800</a></span> | <span class="t">going to do is take the visual words visual features from our images um process them through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2478" target="_blank">00:41:18.160</a></span> | <span class="t">the visual words that we have in our codebook and use that to create um our sparse frequency vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2485" target="_blank">00:41:25.600</a></span> | <span class="t">so that's what we are doing here so we go through each of our our images in descriptors or the set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2494" target="_blank">00:41:34.000</a></span> | <span class="t">of descriptors image descriptors in descriptors and what we do is we use the vector quantization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2501" target="_blank">00:41:41.360</a></span> | <span class="t">quantization function from from scipy to extract the the visual words from those and what that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2510" target="_blank">00:41:50.480</a></span> | <span class="t">going to do it's not going to extract the actual like the the vectors of visual words you're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2515" target="_blank">00:41:55.280</a></span> | <span class="t">to extract the like ids of the visual words um so we actually get all of these id values each of which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2525" target="_blank">00:42:05.680</a></span> | <span class="t">represents one of our visual words like it's like a token right in nlp you have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2530" target="_blank">00:42:10.560</a></span> | <span class="t">word tokens um in in bag of visual words you have visual word tokens so that's what we that's what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2537" target="_blank">00:42:17.760</a></span> | <span class="t">we have here okay so in image zero uh we know that the first five of our visual words um have these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2548" target="_blank">00:42:28.720</a></span> | <span class="t">tokens okay so number 84 22 and so on and in total there are five hundred three hundred and ninety</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2558" target="_blank">00:42:38.400</a></span> | <span class="t">seven visual words in image zero okay now this here so we can take a look at the the centroid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2568" target="_blank">00:42:48.080</a></span> | <span class="t">so the vectored visual word um by looking at the codebook we go to visual word or use visual word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2576" target="_blank">00:42:56.640</a></span> | <span class="t">id index 84 i'm going to see the shape that is 128 okay that's like our centroid position now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2585" target="_blank">00:43:05.280</a></span> | <span class="t">how do we do the we need to do like a frequency count so how many of each visual word um based</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2594" target="_blank">00:43:14.400</a></span> | <span class="t">on the visual word ids how many of those are in each image okay so uh we know so we know that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2603" target="_blank">00:43:23.360</a></span> | <span class="t">length so let's have a look at the length of our codebook should be 200 okay so what we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2610" target="_blank">00:43:30.720</a></span> | <span class="t">to do here is we're going to create a frequency vector each one of these is going to be of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2615" target="_blank">00:43:35.440</a></span> | <span class="t">dimensionality 200 because that's all the possible uh visual words within our codebook okay so we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2622" target="_blank">00:43:42.080</a></span> | <span class="t">going to loop through all of our visual words and we're going to initialize the frequency vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2629" target="_blank">00:43:49.120</a></span> | <span class="t">for each image and then we're going to loop through each word found in the images visual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2634" target="_blank">00:43:54.960</a></span> | <span class="t">words and for each one of those visual word i index values we use that to add a one in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2643" target="_blank">00:44:03.920</a></span> | <span class="t">position of that visual word in the images frequency vector okay after we've done all that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2650" target="_blank">00:44:10.960</a></span> | <span class="t">we we have basically we have a single frequency vector for every single um image each one of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2657" target="_blank">00:44:17.840</a></span> | <span class="t">dimensionally dimensionality 200 and at the end here we're just reformatting that big list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2665" target="_blank">00:44:25.040</a></span> | <span class="t">numpy vectors into a single numpy array okay and at the end we can see that we have 9469</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2677" target="_blank">00:44:37.840</a></span> | <span class="t">of these frequency vectors each one dimensionality 200 aligning to our codebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2684" target="_blank">00:44:44.000</a></span> | <span class="t">now from above we saw that we had these uh we had these visual word tokens in image i think image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2691" target="_blank">00:44:51.920</a></span> | <span class="t">zero yeah so we had these visual word tokens you can see we have one two one seven two twice here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2699" target="_blank">00:44:59.920</a></span> | <span class="t">okay because that that visual word appears in the image more than once um so let's go down here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2707" target="_blank">00:45:07.440</a></span> | <span class="t">let's have a look at each one of those so actually i don't know why i needed to count i just copy and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2712" target="_blank">00:45:12.800</a></span> | <span class="t">pasted it across um so we can actually even remove that if we want but i'll just leave it so if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2718" target="_blank">00:45:18.720</a></span> | <span class="t">have a look at those we should we would expect all of these values to have at least a value of one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2724" target="_blank">00:45:24.160</a></span> | <span class="t">because we've already seen that they are there and for one one seven two we know there's at least two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2728" target="_blank">00:45:28.400</a></span> | <span class="t">of them in there um and we can see that here so we look at the position frequency vector zero uh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2736" target="_blank">00:45:36.160</a></span> | <span class="t">we look at each one of these positions and we can see that there are numbers there okay and let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2741" target="_blank">00:45:41.840</a></span> | <span class="t">have a look at more of image zero's frequency vector so we we have this here we can increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2748" target="_blank">00:45:48.320</a></span> | <span class="t">this we can show everything i mean so we have this 200 values uh each of these are the frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2757" target="_blank">00:45:57.360</a></span> | <span class="t">of those visual words in that image and we can represent that in a big histogram like this okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2767" target="_blank">00:46:07.120</a></span> | <span class="t">now we want to move on to tf idf part so you know we have all of these um these frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2773" target="_blank">00:46:13.840</a></span> | <span class="t">counts in a big vector but some of those visual words are irrelevant they're like the vision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2780" target="_blank">00:46:20.560</a></span> | <span class="t">equivalent of the word v or the word a or the word and we don't want those in there they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2786" target="_blank">00:46:26.320</a></span> | <span class="t">not not important don't tell us anything so we use tf idf to reduce the the score of those items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2794" target="_blank">00:46:34.880</a></span> | <span class="t">reduce their sort of dominance in our frequency vectors so we are going to use the tf idf formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2805" target="_blank">00:46:45.440</a></span> | <span class="t">that you can see here um so first i'm going to calculate um i'm going to calculate well n we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2813" target="_blank">00:46:53.040</a></span> | <span class="t">already know it's the number of images e.g the size of the data set um and then df is the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2821" target="_blank">00:47:01.360</a></span> | <span class="t">of images that a visual word actually appears in okay so basically what we're doing here is we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2829" target="_blank">00:47:09.440</a></span> | <span class="t">looking at all of the frequency vectors and we're saying okay if there's if there is um in a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2836" target="_blank">00:47:16.480</a></span> | <span class="t">vector if the value is greater than zero e.g one or more e.g that visual word appears in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2844" target="_blank">00:47:24.400</a></span> | <span class="t">particular image we will assign that position one okay and then we take the sum across all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2855" target="_blank">00:47:35.200</a></span> | <span class="t">all of those frequency vectors along the zero axis so basically let's say we have visual word zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2864" target="_blank">00:47:44.080</a></span> | <span class="t">in image zero maybe that visual word is the frequency is three in image one the frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2873" target="_blank">00:47:53.040</a></span> | <span class="t">is two and in image three the frequency is zero if we perform this operation across those just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2880" target="_blank">00:48:00.560</a></span> | <span class="t">those three frequency vectors the value in that for that first column would be equal to two because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2887" target="_blank">00:48:07.600</a></span> | <span class="t">it only appears is only not zero in two of the three images or frequency vectors okay so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2896" target="_blank">00:48:16.000</a></span> | <span class="t">see what's happening here so df shape df shape it's still going to be the same um we are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2902" target="_blank">00:48:22.880</a></span> | <span class="t">like uh we have the 200 dimensionalized frequency vectors we have 9 000 of those um and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2908" target="_blank">00:48:28.960</a></span> | <span class="t">compressing those 9 000 into a single a single um i don't know what we call this like a df vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2917" target="_blank">00:48:37.920</a></span> | <span class="t">okay um now let's have a look at this so the inverse document frequency i suppose we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2927" target="_blank">00:48:47.200</a></span> | <span class="t">call it the inverse image frequency um is just the log of n over df okay nothing nothing special there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2936" target="_blank">00:48:56.080</a></span> | <span class="t">and then to calculate tf idf we also need the term frequency part of tf idf now the term frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2944" target="_blank">00:49:04.000</a></span> | <span class="t">part we actually already have those frequency vectors that we've been uh we've been building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2948" target="_blank">00:49:08.240</a></span> | <span class="t">they are the term frequencies so that's that's all we do uh is the frequency vectors multiplied by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2957" target="_blank">00:49:17.200</a></span> | <span class="t">idf idf by the way we can see here it's just a single vector for all of our our entire data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2964" target="_blank">00:49:24.240</a></span> | <span class="t">okay the only part that changes is the frequency vectors okay and we get this now if we plot that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2970" target="_blank">00:49:30.880</a></span> | <span class="t">you can see now this is the same the same image as before and so if we go up you see that we had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2977" target="_blank">00:49:37.680</a></span> | <span class="t">all of these like kind of high values now we come here and there's just this this really high value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2985" target="_blank">00:49:45.200</a></span> | <span class="t">here maybe that's a visual word of the the cross on top of the church that's probably like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2989" target="_blank">00:49:49.680</a></span> | <span class="t">distinguishing feature if we're looking for maybe looking for religious buildings or churches or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=2993" target="_blank">00:49:53.840</a></span> | <span class="t">something along those lines um whereas the rest of the visual words kind of get pushed down because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3000" target="_blank">00:50:00.560</a></span> | <span class="t">most visual words are probably not going to be that relevant okay now we've generated our tf idf</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3008" target="_blank">00:50:08.560</a></span> | <span class="t">vectors here okay so we have them all stored in tf idf here i'll just point out here we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3015" target="_blank">00:50:15.040</a></span> | <span class="t">just over 9 000 of those and we can begin searching so to search we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3024" target="_blank">00:50:24.480</a></span> | <span class="t">cosine similarity so we're going to solve this this image of a dog to start cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3029" target="_blank">00:50:29.840</a></span> | <span class="t">we calculate like this now we're going to search through the entire search space for for b so in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3038" target="_blank">00:50:38.000</a></span> | <span class="t">this case b is not going to be a vector and we're just going to calculate the cosine similarity for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3042" target="_blank">00:50:42.560</a></span> | <span class="t">all of the all of the items when compared to a so one of those items is going to be the exact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3049" target="_blank">00:50:49.040</a></span> | <span class="t">match to a because a for search i so maybe search i is what is it 6595 that image is still within b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3060" target="_blank">00:51:00.080</a></span> | <span class="t">here so we're going to get at least at the top we're going to get that image returned to us first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3065" target="_blank">00:51:05.840</a></span> | <span class="t">okay so the minimum and maximum cosine similarities zero to pretty much one we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3071" target="_blank">00:51:11.600</a></span> | <span class="t">using floating point numbers so it's not actually exactly one um but it is basically one okay i'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3079" target="_blank">00:51:19.040</a></span> | <span class="t">going to go quite quickly through this so we use numpy argsort to get the most similar items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3086" target="_blank">00:51:26.240</a></span> | <span class="t">the first image should obviously correspond to the image itself uh we'd expect the cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3094" target="_blank">00:51:34.480</a></span> | <span class="t">similarity to be pretty much one um and yeah that's what we get here so we're going to just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3099" target="_blank">00:51:39.840</a></span> | <span class="t">display a few of those so using this as our search term we get um sorry using this was our search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3106" target="_blank">00:51:46.720</a></span> | <span class="t">term now this is the first result cosine similarity is equal to one um go down we get another dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3113" target="_blank">00:51:53.280</a></span> | <span class="t">pretty similar looking we get this you know it's not it's not always perfect and then we get more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3118" target="_blank">00:51:58.800</a></span> | <span class="t">of these uh very similar looking dogs here okay now that looks pretty good so we're going to test</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3125" target="_blank">00:52:05.760</a></span> | <span class="t">for a few more images we have this one here it's like some old record player first we get the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3134" target="_blank">00:52:14.160</a></span> | <span class="t">record player and i don't think this record player actually appears again in this data set but i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3138" target="_blank">00:52:18.400</a></span> | <span class="t">thought it was interesting because we get this printer um i assume it's a printer that looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3143" target="_blank">00:52:23.040</a></span> | <span class="t">very similar it has this like top bit on top and despite the background being very different and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3148" target="_blank">00:52:28.960</a></span> | <span class="t">you know this one's just like an image a picture like a blurry image it manages to pull through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3153" target="_blank">00:52:33.840</a></span> | <span class="t">this object that to me looks pretty similar and then the rest of them is nothing uh of relevance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3159" target="_blank">00:52:39.680</a></span> | <span class="t">maybe this one's like a box it's kind of similar okay this one uh we search this guy with a fish</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3166" target="_blank">00:52:46.240</a></span> | <span class="t">obviously we get the exact image back first and then we get the same guy with fish in a slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3172" target="_blank">00:52:52.000</a></span> | <span class="t">different position it's like open his mouth a little bit as you go to the side and get another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3176" target="_blank">00:52:56.720</a></span> | <span class="t">guy with fish and then here i thought this was kind of interesting so here okay there's no guy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3183" target="_blank">00:53:03.600</a></span> | <span class="t">with fish um but i mean you look at the background of these images right the background of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3189" target="_blank">00:53:09.760</a></span> | <span class="t">images is like some like leafy foresty place and obviously here leafy foresty place so it kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3198" target="_blank">00:53:18.240</a></span> | <span class="t">makes sense that it would pull through this image uh here as well uh for this one i suppose there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3204" target="_blank">00:53:24.080</a></span> | <span class="t">kind of like a forest in the background but otherwise i don't know why it's why this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3208" target="_blank">00:53:28.240</a></span> | <span class="t">is being pulled through this one i thought was interesting so this one it didn't perform well on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3213" target="_blank">00:53:33.680</a></span> | <span class="t">or at least it didn't um return what i would expect it to return okay so we have these two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3220" target="_blank">00:53:40.240</a></span> | <span class="t">parachutists and then we get golf balls a dog of the golf ball but if you look at the this parachute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3229" target="_blank">00:53:49.200</a></span> | <span class="t">here it has this like really thick um black line and then the rest of the parachute is probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3235" target="_blank">00:53:55.440</a></span> | <span class="t">white and here on this uh on this golf ball you have like a very similar black line so i assume</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3242" target="_blank">00:54:02.720</a></span> | <span class="t">for these uh golf balls has actually seen that i mean like okay that's uh they're two very similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3249" target="_blank">00:54:09.520</a></span> | <span class="t">features we have another one here we have this another golf ball um return obviously the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3256" target="_blank">00:54:16.080</a></span> | <span class="t">one again and then return of the golf ball like another golf ball same brand as well and knees</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3262" target="_blank">00:54:22.800</a></span> | <span class="t">as well and then we return this truck i thought maybe the reason it's returning this truck is it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3268" target="_blank">00:54:28.240</a></span> | <span class="t">has like this white ridge pattern on it which the golf balls also have a similar sort of white ridge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3274" target="_blank">00:54:34.240</a></span> | <span class="t">pattern i wasn't too sure um but anyway that one performed quite pretty well i thought</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3280" target="_blank">00:54:40.000</a></span> | <span class="t">this one we have this garbage truck the garbage truck here obviously return the garbage truck</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3289" target="_blank">00:54:49.200</a></span> | <span class="t">um and then we return this image and initially i thought okay it's not very good um first result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3295" target="_blank">00:54:55.120</a></span> | <span class="t">back but then we get a garbage image here but then if you actually look at this image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3301" target="_blank">00:55:01.040</a></span> | <span class="t">and you look in the background that actually does seem to be a garbage truck here it's either a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3306" target="_blank">00:55:06.160</a></span> | <span class="t">garbage truck or like some big industrial bin i'm not really sure um but i thought that was kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3312" target="_blank">00:55:12.320</a></span> | <span class="t">cool that i picked up on this thing in the background i i missed the first time i looked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3317" target="_blank">00:55:17.280</a></span> | <span class="t">at this as well um so that's cool uh but yeah so they're all the results as sort of go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3324" target="_blank">00:55:24.080</a></span> | <span class="t">those quickly to have a look at how it's how it did and you can probably optimize this to be much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3329" target="_blank">00:55:29.760</a></span> | <span class="t">better than what i have here i'll use a very small data set for example um but we've we've done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3336" target="_blank">00:55:36.400</a></span> | <span class="t">something pretty cool i suppose we used k-means so it's learned a little bit there um in terms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3342" target="_blank">00:55:42.560</a></span> | <span class="t">of visual words but otherwise it's it's very simple okay and for me to see this sort of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3349" target="_blank">00:55:49.600</a></span> | <span class="t">performance on you know without like some big neural network or anything um i think it's it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3356" target="_blank">00:55:56.800</a></span> | <span class="t">pretty cool so i hope this has been useful um thank you very much for watching and i will see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jjQetJtQDS4&t=3364" target="_blank">00:56:04.800</a></span> | <span class="t">you again in the next one bye</span></div></div></body></html>