<html><head><title>Let's build the GPT Tokenizer</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Let's build the GPT Tokenizer</h2><a href="https://www.youtube.com/watch?v=zduSFxRajkE"><img src="https://i.ytimg.com/vi_webp/zduSFxRajkE/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=0">0:0</a> intro: Tokenization, GPT-2 paper, tokenization-related issues<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=350">5:50</a> tokenization by example in a Web UI (tiktokenizer)<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=896">14:56</a> strings in Python, Unicode code points<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1095">18:15</a> Unicode byte encodings, ASCII, UTF-8, UTF-16, UTF-32<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1367">22:47</a> daydreaming: deleting tokenization<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1430">23:50</a> Byte Pair Encoding (BPE) algorithm walkthrough<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1622">27:2</a> starting the implementation<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1715">28:35</a> counting consecutive pairs, finding most common pair<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1836">30:36</a> merging the most common pair<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2098">34:58</a> training the tokenizer: adding the while loop, compression ratio<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2360">39:20</a> tokenizer/LLM diagram: it is a completely separate stage<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2567">42:47</a> decoding tokens to strings<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2901">48:21</a> encoding strings to tokens<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3456">57:36</a> regex patterns to force splits across categories<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4298">71:38</a> tiktoken library intro, differences between GPT-2/GPT-4 regex<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4499">74:59</a> GPT-2 encoder.py released by OpenAI walkthrough<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4706">78:26</a> special tokens, tiktoken handling of, GPT-2/GPT-4 differences<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5128">85:28</a> minbpe exercise time! write your own GPT-4 tokenizer<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5322">88:42</a> sentencepiece library intro, used to train Llama 2 vocabulary<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6207">103:27</a> how to set vocabulary set? revisiting gpt.py transformer<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6491">108:11</a> training new tokens, example of prompt compression<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6598">109:58</a> multimodal [image, video, audio] tokenization with vector quantization<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6701">111:41</a> revisiting and explaining the quirks of LLM tokenization<br><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7820">130:20</a> final recommendations<br><br><div style="text-align: left;"><a href="./zduSFxRajkE.html">Whisper Transcript</a> | <a href="./transcript_zduSFxRajkE.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi everyone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1" target="_blank">00:00:01.080</a></span> | <span class="t">So in this video, I'd like us to cover</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2" target="_blank">00:00:02.560</a></span> | <span class="t">the process of tokenization in large language models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5" target="_blank">00:00:05.500</a></span> | <span class="t">Now, you see here that I have a sad face,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7" target="_blank">00:00:07.820</a></span> | <span class="t">and that's because tokenization is my least favorite part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=11" target="_blank">00:00:11.080</a></span> | <span class="t">of working with large language models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=12" target="_blank">00:00:12.640</a></span> | <span class="t">but unfortunately it is necessary to understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=14" target="_blank">00:00:14.480</a></span> | <span class="t">in some detail because it is fairly hairy, gnarly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=17" target="_blank">00:00:17.580</a></span> | <span class="t">and there's a lot of hidden foot guns to be aware of,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=20" target="_blank">00:00:20.400</a></span> | <span class="t">and a lot of oddness with large language models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=22" target="_blank">00:00:22.460</a></span> | <span class="t">typically traces back to tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=25" target="_blank">00:00:25.640</a></span> | <span class="t">So what is tokenization?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=27" target="_blank">00:00:27.580</a></span> | <span class="t">Now, in my previous video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=29" target="_blank">00:00:29.000</a></span> | <span class="t">Let's Build GPT from Scratch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=31" target="_blank">00:00:31.480</a></span> | <span class="t">we actually already did tokenization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=33" target="_blank">00:00:33.260</a></span> | <span class="t">but we did a very naive, simple version of tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=36" target="_blank">00:00:36.920</a></span> | <span class="t">So when you go to the Google Colab for that video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=40" target="_blank">00:00:40.220</a></span> | <span class="t">you see here that we loaded our training set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=43" target="_blank">00:00:43.160</a></span> | <span class="t">and our training set was this Shakespeare data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=46" target="_blank">00:00:46.360</a></span> | <span class="t">Now, in the beginning, the Shakespeare data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=49" target="_blank">00:00:49.000</a></span> | <span class="t">is just a large string in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=51" target="_blank">00:00:51.000</a></span> | <span class="t">It's just text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=52" target="_blank">00:00:52.280</a></span> | <span class="t">And so the question is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=53" target="_blank">00:00:53.120</a></span> | <span class="t">how do we plug text into large language models?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=56" target="_blank">00:00:56.680</a></span> | <span class="t">And in this case here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=59" target="_blank">00:00:59.080</a></span> | <span class="t">we created a vocabulary of 65 possible characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=62" target="_blank">00:01:02.700</a></span> | <span class="t">that we saw occur in this string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=65" target="_blank">00:01:05.120</a></span> | <span class="t">These were the possible characters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=66" target="_blank">00:01:06.680</a></span> | <span class="t">and we saw that there are 65 of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=68" target="_blank">00:01:08.840</a></span> | <span class="t">And then we created a lookup table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=71" target="_blank">00:01:11.320</a></span> | <span class="t">for converting from every possible character,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=74" target="_blank">00:01:14.000</a></span> | <span class="t">a little string piece, into a token, an integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=77" target="_blank">00:01:17.860</a></span> | <span class="t">So here, for example, we tokenized the string, hi there,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=82" target="_blank">00:01:22.440</a></span> | <span class="t">and we received this sequence of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=85" target="_blank">00:01:25.760</a></span> | <span class="t">And here we took the first 1,000 characters of our data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=89" target="_blank">00:01:29.520</a></span> | <span class="t">and we encoded it into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=91" target="_blank">00:01:31.920</a></span> | <span class="t">And because this is character level,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=93" target="_blank">00:01:33.920</a></span> | <span class="t">we received 1,000 tokens in a sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=97" target="_blank">00:01:37.720</a></span> | <span class="t">So token 18, 47, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=100" target="_blank">00:01:40.120</a></span> | <span class="t">Now, later we saw that the way we plug these tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=104" target="_blank">00:01:44.860</a></span> | <span class="t">into the language model is by using an embedding table.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=108" target="_blank">00:01:48.540</a></span> | <span class="t">And so basically, if we have 65 possible tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=112" target="_blank">00:01:52.680</a></span> | <span class="t">then this embedding table is going to have 65 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=116" target="_blank">00:01:56.040</a></span> | <span class="t">And roughly speaking, we're taking the integer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=118" target="_blank">00:01:58.960</a></span> | <span class="t">associated with every single token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=120" target="_blank">00:02:00.720</a></span> | <span class="t">we're using that as a lookup into this table,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=123" target="_blank">00:02:03.800</a></span> | <span class="t">and we're plucking out the corresponding row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=126" target="_blank">00:02:06.320</a></span> | <span class="t">And this row is trainable parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=129" target="_blank">00:02:09.500</a></span> | <span class="t">that we're going to train using backpropagation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=131" target="_blank">00:02:11.360</a></span> | <span class="t">And this is the vector that then feeds into the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=135" target="_blank">00:02:15.180</a></span> | <span class="t">And that's how the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=136" target="_blank">00:02:16.240</a></span> | <span class="t">sort of perceives every single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=138" target="_blank">00:02:18.080</a></span> | <span class="t">So here we had a very naive tokenization process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=142" target="_blank">00:02:22.660</a></span> | <span class="t">that was a character level tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=144" target="_blank">00:02:24.960</a></span> | <span class="t">But in practice, in state-of-the-art language models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=147" target="_blank">00:02:27.920</a></span> | <span class="t">people use a lot more complicated schemes, unfortunately,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=150" target="_blank">00:02:30.640</a></span> | <span class="t">for constructing these token vocabularies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=154" target="_blank">00:02:34.520</a></span> | <span class="t">So we're not dealing on the character level,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=157" target="_blank">00:02:37.640</a></span> | <span class="t">we're dealing on chunk level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=159" target="_blank">00:02:39.320</a></span> | <span class="t">And the way these character chunks are constructed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=163" target="_blank">00:02:43.080</a></span> | <span class="t">is using algorithms such as, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=165" target="_blank">00:02:45.240</a></span> | <span class="t">the byte pair encoding algorithm,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=166" target="_blank">00:02:46.780</a></span> | <span class="t">which we're going to go into in detail</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=168" target="_blank">00:02:48.760</a></span> | <span class="t">and cover in this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=172" target="_blank">00:02:52.200</a></span> | <span class="t">I'd like to briefly show you the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=173" target="_blank">00:02:53.480</a></span> | <span class="t">that introduced byte level encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=176" target="_blank">00:02:56.060</a></span> | <span class="t">as a mechanism for tokenization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=177" target="_blank">00:02:57.720</a></span> | <span class="t">in the context of large language models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=179" target="_blank">00:02:59.880</a></span> | <span class="t">And I would say that that's probably a GPT-2 paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=182" target="_blank">00:03:02.600</a></span> | <span class="t">And if you scroll down here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=184" target="_blank">00:03:04.840</a></span> | <span class="t">to the section input representation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=187" target="_blank">00:03:07.200</a></span> | <span class="t">this is where they cover tokenization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=189" target="_blank">00:03:09.120</a></span> | <span class="t">the kinds of properties</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=189" target="_blank">00:03:09.960</a></span> | <span class="t">that you'd like the tokenization to have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=192" target="_blank">00:03:12.380</a></span> | <span class="t">And they conclude here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=193" target="_blank">00:03:13.220</a></span> | <span class="t">that they're going to have a tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=196" target="_blank">00:03:16.060</a></span> | <span class="t">where you have a vocabulary of 50,257 possible tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=201" target="_blank">00:03:21.620</a></span> | <span class="t">And the context size is going to be 1,024 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=206" target="_blank">00:03:26.320</a></span> | <span class="t">So in the attention layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=208" target="_blank">00:03:28.400</a></span> | <span class="t">of the transformer neural network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=210" target="_blank">00:03:30.520</a></span> | <span class="t">every single token is attending</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=212" target="_blank">00:03:32.120</a></span> | <span class="t">to the previous tokens in the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=213" target="_blank">00:03:33.920</a></span> | <span class="t">And it's going to see up to 1,024 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=217" target="_blank">00:03:37.440</a></span> | <span class="t">So tokens are this like fundamental unit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=220" target="_blank">00:03:40.500</a></span> | <span class="t">the atom of large language models, if you will.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=223" target="_blank">00:03:43.740</a></span> | <span class="t">And everything is in units of tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=225" target="_blank">00:03:45.280</a></span> | <span class="t">everything is about tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=227" target="_blank">00:03:47.000</a></span> | <span class="t">And tokenization is the process for translating strings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=229" target="_blank">00:03:49.840</a></span> | <span class="t">or text into sequences of tokens and vice versa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=234" target="_blank">00:03:54.840</a></span> | <span class="t">When you go into the LLAMA-2 paper as well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=237" target="_blank">00:03:57.280</a></span> | <span class="t">I can show you that when you search token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=239" target="_blank">00:03:59.040</a></span> | <span class="t">you're going to get 63 hits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=241" target="_blank">00:04:01.640</a></span> | <span class="t">And that's because tokens are, again, pervasive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=244" target="_blank">00:04:04.340</a></span> | <span class="t">So here, they mentioned that they trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=245" target="_blank">00:04:05.640</a></span> | <span class="t">on 2 trillion tokens of data and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=248" target="_blank">00:04:08.040</a></span> | <span class="t">So we're going to build our own tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=252" target="_blank">00:04:12.000</a></span> | <span class="t">Luckily, the ByteBear encoding algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=253" target="_blank">00:04:13.560</a></span> | <span class="t">is not that super complicated,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=256" target="_blank">00:04:16.040</a></span> | <span class="t">and we can build it from scratch ourselves,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=257" target="_blank">00:04:17.880</a></span> | <span class="t">and we'll see exactly how this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=259" target="_blank">00:04:19.680</a></span> | <span class="t">Before we dive into code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=260" target="_blank">00:04:20.760</a></span> | <span class="t">I'd like to give you a brief taste</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=262" target="_blank">00:04:22.560</a></span> | <span class="t">of some of the complexities that come from the tokenization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=265" target="_blank">00:04:25.320</a></span> | <span class="t">because I just want to make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=266" target="_blank">00:04:26.520</a></span> | <span class="t">that we motivate it sufficiently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=267" target="_blank">00:04:27.800</a></span> | <span class="t">for why we are doing all of this and why this is so gross.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=271" target="_blank">00:04:31.720</a></span> | <span class="t">So tokenization is at the heart of a lot of weirdness</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=274" target="_blank">00:04:34.720</a></span> | <span class="t">in large language models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=275" target="_blank">00:04:35.880</a></span> | <span class="t">and I would advise that you do not brush it off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=278" target="_blank">00:04:38.800</a></span> | <span class="t">A lot of the issues that may look like just issues</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=281" target="_blank">00:04:41.560</a></span> | <span class="t">with the neural network architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=283" target="_blank">00:04:43.080</a></span> | <span class="t">or the large language model itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=285" target="_blank">00:04:45.380</a></span> | <span class="t">are actually issues with the tokenization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=287" target="_blank">00:04:47.680</a></span> | <span class="t">and fundamentally trace back to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=290" target="_blank">00:04:50.360</a></span> | <span class="t">So if you've noticed any issues</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=292" target="_blank">00:04:52.180</a></span> | <span class="t">with large language models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=293" target="_blank">00:04:53.560</a></span> | <span class="t">can, you know, not able to do spelling tasks very easily,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=297" target="_blank">00:04:57.040</a></span> | <span class="t">that's usually due to tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=299" target="_blank">00:04:59.100</a></span> | <span class="t">Simple string processing can be difficult</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=301" target="_blank">00:05:01.180</a></span> | <span class="t">for the large language model to perform natively.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=303" target="_blank">00:05:03.820</a></span> | <span class="t">Non-English languages can work much worse,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=307" target="_blank">00:05:07.220</a></span> | <span class="t">and to a large extent, this is due to tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=310" target="_blank">00:05:10.260</a></span> | <span class="t">Sometimes LLMs are bad at simple arithmetic,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=312" target="_blank">00:05:12.860</a></span> | <span class="t">also can trace, be traced to tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=316" target="_blank">00:05:16.740</a></span> | <span class="t">GPT-2 specifically would have had quite a bit more issues</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=319" target="_blank">00:05:19.460</a></span> | <span class="t">with Python than future versions of it due to tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=323" target="_blank">00:05:23.860</a></span> | <span class="t">There's a lot of other issues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=324" target="_blank">00:05:24.820</a></span> | <span class="t">Maybe you've seen weird warnings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=325" target="_blank">00:05:25.980</a></span> | <span class="t">about a trailing white space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=327" target="_blank">00:05:27.260</a></span> | <span class="t">This is a tokenization issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=328" target="_blank">00:05:28.700</a></span> | <span class="t">If you had asked GPT earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=332" target="_blank">00:05:32.820</a></span> | <span class="t">about Solid Gold Magikarp and what it is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=335" target="_blank">00:05:35.080</a></span> | <span class="t">you would see the LLM go totally crazy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=337" target="_blank">00:05:37.260</a></span> | <span class="t">and it would start going off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=338" target="_blank">00:05:38.880</a></span> | <span class="t">about a completely unrelated tangent topic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=341" target="_blank">00:05:41.660</a></span> | <span class="t">Maybe you've been told to use YAML over JSON</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=343" target="_blank">00:05:43.700</a></span> | <span class="t">in structured data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=344" target="_blank">00:05:44.780</a></span> | <span class="t">All of that has to do with tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=347" target="_blank">00:05:47.060</a></span> | <span class="t">So basically, tokenization is at the heart of many issues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=350" target="_blank">00:05:50.420</a></span> | <span class="t">I will loop back around to these at the end of the video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=353" target="_blank">00:05:53.200</a></span> | <span class="t">but for now, let me just skip over it a little bit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=356" target="_blank">00:05:56.820</a></span> | <span class="t">and let's go to this web app,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=358" target="_blank">00:05:58.720</a></span> | <span class="t">the tick-tokenizer.vercel.app.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=362" target="_blank">00:06:02.220</a></span> | <span class="t">So I have it loaded here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=363" target="_blank">00:06:03.580</a></span> | <span class="t">and what I like about this web app</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=364" target="_blank">00:06:04.660</a></span> | <span class="t">is that tokenization is running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=366" target="_blank">00:06:06.360</a></span> | <span class="t">sort of live in your browser in JavaScript.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=369" target="_blank">00:06:09.260</a></span> | <span class="t">So you can just type here stuff, hello world,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=371" target="_blank">00:06:11.980</a></span> | <span class="t">and the whole string re-tokenizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=374" target="_blank">00:06:14.120</a></span> | <span class="t">So here what we see on the left</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=378" target="_blank">00:06:18.780</a></span> | <span class="t">is a string that you put in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=380" target="_blank">00:06:20.100</a></span> | <span class="t">On the right, we're currently using a GPT-2 tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=383" target="_blank">00:06:23.220</a></span> | <span class="t">We see that this string that I pasted here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=385" target="_blank">00:06:25.640</a></span> | <span class="t">is currently tokenizing into 300 tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=388" target="_blank">00:06:28.660</a></span> | <span class="t">and here they are sort of shown explicitly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=391" target="_blank">00:06:31.700</a></span> | <span class="t">in different colors for every single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=394" target="_blank">00:06:34.340</a></span> | <span class="t">So for example, this word tokenization became two tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=398" target="_blank">00:06:38.900</a></span> | <span class="t">the token 30,642 and 1,634.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=403" target="_blank">00:06:43.900</a></span> | <span class="t">The token space is, is token 318.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=410" target="_blank">00:06:50.060</a></span> | <span class="t">So be careful, on the bottom, you can show whitespace,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=413" target="_blank">00:06:53.300</a></span> | <span class="t">and keep in mind that there are spaces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=415" target="_blank">00:06:55.580</a></span> | <span class="t">and slash and newline characters in here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=418" target="_blank">00:06:58.560</a></span> | <span class="t">but you can hide them for clarity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=420" target="_blank">00:07:00.840</a></span> | <span class="t">The token space at is token 379.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=426" target="_blank">00:07:06.500</a></span> | <span class="t">The token space the is 262, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=431" target="_blank">00:07:11.100</a></span> | <span class="t">So you notice here that the space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=432" target="_blank">00:07:12.340</a></span> | <span class="t">is part of that token chunk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=435" target="_blank">00:07:15.320</a></span> | <span class="t">Now, so this is kind of like how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=438" target="_blank">00:07:18.740</a></span> | <span class="t">our English sentence broke up,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=440" target="_blank">00:07:20.540</a></span> | <span class="t">and that seems all well and good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=443" target="_blank">00:07:23.180</a></span> | <span class="t">Now here, I put in some arithmetic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=445" target="_blank">00:07:25.900</a></span> | <span class="t">So we see that the token 127 plus,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=449" target="_blank">00:07:29.860</a></span> | <span class="t">and then token six, space six, followed by 77.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=454" target="_blank">00:07:34.060</a></span> | <span class="t">So what's happening here is that 127 is feeding in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=456" target="_blank">00:07:36.740</a></span> | <span class="t">as a single token into the large language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=459" target="_blank">00:07:39.420</a></span> | <span class="t">but the number 677 will actually feed in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=463" target="_blank">00:07:43.700</a></span> | <span class="t">as two separate tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=465" target="_blank">00:07:45.900</a></span> | <span class="t">And so the large language model has to sort of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=468" target="_blank">00:07:48.740</a></span> | <span class="t">take account of that and process it correctly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=472" target="_blank">00:07:52.300</a></span> | <span class="t">in its network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=473" target="_blank">00:07:53.940</a></span> | <span class="t">And see here, 804 will be broken up into two tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=477" target="_blank">00:07:57.180</a></span> | <span class="t">and it's all completely arbitrary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=479" target="_blank">00:07:59.060</a></span> | <span class="t">And here I have another example of four-digit numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=481" target="_blank">00:08:01.660</a></span> | <span class="t">and they break up in a way that they break up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=483" target="_blank">00:08:03.900</a></span> | <span class="t">and it's totally arbitrary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=484" target="_blank">00:08:04.860</a></span> | <span class="t">Sometimes you have multiple digits, a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=488" target="_blank">00:08:08.220</a></span> | <span class="t">Sometimes you have individual digits as many tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=491" target="_blank">00:08:11.420</a></span> | <span class="t">and it's all kind of pretty arbitrary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=492" target="_blank">00:08:12.860</a></span> | <span class="t">and coming out of the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=494" target="_blank">00:08:14.460</a></span> | <span class="t">Here's another example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=497" target="_blank">00:08:17.260</a></span> | <span class="t">We have the string egg,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=500" target="_blank">00:08:20.220</a></span> | <span class="t">and you see here that this became two tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=503" target="_blank">00:08:23.420</a></span> | <span class="t">But for some reason, when I say I have an egg,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=506" target="_blank">00:08:26.320</a></span> | <span class="t">you see when it's a space egg, it's two token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=509" target="_blank">00:08:29.780</a></span> | <span class="t">It's, sorry, it's a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=511" target="_blank">00:08:31.980</a></span> | <span class="t">So just egg by itself in the beginning of a sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=514" target="_blank">00:08:34.460</a></span> | <span class="t">is two tokens, but here as a space egg</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=517" target="_blank">00:08:37.460</a></span> | <span class="t">is suddenly a single token for the exact same string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=521" target="_blank">00:08:41.260</a></span> | <span class="t">Here, lowercase egg turns out to be a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=526" target="_blank">00:08:46.020</a></span> | <span class="t">And in particular, notice that the color is different,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=527" target="_blank">00:08:47.860</a></span> | <span class="t">so this is a different token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=529" target="_blank">00:08:49.440</a></span> | <span class="t">So this is case sensitive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=531" target="_blank">00:08:51.180</a></span> | <span class="t">And of course, capital egg would also be different tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=535" target="_blank">00:08:55.380</a></span> | <span class="t">And again, this would be two tokens arbitrarily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=539" target="_blank">00:08:59.220</a></span> | <span class="t">So for the same concept, egg,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=541" target="_blank">00:09:01.580</a></span> | <span class="t">depending on if it's in the beginning of a sentence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=543" target="_blank">00:09:03.320</a></span> | <span class="t">at the end of a sentence, lowercase, uppercase, or mixed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=546" target="_blank">00:09:06.340</a></span> | <span class="t">all of this will be basically very different tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=549" target="_blank">00:09:09.020</a></span> | <span class="t">and different IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=550" target="_blank">00:09:10.180</a></span> | <span class="t">And the language model has to learn from raw data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=552" target="_blank">00:09:12.500</a></span> | <span class="t">from all the internet text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=553" target="_blank">00:09:13.580</a></span> | <span class="t">that it's going to be training on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=554" target="_blank">00:09:14.980</a></span> | <span class="t">that these are actually all the exact same concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=557" target="_blank">00:09:17.460</a></span> | <span class="t">And it has to sort of group them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=558" target="_blank">00:09:18.860</a></span> | <span class="t">in the parameters of the neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=560" target="_blank">00:09:20.940</a></span> | <span class="t">and understand just based on the data patterns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=563" target="_blank">00:09:23.300</a></span> | <span class="t">that these are all very similar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=564" target="_blank">00:09:24.860</a></span> | <span class="t">but maybe not almost exactly similar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=566" target="_blank">00:09:26.980</a></span> | <span class="t">but very, very similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=570" target="_blank">00:09:30.700</a></span> | <span class="t">After the demonstration here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=572" target="_blank">00:09:32.500</a></span> | <span class="t">I have an introduction from OpenAI's Chachabitty in Korean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=577" target="_blank">00:09:37.500</a></span> | <span class="t">So, (speaking in foreign language)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=580" target="_blank">00:09:40.860</a></span> | <span class="t">et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=582" target="_blank">00:09:42.020</a></span> | <span class="t">So this is in Korean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=583" target="_blank">00:09:43.380</a></span> | <span class="t">And the reason I put this here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=584" target="_blank">00:09:44.700</a></span> | <span class="t">is because you'll notice that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=587" target="_blank">00:09:47.020</a></span> | <span class="t">non-English languages work slightly worse in Chachabitty.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=593" target="_blank">00:09:53.360</a></span> | <span class="t">Part of this is because of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=594" target="_blank">00:09:54.900</a></span> | <span class="t">the training data set for Chachabitty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=596" target="_blank">00:09:56.500</a></span> | <span class="t">is much larger for English than for everything else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=599" target="_blank">00:09:59.380</a></span> | <span class="t">But the same is true,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=600" target="_blank">00:10:00.340</a></span> | <span class="t">not just for the large language model itself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=602" target="_blank">00:10:02.540</a></span> | <span class="t">but also for the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=604" target="_blank">00:10:04.380</a></span> | <span class="t">So when we train the tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=605" target="_blank">00:10:05.860</a></span> | <span class="t">we're going to see that there's a training set as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=607" target="_blank">00:10:07.980</a></span> | <span class="t">And there's a lot more English than non-English.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=610" target="_blank">00:10:10.540</a></span> | <span class="t">And what ends up happening</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=611" target="_blank">00:10:11.820</a></span> | <span class="t">is that we're going to have a lot more longer tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=615" target="_blank">00:10:15.700</a></span> | <span class="t">for English.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=616" target="_blank">00:10:16.580</a></span> | <span class="t">So how do I put this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=619" target="_blank">00:10:19.380</a></span> | <span class="t">If you have a single sentence in English</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=621" target="_blank">00:10:21.260</a></span> | <span class="t">and you tokenize it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=622" target="_blank">00:10:22.420</a></span> | <span class="t">you might see that it's 10 tokens or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=625" target="_blank">00:10:25.180</a></span> | <span class="t">But if you translate that sentence into say Korean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=627" target="_blank">00:10:27.420</a></span> | <span class="t">or Japanese or something else,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=629" target="_blank">00:10:29.220</a></span> | <span class="t">you'll typically see that number of tokens used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=631" target="_blank">00:10:31.220</a></span> | <span class="t">is much larger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=632" target="_blank">00:10:32.380</a></span> | <span class="t">And that's because the chunks here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=634" target="_blank">00:10:34.380</a></span> | <span class="t">are a lot more broken up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=635" target="_blank">00:10:35.920</a></span> | <span class="t">So we're using a lot more tokens for the exact same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=640" target="_blank">00:10:40.420</a></span> | <span class="t">And what this does is it bloats up the sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=643" target="_blank">00:10:43.420</a></span> | <span class="t">of all the documents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=644" target="_blank">00:10:44.960</a></span> | <span class="t">So you're using up more tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=646" target="_blank">00:10:46.980</a></span> | <span class="t">and then in the attention of the transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=649" target="_blank">00:10:49.060</a></span> | <span class="t">when these tokens try to attend each other,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=650" target="_blank">00:10:50.860</a></span> | <span class="t">you are running out of context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=653" target="_blank">00:10:53.180</a></span> | <span class="t">in the maximum context length of that transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=656" target="_blank">00:10:56.500</a></span> | <span class="t">And so basically all the non-English text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=659" target="_blank">00:10:59.700</a></span> | <span class="t">is stretched out from the perspective of the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=663" target="_blank">00:11:03.500</a></span> | <span class="t">And this just has to do with the trinks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=666" target="_blank">00:11:06.220</a></span> | <span class="t">that's used for the tokenizer and the tokenization itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=669" target="_blank">00:11:09.380</a></span> | <span class="t">So it will create a lot bigger tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=671" target="_blank">00:11:11.480</a></span> | <span class="t">and a lot larger groups in English,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=673" target="_blank">00:11:13.620</a></span> | <span class="t">and it will have a lot of little boundaries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=675" target="_blank">00:11:15.940</a></span> | <span class="t">for all the other non-English text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=677" target="_blank">00:11:17.700</a></span> | <span class="t">So if we translated this into English,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=681" target="_blank">00:11:21.620</a></span> | <span class="t">it would be significantly fewer tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=684" target="_blank">00:11:24.380</a></span> | <span class="t">The final example I have here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=685" target="_blank">00:11:25.580</a></span> | <span class="t">is a little snippet of Python for doing FizzBuzz.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=689" target="_blank">00:11:29.180</a></span> | <span class="t">And what I'd like you to notice is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=690" target="_blank">00:11:30.900</a></span> | <span class="t">look, all these individual spaces are all separate tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=695" target="_blank">00:11:35.580</a></span> | <span class="t">They are token 220.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=697" target="_blank">00:11:37.940</a></span> | <span class="t">So 220, 220, 220, 220,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=701" target="_blank">00:11:41.860</a></span> | <span class="t">and then space if is a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=704" target="_blank">00:11:44.780</a></span> | <span class="t">And so what's going on here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=705" target="_blank">00:11:45.700</a></span> | <span class="t">is that when the transformer is going to consume</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=707" target="_blank">00:11:47.620</a></span> | <span class="t">or try to create this text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=710" target="_blank">00:11:50.620</a></span> | <span class="t">it needs to handle all these spaces individually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=713" target="_blank">00:11:53.860</a></span> | <span class="t">They all feed in one by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=715" target="_blank">00:11:55.900</a></span> | <span class="t">into the entire transformer in the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=718" target="_blank">00:11:58.580</a></span> | <span class="t">And so this is being extremely wasteful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=720" target="_blank">00:12:00.820</a></span> | <span class="t">tokenizing it in this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=722" target="_blank">00:12:02.780</a></span> | <span class="t">And so as a result of that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=724" target="_blank">00:12:04.740</a></span> | <span class="t">GPT-2 is not very good with Python,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=727" target="_blank">00:12:07.060</a></span> | <span class="t">and it's not anything to do with coding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=728" target="_blank">00:12:08.860</a></span> | <span class="t">or the language model itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=730" target="_blank">00:12:10.300</a></span> | <span class="t">It's just that if you use a lot of indentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=732" target="_blank">00:12:12.180</a></span> | <span class="t">using space in Python, like we usually do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=735" target="_blank">00:12:15.540</a></span> | <span class="t">you just end up bloating out all the text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=737" target="_blank">00:12:17.800</a></span> | <span class="t">and it's separated across way too much of the sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=740" target="_blank">00:12:20.540</a></span> | <span class="t">and we are running out of the context length in the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=743" target="_blank">00:12:23.760</a></span> | <span class="t">That's roughly speaking what's happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=745" target="_blank">00:12:25.260</a></span> | <span class="t">We're being way too wasteful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=746" target="_blank">00:12:26.580</a></span> | <span class="t">We're taking up way too much token space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=748" target="_blank">00:12:28.740</a></span> | <span class="t">Now, we can also scroll up here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=750" target="_blank">00:12:30.100</a></span> | <span class="t">and we can change the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=751" target="_blank">00:12:31.720</a></span> | <span class="t">So note here that GPT-2 tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=753" target="_blank">00:12:33.700</a></span> | <span class="t">creates a token count of 300 for this string here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=757" target="_blank">00:12:37.760</a></span> | <span class="t">We can change it to CL100K base,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=759" target="_blank">00:12:39.620</a></span> | <span class="t">which is the GPT-4 tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=761" target="_blank">00:12:41.620</a></span> | <span class="t">And we see that the token count drops to 185.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=764" target="_blank">00:12:44.560</a></span> | <span class="t">So for the exact same string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=766" target="_blank">00:12:46.220</a></span> | <span class="t">we are now roughly halving the number of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=769" target="_blank">00:12:49.780</a></span> | <span class="t">And roughly speaking,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=770" target="_blank">00:12:50.620</a></span> | <span class="t">this is because the number of tokens in the GPT-4 tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=774" target="_blank">00:12:54.440</a></span> | <span class="t">is roughly double that of the number of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=777" target="_blank">00:12:57.160</a></span> | <span class="t">in the GPT-2 tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=778" target="_blank">00:12:58.620</a></span> | <span class="t">So we went from roughly 50K to roughly 100K.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=781" target="_blank">00:13:01.720</a></span> | <span class="t">Now, you can imagine that this is a good thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=783" target="_blank">00:13:03.840</a></span> | <span class="t">because the same text is now squished</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=786" target="_blank">00:13:06.820</a></span> | <span class="t">into half as many tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=788" target="_blank">00:13:08.560</a></span> | <span class="t">So this is a lot denser input to the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=792" target="_blank">00:13:12.780</a></span> | <span class="t">And in the transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=795" target="_blank">00:13:15.360</a></span> | <span class="t">every single token has a finite number of tokens before it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=797" target="_blank">00:13:17.880</a></span> | <span class="t">that it's going to pay attention to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=799" target="_blank">00:13:19.560</a></span> | <span class="t">And so what this is doing is we're roughly able to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=802" target="_blank">00:13:22.960</a></span> | <span class="t">twice as much text as a context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=805" target="_blank">00:13:25.840</a></span> | <span class="t">for what token to predict next because of this change.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=809" target="_blank">00:13:29.360</a></span> | <span class="t">But of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=810" target="_blank">00:13:30.200</a></span> | <span class="t">just increasing the number of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=811" target="_blank">00:13:31.520</a></span> | <span class="t">is not strictly better infinitely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=814" target="_blank">00:13:34.520</a></span> | <span class="t">because as you increase the number of tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=816" target="_blank">00:13:36.240</a></span> | <span class="t">now your embedding table is sort of getting a lot larger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=819" target="_blank">00:13:39.960</a></span> | <span class="t">And also at the output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=821" target="_blank">00:13:41.080</a></span> | <span class="t">we are trying to predict the next token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=822" target="_blank">00:13:42.520</a></span> | <span class="t">and there's the softmax there, and that grows as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=825" target="_blank">00:13:45.280</a></span> | <span class="t">We're gonna go into more detail later on this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=827" target="_blank">00:13:47.200</a></span> | <span class="t">but there's some kind of a sweet spot somewhere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=829" target="_blank">00:13:49.560</a></span> | <span class="t">where you have a just right number of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=832" target="_blank">00:13:52.160</a></span> | <span class="t">in your vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=833" target="_blank">00:13:53.200</a></span> | <span class="t">where everything is appropriately dense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=835" target="_blank">00:13:55.360</a></span> | <span class="t">and still fairly efficient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=836" target="_blank">00:13:56.720</a></span> | <span class="t">Now, one thing I would like you to note specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=839" target="_blank">00:13:59.400</a></span> | <span class="t">for the GPT-4 Tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=841" target="_blank">00:14:01.160</a></span> | <span class="t">is that the handling of the whitespace for Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=844" target="_blank">00:14:04.880</a></span> | <span class="t">has improved a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=846" target="_blank">00:14:06.180</a></span> | <span class="t">You see that here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=847" target="_blank">00:14:07.640</a></span> | <span class="t">these four spaces are represented as one single token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=850" target="_blank">00:14:10.120</a></span> | <span class="t">for the three spaces here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=852" target="_blank">00:14:12.400</a></span> | <span class="t">and then the token spaces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=854" target="_blank">00:14:14.640</a></span> | <span class="t">And here, seven spaces were all grouped into a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=858" target="_blank">00:14:18.640</a></span> | <span class="t">So we're being a lot more efficient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=859" target="_blank">00:14:19.960</a></span> | <span class="t">in how we represent Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=861" target="_blank">00:14:21.400</a></span> | <span class="t">And this was a deliberate choice made by OpenAI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=863" target="_blank">00:14:23.680</a></span> | <span class="t">when they designed the GPT-4 Tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=866" target="_blank">00:14:26.440</a></span> | <span class="t">and they group a lot more whitespace into a single character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=870" target="_blank">00:14:30.600</a></span> | <span class="t">What this does is this densifies Python,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=873" target="_blank">00:14:33.880</a></span> | <span class="t">and therefore we can attend to more code before it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=877" target="_blank">00:14:37.980</a></span> | <span class="t">when we're trying to predict the next token in the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=880" target="_blank">00:14:40.760</a></span> | <span class="t">And so the improvement in the Python coding ability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=883" target="_blank">00:14:43.660</a></span> | <span class="t">from GPT-2 to GPT-4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=885" target="_blank">00:14:45.440</a></span> | <span class="t">is not just a matter of the language model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=887" target="_blank">00:14:47.480</a></span> | <span class="t">and the architecture and the details of the optimization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=890" target="_blank">00:14:50.440</a></span> | <span class="t">but a lot of the improvement here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=891" target="_blank">00:14:51.540</a></span> | <span class="t">is also coming from the design of the Tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=893" target="_blank">00:14:53.800</a></span> | <span class="t">and how it groups characters into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=896" target="_blank">00:14:56.720</a></span> | <span class="t">Okay, so let's now start writing some code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=899" target="_blank">00:14:59.360</a></span> | <span class="t">So remember what we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=901" target="_blank">00:15:01.140</a></span> | <span class="t">We want to take strings and feed them into language models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=905" target="_blank">00:15:05.040</a></span> | <span class="t">For that, we need to somehow tokenize strings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=907" target="_blank">00:15:07.640</a></span> | <span class="t">into some integers in some fixed vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=912" target="_blank">00:15:12.120</a></span> | <span class="t">and then we will use those integers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=913" target="_blank">00:15:13.860</a></span> | <span class="t">to make a lookup into a lookup table of vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=916" target="_blank">00:15:16.820</a></span> | <span class="t">and feed those vectors into the transformer as an input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=920" target="_blank">00:15:20.300</a></span> | <span class="t">Now, the reason this gets a little bit tricky, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=922" target="_blank">00:15:22.740</a></span> | <span class="t">is that we don't just want to support</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=924" target="_blank">00:15:24.060</a></span> | <span class="t">the simple English alphabet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=925" target="_blank">00:15:25.760</a></span> | <span class="t">We want to support different kinds of languages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=927" target="_blank">00:15:27.920</a></span> | <span class="t">So this is annyeonghaseyo in Korean, which is hello.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=931" target="_blank">00:15:31.660</a></span> | <span class="t">And we also want to support many kinds of special characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=933" target="_blank">00:15:33.820</a></span> | <span class="t">that we might find on the internet, for example, emoji.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=938" target="_blank">00:15:38.260</a></span> | <span class="t">So how do we feed this text into transformers?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=943" target="_blank">00:15:43.100</a></span> | <span class="t">Well, what is this text anyway in Python?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=946" target="_blank">00:15:46.140</a></span> | <span class="t">So if you go to the documentation of a string in Python,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=949" target="_blank">00:15:49.660</a></span> | <span class="t">you can see that strings are immutable sequences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=952" target="_blank">00:15:52.340</a></span> | <span class="t">of Unicode code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=955" target="_blank">00:15:55.020</a></span> | <span class="t">Okay, what are Unicode code points?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=956" target="_blank">00:15:56.980</a></span> | <span class="t">We can go to Wikipedia.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=959" target="_blank">00:15:59.900</a></span> | <span class="t">So Unicode code points are defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=962" target="_blank">00:16:02.380</a></span> | <span class="t">by the Unicode consortium as part of the Unicode standard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=967" target="_blank">00:16:07.180</a></span> | <span class="t">And what this is really is that it's just a definition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=969" target="_blank">00:16:09.640</a></span> | <span class="t">of roughly 150,000 characters right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=973" target="_blank">00:16:13.000</a></span> | <span class="t">And roughly speaking, what they look like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=975" target="_blank">00:16:15.280</a></span> | <span class="t">and what integers represent those characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=978" target="_blank">00:16:18.680</a></span> | <span class="t">So this is 150,000 characters across 161 scripts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=982" target="_blank">00:16:22.000</a></span> | <span class="t">as of right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=983" target="_blank">00:16:23.620</a></span> | <span class="t">So if you scroll down here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=984" target="_blank">00:16:24.640</a></span> | <span class="t">you can see that the standard is very much alive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=987" target="_blank">00:16:27.280</a></span> | <span class="t">The latest standard 15.1 is September, 2023.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=989" target="_blank">00:16:29.980</a></span> | <span class="t">And basically, this is just a way to define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=994" target="_blank">00:16:34.960</a></span> | <span class="t">lots of types of characters, like for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=998" target="_blank">00:16:38.980</a></span> | <span class="t">all these characters across different scripts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1001" target="_blank">00:16:41.300</a></span> | <span class="t">So the way we can access the Unicode code point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1004" target="_blank">00:16:44.300</a></span> | <span class="t">given a single character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1005" target="_blank">00:16:45.580</a></span> | <span class="t">is by using the ORD function in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1007" target="_blank">00:16:47.620</a></span> | <span class="t">So for example, I can pass in ORD of H,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1010" target="_blank">00:16:50.620</a></span> | <span class="t">and I can see that for the single character H,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1013" target="_blank">00:16:53.980</a></span> | <span class="t">the Unicode code point is 104, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1017" target="_blank">00:16:57.860</a></span> | <span class="t">But this can be arbitrarily complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1020" target="_blank">00:17:00.940</a></span> | <span class="t">So we can take, for example, our emoji here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1023" target="_blank">00:17:03.620</a></span> | <span class="t">and we can see that the code point for this one is 128,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1027" target="_blank">00:17:07.460</a></span> | <span class="t">Or we can take UN,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1029" target="_blank">00:17:09.100</a></span> | <span class="t">and this is 50,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1033" target="_blank">00:17:13.180</a></span> | <span class="t">Now, keep in mind, you can't plug in strings here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1035" target="_blank">00:17:15.860</a></span> | <span class="t">because this doesn't have a single code point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1038" target="_blank">00:17:18.960</a></span> | <span class="t">It only takes a single Unicode code point character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1042" target="_blank">00:17:22.140</a></span> | <span class="t">and tells you its integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1043" target="_blank">00:17:23.800</a></span> | <span class="t">So in this way, we can look up all the characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1049" target="_blank">00:17:29.640</a></span> | <span class="t">of this specific string and their code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1052" target="_blank">00:17:32.020</a></span> | <span class="t">So ORD of X, for X in this string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1055" target="_blank">00:17:35.460</a></span> | <span class="t">and we get this encoding here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1058" target="_blank">00:17:38.560</a></span> | <span class="t">Now, see here, we've already turned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1061" target="_blank">00:17:41.220</a></span> | <span class="t">the raw code points already have integers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1063" target="_blank">00:17:43.740</a></span> | <span class="t">So why can't we simply just use these integers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1066" target="_blank">00:17:46.200</a></span> | <span class="t">and not have any tokenization at all?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1068" target="_blank">00:17:48.260</a></span> | <span class="t">Why can't we just use this natively as is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1070" target="_blank">00:17:50.500</a></span> | <span class="t">and just use the code point?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1072" target="_blank">00:17:52.200</a></span> | <span class="t">Well, one reason for that, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1073" target="_blank">00:17:53.420</a></span> | <span class="t">is that the vocabulary in that case would be quite long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1076" target="_blank">00:17:56.000</a></span> | <span class="t">So in this case, for Unicode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1078" target="_blank">00:17:58.380</a></span> | <span class="t">this is a vocabulary of 150,000 different code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1082" target="_blank">00:18:02.260</a></span> | <span class="t">But more worryingly than that, I think,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1084" target="_blank">00:18:04.300</a></span> | <span class="t">the Unicode standard is very much alive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1086" target="_blank">00:18:06.580</a></span> | <span class="t">and it keeps changing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1088" target="_blank">00:18:08.040</a></span> | <span class="t">And so it's not kind of a stable representation necessarily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1090" target="_blank">00:18:10.940</a></span> | <span class="t">that we may wanna use directly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1093" target="_blank">00:18:13.220</a></span> | <span class="t">So for those reasons, we need something a bit better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1095" target="_blank">00:18:15.860</a></span> | <span class="t">So to find something better, we turn to encodings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1098" target="_blank">00:18:18.740</a></span> | <span class="t">So if we go to the Wikipedia page here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1100" target="_blank">00:18:20.180</a></span> | <span class="t">we see that the Unicode Consortium</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1102" target="_blank">00:18:22.240</a></span> | <span class="t">defines three types of encodings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1104" target="_blank">00:18:24.900</a></span> | <span class="t">UTF-8, UTF-16, and UTF-32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1107" target="_blank">00:18:27.860</a></span> | <span class="t">These encodings are the way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1110" target="_blank">00:18:30.060</a></span> | <span class="t">by which we can take Unicode text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1112" target="_blank">00:18:32.340</a></span> | <span class="t">and translate it into binary data or byte streams.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1116" target="_blank">00:18:36.140</a></span> | <span class="t">UTF-8 is by far the most common.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1118" target="_blank">00:18:38.940</a></span> | <span class="t">So this is the UTF-8 page.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1120" target="_blank">00:18:40.600</a></span> | <span class="t">Now this Wikipedia page is actually quite long,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1123" target="_blank">00:18:43.300</a></span> | <span class="t">but what's important for our purposes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1124" target="_blank">00:18:44.900</a></span> | <span class="t">is that UTF-8 takes every single code point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1127" target="_blank">00:18:47.820</a></span> | <span class="t">and it translates it to a byte stream.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1130" target="_blank">00:18:50.540</a></span> | <span class="t">And this byte stream is between one to four bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1133" target="_blank">00:18:53.380</a></span> | <span class="t">So it's a variable length encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1135" target="_blank">00:18:55.400</a></span> | <span class="t">So depending on the Unicode point, according to the schema,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1138" target="_blank">00:18:58.080</a></span> | <span class="t">you're gonna end up with between one to four bytes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1140" target="_blank">00:19:00.560</a></span> | <span class="t">for each code point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1141" target="_blank">00:19:01.640</a></span> | <span class="t">On top of that, there's UTF-8, UTF-16, and UTF-32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1147" target="_blank">00:19:07.480</a></span> | <span class="t">UTF-32 is nice because it is fixed length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1149" target="_blank">00:19:09.960</a></span> | <span class="t">instead of variable length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1151" target="_blank">00:19:11.120</a></span> | <span class="t">but it has many other downsides as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1153" target="_blank">00:19:13.680</a></span> | <span class="t">So the full kind of spectrum of pros and cons</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1157" target="_blank">00:19:17.720</a></span> | <span class="t">of all these different three encodings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1159" target="_blank">00:19:19.560</a></span> | <span class="t">are beyond the scope of this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1161" target="_blank">00:19:21.400</a></span> | <span class="t">I just like to point out that I enjoyed this blog post</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1164" target="_blank">00:19:24.460</a></span> | <span class="t">and this blog post at the end of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1166" target="_blank">00:19:26.120</a></span> | <span class="t">also has a number of references that can be quite useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1169" target="_blank">00:19:29.160</a></span> | <span class="t">One of them is UTF-8 Everywhere Manifesto.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1172" target="_blank">00:19:32.620</a></span> | <span class="t">And this manifesto describes the reason why UTF-8</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1176" target="_blank">00:19:36.280</a></span> | <span class="t">is significantly preferred and a lot nicer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1179" target="_blank">00:19:39.760</a></span> | <span class="t">than the other encodings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1181" target="_blank">00:19:41.280</a></span> | <span class="t">and why it is used a lot more prominently on the internet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1185" target="_blank">00:19:45.540</a></span> | <span class="t">One of the major advantages, just to give you a sense,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1189" target="_blank">00:19:49.360</a></span> | <span class="t">is that UTF-8 is the only one of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1191" target="_blank">00:19:51.560</a></span> | <span class="t">that is backwards compatible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1193" target="_blank">00:19:53.060</a></span> | <span class="t">to the much simpler ASCII encoding of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1196" target="_blank">00:19:56.860</a></span> | <span class="t">But I'm not gonna go into the full detail in this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1199" target="_blank">00:19:59.580</a></span> | <span class="t">So suffice to say that we like the UTF-8 encoding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1202" target="_blank">00:20:02.420</a></span> | <span class="t">and let's try to take the string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1204" target="_blank">00:20:04.700</a></span> | <span class="t">and see what we get if we encode it into UTF-8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1207" target="_blank">00:20:07.360</a></span> | <span class="t">The string class in Python actually has dot encode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1211" target="_blank">00:20:11.660</a></span> | <span class="t">and you can give it the encoding, which is, say, UTF-8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1215" target="_blank">00:20:15.180</a></span> | <span class="t">Now, what we get out of this is not very nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1217" target="_blank">00:20:17.180</a></span> | <span class="t">because this is the bytes, this is a bytes object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1220" target="_blank">00:20:20.540</a></span> | <span class="t">and it's not very nice in the way that it's printed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1223" target="_blank">00:20:23.500</a></span> | <span class="t">So I personally like to take it through a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1226" target="_blank">00:20:26.040</a></span> | <span class="t">because then we actually get the raw bytes of this encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1230" target="_blank">00:20:30.840</a></span> | <span class="t">So this is the raw bytes that represent this string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1235" target="_blank">00:20:35.680</a></span> | <span class="t">according to the UTF-8 encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1237" target="_blank">00:20:37.980</a></span> | <span class="t">We can also look at UTF-16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1240" target="_blank">00:20:40.100</a></span> | <span class="t">We get a slightly different byte stream.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1242" target="_blank">00:20:42.520</a></span> | <span class="t">And here we start to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1243" target="_blank">00:20:43.680</a></span> | <span class="t">one of the disadvantages of UTF-16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1245" target="_blank">00:20:45.620</a></span> | <span class="t">You see how we have zero something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1247" target="_blank">00:20:47.800</a></span> | <span class="t">zero something, zero something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1249" target="_blank">00:20:49.360</a></span> | <span class="t">We're starting to get a sense that this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1250" target="_blank">00:20:50.560</a></span> | <span class="t">a bit of a wasteful encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1252" target="_blank">00:20:52.280</a></span> | <span class="t">And indeed, for simple ASCII characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1255" target="_blank">00:20:55.360</a></span> | <span class="t">or English characters here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1257" target="_blank">00:20:57.320</a></span> | <span class="t">we just have the structure of zero something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1258" target="_blank">00:20:58.880</a></span> | <span class="t">zero something, and it's not exactly nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1262" target="_blank">00:21:02.280</a></span> | <span class="t">Same for UTF-32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1264" target="_blank">00:21:04.000</a></span> | <span class="t">When we expand this, we can start to get a sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1266" target="_blank">00:21:06.140</a></span> | <span class="t">of the wastefulness of this encoding for our purposes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1268" target="_blank">00:21:08.960</a></span> | <span class="t">You see a lot of zeros followed by something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1271" target="_blank">00:21:11.460</a></span> | <span class="t">and so this is not desirable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1274" target="_blank">00:21:14.580</a></span> | <span class="t">So suffice it to say that we would like to stick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1278" target="_blank">00:21:18.820</a></span> | <span class="t">with UTF-8 for our purposes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1281" target="_blank">00:21:21.780</a></span> | <span class="t">However, if we just use UTF-8 naively,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1284" target="_blank">00:21:24.660</a></span> | <span class="t">these are byte streams.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1286" target="_blank">00:21:26.060</a></span> | <span class="t">So that would imply a vocabulary length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1288" target="_blank">00:21:28.680</a></span> | <span class="t">of only 256 possible tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1292" target="_blank">00:21:32.340</a></span> | <span class="t">But this vocabulary size is very, very small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1295" target="_blank">00:21:35.260</a></span> | <span class="t">What this is going to do if we just were to use it naively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1297" target="_blank">00:21:37.900</a></span> | <span class="t">is that all of our text would be stretched out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1301" target="_blank">00:21:41.140</a></span> | <span class="t">over very, very long sequences of bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1304" target="_blank">00:21:44.400</a></span> | <span class="t">And so what this does is that certainly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1309" target="_blank">00:21:49.400</a></span> | <span class="t">the embedding table is going to be tiny,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1311" target="_blank">00:21:51.060</a></span> | <span class="t">and the prediction at the top of the final layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1312" target="_blank">00:21:52.980</a></span> | <span class="t">is going to be very tiny, but our sequences are very long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1315" target="_blank">00:21:55.940</a></span> | <span class="t">And remember that we have pretty finite context lengths</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1319" target="_blank">00:21:59.860</a></span> | <span class="t">in the attention that we can support in a transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1322" target="_blank">00:22:02.660</a></span> | <span class="t">for computational reasons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1324" target="_blank">00:22:04.220</a></span> | <span class="t">And so we only have as much context length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1327" target="_blank">00:22:07.140</a></span> | <span class="t">but now we have very, very long sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1329" target="_blank">00:22:09.320</a></span> | <span class="t">And this is just inefficient,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1330" target="_blank">00:22:10.300</a></span> | <span class="t">and it's not going to allow us to attend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1332" target="_blank">00:22:12.220</a></span> | <span class="t">to sufficiently long text before us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1335" target="_blank">00:22:15.100</a></span> | <span class="t">for the purposes of the next token prediction task.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1338" target="_blank">00:22:18.020</a></span> | <span class="t">So we don't want to use the raw bytes of the UTF-8 encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1343" target="_blank">00:22:23.020</a></span> | <span class="t">We want to be able to support larger vocabulary size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1346" target="_blank">00:22:26.780</a></span> | <span class="t">that we can tune as a hyperparameter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1348" target="_blank">00:22:28.700</a></span> | <span class="t">but we want to stick with the UTF-8 encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1351" target="_blank">00:22:31.700</a></span> | <span class="t">of these strings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1352" target="_blank">00:22:32.800</a></span> | <span class="t">So what do we do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1354" target="_blank">00:22:34.340</a></span> | <span class="t">Well, the answer, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1355" target="_blank">00:22:35.180</a></span> | <span class="t">is we turn to the byte-pair encoding algorithm,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1357" target="_blank">00:22:37.420</a></span> | <span class="t">which will allow us to compress these byte sequences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1361" target="_blank">00:22:41.220</a></span> | <span class="t">to a variable amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1362" target="_blank">00:22:42.720</a></span> | <span class="t">So we'll get to that in a bit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1363" target="_blank">00:22:43.780</a></span> | <span class="t">but I just want to briefly speak to the fact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1366" target="_blank">00:22:46.300</a></span> | <span class="t">that I would love nothing more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1368" target="_blank">00:22:48.740</a></span> | <span class="t">than to be able to feed raw byte sequences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1371" target="_blank">00:22:51.540</a></span> | <span class="t">into language models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1374" target="_blank">00:22:54.100</a></span> | <span class="t">In fact, there's a paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1374" target="_blank">00:22:54.900</a></span> | <span class="t">about how this could potentially be done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1377" target="_blank">00:22:57.280</a></span> | <span class="t">from somewhere last year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1379" target="_blank">00:22:59.020</a></span> | <span class="t">Now, the problem is you actually have to go in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1381" target="_blank">00:23:01.060</a></span> | <span class="t">and you have to modify the transformer architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1383" target="_blank">00:23:03.180</a></span> | <span class="t">because, as I mentioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1384" target="_blank">00:23:04.580</a></span> | <span class="t">you're going to have a problem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1386" target="_blank">00:23:06.020</a></span> | <span class="t">where the attention will start to become extremely expensive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1388" target="_blank">00:23:08.740</a></span> | <span class="t">because the sequences are so long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1391" target="_blank">00:23:11.380</a></span> | <span class="t">And so in this paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1392" target="_blank">00:23:12.780</a></span> | <span class="t">they propose kind of a hierarchical structuring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1395" target="_blank">00:23:15.740</a></span> | <span class="t">of the transformer that could allow you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1397" target="_blank">00:23:17.540</a></span> | <span class="t">to just feed in raw bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1399" target="_blank">00:23:19.660</a></span> | <span class="t">And so at the end, they say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1400" target="_blank">00:23:20.980</a></span> | <span class="t">"Together, these results establish the viability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1402" target="_blank">00:23:22.900</a></span> | <span class="t">of tokenization-free autoregressive sequence modeling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1405" target="_blank">00:23:25.380</a></span> | <span class="t">at scale."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1406" target="_blank">00:23:26.300</a></span> | <span class="t">So tokenization-free would indeed be amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1408" target="_blank">00:23:28.680</a></span> | <span class="t">We would just feed byte streams directly into our models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1412" target="_blank">00:23:32.180</a></span> | <span class="t">but unfortunately, I don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1413" target="_blank">00:23:33.260</a></span> | <span class="t">that this has really been proven out yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1415" target="_blank">00:23:35.580</a></span> | <span class="t">by sufficiently many groups and at sufficient scale,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1418" target="_blank">00:23:38.580</a></span> | <span class="t">but something like this at one point would be amazing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1420" target="_blank">00:23:40.540</a></span> | <span class="t">and I hope someone comes up with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1422" target="_blank">00:23:42.020</a></span> | <span class="t">But for now, we have to come back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1424" target="_blank">00:23:44.020</a></span> | <span class="t">and we can't feed this directly into language models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1426" target="_blank">00:23:46.500</a></span> | <span class="t">and we have to compress it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1427" target="_blank">00:23:47.740</a></span> | <span class="t">using the byte-pair encoding algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1429" target="_blank">00:23:49.480</a></span> | <span class="t">So let's see how that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1430" target="_blank">00:23:50.620</a></span> | <span class="t">So as I mentioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1431" target="_blank">00:23:51.460</a></span> | <span class="t">the byte-pair encoding algorithm is not all that complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1434" target="_blank">00:23:54.460</a></span> | <span class="t">and the Wikipedia page is actually quite instructive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1436" target="_blank">00:23:56.500</a></span> | <span class="t">as far as the basic idea goes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1438" target="_blank">00:23:58.980</a></span> | <span class="t">What we're doing is we have some kind of a input sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1441" target="_blank">00:24:01.780</a></span> | <span class="t">Like, for example, here we have only four elements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1444" target="_blank">00:24:04.100</a></span> | <span class="t">in our vocabulary, A, B, C, and D,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1446" target="_blank">00:24:06.420</a></span> | <span class="t">and we have a sequence of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1447" target="_blank">00:24:07.920</a></span> | <span class="t">So instead of bytes, let's say we just had four,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1450" target="_blank">00:24:10.460</a></span> | <span class="t">a vocab size of four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1451" target="_blank">00:24:11.740</a></span> | <span class="t">The sequence is too long and we'd like to compress it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1455" target="_blank">00:24:15.380</a></span> | <span class="t">So what we do is that we iteratively find the pair of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1460" target="_blank">00:24:20.380</a></span> | <span class="t">that occur the most frequently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1464" target="_blank">00:24:24.360</a></span> | <span class="t">And then once we've identified that pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1467" target="_blank">00:24:27.060</a></span> | <span class="t">we replace that pair with just a single new token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1470" target="_blank">00:24:30.900</a></span> | <span class="t">that we append to our vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1473" target="_blank">00:24:33.380</a></span> | <span class="t">So for example, here, the byte-pair AA occurs most often,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1477" target="_blank">00:24:37.320</a></span> | <span class="t">so we mint a new token, let's call it capital Z,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1480" target="_blank">00:24:40.740</a></span> | <span class="t">and we replace every single occurrence of AA by Z.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1484" target="_blank">00:24:44.800</a></span> | <span class="t">So now we have two Zs here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1487" target="_blank">00:24:47.920</a></span> | <span class="t">So here we took a sequence of 11 characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1491" target="_blank">00:24:51.540</a></span> | <span class="t">with vocabulary size four,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1493" target="_blank">00:24:53.740</a></span> | <span class="t">and we've converted it to a sequence of only nine tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1498" target="_blank">00:24:58.740</a></span> | <span class="t">but now with a vocabulary of five,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1500" target="_blank">00:25:00.600</a></span> | <span class="t">because we have a fifth vocabulary element</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1502" target="_blank">00:25:02.780</a></span> | <span class="t">that we just created, and it's Z,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1505" target="_blank">00:25:05.000</a></span> | <span class="t">standing for concatenation of AA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1507" target="_blank">00:25:07.300</a></span> | <span class="t">And we can, again, repeat this process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1509" target="_blank">00:25:09.660</a></span> | <span class="t">So we, again, look at the sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1511" target="_blank">00:25:11.980</a></span> | <span class="t">and identify the pair of tokens that are most frequent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1516" target="_blank">00:25:16.680</a></span> | <span class="t">Let's say that that is now AB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1519" target="_blank">00:25:19.140</a></span> | <span class="t">Well, we are going to replace AB with a new token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1521" target="_blank">00:25:21.340</a></span> | <span class="t">that we mint, called Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1523" target="_blank">00:25:23.460</a></span> | <span class="t">So Y becomes AB, and then every single occurrence of AB</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1526" target="_blank">00:25:26.220</a></span> | <span class="t">is now replaced with Y, so we end up with this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1529" target="_blank">00:25:29.780</a></span> | <span class="t">So now we only have one, two, three, four, five, six,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1533" target="_blank">00:25:33.860</a></span> | <span class="t">seven characters in our sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1536" target="_blank">00:25:36.100</a></span> | <span class="t">but we have not just four vocabulary elements or five,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1541" target="_blank">00:25:41.100</a></span> | <span class="t">but now we have six.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1543" target="_blank">00:25:43.620</a></span> | <span class="t">And for the final round, we, again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1546" target="_blank">00:25:46.220</a></span> | <span class="t">look through the sequence, find that the phrase ZY,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1549" target="_blank">00:25:49.600</a></span> | <span class="t">or the pair ZY is most common,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1551" target="_blank">00:25:51.540</a></span> | <span class="t">and replace it one more time with another character,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1555" target="_blank">00:25:55.500</a></span> | <span class="t">let's say X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1556" target="_blank">00:25:56.580</a></span> | <span class="t">So X is ZY, and we replace all occurrences of ZY,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1559" target="_blank">00:25:59.980</a></span> | <span class="t">and we get this following sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1562" target="_blank">00:26:02.020</a></span> | <span class="t">So basically, after we have gone through this process,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1564" target="_blank">00:26:04.840</a></span> | <span class="t">instead of having a sequence of 11 tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1569" target="_blank">00:26:09.840</a></span> | <span class="t">with a vocabulary length of four,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1574" target="_blank">00:26:14.680</a></span> | <span class="t">we now have a sequence of one, two, three, four, five tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1579" target="_blank">00:26:19.680</a></span> | <span class="t">but our vocabulary length now is seven.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1583" target="_blank">00:26:23.260</a></span> | <span class="t">And so in this way, we can iteratively compress our sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1587" target="_blank">00:26:27.580</a></span> | <span class="t">as we mint new tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1589" target="_blank">00:26:29.560</a></span> | <span class="t">So in the exact same way, we start out with byte sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1594" target="_blank">00:26:34.320</a></span> | <span class="t">So we have 256 vocabulary size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1597" target="_blank">00:26:37.520</a></span> | <span class="t">but we're now going to go through these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1598" target="_blank">00:26:38.980</a></span> | <span class="t">and find the byte pairs that occur the most.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1602" target="_blank">00:26:42.160</a></span> | <span class="t">And we're going to iteratively start minting new tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1604" target="_blank">00:26:44.920</a></span> | <span class="t">appending them to our vocabulary, and replacing things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1608" target="_blank">00:26:48.160</a></span> | <span class="t">And in this way, we're going to end up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1609" target="_blank">00:26:49.480</a></span> | <span class="t">with a compressed training dataset,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1611" target="_blank">00:26:51.580</a></span> | <span class="t">and also an algorithm for taking any arbitrary sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1614" target="_blank">00:26:54.920</a></span> | <span class="t">and encoding it using this vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1618" target="_blank">00:26:58.240</a></span> | <span class="t">and also decoding it back to strings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1620" target="_blank">00:27:00.720</a></span> | <span class="t">So let's now implement all that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1622" target="_blank">00:27:02.920</a></span> | <span class="t">So here's what I did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1624" target="_blank">00:27:04.280</a></span> | <span class="t">I went to this blog post that I enjoyed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1626" target="_blank">00:27:06.640</a></span> | <span class="t">and I took the first paragraph,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1627" target="_blank">00:27:07.960</a></span> | <span class="t">and I copy pasted it here into text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1630" target="_blank">00:27:10.840</a></span> | <span class="t">So this is one very long line here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1633" target="_blank">00:27:13.040</a></span> | <span class="t">Now, to get the tokens, as I mentioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1636" target="_blank">00:27:16.360</a></span> | <span class="t">we just take our text and we encode it into UTF-8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1639" target="_blank">00:27:19.360</a></span> | <span class="t">The tokens here at this point will be a raw bytes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1642" target="_blank">00:27:22.520</a></span> | <span class="t">single stream of bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1644" target="_blank">00:27:24.700</a></span> | <span class="t">And just so that it's easier to work with,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1646" target="_blank">00:27:26.760</a></span> | <span class="t">instead of just a bytes object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1648" target="_blank">00:27:28.800</a></span> | <span class="t">I'm going to convert all those bytes to integers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1652" target="_blank">00:27:32.000</a></span> | <span class="t">and then create a list of it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1653" target="_blank">00:27:33.420</a></span> | <span class="t">just so it's easier for us to manipulate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1655" target="_blank">00:27:35.040</a></span> | <span class="t">and work with in Python and visualize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1657" target="_blank">00:27:37.200</a></span> | <span class="t">And here I'm printing all of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1658" target="_blank">00:27:38.360</a></span> | <span class="t">So this is the original paragraph,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1663" target="_blank">00:27:43.360</a></span> | <span class="t">and its length is 533 code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1668" target="_blank">00:27:48.720</a></span> | <span class="t">And then here are the bytes encoded in UTF-8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1672" target="_blank">00:27:52.800</a></span> | <span class="t">And we see that this has a length of 616 bytes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1676" target="_blank">00:27:56.180</a></span> | <span class="t">at this point, or 616 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1678" target="_blank">00:27:58.360</a></span> | <span class="t">And the reason this is more,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1679" target="_blank">00:27:59.800</a></span> | <span class="t">is because a lot of these simple ASCII characters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1683" target="_blank">00:28:03.240</a></span> | <span class="t">or simple characters, they just become a single byte.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1686" target="_blank">00:28:06.200</a></span> | <span class="t">But a lot of these Unicode, more complex characters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1688" target="_blank">00:28:08.840</a></span> | <span class="t">become multiple bytes, up to four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1690" target="_blank">00:28:10.720</a></span> | <span class="t">And so we are expanding that size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1692" target="_blank">00:28:12.760</a></span> | <span class="t">So now what we'd like to do as a first step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1695" target="_blank">00:28:15.220</a></span> | <span class="t">of the algorithm, is we'd like to iterate over here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1697" target="_blank">00:28:17.700</a></span> | <span class="t">and find the pair of bytes that occur most frequently,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1702" target="_blank">00:28:22.040</a></span> | <span class="t">because we're then going to merge it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1703" target="_blank">00:28:23.840</a></span> | <span class="t">So if you are working along on a notebook, on a side,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1706" target="_blank">00:28:26.460</a></span> | <span class="t">then I encourage you to basically click on the link,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1708" target="_blank">00:28:28.740</a></span> | <span class="t">find this notebook,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1709" target="_blank">00:28:29.940</a></span> | <span class="t">and try to write that function yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1711" target="_blank">00:28:31.980</a></span> | <span class="t">Otherwise, I'm going to come here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1712" target="_blank">00:28:32.980</a></span> | <span class="t">and implement first the function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1714" target="_blank">00:28:34.620</a></span> | <span class="t">that finds the most common pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1716" target="_blank">00:28:36.380</a></span> | <span class="t">Okay, so here's what I came up with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1717" target="_blank">00:28:37.740</a></span> | <span class="t">There are many different ways to implement this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1719" target="_blank">00:28:39.860</a></span> | <span class="t">but I'm calling the function getStats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1721" target="_blank">00:28:41.460</a></span> | <span class="t">It expects a list of integers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1723" target="_blank">00:28:43.360</a></span> | <span class="t">I'm using a dictionary to keep track</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1725" target="_blank">00:28:45.260</a></span> | <span class="t">of basically the counts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1726" target="_blank">00:28:46.860</a></span> | <span class="t">And then this is a Pythonic way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1728" target="_blank">00:28:48.080</a></span> | <span class="t">to iterate consecutive elements of this list,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1731" target="_blank">00:28:51.300</a></span> | <span class="t">which we covered in a previous video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1733" target="_blank">00:28:53.740</a></span> | <span class="t">And then here, I'm just keeping track</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1735" target="_blank">00:28:55.500</a></span> | <span class="t">of just incrementing by one for all the pairs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1739" target="_blank">00:28:59.340</a></span> | <span class="t">So if I call this on all the tokens here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1741" target="_blank">00:29:01.900</a></span> | <span class="t">then the stats comes out here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1744" target="_blank">00:29:04.240</a></span> | <span class="t">So this is a dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1745" target="_blank">00:29:05.640</a></span> | <span class="t">The keys are these tuples of consecutive elements,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1749" target="_blank">00:29:09.520</a></span> | <span class="t">and this is the count.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1751" target="_blank">00:29:11.160</a></span> | <span class="t">So just to print it in a slightly better way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1754" target="_blank">00:29:14.780</a></span> | <span class="t">this is one way that I like to do that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1757" target="_blank">00:29:17.540</a></span> | <span class="t">where it's a little bit compound here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1760" target="_blank">00:29:20.820</a></span> | <span class="t">so you can pause if you like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1762" target="_blank">00:29:22.200</a></span> | <span class="t">but we iterate all the items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1764" target="_blank">00:29:24.460</a></span> | <span class="t">The items called on dictionary returns pairs of key value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1769" target="_blank">00:29:29.060</a></span> | <span class="t">And instead, I create a list here of value key,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1774" target="_blank">00:29:34.060</a></span> | <span class="t">because if it's a value key list,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1776" target="_blank">00:29:36.260</a></span> | <span class="t">then I can call sort on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1778" target="_blank">00:29:38.020</a></span> | <span class="t">And by default, Python will use the first element,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1782" target="_blank">00:29:42.780</a></span> | <span class="t">which in this case will be value,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1784" target="_blank">00:29:44.100</a></span> | <span class="t">to sort by if it's given tuples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1786" target="_blank">00:29:46.420</a></span> | <span class="t">And then reverse, so it's descending, and print that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1789" target="_blank">00:29:49.220</a></span> | <span class="t">So basically, it looks like 101,32</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1792" target="_blank">00:29:52.640</a></span> | <span class="t">was the most commonly occurring consecutive pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1795" target="_blank">00:29:55.580</a></span> | <span class="t">and it occurred 20 times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1797" target="_blank">00:29:57.480</a></span> | <span class="t">We can double check that that makes reasonable sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1800" target="_blank">00:30:00.200</a></span> | <span class="t">So if I just search 101,32,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1803" target="_blank">00:30:03.160</a></span> | <span class="t">then you see that these are the 20 occurrences of that pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1807" target="_blank">00:30:07.360</a></span> | <span class="t">And if we'd like to take a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1810" target="_blank">00:30:10.800</a></span> | <span class="t">at what exactly that pair is, we can use char,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1813" target="_blank">00:30:13.920</a></span> | <span class="t">which is the opposite of ord in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1816" target="_blank">00:30:16.320</a></span> | <span class="t">So we give it a Unicode code point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1819" target="_blank">00:30:19.200</a></span> | <span class="t">So 101, and of 32, and we see that this is E and space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1824" target="_blank">00:30:24.200</a></span> | <span class="t">So basically, there's a lot of E space here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1828" target="_blank">00:30:28.220</a></span> | <span class="t">meaning that a lot of these words seem to end with E.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1830" target="_blank">00:30:30.700</a></span> | <span class="t">So here's E space as an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1833" target="_blank">00:30:33.240</a></span> | <span class="t">So there's a lot of that going on here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1834" target="_blank">00:30:34.560</a></span> | <span class="t">and this is the most common pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1836" target="_blank">00:30:36.840</a></span> | <span class="t">So now that we've identified the most common pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1839" target="_blank">00:30:39.140</a></span> | <span class="t">we would like to iterate over the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1841" target="_blank">00:30:41.980</a></span> | <span class="t">We're going to mint a new token with the ID of 256, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1846" target="_blank">00:30:46.340</a></span> | <span class="t">Because these tokens currently go from zero to 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1849" target="_blank">00:30:49.740</a></span> | <span class="t">So when we create a new token, it will have an ID of 256,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1853" target="_blank">00:30:53.780</a></span> | <span class="t">and we're going to iterate over this entire list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1858" target="_blank">00:30:58.460</a></span> | <span class="t">And every time we see 101,32,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1862" target="_blank">00:31:02.060</a></span> | <span class="t">we're gonna swap that out for 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1864" target="_blank">00:31:04.900</a></span> | <span class="t">So let's implement that now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1867" target="_blank">00:31:07.020</a></span> | <span class="t">and feel free to do that yourself as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1869" target="_blank">00:31:09.840</a></span> | <span class="t">So first, I commented this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1871" target="_blank">00:31:11.620</a></span> | <span class="t">just so we don't pollute the notebook too much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1874" target="_blank">00:31:14.920</a></span> | <span class="t">This is a nice way of, in Python,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1878" target="_blank">00:31:18.000</a></span> | <span class="t">obtaining the highest ranking pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1880" target="_blank">00:31:20.440</a></span> | <span class="t">So we're basically calling the max on this dictionary stats,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1885" target="_blank">00:31:25.000</a></span> | <span class="t">and this will return the maximum key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1888" target="_blank">00:31:28.640</a></span> | <span class="t">And then the question is, how does it rank keys?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1891" target="_blank">00:31:31.760</a></span> | <span class="t">So you can provide it with a function that ranks keys,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1894" target="_blank">00:31:34.860</a></span> | <span class="t">and that function is just stats.get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1897" target="_blank">00:31:37.740</a></span> | <span class="t">Stats.get would basically return the value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1901" target="_blank">00:31:41.120</a></span> | <span class="t">And so we're ranking by the value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1902" target="_blank">00:31:42.760</a></span> | <span class="t">and getting the maximum key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1904" target="_blank">00:31:44.480</a></span> | <span class="t">So it's 101,32, as we saw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1907" target="_blank">00:31:47.520</a></span> | <span class="t">Now, to actually merge 101,32,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1909" target="_blank">00:31:49.860</a></span> | <span class="t">this is the function that I wrote,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1912" target="_blank">00:31:52.240</a></span> | <span class="t">but again, there are many different versions of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1914" target="_blank">00:31:54.840</a></span> | <span class="t">So we're gonna take a list of IDs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1916" target="_blank">00:31:56.920</a></span> | <span class="t">and the pair that we wanna replace,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1918" target="_blank">00:31:58.900</a></span> | <span class="t">and that pair will be replaced with the new index IDX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1922" target="_blank">00:32:02.300</a></span> | <span class="t">So iterating through IDs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1925" target="_blank">00:32:05.020</a></span> | <span class="t">if we find the pair, swap it out for IDX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1928" target="_blank">00:32:08.240</a></span> | <span class="t">So we create this new list, and then we start at zero,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1931" target="_blank">00:32:11.680</a></span> | <span class="t">and then we go through this entire list sequentially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1933" target="_blank">00:32:13.880</a></span> | <span class="t">from left to right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1934" target="_blank">00:32:14.840</a></span> | <span class="t">And here we are checking for equality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1938" target="_blank">00:32:18.040</a></span> | <span class="t">at the current position with the pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1940" target="_blank">00:32:20.440</a></span> | <span class="t">So here we are checking that the pair matches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1944" target="_blank">00:32:24.660</a></span> | <span class="t">Now, here's a bit of a tricky condition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1946" target="_blank">00:32:26.360</a></span> | <span class="t">that you have to append if you're trying to be careful,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1948" target="_blank">00:32:28.680</a></span> | <span class="t">and that is that you don't want this here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1951" target="_blank">00:32:31.700</a></span> | <span class="t">to be out of bounds at the very last position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1954" target="_blank">00:32:34.320</a></span> | <span class="t">when you're on the rightmost element of this list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1956" target="_blank">00:32:36.660</a></span> | <span class="t">Otherwise, this would give you an out-of-bounds error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1959" target="_blank">00:32:39.400</a></span> | <span class="t">So we have to make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1960" target="_blank">00:32:40.240</a></span> | <span class="t">that we're not at the very, very last element.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1962" target="_blank">00:32:42.800</a></span> | <span class="t">So this would be false for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1965" target="_blank">00:32:45.840</a></span> | <span class="t">So if we find a match,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1967" target="_blank">00:32:47.480</a></span> | <span class="t">we append to this new list that replacement index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1972" target="_blank">00:32:52.480</a></span> | <span class="t">and we increment the position by two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1974" target="_blank">00:32:54.080</a></span> | <span class="t">So we skip over that entire pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1976" target="_blank">00:32:56.440</a></span> | <span class="t">But otherwise, if we haven't found a matching pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1978" target="_blank">00:32:58.880</a></span> | <span class="t">we just sort of copy over the element at that position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1982" target="_blank">00:33:02.720</a></span> | <span class="t">and increment by one, and then return this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1986" target="_blank">00:33:06.360</a></span> | <span class="t">So here's a very small toy example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1987" target="_blank">00:33:07.840</a></span> | <span class="t">If we have a list 5, 6, 6, 7, 9, 1,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1990" target="_blank">00:33:10.300</a></span> | <span class="t">and we want to replace the occurrences of 67 with 99,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1993" target="_blank">00:33:13.620</a></span> | <span class="t">then calling this on that will give us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1997" target="_blank">00:33:17.320</a></span> | <span class="t">what we're asking for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=1998" target="_blank">00:33:18.600</a></span> | <span class="t">So here, the 67 is replaced with 99.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2001" target="_blank">00:33:21.360</a></span> | <span class="t">So now I'm going to uncomment this for our actual use case,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2006" target="_blank">00:33:26.240</a></span> | <span class="t">where we want to take our tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2008" target="_blank">00:33:28.520</a></span> | <span class="t">We want to take the top pair here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2011" target="_blank">00:33:31.040</a></span> | <span class="t">and replace it with 256 to get tokens two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2014" target="_blank">00:33:34.120</a></span> | <span class="t">If we run this, we get the following.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2018" target="_blank">00:33:38.240</a></span> | <span class="t">So recall that previously, we had a length 616 in this list,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2023" target="_blank">00:33:43.240</a></span> | <span class="t">and now we have a length 596, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2027" target="_blank">00:33:47.560</a></span> | <span class="t">So this decreased by 20,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2029" target="_blank">00:33:49.620</a></span> | <span class="t">which makes sense because there are 20 occurrences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2032" target="_blank">00:33:52.420</a></span> | <span class="t">Moreover, we can try to find 256 here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2035" target="_blank">00:33:55.500</a></span> | <span class="t">and we see plenty of occurrences off it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2037" target="_blank">00:33:57.600</a></span> | <span class="t">And moreover, just double check,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2039" target="_blank">00:33:59.760</a></span> | <span class="t">there should be no occurrence of 101, 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2042" target="_blank">00:34:02.320</a></span> | <span class="t">So this is the original array, plenty of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2044" target="_blank">00:34:04.980</a></span> | <span class="t">And in the second array, there are no occurrences of 101, 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2048" target="_blank">00:34:08.320</a></span> | <span class="t">So we've successfully merged this single pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2051" target="_blank">00:34:11.480</a></span> | <span class="t">And now we just iterate this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2053" target="_blank">00:34:13.320</a></span> | <span class="t">So we are going to go over the sequence again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2055" target="_blank">00:34:15.420</a></span> | <span class="t">find the most common pair, and replace it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2057" target="_blank">00:34:17.740</a></span> | <span class="t">So let me now write a while loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2059" target="_blank">00:34:19.140</a></span> | <span class="t">that uses these functions to do this sort of iteratively.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2062" target="_blank">00:34:22.820</a></span> | <span class="t">And how many times do we do it for?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2065" target="_blank">00:34:25.160</a></span> | <span class="t">Well, that's totally up to us as a hyperparameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2067" target="_blank">00:34:27.460</a></span> | <span class="t">The more steps we take, the larger will be our vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2072" target="_blank">00:34:32.420</a></span> | <span class="t">and the shorter will be our sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2074" target="_blank">00:34:34.500</a></span> | <span class="t">And there is some sweet spot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2075" target="_blank">00:34:35.940</a></span> | <span class="t">that we usually find works the best in practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2078" target="_blank">00:34:38.780</a></span> | <span class="t">And so this is kind of a hyperparameter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2080" target="_blank">00:34:40.900</a></span> | <span class="t">and we tune it, and we find good vocabulary sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2084" target="_blank">00:34:44.020</a></span> | <span class="t">As an example, GPT-4 currently uses roughly 100,000 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2087" target="_blank">00:34:47.780</a></span> | <span class="t">And ballpark, those are reasonable numbers currently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2091" target="_blank">00:34:51.580</a></span> | <span class="t">in state-of-the-art large-language models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2093" target="_blank">00:34:53.500</a></span> | <span class="t">So let me now write, putting it all together,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2096" target="_blank">00:34:56.580</a></span> | <span class="t">and iterating these steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2098" target="_blank">00:34:58.720</a></span> | <span class="t">Okay, now, before we dive into the while loop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2100" target="_blank">00:35:00.500</a></span> | <span class="t">I wanted to add one more cell here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2103" target="_blank">00:35:03.160</a></span> | <span class="t">where I went to the blog post,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2104" target="_blank">00:35:04.540</a></span> | <span class="t">and instead of grabbing just the first paragraph or two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2107" target="_blank">00:35:07.100</a></span> | <span class="t">I took the entire blog post,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2108" target="_blank">00:35:08.700</a></span> | <span class="t">and I stretched it out in a single line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2110" target="_blank">00:35:10.780</a></span> | <span class="t">And basically, just using longer text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2112" target="_blank">00:35:12.460</a></span> | <span class="t">will allow us to have more representative statistics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2114" target="_blank">00:35:14.700</a></span> | <span class="t">for the byte pairs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2115" target="_blank">00:35:15.920</a></span> | <span class="t">and we'll just get more sensible results out of it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2118" target="_blank">00:35:18.940</a></span> | <span class="t">because it's longer text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2120" target="_blank">00:35:20.280</a></span> | <span class="t">So here we have the raw text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2123" target="_blank">00:35:23.180</a></span> | <span class="t">We encode it into bytes using the UTF-8 encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2127" target="_blank">00:35:27.660</a></span> | <span class="t">And then here, as before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2129" target="_blank">00:35:29.140</a></span> | <span class="t">we are just changing it into a list of integers in Python,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2132" target="_blank">00:35:32.240</a></span> | <span class="t">just so it's easier to work with,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2134" target="_blank">00:35:34.060</a></span> | <span class="t">instead of the raw bytes objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2136" target="_blank">00:35:36.380</a></span> | <span class="t">And then this is the code that I came up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2140" target="_blank">00:35:40.220</a></span> | <span class="t">to actually do the merging in loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2143" target="_blank">00:35:43.860</a></span> | <span class="t">These two functions here are identical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2145" target="_blank">00:35:45.700</a></span> | <span class="t">to what we had above.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2146" target="_blank">00:35:46.740</a></span> | <span class="t">I only included them here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2148" target="_blank">00:35:48.100</a></span> | <span class="t">just so that you have the point of reference here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2150" target="_blank">00:35:50.760</a></span> | <span class="t">So these two are identical,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2154" target="_blank">00:35:54.020</a></span> | <span class="t">and then this is the new code that I added.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2156" target="_blank">00:35:56.540</a></span> | <span class="t">So the first thing we wanna do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2157" target="_blank">00:35:57.380</a></span> | <span class="t">is we want to decide on a final vocabulary size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2160" target="_blank">00:36:00.180</a></span> | <span class="t">that we want our tokenizer to have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2162" target="_blank">00:36:02.480</a></span> | <span class="t">And as I mentioned, this is a hyperparameter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2164" target="_blank">00:36:04.040</a></span> | <span class="t">and you set it in some way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2165" target="_blank">00:36:05.280</a></span> | <span class="t">depending on your best performance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2167" target="_blank">00:36:07.520</a></span> | <span class="t">So let's say for us, we're going to use 276,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2170" target="_blank">00:36:10.140</a></span> | <span class="t">because that way we're going to be doing exactly 20 merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2174" target="_blank">00:36:14.000</a></span> | <span class="t">And 20 merges because we already have 256 tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2178" target="_blank">00:36:18.420</a></span> | <span class="t">for the raw bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2180" target="_blank">00:36:20.280</a></span> | <span class="t">And to reach 276, we have to do 20 merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2183" target="_blank">00:36:23.600</a></span> | <span class="t">to add 20 new tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2185" target="_blank">00:36:25.160</a></span> | <span class="t">Here, this is one way in Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2188" target="_blank">00:36:28.680</a></span> | <span class="t">to just create a copy of a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2190" target="_blank">00:36:30.760</a></span> | <span class="t">So I'm taking the tokens list,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2193" target="_blank">00:36:33.260</a></span> | <span class="t">and by wrapping it in the list,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2194" target="_blank">00:36:34.940</a></span> | <span class="t">Python will construct a new list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2196" target="_blank">00:36:36.940</a></span> | <span class="t">of all the individual elements,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2198" target="_blank">00:36:38.100</a></span> | <span class="t">so this is just a copy operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2199" target="_blank">00:36:39.740</a></span> | <span class="t">Then here, I'm creating a merges dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2204" target="_blank">00:36:44.340</a></span> | <span class="t">So this merges dictionary is going to maintain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2206" target="_blank">00:36:46.140</a></span> | <span class="t">basically the child one, child two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2209" target="_blank">00:36:49.420</a></span> | <span class="t">mapping to a new token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2212" target="_blank">00:36:52.300</a></span> | <span class="t">And so what we're going to be building up here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2213" target="_blank">00:36:53.740</a></span> | <span class="t">is a binary tree of merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2216" target="_blank">00:36:56.500</a></span> | <span class="t">But actually, it's not exactly a tree</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2217" target="_blank">00:36:57.860</a></span> | <span class="t">because a tree would have a single root node</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2220" target="_blank">00:37:00.500</a></span> | <span class="t">with a bunch of leaves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2222" target="_blank">00:37:02.220</a></span> | <span class="t">For us, we're starting with the leaves on the bottom,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2224" target="_blank">00:37:04.620</a></span> | <span class="t">which are the individual bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2226" target="_blank">00:37:06.060</a></span> | <span class="t">Those are the starting 256 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2228" target="_blank">00:37:08.580</a></span> | <span class="t">And then we're starting to merge two of them at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2231" target="_blank">00:37:11.380</a></span> | <span class="t">And so it's not a tree, it's more like a forest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2233" target="_blank">00:37:13.740</a></span> | <span class="t">as we merge these elements.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2238" target="_blank">00:37:18.360</a></span> | <span class="t">So for 20 merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2241" target="_blank">00:37:21.540</a></span> | <span class="t">we're going to find the most commonly occurring pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2244" target="_blank">00:37:24.840</a></span> | <span class="t">We're going to mint a new token integer for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2247" target="_blank">00:37:27.940</a></span> | <span class="t">So I here will start at zero,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2249" target="_blank">00:37:29.460</a></span> | <span class="t">so we're going to start at 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2251" target="_blank">00:37:31.940</a></span> | <span class="t">We're going to print that we're merging it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2253" target="_blank">00:37:33.620</a></span> | <span class="t">and we're going to replace all the occurrences of that pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2256" target="_blank">00:37:36.660</a></span> | <span class="t">with the newly minted token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2259" target="_blank">00:37:39.520</a></span> | <span class="t">And we're going to record that this pair of integers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2262" target="_blank">00:37:42.980</a></span> | <span class="t">merged into this new integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2265" target="_blank">00:37:45.460</a></span> | <span class="t">So running this gives us the following output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2269" target="_blank">00:37:49.940</a></span> | <span class="t">So we did 20 merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2274" target="_blank">00:37:54.160</a></span> | <span class="t">And for example, the first merge was exactly as before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2277" target="_blank">00:37:57.500</a></span> | <span class="t">the 101, 32 tokens merging into a new token 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2282" target="_blank">00:38:02.500</a></span> | <span class="t">Now keep in mind that the individual tokens 101 and 32</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2286" target="_blank">00:38:06.440</a></span> | <span class="t">can still occur in the sequence after merging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2289" target="_blank">00:38:09.220</a></span> | <span class="t">It's only when they occur exactly consecutively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2291" target="_blank">00:38:11.800</a></span> | <span class="t">that that becomes 256 now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2293" target="_blank">00:38:13.680</a></span> | <span class="t">And in particular, the other thing to notice here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2297" target="_blank">00:38:17.620</a></span> | <span class="t">is that the token 256, which is the newly minted token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2300" target="_blank">00:38:20.920</a></span> | <span class="t">is also eligible for merging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2302" target="_blank">00:38:22.860</a></span> | <span class="t">So here on the bottom, the 20th merge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2304" target="_blank">00:38:24.980</a></span> | <span class="t">was a merge of 256 and 259 becoming 275.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2309" target="_blank">00:38:29.780</a></span> | <span class="t">So every time we replace these tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2312" target="_blank">00:38:32.180</a></span> | <span class="t">they become eligible for merging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2313" target="_blank">00:38:33.700</a></span> | <span class="t">in the next round of the iteration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2315" target="_blank">00:38:35.820</a></span> | <span class="t">So that's why we're building up a small sort of binary forest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2318" target="_blank">00:38:38.440</a></span> | <span class="t">instead of a single individual tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2320" target="_blank">00:38:40.240</a></span> | <span class="t">One thing we can take a look at as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2323" target="_blank">00:38:43.020</a></span> | <span class="t">is we can take a look at the compression ratio</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2324" target="_blank">00:38:44.740</a></span> | <span class="t">that we've achieved.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2326" target="_blank">00:38:46.100</a></span> | <span class="t">So in particular, we started off with this tokens list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2330" target="_blank">00:38:50.220</a></span> | <span class="t">So we started off with 24,000 bytes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2333" target="_blank">00:38:53.460</a></span> | <span class="t">and after merging 20 times,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2336" target="_blank">00:38:56.500</a></span> | <span class="t">we now have only 19,000 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2341" target="_blank">00:39:01.220</a></span> | <span class="t">And so therefore, the compression ratio</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2342" target="_blank">00:39:02.660</a></span> | <span class="t">of simply just dividing the two is roughly 1.27.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2346" target="_blank">00:39:06.220</a></span> | <span class="t">So that's the amount of compression we were able to achieve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2348" target="_blank">00:39:08.380</a></span> | <span class="t">of this text with only 20 merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2351" target="_blank">00:39:11.100</a></span> | <span class="t">And of course, the more vocabulary elements you add,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2355" target="_blank">00:39:15.380</a></span> | <span class="t">the greater the compression ratio here would be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2358" target="_blank">00:39:18.780</a></span> | <span class="t">Finally, so that's kind of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2362" target="_blank">00:39:22.120</a></span> | <span class="t">the training of the tokenizer, if you will.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2365" target="_blank">00:39:25.780</a></span> | <span class="t">Now, one point that I wanted to make is that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2368" target="_blank">00:39:28.340</a></span> | <span class="t">and maybe this is a diagram that can help kind of illustrate,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2372" target="_blank">00:39:32.300</a></span> | <span class="t">is that tokenizer is a completely separate object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2374" target="_blank">00:39:34.780</a></span> | <span class="t">from the large language model itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2376" target="_blank">00:39:36.780</a></span> | <span class="t">So everything in this lecture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2377" target="_blank">00:39:37.920</a></span> | <span class="t">we're not really touching the LLM itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2380" target="_blank">00:39:40.060</a></span> | <span class="t">We're just training the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2381" target="_blank">00:39:41.660</a></span> | <span class="t">This is a completely separate pre-processing stage usually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2384" target="_blank">00:39:44.820</a></span> | <span class="t">So the tokenizer will have its own training set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2387" target="_blank">00:39:47.440</a></span> | <span class="t">just like a large language model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2388" target="_blank">00:39:48.660</a></span> | <span class="t">has a potentially different training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2391" target="_blank">00:39:51.540</a></span> | <span class="t">So the tokenizer has a training set of documents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2393" target="_blank">00:39:53.300</a></span> | <span class="t">on which you're going to train the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2395" target="_blank">00:39:55.740</a></span> | <span class="t">And then we're performing the BytePair encoding algorithm,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2399" target="_blank">00:39:59.460</a></span> | <span class="t">as we saw above, to train the vocabulary of this tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2403" target="_blank">00:40:03.660</a></span> | <span class="t">So it has its own training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2405" target="_blank">00:40:05.060</a></span> | <span class="t">It has a pre-processing stage</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2406" target="_blank">00:40:06.380</a></span> | <span class="t">that you would run a single time in the beginning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2408" target="_blank">00:40:08.820</a></span> | <span class="t">And the tokenizer is trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2411" target="_blank">00:40:11.740</a></span> | <span class="t">using BytePair encoding algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2413" target="_blank">00:40:13.820</a></span> | <span class="t">Once you have the tokenizer, once it's trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2416" target="_blank">00:40:16.060</a></span> | <span class="t">and you have the vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2417" target="_blank">00:40:17.180</a></span> | <span class="t">and you have the merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2419" target="_blank">00:40:19.200</a></span> | <span class="t">we can do both encoding and decoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2422" target="_blank">00:40:22.300</a></span> | <span class="t">So these two arrows here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2424" target="_blank">00:40:24.340</a></span> | <span class="t">So the tokenizer is a translation layer between raw text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2428" target="_blank">00:40:28.200</a></span> | <span class="t">which is, as we saw, the sequence of Unicode code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2431" target="_blank">00:40:31.840</a></span> | <span class="t">It can take raw text and turn it into a token sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2435" target="_blank">00:40:35.520</a></span> | <span class="t">and vice versa, it can take a token sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2438" target="_blank">00:40:38.080</a></span> | <span class="t">and translate it back into raw text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2440" target="_blank">00:40:40.140</a></span> | <span class="t">So now that we have trained the tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2444" target="_blank">00:40:44.120</a></span> | <span class="t">and we have these merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2445" target="_blank">00:40:45.920</a></span> | <span class="t">we are going to turn to how we can do the encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2448" target="_blank">00:40:48.120</a></span> | <span class="t">and the decoding step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2449" target="_blank">00:40:49.400</a></span> | <span class="t">If you give me text, here are the tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2451" target="_blank">00:40:51.200</a></span> | <span class="t">and vice versa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2452" target="_blank">00:40:52.040</a></span> | <span class="t">If you give me tokens, here's the text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2454" target="_blank">00:40:54.240</a></span> | <span class="t">Once we have that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2455" target="_blank">00:40:55.080</a></span> | <span class="t">we can translate between these two realms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2457" target="_blank">00:40:57.320</a></span> | <span class="t">And then the language model is going to be trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2459" target="_blank">00:40:59.180</a></span> | <span class="t">as a step two afterwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2461" target="_blank">00:41:01.120</a></span> | <span class="t">And typically, in a sort of a state-of-the-art application,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2465" target="_blank">00:41:05.280</a></span> | <span class="t">you might take all of your training data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2466" target="_blank">00:41:06.680</a></span> | <span class="t">for the language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2467" target="_blank">00:41:07.800</a></span> | <span class="t">and you might run it through the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2469" target="_blank">00:41:09.480</a></span> | <span class="t">and sort of translate everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2471" target="_blank">00:41:11.300</a></span> | <span class="t">into a massive token sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2472" target="_blank">00:41:12.920</a></span> | <span class="t">And then you can throw away the raw text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2474" target="_blank">00:41:14.680</a></span> | <span class="t">that you're just left with, the tokens themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2477" target="_blank">00:41:17.040</a></span> | <span class="t">And those are stored on disk,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2479" target="_blank">00:41:19.120</a></span> | <span class="t">and that is what the larger language model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2480" target="_blank">00:41:20.600</a></span> | <span class="t">is actually reading when it's training on them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2482" target="_blank">00:41:22.960</a></span> | <span class="t">So that's one approach that you can take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2484" target="_blank">00:41:24.180</a></span> | <span class="t">as a single massive pre-processing stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2486" target="_blank">00:41:26.840</a></span> | <span class="t">So yeah, basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2490" target="_blank">00:41:30.240</a></span> | <span class="t">I think the most important thing I want to get across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2491" target="_blank">00:41:31.800</a></span> | <span class="t">is that this is a completely separate stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2493" target="_blank">00:41:33.440</a></span> | <span class="t">It usually has its own entire training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2496" target="_blank">00:41:36.360</a></span> | <span class="t">You may want to have those training sets be different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2498" target="_blank">00:41:38.440</a></span> | <span class="t">between the tokenizer and the larger language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2500" target="_blank">00:41:40.720</a></span> | <span class="t">So for example, when you're training the tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2503" target="_blank">00:41:43.160</a></span> | <span class="t">as I mentioned, we don't just care</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2504" target="_blank">00:41:44.680</a></span> | <span class="t">about the performance of English text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2506" target="_blank">00:41:46.400</a></span> | <span class="t">We care about many different languages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2509" target="_blank">00:41:49.480</a></span> | <span class="t">And we also care about code or not code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2511" target="_blank">00:41:51.640</a></span> | <span class="t">So you may want to look into different kinds of mixtures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2514" target="_blank">00:41:54.600</a></span> | <span class="t">of different kinds of languages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2515" target="_blank">00:41:55.960</a></span> | <span class="t">and different amounts of code and things like that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2518" target="_blank">00:41:58.760</a></span> | <span class="t">because the amount of different language that you have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2521" target="_blank">00:42:01.940</a></span> | <span class="t">in your tokenizer training set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2523" target="_blank">00:42:03.720</a></span> | <span class="t">will determine how many merges of it there will be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2527" target="_blank">00:42:07.280</a></span> | <span class="t">And therefore, that determines the density</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2529" target="_blank">00:42:09.420</a></span> | <span class="t">with which this type of data sort of has in the token space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2534" target="_blank">00:42:14.420</a></span> | <span class="t">And so roughly speaking intuitively,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2538" target="_blank">00:42:18.800</a></span> | <span class="t">if you add some amount of data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2540" target="_blank">00:42:20.020</a></span> | <span class="t">like say you have a ton of Japanese data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2541" target="_blank">00:42:21.740</a></span> | <span class="t">in your tokenizer training set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2544" target="_blank">00:42:24.060</a></span> | <span class="t">then that means that more Japanese tokens will get merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2546" target="_blank">00:42:26.840</a></span> | <span class="t">And therefore, Japanese will have shorter sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2549" target="_blank">00:42:29.940</a></span> | <span class="t">And that's going to be beneficial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2551" target="_blank">00:42:31.160</a></span> | <span class="t">for the large language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2552" target="_blank">00:42:32.380</a></span> | <span class="t">which has a finite context length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2554" target="_blank">00:42:34.300</a></span> | <span class="t">on which it can work on in the token space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2557" target="_blank">00:42:37.820</a></span> | <span class="t">So hopefully that makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2559" target="_blank">00:42:39.340</a></span> | <span class="t">So we're now going to turn to encoding and decoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2562" target="_blank">00:42:42.120</a></span> | <span class="t">now that we have trained a tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2564" target="_blank">00:42:44.020</a></span> | <span class="t">So we have our merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2566" target="_blank">00:42:46.160</a></span> | <span class="t">And now how do we do encoding and decoding?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2568" target="_blank">00:42:48.340</a></span> | <span class="t">Okay, so let's begin with decoding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2570" target="_blank">00:42:50.100</a></span> | <span class="t">which is this arrow over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2571" target="_blank">00:42:51.880</a></span> | <span class="t">So given a token sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2573" target="_blank">00:42:53.820</a></span> | <span class="t">let's go through the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2575" target="_blank">00:42:55.020</a></span> | <span class="t">to get back a Python string object, so the raw text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2579" target="_blank">00:42:59.140</a></span> | <span class="t">So this is the function that we'd like to implement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2581" target="_blank">00:43:01.860</a></span> | <span class="t">We're given the list of integers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2583" target="_blank">00:43:03.260</a></span> | <span class="t">and we want to return a Python string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2584" target="_blank">00:43:04.980</a></span> | <span class="t">If you'd like, try to implement this function yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2587" target="_blank">00:43:07.420</a></span> | <span class="t">It's a fun exercise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2588" target="_blank">00:43:08.600</a></span> | <span class="t">Otherwise, I'm going to start pasting in my own solution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2592" target="_blank">00:43:12.260</a></span> | <span class="t">So there are many different ways to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2595" target="_blank">00:43:15.100</a></span> | <span class="t">Here's one way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2596" target="_blank">00:43:16.420</a></span> | <span class="t">I will create a kind of pre-processing variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2599" target="_blank">00:43:19.460</a></span> | <span class="t">that I will call vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2600" target="_blank">00:43:20.780</a></span> | <span class="t">And vocab is a mapping or a dictionary in Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2606" target="_blank">00:43:26.020</a></span> | <span class="t">from the token ID to the bytes object for that token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2611" target="_blank">00:43:31.020</a></span> | <span class="t">So we begin with the raw bytes for tokens from zero to 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2615" target="_blank">00:43:35.900</a></span> | <span class="t">And then we go in order of all the merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2618" target="_blank">00:43:38.760</a></span> | <span class="t">and we sort of populate this vocab list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2621" target="_blank">00:43:41.720</a></span> | <span class="t">by doing an addition here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2623" target="_blank">00:43:43.360</a></span> | <span class="t">So this is basically the bytes representation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2626" target="_blank">00:43:46.840</a></span> | <span class="t">of the first child followed by the second one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2629" target="_blank">00:43:49.920</a></span> | <span class="t">And remember, these are bytes objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2631" target="_blank">00:43:51.760</a></span> | <span class="t">So this addition here is an addition of two bytes objects,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2635" target="_blank">00:43:55.240</a></span> | <span class="t">just concatenation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2637" target="_blank">00:43:57.080</a></span> | <span class="t">So that's what we get here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2638" target="_blank">00:43:58.440</a></span> | <span class="t">One tricky thing to be careful with, by the way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2641" target="_blank">00:44:01.520</a></span> | <span class="t">is that I'm iterating a dictionary in Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2644" target="_blank">00:44:04.320</a></span> | <span class="t">using a .items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2645" target="_blank">00:44:05.920</a></span> | <span class="t">And it really matters that this runs in the order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2649" target="_blank">00:44:09.400</a></span> | <span class="t">in which we inserted items into the merges dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2653" target="_blank">00:44:13.220</a></span> | <span class="t">Luckily, starting with Python 3.7,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2655" target="_blank">00:44:15.100</a></span> | <span class="t">this is guaranteed to be the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2656" target="_blank">00:44:16.640</a></span> | <span class="t">But before Python 3.7,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2658" target="_blank">00:44:18.280</a></span> | <span class="t">this iteration may have been out of order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2660" target="_blank">00:44:20.120</a></span> | <span class="t">with respect to how we inserted elements into merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2662" target="_blank">00:44:22.880</a></span> | <span class="t">and this may not have worked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2664" target="_blank">00:44:24.320</a></span> | <span class="t">But we are using modern Python, so we're okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2667" target="_blank">00:44:27.320</a></span> | <span class="t">And then here, given the IDs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2671" target="_blank">00:44:31.280</a></span> | <span class="t">the first thing we're going to do is get the tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2673" target="_blank">00:44:33.980</a></span> | <span class="t">So the way I implemented this here is I'm taking,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2678" target="_blank">00:44:38.960</a></span> | <span class="t">I'm iterating over all the IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2680" target="_blank">00:44:40.600</a></span> | <span class="t">I'm using vocab to look up their bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2682" target="_blank">00:44:42.880</a></span> | <span class="t">And then here, this is one way in Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2685" target="_blank">00:44:45.000</a></span> | <span class="t">to concatenate all these bytes together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2687" target="_blank">00:44:47.640</a></span> | <span class="t">to create our tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2689" target="_blank">00:44:49.640</a></span> | <span class="t">And then these tokens here at this point are raw bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2693" target="_blank">00:44:53.120</a></span> | <span class="t">So I have to decode using UTF-8 now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2696" target="_blank">00:44:56.800</a></span> | <span class="t">back into Python strings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2699" target="_blank">00:44:59.080</a></span> | <span class="t">So previously, we called dot encode on a string object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2702" target="_blank">00:45:02.020</a></span> | <span class="t">to get the bytes, and now we're doing it opposite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2704" target="_blank">00:45:04.720</a></span> | <span class="t">We're taking the bytes and calling a decode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2707" target="_blank">00:45:07.240</a></span> | <span class="t">on the bytes object to get a string in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2710" target="_blank">00:45:10.880</a></span> | <span class="t">And then we can return text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2712" target="_blank">00:45:12.600</a></span> | <span class="t">So this is how we can do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2716" target="_blank">00:45:16.800</a></span> | <span class="t">Now, this actually has a issue in the way I implemented it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2721" target="_blank">00:45:21.720</a></span> | <span class="t">and this could actually throw an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2723" target="_blank">00:45:23.520</a></span> | <span class="t">So try to figure out why this code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2726" target="_blank">00:45:26.120</a></span> | <span class="t">could actually result in an error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2727" target="_blank">00:45:27.760</a></span> | <span class="t">if we plug in some sequence of IDs that is unlucky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2732" target="_blank">00:45:32.500</a></span> | <span class="t">So let me demonstrate the issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2735" target="_blank">00:45:35.360</a></span> | <span class="t">When I try to decode just something like 97,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2738" target="_blank">00:45:38.160</a></span> | <span class="t">I am going to get a letter A here back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2741" target="_blank">00:45:41.040</a></span> | <span class="t">So nothing too crazy happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2743" target="_blank">00:45:43.560</a></span> | <span class="t">But when I try to decode 128 as a single element,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2748" target="_blank">00:45:48.320</a></span> | <span class="t">the token 128 is what in string or in Python object?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2752" target="_blank">00:45:52.320</a></span> | <span class="t">Unicode decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2754" target="_blank">00:45:54.240</a></span> | <span class="t">UTF-8 can't decode byte 0x80,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2757" target="_blank">00:45:57.840</a></span> | <span class="t">which is this in hex,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2760" target="_blank">00:46:00.040</a></span> | <span class="t">in position zero, invalid start byte.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2761" target="_blank">00:46:01.880</a></span> | <span class="t">What does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2763" target="_blank">00:46:03.120</a></span> | <span class="t">Well, to understand what this means,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2764" target="_blank">00:46:04.040</a></span> | <span class="t">we have to go back to our UTF-8 page</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2766" target="_blank">00:46:06.600</a></span> | <span class="t">that I briefly showed earlier,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2768" target="_blank">00:46:08.560</a></span> | <span class="t">and this is Wikipedia UTF-8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2770" target="_blank">00:46:10.640</a></span> | <span class="t">And basically, there's a specific schema</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2773" target="_blank">00:46:13.140</a></span> | <span class="t">that UTF-8 bytes take.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2776" target="_blank">00:46:16.080</a></span> | <span class="t">So in particular, if you have a multi-byte object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2779" target="_blank">00:46:19.440</a></span> | <span class="t">for some of the Unicode characters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2780" target="_blank">00:46:20.960</a></span> | <span class="t">they have to have this special sort of envelope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2783" target="_blank">00:46:23.160</a></span> | <span class="t">in how the encoding works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2785" target="_blank">00:46:25.800</a></span> | <span class="t">And so what's happening here is that invalid start byte,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2789" target="_blank">00:46:29.800</a></span> | <span class="t">that's because 128, the binary representation of it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2793" target="_blank">00:46:33.640</a></span> | <span class="t">is one followed by all zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2796" target="_blank">00:46:36.280</a></span> | <span class="t">So we have one and then all zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2798" target="_blank">00:46:38.800</a></span> | <span class="t">And we see here that that doesn't conform to the format</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2801" target="_blank">00:46:41.040</a></span> | <span class="t">because one followed by all zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2802" target="_blank">00:46:42.480</a></span> | <span class="t">just doesn't fit any of these rules, so to speak.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2805" target="_blank">00:46:45.660</a></span> | <span class="t">So it's an invalid start byte, which is byte one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2809" target="_blank">00:46:49.240</a></span> | <span class="t">This one must have a one following it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2812" target="_blank">00:46:52.040</a></span> | <span class="t">and then a zero following it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2813" target="_blank">00:46:53.520</a></span> | <span class="t">and then the content of your Unicode in excess here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2817" target="_blank">00:46:57.080</a></span> | <span class="t">So basically, we don't exactly follow the UTF-8 standard,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2820" target="_blank">00:47:00.600</a></span> | <span class="t">and this cannot be decoded.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2822" target="_blank">00:47:02.400</a></span> | <span class="t">And so the way to fix this is to use this errors equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2827" target="_blank">00:47:07.400</a></span> | <span class="t">in bytes.decode function of Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2832" target="_blank">00:47:12.800</a></span> | <span class="t">And by default, errors is strict.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2834" target="_blank">00:47:14.720</a></span> | <span class="t">So we will throw an error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2836" target="_blank">00:47:16.560</a></span> | <span class="t">if it's not valid UTF-8 bytes encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2840" target="_blank">00:47:20.360</a></span> | <span class="t">But there are many different things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2841" target="_blank">00:47:21.640</a></span> | <span class="t">that you could put here on error handling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2843" target="_blank">00:47:23.680</a></span> | <span class="t">This is the full list of all the errors that you can use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2846" target="_blank">00:47:26.760</a></span> | <span class="t">And in particular, instead of strict,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2848" target="_blank">00:47:28.220</a></span> | <span class="t">let's change it to replace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2850" target="_blank">00:47:30.360</a></span> | <span class="t">And that will replace with this special marker,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2854" target="_blank">00:47:34.720</a></span> | <span class="t">this replacement character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2856" target="_blank">00:47:36.720</a></span> | <span class="t">So errors equals replace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2860" target="_blank">00:47:40.360</a></span> | <span class="t">And now we just get that character back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2862" target="_blank">00:47:42.360</a></span> | <span class="t">So basically, not every single byte sequence is valid UTF-8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2869" target="_blank">00:47:49.440</a></span> | <span class="t">And if it happens that your large language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2872" target="_blank">00:47:52.040</a></span> | <span class="t">for example, predicts your tokens in a bad manner,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2876" target="_blank">00:47:56.080</a></span> | <span class="t">then they might not fall into valid UTF-8,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2879" target="_blank">00:47:59.720</a></span> | <span class="t">and then we won't be able to decode them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2882" target="_blank">00:48:02.160</a></span> | <span class="t">So the standard practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2883" target="_blank">00:48:03.720</a></span> | <span class="t">is to basically use errors equals replace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2887" target="_blank">00:48:07.080</a></span> | <span class="t">And this is what you will also find in the OpenAI code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2890" target="_blank">00:48:10.320</a></span> | <span class="t">that they released as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2892" target="_blank">00:48:12.240</a></span> | <span class="t">But basically, whenever you see this kind of a character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2894" target="_blank">00:48:14.560</a></span> | <span class="t">in your output, in that case, something went wrong,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2897" target="_blank">00:48:17.080</a></span> | <span class="t">and the LM output was not a valid sequence of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2902" target="_blank">00:48:22.080</a></span> | <span class="t">Okay, and now we're going to go the other way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2904" target="_blank">00:48:24.320</a></span> | <span class="t">So we are going to implement this error right here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2907" target="_blank">00:48:27.600</a></span> | <span class="t">where we are gonna be given a string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2909" target="_blank">00:48:29.160</a></span> | <span class="t">and we want to encode it into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2911" target="_blank">00:48:31.000</a></span> | <span class="t">So this is the signature of the function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2914" target="_blank">00:48:34.080</a></span> | <span class="t">that we're interested in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2915" target="_blank">00:48:35.640</a></span> | <span class="t">And this should basically print a list of integers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2919" target="_blank">00:48:39.080</a></span> | <span class="t">of the tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2920" target="_blank">00:48:40.040</a></span> | <span class="t">So again, try to maybe implement this yourself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2923" target="_blank">00:48:43.040</a></span> | <span class="t">if you'd like a fun exercise, and pause here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2925" target="_blank">00:48:45.840</a></span> | <span class="t">Otherwise, I'm going to start putting in my solution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2928" target="_blank">00:48:48.160</a></span> | <span class="t">So again, there are many ways to do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2930" target="_blank">00:48:50.840</a></span> | <span class="t">So this is one of the ways that sort of I came up with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2935" target="_blank">00:48:55.840</a></span> | <span class="t">So the first thing we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2938" target="_blank">00:48:58.640</a></span> | <span class="t">is we are going to take our text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2942" target="_blank">00:49:02.360</a></span> | <span class="t">encode it into UTF-8 to get the raw bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2945" target="_blank">00:49:05.120</a></span> | <span class="t">And then as before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2945" target="_blank">00:49:05.960</a></span> | <span class="t">we're going to call list on the bytes object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2947" target="_blank">00:49:07.760</a></span> | <span class="t">to get a list of integers of those bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2951" target="_blank">00:49:11.680</a></span> | <span class="t">So those are the starting tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2953" target="_blank">00:49:13.240</a></span> | <span class="t">Those are the raw bytes of our sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2955" target="_blank">00:49:15.640</a></span> | <span class="t">But now of course, according to the merges dictionary above,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2959" target="_blank">00:49:19.080</a></span> | <span class="t">and recall this was the merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2960" target="_blank">00:49:20.760</a></span> | <span class="t">some of the bytes may be merged according to this lookup.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2965" target="_blank">00:49:25.960</a></span> | <span class="t">In addition to that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2966" target="_blank">00:49:26.800</a></span> | <span class="t">remember that the merges was built from top to bottom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2969" target="_blank">00:49:29.320</a></span> | <span class="t">And this is sort of the order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2970" target="_blank">00:49:30.320</a></span> | <span class="t">in which we inserted stuff into merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2972" target="_blank">00:49:32.560</a></span> | <span class="t">And so we prefer to do all these merges in the beginning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2975" target="_blank">00:49:35.720</a></span> | <span class="t">before we do these merges later,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2977" target="_blank">00:49:37.760</a></span> | <span class="t">because for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2979" target="_blank">00:49:39.520</a></span> | <span class="t">this merge over here relies on the 256,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2982" target="_blank">00:49:42.040</a></span> | <span class="t">which got merged here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2984" target="_blank">00:49:44.120</a></span> | <span class="t">So we have to go in the order from top to bottom sort of,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2987" target="_blank">00:49:47.360</a></span> | <span class="t">if we are going to be merging anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2990" target="_blank">00:49:50.000</a></span> | <span class="t">Now we expect to be doing a few merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2992" target="_blank">00:49:52.160</a></span> | <span class="t">So we're going to be doing while true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2994" target="_blank">00:49:54.080</a></span> | <span class="t">And now we want to find a pair of bytes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=2999" target="_blank">00:49:59.000</a></span> | <span class="t">that is consecutive,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3000" target="_blank">00:50:00.280</a></span> | <span class="t">that we are allowed to merge according to this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3002" target="_blank">00:50:02.760</a></span> | <span class="t">In order to reuse some of the functionality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3005" target="_blank">00:50:05.120</a></span> | <span class="t">that we've already written,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3006" target="_blank">00:50:06.200</a></span> | <span class="t">I'm going to reuse the function get stats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3009" target="_blank">00:50:09.040</a></span> | <span class="t">So recall that get stats will give us the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3013" target="_blank">00:50:13.040</a></span> | <span class="t">will basically count up how many times every single pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3016" target="_blank">00:50:16.040</a></span> | <span class="t">occurs in our sequence of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3018" target="_blank">00:50:18.400</a></span> | <span class="t">and return that as a dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3020" target="_blank">00:50:20.480</a></span> | <span class="t">And the dictionary was a mapping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3022" target="_blank">00:50:22.040</a></span> | <span class="t">from all the different byte pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3026" target="_blank">00:50:26.400</a></span> | <span class="t">to the number of times that they occur, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3028" target="_blank">00:50:28.680</a></span> | <span class="t">At this point, we don't actually care</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3030" target="_blank">00:50:30.880</a></span> | <span class="t">how many times they occur in the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3033" target="_blank">00:50:33.040</a></span> | <span class="t">We only care what the raw pairs are in that sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3036" target="_blank">00:50:36.680</a></span> | <span class="t">And so I'm only going to be using basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3038" target="_blank">00:50:38.120</a></span> | <span class="t">the keys of the dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3039" target="_blank">00:50:39.800</a></span> | <span class="t">I only care about the set of possible merge candidates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3042" target="_blank">00:50:42.920</a></span> | <span class="t">if that makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3043" target="_blank">00:50:43.920</a></span> | <span class="t">Now we want to identify the pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3046" target="_blank">00:50:46.280</a></span> | <span class="t">that we're going to be merging at this stage of the loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3049" target="_blank">00:50:49.400</a></span> | <span class="t">So what do we want?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3050" target="_blank">00:50:50.240</a></span> | <span class="t">We want to find the pair or like a key inside stats</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3054" target="_blank">00:50:54.800</a></span> | <span class="t">that has the lowest index in the merges dictionary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3059" target="_blank">00:50:59.440</a></span> | <span class="t">because we want to do all the early merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3061" target="_blank">00:51:01.080</a></span> | <span class="t">before we work our way to the late merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3064" target="_blank">00:51:04.120</a></span> | <span class="t">So again, there are many different ways to implement this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3066" target="_blank">00:51:06.240</a></span> | <span class="t">but I'm going to do something a little bit fancy here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3072" target="_blank">00:51:12.320</a></span> | <span class="t">So I'm going to be using the min over an iterator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3075" target="_blank">00:51:15.960</a></span> | <span class="t">In Python, when you call min on an iterator,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3078" target="_blank">00:51:18.200</a></span> | <span class="t">and stats here is a dictionary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3079" target="_blank">00:51:19.920</a></span> | <span class="t">we're going to be iterating the keys</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3081" target="_blank">00:51:21.400</a></span> | <span class="t">of this dictionary in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3083" target="_blank">00:51:23.480</a></span> | <span class="t">So we're looking at all the pairs inside stats,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3086" target="_blank">00:51:26.920</a></span> | <span class="t">which are all the consecutive pairs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3090" target="_blank">00:51:30.440</a></span> | <span class="t">And we're going to be taking the consecutive pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3093" target="_blank">00:51:33.080</a></span> | <span class="t">inside tokens that has the minimum, what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3096" target="_blank">00:51:36.200</a></span> | <span class="t">The min takes a key, which gives us the function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3100" target="_blank">00:51:40.080</a></span> | <span class="t">that is going to return a value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3101" target="_blank">00:51:41.920</a></span> | <span class="t">over which we're going to do the min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3104" target="_blank">00:51:44.120</a></span> | <span class="t">And the one we care about is we care about taking merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3107" target="_blank">00:51:47.400</a></span> | <span class="t">and basically getting that pair's index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3112" target="_blank">00:51:52.400</a></span> | <span class="t">So basically for any pair inside stats,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3118" target="_blank">00:51:58.240</a></span> | <span class="t">we are going to be looking into merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3120" target="_blank">00:52:00.800</a></span> | <span class="t">at what index it has.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3122" target="_blank">00:52:02.720</a></span> | <span class="t">And we want to get the pair with the min number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3125" target="_blank">00:52:05.800</a></span> | <span class="t">So as an example, if there's a pair 101 and 32,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3128" target="_blank">00:52:08.320</a></span> | <span class="t">we definitely want to get that pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3130" target="_blank">00:52:10.640</a></span> | <span class="t">We want to identify it here and return it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3132" target="_blank">00:52:12.560</a></span> | <span class="t">And pair would become 101, 32 if it occurs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3135" target="_blank">00:52:15.920</a></span> | <span class="t">And the reason that I'm putting a float inf here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3139" target="_blank">00:52:19.200</a></span> | <span class="t">as a fallback is that in the get function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3142" target="_blank">00:52:22.200</a></span> | <span class="t">when we call, when we basically consider a pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3146" target="_blank">00:52:26.240</a></span> | <span class="t">that doesn't occur in the merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3148" target="_blank">00:52:28.400</a></span> | <span class="t">then that pair is not eligible to be merged, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3150" target="_blank">00:52:30.760</a></span> | <span class="t">So if in the token sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3152" target="_blank">00:52:32.720</a></span> | <span class="t">there's some pair that is not a merging pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3155" target="_blank">00:52:35.200</a></span> | <span class="t">it cannot be merged,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3156" target="_blank">00:52:36.440</a></span> | <span class="t">then it doesn't actually occur here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3158" target="_blank">00:52:38.640</a></span> | <span class="t">and it doesn't have an index and it cannot be merged,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3161" target="_blank">00:52:41.840</a></span> | <span class="t">which we will denote as float inf.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3164" target="_blank">00:52:44.120</a></span> | <span class="t">And the reason infinity is nice here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3165" target="_blank">00:52:45.600</a></span> | <span class="t">is because for sure we're guaranteed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3167" target="_blank">00:52:47.520</a></span> | <span class="t">that it's not going to participate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3168" target="_blank">00:52:48.760</a></span> | <span class="t">in the list of candidates when we do the min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3171" target="_blank">00:52:51.920</a></span> | <span class="t">So this is one way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3174" target="_blank">00:52:54.160</a></span> | <span class="t">So basically a long story short,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3176" target="_blank">00:52:56.440</a></span> | <span class="t">this returns the most eligible merging candidate pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3180" target="_blank">00:53:00.800</a></span> | <span class="t">that occurs in the tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3182" target="_blank">00:53:02.400</a></span> | <span class="t">Now, one thing to be careful with here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3184" target="_blank">00:53:04.560</a></span> | <span class="t">is this function here might fail in the following way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3189" target="_blank">00:53:09.560</a></span> | <span class="t">If there's nothing to merge,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3191" target="_blank">00:53:11.280</a></span> | <span class="t">then there's nothing in merges that is satisfied anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3196" target="_blank">00:53:16.280</a></span> | <span class="t">There's nothing to merge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3199" target="_blank">00:53:19.280</a></span> | <span class="t">Everything just returns float infs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3201" target="_blank">00:53:21.760</a></span> | <span class="t">And then the pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3203" target="_blank">00:53:23.120</a></span> | <span class="t">I think will just become the very first element of stats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3206" target="_blank">00:53:26.640</a></span> | <span class="t">But this pair is not actually a mergeable pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3209" target="_blank">00:53:29.320</a></span> | <span class="t">It just becomes the first pair inside stats arbitrarily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3213" target="_blank">00:53:33.040</a></span> | <span class="t">because all of these pairs evaluate to float inf</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3215" target="_blank">00:53:35.600</a></span> | <span class="t">for the merging criterion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3218" target="_blank">00:53:38.240</a></span> | <span class="t">So basically it could be that this doesn't succeed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3220" target="_blank">00:53:40.840</a></span> | <span class="t">because there's no more merging pairs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3222" target="_blank">00:53:42.080</a></span> | <span class="t">So if this pair is not in merges that was returned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3226" target="_blank">00:53:46.080</a></span> | <span class="t">then this is a signal for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3227" target="_blank">00:53:47.280</a></span> | <span class="t">that actually there was nothing to merge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3229" target="_blank">00:53:49.320</a></span> | <span class="t">No single pair can be merged anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3231" target="_blank">00:53:51.480</a></span> | <span class="t">In that case, we will break out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3233" target="_blank">00:53:53.080</a></span> | <span class="t">Nothing else can be merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3236" target="_blank">00:53:56.560</a></span> | <span class="t">You may come up with a different implementation, by the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3240" target="_blank">00:54:00.760</a></span> | <span class="t">This is kind of like really trying hard in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3243" target="_blank">00:54:03.720</a></span> | <span class="t">But really we're just trying to find a pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3247" target="_blank">00:54:07.120</a></span> | <span class="t">that can be merged with a lowest index here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3249" target="_blank">00:54:09.400</a></span> | <span class="t">Now, if we did find a pair that is inside merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3255" target="_blank">00:54:15.360</a></span> | <span class="t">with the lowest index, then we can merge it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3257" target="_blank">00:54:17.760</a></span> | <span class="t">So we're going to look into the mergers dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3262" target="_blank">00:54:22.520</a></span> | <span class="t">for that pair to look up the index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3265" target="_blank">00:54:25.320</a></span> | <span class="t">And we're going to now merge into that index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3268" target="_blank">00:54:28.680</a></span> | <span class="t">So we're going to do tokens equals,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3270" target="_blank">00:54:30.320</a></span> | <span class="t">and we're going to replace the original tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3274" target="_blank">00:54:34.520</a></span> | <span class="t">We're going to be replacing the pair, pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3276" target="_blank">00:54:36.680</a></span> | <span class="t">and we're going to be replacing it with index IDX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3279" target="_blank">00:54:39.080</a></span> | <span class="t">And this returns a new list of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3281" target="_blank">00:54:41.640</a></span> | <span class="t">where every occurrence of pair is replaced with IDX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3284" target="_blank">00:54:44.520</a></span> | <span class="t">So we're doing a merge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3286" target="_blank">00:54:46.360</a></span> | <span class="t">And we're going to be continuing this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3287" target="_blank">00:54:47.640</a></span> | <span class="t">until eventually nothing can be merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3289" target="_blank">00:54:49.400</a></span> | <span class="t">We'll come out here and we'll break out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3291" target="_blank">00:54:51.360</a></span> | <span class="t">And here we just return tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3293" target="_blank">00:54:53.040</a></span> | <span class="t">And so that's the implementation, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3296" target="_blank">00:54:56.880</a></span> | <span class="t">So hopefully this runs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3298" target="_blank">00:54:58.240</a></span> | <span class="t">Okay, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3299" target="_blank">00:54:59.680</a></span> | <span class="t">Um, yeah, and this looks reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3302" target="_blank">00:55:02.960</a></span> | <span class="t">So for example, 32 is a space in ASCII, so that's here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3306" target="_blank">00:55:06.600</a></span> | <span class="t">So this looks like it worked, great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3310" target="_blank">00:55:10.720</a></span> | <span class="t">Okay, so let's wrap up this section of the video at least.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3313" target="_blank">00:55:13.480</a></span> | <span class="t">I wanted to point out that this is not quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3315" target="_blank">00:55:15.160</a></span> | <span class="t">the right implementation just yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3316" target="_blank">00:55:16.320</a></span> | <span class="t">because we are leaving out a special case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3318" target="_blank">00:55:18.760</a></span> | <span class="t">So in particular, if we tried to do this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3321" target="_blank">00:55:21.600</a></span> | <span class="t">this would give us an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3323" target="_blank">00:55:23.280</a></span> | <span class="t">And the issue is that if we only have a single character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3326" target="_blank">00:55:26.360</a></span> | <span class="t">or an empty string, then stats is empty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3329" target="_blank">00:55:29.000</a></span> | <span class="t">and that causes an issue inside min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3331" target="_blank">00:55:31.080</a></span> | <span class="t">So one way to fight this is if len of tokens is at least two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3336" target="_blank">00:55:36.080</a></span> | <span class="t">because if it's less than two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3337" target="_blank">00:55:37.320</a></span> | <span class="t">it's just a single token or no tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3338" target="_blank">00:55:38.880</a></span> | <span class="t">then let's just, there's nothing to merge,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3341" target="_blank">00:55:41.040</a></span> | <span class="t">so we just return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3342" target="_blank">00:55:42.440</a></span> | <span class="t">So that would fix that case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3344" target="_blank">00:55:44.280</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3346" target="_blank">00:55:46.440</a></span> | <span class="t">And then second, I have a few test cases here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3348" target="_blank">00:55:48.880</a></span> | <span class="t">for us as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3350" target="_blank">00:55:50.040</a></span> | <span class="t">So first let's make sure about, or let's note the following.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3354" target="_blank">00:55:54.120</a></span> | <span class="t">If we take a string and we try to encode it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3357" target="_blank">00:55:57.400</a></span> | <span class="t">and then decode it back,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3358" target="_blank">00:55:58.800</a></span> | <span class="t">you'd expect to get the same string back, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3361" target="_blank">00:56:01.080</a></span> | <span class="t">Is that true for all strings?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3362" target="_blank">00:56:02.600</a></span> | <span class="t">So I think, so here it is the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3367" target="_blank">00:56:07.560</a></span> | <span class="t">And I think in general, this is probably the case,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3370" target="_blank">00:56:10.040</a></span> | <span class="t">but notice that going backwards is not,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3374" target="_blank">00:56:14.440</a></span> | <span class="t">you're not going to have an identity going backwards</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3376" target="_blank">00:56:16.640</a></span> | <span class="t">because as I mentioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3378" target="_blank">00:56:18.280</a></span> | <span class="t">not all token sequences are valid UTF-8 sort of byte streams.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3384" target="_blank">00:56:24.760</a></span> | <span class="t">And so therefore, some of them can't even be decodable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3387" target="_blank">00:56:27.600</a></span> | <span class="t">So this only goes in one direction,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3391" target="_blank">00:56:31.480</a></span> | <span class="t">but for that one direction, we can check here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3394" target="_blank">00:56:34.360</a></span> | <span class="t">If we take the training text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3395" target="_blank">00:56:35.680</a></span> | <span class="t">which is the text that we trained the tokenizer on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3397" target="_blank">00:56:37.760</a></span> | <span class="t">we can make sure that when we encode and decode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3399" target="_blank">00:56:39.440</a></span> | <span class="t">we get the same thing back, which is true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3402" target="_blank">00:56:42.040</a></span> | <span class="t">And here I took some validation data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3403" target="_blank">00:56:43.600</a></span> | <span class="t">So I went to, I think this webpage and I grabbed some text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3407" target="_blank">00:56:47.120</a></span> | <span class="t">So this is text that the tokenizer has not seen,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3409" target="_blank">00:56:49.440</a></span> | <span class="t">and we can make sure that this also works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3412" target="_blank">00:56:52.640</a></span> | <span class="t">Okay, so that gives us some confidence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3413" target="_blank">00:56:53.960</a></span> | <span class="t">that this was correctly implemented.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3416" target="_blank">00:56:56.040</a></span> | <span class="t">So those are the basics of the byte-pair encoding algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3419" target="_blank">00:56:59.160</a></span> | <span class="t">We saw how we can take some training set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3422" target="_blank">00:57:02.160</a></span> | <span class="t">train a tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3423" target="_blank">00:57:03.720</a></span> | <span class="t">The parameters of this tokenizer really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3425" target="_blank">00:57:05.480</a></span> | <span class="t">are just this dictionary of merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3427" target="_blank">00:57:07.960</a></span> | <span class="t">And that basically creates the little binary forest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3430" target="_blank">00:57:10.080</a></span> | <span class="t">on top of raw bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3431" target="_blank">00:57:11.360</a></span> | <span class="t">Once we have this, the merges table,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3434" target="_blank">00:57:14.720</a></span> | <span class="t">we can both encode and decode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3436" target="_blank">00:57:16.560</a></span> | <span class="t">between raw text and token sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3439" target="_blank">00:57:19.040</a></span> | <span class="t">So that's the simplest setting of the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3442" target="_blank">00:57:22.360</a></span> | <span class="t">What we're going to do now though,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3443" target="_blank">00:57:23.480</a></span> | <span class="t">is we're going to look at some of the state-of-the-art</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3445" target="_blank">00:57:25.360</a></span> | <span class="t">large language models and the kinds of tokenizers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3447" target="_blank">00:57:27.520</a></span> | <span class="t">that they use, and we're going to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3449" target="_blank">00:57:29.040</a></span> | <span class="t">that this picture complexifies very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3451" target="_blank">00:57:31.200</a></span> | <span class="t">So we're going to go through the details</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3453" target="_blank">00:57:33.360</a></span> | <span class="t">of this complexification one at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3457" target="_blank">00:57:37.280</a></span> | <span class="t">So let's kick things off by looking at the GPT series.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3460" target="_blank">00:57:40.040</a></span> | <span class="t">So in particular, I have the GPT-2 paper here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3462" target="_blank">00:57:42.460</a></span> | <span class="t">and this paper is from 2019 or so, so five years ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3468" target="_blank">00:57:48.000</a></span> | <span class="t">And let's scroll down to input representation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3471" target="_blank">00:57:51.220</a></span> | <span class="t">This is where they talk about the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3472" target="_blank">00:57:52.720</a></span> | <span class="t">that they're using for GPT-2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3475" target="_blank">00:57:55.160</a></span> | <span class="t">Now, this is all fairly readable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3476" target="_blank">00:57:56.520</a></span> | <span class="t">so I encourage you to pause and read this yourself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3480" target="_blank">00:58:00.000</a></span> | <span class="t">but this is where they motivate the use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3481" target="_blank">00:58:01.500</a></span> | <span class="t">of the byte-pair encoding algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3483" target="_blank">00:58:03.960</a></span> | <span class="t">on the byte-level representation of UTF-8 encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3488" target="_blank">00:58:08.700</a></span> | <span class="t">So this is where they motivate it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3490" target="_blank">00:58:10.040</a></span> | <span class="t">and they talk about the vocabulary sizes and everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3493" target="_blank">00:58:13.120</a></span> | <span class="t">Now, everything here is exactly as we've covered it so far,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3496" target="_blank">00:58:16.040</a></span> | <span class="t">but things start to depart around here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3498" target="_blank">00:58:18.700</a></span> | <span class="t">So what they mention is that they don't just apply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3501" target="_blank">00:58:21.040</a></span> | <span class="t">the Naive algorithm as we have done it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3503" target="_blank">00:58:23.520</a></span> | <span class="t">And in particular, here's a motivating example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3506" target="_blank">00:58:26.240</a></span> | <span class="t">Suppose that you have common words like dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3508" target="_blank">00:58:28.440</a></span> | <span class="t">What will happen is that dog, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3510" target="_blank">00:58:30.080</a></span> | <span class="t">occurs very frequently in the text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3512" target="_blank">00:58:32.620</a></span> | <span class="t">and it occurs right next to all kinds of punctuation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3515" target="_blank">00:58:35.300</a></span> | <span class="t">as an example, so dog dot, dog exclamation mark,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3518" target="_blank">00:58:38.920</a></span> | <span class="t">dog question mark, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3520" target="_blank">00:58:40.800</a></span> | <span class="t">And naively, you might imagine that the BPA algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3523" target="_blank">00:58:43.520</a></span> | <span class="t">could merge these to be single tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3525" target="_blank">00:58:45.680</a></span> | <span class="t">and then you end up with lots of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3527" target="_blank">00:58:47.280</a></span> | <span class="t">that are just like dog with a slightly different punctuation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3530" target="_blank">00:58:50.080</a></span> | <span class="t">And so it feels like you're clustering things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3531" target="_blank">00:58:51.680</a></span> | <span class="t">that shouldn't be clustered.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3532" target="_blank">00:58:52.520</a></span> | <span class="t">You're combining kind of semantics with punctuation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3535" target="_blank">00:58:55.420</a></span> | <span class="t">And this feels suboptimal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3538" target="_blank">00:58:58.840</a></span> | <span class="t">And indeed, they also say that this is suboptimal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3541" target="_blank">00:59:01.520</a></span> | <span class="t">according to some of the experiments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3543" target="_blank">00:59:03.440</a></span> | <span class="t">So what they want to do is they want to top down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3545" target="_blank">00:59:05.380</a></span> | <span class="t">in a manual way, enforce that some types of characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3549" target="_blank">00:59:09.640</a></span> | <span class="t">should never be merged together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3551" target="_blank">00:59:11.580</a></span> | <span class="t">So they want to enforce these emerging rules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3554" target="_blank">00:59:14.840</a></span> | <span class="t">on top of the BytePair encoding algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3557" target="_blank">00:59:17.720</a></span> | <span class="t">So let's take a look at their code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3559" target="_blank">00:59:19.920</a></span> | <span class="t">and see how they actually enforce this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3561" target="_blank">00:59:21.480</a></span> | <span class="t">and what kinds of mergers they actually do perform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3564" target="_blank">00:59:24.280</a></span> | <span class="t">So I have the tab open here for GPT-2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3567" target="_blank">00:59:27.280</a></span> | <span class="t">under OpenAI on GitHub.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3569" target="_blank">00:59:29.520</a></span> | <span class="t">And when we go to source, there is an encoder.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3574" target="_blank">00:59:34.000</a></span> | <span class="t">Now, I don't personally love that they called encoder.py</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3576" target="_blank">00:59:36.320</a></span> | <span class="t">because this is the tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3578" target="_blank">00:59:38.120</a></span> | <span class="t">and the tokenizer can do both encode and decode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3581" target="_blank">00:59:41.080</a></span> | <span class="t">So it feels kind of awkward to me that it's called encoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3583" target="_blank">00:59:43.120</a></span> | <span class="t">but that is the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3585" target="_blank">00:59:45.520</a></span> | <span class="t">And there's a lot going on here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3586" target="_blank">00:59:46.680</a></span> | <span class="t">and we're gonna step through it in detail at one point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3589" target="_blank">00:59:49.280</a></span> | <span class="t">For now, I just want to focus on this part here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3592" target="_blank">00:59:52.260</a></span> | <span class="t">They create a regex pattern here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3595" target="_blank">00:59:55.120</a></span> | <span class="t">that looks very complicated,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3596" target="_blank">00:59:56.200</a></span> | <span class="t">and we're gonna go through it in a bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3598" target="_blank">00:59:58.680</a></span> | <span class="t">But this is the core part that allows them to enforce rules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3602" target="_blank">01:00:02.660</a></span> | <span class="t">for what parts of the text will never be merged for sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3606" target="_blank">01:00:06.040</a></span> | <span class="t">Now, notice that re.compile here is a little bit misleading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3609" target="_blank">01:00:09.640</a></span> | <span class="t">because we're not just doing import re,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3612" target="_blank">01:00:12.120</a></span> | <span class="t">which is the Python re module,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3613" target="_blank">01:00:13.580</a></span> | <span class="t">we're doing import regex as re.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3615" target="_blank">01:00:15.640</a></span> | <span class="t">And regex is a Python package that you can install,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3618" target="_blank">01:00:18.720</a></span> | <span class="t">pip install regex,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3620" target="_blank">01:00:20.160</a></span> | <span class="t">and it's basically an extension of re,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3621" target="_blank">01:00:21.800</a></span> | <span class="t">so it's a bit more powerful re.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3623" target="_blank">01:00:23.360</a></span> | <span class="t">So let's take a look at this pattern and what it's doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3629" target="_blank">01:00:29.700</a></span> | <span class="t">and why this is actually doing the separation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3632" target="_blank">01:00:32.280</a></span> | <span class="t">that they are looking for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3633" target="_blank">01:00:33.880</a></span> | <span class="t">Okay, so I've copy pasted the pattern here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3635" target="_blank">01:00:35.820</a></span> | <span class="t">to our Jupyter Notebook where we left off,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3638" target="_blank">01:00:38.280</a></span> | <span class="t">and let's take this pattern for a spin.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3640" target="_blank">01:00:40.700</a></span> | <span class="t">So in the exact same way that their code does,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3643" target="_blank">01:00:43.400</a></span> | <span class="t">we're going to call an re.findAll for this pattern</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3647" target="_blank">01:00:47.000</a></span> | <span class="t">on any arbitrary string that we are interested in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3649" target="_blank">01:00:49.440</a></span> | <span class="t">So this is the string that we want to encode into tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3652" target="_blank">01:00:52.240</a></span> | <span class="t">to feed into an LLM, like GPT-2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3656" target="_blank">01:00:56.800</a></span> | <span class="t">So what exactly is this doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3659" target="_blank">01:00:59.040</a></span> | <span class="t">Well, re.findAll will take this pattern</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3661" target="_blank">01:01:01.120</a></span> | <span class="t">and try to match it against this string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3663" target="_blank">01:01:03.120</a></span> | <span class="t">The way this works is that you are going from left to right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3667" target="_blank">01:01:07.760</a></span> | <span class="t">in the string, and you're trying to match the pattern.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3671" target="_blank">01:01:11.320</a></span> | <span class="t">And re.findAll will get all the occurrences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3675" target="_blank">01:01:15.060</a></span> | <span class="t">and organize them into a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3676" target="_blank">01:01:16.560</a></span> | <span class="t">Now, when you look at this pattern,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3680" target="_blank">01:01:20.500</a></span> | <span class="t">first of all, notice that this is a raw string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3682" target="_blank">01:01:22.940</a></span> | <span class="t">and then these are three double quotes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3686" target="_blank">01:01:26.220</a></span> | <span class="t">just to start the string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3687" target="_blank">01:01:27.820</a></span> | <span class="t">So really the string itself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3689" target="_blank">01:01:29.400</a></span> | <span class="t">this is the pattern itself, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3691" target="_blank">01:01:31.060</a></span> | <span class="t">And notice that it's made up of a lot of ORs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3695" target="_blank">01:01:35.260</a></span> | <span class="t">So see these vertical bars?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3696" target="_blank">01:01:36.500</a></span> | <span class="t">Those are ORs in Regex.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3698" target="_blank">01:01:38.480</a></span> | <span class="t">And so you go from left to right in this pattern</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3701" target="_blank">01:01:41.460</a></span> | <span class="t">and try to match it against the string wherever you are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3704" target="_blank">01:01:44.540</a></span> | <span class="t">So we have hello, and we're gonna try to match it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3708" target="_blank">01:01:48.040</a></span> | <span class="t">Well, it's not apostrophe S,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3709" target="_blank">01:01:49.560</a></span> | <span class="t">it's not apostrophe T, or any of these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3712" target="_blank">01:01:52.520</a></span> | <span class="t">but it is an optional space followed by dash P of,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3717" target="_blank">01:01:57.220</a></span> | <span class="t">sorry, slash P of L one or more times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3720" target="_blank">01:02:00.340</a></span> | <span class="t">What is slash P of L?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3721" target="_blank">01:02:01.940</a></span> | <span class="t">It is coming to some documentation that I found.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3725" target="_blank">01:02:05.260</a></span> | <span class="t">There might be other sources as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3729" target="_blank">01:02:09.200</a></span> | <span class="t">Slash P of L is a letter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3731" target="_blank">01:02:11.220</a></span> | <span class="t">any kind of letter from any language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3733" target="_blank">01:02:13.660</a></span> | <span class="t">And hello is made up of letters, H-E-L-L-O, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3738" target="_blank">01:02:18.340</a></span> | <span class="t">So optional space followed by a bunch of letters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3741" target="_blank">01:02:21.520</a></span> | <span class="t">one or more letters, is going to match hello,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3744" target="_blank">01:02:24.740</a></span> | <span class="t">but then the match ends</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3746" target="_blank">01:02:26.260</a></span> | <span class="t">because a white space is not a letter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3748" target="_blank">01:02:28.740</a></span> | <span class="t">So from there on begins a new sort of attempt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3753" target="_blank">01:02:33.220</a></span> | <span class="t">to match against the string again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3755" target="_blank">01:02:35.780</a></span> | <span class="t">And starting in here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3757" target="_blank">01:02:37.080</a></span> | <span class="t">we're gonna skip over all of these again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3759" target="_blank">01:02:39.140</a></span> | <span class="t">until we get to the exact same point again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3761" target="_blank">01:02:41.580</a></span> | <span class="t">And we see that there's an optional space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3763" target="_blank">01:02:43.540</a></span> | <span class="t">this is the optional space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3764" target="_blank">01:02:44.980</a></span> | <span class="t">followed by a bunch of letters, one or more of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3767" target="_blank">01:02:47.140</a></span> | <span class="t">And so that matches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3768" target="_blank">01:02:48.620</a></span> | <span class="t">So when we run this, we get a list of two elements,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3772" target="_blank">01:02:52.620</a></span> | <span class="t">hello, and then space world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3774" target="_blank">01:02:54.580</a></span> | <span class="t">So how are you if we add more letters?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3778" target="_blank">01:02:58.840</a></span> | <span class="t">We would just get them like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3781" target="_blank">01:03:01.180</a></span> | <span class="t">Now, what is this doing and why is this important?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3783" target="_blank">01:03:03.700</a></span> | <span class="t">We are taking our string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3785" target="_blank">01:03:05.460</a></span> | <span class="t">and instead of directly encoding it for tokenization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3790" target="_blank">01:03:10.020</a></span> | <span class="t">we are first splitting it up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3792" target="_blank">01:03:12.180</a></span> | <span class="t">And when you actually step through the code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3794" target="_blank">01:03:14.140</a></span> | <span class="t">and we'll do that in a bit more detail,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3796" target="_blank">01:03:16.320</a></span> | <span class="t">what really it's doing on a high level</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3797" target="_blank">01:03:17.740</a></span> | <span class="t">is that it first splits your text into a list of texts,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3802" target="_blank">01:03:22.740</a></span> | <span class="t">just like this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3804" target="_blank">01:03:24.620</a></span> | <span class="t">And all these elements of this list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3806" target="_blank">01:03:26.420</a></span> | <span class="t">are processed independently by the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3809" target="_blank">01:03:29.220</a></span> | <span class="t">And all of the results of that processing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3811" target="_blank">01:03:31.340</a></span> | <span class="t">are simply concatenated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3813" target="_blank">01:03:33.240</a></span> | <span class="t">So hello world, oh, I missed how.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3816" target="_blank">01:03:36.660</a></span> | <span class="t">Hello world, how are you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3819" target="_blank">01:03:39.580</a></span> | <span class="t">We have five elements of a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3821" target="_blank">01:03:41.180</a></span> | <span class="t">All of these will independently go from text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3826" target="_blank">01:03:46.180</a></span> | <span class="t">to a token sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3828" target="_blank">01:03:48.060</a></span> | <span class="t">And then that token sequence is going to be concatenated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3830" target="_blank">01:03:50.580</a></span> | <span class="t">It's all gonna be joined up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3832" target="_blank">01:03:52.700</a></span> | <span class="t">And roughly speaking, what that does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3834" target="_blank">01:03:54.940</a></span> | <span class="t">is you're only ever finding merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3837" target="_blank">01:03:57.420</a></span> | <span class="t">between the elements of this list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3839" target="_blank">01:03:59.240</a></span> | <span class="t">So you can only ever consider merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3840" target="_blank">01:04:00.740</a></span> | <span class="t">within every one of these elements individually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3843" target="_blank">01:04:03.200</a></span> | <span class="t">And after you've done all the possible merging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3847" target="_blank">01:04:07.540</a></span> | <span class="t">for all of these elements individually,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3849" target="_blank">01:04:09.460</a></span> | <span class="t">the results of all that will be joined by concatenation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3854" target="_blank">01:04:14.460</a></span> | <span class="t">And so you are basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3856" target="_blank">01:04:16.220</a></span> | <span class="t">what you're doing effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3857" target="_blank">01:04:17.820</a></span> | <span class="t">is you are never going to be merging this E</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3860" target="_blank">01:04:20.980</a></span> | <span class="t">with this space because they are now parts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3863" target="_blank">01:04:23.500</a></span> | <span class="t">of the separate elements of this list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3865" target="_blank">01:04:25.860</a></span> | <span class="t">And so you are saying we are never gonna merge E space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3869" target="_blank">01:04:29.260</a></span> | <span class="t">because we're breaking it up in this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3873" target="_blank">01:04:33.580</a></span> | <span class="t">So basically using this regex pattern to chunk up the text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3877" target="_blank">01:04:37.420</a></span> | <span class="t">is just one way of enforcing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3879" target="_blank">01:04:39.580</a></span> | <span class="t">that some merges are not to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3883" target="_blank">01:04:43.100</a></span> | <span class="t">And we're gonna go into more of this text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3884" target="_blank">01:04:44.660</a></span> | <span class="t">and we'll see that what this is trying to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3886" target="_blank">01:04:46.000</a></span> | <span class="t">on a high level is we're trying to not merge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3888" target="_blank">01:04:48.100</a></span> | <span class="t">across letters, across numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3890" target="_blank">01:04:50.220</a></span> | <span class="t">across punctuation, and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3892" target="_blank">01:04:52.700</a></span> | <span class="t">So let's see in more detail how that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3894" target="_blank">01:04:54.500</a></span> | <span class="t">So let's continue now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3895" target="_blank">01:04:55.940</a></span> | <span class="t">We have slash P of N.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3897" target="_blank">01:04:57.660</a></span> | <span class="t">If you go to the documentation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3899" target="_blank">01:04:59.740</a></span> | <span class="t">slash P of N is any kind of numeric character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3903" target="_blank">01:05:03.380</a></span> | <span class="t">in any script.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3904" target="_blank">01:05:04.420</a></span> | <span class="t">So it's numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3905" target="_blank">01:05:05.940</a></span> | <span class="t">So we have an optional space followed by numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3907" target="_blank">01:05:07.940</a></span> | <span class="t">and those would be separated out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3909" target="_blank">01:05:09.740</a></span> | <span class="t">So letters and numbers are being separated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3911" target="_blank">01:05:11.540</a></span> | <span class="t">So if I do, hello world, one, two, three, how are you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3914" target="_blank">01:05:14.980</a></span> | <span class="t">Then world will stop matching here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3916" target="_blank">01:05:16.980</a></span> | <span class="t">because one is not a letter anymore,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3919" target="_blank">01:05:19.580</a></span> | <span class="t">but one is a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3920" target="_blank">01:05:20.740</a></span> | <span class="t">So this group will match for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3922" target="_blank">01:05:22.520</a></span> | <span class="t">and we'll get it as a separate entity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3924" target="_blank">01:05:24.460</a></span> | <span class="t">Let's see how these apostrophes work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3928" target="_blank">01:05:28.420</a></span> | <span class="t">So here, if we have slash V,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3934" target="_blank">01:05:34.180</a></span> | <span class="t">I mean apostrophe V as an example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3936" target="_blank">01:05:36.660</a></span> | <span class="t">then apostrophe here is not a letter or a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3939" target="_blank">01:05:39.700</a></span> | <span class="t">So hello will stop matching</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3942" target="_blank">01:05:42.420</a></span> | <span class="t">and then we will exactly match this with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3945" target="_blank">01:05:45.940</a></span> | <span class="t">So that will come out as a separate thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3948" target="_blank">01:05:48.340</a></span> | <span class="t">So why are they doing the apostrophes here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3951" target="_blank">01:05:51.620</a></span> | <span class="t">Honestly, I think that these are just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3952" target="_blank">01:05:52.740</a></span> | <span class="t">like very common apostrophes that are used typically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3957" target="_blank">01:05:57.740</a></span> | <span class="t">I don't love that they've done this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3959" target="_blank">01:05:59.620</a></span> | <span class="t">because let me show you what happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3963" target="_blank">01:06:03.420</a></span> | <span class="t">when you have some Unicode apostrophes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3966" target="_blank">01:06:06.380</a></span> | <span class="t">Like for example, you can have,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3968" target="_blank">01:06:08.140</a></span> | <span class="t">if you have house, then this will be separated out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3971" target="_blank">01:06:11.180</a></span> | <span class="t">because of this matching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3973" target="_blank">01:06:13.140</a></span> | <span class="t">But if you use the Unicode apostrophe like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3976" target="_blank">01:06:16.200</a></span> | <span class="t">then suddenly this does not work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3979" target="_blank">01:06:19.940</a></span> | <span class="t">And so this apostrophe will actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3981" target="_blank">01:06:21.660</a></span> | <span class="t">become its own thing now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3983" target="_blank">01:06:23.740</a></span> | <span class="t">And so it's basically hard-coded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3985" target="_blank">01:06:25.980</a></span> | <span class="t">for this specific kind of apostrophe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3988" target="_blank">01:06:28.260</a></span> | <span class="t">and otherwise they become completely separate tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3993" target="_blank">01:06:33.220</a></span> | <span class="t">In addition to this, you can go to the GPT-2 docs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3997" target="_blank">01:06:37.680</a></span> | <span class="t">and here when they define the pattern,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=3999" target="_blank">01:06:39.460</a></span> | <span class="t">they say should have added re.ignoreCase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4002" target="_blank">01:06:42.300</a></span> | <span class="t">So BP merges can happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4003" target="_blank">01:06:43.480</a></span> | <span class="t">for capitalized versions of contractions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4005" target="_blank">01:06:45.560</a></span> | <span class="t">So what they're pointing out is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4007" target="_blank">01:06:47.180</a></span> | <span class="t">you see how this is apostrophe and then lowercase letters?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4010" target="_blank">01:06:50.820</a></span> | <span class="t">Well, because they didn't do re.ignoreCase,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4013" target="_blank">01:06:53.860</a></span> | <span class="t">then these rules will not separate out the apostrophes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4017" target="_blank">01:06:57.940</a></span> | <span class="t">if it's uppercase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4019" target="_blank">01:06:59.820</a></span> | <span class="t">So house would be like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4023" target="_blank">01:07:03.940</a></span> | <span class="t">but if I did house from uppercase,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4029" target="_blank">01:07:09.020</a></span> | <span class="t">then notice suddenly the apostrophe comes by itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4032" target="_blank">01:07:12.280</a></span> | <span class="t">So the tokenization will work differently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4036" target="_blank">01:07:16.220</a></span> | <span class="t">in uppercase and lowercase,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4037" target="_blank">01:07:17.560</a></span> | <span class="t">inconsistently separating out these apostrophes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4039" target="_blank">01:07:19.940</a></span> | <span class="t">So it feels extremely gnarly and slightly gross,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4042" target="_blank">01:07:22.380</a></span> | <span class="t">but that's how that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4045" target="_blank">01:07:25.780</a></span> | <span class="t">Okay, so let's come back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4047" target="_blank">01:07:27.320</a></span> | <span class="t">After trying to match a bunch of apostrophe expressions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4049" target="_blank">01:07:29.960</a></span> | <span class="t">by the way, the other issue here is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4051" target="_blank">01:07:31.100</a></span> | <span class="t">these are quite language-specific probably.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4053" target="_blank">01:07:33.340</a></span> | <span class="t">So I don't know that all the languages, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4055" target="_blank">01:07:35.940</a></span> | <span class="t">use or don't use apostrophes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4057" target="_blank">01:07:37.180</a></span> | <span class="t">but that would be inconsistently tokenized as a result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4061" target="_blank">01:07:41.060</a></span> | <span class="t">Then we try to match letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4062" target="_blank">01:07:42.500</a></span> | <span class="t">Then we try to match numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4064" target="_blank">01:07:44.340</a></span> | <span class="t">And then if that doesn't work, we fall back to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4067" target="_blank">01:07:47.540</a></span> | <span class="t">And what this is saying is, again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4068" target="_blank">01:07:48.820</a></span> | <span class="t">optional space followed by something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4070" target="_blank">01:07:50.340</a></span> | <span class="t">that is not a letter, number, or a space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4073" target="_blank">01:07:53.580</a></span> | <span class="t">and one or more of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4075" target="_blank">01:07:55.060</a></span> | <span class="t">So what this is doing effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4076" target="_blank">01:07:56.300</a></span> | <span class="t">is this is trying to match punctuation, roughly speaking,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4079" target="_blank">01:07:59.100</a></span> | <span class="t">not letters and not numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4081" target="_blank">01:08:01.140</a></span> | <span class="t">So this group will try to trigger for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4083" target="_blank">01:08:03.380</a></span> | <span class="t">So if I do something like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4085" target="_blank">01:08:05.600</a></span> | <span class="t">then these parts here are not letters or numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4089" target="_blank">01:08:09.540</a></span> | <span class="t">but they will actually get caught here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4093" target="_blank">01:08:13.540</a></span> | <span class="t">And so they become its own group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4095" target="_blank">01:08:15.760</a></span> | <span class="t">So we've separated out the punctuation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4098" target="_blank">01:08:18.420</a></span> | <span class="t">And finally, this is also a little bit confusing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4101" target="_blank">01:08:21.660</a></span> | <span class="t">So this is matching whitespace,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4104" target="_blank">01:08:24.140</a></span> | <span class="t">but this is using a negative lookahead assertion in regex.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4109" target="_blank">01:08:29.060</a></span> | <span class="t">So what this is doing is it's matching whitespace up to,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4112" target="_blank">01:08:32.140</a></span> | <span class="t">but not including the last whitespace character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4114" target="_blank">01:08:34.820</a></span> | <span class="t">Why is this important?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4117" target="_blank">01:08:37.900</a></span> | <span class="t">This is pretty subtle, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4119" target="_blank">01:08:39.440</a></span> | <span class="t">So you see how the whitespace is always included</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4121" target="_blank">01:08:41.660</a></span> | <span class="t">at the beginning of the word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4123" target="_blank">01:08:43.460</a></span> | <span class="t">So space R, space U, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4127" target="_blank">01:08:47.340</a></span> | <span class="t">Suppose we have a lot of spaces here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4129" target="_blank">01:08:49.180</a></span> | <span class="t">What's gonna happen here is that these spaces up to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4133" target="_blank">01:08:53.740</a></span> | <span class="t">and not including the last character will get caught by this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4138" target="_blank">01:08:58.020</a></span> | <span class="t">And what that will do is it will separate out the spaces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4141" target="_blank">01:09:01.180</a></span> | <span class="t">up to but not including the last character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4143" target="_blank">01:09:03.300</a></span> | <span class="t">so that the last character can come here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4145" target="_blank">01:09:05.620</a></span> | <span class="t">and join with the space U.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4148" target="_blank">01:09:08.620</a></span> | <span class="t">And the reason that's nice is because space U</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4151" target="_blank">01:09:11.220</a></span> | <span class="t">is the common token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4152" target="_blank">01:09:12.580</a></span> | <span class="t">So if I didn't have these extra spaces here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4155" target="_blank">01:09:15.060</a></span> | <span class="t">you would just have space U.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4156" target="_blank">01:09:16.500</a></span> | <span class="t">And if I add spaces, we still have a space U,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4160" target="_blank">01:09:20.660</a></span> | <span class="t">but now we have all this extra whitespace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4163" target="_blank">01:09:23.100</a></span> | <span class="t">So basically the GPT-2 tokenizer really likes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4165" target="_blank">01:09:25.060</a></span> | <span class="t">to have a space letters or numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4167" target="_blank">01:09:27.780</a></span> | <span class="t">and it prepends these spaces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4170" target="_blank">01:09:30.320</a></span> | <span class="t">And this is just something that it is consistent about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4173" target="_blank">01:09:33.020</a></span> | <span class="t">So that's what that is for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4174" target="_blank">01:09:34.460</a></span> | <span class="t">And then finally, we have all the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4176" target="_blank">01:09:36.300</a></span> | <span class="t">the last fallback is whitespace characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4179" target="_blank">01:09:39.780</a></span> | <span class="t">So that would be just,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4182" target="_blank">01:09:42.660</a></span> | <span class="t">if that doesn't get caught,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4186" target="_blank">01:09:46.100</a></span> | <span class="t">then this thing will catch any trailing spaces and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4190" target="_blank">01:09:50.100</a></span> | <span class="t">I wanted to show one more real world example here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4192" target="_blank">01:09:52.740</a></span> | <span class="t">So if we have this string, which is a piece of Python code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4195" target="_blank">01:09:55.340</a></span> | <span class="t">and then we try to split it up,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4197" target="_blank">01:09:57.300</a></span> | <span class="t">then this is the kind of output we get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4199" target="_blank">01:09:59.500</a></span> | <span class="t">So you'll notice that the list has many elements here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4201" target="_blank">01:10:01.580</a></span> | <span class="t">and that's because we are splitting up fairly often,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4204" target="_blank">01:10:04.900</a></span> | <span class="t">every time sort of a category changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4207" target="_blank">01:10:07.440</a></span> | <span class="t">So there will never be any mergers within these elements.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4211" target="_blank">01:10:11.940</a></span> | <span class="t">And that's what you are seeing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4214" target="_blank">01:10:14.780</a></span> | <span class="t">Now, you might think that in order to train the tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4219" target="_blank">01:10:19.020</a></span> | <span class="t">OpenAI has used this to split up text into chunks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4223" target="_blank">01:10:23.220</a></span> | <span class="t">and then run just a BP algorithm within all the chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4226" target="_blank">01:10:26.820</a></span> | <span class="t">But that's not exactly what happened.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4228" target="_blank">01:10:28.580</a></span> | <span class="t">And the reason is the following.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4230" target="_blank">01:10:30.420</a></span> | <span class="t">Notice that we have the spaces here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4233" target="_blank">01:10:33.340</a></span> | <span class="t">Those spaces end up being entire elements.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4236" target="_blank">01:10:36.440</a></span> | <span class="t">But these spaces never actually end up being merged</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4239" target="_blank">01:10:39.660</a></span> | <span class="t">by OpenAI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4240" target="_blank">01:10:40.500</a></span> | <span class="t">And the way you can tell is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4242" target="_blank">01:10:42.060</a></span> | <span class="t">if you copy paste the exact same chunk here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4243" target="_blank">01:10:43.740</a></span> | <span class="t">into a tick token, tick tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4246" target="_blank">01:10:46.900</a></span> | <span class="t">you see that all the spaces are kept independent,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4249" target="_blank">01:10:49.260</a></span> | <span class="t">and they're all token 220.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4250" target="_blank">01:10:50.840</a></span> | <span class="t">So I think OpenAI at some point enforced some rule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4255" target="_blank">01:10:55.240</a></span> | <span class="t">that these spaces would never be merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4257" target="_blank">01:10:57.580</a></span> | <span class="t">And so there's some additional rules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4260" target="_blank">01:11:00.420</a></span> | <span class="t">on top of just chunking and BP</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4262" target="_blank">01:11:02.920</a></span> | <span class="t">that OpenAI is not clear about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4265" target="_blank">01:11:05.400</a></span> | <span class="t">Now, the training code for the GPT-2 tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4267" target="_blank">01:11:07.380</a></span> | <span class="t">was never released.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4268" target="_blank">01:11:08.540</a></span> | <span class="t">So all we have is the code that I've already shown you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4272" target="_blank">01:11:12.280</a></span> | <span class="t">But this code here that they've released</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4274" target="_blank">01:11:14.020</a></span> | <span class="t">is only the inference code for the tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4277" target="_blank">01:11:17.300</a></span> | <span class="t">So this is not the training code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4278" target="_blank">01:11:18.620</a></span> | <span class="t">You can't give it a piece of text and train tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4281" target="_blank">01:11:21.620</a></span> | <span class="t">This is just the inference code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4283" target="_blank">01:11:23.020</a></span> | <span class="t">which takes the merges that we have up above</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4286" target="_blank">01:11:26.340</a></span> | <span class="t">and applies them to a new piece of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4289" target="_blank">01:11:29.260</a></span> | <span class="t">And so we don't know exactly how OpenAI trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4291" target="_blank">01:11:31.420</a></span> | <span class="t">the tokenizer, but it wasn't as simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4294" target="_blank">01:11:34.460</a></span> | <span class="t">as chunk it up and BP it, whatever it was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4298" target="_blank">01:11:38.340</a></span> | <span class="t">Next, I wanted to introduce you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4299" target="_blank">01:11:39.860</a></span> | <span class="t">to the tick token library for OpenAI,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4302" target="_blank">01:11:42.220</a></span> | <span class="t">which is the official library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4303" target="_blank">01:11:43.980</a></span> | <span class="t">for tokenization from OpenAI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4306" target="_blank">01:11:46.200</a></span> | <span class="t">So this is ticktoken, pip install ticktoken,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4310" target="_blank">01:11:50.180</a></span> | <span class="t">and then you can do the tokenization inference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4314" target="_blank">01:11:54.300</a></span> | <span class="t">So this is again, not training code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4315" target="_blank">01:11:55.740</a></span> | <span class="t">This is only inference code for tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4317" target="_blank">01:11:57.980</a></span> | <span class="t">I wanted to show you how you would use it, quite simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4322" target="_blank">01:12:02.180</a></span> | <span class="t">And running this just gives us the GPT-2 tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4324" target="_blank">01:12:04.860</a></span> | <span class="t">or the GPT-4 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4326" target="_blank">01:12:06.620</a></span> | <span class="t">So this is the tokenizer used for GPT-4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4329" target="_blank">01:12:09.420</a></span> | <span class="t">And so in particular, we see that the whitespace in GPT-2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4332" target="_blank">01:12:12.080</a></span> | <span class="t">it remains unmerged, but in GPT-4,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4334" target="_blank">01:12:14.500</a></span> | <span class="t">these whitespaces merge, as we also saw in this one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4338" target="_blank">01:12:18.740</a></span> | <span class="t">where here they're all unmerged,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4340" target="_blank">01:12:20.140</a></span> | <span class="t">but if we go down to GPT-4, they become merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4343" target="_blank">01:12:23.780</a></span> | <span class="t">Now in the GPT-4 tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4350" target="_blank">01:12:30.060</a></span> | <span class="t">they changed the regular expression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4352" target="_blank">01:12:32.320</a></span> | <span class="t">that they use to chunk up text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4354" target="_blank">01:12:34.700</a></span> | <span class="t">So the way to see this is that if you come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4356" target="_blank">01:12:36.200</a></span> | <span class="t">to the tick token library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4359" target="_blank">01:12:39.500</a></span> | <span class="t">and then you go to this file, tick_token_ext_openai_public,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4363" target="_blank">01:12:43.800</a></span> | <span class="t">this is where sort of like the definition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4365" target="_blank">01:12:45.360</a></span> | <span class="t">of all these different tokenizers that OpenAI maintains is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4368" target="_blank">01:12:48.680</a></span> | <span class="t">And so necessarily to do the inference,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4371" target="_blank">01:12:51.120</a></span> | <span class="t">they had to publish some of the details about the strings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4374" target="_blank">01:12:54.020</a></span> | <span class="t">So this is the string that we already saw for GPT-2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4377" target="_blank">01:12:57.080</a></span> | <span class="t">It is slightly different, but it is actually equivalent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4380" target="_blank">01:13:00.000</a></span> | <span class="t">to what we discussed here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4382" target="_blank">01:13:02.020</a></span> | <span class="t">So this pattern that we discussed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4383" target="_blank">01:13:03.520</a></span> | <span class="t">is equivalent to this pattern,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4385" target="_blank">01:13:05.600</a></span> | <span class="t">and this one just executes a little bit faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4388" target="_blank">01:13:08.320</a></span> | <span class="t">So here you see a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4389" target="_blank">01:13:09.360</a></span> | <span class="t">of a slightly different definition,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4390" target="_blank">01:13:10.620</a></span> | <span class="t">but otherwise it's the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4392" target="_blank">01:13:12.560</a></span> | <span class="t">We're gonna go into special tokens in a bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4395" target="_blank">01:13:15.160</a></span> | <span class="t">And then if you scroll down to CL-100K,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4398" target="_blank">01:13:18.440</a></span> | <span class="t">this is the GPT-4 tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4400" target="_blank">01:13:20.280</a></span> | <span class="t">you see that the pattern has changed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4402" target="_blank">01:13:22.240</a></span> | <span class="t">And this is kind of like the major change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4406" target="_blank">01:13:26.000</a></span> | <span class="t">in addition to a bunch of other special tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4407" target="_blank">01:13:27.800</a></span> | <span class="t">which we'll go into a bit again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4409" target="_blank">01:13:29.400</a></span> | <span class="t">Now, I'm not going to actually go into the full detail</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4412" target="_blank">01:13:32.840</a></span> | <span class="t">of the pattern change,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4413" target="_blank">01:13:33.680</a></span> | <span class="t">because honestly, this is mind-numbing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4415" target="_blank">01:13:35.960</a></span> | <span class="t">I would just advise that you pull out chat-gpt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4418" target="_blank">01:13:38.680</a></span> | <span class="t">in the regex documentation and just step through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4422" target="_blank">01:13:42.240</a></span> | <span class="t">But really the major changes are,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4424" target="_blank">01:13:44.280</a></span> | <span class="t">number one, you see this I here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4427" target="_blank">01:13:47.320</a></span> | <span class="t">That means that the case sensitivity,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4430" target="_blank">01:13:50.800</a></span> | <span class="t">this is case insensitive match.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4432" target="_blank">01:13:52.680</a></span> | <span class="t">And so the comment that we saw earlier on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4435" target="_blank">01:13:55.600</a></span> | <span class="t">oh, we should have used re.uppercase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4438" target="_blank">01:13:58.400</a></span> | <span class="t">Basically, we're now going to be matching</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4441" target="_blank">01:14:01.640</a></span> | <span class="t">these apostrophe S, apostrophe D, apostrophe M, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4446" target="_blank">01:14:06.640</a></span> | <span class="t">We're gonna be matching them both in lowercase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4448" target="_blank">01:14:08.200</a></span> | <span class="t">and in uppercase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4449" target="_blank">01:14:09.640</a></span> | <span class="t">So that's fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4451" target="_blank">01:14:11.080</a></span> | <span class="t">There's a bunch of different handling of the whitespace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4453" target="_blank">01:14:13.400</a></span> | <span class="t">that I'm not going to go into the full details of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4455" target="_blank">01:14:15.800</a></span> | <span class="t">And then one more thing here is you will notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4458" target="_blank">01:14:18.600</a></span> | <span class="t">that when they match the numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4460" target="_blank">01:14:20.240</a></span> | <span class="t">they only match one to three numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4463" target="_blank">01:14:23.200</a></span> | <span class="t">So they will never merge numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4467" target="_blank">01:14:27.080</a></span> | <span class="t">that are in more than three digits,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4469" target="_blank">01:14:29.840</a></span> | <span class="t">only up to three digits of numbers will ever be merged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4473" target="_blank">01:14:33.920</a></span> | <span class="t">And that's one change that they made as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4476" target="_blank">01:14:36.360</a></span> | <span class="t">to prevent tokens that are very, very long number sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4480" target="_blank">01:14:40.120</a></span> | <span class="t">But again, we don't really know why they do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4483" target="_blank">01:14:43.000</a></span> | <span class="t">any of this stuff because none of this is documented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4485" target="_blank">01:14:45.880</a></span> | <span class="t">and it's just, we just get the pattern.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4488" target="_blank">01:14:48.360</a></span> | <span class="t">So yeah, it is what it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4491" target="_blank">01:14:51.440</a></span> | <span class="t">But those are some of the changes that GPT-4 has made.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4494" target="_blank">01:14:54.400</a></span> | <span class="t">And of course, the vocabulary size went</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4496" target="_blank">01:14:56.400</a></span> | <span class="t">from roughly 50K to roughly 100K.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4499" target="_blank">01:14:59.480</a></span> | <span class="t">The next thing I would like to do very briefly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4501" target="_blank">01:15:01.120</a></span> | <span class="t">is to take you through the GPT-2 encoder.py</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4503" target="_blank">01:15:03.880</a></span> | <span class="t">that OpenAI has released.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4505" target="_blank">01:15:05.360</a></span> | <span class="t">This is the file that I already mentioned to you briefly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4509" target="_blank">01:15:09.280</a></span> | <span class="t">Now, this file is fairly short</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4512" target="_blank">01:15:12.560</a></span> | <span class="t">and should be relatively understandable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4514" target="_blank">01:15:14.240</a></span> | <span class="t">to you at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4515" target="_blank">01:15:15.280</a></span> | <span class="t">Starting at the bottom here, they are loading two files,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4521" target="_blank">01:15:21.000</a></span> | <span class="t">encoder.json and vocab.bpe.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4523" target="_blank">01:15:23.680</a></span> | <span class="t">And they do some light processing on it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4525" target="_blank">01:15:25.120</a></span> | <span class="t">and then they call this encoder object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4526" target="_blank">01:15:26.840</a></span> | <span class="t">which is the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4528" target="_blank">01:15:28.640</a></span> | <span class="t">Now, if you'd like to inspect these two files,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4531" target="_blank">01:15:31.160</a></span> | <span class="t">which together constitute their saved tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4534" target="_blank">01:15:34.480</a></span> | <span class="t">then you can do that with a piece of code like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4537" target="_blank">01:15:37.080</a></span> | <span class="t">This is where you can download these two files</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4540" target="_blank">01:15:40.040</a></span> | <span class="t">and you can inspect them if you'd like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4541" target="_blank">01:15:41.800</a></span> | <span class="t">And what you will find is that this encoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4544" target="_blank">01:15:44.440</a></span> | <span class="t">as they call it in their code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4545" target="_blank">01:15:45.960</a></span> | <span class="t">is exactly equivalent to our vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4548" target="_blank">01:15:48.680</a></span> | <span class="t">So remember here where we have this vocab object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4552" target="_blank">01:15:52.840</a></span> | <span class="t">which allowed us to decode very efficiently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4555" target="_blank">01:15:55.000</a></span> | <span class="t">And basically it took us from the integer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4557" target="_blank">01:15:57.560</a></span> | <span class="t">to the bytes for that integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4561" target="_blank">01:16:01.600</a></span> | <span class="t">So our vocab is exactly their encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4565" target="_blank">01:16:05.000</a></span> | <span class="t">And then their vocab.bpe, confusingly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4568" target="_blank">01:16:08.720</a></span> | <span class="t">is actually our merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4571" target="_blank">01:16:11.000</a></span> | <span class="t">So their bpe.merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4572" target="_blank">01:16:12.560</a></span> | <span class="t">which is based on the data inside vocab.bpe,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4576" target="_blank">01:16:16.240</a></span> | <span class="t">ends up being equivalent to our merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4578" target="_blank">01:16:18.920</a></span> | <span class="t">So basically they are saving and loading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4582" target="_blank">01:16:22.880</a></span> | <span class="t">the two variables that for us are also critical,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4586" target="_blank">01:16:26.320</a></span> | <span class="t">the merges variable and the vocab variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4589" target="_blank">01:16:29.000</a></span> | <span class="t">Using just these two variables,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4590" target="_blank">01:16:30.920</a></span> | <span class="t">you can represent a tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4592" target="_blank">01:16:32.400</a></span> | <span class="t">and you can both do encoding and decoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4594" target="_blank">01:16:34.320</a></span> | <span class="t">once you've trained this tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4596" target="_blank">01:16:36.160</a></span> | <span class="t">Now, the only thing that is actually slightly confusing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4601" target="_blank">01:16:41.480</a></span> | <span class="t">inside what OpenAI does here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4603" target="_blank">01:16:43.840</a></span> | <span class="t">is that in addition to this encoder and the decoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4606" target="_blank">01:16:46.560</a></span> | <span class="t">they also have something called a byte encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4608" target="_blank">01:16:48.480</a></span> | <span class="t">and a byte decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4610" target="_blank">01:16:50.280</a></span> | <span class="t">And this is actually, unfortunately,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4611" target="_blank">01:16:51.920</a></span> | <span class="t">just kind of a spurious implementation detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4615" target="_blank">01:16:55.960</a></span> | <span class="t">It isn't actually deep or interesting in any way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4618" target="_blank">01:16:58.240</a></span> | <span class="t">so I'm going to skip the discussion of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4620" target="_blank">01:17:00.280</a></span> | <span class="t">But what OpenAI does here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4621" target="_blank">01:17:01.400</a></span> | <span class="t">for reasons that I don't fully understand,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4623" target="_blank">01:17:03.000</a></span> | <span class="t">is that not only have they this tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4625" target="_blank">01:17:05.720</a></span> | <span class="t">which can encode and decode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4627" target="_blank">01:17:07.200</a></span> | <span class="t">but they have a whole separate layer here in addition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4629" target="_blank">01:17:09.520</a></span> | <span class="t">that is used serially with the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4632" target="_blank">01:17:12.000</a></span> | <span class="t">And so you first do byte encode and then encode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4636" target="_blank">01:17:16.080</a></span> | <span class="t">and then you do decode and then byte decode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4638" target="_blank">01:17:18.560</a></span> | <span class="t">So that's the loop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4639" target="_blank">01:17:19.920</a></span> | <span class="t">and they are just stacked serial on top of each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4642" target="_blank">01:17:22.960</a></span> | <span class="t">And it's not that interesting,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4644" target="_blank">01:17:24.560</a></span> | <span class="t">so I won't cover it, and you can step through it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4646" target="_blank">01:17:26.080</a></span> | <span class="t">if you'd like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4647" target="_blank">01:17:27.360</a></span> | <span class="t">Otherwise, this file,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4648" target="_blank">01:17:28.520</a></span> | <span class="t">if you ignore the byte encoder and the byte decoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4650" target="_blank">01:17:30.800</a></span> | <span class="t">will be algorithmically very familiar with you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4653" target="_blank">01:17:33.120</a></span> | <span class="t">And the meat of it here is what they call BPE function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4657" target="_blank">01:17:37.080</a></span> | <span class="t">And you should recognize this loop here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4659" target="_blank">01:17:39.640</a></span> | <span class="t">which is very similar to our own while loop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4662" target="_blank">01:17:42.040</a></span> | <span class="t">where they're trying to identify the bigram, a pair,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4666" target="_blank">01:17:46.000</a></span> | <span class="t">that they should be merging next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4668" target="_blank">01:17:48.000</a></span> | <span class="t">And then here, just like we had,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4669" target="_blank">01:17:49.680</a></span> | <span class="t">they have a for loop trying to merge this pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4672" target="_blank">01:17:52.320</a></span> | <span class="t">So they will go over all of the sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4674" target="_blank">01:17:54.120</a></span> | <span class="t">and they will merge the pair whenever they find it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4677" target="_blank">01:17:57.080</a></span> | <span class="t">And they keep repeating that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4678" target="_blank">01:17:58.440</a></span> | <span class="t">until they run out of possible merges in the text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4682" target="_blank">01:18:02.240</a></span> | <span class="t">So that's the meat of this file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4683" target="_blank">01:18:03.920</a></span> | <span class="t">And there's an encode and decode function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4686" target="_blank">01:18:06.040</a></span> | <span class="t">just like we have implemented it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4687" target="_blank">01:18:07.880</a></span> | <span class="t">So long story short,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4688" target="_blank">01:18:08.840</a></span> | <span class="t">what I want you to take away at this point is that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4691" target="_blank">01:18:11.040</a></span> | <span class="t">unfortunately, it's a little bit of a messy code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4692" target="_blank">01:18:12.680</a></span> | <span class="t">that they have, but algorithmically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4694" target="_blank">01:18:14.280</a></span> | <span class="t">it is identical to what we've built up above.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4697" target="_blank">01:18:17.080</a></span> | <span class="t">And what we've built up above, if you understand it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4699" target="_blank">01:18:19.440</a></span> | <span class="t">is algorithmically what is necessary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4701" target="_blank">01:18:21.440</a></span> | <span class="t">to actually build a BPE tokenizer, train it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4704" target="_blank">01:18:24.440</a></span> | <span class="t">and then both encode and decode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4706" target="_blank">01:18:26.920</a></span> | <span class="t">The next topic I would like to turn to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4708" target="_blank">01:18:28.280</a></span> | <span class="t">is that of special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4710" target="_blank">01:18:30.360</a></span> | <span class="t">So in addition to tokens that are coming from raw bytes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4713" target="_blank">01:18:33.400</a></span> | <span class="t">and the BPE merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4715" target="_blank">01:18:35.000</a></span> | <span class="t">we can insert all kinds of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4716" target="_blank">01:18:36.480</a></span> | <span class="t">that we are going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4717" target="_blank">01:18:37.480</a></span> | <span class="t">to delimit different parts of the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4719" target="_blank">01:18:39.880</a></span> | <span class="t">or introduce to create a special structure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4722" target="_blank">01:18:42.320</a></span> | <span class="t">of the token streams.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4724" target="_blank">01:18:44.760</a></span> | <span class="t">So if you look at this encoder object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4727" target="_blank">01:18:47.960</a></span> | <span class="t">from OpenAI's GPT-2 right here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4730" target="_blank">01:18:50.920</a></span> | <span class="t">we mentioned this is very similar to our vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4733" target="_blank">01:18:53.280</a></span> | <span class="t">You'll notice that the length of this is 50,257.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4737" target="_blank">01:18:57.560</a></span> | <span class="t">As I mentioned, it's mapping,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4741" target="_blank">01:19:01.920</a></span> | <span class="t">and it's inverted from the mapping of our vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4744" target="_blank">01:19:04.240</a></span> | <span class="t">Our vocab goes from integer to string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4747" target="_blank">01:19:07.000</a></span> | <span class="t">and they go the other way around for no amazing reason.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4750" target="_blank">01:19:10.360</a></span> | <span class="t">But the thing to note here is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4752" target="_blank">01:19:12.880</a></span> | <span class="t">the mapping table here is 50,257.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4756" target="_blank">01:19:16.080</a></span> | <span class="t">Where does that number come from?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4758" target="_blank">01:19:18.120</a></span> | <span class="t">Where are the tokens?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4760" target="_blank">01:19:20.440</a></span> | <span class="t">As I mentioned, there are 256 raw byte tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4763" target="_blank">01:19:23.640</a></span> | <span class="t">And then OpenAI actually did 50,000 merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4768" target="_blank">01:19:28.720</a></span> | <span class="t">So those become the other tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4772" target="_blank">01:19:32.040</a></span> | <span class="t">But this would have been 50,256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4775" target="_blank">01:19:35.040</a></span> | <span class="t">So what is the 57th token?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4777" target="_blank">01:19:37.600</a></span> | <span class="t">And there is basically one special token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4779" target="_blank">01:19:39.680</a></span> | <span class="t">And that one special token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4783" target="_blank">01:19:43.040</a></span> | <span class="t">you can see it's called end of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4786" target="_blank">01:19:46.600</a></span> | <span class="t">So this is a special token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4788" target="_blank">01:19:48.080</a></span> | <span class="t">and it's the very last token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4790" target="_blank">01:19:50.560</a></span> | <span class="t">And this token is used to delimit documents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4793" target="_blank">01:19:53.240</a></span> | <span class="t">in the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4795" target="_blank">01:19:55.040</a></span> | <span class="t">So when we're creating the training data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4797" target="_blank">01:19:57.320</a></span> | <span class="t">we have all these documents,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4798" target="_blank">01:19:58.520</a></span> | <span class="t">and we tokenize them and get a stream of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4801" target="_blank">01:20:01.600</a></span> | <span class="t">Those tokens only range from zero to 50,256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4806" target="_blank">01:20:06.280</a></span> | <span class="t">And then in between those documents,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4808" target="_blank">01:20:08.000</a></span> | <span class="t">we put special end of text token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4810" target="_blank">01:20:10.560</a></span> | <span class="t">And we insert that token in between documents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4814" target="_blank">01:20:14.400</a></span> | <span class="t">And we are using this as a signal to the language model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4817" target="_blank">01:20:17.800</a></span> | <span class="t">that the document has ended,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4819" target="_blank">01:20:19.800</a></span> | <span class="t">and what follows is going to be unrelated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4822" target="_blank">01:20:22.080</a></span> | <span class="t">to the document previously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4824" target="_blank">01:20:24.320</a></span> | <span class="t">That said, the language model has to learn this from data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4826" target="_blank">01:20:26.920</a></span> | <span class="t">It needs to learn that this token usually means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4829" target="_blank">01:20:29.720</a></span> | <span class="t">that it should wipe its sort of memory of what came before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4833" target="_blank">01:20:33.240</a></span> | <span class="t">And what came before this token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4834" target="_blank">01:20:34.520</a></span> | <span class="t">is not actually informative to what comes next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4836" target="_blank">01:20:36.960</a></span> | <span class="t">But we are expecting the language model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4838" target="_blank">01:20:38.240</a></span> | <span class="t">to just like learn this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4839" target="_blank">01:20:39.680</a></span> | <span class="t">but we're giving it the special sort of delimiter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4842" target="_blank">01:20:42.280</a></span> | <span class="t">of these documents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4844" target="_blank">01:20:44.160</a></span> | <span class="t">We can go here to tick tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4845" target="_blank">01:20:45.800</a></span> | <span class="t">and this is the GPT-2 tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4848" target="_blank">01:20:48.800</a></span> | <span class="t">our code that we've been playing with before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4851" target="_blank">01:20:51.080</a></span> | <span class="t">So we can add here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4852" target="_blank">01:20:52.080</a></span> | <span class="t">Hello world, how are you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4854" target="_blank">01:20:54.360</a></span> | <span class="t">And we're getting different tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4855" target="_blank">01:20:55.880</a></span> | <span class="t">But now you can see what happens if I put end of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4859" target="_blank">01:20:59.640</a></span> | <span class="t">You see how until I finished it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4863" target="_blank">01:21:03.200</a></span> | <span class="t">these are all different tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4864" target="_blank">01:21:04.960</a></span> | <span class="t">End of text, still set prefer tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4868" target="_blank">01:21:08.560</a></span> | <span class="t">And now when I finish it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4870" target="_blank">01:21:10.000</a></span> | <span class="t">suddenly we get token 50,256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4874" target="_blank">01:21:14.360</a></span> | <span class="t">And the reason this works is because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4876" target="_blank">01:21:16.920</a></span> | <span class="t">this didn't actually go through the BPE merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4879" target="_blank">01:21:19.960</a></span> | <span class="t">Instead, the code that actually outputs the tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4884" target="_blank">01:21:24.200</a></span> | <span class="t">has special case instructions for handling special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4888" target="_blank">01:21:28.480</a></span> | <span class="t">We did not see these special instructions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4891" target="_blank">01:21:31.520</a></span> | <span class="t">for handling special tokens in the encoder.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4894" target="_blank">01:21:34.840</a></span> | <span class="t">It's absent there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4896" target="_blank">01:21:36.440</a></span> | <span class="t">But if you go to tick token library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4897" target="_blank">01:21:37.960</a></span> | <span class="t">which is implemented in Rust,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4900" target="_blank">01:21:40.520</a></span> | <span class="t">you will find all kinds of special case handling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4902" target="_blank">01:21:42.680</a></span> | <span class="t">for these special tokens that you can register,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4905" target="_blank">01:21:45.680</a></span> | <span class="t">create, add to the vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4908" target="_blank">01:21:48.080</a></span> | <span class="t">and then it looks for them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4909" target="_blank">01:21:49.000</a></span> | <span class="t">and whenever it sees these special tokens like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4912" target="_blank">01:21:52.720</a></span> | <span class="t">it will actually come in and swap in that special token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4915" target="_blank">01:21:55.920</a></span> | <span class="t">So these things are outside of the typical algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4918" target="_blank">01:21:58.760</a></span> | <span class="t">of byte-pair encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4920" target="_blank">01:22:00.280</a></span> | <span class="t">So these special tokens are used pervasively,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4924" target="_blank">01:22:04.040</a></span> | <span class="t">not just in basically base language modeling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4926" target="_blank">01:22:06.840</a></span> | <span class="t">of predicting the next token in the sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4928" target="_blank">01:22:08.880</a></span> | <span class="t">but especially when it gets to later,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4930" target="_blank">01:22:10.520</a></span> | <span class="t">to the fine tuning stage,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4931" target="_blank">01:22:11.840</a></span> | <span class="t">and all of the chat GPT sort of aspects of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4935" target="_blank">01:22:15.440</a></span> | <span class="t">Because we don't just want to delimit documents,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4936" target="_blank">01:22:16.960</a></span> | <span class="t">we want to delimit entire conversations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4938" target="_blank">01:22:18.720</a></span> | <span class="t">between an assistant and a user.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4941" target="_blank">01:22:21.120</a></span> | <span class="t">So if I refresh this tick tokenizer page,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4944" target="_blank">01:22:24.160</a></span> | <span class="t">the default example that they have here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4946" target="_blank">01:22:26.240</a></span> | <span class="t">is using not sort of base model encoders,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4950" target="_blank">01:22:30.080</a></span> | <span class="t">but fine-tuned model sort of tokenizers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4953" target="_blank">01:22:33.240</a></span> | <span class="t">So for example, using the GPT 3.5 turbo scheme,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4957" target="_blank">01:22:37.120</a></span> | <span class="t">these here are all special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4959" target="_blank">01:22:39.520</a></span> | <span class="t">I am start, I am end, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4963" target="_blank">01:22:43.080</a></span> | <span class="t">This is short for imaginary malloc_start, by the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4966" target="_blank">01:22:46.880</a></span> | <span class="t">But you can see here that there's a sort of start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4970" target="_blank">01:22:50.320</a></span> | <span class="t">and end of every single message,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4971" target="_blank">01:22:51.800</a></span> | <span class="t">and there can be many other tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4973" target="_blank">01:22:53.520</a></span> | <span class="t">lots of tokens in use to delimit these conversations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4978" target="_blank">01:22:58.280</a></span> | <span class="t">and kind of keep track of the flow of the messages here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4981" target="_blank">01:23:01.880</a></span> | <span class="t">Now we can go back to the tick token library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4984" target="_blank">01:23:04.800</a></span> | <span class="t">And here, when you scroll to the bottom,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4987" target="_blank">01:23:07.320</a></span> | <span class="t">they talk about how you can extend tick token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4989" target="_blank">01:23:09.320</a></span> | <span class="t">And I can, you can create, basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4991" target="_blank">01:23:11.000</a></span> | <span class="t">you can fork the CL 100K base tokenizers in GPT 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4996" target="_blank">01:23:16.000</a></span> | <span class="t">And for example, you can extend it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4998" target="_blank">01:23:18.280</a></span> | <span class="t">by adding more special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=4999" target="_blank">01:23:19.720</a></span> | <span class="t">And these are totally up to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5000" target="_blank">01:23:20.640</a></span> | <span class="t">You can come up with any arbitrary tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5002" target="_blank">01:23:22.440</a></span> | <span class="t">and add them with a new ID afterwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5005" target="_blank">01:23:25.480</a></span> | <span class="t">And the tick token library will correctly swap them out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5009" target="_blank">01:23:29.360</a></span> | <span class="t">when it sees this in the strings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5011" target="_blank">01:23:31.800</a></span> | <span class="t">Now, we can also go back to this file,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5015" target="_blank">01:23:35.240</a></span> | <span class="t">which we looked at previously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5017" target="_blank">01:23:37.160</a></span> | <span class="t">And I mentioned that the GPT 2 in tick token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5020" target="_blank">01:23:40.040</a></span> | <span class="t">OpenAI public.py, we have the vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5023" target="_blank">01:23:43.600</a></span> | <span class="t">we have the pattern for splitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5025" target="_blank">01:23:45.760</a></span> | <span class="t">And then here we are registering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5026" target="_blank">01:23:46.960</a></span> | <span class="t">the single special token in GPT 2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5028" target="_blank">01:23:48.760</a></span> | <span class="t">which was the end of text token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5030" target="_blank">01:23:50.280</a></span> | <span class="t">And we saw that it has this ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5032" target="_blank">01:23:52.040</a></span> | <span class="t">In GPT 4, when they define this here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5036" target="_blank">01:23:56.400</a></span> | <span class="t">you see that the pattern has changed as we've discussed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5038" target="_blank">01:23:58.600</a></span> | <span class="t">but also the special tokens have changed in this tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5041" target="_blank">01:24:01.240</a></span> | <span class="t">So we, of course, have the end of text, just like in GPT 2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5045" target="_blank">01:24:05.040</a></span> | <span class="t">but we also see three, sorry, four additional tokens here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5048" target="_blank">01:24:08.720</a></span> | <span class="t">Thim prefix, middle, and suffix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5051" target="_blank">01:24:11.000</a></span> | <span class="t">What is thim?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5051" target="_blank">01:24:11.840</a></span> | <span class="t">Thim is short for fill in the middle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5054" target="_blank">01:24:14.560</a></span> | <span class="t">And if you'd like to learn more about this idea,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5057" target="_blank">01:24:17.120</a></span> | <span class="t">it comes from this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5058" target="_blank">01:24:18.360</a></span> | <span class="t">And I'm not gonna go into detail in this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5061" target="_blank">01:24:21.280</a></span> | <span class="t">It's beyond this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5062" target="_blank">01:24:22.640</a></span> | <span class="t">And then there's one additional sort of token here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5066" target="_blank">01:24:26.760</a></span> | <span class="t">So that's that encoding as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5068" target="_blank">01:24:28.640</a></span> | <span class="t">So it's very common, basically, to train a language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5072" target="_blank">01:24:32.880</a></span> | <span class="t">And then if you'd like, you can add special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5076" target="_blank">01:24:36.920</a></span> | <span class="t">Now, when you add special tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5078" target="_blank">01:24:38.400</a></span> | <span class="t">you, of course, have to do some model surgery</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5081" target="_blank">01:24:41.480</a></span> | <span class="t">to the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5082" target="_blank">01:24:42.560</a></span> | <span class="t">and all of the parameters involved in that transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5084" target="_blank">01:24:44.920</a></span> | <span class="t">because you are basically adding an integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5087" target="_blank">01:24:47.000</a></span> | <span class="t">And you wanna make sure that, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5088" target="_blank">01:24:48.320</a></span> | <span class="t">your embedding matrix for the vocabulary tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5091" target="_blank">01:24:51.360</a></span> | <span class="t">has to be extended by adding a row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5093" target="_blank">01:24:53.800</a></span> | <span class="t">And typically, this row would be initialized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5095" target="_blank">01:24:55.800</a></span> | <span class="t">with small random numbers or something like that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5098" target="_blank">01:24:58.360</a></span> | <span class="t">because we need to have a vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5099" target="_blank">01:24:59.560</a></span> | <span class="t">that now stands for that token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5102" target="_blank">01:25:02.520</a></span> | <span class="t">In addition to that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5103" target="_blank">01:25:03.360</a></span> | <span class="t">you have to go to the final layer of the transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5105" target="_blank">01:25:05.000</a></span> | <span class="t">and you have to make sure that that projection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5106" target="_blank">01:25:06.600</a></span> | <span class="t">at the very end into the classifier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5109" target="_blank">01:25:09.000</a></span> | <span class="t">is extended by one as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5110" target="_blank">01:25:10.920</a></span> | <span class="t">So basically, there's some model surgery involved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5113" target="_blank">01:25:13.000</a></span> | <span class="t">that you have to couple with the tokenization changes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5116" target="_blank">01:25:16.400</a></span> | <span class="t">if you are going to add special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5118" target="_blank">01:25:18.840</a></span> | <span class="t">But this is a very common operation that people do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5120" target="_blank">01:25:20.920</a></span> | <span class="t">especially if they'd like to fine-tune the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5123" target="_blank">01:25:23.120</a></span> | <span class="t">for example, taking it from a base model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5124" target="_blank">01:25:24.960</a></span> | <span class="t">to a chat model like chat-gpt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5127" target="_blank">01:25:27.240</a></span> | <span class="t">Okay, so at this point, you should have everything you need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5130" target="_blank">01:25:30.680</a></span> | <span class="t">in order to build your own GPT-4 tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5133" target="_blank">01:25:33.240</a></span> | <span class="t">Now, in the process of developing this lecture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5135" target="_blank">01:25:35.040</a></span> | <span class="t">I've done that, and I've published the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5137" target="_blank">01:25:37.000</a></span> | <span class="t">under this repository, minBPE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5139" target="_blank">01:25:39.880</a></span> | <span class="t">So minBPE looks like this right now as I'm recording,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5143" target="_blank">01:25:43.400</a></span> | <span class="t">but the minBPE repository will probably change quite a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5146" target="_blank">01:25:46.520</a></span> | <span class="t">because I intend to continue working on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5148" target="_blank">01:25:48.680</a></span> | <span class="t">In addition to the minBPE repository,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5151" target="_blank">01:25:51.560</a></span> | <span class="t">I've published this exercise progression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5153" target="_blank">01:25:53.920</a></span> | <span class="t">that you can follow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5155" target="_blank">01:25:55.240</a></span> | <span class="t">So if you go to exercise.md here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5158" target="_blank">01:25:58.120</a></span> | <span class="t">this is sort of me breaking up the task ahead of you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5161" target="_blank">01:26:01.360</a></span> | <span class="t">into four steps that sort of build up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5164" target="_blank">01:26:04.200</a></span> | <span class="t">to what can be a GPT-4 tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5166" target="_blank">01:26:06.640</a></span> | <span class="t">And so feel free to follow these steps exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5169" target="_blank">01:26:09.240</a></span> | <span class="t">and follow a little bit of the guidance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5170" target="_blank">01:26:10.800</a></span> | <span class="t">that I've laid out here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5172" target="_blank">01:26:12.200</a></span> | <span class="t">And anytime you feel stuck,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5174" target="_blank">01:26:14.160</a></span> | <span class="t">just reference the minBPE repository here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5177" target="_blank">01:26:17.040</a></span> | <span class="t">So either the tests could be useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5179" target="_blank">01:26:19.360</a></span> | <span class="t">or the minBPE repository itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5181" target="_blank">01:26:21.520</a></span> | <span class="t">I try to keep the code fairly clean and understandable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5185" target="_blank">01:26:25.040</a></span> | <span class="t">And so feel free to reference it whenever you get stuck.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5189" target="_blank">01:26:29.840</a></span> | <span class="t">In addition to that, basically, once you write it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5194" target="_blank">01:26:34.040</a></span> | <span class="t">you should be able to reproduce this behavior</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5195" target="_blank">01:26:35.640</a></span> | <span class="t">from TicToken.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5196" target="_blank">01:26:36.800</a></span> | <span class="t">So getting the GPT-4 tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5198" target="_blank">01:26:38.840</a></span> | <span class="t">you can take, you can encode the string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5201" target="_blank">01:26:41.320</a></span> | <span class="t">and you should get these tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5202" target="_blank">01:26:42.920</a></span> | <span class="t">And then you can encode and decode the exact same string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5205" target="_blank">01:26:45.040</a></span> | <span class="t">to recover it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5206" target="_blank">01:26:46.440</a></span> | <span class="t">And in addition to all that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5207" target="_blank">01:26:47.560</a></span> | <span class="t">you should be able to implement your own train function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5210" target="_blank">01:26:50.040</a></span> | <span class="t">which TicToken library does not provide.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5212" target="_blank">01:26:52.160</a></span> | <span class="t">It's, again, only inference code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5214" target="_blank">01:26:54.040</a></span> | <span class="t">but you could write your own train, minBPE does it as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5217" target="_blank">01:26:57.800</a></span> | <span class="t">And that will allow you to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5219" target="_blank">01:26:59.280</a></span> | <span class="t">your own token vocabularies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5220" target="_blank">01:27:00.760</a></span> | <span class="t">So here's some of the code inside minBEP, minBPE,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5225" target="_blank">01:27:05.200</a></span> | <span class="t">shows the token vocabularies that you might obtain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5228" target="_blank">01:27:08.720</a></span> | <span class="t">So on the left here, we have the GPT-4 merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5233" target="_blank">01:27:13.560</a></span> | <span class="t">So the first 256 are raw individual bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5237" target="_blank">01:27:17.120</a></span> | <span class="t">And then here I am visualizing the merges</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5238" target="_blank">01:27:18.880</a></span> | <span class="t">that GPT-4 performed during its training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5241" target="_blank">01:27:21.600</a></span> | <span class="t">So the very first merge that GPT-4 did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5244" target="_blank">01:27:24.000</a></span> | <span class="t">was merge two spaces into a single token for two spaces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5248" target="_blank">01:27:28.760</a></span> | <span class="t">And that is a token 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5250" target="_blank">01:27:30.840</a></span> | <span class="t">And so this is the order in which things merged</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5252" target="_blank">01:27:32.680</a></span> | <span class="t">during GPT-4 training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5254" target="_blank">01:27:34.200</a></span> | <span class="t">And this is the merge order that we obtained in minBPE</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5259" target="_blank">01:27:39.120</a></span> | <span class="t">by training a tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5260" target="_blank">01:27:40.680</a></span> | <span class="t">And in this case, I trained it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5261" target="_blank">01:27:41.880</a></span> | <span class="t">on a Wikipedia page of Taylor Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5264" target="_blank">01:27:44.520</a></span> | <span class="t">Not because I'm a Swifty,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5265" target="_blank">01:27:45.520</a></span> | <span class="t">but because that is one of the longest Wikipedia pages,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5269" target="_blank">01:27:49.080</a></span> | <span class="t">apparently, that's available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5270" target="_blank">01:27:50.560</a></span> | <span class="t">But she is pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5272" target="_blank">01:27:52.320</a></span> | <span class="t">And what was I gonna say?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5276" target="_blank">01:27:56.120</a></span> | <span class="t">Yeah, so you can compare these two vocabularies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5278" target="_blank">01:27:58.920</a></span> | <span class="t">And so as an example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5281" target="_blank">01:28:01.240</a></span> | <span class="t">here, GPT-4 merged IN to become IN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5286" target="_blank">01:28:06.120</a></span> | <span class="t">And we've done the exact same thing on this token 259.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5289" target="_blank">01:28:09.960</a></span> | <span class="t">Here, space T becomes space T.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5292" target="_blank">01:28:12.600</a></span> | <span class="t">And that happened for us a little bit later as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5295" target="_blank">01:28:15.160</a></span> | <span class="t">So the difference here is, again, to my understanding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5297" target="_blank">01:28:17.480</a></span> | <span class="t">only a difference of the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5299" target="_blank">01:28:19.480</a></span> | <span class="t">So as an example, because I see a lot of white space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5301" target="_blank">01:28:21.880</a></span> | <span class="t">I expect that GPT-4 probably had a lot of Python code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5304" target="_blank">01:28:24.360</a></span> | <span class="t">in its training set, I'm not sure, for the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5307" target="_blank">01:28:27.640</a></span> | <span class="t">And here we see much less of that, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5310" target="_blank">01:28:30.760</a></span> | <span class="t">in the Wikipedia page.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5312" target="_blank">01:28:32.960</a></span> | <span class="t">So roughly speaking, they look the same,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5314" target="_blank">01:28:34.760</a></span> | <span class="t">and they look the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5315" target="_blank">01:28:35.600</a></span> | <span class="t">because they're running the same algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5317" target="_blank">01:28:37.360</a></span> | <span class="t">And when you train your own,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5318" target="_blank">01:28:38.720</a></span> | <span class="t">you're probably gonna get something similar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5320" target="_blank">01:28:40.800</a></span> | <span class="t">depending on what you train it on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5322" target="_blank">01:28:42.480</a></span> | <span class="t">Okay, so we are now going to move on from TIC token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5324" target="_blank">01:28:44.800</a></span> | <span class="t">and the way that OpenAI tokenizes its strings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5327" target="_blank">01:28:47.680</a></span> | <span class="t">We're going to discuss one more very commonly used library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5330" target="_blank">01:28:50.400</a></span> | <span class="t">for working with tokenization in LLMs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5332" target="_blank">01:28:52.720</a></span> | <span class="t">and that is SentencePiece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5334" target="_blank">01:28:54.840</a></span> | <span class="t">So SentencePiece is very commonly used in language models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5338" target="_blank">01:28:58.840</a></span> | <span class="t">because unlike TIC token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5339" target="_blank">01:28:59.920</a></span> | <span class="t">it can do both training and inference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5342" target="_blank">01:29:02.120</a></span> | <span class="t">and is quite efficient at both.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5344" target="_blank">01:29:04.360</a></span> | <span class="t">It supports a number of algorithms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5345" target="_blank">01:29:05.800</a></span> | <span class="t">for training vocabularies,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5347" target="_blank">01:29:07.760</a></span> | <span class="t">but one of them is the byte-bearing coding algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5350" target="_blank">01:29:10.120</a></span> | <span class="t">that we've been looking at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5351" target="_blank">01:29:11.240</a></span> | <span class="t">So it supports it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5353" target="_blank">01:29:13.240</a></span> | <span class="t">Now, SentencePiece is used both by Lama and Mistral Series</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5356" target="_blank">01:29:16.960</a></span> | <span class="t">and many other models as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5359" target="_blank">01:29:19.120</a></span> | <span class="t">It is on GitHub under Google/SentencePiece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5361" target="_blank">01:29:21.640</a></span> | <span class="t">And the big difference with SentencePiece,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5364" target="_blank">01:29:24.760</a></span> | <span class="t">and we're going to look at example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5366" target="_blank">01:29:26.200</a></span> | <span class="t">because this is kind of hard and subtle to explain,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5369" target="_blank">01:29:29.280</a></span> | <span class="t">is that they think different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5371" target="_blank">01:29:31.000</a></span> | <span class="t">about the order of operations here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5374" target="_blank">01:29:34.480</a></span> | <span class="t">So in the case of TIC token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5376" target="_blank">01:29:36.840</a></span> | <span class="t">we first take our code points in the string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5380" target="_blank">01:29:40.360</a></span> | <span class="t">we encode them using UTF-8 to bytes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5382" target="_blank">01:29:42.640</a></span> | <span class="t">and then we're merging bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5383" target="_blank">01:29:43.880</a></span> | <span class="t">It's fairly straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5385" target="_blank">01:29:45.960</a></span> | <span class="t">For SentencePiece, it works directly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5389" target="_blank">01:29:49.640</a></span> | <span class="t">on the level of the code points themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5391" target="_blank">01:29:51.760</a></span> | <span class="t">So it looks at whatever code points are available</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5393" target="_blank">01:29:53.920</a></span> | <span class="t">in your training set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5395" target="_blank">01:29:55.200</a></span> | <span class="t">and then it starts merging those code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5397" target="_blank">01:29:57.720</a></span> | <span class="t">And the BPE is running on the level of code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5401" target="_blank">01:30:01.600</a></span> | <span class="t">And if you happen to run out of code points,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5405" target="_blank">01:30:05.160</a></span> | <span class="t">so there are maybe some rare code points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5407" target="_blank">01:30:07.400</a></span> | <span class="t">that just don't come up too often,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5408" target="_blank">01:30:08.640</a></span> | <span class="t">and the rarity is determined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5409" target="_blank">01:30:09.800</a></span> | <span class="t">by this character coverage hyperparameter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5412" target="_blank">01:30:12.080</a></span> | <span class="t">then these code points will either get mapped</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5415" target="_blank">01:30:15.200</a></span> | <span class="t">to a special unknown token like onc,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5418" target="_blank">01:30:18.120</a></span> | <span class="t">or if you have the byte fallback option turned on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5421" target="_blank">01:30:21.160</a></span> | <span class="t">then that will take those rare code points,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5423" target="_blank">01:30:23.600</a></span> | <span class="t">it will encode them using UTF-8,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5425" target="_blank">01:30:25.720</a></span> | <span class="t">and then the individual bytes of that encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5427" target="_blank">01:30:27.640</a></span> | <span class="t">will be translated into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5429" target="_blank">01:30:29.800</a></span> | <span class="t">And there are these special byte tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5431" target="_blank">01:30:31.560</a></span> | <span class="t">that basically get added to the vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5434" target="_blank">01:30:34.040</a></span> | <span class="t">So it uses BPE on the code points,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5437" target="_blank">01:30:37.800</a></span> | <span class="t">and then it falls back to bytes for rare code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5441" target="_blank">01:30:41.280</a></span> | <span class="t">And so that's kind of like difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5444" target="_blank">01:30:44.120</a></span> | <span class="t">Personally, I find the tick token way significantly cleaner,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5447" target="_blank">01:30:47.040</a></span> | <span class="t">but it's kind of like a subtle,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5448" target="_blank">01:30:48.200</a></span> | <span class="t">but pretty major difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5449" target="_blank">01:30:49.200</a></span> | <span class="t">between the way they approach tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5451" target="_blank">01:30:51.400</a></span> | <span class="t">Let's work with a concrete example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5452" target="_blank">01:30:52.760</a></span> | <span class="t">because otherwise this is kind of hard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5454" target="_blank">01:30:54.680</a></span> | <span class="t">to get your head around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5457" target="_blank">01:30:57.800</a></span> | <span class="t">So let's work with a concrete example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5460" target="_blank">01:31:00.160</a></span> | <span class="t">This is how we can import sentence piece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5462" target="_blank">01:31:02.760</a></span> | <span class="t">And then here we're going to take,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5464" target="_blank">01:31:04.400</a></span> | <span class="t">I think I took like the description of sentence piece,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5466" target="_blank">01:31:06.440</a></span> | <span class="t">and I just create like a little toy dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5468" target="_blank">01:31:08.600</a></span> | <span class="t">It really likes to have a file,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5469" target="_blank">01:31:09.920</a></span> | <span class="t">so I created a toy.txt file with this content.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5474" target="_blank">01:31:14.000</a></span> | <span class="t">Now, what's kind of a little bit crazy about sentence piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5476" target="_blank">01:31:16.560</a></span> | <span class="t">is that there's a ton of options and configurations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5479" target="_blank">01:31:19.720</a></span> | <span class="t">And the reason this is so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5480" target="_blank">01:31:20.800</a></span> | <span class="t">is because sentence piece has been around,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5482" target="_blank">01:31:22.440</a></span> | <span class="t">I think for a while,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5483" target="_blank">01:31:23.520</a></span> | <span class="t">and it really tries to handle a large diversity of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5486" target="_blank">01:31:26.640</a></span> | <span class="t">And because it's been around,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5488" target="_blank">01:31:28.320</a></span> | <span class="t">I think it has quite a bit of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5489" target="_blank">01:31:29.920</a></span> | <span class="t">accumulated historical baggage as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5493" target="_blank">01:31:33.040</a></span> | <span class="t">And so in particular,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5494" target="_blank">01:31:34.120</a></span> | <span class="t">there's like a ton of configuration arguments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5496" target="_blank">01:31:36.440</a></span> | <span class="t">This is not even all of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5498" target="_blank">01:31:38.160</a></span> | <span class="t">You can go to here to see all the training options.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5502" target="_blank">01:31:42.560</a></span> | <span class="t">And there's also quite useful documentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5505" target="_blank">01:31:45.400</a></span> | <span class="t">when you look at the raw protobuf</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5507" target="_blank">01:31:47.480</a></span> | <span class="t">that is used to represent the trainer spec and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5510" target="_blank">01:31:50.680</a></span> | <span class="t">Many of these options are irrelevant to us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5514" target="_blank">01:31:54.720</a></span> | <span class="t">So maybe to point out one example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5516" target="_blank">01:31:56.720</a></span> | <span class="t">dash dash shrinking factor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5518" target="_blank">01:31:58.760</a></span> | <span class="t">This shrinking factor is not used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5520" target="_blank">01:32:00.800</a></span> | <span class="t">in the byte bearing coding algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5522" target="_blank">01:32:02.200</a></span> | <span class="t">So this is just an argument that is irrelevant to us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5525" target="_blank">01:32:05.840</a></span> | <span class="t">It applies to a different training algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5528" target="_blank">01:32:08.080</a></span> | <span class="t">Now, what I tried to do here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5531" target="_blank">01:32:11.760</a></span> | <span class="t">is I tried to set up sentence piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5533" target="_blank">01:32:13.680</a></span> | <span class="t">in a way that is very, very similar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5535" target="_blank">01:32:15.440</a></span> | <span class="t">as far as I can tell,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5536" target="_blank">01:32:16.640</a></span> | <span class="t">to maybe identical, hopefully,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5538" target="_blank">01:32:18.920</a></span> | <span class="t">to the way that Llama2 was trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5541" target="_blank">01:32:21.680</a></span> | <span class="t">So the way they trained their own tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5546" target="_blank">01:32:26.120</a></span> | <span class="t">And the way I did this was basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5547" target="_blank">01:32:27.520</a></span> | <span class="t">you can take the tokenizer.model file that Meta released,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5551" target="_blank">01:32:31.160</a></span> | <span class="t">and you can open it using the protobuf</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5555" target="_blank">01:32:35.360</a></span> | <span class="t">sort of file that you can generate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5558" target="_blank">01:32:38.400</a></span> | <span class="t">And then you can inspect all the options.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5559" target="_blank">01:32:39.880</a></span> | <span class="t">And I tried to copy over all the options</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5561" target="_blank">01:32:41.520</a></span> | <span class="t">that looked relevant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5562" target="_blank">01:32:42.960</a></span> | <span class="t">So here we set up the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5564" target="_blank">01:32:44.560</a></span> | <span class="t">It's a raw text in this file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5566" target="_blank">01:32:46.680</a></span> | <span class="t">Here's gonna be the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5567" target="_blank">01:32:47.960</a></span> | <span class="t">So it's gonna be protoc400.model and .vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5571" target="_blank">01:32:51.520</a></span> | <span class="t">We're saying that we're gonna use the BP algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5574" target="_blank">01:32:54.240</a></span> | <span class="t">and we want to vocab size of 400.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5575" target="_blank">01:32:55.960</a></span> | <span class="t">Then there's a ton of configurations here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5579" target="_blank">01:32:59.160</a></span> | <span class="t">for basically preprocessing and normalization rules,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5586" target="_blank">01:33:06.240</a></span> | <span class="t">as they're called.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5587" target="_blank">01:33:07.240</a></span> | <span class="t">Normalization used to be very prevalent,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5589" target="_blank">01:33:09.600</a></span> | <span class="t">I would say, before LLMs in natural language processing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5592" target="_blank">01:33:12.360</a></span> | <span class="t">So in machine translation and text classification and so on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5595" target="_blank">01:33:15.800</a></span> | <span class="t">you want to normalize and simplify the text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5597" target="_blank">01:33:17.640</a></span> | <span class="t">and you wanna turn it all lowercase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5598" target="_blank">01:33:18.960</a></span> | <span class="t">and you wanna remove all double whitespace, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5602" target="_blank">01:33:22.240</a></span> | <span class="t">And in language models, we prefer not to do any of it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5604" target="_blank">01:33:24.640</a></span> | <span class="t">or at least that is my preference as a deep learning person.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5606" target="_blank">01:33:26.960</a></span> | <span class="t">You want to not touch your data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5608" target="_blank">01:33:28.400</a></span> | <span class="t">You want to keep the raw data as much as possible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5611" target="_blank">01:33:31.800</a></span> | <span class="t">in a raw form.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5613" target="_blank">01:33:33.200</a></span> | <span class="t">So you're basically trying to turn off a lot of this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5616" target="_blank">01:33:36.200</a></span> | <span class="t">if you can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5617" target="_blank">01:33:37.840</a></span> | <span class="t">The other thing that sentence piece does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5619" target="_blank">01:33:39.280</a></span> | <span class="t">is that it has this concept of sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5621" target="_blank">01:33:41.720</a></span> | <span class="t">So sentence piece, it's back,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5625" target="_blank">01:33:45.200</a></span> | <span class="t">it kind of like was developed, I think,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5626" target="_blank">01:33:46.440</a></span> | <span class="t">early in the days where there was an idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5630" target="_blank">01:33:50.080</a></span> | <span class="t">that you're training a tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5631" target="_blank">01:33:51.840</a></span> | <span class="t">on a bunch of independent sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5633" target="_blank">01:33:53.800</a></span> | <span class="t">So it has a lot of like how many sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5636" target="_blank">01:33:56.400</a></span> | <span class="t">you're gonna train on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5637" target="_blank">01:33:57.360</a></span> | <span class="t">what is the maximum sentence length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5639" target="_blank">01:33:59.160</a></span> | <span class="t">shuffling sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5643" target="_blank">01:34:03.160</a></span> | <span class="t">And so for it, sentences are kind of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5644" target="_blank">01:34:04.840</a></span> | <span class="t">the individual training examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5646" target="_blank">01:34:06.600</a></span> | <span class="t">But again, in the context of LLMs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5648" target="_blank">01:34:08.160</a></span> | <span class="t">I find that this is like a very spurious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5650" target="_blank">01:34:10.000</a></span> | <span class="t">and weird distinction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5651" target="_blank">01:34:11.320</a></span> | <span class="t">Like sentences are just like, don't touch the raw data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5655" target="_blank">01:34:15.080</a></span> | <span class="t">Sentences happen to exist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5656" target="_blank">01:34:16.920</a></span> | <span class="t">But in the raw data sets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5658" target="_blank">01:34:18.760</a></span> | <span class="t">there are a lot of like in-betweens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5660" target="_blank">01:34:20.200</a></span> | <span class="t">like what exactly is a sentence?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5661" target="_blank">01:34:21.800</a></span> | <span class="t">What isn't a sentence?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5663" target="_blank">01:34:23.160</a></span> | <span class="t">And so I think like, it's really hard to define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5665" target="_blank">01:34:25.920</a></span> | <span class="t">what an actual sentence is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5667" target="_blank">01:34:27.560</a></span> | <span class="t">if you really like dig into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5669" target="_blank">01:34:29.360</a></span> | <span class="t">And there could be different concepts of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5671" target="_blank">01:34:31.320</a></span> | <span class="t">in different languages or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5672" target="_blank">01:34:32.800</a></span> | <span class="t">So why even introduce the concept?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5674" target="_blank">01:34:34.720</a></span> | <span class="t">It doesn't honestly make sense to me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5676" target="_blank">01:34:36.600</a></span> | <span class="t">I would just prefer to treat a file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5678" target="_blank">01:34:38.440</a></span> | <span class="t">as a giant stream of bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5680" target="_blank">01:34:40.400</a></span> | <span class="t">It has a lot of treatment around rare word characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5684" target="_blank">01:34:44.400</a></span> | <span class="t">And when I say word, I mean, code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5686" target="_blank">01:34:46.120</a></span> | <span class="t">We're gonna come back to this in a second.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5688" target="_blank">01:34:48.320</a></span> | <span class="t">And it has a lot of other rules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5689" target="_blank">01:34:49.600</a></span> | <span class="t">for basically splitting digits,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5693" target="_blank">01:34:53.000</a></span> | <span class="t">splitting white space and numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5695" target="_blank">01:34:55.240</a></span> | <span class="t">and how you deal with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5696" target="_blank">01:34:56.520</a></span> | <span class="t">So these are some kind of like merge rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5699" target="_blank">01:34:59.120</a></span> | <span class="t">So I think this is a little bit equivalent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5700" target="_blank">01:35:00.600</a></span> | <span class="t">to tick token using the regular expression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5703" target="_blank">01:35:03.760</a></span> | <span class="t">to split up categories.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5705" target="_blank">01:35:05.480</a></span> | <span class="t">There's like kind of equivalence of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5707" target="_blank">01:35:07.920</a></span> | <span class="t">if you squint at it in sentence piece,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5709" target="_blank">01:35:09.960</a></span> | <span class="t">where you can also, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5711" target="_blank">01:35:11.000</a></span> | <span class="t">split up the digits and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5715" target="_blank">01:35:15.520</a></span> | <span class="t">There's a few more things here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5718" target="_blank">01:35:18.040</a></span> | <span class="t">that I'll come back to in a bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5719" target="_blank">01:35:19.280</a></span> | <span class="t">And then there are some special tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5720" target="_blank">01:35:20.440</a></span> | <span class="t">that you can indicate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5721" target="_blank">01:35:21.640</a></span> | <span class="t">And it hardcodes the UNCTOKEN,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5724" target="_blank">01:35:24.040</a></span> | <span class="t">the beginning of sentence, end of sentence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5726" target="_blank">01:35:26.280</a></span> | <span class="t">and a PAT token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5727" target="_blank">01:35:27.440</a></span> | <span class="t">And the UNCTOKEN must exist from my understanding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5731" target="_blank">01:35:31.720</a></span> | <span class="t">And there's some systems things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5733" target="_blank">01:35:33.920</a></span> | <span class="t">So we can train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5735" target="_blank">01:35:35.800</a></span> | <span class="t">And when I press train,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5737" target="_blank">01:35:37.240</a></span> | <span class="t">it's going to create this file,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5739" target="_blank">01:35:39.320</a></span> | <span class="t">talk400.model and talk400.vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5742" target="_blank">01:35:42.400</a></span> | <span class="t">I can then load the model file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5744" target="_blank">01:35:44.520</a></span> | <span class="t">and I can inspect the vocabulary of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5747" target="_blank">01:35:47.440</a></span> | <span class="t">And so we trained vocab size 400 on this text here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5752" target="_blank">01:35:52.280</a></span> | <span class="t">And these are the individual pieces,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5755" target="_blank">01:35:55.000</a></span> | <span class="t">the individual tokens that sentence piece will create.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5758" target="_blank">01:35:58.000</a></span> | <span class="t">So in the beginning,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5758" target="_blank">01:35:58.840</a></span> | <span class="t">we see that we have the UNCTOKEN with the ID zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5763" target="_blank">01:36:03.080</a></span> | <span class="t">Then we have the beginning of sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5764" target="_blank">01:36:04.880</a></span> | <span class="t">end of sequence, one and two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5767" target="_blank">01:36:07.720</a></span> | <span class="t">And then we said that the PAT ID is negative one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5769" target="_blank">01:36:09.600</a></span> | <span class="t">So we chose not to use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5771" target="_blank">01:36:11.800</a></span> | <span class="t">So there's no PAT ID here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5773" target="_blank">01:36:13.280</a></span> | <span class="t">Then these are individual byte tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5777" target="_blank">01:36:17.840</a></span> | <span class="t">So here we saw that byte fallback in llama was turned on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5782" target="_blank">01:36:22.120</a></span> | <span class="t">So it's true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5783" target="_blank">01:36:23.480</a></span> | <span class="t">So what follows are going to be the 256 byte tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5787" target="_blank">01:36:27.520</a></span> | <span class="t">And these are their IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5792" target="_blank">01:36:32.880</a></span> | <span class="t">And then at the bottom,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5794" target="_blank">01:36:34.760</a></span> | <span class="t">after the byte tokens come the merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5797" target="_blank">01:36:37.720</a></span> | <span class="t">And these are the parent nodes in the merges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5801" target="_blank">01:36:41.560</a></span> | <span class="t">So we're not seeing the children,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5802" target="_blank">01:36:42.640</a></span> | <span class="t">we're just seeing the parents and their ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5804" target="_blank">01:36:44.800</a></span> | <span class="t">And then after the merges comes eventually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5809" target="_blank">01:36:49.080</a></span> | <span class="t">the individual tokens and their IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5813" target="_blank">01:36:53.120</a></span> | <span class="t">And so these are the individual tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5814" target="_blank">01:36:54.560</a></span> | <span class="t">So these are the individual code point tokens, if you will,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5818" target="_blank">01:36:58.360</a></span> | <span class="t">and they come at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5819" target="_blank">01:36:59.880</a></span> | <span class="t">So that is the ordering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5820" target="_blank">01:37:00.840</a></span> | <span class="t">with which sentence piece sort of like represents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5822" target="_blank">01:37:02.840</a></span> | <span class="t">its vocabularies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5823" target="_blank">01:37:03.800</a></span> | <span class="t">It starts with special tokens, then the byte tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5826" target="_blank">01:37:06.840</a></span> | <span class="t">then the merge tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5828" target="_blank">01:37:08.000</a></span> | <span class="t">and then the individual code point tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5830" target="_blank">01:37:10.640</a></span> | <span class="t">And all these raw code point tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5833" target="_blank">01:37:13.640</a></span> | <span class="t">are the ones that it encountered in the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5837" target="_blank">01:37:17.080</a></span> | <span class="t">So those individual code points are all the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5840" target="_blank">01:37:20.720</a></span> | <span class="t">the entire set of code points that occurred here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5843" target="_blank">01:37:23.240</a></span> | <span class="t">So those all get put in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5847" target="_blank">01:37:27.360</a></span> | <span class="t">And then those that are extremely rare</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5849" target="_blank">01:37:29.160</a></span> | <span class="t">as determined by character coverage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5850" target="_blank">01:37:30.840</a></span> | <span class="t">So if a code point occurred only a single time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5852" target="_blank">01:37:32.640</a></span> | <span class="t">out of like a million sentences or something like that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5856" target="_blank">01:37:36.200</a></span> | <span class="t">then it would be ignored</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5857" target="_blank">01:37:37.840</a></span> | <span class="t">and it would not be added to our vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5861" target="_blank">01:37:41.120</a></span> | <span class="t">Once we have a vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5863" target="_blank">01:37:43.280</a></span> | <span class="t">we can encode into IDs and we can sort of get a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5867" target="_blank">01:37:47.520</a></span> | <span class="t">And then here I am also decoding the individual tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5873" target="_blank">01:37:53.080</a></span> | <span class="t">back into little pieces as they call it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5875" target="_blank">01:37:55.720</a></span> | <span class="t">So let's take a look at what happened here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5878" target="_blank">01:37:58.920</a></span> | <span class="t">Hello, space, (speaking in foreign language)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5882" target="_blank">01:38:02.000</a></span> | <span class="t">So these are the token IDs we got back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5885" target="_blank">01:38:05.560</a></span> | <span class="t">And when we look here, a few things sort of jumped to mind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5890" target="_blank">01:38:10.400</a></span> | <span class="t">Number one, take a look at these characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5894" target="_blank">01:38:14.160</a></span> | <span class="t">The Korean characters, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5895" target="_blank">01:38:15.320</a></span> | <span class="t">were not part of the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5897" target="_blank">01:38:17.080</a></span> | <span class="t">So sentence piece is encountering code points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5899" target="_blank">01:38:19.560</a></span> | <span class="t">that it has not seen during training time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5902" target="_blank">01:38:22.120</a></span> | <span class="t">And those code points do not have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5904" target="_blank">01:38:24.080</a></span> | <span class="t">a token associated with them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5905" target="_blank">01:38:25.840</a></span> | <span class="t">So suddenly these are unk tokens, unknown tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5909" target="_blank">01:38:29.760</a></span> | <span class="t">But because byte fallback is true,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5912" target="_blank">01:38:32.320</a></span> | <span class="t">instead, sentence piece falls back to bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5915" target="_blank">01:38:35.720</a></span> | <span class="t">And so it takes this, it encodes it with UTF-8,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5919" target="_blank">01:38:39.640</a></span> | <span class="t">and then it uses these tokens to represent those bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5924" target="_blank">01:38:44.240</a></span> | <span class="t">And that's what we are getting sort of here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5927" target="_blank">01:38:47.960</a></span> | <span class="t">This is the UTF-8 encoding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5930" target="_blank">01:38:50.640</a></span> | <span class="t">and it is shifted by three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5932" target="_blank">01:38:52.880</a></span> | <span class="t">because of these special tokens here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5936" target="_blank">01:38:56.280</a></span> | <span class="t">that have IDs earlier on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5938" target="_blank">01:38:58.400</a></span> | <span class="t">So that's what happened here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5940" target="_blank">01:39:00.400</a></span> | <span class="t">Now, one more thing that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5942" target="_blank">01:39:02.960</a></span> | <span class="t">well, first, before I go on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5945" target="_blank">01:39:05.200</a></span> | <span class="t">with respect to the byte fallback,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5946" target="_blank">01:39:06.840</a></span> | <span class="t">let me remove byte fallback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5949" target="_blank">01:39:09.240</a></span> | <span class="t">If this is false, what's gonna happen?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5951" target="_blank">01:39:11.680</a></span> | <span class="t">Let's retrain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5952" target="_blank">01:39:12.520</a></span> | <span class="t">So the first thing that happened</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5954" target="_blank">01:39:14.520</a></span> | <span class="t">is all of the byte tokens disappeared, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5957" target="_blank">01:39:17.320</a></span> | <span class="t">And now we just have the merges,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5958" target="_blank">01:39:18.840</a></span> | <span class="t">and we have a lot more merges now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5960" target="_blank">01:39:20.240</a></span> | <span class="t">because we have a lot more space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5961" target="_blank">01:39:21.360</a></span> | <span class="t">because we're not taking up space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5963" target="_blank">01:39:23.240</a></span> | <span class="t">in the vocab size with all the bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5966" target="_blank">01:39:26.960</a></span> | <span class="t">And now if we encode this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5968" target="_blank">01:39:28.880</a></span> | <span class="t">we get a zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5971" target="_blank">01:39:31.960</a></span> | <span class="t">So this entire string here suddenly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5973" target="_blank">01:39:33.840</a></span> | <span class="t">there's no byte fallback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5974" target="_blank">01:39:34.960</a></span> | <span class="t">So this is unknown, and unknown is UNK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5979" target="_blank">01:39:39.000</a></span> | <span class="t">And so this is zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5980" target="_blank">01:39:40.400</a></span> | <span class="t">because the UNK token is token zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5983" target="_blank">01:39:43.200</a></span> | <span class="t">And you have to keep in mind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5984" target="_blank">01:39:44.960</a></span> | <span class="t">that this would feed into your language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5987" target="_blank">01:39:47.720</a></span> | <span class="t">So what is the language model supposed to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5989" target="_blank">01:39:49.240</a></span> | <span class="t">when all kinds of different things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5991" target="_blank">01:39:51.000</a></span> | <span class="t">that are unrecognized because they're rare</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5993" target="_blank">01:39:53.000</a></span> | <span class="t">just end up mapping into UNK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5994" target="_blank">01:39:54.880</a></span> | <span class="t">It's not exactly the property that you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5997" target="_blank">01:39:57.080</a></span> | <span class="t">So that's why I think Lama correctly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=5999" target="_blank">01:39:59.480</a></span> | <span class="t">used byte fallback true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6002" target="_blank">01:40:02.160</a></span> | <span class="t">because we definitely want to feed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6003" target="_blank">01:40:03.640</a></span> | <span class="t">these unknown or rare code points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6006" target="_blank">01:40:06.120</a></span> | <span class="t">into the model in some manner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6008" target="_blank">01:40:08.600</a></span> | <span class="t">The next thing I wanna show you is the following.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6011" target="_blank">01:40:11.720</a></span> | <span class="t">Notice here when we are decoding all the individual tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6014" target="_blank">01:40:14.640</a></span> | <span class="t">you see how spaces, space here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6017" target="_blank">01:40:17.760</a></span> | <span class="t">ends up being this bold underline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6020" target="_blank">01:40:20.920</a></span> | <span class="t">I'm not 100% sure, by the way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6022" target="_blank">01:40:22.320</a></span> | <span class="t">why sentence piece switches whitespace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6024" target="_blank">01:40:24.240</a></span> | <span class="t">into these bold underscore characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6027" target="_blank">01:40:27.240</a></span> | <span class="t">Maybe it's for visualization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6028" target="_blank">01:40:28.400</a></span> | <span class="t">I'm not 100% sure why that happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6030" target="_blank">01:40:30.920</a></span> | <span class="t">But notice this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6032" target="_blank">01:40:32.040</a></span> | <span class="t">Why do we have an extra space in the front of hello?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6037" target="_blank">01:40:37.040</a></span> | <span class="t">What is this coming from?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6040" target="_blank">01:40:40.560</a></span> | <span class="t">Well, it's coming from this option here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6042" target="_blank">01:40:42.800</a></span> | <span class="t">Add dummy prefix is true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6048" target="_blank">01:40:48.120</a></span> | <span class="t">And when you go to the documentation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6050" target="_blank">01:40:50.720</a></span> | <span class="t">add dummy whitespace at the beginning of text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6052" target="_blank">01:40:52.640</a></span> | <span class="t">in order to treat world in world</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6054" target="_blank">01:40:54.920</a></span> | <span class="t">and hello world in the exact same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6057" target="_blank">01:40:57.240</a></span> | <span class="t">So what this is trying to do is the following.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6060" target="_blank">01:41:00.280</a></span> | <span class="t">If we go back to our tick tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6062" target="_blank">01:41:02.120</a></span> | <span class="t">world as a token by itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6066" target="_blank">01:41:06.400</a></span> | <span class="t">has a different ID than space world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6070" target="_blank">01:41:10.040</a></span> | <span class="t">So we have, this is 1917, but this is 14, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6074" target="_blank">01:41:14.720</a></span> | <span class="t">So these are two different tokens for the language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6077" target="_blank">01:41:17.000</a></span> | <span class="t">And the language model has to learn from data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6078" target="_blank">01:41:18.720</a></span> | <span class="t">that they are actually kind of like a very similar concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6081" target="_blank">01:41:21.200</a></span> | <span class="t">So to the language model in the tick token world,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6084" target="_blank">01:41:24.080</a></span> | <span class="t">basically words in the beginning of sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6087" target="_blank">01:41:27.000</a></span> | <span class="t">and words in the middle of sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6088" target="_blank">01:41:28.560</a></span> | <span class="t">actually look completely different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6090" target="_blank">01:41:30.320</a></span> | <span class="t">And it has learned that they are roughly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6094" target="_blank">01:41:34.400</a></span> | <span class="t">So this add dummy prefix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6096" target="_blank">01:41:36.480</a></span> | <span class="t">is trying to fight that a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6098" target="_blank">01:41:38.440</a></span> | <span class="t">And the way that works is that it basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6100" target="_blank">01:41:40.800</a></span> | <span class="t">adds a dummy prefix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6103" target="_blank">01:41:43.880</a></span> | <span class="t">So as a part of pre-processing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6108" target="_blank">01:41:48.600</a></span> | <span class="t">it will take the string and it will add a space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6111" target="_blank">01:41:51.160</a></span> | <span class="t">It will do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6112" target="_blank">01:41:52.920</a></span> | <span class="t">And that's done in an effort to make this world</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6116" target="_blank">01:41:56.320</a></span> | <span class="t">and that world the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6117" target="_blank">01:41:57.600</a></span> | <span class="t">They will both be space world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6119" target="_blank">01:41:59.960</a></span> | <span class="t">So that's one other kind of pre-processing option</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6122" target="_blank">01:42:02.120</a></span> | <span class="t">that is turned on and Llama2 also uses this option.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6126" target="_blank">01:42:06.800</a></span> | <span class="t">And that's I think everything that I wanna say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6128" target="_blank">01:42:08.360</a></span> | <span class="t">from my preview of sentence piece and how it is different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6131" target="_blank">01:42:11.880</a></span> | <span class="t">Maybe here what I've done is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6134" target="_blank">01:42:14.040</a></span> | <span class="t">I just put in the raw protocol buffer representation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6138" target="_blank">01:42:18.480</a></span> | <span class="t">basically of the tokenizer, the Llama2 trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6142" target="_blank">01:42:22.280</a></span> | <span class="t">So feel free to sort of step through this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6144" target="_blank">01:42:24.520</a></span> | <span class="t">And if you would like your tokenization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6146" target="_blank">01:42:26.560</a></span> | <span class="t">to look identical to that of the meta Llama2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6150" target="_blank">01:42:30.360</a></span> | <span class="t">then you would be copy pasting these settings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6152" target="_blank">01:42:32.080</a></span> | <span class="t">as I've tried to do up above.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6154" target="_blank">01:42:34.000</a></span> | <span class="t">And yeah, I think that's it for this section.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6157" target="_blank">01:42:37.800</a></span> | <span class="t">I think my summary for sentence piece from all this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6160" target="_blank">01:42:40.200</a></span> | <span class="t">is number one, I think that there's a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6162" target="_blank">01:42:42.400</a></span> | <span class="t">of historical baggage in sentence piece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6164" target="_blank">01:42:44.240</a></span> | <span class="t">A lot of concepts that I think are slightly confusing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6166" target="_blank">01:42:46.840</a></span> | <span class="t">and I think potentially contain foot guns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6169" target="_blank">01:42:49.200</a></span> | <span class="t">like this concept of a sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6170" target="_blank">01:42:50.600</a></span> | <span class="t">and its maximum length and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6172" target="_blank">01:42:52.760</a></span> | <span class="t">Otherwise it is fairly commonly used in the industry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6176" target="_blank">01:42:56.640</a></span> | <span class="t">because it is efficient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6178" target="_blank">01:42:58.920</a></span> | <span class="t">and can do both training and inference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6181" target="_blank">01:43:01.160</a></span> | <span class="t">It has a few quirks, like for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6182" target="_blank">01:43:02.920</a></span> | <span class="t">on token must exist and the way the byte fallbacks are done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6185" target="_blank">01:43:05.880</a></span> | <span class="t">and so on, I don't find particularly elegant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6188" target="_blank">01:43:08.320</a></span> | <span class="t">And unfortunately I have to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6189" target="_blank">01:43:09.360</a></span> | <span class="t">it's not very well documented.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6190" target="_blank">01:43:10.480</a></span> | <span class="t">So it took me a lot of time working with this myself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6193" target="_blank">01:43:13.760</a></span> | <span class="t">and just visualizing things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6195" target="_blank">01:43:15.760</a></span> | <span class="t">and try to really understand what is happening here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6197" target="_blank">01:43:17.760</a></span> | <span class="t">because the documentation, unfortunately,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6200" target="_blank">01:43:20.360</a></span> | <span class="t">is in my opinion, not super amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6202" target="_blank">01:43:22.720</a></span> | <span class="t">But it is a very nice repo that is available to you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6205" target="_blank">01:43:25.840</a></span> | <span class="t">if you'd like to train your own tokenizer right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6208" target="_blank">01:43:28.200</a></span> | <span class="t">Okay, let me now switch gears again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6209" target="_blank">01:43:29.560</a></span> | <span class="t">as we're starting to slowly wrap up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6211" target="_blank">01:43:31.640</a></span> | <span class="t">I want to revisit this issue in a bit more detail</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6213" target="_blank">01:43:33.840</a></span> | <span class="t">of how we should set the vocab size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6215" target="_blank">01:43:35.680</a></span> | <span class="t">and what are some of the considerations around it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6218" target="_blank">01:43:38.160</a></span> | <span class="t">So for this, I'd like to go back to the model architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6221" target="_blank">01:43:41.360</a></span> | <span class="t">that we developed in the last video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6223" target="_blank">01:43:43.080</a></span> | <span class="t">when we built the GPT from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6225" target="_blank">01:43:45.680</a></span> | <span class="t">So this here was the file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6227" target="_blank">01:43:47.480</a></span> | <span class="t">that we built in the previous video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6229" target="_blank">01:43:49.000</a></span> | <span class="t">and we defined the transformer model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6230" target="_blank">01:43:50.680</a></span> | <span class="t">and let's specifically look at vocab size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6232" target="_blank">01:43:52.800</a></span> | <span class="t">and where it appears in this file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6234" target="_blank">01:43:54.820</a></span> | <span class="t">So here we define the vocab size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6236" target="_blank">01:43:56.560</a></span> | <span class="t">At this time it was 65 or something like that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6239" target="_blank">01:43:59.640</a></span> | <span class="t">extremely small number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6240" target="_blank">01:44:00.720</a></span> | <span class="t">So this will grow much larger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6243" target="_blank">01:44:03.160</a></span> | <span class="t">You'll see that vocab size doesn't come up too much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6244" target="_blank">01:44:04.980</a></span> | <span class="t">in most of these layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6246" target="_blank">01:44:06.160</a></span> | <span class="t">The only place that it comes up to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6248" target="_blank">01:44:08.240</a></span> | <span class="t">is in exactly these two places here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6250" target="_blank">01:44:10.920</a></span> | <span class="t">So when we define the language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6253" target="_blank">01:44:13.280</a></span> | <span class="t">there's the token embedding table,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6255" target="_blank">01:44:15.200</a></span> | <span class="t">which is this two-dimensional array</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6257" target="_blank">01:44:17.320</a></span> | <span class="t">where the vocab size is basically the number of rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6260" target="_blank">01:44:20.620</a></span> | <span class="t">and each vocabulary element, each token has a vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6265" target="_blank">01:44:25.000</a></span> | <span class="t">that we're going to train using backpropagation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6267" target="_blank">01:44:27.240</a></span> | <span class="t">That vector is of size and embed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6268" target="_blank">01:44:28.920</a></span> | <span class="t">which is number of channels in the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6271" target="_blank">01:44:31.440</a></span> | <span class="t">And basically as vocab size increases,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6273" target="_blank">01:44:33.560</a></span> | <span class="t">this embedding table, as I mentioned earlier,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6275" target="_blank">01:44:35.760</a></span> | <span class="t">is going to also grow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6276" target="_blank">01:44:36.680</a></span> | <span class="t">We're going to be adding rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6278" target="_blank">01:44:38.680</a></span> | <span class="t">In addition to that, at the end of the transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6281" target="_blank">01:44:41.080</a></span> | <span class="t">there's this LM head layer, which is a linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6284" target="_blank">01:44:44.240</a></span> | <span class="t">And you'll notice that that layer is used at the very end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6287" target="_blank">01:44:47.000</a></span> | <span class="t">to produce the logits, which become the probabilities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6289" target="_blank">01:44:49.840</a></span> | <span class="t">for the next token in a sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6291" target="_blank">01:44:51.520</a></span> | <span class="t">And so intuitively, we're trying to produce a probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6294" target="_blank">01:44:54.520</a></span> | <span class="t">for every single token that might come next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6297" target="_blank">01:44:57.240</a></span> | <span class="t">at every point in time of that transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6300" target="_blank">01:45:00.240</a></span> | <span class="t">And if we have more and more tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6302" target="_blank">01:45:02.000</a></span> | <span class="t">we need to produce more and more probabilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6304" target="_blank">01:45:04.360</a></span> | <span class="t">So every single token is going to introduce</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6306" target="_blank">01:45:06.160</a></span> | <span class="t">an additional dot product that we have to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6308" target="_blank">01:45:08.600</a></span> | <span class="t">here in this linear layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6309" target="_blank">01:45:09.880</a></span> | <span class="t">for this final layer in the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6312" target="_blank">01:45:12.440</a></span> | <span class="t">So why can't vocab size be infinite?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6315" target="_blank">01:45:15.340</a></span> | <span class="t">Why can't we grow to infinity?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6316" target="_blank">01:45:16.560</a></span> | <span class="t">Well, number one, your token embedding table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6318" target="_blank">01:45:18.520</a></span> | <span class="t">is going to grow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6319" target="_blank">01:45:19.840</a></span> | <span class="t">Your linear layer is going to grow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6323" target="_blank">01:45:23.000</a></span> | <span class="t">So we're going to be doing a lot more computation here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6325" target="_blank">01:45:25.140</a></span> | <span class="t">because this LM head layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6326" target="_blank">01:45:26.280</a></span> | <span class="t">will become more computational expensive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6328" target="_blank">01:45:28.740</a></span> | <span class="t">Number two, because we have more parameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6330" target="_blank">01:45:30.600</a></span> | <span class="t">we could be worried that we are going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6332" target="_blank">01:45:32.640</a></span> | <span class="t">under-training some of these parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6335" target="_blank">01:45:35.440</a></span> | <span class="t">So intuitively, if you have a very large vocabulary size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6338" target="_blank">01:45:38.560</a></span> | <span class="t">say we have a million tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6340" target="_blank">01:45:40.800</a></span> | <span class="t">then every one of these tokens is going to come up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6342" target="_blank">01:45:42.480</a></span> | <span class="t">more and more rarely in the training data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6345" target="_blank">01:45:45.080</a></span> | <span class="t">because there's a lot more other tokens all over the place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6347" target="_blank">01:45:47.600</a></span> | <span class="t">And so we're going to be seeing fewer and fewer examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6351" target="_blank">01:45:51.080</a></span> | <span class="t">for each individual token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6352" target="_blank">01:45:52.960</a></span> | <span class="t">And you might be worried that basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6354" target="_blank">01:45:54.320</a></span> | <span class="t">the vectors associated with every token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6356" target="_blank">01:45:56.080</a></span> | <span class="t">will be under-trained as a result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6357" target="_blank">01:45:57.760</a></span> | <span class="t">because they just don't come up too often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6359" target="_blank">01:45:59.760</a></span> | <span class="t">and they don't participate in the forward-backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6362" target="_blank">01:46:02.460</a></span> | <span class="t">In addition to that, as your vocab size grows,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6364" target="_blank">01:46:04.600</a></span> | <span class="t">you're going to start shrinking your sequences a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6367" target="_blank">01:46:07.640</a></span> | <span class="t">And that's really nice because that means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6369" target="_blank">01:46:09.720</a></span> | <span class="t">that we're going to be attending to more and more text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6371" target="_blank">01:46:11.880</a></span> | <span class="t">So that's nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6372" target="_blank">01:46:12.980</a></span> | <span class="t">But also you might be worrying that too large of chunks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6375" target="_blank">01:46:15.800</a></span> | <span class="t">are being squished into single tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6378" target="_blank">01:46:18.040</a></span> | <span class="t">And so the model just doesn't have as much time to think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6382" target="_blank">01:46:22.000</a></span> | <span class="t">per some number of characters in a text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6386" target="_blank">01:46:26.320</a></span> | <span class="t">or you can think about it that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6388" target="_blank">01:46:28.000</a></span> | <span class="t">So basically we're squishing too much information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6389" target="_blank">01:46:29.960</a></span> | <span class="t">into a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6391" target="_blank">01:46:31.180</a></span> | <span class="t">And then the forward pass of the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6392" target="_blank">01:46:32.980</a></span> | <span class="t">is not enough to actually process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6394" target="_blank">01:46:34.300</a></span> | <span class="t">that information appropriately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6395" target="_blank">01:46:35.940</a></span> | <span class="t">And so these are some of the considerations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6397" target="_blank">01:46:37.420</a></span> | <span class="t">you're thinking about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6398" target="_blank">01:46:38.260</a></span> | <span class="t">when you're designing the vocab size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6399" target="_blank">01:46:39.820</a></span> | <span class="t">As I mentioned, this is mostly an empirical hyperparameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6402" target="_blank">01:46:42.260</a></span> | <span class="t">And it seems like in state-of-the-art architectures today,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6404" target="_blank">01:46:44.980</a></span> | <span class="t">this is usually in the high 10,000th</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6406" target="_blank">01:46:46.820</a></span> | <span class="t">or somewhere around 100,000 today.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6409" target="_blank">01:46:49.340</a></span> | <span class="t">And the next consideration I want to briefly talk about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6411" target="_blank">01:46:51.500</a></span> | <span class="t">is what if we want to take a pre-trained model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6414" target="_blank">01:46:54.260</a></span> | <span class="t">and we want to extend the vocab size?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6416" target="_blank">01:46:56.460</a></span> | <span class="t">And this is done fairly commonly actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6418" target="_blank">01:46:58.180</a></span> | <span class="t">So for example, when you're doing fine tuning for chat GPT,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6422" target="_blank">01:47:02.240</a></span> | <span class="t">a lot more new special tokens get introduced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6424" target="_blank">01:47:04.280</a></span> | <span class="t">on top of the base model to maintain the metadata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6427" target="_blank">01:47:07.280</a></span> | <span class="t">and all the structure of conversation objects</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6429" target="_blank">01:47:09.980</a></span> | <span class="t">between the user and an assistant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6431" target="_blank">01:47:11.740</a></span> | <span class="t">So that takes a lot of special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6433" target="_blank">01:47:13.860</a></span> | <span class="t">You might also try to throw in more special tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6435" target="_blank">01:47:15.960</a></span> | <span class="t">for example, for using the browser or any other tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6438" target="_blank">01:47:18.920</a></span> | <span class="t">And so it's very tempting to add a lot of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6441" target="_blank">01:47:21.560</a></span> | <span class="t">for all kinds of special functionality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6443" target="_blank">01:47:23.960</a></span> | <span class="t">So if you want to be adding a token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6445" target="_blank">01:47:25.320</a></span> | <span class="t">that's totally possible, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6446" target="_blank">01:47:26.960</a></span> | <span class="t">All we have to do is we have to resize this embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6449" target="_blank">01:47:29.620</a></span> | <span class="t">So we have to add rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6451" target="_blank">01:47:31.100</a></span> | <span class="t">We would initialize these parameters from scratch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6453" target="_blank">01:47:33.860</a></span> | <span class="t">which would be small random numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6455" target="_blank">01:47:35.500</a></span> | <span class="t">And then we have to extend the weight inside this linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6459" target="_blank">01:47:39.340</a></span> | <span class="t">So we have to start making dot products</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6461" target="_blank">01:47:41.900</a></span> | <span class="t">with the associated parameters as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6463" target="_blank">01:47:43.780</a></span> | <span class="t">to basically calculate the probabilities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6465" target="_blank">01:47:45.120</a></span> | <span class="t">for these new tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6466" target="_blank">01:47:46.660</a></span> | <span class="t">So both of these are just a resizing operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6469" target="_blank">01:47:49.500</a></span> | <span class="t">It's a very mild model surgery</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6471" target="_blank">01:47:51.940</a></span> | <span class="t">and can be done fairly easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6473" target="_blank">01:47:53.260</a></span> | <span class="t">And it's quite common that basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6474" target="_blank">01:47:54.460</a></span> | <span class="t">you would freeze the base model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6476" target="_blank">01:47:56.000</a></span> | <span class="t">You introduce these new parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6477" target="_blank">01:47:57.500</a></span> | <span class="t">and then you only train these new parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6479" target="_blank">01:47:59.300</a></span> | <span class="t">to introduce new tokens into the architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6481" target="_blank">01:48:01.600</a></span> | <span class="t">And so you can freeze arbitrary parts of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6484" target="_blank">01:48:04.500</a></span> | <span class="t">or you can train arbitrary parts of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6486" target="_blank">01:48:06.140</a></span> | <span class="t">and that's totally up to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6487" target="_blank">01:48:07.580</a></span> | <span class="t">But basically minor surgery required</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6489" target="_blank">01:48:09.460</a></span> | <span class="t">if you'd like to introduce new tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6491" target="_blank">01:48:11.420</a></span> | <span class="t">And finally, I'd like to mention that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6492" target="_blank">01:48:12.760</a></span> | <span class="t">actually there's an entire design space of applications</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6495" target="_blank">01:48:15.900</a></span> | <span class="t">in terms of introducing new tokens into a vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6498" target="_blank">01:48:18.460</a></span> | <span class="t">that go way beyond just adding special tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6500" target="_blank">01:48:20.460</a></span> | <span class="t">and special new functionality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6502" target="_blank">01:48:22.240</a></span> | <span class="t">So just to give you a sense of the design space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6504" target="_blank">01:48:24.100</a></span> | <span class="t">but this could be an entire video just by itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6506" target="_blank">01:48:26.660</a></span> | <span class="t">This is a paper on learning to compress prompts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6509" target="_blank">01:48:29.260</a></span> | <span class="t">with what they called GIST tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6512" target="_blank">01:48:32.060</a></span> | <span class="t">And the rough idea is suppose that you're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6514" target="_blank">01:48:34.060</a></span> | <span class="t">language models in a setting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6515" target="_blank">01:48:35.060</a></span> | <span class="t">that requires very long prompts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6517" target="_blank">01:48:37.320</a></span> | <span class="t">Well, these long prompts just slow everything down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6519" target="_blank">01:48:39.460</a></span> | <span class="t">because you have to encode them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6520" target="_blank">01:48:40.540</a></span> | <span class="t">and then you have to use them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6521" target="_blank">01:48:41.740</a></span> | <span class="t">and then you're tending over them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6523" target="_blank">01:48:43.220</a></span> | <span class="t">and it's just heavy to have very large prompts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6526" target="_blank">01:48:46.820</a></span> | <span class="t">So instead what they do here in this paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6529" target="_blank">01:48:49.220</a></span> | <span class="t">is they introduce new tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6532" target="_blank">01:48:52.340</a></span> | <span class="t">and imagine basically having a few new tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6536" target="_blank">01:48:56.100</a></span> | <span class="t">you put them in a sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6537" target="_blank">01:48:57.700</a></span> | <span class="t">and then you train the model by distillation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6540" target="_blank">01:49:00.820</a></span> | <span class="t">So you are keeping the entire model frozen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6542" target="_blank">01:49:02.740</a></span> | <span class="t">and you're only training the representations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6544" target="_blank">01:49:04.740</a></span> | <span class="t">of the new tokens, their embeddings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6546" target="_blank">01:49:06.780</a></span> | <span class="t">and you're optimizing over the new tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6548" target="_blank">01:49:08.660</a></span> | <span class="t">such that the behavior of the language model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6551" target="_blank">01:49:11.120</a></span> | <span class="t">is identical to the model that has a very long prompt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6556" target="_blank">01:49:16.120</a></span> | <span class="t">that works for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6557" target="_blank">01:49:17.580</a></span> | <span class="t">And so it's a compression technique</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6559" target="_blank">01:49:19.020</a></span> | <span class="t">of compressing that very long prompt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6560" target="_blank">01:49:20.620</a></span> | <span class="t">into those few new GIST tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6563" target="_blank">01:49:23.140</a></span> | <span class="t">And so you can train this and then at test time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6564" target="_blank">01:49:24.980</a></span> | <span class="t">you can discard your old prompt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6566" target="_blank">01:49:26.100</a></span> | <span class="t">and just swap in those tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6567" target="_blank">01:49:27.540</a></span> | <span class="t">and they sort of like stand in for that very long prompt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6570" target="_blank">01:49:30.900</a></span> | <span class="t">and have an almost identical performance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6573" target="_blank">01:49:33.580</a></span> | <span class="t">And so this is one technique</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6576" target="_blank">01:49:36.100</a></span> | <span class="t">in a class of parameter efficient fine tuning techniques</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6578" target="_blank">01:49:38.780</a></span> | <span class="t">where most of the model is basically fixed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6580" target="_blank">01:49:40.940</a></span> | <span class="t">and there's no training of the model weights,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6583" target="_blank">01:49:43.000</a></span> | <span class="t">there's no training of LoRa or anything like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6585" target="_blank">01:49:45.260</a></span> | <span class="t">of new parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6586" target="_blank">01:49:46.360</a></span> | <span class="t">The parameters that you're training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6587" target="_blank">01:49:47.900</a></span> | <span class="t">are now just the token embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6590" target="_blank">01:49:50.660</a></span> | <span class="t">So that's just one example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6591" target="_blank">01:49:51.700</a></span> | <span class="t">but this could again be like an entire video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6593" target="_blank">01:49:53.900</a></span> | <span class="t">but just to give you a sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6594" target="_blank">01:49:54.860</a></span> | <span class="t">that there's a whole design space here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6596" target="_blank">01:49:56.020</a></span> | <span class="t">that is potentially worth exploring in the future.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6598" target="_blank">01:49:58.620</a></span> | <span class="t">The next thing I want to briefly address</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6600" target="_blank">01:50:00.020</a></span> | <span class="t">is that I think recently there's a lot of momentum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6602" target="_blank">01:50:02.420</a></span> | <span class="t">in how you actually could construct transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6605" target="_blank">01:50:05.220</a></span> | <span class="t">that can simultaneously process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6606" target="_blank">01:50:06.460</a></span> | <span class="t">not just text as the input modality,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6608" target="_blank">01:50:08.580</a></span> | <span class="t">but a lot of other modalities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6609" target="_blank">01:50:09.660</a></span> | <span class="t">So be it images, videos, audio, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6612" target="_blank">01:50:12.980</a></span> | <span class="t">And how do you feed in all these modalities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6614" target="_blank">01:50:14.980</a></span> | <span class="t">and potentially predict these modalities from a transformer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6618" target="_blank">01:50:18.980</a></span> | <span class="t">Do you have to change the architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6620" target="_blank">01:50:20.020</a></span> | <span class="t">in some fundamental way?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6621" target="_blank">01:50:21.060</a></span> | <span class="t">And I think what a lot of people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6622" target="_blank">01:50:22.220</a></span> | <span class="t">are starting to converge towards</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6623" target="_blank">01:50:23.540</a></span> | <span class="t">is that you're not changing the architecture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6625" target="_blank">01:50:25.000</a></span> | <span class="t">you stick with the transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6626" target="_blank">01:50:26.380</a></span> | <span class="t">you just kind of tokenize your input domains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6628" target="_blank">01:50:28.940</a></span> | <span class="t">and then call it a day and pretend it's just text tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6631" target="_blank">01:50:31.420</a></span> | <span class="t">and just do everything else in an identical manner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6635" target="_blank">01:50:35.420</a></span> | <span class="t">So here, for example, there was an early paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6637" target="_blank">01:50:37.020</a></span> | <span class="t">that has a nice graphic for how you can take an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6639" target="_blank">01:50:39.720</a></span> | <span class="t">and you can truncate it into integers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6643" target="_blank">01:50:43.460</a></span> | <span class="t">And these sometimes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6645" target="_blank">01:50:45.340</a></span> | <span class="t">so these would basically become the tokens of images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6647" target="_blank">01:50:47.700</a></span> | <span class="t">as an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6648" target="_blank">01:50:48.900</a></span> | <span class="t">And these tokens can be hard tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6651" target="_blank">01:50:51.540</a></span> | <span class="t">where you force them to be integers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6653" target="_blank">01:50:53.620</a></span> | <span class="t">They can also be soft tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6655" target="_blank">01:50:55.540</a></span> | <span class="t">where you sort of don't require these to be discrete,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6660" target="_blank">01:51:00.240</a></span> | <span class="t">but you do force these representations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6662" target="_blank">01:51:02.300</a></span> | <span class="t">to go through bottlenecks like in autoencoders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6664" target="_blank">01:51:04.940</a></span> | <span class="t">Also in this paper that came out from OpenAI Sora,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6668" target="_blank">01:51:08.420</a></span> | <span class="t">which I think really blew the mind of many people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6672" target="_blank">01:51:12.420</a></span> | <span class="t">and inspired a lot of people in terms of what's possible,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6674" target="_blank">01:51:14.980</a></span> | <span class="t">they have a graphic here and they talk briefly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6676" target="_blank">01:51:16.620</a></span> | <span class="t">about how LLMs have text tokens, Sora has visual patches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6681" target="_blank">01:51:21.340</a></span> | <span class="t">So again, they came up with a way to truncate videos</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6684" target="_blank">01:51:24.260</a></span> | <span class="t">into basically the tokens with their own vocabularies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6687" target="_blank">01:51:27.540</a></span> | <span class="t">And then you can either process discrete tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6689" target="_blank">01:51:29.660</a></span> | <span class="t">say with autoregressive models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6691" target="_blank">01:51:31.040</a></span> | <span class="t">or even soft tokens with diffusion models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6693" target="_blank">01:51:33.660</a></span> | <span class="t">And all of that is sort of being actively worked on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6698" target="_blank">01:51:38.320</a></span> | <span class="t">designed on, and it's beyond the scope of this video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6700" target="_blank">01:51:40.140</a></span> | <span class="t">but just something I wanted to mention briefly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6702" target="_blank">01:51:42.020</a></span> | <span class="t">Okay, now that we have come quite deep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6704" target="_blank">01:51:44.340</a></span> | <span class="t">into the tokenization algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6705" target="_blank">01:51:45.660</a></span> | <span class="t">and we understand a lot more about how it works,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6708" target="_blank">01:51:48.340</a></span> | <span class="t">let's loop back around to the beginning of this video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6710" target="_blank">01:51:50.620</a></span> | <span class="t">and go through some of these bullet points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6711" target="_blank">01:51:51.940</a></span> | <span class="t">and really see why they happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6714" target="_blank">01:51:54.740</a></span> | <span class="t">So first of all, why can't my LLM spell words very well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6717" target="_blank">01:51:57.820</a></span> | <span class="t">or do other spell-related tasks?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6720" target="_blank">01:52:00.160</a></span> | <span class="t">So fundamentally, this is because, as we saw,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6723" target="_blank">01:52:03.800</a></span> | <span class="t">these characters are chunked up into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6727" target="_blank">01:52:07.180</a></span> | <span class="t">And some of these tokens are actually fairly long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6729" target="_blank">01:52:09.820</a></span> | <span class="t">So as an example, I went to the GPT-4 vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6732" target="_blank">01:52:12.740</a></span> | <span class="t">and I looked at one of the longer tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6735" target="_blank">01:52:15.180</a></span> | <span class="t">So .defaultstyle turns out to be a single individual token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6739" target="_blank">01:52:19.380</a></span> | <span class="t">So that's a lot of characters for a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6741" target="_blank">01:52:21.860</a></span> | <span class="t">So my suspicion is that there's just too much crammed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6744" target="_blank">01:52:24.340</a></span> | <span class="t">into this single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6745" target="_blank">01:52:25.820</a></span> | <span class="t">And my suspicion was that the model should not be very good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6748" target="_blank">01:52:28.580</a></span> | <span class="t">at tasks related to spelling of this single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6753" target="_blank">01:52:33.580</a></span> | <span class="t">So I asked, how many letters L are there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6756" target="_blank">01:52:36.980</a></span> | <span class="t">in the word .defaultstyle?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6759" target="_blank">01:52:39.280</a></span> | <span class="t">And of course, my prompt is intentionally done that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6764" target="_blank">01:52:44.280</a></span> | <span class="t">And you see how .defaultstyle will be a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6766" target="_blank">01:52:46.500</a></span> | <span class="t">So this is what the model sees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6768" target="_blank">01:52:48.260</a></span> | <span class="t">So my suspicion is that it wouldn't be very good at this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6770" target="_blank">01:52:50.500</a></span> | <span class="t">And indeed, it is not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6771" target="_blank">01:52:51.940</a></span> | <span class="t">It doesn't actually know how many Ls are in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6774" target="_blank">01:52:54.140</a></span> | <span class="t">It thinks there are three, and actually there are four,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6776" target="_blank">01:52:56.900</a></span> | <span class="t">if I'm not getting this wrong myself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6779" target="_blank">01:52:59.300</a></span> | <span class="t">So that didn't go extremely well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6781" target="_blank">01:53:01.360</a></span> | <span class="t">Let's look at another kind of character-level task.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6785" target="_blank">01:53:05.480</a></span> | <span class="t">So for example, here I asked GPT-4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6788" target="_blank">01:53:08.540</a></span> | <span class="t">to reverse the string .defaultstyle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6791" target="_blank">01:53:11.060</a></span> | <span class="t">And it tried to use a code interpreter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6793" target="_blank">01:53:13.260</a></span> | <span class="t">I stopped it, and I said, just do it, just try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6796" target="_blank">01:53:16.420</a></span> | <span class="t">And it gave me jumble.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6798" target="_blank">01:53:18.820</a></span> | <span class="t">So it doesn't actually really know how to reverse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6802" target="_blank">01:53:22.060</a></span> | <span class="t">this string going from right to left.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6804" target="_blank">01:53:24.740</a></span> | <span class="t">So it gave a wrong result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6806" target="_blank">01:53:26.600</a></span> | <span class="t">So again, like working with this working hypothesis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6809" target="_blank">01:53:29.000</a></span> | <span class="t">that maybe this is due to the tokenization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6811" target="_blank">01:53:31.060</a></span> | <span class="t">I tried a different approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6812" target="_blank">01:53:32.180</a></span> | <span class="t">I said, okay, let's reverse the exact same string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6815" target="_blank">01:53:35.340</a></span> | <span class="t">but take the following approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6817" target="_blank">01:53:37.260</a></span> | <span class="t">Step one, just print out every single character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6819" target="_blank">01:53:39.400</a></span> | <span class="t">separated by spaces,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6820" target="_blank">01:53:40.660</a></span> | <span class="t">and then as a step two, reverse that list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6823" target="_blank">01:53:43.260</a></span> | <span class="t">And it again tried to use a tool, but when I stopped it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6825" target="_blank">01:53:45.820</a></span> | <span class="t">it first produced all the characters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6828" target="_blank">01:53:48.380</a></span> | <span class="t">and that was actually correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6830" target="_blank">01:53:50.040</a></span> | <span class="t">And then it reversed them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6830" target="_blank">01:53:50.880</a></span> | <span class="t">and that was correct once it had this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6832" target="_blank">01:53:52.940</a></span> | <span class="t">So somehow it can't reverse it directly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6834" target="_blank">01:53:54.760</a></span> | <span class="t">but when you go just first, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6837" target="_blank">01:53:57.500</a></span> | <span class="t">listing it out in order, it can do that somehow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6840" target="_blank">01:54:00.100</a></span> | <span class="t">And then it can, once it's broken up this way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6843" target="_blank">01:54:03.260</a></span> | <span class="t">this becomes all these individual characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6845" target="_blank">01:54:05.480</a></span> | <span class="t">And so now this is much easier for it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6847" target="_blank">01:54:07.220</a></span> | <span class="t">to see these individual tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6849" target="_blank">01:54:09.080</a></span> | <span class="t">and reverse them and print them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6851" target="_blank">01:54:11.720</a></span> | <span class="t">So that is kind of interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6854" target="_blank">01:54:14.620</a></span> | <span class="t">So let's continue now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6856" target="_blank">01:54:16.300</a></span> | <span class="t">Why are LLMs worse at non-English languages?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6860" target="_blank">01:54:20.460</a></span> | <span class="t">And I briefly covered this already,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6861" target="_blank">01:54:21.780</a></span> | <span class="t">but basically it's not only that the language model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6865" target="_blank">01:54:25.500</a></span> | <span class="t">sees less non-English data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6867" target="_blank">01:54:27.420</a></span> | <span class="t">during training of the model parameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6869" target="_blank">01:54:29.660</a></span> | <span class="t">but also the tokenizer is not sufficiently trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6874" target="_blank">01:54:34.100</a></span> | <span class="t">on non-English data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6876" target="_blank">01:54:36.060</a></span> | <span class="t">And so here, for example, hello, how are you is five tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6880" target="_blank">01:54:40.140</a></span> | <span class="t">and its translation is 15 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6882" target="_blank">01:54:42.380</a></span> | <span class="t">So this is a three times blow up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6885" target="_blank">01:54:45.020</a></span> | <span class="t">And so for example, annyeong haseyo is just hello,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6888" target="_blank">01:54:48.260</a></span> | <span class="t">basically in Korean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6889" target="_blank">01:54:49.300</a></span> | <span class="t">And that ends up being three tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6890" target="_blank">01:54:50.820</a></span> | <span class="t">I'm actually kind of surprised by that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6891" target="_blank">01:54:51.980</a></span> | <span class="t">because that is a very common phrase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6893" target="_blank">01:54:53.900</a></span> | <span class="t">That's just a typical greeting of like hello.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6896" target="_blank">01:54:56.180</a></span> | <span class="t">And that ends up being three tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6897" target="_blank">01:54:57.620</a></span> | <span class="t">whereas our hello is a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6899" target="_blank">01:54:59.820</a></span> | <span class="t">And so basically everything is a lot more bloated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6901" target="_blank">01:55:01.580</a></span> | <span class="t">and diffuse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6902" target="_blank">01:55:02.420</a></span> | <span class="t">And this is, I think, partly the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6903" target="_blank">01:55:03.980</a></span> | <span class="t">that the model works worse on other languages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6907" target="_blank">01:55:07.000</a></span> | <span class="t">Coming back, why is LLM bad at simple arithmetic?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6911" target="_blank">01:55:11.200</a></span> | <span class="t">That has to do with the tokenization of numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6916" target="_blank">01:55:16.540</a></span> | <span class="t">And so you'll notice that, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6919" target="_blank">01:55:19.140</a></span> | <span class="t">addition is very sort of like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6920" target="_blank">01:55:20.860</a></span> | <span class="t">there's an algorithm that is like character level</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6924" target="_blank">01:55:24.200</a></span> | <span class="t">for doing addition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6925" target="_blank">01:55:25.760</a></span> | <span class="t">So for example, here, we would first add the ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6928" target="_blank">01:55:28.180</a></span> | <span class="t">and then the tens and then the hundreds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6929" target="_blank">01:55:29.840</a></span> | <span class="t">You have to refer to specific parts of these digits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6933" target="_blank">01:55:33.340</a></span> | <span class="t">But these numbers are represented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6935" target="_blank">01:55:35.940</a></span> | <span class="t">completely arbitrarily based on whatever happened</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6937" target="_blank">01:55:37.780</a></span> | <span class="t">to merge or not merge during the tokenization process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6940" target="_blank">01:55:40.940</a></span> | <span class="t">There's an entire blog post about this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6942" target="_blank">01:55:42.360</a></span> | <span class="t">that I think is quite good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6943" target="_blank">01:55:43.740</a></span> | <span class="t">Integer tokenization is insane.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6945" target="_blank">01:55:45.500</a></span> | <span class="t">And this person basically systematically explores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6947" target="_blank">01:55:47.860</a></span> | <span class="t">the tokenization of numbers in, I believe this is GPT-2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6952" target="_blank">01:55:52.020</a></span> | <span class="t">And so they noticed that, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6953" target="_blank">01:55:53.320</a></span> | <span class="t">for four-digit numbers, you can take a look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6957" target="_blank">01:55:57.720</a></span> | <span class="t">whether it is a single token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6960" target="_blank">01:56:00.280</a></span> | <span class="t">or whether it is two tokens that is a one, three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6962" target="_blank">01:56:02.640</a></span> | <span class="t">or a two, two, or a three, one combination.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6964" target="_blank">01:56:04.800</a></span> | <span class="t">And so all the different numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6966" target="_blank">01:56:06.200</a></span> | <span class="t">are all the different combinations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6967" target="_blank">01:56:07.760</a></span> | <span class="t">And you can imagine this is all completely arbitrarily so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6970" target="_blank">01:56:10.520</a></span> | <span class="t">And the model, unfortunately, sometimes sees</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6972" target="_blank">01:56:12.880</a></span> | <span class="t">a token for all four digits, sometimes for three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6977" target="_blank">01:56:17.280</a></span> | <span class="t">sometimes for two, sometimes for one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6979" target="_blank">01:56:19.200</a></span> | <span class="t">and it's in an arbitrary manner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6982" target="_blank">01:56:22.060</a></span> | <span class="t">And so this is definitely a headwind, if you will,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6985" target="_blank">01:56:25.020</a></span> | <span class="t">for the language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6986" target="_blank">01:56:26.020</a></span> | <span class="t">And it's kind of incredible that it can kind of do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6987" target="_blank">01:56:27.900</a></span> | <span class="t">and deal with it, but it's also kind of not ideal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6991" target="_blank">01:56:31.020</a></span> | <span class="t">And so that's why, for example, we saw that Meta,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6993" target="_blank">01:56:33.060</a></span> | <span class="t">when they trained the LLAMA2 algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6995" target="_blank">01:56:35.160</a></span> | <span class="t">and they used sentence piece,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=6996" target="_blank">01:56:36.580</a></span> | <span class="t">they make sure to split up all the digits,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7000" target="_blank">01:56:40.580</a></span> | <span class="t">as an example, for LLAMA2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7003" target="_blank">01:56:43.460</a></span> | <span class="t">And this is partly to improve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7004" target="_blank">01:56:44.900</a></span> | <span class="t">a simple arithmetic kind of performance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7008" target="_blank">01:56:48.020</a></span> | <span class="t">And finally, why is GPT-2 not as good in Python?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7012" target="_blank">01:56:52.040</a></span> | <span class="t">Again, this is partly a modeling issue</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7013" target="_blank">01:56:53.880</a></span> | <span class="t">on the architecture and the dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7015" target="_blank">01:56:55.840</a></span> | <span class="t">and the strength of the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7017" target="_blank">01:56:57.320</a></span> | <span class="t">but it's also partly tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7019" target="_blank">01:56:59.240</a></span> | <span class="t">Because as we saw here with a simple Python example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7022" target="_blank">01:57:02.020</a></span> | <span class="t">the encoding efficiency of the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7024" target="_blank">01:57:04.760</a></span> | <span class="t">for handling spaces in Python is terrible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7027" target="_blank">01:57:07.180</a></span> | <span class="t">And every single space is an individual token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7029" target="_blank">01:57:09.360</a></span> | <span class="t">And this dramatically reduces the context length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7031" target="_blank">01:57:11.680</a></span> | <span class="t">that the model can attend across.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7033" target="_blank">01:57:13.320</a></span> | <span class="t">So that's almost like a tokenization bug for GPT-2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7036" target="_blank">01:57:16.400</a></span> | <span class="t">And that was later fixed with GPT-4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7039" target="_blank">01:57:19.580</a></span> | <span class="t">Okay, so here's another fun one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7041" target="_blank">01:57:21.240</a></span> | <span class="t">My LLM abruptly halts when it sees the string end of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7045" target="_blank">01:57:25.080</a></span> | <span class="t">So here's a very strange behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7048" target="_blank">01:57:28.200</a></span> | <span class="t">Print a string end of text, is what I told GPT-4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7051" target="_blank">01:57:31.440</a></span> | <span class="t">And it says, could you please specify the string?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7053" target="_blank">01:57:33.960</a></span> | <span class="t">And I'm telling it, give me end of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7056" target="_blank">01:57:36.440</a></span> | <span class="t">And it seems like there's an issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7058" target="_blank">01:57:38.000</a></span> | <span class="t">It's not seeing end of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7060" target="_blank">01:57:40.280</a></span> | <span class="t">And then I give it end of text as the string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7062" target="_blank">01:57:42.840</a></span> | <span class="t">and then here's the string,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7064" target="_blank">01:57:44.200</a></span> | <span class="t">and then it just doesn't print it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7065" target="_blank">01:57:45.840</a></span> | <span class="t">So obviously something is breaking here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7067" target="_blank">01:57:47.200</a></span> | <span class="t">with respect to the handling of the special token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7069" target="_blank">01:57:49.520</a></span> | <span class="t">And I didn't actually know what OpenAI is doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7071" target="_blank">01:57:51.600</a></span> | <span class="t">under the hood here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7073" target="_blank">01:57:53.000</a></span> | <span class="t">and whether they are potentially parsing this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7075" target="_blank">01:57:55.600</a></span> | <span class="t">as an actual token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7079" target="_blank">01:57:59.040</a></span> | <span class="t">instead of this just being end of text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7081" target="_blank">01:58:01.800</a></span> | <span class="t">as like individual sort of pieces of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7085" target="_blank">01:58:05.260</a></span> | <span class="t">without the special token handling logic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7088" target="_blank">01:58:08.280</a></span> | <span class="t">And so it might be that someone,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7089" target="_blank">01:58:09.920</a></span> | <span class="t">when they're calling dot encode,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7091" target="_blank">01:58:11.960</a></span> | <span class="t">they are passing in the allowed special,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7094" target="_blank">01:58:14.260</a></span> | <span class="t">and they are allowing end of text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7096" target="_blank">01:58:16.720</a></span> | <span class="t">as a special character in the user prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7099" target="_blank">01:58:19.260</a></span> | <span class="t">But the user prompt, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7100" target="_blank">01:58:20.280</a></span> | <span class="t">is a sort of attacker-controlled text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7103" target="_blank">01:58:23.660</a></span> | <span class="t">So you would hope that they don't really parse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7105" target="_blank">01:58:25.840</a></span> | <span class="t">or use special tokens from that kind of input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7110" target="_blank">01:58:30.240</a></span> | <span class="t">But it appears that there's something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7111" target="_blank">01:58:31.240</a></span> | <span class="t">definitely going wrong here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7112" target="_blank">01:58:32.640</a></span> | <span class="t">And so your knowledge of these special tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7115" target="_blank">01:58:35.840</a></span> | <span class="t">ends up being an attack surface, potentially.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7118" target="_blank">01:58:38.120</a></span> | <span class="t">And so if you'd like to confuse LLMs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7121" target="_blank">01:58:41.440</a></span> | <span class="t">then just try to give them some special tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7124" target="_blank">01:58:44.120</a></span> | <span class="t">and see if you're breaking something by chance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7126" target="_blank">01:58:46.320</a></span> | <span class="t">Okay, so this next one is a really fun one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7128" target="_blank">01:58:48.480</a></span> | <span class="t">the trailing whitespace issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7131" target="_blank">01:58:51.960</a></span> | <span class="t">So if you come to Playground,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7134" target="_blank">01:58:54.440</a></span> | <span class="t">and we come here to GPT 3.5 Turbo Instruct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7138" target="_blank">01:58:58.320</a></span> | <span class="t">So this is not a chat model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7139" target="_blank">01:58:59.520</a></span> | <span class="t">This is a completion model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7140" target="_blank">01:59:00.720</a></span> | <span class="t">So think of it more like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7142" target="_blank">01:59:02.440</a></span> | <span class="t">it's a lot more closer to a base model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7144" target="_blank">01:59:04.600</a></span> | <span class="t">It does completion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7145" target="_blank">01:59:05.960</a></span> | <span class="t">It will continue the token sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7148" target="_blank">01:59:08.720</a></span> | <span class="t">So here's a tagline for Ice Cream Shop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7150" target="_blank">01:59:10.520</a></span> | <span class="t">and we wanna continue the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7152" target="_blank">01:59:12.600</a></span> | <span class="t">And so we can submit and get a bunch of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7155" target="_blank">01:59:15.600</a></span> | <span class="t">Okay, no problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7157" target="_blank">01:59:17.400</a></span> | <span class="t">But now, suppose I do this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7159" target="_blank">01:59:19.720</a></span> | <span class="t">but instead of pressing submit here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7162" target="_blank">01:59:22.420</a></span> | <span class="t">I do, here's a tagline for Ice Cream Shop space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7165" target="_blank">01:59:25.880</a></span> | <span class="t">So I have a space here before I click submit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7168" target="_blank">01:59:28.560</a></span> | <span class="t">We get a warning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7171" target="_blank">01:59:31.240</a></span> | <span class="t">Your text ends in a trailing space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7172" target="_blank">01:59:32.760</a></span> | <span class="t">which causes worse performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7173" target="_blank">01:59:33.920</a></span> | <span class="t">due to how API splits text into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7177" target="_blank">01:59:37.240</a></span> | <span class="t">So what's happening here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7178" target="_blank">01:59:38.200</a></span> | <span class="t">it still gave us a sort of completion here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7180" target="_blank">01:59:40.800</a></span> | <span class="t">but let's take a look at what's happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7182" target="_blank">01:59:42.760</a></span> | <span class="t">So here's a tagline for an Ice Cream Shop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7186" target="_blank">01:59:46.600</a></span> | <span class="t">And then, what does this look like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7189" target="_blank">01:59:49.000</a></span> | <span class="t">in the actual training data?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7190" target="_blank">01:59:50.160</a></span> | <span class="t">Suppose you found the completion in the training document,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7193" target="_blank">01:59:53.120</a></span> | <span class="t">somewhere on the internet,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7194" target="_blank">01:59:54.120</a></span> | <span class="t">and the LLM trained on this data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7196" target="_blank">01:59:56.360</a></span> | <span class="t">So maybe it's something like, oh yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7199" target="_blank">01:59:59.280</a></span> | <span class="t">Maybe that's the tagline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7200" target="_blank">02:00:00.120</a></span> | <span class="t">That's a terrible tagline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7201" target="_blank">02:00:01.160</a></span> | <span class="t">But notice here that when I create O,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7204" target="_blank">02:00:04.680</a></span> | <span class="t">you see that because there's the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7206" target="_blank">02:00:06.960</a></span> | <span class="t">the space character is always a prefix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7209" target="_blank">02:00:09.000</a></span> | <span class="t">to these tokens in GPT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7211" target="_blank">02:00:11.300</a></span> | <span class="t">So it's not an O token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7212" target="_blank">02:00:12.560</a></span> | <span class="t">It's a space O token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7214" target="_blank">02:00:14.040</a></span> | <span class="t">The space is part of the O.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7216" target="_blank">02:00:16.520</a></span> | <span class="t">And together, they are token 8840.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7219" target="_blank">02:00:19.160</a></span> | <span class="t">That's space O.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7220" target="_blank">02:00:20.360</a></span> | <span class="t">So what's happening here is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7223" target="_blank">02:00:23.680</a></span> | <span class="t">when I just have it like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7225" target="_blank">02:00:25.760</a></span> | <span class="t">and I let it complete the next token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7228" target="_blank">02:00:28.120</a></span> | <span class="t">it can sample the space O token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7231" target="_blank">02:00:31.120</a></span> | <span class="t">But instead, if I have this and I add my space,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7234" target="_blank">02:00:34.140</a></span> | <span class="t">then what I'm doing here when I encode this string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7236" target="_blank">02:00:36.740</a></span> | <span class="t">is I have basically, here's a tagline for an ice cream shop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7240" target="_blank">02:00:40.940</a></span> | <span class="t">and this space at the very end becomes a token 220.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7243" target="_blank">02:00:43.840</a></span> | <span class="t">And so we've added token 220,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7247" target="_blank">02:00:47.780</a></span> | <span class="t">and this token otherwise would be part of the tagline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7251" target="_blank">02:00:51.020</a></span> | <span class="t">Because if there actually is a tagline here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7252" target="_blank">02:00:52.700</a></span> | <span class="t">so space O is the token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7255" target="_blank">02:00:55.260</a></span> | <span class="t">And so this is suddenly out of distribution for the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7258" target="_blank">02:00:58.820</a></span> | <span class="t">because this space is part of the next token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7261" target="_blank">02:01:01.500</a></span> | <span class="t">but we're putting it here like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7263" target="_blank">02:01:03.900</a></span> | <span class="t">and the model has seen very, very little data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7266" target="_blank">02:01:06.700</a></span> | <span class="t">of actual space by itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7269" target="_blank">02:01:09.740</a></span> | <span class="t">And we're asking it to complete the sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7271" target="_blank">02:01:11.300</a></span> | <span class="t">like add in more tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7272" target="_blank">02:01:12.820</a></span> | <span class="t">But the problem is that we've sort of begun the first token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7276" target="_blank">02:01:16.200</a></span> | <span class="t">and now it's been split up,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7278" target="_blank">02:01:18.340</a></span> | <span class="t">and now we're out of distribution,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7280" target="_blank">02:01:20.020</a></span> | <span class="t">and now arbitrary bad things happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7282" target="_blank">02:01:22.100</a></span> | <span class="t">And it's just a very rare example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7283" target="_blank">02:01:23.740</a></span> | <span class="t">for it to see something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7285" target="_blank">02:01:25.460</a></span> | <span class="t">And that's why we did the warning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7287" target="_blank">02:01:27.740</a></span> | <span class="t">So the fundamental issue here is, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7289" target="_blank">02:01:29.580</a></span> | <span class="t">that the LLM is on top of these tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7293" target="_blank">02:01:33.660</a></span> | <span class="t">and these tokens are text chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7295" target="_blank">02:01:35.180</a></span> | <span class="t">They're not characters in a way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7296" target="_blank">02:01:36.620</a></span> | <span class="t">you and I would think of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7298" target="_blank">02:01:38.300</a></span> | <span class="t">These are the atoms of what the LLM is seeing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7300" target="_blank">02:01:40.860</a></span> | <span class="t">and there's a bunch of weird stuff that comes out of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7303" target="_blank">02:01:43.180</a></span> | <span class="t">Let's go back to our default cell style.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7306" target="_blank">02:01:46.800</a></span> | <span class="t">I bet you that the model has never in its training set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7310" target="_blank">02:01:50.020</a></span> | <span class="t">seen default cell style without le in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7315" target="_blank">02:01:55.020</a></span> | <span class="t">It's always seen this as a single group,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7317" target="_blank">02:01:57.140</a></span> | <span class="t">because this is some kind of a function in,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7320" target="_blank">02:02:00.300</a></span> | <span class="t">I don't actually know what this is part of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7323" target="_blank">02:02:03.100</a></span> | <span class="t">It's some kind of API.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7324" target="_blank">02:02:04.180</a></span> | <span class="t">But I bet you that it's never seen this combination</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7326" target="_blank">02:02:06.980</a></span> | <span class="t">of tokens in its training data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7329" target="_blank">02:02:09.740</a></span> | <span class="t">because, or I think it would be extremely rare.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7332" target="_blank">02:02:12.260</a></span> | <span class="t">So I took this and I copied pasted it here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7334" target="_blank">02:02:14.760</a></span> | <span class="t">and I tried to complete from it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7337" target="_blank">02:02:17.560</a></span> | <span class="t">and it immediately gave me a big error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7340" target="_blank">02:02:20.000</a></span> | <span class="t">And it said, "The model predicted a completion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7341" target="_blank">02:02:21.460</a></span> | <span class="t">"that begins with a stop sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7342" target="_blank">02:02:22.740</a></span> | <span class="t">"resulting in no output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7343" target="_blank">02:02:23.820</a></span> | <span class="t">"Consider adjusting your prompt or stop sequences."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7346" target="_blank">02:02:26.460</a></span> | <span class="t">So what happened here when I clicked submit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7348" target="_blank">02:02:28.620</a></span> | <span class="t">is that immediately the model emitted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7350" target="_blank">02:02:30.860</a></span> | <span class="t">and sort of like end of text token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7352" target="_blank">02:02:32.740</a></span> | <span class="t">I think, or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7354" target="_blank">02:02:34.320</a></span> | <span class="t">It basically predicted the stop sequence immediately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7356" target="_blank">02:02:36.940</a></span> | <span class="t">So it had no completion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7358" target="_blank">02:02:38.660</a></span> | <span class="t">And so this is why I'm getting a warning again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7360" target="_blank">02:02:40.580</a></span> | <span class="t">because we're off the data distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7362" target="_blank">02:02:42.800</a></span> | <span class="t">and the model is just predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7366" target="_blank">02:02:46.180</a></span> | <span class="t">just totally arbitrary things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7367" target="_blank">02:02:47.740</a></span> | <span class="t">It's just really confused, basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7369" target="_blank">02:02:49.380</a></span> | <span class="t">This is giving it brain damage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7371" target="_blank">02:02:51.020</a></span> | <span class="t">It's never seen this before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7372" target="_blank">02:02:52.100</a></span> | <span class="t">It's shocked, and it's predicting end of text or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7375" target="_blank">02:02:55.540</a></span> | <span class="t">I tried it again here, and in this case, it completed it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7378" target="_blank">02:02:58.920</a></span> | <span class="t">But then for some reason,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7380" target="_blank">02:03:00.280</a></span> | <span class="t">this request may violate our usage policies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7382" target="_blank">02:03:02.840</a></span> | <span class="t">This was flagged.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7383" target="_blank">02:03:03.820</a></span> | <span class="t">Basically, something just goes wrong,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7387" target="_blank">02:03:07.200</a></span> | <span class="t">and there's something like jank.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7388" target="_blank">02:03:08.280</a></span> | <span class="t">You can just feel the jank</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7389" target="_blank">02:03:09.360</a></span> | <span class="t">because the model is extremely unhappy with just this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7392" target="_blank">02:03:12.320</a></span> | <span class="t">and it doesn't know how to complete it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7393" target="_blank">02:03:13.420</a></span> | <span class="t">because it's never occurred in a training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7395" target="_blank">02:03:15.420</a></span> | <span class="t">In a training set, it always appears like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7397" target="_blank">02:03:17.920</a></span> | <span class="t">and becomes a single token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7400" target="_blank">02:03:20.040</a></span> | <span class="t">So these kinds of issues where tokens are,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7402" target="_blank">02:03:22.860</a></span> | <span class="t">either you sort of complete the first character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7405" target="_blank">02:03:25.180</a></span> | <span class="t">of the next token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7406" target="_blank">02:03:26.520</a></span> | <span class="t">or you have long tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7408" target="_blank">02:03:28.480</a></span> | <span class="t">that you then have just some of the characters off,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7411" target="_blank">02:03:31.320</a></span> | <span class="t">all of these are kind of like issues with partial tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7415" target="_blank">02:03:35.000</a></span> | <span class="t">is how I would describe it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7416" target="_blank">02:03:36.800</a></span> | <span class="t">And if you actually dig into the TukToken repository,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7419" target="_blank">02:03:39.760</a></span> | <span class="t">go to the Rust code and search for unstable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7423" target="_blank">02:03:43.400</a></span> | <span class="t">and you'll see encode unstable native, unstable tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7429" target="_blank">02:03:49.280</a></span> | <span class="t">and a lot of special case handling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7431" target="_blank">02:03:51.520</a></span> | <span class="t">None of this stuff about unstable tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7433" target="_blank">02:03:53.400</a></span> | <span class="t">is documented anywhere,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7434" target="_blank">02:03:54.960</a></span> | <span class="t">but there's a ton of code dealing with unstable tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7437" target="_blank">02:03:57.960</a></span> | <span class="t">and unstable tokens is exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7440" target="_blank">02:04:00.200</a></span> | <span class="t">kind of like what I'm describing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7442" target="_blank">02:04:02.320</a></span> | <span class="t">What you would like out of a completion API</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7445" target="_blank">02:04:05.000</a></span> | <span class="t">is something a lot more fancy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7446" target="_blank">02:04:06.280</a></span> | <span class="t">Like if we're putting in default cell star,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7448" target="_blank">02:04:08.740</a></span> | <span class="t">if we're asking for the next token sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7450" target="_blank">02:04:10.580</a></span> | <span class="t">we're not actually trying to append the next token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7452" target="_blank">02:04:12.560</a></span> | <span class="t">exactly after this list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7454" target="_blank">02:04:14.400</a></span> | <span class="t">We're actually trying to append,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7456" target="_blank">02:04:16.240</a></span> | <span class="t">we're trying to consider lots of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7458" target="_blank">02:04:18.200</a></span> | <span class="t">that if we were, I guess like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7462" target="_blank">02:04:22.120</a></span> | <span class="t">we're trying to search over characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7464" target="_blank">02:04:24.320</a></span> | <span class="t">that if we re-tokenized would be of high probability,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7468" target="_blank">02:04:28.220</a></span> | <span class="t">if that makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7469" target="_blank">02:04:29.220</a></span> | <span class="t">So that we can actually add a single individual character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7473" target="_blank">02:04:33.520</a></span> | <span class="t">instead of just like adding the next full token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7475" target="_blank">02:04:35.800</a></span> | <span class="t">that comes after this partial token list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7478" target="_blank">02:04:38.760</a></span> | <span class="t">So this is very tricky to describe,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7480" target="_blank">02:04:40.560</a></span> | <span class="t">and I invite you to maybe like look through this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7482" target="_blank">02:04:42.840</a></span> | <span class="t">It ends up being extremely gnarly and hairy kind of topic,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7485" target="_blank">02:04:45.640</a></span> | <span class="t">and it comes from tokenization fundamentally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7487" target="_blank">02:04:47.600</a></span> | <span class="t">So maybe I can even spend an entire video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7490" target="_blank">02:04:50.660</a></span> | <span class="t">talking about unstable tokens sometime in the future.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7493" target="_blank">02:04:53.120</a></span> | <span class="t">Okay, and I'm really saving the best for last.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7495" target="_blank">02:04:55.320</a></span> | <span class="t">My favorite one by far is the solid gold Magikarp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7498" target="_blank">02:04:58.940</a></span> | <span class="t">(laughs)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7500" target="_blank">02:05:00.280</a></span> | <span class="t">It was just, okay, so this comes from this blog post,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7502" target="_blank">02:05:02.720</a></span> | <span class="t">solid gold Magikarp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7504" target="_blank">02:05:04.640</a></span> | <span class="t">And this is internet famous now for those of us in LLMs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7509" target="_blank">02:05:09.640</a></span> | <span class="t">And basically I would advise you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7511" target="_blank">02:05:11.440</a></span> | <span class="t">to read this blog post in full.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7513" target="_blank">02:05:13.600</a></span> | <span class="t">But basically what this person was doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7515" target="_blank">02:05:15.080</a></span> | <span class="t">is this person went to the token embedding stable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7521" target="_blank">02:05:21.200</a></span> | <span class="t">and clustered the tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7523" target="_blank">02:05:23.040</a></span> | <span class="t">based on their embedding representation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7525" target="_blank">02:05:25.680</a></span> | <span class="t">And this person noticed that there's a cluster of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7529" target="_blank">02:05:29.160</a></span> | <span class="t">that look really strange.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7530" target="_blank">02:05:30.420</a></span> | <span class="t">So there's a cluster here, @rot, E-stream fame,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7533" target="_blank">02:05:33.600</a></span> | <span class="t">solid gold Magikarp, signup message,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7535" target="_blank">02:05:35.640</a></span> | <span class="t">like really weird tokens in basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7539" target="_blank">02:05:39.720</a></span> | <span class="t">in this embedding cluster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7541" target="_blank">02:05:41.520</a></span> | <span class="t">And so where are these tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7542" target="_blank">02:05:42.720</a></span> | <span class="t">and where did they even come from?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7543" target="_blank">02:05:43.760</a></span> | <span class="t">Like what is solid gold Magikarp?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7545" target="_blank">02:05:45.120</a></span> | <span class="t">It makes no sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7546" target="_blank">02:05:46.160</a></span> | <span class="t">And then they found a bunch of these tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7550" target="_blank">02:05:50.900</a></span> | <span class="t">And then they noticed that actually the plot thickens here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7553" target="_blank">02:05:53.340</a></span> | <span class="t">because if you ask the model about these tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7556" target="_blank">02:05:56.100</a></span> | <span class="t">like you ask it some very benign question,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7559" target="_blank">02:05:59.060</a></span> | <span class="t">like please can you repeat back to me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7560" target="_blank">02:06:00.580</a></span> | <span class="t">the string sold gold Magikarp?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7563" target="_blank">02:06:03.020</a></span> | <span class="t">Then you get a variety of basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7564" target="_blank">02:06:04.860</a></span> | <span class="t">totally broken LLM behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7567" target="_blank">02:06:07.500</a></span> | <span class="t">So either you get evasion, so I'm sorry I can't hear you,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7570" target="_blank">02:06:10.820</a></span> | <span class="t">or you get a bunch of hallucinations as a response.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7573" target="_blank">02:06:13.460</a></span> | <span class="t">You can even get back like insults.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7576" target="_blank">02:06:16.340</a></span> | <span class="t">So you ask it about streamer bot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7578" target="_blank">02:06:18.660</a></span> | <span class="t">and the model actually just calls you names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7582" target="_blank">02:06:22.300</a></span> | <span class="t">Or it kind of comes up with like weird humor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7585" target="_blank">02:06:25.300</a></span> | <span class="t">Like you're actually breaking the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7587" target="_blank">02:06:27.300</a></span> | <span class="t">by asking about these very simple strings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7589" target="_blank">02:06:29.500</a></span> | <span class="t">like @rot and solid gold Magikarp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7592" target="_blank">02:06:32.240</a></span> | <span class="t">So like what the hell is happening?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7593" target="_blank">02:06:33.600</a></span> | <span class="t">And there's a variety of here documented behaviors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7596" target="_blank">02:06:36.980</a></span> | <span class="t">There's a bunch of tokens, not just sold gold Magikarp</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7599" target="_blank">02:06:39.060</a></span> | <span class="t">that have that kind of a behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7601" target="_blank">02:06:41.380</a></span> | <span class="t">And so basically there's a bunch of like trigger words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7603" target="_blank">02:06:43.940</a></span> | <span class="t">And if you ask the model about these trigger words,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7606" target="_blank">02:06:46.100</a></span> | <span class="t">or you just include them in your prompt,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7608" target="_blank">02:06:48.160</a></span> | <span class="t">the model goes haywire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7609" target="_blank">02:06:49.300</a></span> | <span class="t">and has all kinds of really strange behaviors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7612" target="_blank">02:06:52.180</a></span> | <span class="t">including sort of ones that violate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7614" target="_blank">02:06:54.220</a></span> | <span class="t">typical safety guidelines and the alignment of the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7617" target="_blank">02:06:57.600</a></span> | <span class="t">like it's swearing back at you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7619" target="_blank">02:06:59.600</a></span> | <span class="t">So what is happening here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7621" target="_blank">02:07:01.180</a></span> | <span class="t">and how can this possibly be true?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7623" target="_blank">02:07:03.180</a></span> | <span class="t">Well, this again comes down to tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7626" target="_blank">02:07:06.140</a></span> | <span class="t">So what's happening here is that sold gold Magikarp,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7628" target="_blank">02:07:08.500</a></span> | <span class="t">if you actually dig into it, is a Reddit user.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7631" target="_blank">02:07:11.580</a></span> | <span class="t">So there's a u/soldgoldmagikarp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7635" target="_blank">02:07:15.100</a></span> | <span class="t">And probably what happened here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7636" target="_blank">02:07:16.840</a></span> | <span class="t">even though I don't know that this has been like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7638" target="_blank">02:07:18.360</a></span> | <span class="t">really definitively explored,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7640" target="_blank">02:07:20.420</a></span> | <span class="t">but what is thought to have happened</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7642" target="_blank">02:07:22.860</a></span> | <span class="t">is that the tokenization dataset was very different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7646" target="_blank">02:07:26.180</a></span> | <span class="t">from the training dataset for the actual language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7649" target="_blank">02:07:29.660</a></span> | <span class="t">So in the tokenization dataset,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7650" target="_blank">02:07:30.940</a></span> | <span class="t">there was a ton of Reddit data potentially,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7653" target="_blank">02:07:33.380</a></span> | <span class="t">where the u/soldgoldmagikarp was mentioned in the text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7657" target="_blank">02:07:37.300</a></span> | <span class="t">Because sold gold Magikarp was a very common</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7660" target="_blank">02:07:40.420</a></span> | <span class="t">sort of person who would post a lot,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7663" target="_blank">02:07:43.340</a></span> | <span class="t">this would be a string that occurs many times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7665" target="_blank">02:07:45.220</a></span> | <span class="t">in a tokenization dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7666" target="_blank">02:07:46.940</a></span> | <span class="t">Because it occurs many times in the tokenization dataset,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7670" target="_blank">02:07:50.020</a></span> | <span class="t">these tokens would end up getting merged</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7671" target="_blank">02:07:51.660</a></span> | <span class="t">to a single individual token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7673" target="_blank">02:07:53.100</a></span> | <span class="t">for that single Reddit user, soldgoldmagikarp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7676" target="_blank">02:07:56.300</a></span> | <span class="t">So they would have a dedicated token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7678" target="_blank">02:07:58.220</a></span> | <span class="t">in a vocabulary of, was it 50,000 tokens in GPT-2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7681" target="_blank">02:08:01.820</a></span> | <span class="t">that is devoted to that Reddit user.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7684" target="_blank">02:08:04.020</a></span> | <span class="t">And then what happens is the tokenization dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7686" target="_blank">02:08:06.700</a></span> | <span class="t">has those strings, but then later when you train the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7691" target="_blank">02:08:11.020</a></span> | <span class="t">the language model itself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7693" target="_blank">02:08:13.300</a></span> | <span class="t">this data from Reddit was not present.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7696" target="_blank">02:08:16.300</a></span> | <span class="t">And so therefore, in the entire training set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7698" target="_blank">02:08:18.760</a></span> | <span class="t">for the language model, soldgoldmagikarp never occurs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7702" target="_blank">02:08:22.300</a></span> | <span class="t">That token never appears in the training set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7705" target="_blank">02:08:25.100</a></span> | <span class="t">for the actual language model later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7707" target="_blank">02:08:27.440</a></span> | <span class="t">So this token never gets activated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7709" target="_blank">02:08:29.860</a></span> | <span class="t">It's initialized at random in the beginning of optimization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7712" target="_blank">02:08:32.780</a></span> | <span class="t">Then you have forward-backward passes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7714" target="_blank">02:08:34.140</a></span> | <span class="t">and updates to the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7715" target="_blank">02:08:35.300</a></span> | <span class="t">And this token is just never updated in the embedding table.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7717" target="_blank">02:08:37.900</a></span> | <span class="t">That row vector never gets sampled.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7719" target="_blank">02:08:39.980</a></span> | <span class="t">It never gets used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7721" target="_blank">02:08:41.060</a></span> | <span class="t">So it never gets trained and it's completely untrained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7723" target="_blank">02:08:43.700</a></span> | <span class="t">It's kind of like unallocated memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7725" target="_blank">02:08:45.540</a></span> | <span class="t">in a typical binary program written in C</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7727" target="_blank">02:08:47.940</a></span> | <span class="t">or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7729" target="_blank">02:08:49.220</a></span> | <span class="t">So it's unallocated memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7730" target="_blank">02:08:50.740</a></span> | <span class="t">And then at test time, if you evoke this token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7733" target="_blank">02:08:53.460</a></span> | <span class="t">then you're basically plucking out a row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7735" target="_blank">02:08:55.320</a></span> | <span class="t">of the embedding table that is completely untrained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7737" target="_blank">02:08:57.260</a></span> | <span class="t">and that feeds into a transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7738" target="_blank">02:08:58.900</a></span> | <span class="t">and creates undefined behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7740" target="_blank">02:09:00.820</a></span> | <span class="t">And that's what we're seeing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7741" target="_blank">02:09:01.740</a></span> | <span class="t">This completely undefined,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7742" target="_blank">02:09:02.980</a></span> | <span class="t">never before seen in a training behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7745" target="_blank">02:09:05.700</a></span> | <span class="t">And so any of these kind of like weird tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7747" target="_blank">02:09:07.640</a></span> | <span class="t">would evoke this behavior</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7748" target="_blank">02:09:08.620</a></span> | <span class="t">because fundamentally the model is out of sample,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7753" target="_blank">02:09:13.540</a></span> | <span class="t">out of distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7756" target="_blank">02:09:16.140</a></span> | <span class="t">Okay, and the very last thing I wanted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7757" target="_blank">02:09:17.300</a></span> | <span class="t">to just briefly mention and point out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7758" target="_blank">02:09:18.980</a></span> | <span class="t">although I think a lot of people are quite aware of this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7761" target="_blank">02:09:21.340</a></span> | <span class="t">is that different kinds of formats</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7762" target="_blank">02:09:22.900</a></span> | <span class="t">and different representations and different languages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7765" target="_blank">02:09:25.060</a></span> | <span class="t">and so on might be more or less efficient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7767" target="_blank">02:09:27.500</a></span> | <span class="t">with GPT tokenizers or any tokenizers for any other,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7770" target="_blank">02:09:30.860</a></span> | <span class="t">let alone for that matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7772" target="_blank">02:09:32.060</a></span> | <span class="t">So for example, JSON is actually really dense in tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7775" target="_blank">02:09:35.140</a></span> | <span class="t">and YAML is a lot more efficient in tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7779" target="_blank">02:09:39.040</a></span> | <span class="t">So for example, these are the same in JSON and in YAML.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7783" target="_blank">02:09:43.280</a></span> | <span class="t">The JSON is 116 and the YAML is 99.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7787" target="_blank">02:09:47.540</a></span> | <span class="t">So quite a bit of an improvement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7789" target="_blank">02:09:49.400</a></span> | <span class="t">And so in the token economy where we are paying per token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7793" target="_blank">02:09:53.760</a></span> | <span class="t">in many ways, and you are paying in the context length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7796" target="_blank">02:09:56.400</a></span> | <span class="t">and you're paying in dollar amount</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7798" target="_blank">02:09:58.560</a></span> | <span class="t">for the cost of processing all this kind of structured data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7801" target="_blank">02:10:01.520</a></span> | <span class="t">when you have to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7803" target="_blank">02:10:03.000</a></span> | <span class="t">So prefer to use YAMLs over JSONs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7805" target="_blank">02:10:05.340</a></span> | <span class="t">And in general, kind of like the tokenization density,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7807" target="_blank">02:10:07.640</a></span> | <span class="t">something that you have to sort of care about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7810" target="_blank">02:10:10.560</a></span> | <span class="t">and worry about at all times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7811" target="_blank">02:10:11.840</a></span> | <span class="t">and try to find efficient encoding schemes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7814" target="_blank">02:10:14.180</a></span> | <span class="t">and spend a lot of time in TickTokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7816" target="_blank">02:10:16.080</a></span> | <span class="t">and measure the different token efficiencies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7818" target="_blank">02:10:18.180</a></span> | <span class="t">of different formats and settings and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7820" target="_blank">02:10:20.520</a></span> | <span class="t">Okay, so that concludes my fairly long video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7823" target="_blank">02:10:23.000</a></span> | <span class="t">on tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7824" target="_blank">02:10:24.440</a></span> | <span class="t">I know it's dry, I know it's annoying,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7826" target="_blank">02:10:26.900</a></span> | <span class="t">I know it's irritating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7828" target="_blank">02:10:28.080</a></span> | <span class="t">I personally really dislike the stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7830" target="_blank">02:10:30.660</a></span> | <span class="t">What I do have to say at this point is don't brush it off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7833" target="_blank">02:10:33.880</a></span> | <span class="t">There's a lot of foot guns, sharp edges here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7836" target="_blank">02:10:36.080</a></span> | <span class="t">security issues, AI safety issues,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7838" target="_blank">02:10:38.940</a></span> | <span class="t">as we saw plugging in unallocated memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7841" target="_blank">02:10:41.120</a></span> | <span class="t">into language models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7843" target="_blank">02:10:43.020</a></span> | <span class="t">So it's worth understanding this stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7846" target="_blank">02:10:46.020</a></span> | <span class="t">That said, I will say that eternal glory goes to anyone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7849" target="_blank">02:10:49.860</a></span> | <span class="t">who can get rid of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7851" target="_blank">02:10:51.160</a></span> | <span class="t">I showed you one possible paper that tried to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7854" target="_blank">02:10:54.440</a></span> | <span class="t">And I think, I hope a lot more can follow over time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7858" target="_blank">02:10:58.080</a></span> | <span class="t">And my final recommendations for the application right now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7860" target="_blank">02:11:00.460</a></span> | <span class="t">are if you can reuse the GPT-4 tokens and vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7864" target="_blank">02:11:04.240</a></span> | <span class="t">in your application,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7865" target="_blank">02:11:05.080</a></span> | <span class="t">that's something you should consider</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7866" target="_blank">02:11:06.200</a></span> | <span class="t">and just use TicToken because it is very efficient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7868" target="_blank">02:11:08.800</a></span> | <span class="t">and nice library for inference for BPE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7872" target="_blank">02:11:12.640</a></span> | <span class="t">I also really like the byte level BPE</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7874" target="_blank">02:11:14.440</a></span> | <span class="t">that TicToken and OpenAI uses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7876" target="_blank">02:11:16.540</a></span> | <span class="t">If you for some reason want to train your own vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7880" target="_blank">02:11:20.120</a></span> | <span class="t">from scratch, then I would use the BPE with sentence piece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7885" target="_blank">02:11:25.120</a></span> | <span class="t">Oops, as I mentioned, I'm not a huge fan of sentence piece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7889" target="_blank">02:11:29.440</a></span> | <span class="t">I don't like it's a byte fallback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7893" target="_blank">02:11:33.040</a></span> | <span class="t">and I don't like that it's doing BPE</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7894" target="_blank">02:11:34.920</a></span> | <span class="t">on Unicode code points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7896" target="_blank">02:11:36.320</a></span> | <span class="t">I think it's, it also has like a million settings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7898" target="_blank">02:11:38.600</a></span> | <span class="t">and I think there's a lot of foot guns here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7900" target="_blank">02:11:40.000</a></span> | <span class="t">and I think it's really easy to miscalibrate them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7902" target="_blank">02:11:42.160</a></span> | <span class="t">and you end up cropping your sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7903" target="_blank">02:11:43.680</a></span> | <span class="t">or something like that because of some hyperparameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7906" target="_blank">02:11:46.600</a></span> | <span class="t">that you don't fully understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7908" target="_blank">02:11:48.000</a></span> | <span class="t">So be very careful with the settings,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7910" target="_blank">02:11:50.400</a></span> | <span class="t">try to copy paste exactly maybe what Meta did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7913" target="_blank">02:11:53.240</a></span> | <span class="t">or basically spend a lot of time looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7915" target="_blank">02:11:55.400</a></span> | <span class="t">at all the hyperparameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7916" target="_blank">02:11:56.880</a></span> | <span class="t">and go through the code of sentence piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7918" target="_blank">02:11:58.440</a></span> | <span class="t">and make sure that you have this correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7920" target="_blank">02:12:00.440</a></span> | <span class="t">But even if you have all the settings correct,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7923" target="_blank">02:12:03.160</a></span> | <span class="t">I still think that the algorithm is kind of inferior</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7925" target="_blank">02:12:05.720</a></span> | <span class="t">to what's happening here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7927" target="_blank">02:12:07.440</a></span> | <span class="t">And maybe the best,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7928" target="_blank">02:12:08.880</a></span> | <span class="t">if you really need to train your vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7930" target="_blank">02:12:10.960</a></span> | <span class="t">maybe the best thing is to just wait</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7932" target="_blank">02:12:12.240</a></span> | <span class="t">for MIM-BPE to become as efficient as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7935" target="_blank">02:12:15.920</a></span> | <span class="t">And that's something that maybe I hope to work on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7939" target="_blank">02:12:19.360</a></span> | <span class="t">And at some point, maybe we can be training basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7942" target="_blank">02:12:22.520</a></span> | <span class="t">really what we want is we want TIC token, but training code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7945" target="_blank">02:12:25.800</a></span> | <span class="t">And that is the ideal thing that currently does not exist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7949" target="_blank">02:12:29.640</a></span> | <span class="t">And MIM-BPE is an implementation of it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7952" target="_blank">02:12:32.920</a></span> | <span class="t">but currently it's in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7954" target="_blank">02:12:34.960</a></span> | <span class="t">So that's currently what I have to say for tokenization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7958" target="_blank">02:12:38.040</a></span> | <span class="t">There might be an advanced video that has even drier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7961" target="_blank">02:12:41.040</a></span> | <span class="t">and even more detailed in the future.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7962" target="_blank">02:12:42.880</a></span> | <span class="t">But for now, I think we're gonna leave things off here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7965" target="_blank">02:12:45.040</a></span> | <span class="t">and I hope that was helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7968" target="_blank">02:12:48.040</a></span> | <span class="t">Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7968" target="_blank">02:12:48.880</a></span> | <span class="t">And they increased this context size from GPT-1 of 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7978" target="_blank">02:12:58.680</a></span> | <span class="t">to 1024 in GPT-4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7981" target="_blank">02:13:01.840</a></span> | <span class="t">(laughs)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7983" target="_blank">02:13:03.760</a></span> | <span class="t">The next...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7984" target="_blank">02:13:04.600</a></span> | <span class="t">Okay, next, I would like us to briefly walk through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7988" target="_blank">02:13:08.640</a></span> | <span class="t">the code for OpenAI on the GPT-2 encoded at Pi.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7992" target="_blank">02:13:12.040</a></span> | <span class="t">I'm sorry, I'm gonna sneeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=7999" target="_blank">02:13:19.120</a></span> | <span class="t">And then what's happening here is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=8001" target="_blank">02:13:21.240</a></span> | <span class="t">this is a spurious layer that I will explain in a bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=8005" target="_blank">02:13:25.600</a></span> | <span class="t">What's happening here is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=8009" target="_blank">02:13:29.600</a></span> | <span class="t">(sneezes)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=zduSFxRajkE&t=8011" target="_blank">02:13:31.760</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>