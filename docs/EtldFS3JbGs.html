<html><head><title>Conversational Memory in LangChain for 2025</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Conversational Memory in LangChain for 2025</h2><a href="https://www.youtube.com/watch?v=EtldFS3JbGs"><img src="https://i.ytimg.com/vi/EtldFS3JbGs/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=0">0:0</a> Conversational Memory in LangChain<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=72">1:12</a> LangChain Chat Memory Types<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=266">4:26</a> LangChain ConversationBufferMemory<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=503">8:23</a> Buffer Memory with LCEL<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=794">13:14</a> LangChain ConversationBufferWindowMemory<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=961">16:1</a> Buffer Window Memory with LCEL<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1352">22:32</a> LangChain ConversationSummaryMemory<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1517">25:17</a> Summary Memory with LCEL<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1812">30:12</a> Token Usage in LangSmith<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1928">32:8</a> Conversation Summary Buffer Memory<br><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2076">34:36</a> Summary Buffer with LCEL<br><br><div style="text-align: left;"><a href="./EtldFS3JbGs.html">Whisper Transcript</a> | <a href="./transcript_EtldFS3JbGs.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">in this chapter we're going to be taking a look at conversational memory in linechain we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=6" target="_blank">00:00:06.160</a></span> | <span class="t">to be taking a look at the core like chat memory components that have already been in linechain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=13" target="_blank">00:00:13.760</a></span> | <span class="t">since the start but are essentially no longer in the library and we'll be seeing how we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=20" target="_blank">00:00:20.560</a></span> | <span class="t">implement those historic conversational memory utilities in the new versions of linechain so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=29" target="_blank">00:00:29.920</a></span> | <span class="t">0.3 now as a pre-warning this chapter is fairly long but that is because conversational memory is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=37" target="_blank">00:00:37.360</a></span> | <span class="t">just such a critical part of chatbots and agents conversational memory is what allows them to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=44" target="_blank">00:00:44.320</a></span> | <span class="t">remember previous interactions and without it our chatbots and agents would just be responding to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=51" target="_blank">00:00:51.200</a></span> | <span class="t">the most recent message without any understanding of previous interactions within a conversations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=57" target="_blank">00:00:57.360</a></span> | <span class="t">so they would just not be conversational and depending on the type of conversation we might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=63" target="_blank">00:01:03.920</a></span> | <span class="t">want to go with various approaches to how we remember those interactions within a conversation now throughout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=72" target="_blank">00:01:12.960</a></span> | <span class="t">this chapter we're going to be focusing on these four memory types we'll be referring to these and i'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=79" target="_blank">00:01:19.200</a></span> | <span class="t">be showing you actually how each one of these works but what we're really focusing on is rewriting these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=85" target="_blank">00:01:25.600</a></span> | <span class="t">for the latest version of langchain using the what's called the runnable with message</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=93" target="_blank">00:01:33.840</a></span> | <span class="t">history so we're going to be essentially taking a look at the original implementations for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=102" target="_blank">00:01:42.080</a></span> | <span class="t">of these four original memory types and then we'll be rewriting them with the the runnable memory history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=108" target="_blank">00:01:48.320</a></span> | <span class="t">class so just taking a look at each of these four very quickly a constantial buffer memory is i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=116" target="_blank">00:01:56.560</a></span> | <span class="t">the simplest most intuitive of these memory types it is literally just you have your messages they come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=125" target="_blank">00:02:05.520</a></span> | <span class="t">in to this object they are stored in this object as essentially a list and when you need them again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=132" target="_blank">00:02:12.640</a></span> | <span class="t">it will return them to you there's nothing nothing else to it's super simple the conversation buffer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=138" target="_blank">00:02:18.880</a></span> | <span class="t">window memory okay so new word in the middle of the window this works in pretty much the same way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=145" target="_blank">00:02:25.760</a></span> | <span class="t">but those messages that it has stored it's not going to return all of them for you instead it's just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=151" target="_blank">00:02:31.680</a></span> | <span class="t">return the most recent let's say the most recent three for example okay and that is defined by a parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=159" target="_blank">00:02:39.280</a></span> | <span class="t">k conversational summary memory rather than keeping track of the entire interaction memory directly what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=167" target="_blank">00:02:47.680</a></span> | <span class="t">it's doing is as those interactions come in it's actually going to take them and it's going to compress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=173" target="_blank">00:02:53.600</a></span> | <span class="t">them into a smaller little summary of what has been within that conversation and as every a new interaction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=181" target="_blank">00:03:01.200</a></span> | <span class="t">is coming in it's going to do that and i keep iterating on that summary and then that is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=186" target="_blank">00:03:06.400</a></span> | <span class="t">to return to us when we need it and finally we have the conversational summary buffer memory so this is it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=194" target="_blank">00:03:14.000</a></span> | <span class="t">taking so the buffer part of this is actually referring to a very similar thing to the buffer window memory but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=201" target="_blank">00:03:21.040</a></span> | <span class="t">rather than it being a you know most k messages it's looking at the number of tokens within your memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=207" target="_blank">00:03:27.360</a></span> | <span class="t">and it's returning the most recent k tokens that's what the buffer part is there and then it's also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=216" target="_blank">00:03:36.480</a></span> | <span class="t">merging that with the summary memory here so essentially what you're getting is almost like a list of the most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=224" target="_blank">00:03:44.080</a></span> | <span class="t">recent messages based on the token length rather than the number of interactions plus a summary which would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=230" target="_blank">00:03:50.960</a></span> | <span class="t">you know come at the the top here so you get kind of both the idea is that obviously this summary here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=237" target="_blank">00:03:57.760</a></span> | <span class="t">would maintain all of your interactions in a very compressed form so you're you're losing less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=245" target="_blank">00:04:05.360</a></span> | <span class="t">information and you're still maintaining you know maybe the very first interaction the user might have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=250" target="_blank">00:04:10.240</a></span> | <span class="t">introduced themselves giving you their name hopefully that would be maintained within the summary and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=256" target="_blank">00:04:16.560</a></span> | <span class="t">would not be lost and then you have almost like a higher resolution on the most recent um k or k tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=264" target="_blank">00:04:24.000</a></span> | <span class="t">from your memory okay so let's jump over to the code we're going into the zero four chat memory notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=270" target="_blank">00:04:30.880</a></span> | <span class="t">okay open that in colab okay now here we are let's go ahead and install the prerequisites run all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=277" target="_blank">00:04:37.520</a></span> | <span class="t">we again can or cannot use alignsmith it is up to you enter that and let's come down and start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=287" target="_blank">00:04:47.360</a></span> | <span class="t">so first to just initialize our lm using 40 mini in this example again low temperature</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=295" target="_blank">00:04:55.920</a></span> | <span class="t">and we're going to start with conversation buffer memory okay so this is the original version of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=303" target="_blank">00:05:03.760</a></span> | <span class="t">this memory type so let me uh where are we we're here so memory conversation buffer memory and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=312" target="_blank">00:05:12.320</a></span> | <span class="t">returning messages that needs to be set to true so the reason that we set return messages true as it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=319" target="_blank">00:05:19.040</a></span> | <span class="t">mentions up here is if you do not do this it's going to be returning your chat history as a string to an llm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=327" target="_blank">00:05:27.280</a></span> | <span class="t">whereas well chat llms nowadays would expect message objects so yeah you just want to be returning these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=337" target="_blank">00:05:37.440</a></span> | <span class="t">as messages rather than as strings okay otherwise yeah you're going to get some kind of strange</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=343" target="_blank">00:05:43.200</a></span> | <span class="t">behavior out from your lms if you return them strings so you do want to make sure that it's true i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=348" target="_blank">00:05:48.400</a></span> | <span class="t">by default it might not be true but this is coming this is deprecated right it does tell you here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=354" target="_blank">00:05:54.240</a></span> | <span class="t">as deprecation warning this is coming from older blank chain but it's a good place to start just to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=360" target="_blank">00:06:00.000</a></span> | <span class="t">understand this and then we're going to rewrite this with the runnables which is the recommended way of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=364" target="_blank">00:06:04.880</a></span> | <span class="t">doing so nowadays okay so adding messages to our memory we're going to write this okay so it's just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=373" target="_blank">00:06:13.040</a></span> | <span class="t">just a conversation user ai user ai so on random chat main things to note here is i do provide my name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=380" target="_blank">00:06:20.480</a></span> | <span class="t">we have the the model same right towards the start of those interactions okay so i'm just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=385" target="_blank">00:06:25.760</a></span> | <span class="t">add all of those we do it like this okay then we can just see we can load our history like so so let's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=397" target="_blank">00:06:37.840</a></span> | <span class="t">see what we have there okay so we have a human message ai message human message right this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=402" target="_blank">00:06:42.960</a></span> | <span class="t">exactly what we i showed you just here it's just in that message format from line chain okay so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=410" target="_blank">00:06:50.640</a></span> | <span class="t">do that alternatively we can actually do this so we can get our memory we initialize the constational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=416" target="_blank">00:06:56.960</a></span> | <span class="t">buffer memory as we did before and we can actually add it directly each message into our memory like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=423" target="_blank">00:07:03.600</a></span> | <span class="t">so we can use this add user message add ai message so on and so on load again and it's going to give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=428" target="_blank">00:07:08.800</a></span> | <span class="t">us the exact same thing again there's multiple ways to do the same thing cool so we have that to pass all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=435" target="_blank">00:07:15.920</a></span> | <span class="t">of this into our lm again this is all deprecated stuff we're going to learn how to use properly in a moment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=441" target="_blank">00:07:21.440</a></span> | <span class="t">but this is how long chain is doing in the past so to pass all of this into our lm we'd be using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=448" target="_blank">00:07:28.720</a></span> | <span class="t">conversation chain right again this is deprecated nowadays we would be using lcell for this so i just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=457" target="_blank">00:07:37.520</a></span> | <span class="t">want to show you okay how this would all go together and then we would invoke okay what is my name again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=462" target="_blank">00:07:42.240</a></span> | <span class="t">let's run that and we'll see what we get it's remembering everything remember so this conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=469" target="_blank">00:07:49.120</a></span> | <span class="t">buffer memory it doesn't drop messages it just remembers everything right and honestly with the sort of high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=476" target="_blank">00:07:56.960</a></span> | <span class="t">context windows of many lms that might be what you do it depends on how long you expect a conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=482" target="_blank">00:08:02.160</a></span> | <span class="t">to go on for but you could you probably in most cases would get away with this okay so what let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=489" target="_blank">00:08:09.360</a></span> | <span class="t">see what we get um i say what is my name again okay let's see what it gives me says your name is james</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=495" target="_blank">00:08:15.520</a></span> | <span class="t">great thank you that works now as i mentioned all of this i just showed you is actually deprecated that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=502" target="_blank">00:08:22.240</a></span> | <span class="t">the old way of doing things let's see how we actually do this in modern or up-to-date line chain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=508" target="_blank">00:08:28.080</a></span> | <span class="t">so we're going to be using this runnable with message history to implement that we will need to use lcell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=514" target="_blank">00:08:34.720</a></span> | <span class="t">and for that we will need to just define prompt templates our lm as we usually would okay so we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=521" target="_blank">00:08:41.520</a></span> | <span class="t">going to set up our system prompt which is just your helpful system called zeta okay we're going to put in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=528" target="_blank">00:08:48.640</a></span> | <span class="t">messages placeholder okay so that's important essentially that is where our messages are coming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=536" target="_blank">00:08:56.320</a></span> | <span class="t">from our conversation buffer memory is going to be inserted right so it's going to be that chat history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=542" target="_blank">00:09:02.880</a></span> | <span class="t">is going to be inserted after our system prompt but before our most recent query which is going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=548" target="_blank">00:09:08.880</a></span> | <span class="t">inserted last here okay so messages placeholder item that's important and we use that throughout the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=556" target="_blank">00:09:16.160</a></span> | <span class="t">course as well so we use it both for chat history and we'll see later on we also use it for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=561" target="_blank">00:09:21.120</a></span> | <span class="t">intermediate thoughts that a agent would go through as well so important to remember that little thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=568" target="_blank">00:09:28.000</a></span> | <span class="t">we'll link our prompt template to our lm again if we would like we could also add in the i think we only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=576" target="_blank">00:09:36.800</a></span> | <span class="t">have the query here oh we would probably also want our history as well but i'm not going to do that right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=584" target="_blank">00:09:44.240</a></span> | <span class="t">now okay so we have our pipeline and we can go ahead and actually define our runnable with message history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=591" target="_blank">00:09:51.840</a></span> | <span class="t">now this class or object when we are initializing it does require a few items we can see them here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=597" target="_blank">00:09:57.440</a></span> | <span class="t">okay so we see that we have our pipeline with history so it's basically going to be uh you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=603" target="_blank">00:10:03.520</a></span> | <span class="t">you can see here right we have that history meshes key right this here has to align with what we provided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=610" target="_blank">00:10:10.480</a></span> | <span class="t">as the meshes placeholder in our pipeline right so we have our pipeline prompt template here and here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=619" target="_blank">00:10:19.600</a></span> | <span class="t">right so that's where it's coming from it's coming from meshes placeholder variable name is history right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=624" target="_blank">00:10:24.240</a></span> | <span class="t">that's important that links to this then for the input meshes key here we have query that again links to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=634" target="_blank">00:10:34.960</a></span> | <span class="t">okay so both important to have that the other thing that is important is obviously we're passing in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=642" target="_blank">00:10:42.240</a></span> | <span class="t">pipeline from before but then we also have this get session history basically what this is doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=647" target="_blank">00:10:47.840</a></span> | <span class="t">is it's saying okay i need to get the list of messages that make up my chat history that are going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=653" target="_blank">00:10:53.280</a></span> | <span class="t">inserted into this variable so that is a function that we define okay and with it within this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=659" target="_blank">00:10:59.920</a></span> | <span class="t">what we're trying to do here is actually replicate what we have with the previous conversation buffer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=668" target="_blank">00:11:08.240</a></span> | <span class="t">memory okay so that's what we're doing here so it's very simple right so we have this in memory chat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=677" target="_blank">00:11:17.040</a></span> | <span class="t">message history okay so that's just the object that we're going to be returning what this will do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=682" target="_blank">00:11:22.320</a></span> | <span class="t">it will set up a session id the session i use essentially like a unique identifier so that each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=688" target="_blank">00:11:28.240</a></span> | <span class="t">conversational interaction within a single conversation is being mapped to a specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=692" target="_blank">00:11:32.880</a></span> | <span class="t">conversation so you don't have overlapping let's say of multiple users using the same system you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=697" target="_blank">00:11:37.520</a></span> | <span class="t">to have a unique session id for each one of those okay and what it's doing is saying okay if session id is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=703" target="_blank">00:11:43.120</a></span> | <span class="t">not in the chat map which is this empty dictionary we're defined here we are going to initialize that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=710" target="_blank">00:11:50.240</a></span> | <span class="t">session with an in memory chat message history okay and that's it and we return okay and all that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=719" target="_blank">00:11:59.280</a></span> | <span class="t">to do is it's going to basically append our messages they will be appended within this chat map session id</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=726" target="_blank">00:12:06.400</a></span> | <span class="t">and they're going to get returned there's nothing really there's nothing else to it to be honest so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=732" target="_blank">00:12:12.960</a></span> | <span class="t">we invoke our runnable let's see what we get oh i need to run this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=737" target="_blank">00:12:17.840</a></span> | <span class="t">okay note that we do have this config so we have a session id that's to again as i mentioned keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=746" target="_blank">00:12:26.560</a></span> | <span class="t">different conversations separate okay so we've run that now let's run a few more so what is my name again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=753" target="_blank">00:12:33.360</a></span> | <span class="t">let's see if it remembers your name is james how can i help you today james okay so it's what we've just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=761" target="_blank">00:12:41.520</a></span> | <span class="t">done there is literally conversation buffer memory but for up-to-date line chain with l cell with runnables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=771" target="_blank">00:12:51.360</a></span> | <span class="t">so you know the recommended way of doing it nowadays so that's a very simple example okay there's really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=779" target="_blank">00:12:59.520</a></span> | <span class="t">and not that much to it it gets a little more complicated as we start thinking about the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=784" target="_blank">00:13:04.720</a></span> | <span class="t">different types of memory although with that being said it's not massively complicated we're only really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=789" target="_blank">00:13:09.760</a></span> | <span class="t">going to be changing the way that we're getting our interactions so let's uh let's dive into that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=797" target="_blank">00:13:17.440</a></span> | <span class="t">see how we will do something similar with the conversation buffer window memory but first let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=802" target="_blank">00:13:22.480</a></span> | <span class="t">actually just understand okay what is the conversation buffer window memory so as i mentioned near the start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=807" target="_blank">00:13:27.840</a></span> | <span class="t">it's going to keep track of the last k messages so there's a few things to keep in mind here more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=814" target="_blank">00:13:34.240</a></span> | <span class="t">messages does mean more tokens that send each request and if we have more tokens in each request</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=820" target="_blank">00:13:40.160</a></span> | <span class="t">it means that we're increasing the latency of our responses and also the cost so with the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=826" target="_blank">00:13:46.240</a></span> | <span class="t">memory type we're just sending everything and because we're sending everything that is going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=830" target="_blank">00:13:50.960</a></span> | <span class="t">increasing our costs going to be increasing our latency for every message especially as a conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=835" target="_blank">00:13:55.440</a></span> | <span class="t">gets longer and longer and we don't we might not necessarily want to do that so with this conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=841" target="_blank">00:14:01.360</a></span> | <span class="t">buffer window memory we're going to just say okay just return me the most recent messages okay so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=849" target="_blank">00:14:09.600</a></span> | <span class="t">let's see how that would work here we're going to return the most recent four messages okay we are again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=856" target="_blank">00:14:16.640</a></span> | <span class="t">make sure we've turned messages is set to true again this is deprecated this is just the old way of doing it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=862" target="_blank">00:14:22.800</a></span> | <span class="t">in a moment we'll see the updated way of doing this we'll add all of our messages okay so we have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=871" target="_blank">00:14:31.680</a></span> | <span class="t">and just see here all right so we've added in all these messages there's more than four messages here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=878" target="_blank">00:14:38.640</a></span> | <span class="t">and we can actually see that here so we have human message ai human ai human ai human ai right so we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=887" target="_blank">00:14:47.680</a></span> | <span class="t">got four pairs of human ai interactions there but here we don't have there's more than four pairs so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=894" target="_blank">00:14:54.080</a></span> | <span class="t">four pairs will take us back all the way to here i'm researching different types of conversational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=902" target="_blank">00:15:02.000</a></span> | <span class="t">memory okay and if we take a look here the most the first message we have is i'm researching different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=907" target="_blank">00:15:07.280</a></span> | <span class="t">types of conversational memory so it's cut off these two here which will be a bit problematic when we ask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=913" target="_blank">00:15:13.280</a></span> | <span class="t">you what our name is okay so let's just see i'm going to be using conversation chain object again again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=919" target="_blank">00:15:19.040</a></span> | <span class="t">just remember that is deprecated and i want to say what is my name again let's see let's see what it says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=926" target="_blank">00:15:26.880</a></span> | <span class="t">uh i'm sorry but i don't know that's your name or any personal information if you like you can tell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=931" target="_blank">00:15:31.440</a></span> | <span class="t">me your name right so it doesn't actually remember so that's kind of like a negative of the conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=939" target="_blank">00:15:39.360</a></span> | <span class="t">buffer window memory of course the uh to fix that in this scenario we might just want to increase k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=945" target="_blank">00:15:45.680</a></span> | <span class="t">maybe we say around the previous eight interaction pairs and it will actually remember so what's my name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=952" target="_blank">00:15:52.400</a></span> | <span class="t">again your name is james so now it remembers we've just modified how much it is remembering but of course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=958" target="_blank">00:15:58.240</a></span> | <span class="t">you know there's pros and cons to this it really depends on what you're trying to build so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=963" target="_blank">00:16:03.440</a></span> | <span class="t">take a look at how we would actually implement this with the runnable with message history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=969" target="_blank">00:16:09.520</a></span> | <span class="t">okay so you know getting a little more complicated here although it is it's not it's not complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=978" target="_blank">00:16:18.560</a></span> | <span class="t">but well we'll see okay so we have a buffer window message history we're creating a class here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=983" target="_blank">00:16:23.520</a></span> | <span class="t">this class is going to inherit from the base chat message history object from linechain okay and all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=992" target="_blank">00:16:32.080</a></span> | <span class="t">our other message history objects can do the same thing before with the in-memory message object that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=999" target="_blank">00:16:39.040</a></span> | <span class="t">was basically replicating the buffer memory so we didn't actually need to do anything we need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1006" target="_blank">00:16:46.480</a></span> | <span class="t">define our own class here so in this case we do so we follow the same pattern that linechain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1013" target="_blank">00:16:53.520</a></span> | <span class="t">follows with this base chat message history and you can see a few of the functions here that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1018" target="_blank">00:16:58.720</a></span> | <span class="t">important so add messages and clear are the ones that we're going to be focusing on we also need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1023" target="_blank">00:17:03.760</a></span> | <span class="t">have messages which this object attribute here okay so we're just implementing the synchronous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1031" target="_blank">00:17:11.360</a></span> | <span class="t">methods here if we want this to be async if we want to supply async we would have to add a add messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1038" target="_blank">00:17:18.720</a></span> | <span class="t">and a get messages and a clear as well so let's go ahead and do that we have messages we have k again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1046" target="_blank">00:17:26.000</a></span> | <span class="t">we're looking at remembering the top k messages or most recent k messages only so it's important that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1051" target="_blank">00:17:31.520</a></span> | <span class="t">have that variable we are adding messages through this class this is going to be used by linechain within our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1058" target="_blank">00:17:38.560</a></span> | <span class="t">runnable so we need to make sure that we do have this method and all we're going to be doing is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1063" target="_blank">00:17:43.200</a></span> | <span class="t">extending the self messages list here and then we're actually just going to be trimming that down so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1068" target="_blank">00:17:48.800</a></span> | <span class="t">that we're not remembering anything beyond those you know most recent k messages that we have set from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1076" target="_blank">00:17:56.720</a></span> | <span class="t">here and then we also have the clear method as well so we need to include that that's just going to clear the history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1083" target="_blank">00:18:03.520</a></span> | <span class="t">okay so it's not this isn't complicated right it just gives us this nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1088" target="_blank">00:18:08.240</a></span> | <span class="t">default standard interface for message history and we just need to make sure we're following that pattern</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1095" target="_blank">00:18:15.440</a></span> | <span class="t">okay i've included the uh this print here just so we can see what's happening okay so we have that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1100" target="_blank">00:18:20.560</a></span> | <span class="t">and now for that get chat history function that we defined earlier rather than using the built-in method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1109" target="_blank">00:18:29.120</a></span> | <span class="t">we're going to be using our own object which is a buffer window message history which we defined just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1114" target="_blank">00:18:34.880</a></span> | <span class="t">here okay so if session id is not in the chat map as we did before we're going to be initializing our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1122" target="_blank">00:18:42.400</a></span> | <span class="t">buffer window message history we're setting k up here with a default value of 4 and then we just return it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1128" target="_blank">00:18:48.640</a></span> | <span class="t">okay and and that's it so let's run this we have our runnable with message history we have all of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1135" target="_blank">00:18:55.920</a></span> | <span class="t">variables which are exactly the same as before but then we also have these variables here with this history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1141" target="_blank">00:19:01.920</a></span> | <span class="t">factory config and this is where if we have um new variables that we've added to our message history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1152" target="_blank">00:19:12.480</a></span> | <span class="t">in this case k that we have down here we need to provide that to line training tell it this is a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1158" target="_blank">00:19:18.560</a></span> | <span class="t">configurable field okay and we've also added it for the session id here as well so we're just being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1164" target="_blank">00:19:24.560</a></span> | <span class="t">explicit and have everything in that so we have that and we run okay now let's go ahead and invoke and see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1173" target="_blank">00:19:33.600</a></span> | <span class="t">what we get okay so important here this history factory config that is kind of being fed through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1181" target="_blank">00:19:41.200</a></span> | <span class="t">into our invoke so that we can actually modify those variables from here okay so we have config configurable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1187" target="_blank">00:19:47.760</a></span> | <span class="t">session id okay we'll just put whatever we want in here and then we also have the number k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1192" target="_blank">00:19:52.480</a></span> | <span class="t">okay so remember the previous four interactions i think in this one we're doing something slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1200" target="_blank">00:20:00.320</a></span> | <span class="t">different i think we're remembering the four interactions rather than the previous four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1204" target="_blank">00:20:04.800</a></span> | <span class="t">interaction pairs okay so my name is james uh we're going to go through i'm just going to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1210" target="_blank">00:20:10.480</a></span> | <span class="t">clear this and now i'm going to start again and we're going to use the exact same add user message</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1216" target="_blank">00:20:16.000</a></span> | <span class="t">and ai message that we used before we're just manually inserting all that into our history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1220" target="_blank">00:20:20.080</a></span> | <span class="t">so that we can then just see okay what is the result and you can see that k equals four is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1227" target="_blank">00:20:27.360</a></span> | <span class="t">unlike before where we were having the uh saving the top four interaction pairs we're now saving the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1235" target="_blank">00:20:35.680</a></span> | <span class="t">most recent four interactions not pairs just interactions and honestly i just think that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1241" target="_blank">00:20:41.920</a></span> | <span class="t">clearer i think it's weird that the number four for k would actually save the most recent eight messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1248" target="_blank">00:20:48.800</a></span> | <span class="t">right i think that's odd so i'm just not replicating that weirdness</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1254" target="_blank">00:20:54.400</a></span> | <span class="t">we could if we wanted to i just don't like it so i'm not doing that and anyway we can see from messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1261" target="_blank">00:21:01.920</a></span> | <span class="t">that we're returning just the most four recent messages okay we should be these four okay cool so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1268" target="_blank">00:21:08.960</a></span> | <span class="t">we've just using the runnable we've replicated the old way of having a window memory and okay i'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1277" target="_blank">00:21:17.680</a></span> | <span class="t">to say what is my name again as before it's not going to remember so we can come to here i'm sorry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1282" target="_blank">00:21:22.880</a></span> | <span class="t">but i don't have access to personal information and so on and so on if you like to tell me your name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1287" target="_blank">00:21:27.120</a></span> | <span class="t">it doesn't know now let's try a new one where we initialize a new session okay so we're going with idk14</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1296" target="_blank">00:21:36.320</a></span> | <span class="t">so that's going to create a new conversation there and we're going to say we're going to set k to 14</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1303" target="_blank">00:21:43.360</a></span> | <span class="t">okay great i'm going to manually insert the other uh messages as we did before okay and we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1310" target="_blank">00:21:50.160</a></span> | <span class="t">all of those you can see at the top here we are still maintaining that hi my name is james message</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1314" target="_blank">00:21:54.880</a></span> | <span class="t">now let's see if it remembers my name your name is james okay there we go cool so that is working and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1323" target="_blank">00:22:03.520</a></span> | <span class="t">we can also see so we just added this what is my name again let's just see if did that get added to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1330" target="_blank">00:22:10.320</a></span> | <span class="t">lists of messages right what is my name again nice and then we also have the response your name is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1335" target="_blank">00:22:15.920</a></span> | <span class="t">james so just by invoking this because we're using the the runnable with message history it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1343" target="_blank">00:22:23.040</a></span> | <span class="t">automatically adding all of that into our message history which is nice cool all right so that is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1351" target="_blank">00:22:31.600</a></span> | <span class="t">buffer window memory and now we are going to take a look at how we might do something a little more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1357" target="_blank">00:22:37.600</a></span> | <span class="t">complicated which is the the summaries okay so when you think about the summary you know what are we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1362" target="_blank">00:22:42.720</a></span> | <span class="t">doing we're actually taking the messages we're using that lm call to summarize them to compress them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1370" target="_blank">00:22:50.160</a></span> | <span class="t">and then we're storing them within messages so let's see how we would actually do that so to start with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1378" target="_blank">00:22:58.720</a></span> | <span class="t">let's just see how it was done in old line chain so you have conversation summary memory go through that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1386" target="_blank">00:23:06.320</a></span> | <span class="t">and let's just see what we get so again same interactions right i'm just invoking invoking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1395" target="_blank">00:23:15.680</a></span> | <span class="t">invoking i'm not adding these directly to the messages because it actually needs to go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1400" target="_blank">00:23:20.320</a></span> | <span class="t">a um like that summarization process and if we have a look we can see it happening okay current</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1408" target="_blank">00:23:28.000</a></span> | <span class="t">conversation so sorry current conversation hello there my name is james ai is generating current</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1414" target="_blank">00:23:34.560</a></span> | <span class="t">conversation the human introduces himself as james ai greets james warmly and expresses its readiness to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1420" target="_blank">00:23:40.640</a></span> | <span class="t">chat and assist inquiring about how his day is going right so it's summarizing the the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1426" target="_blank">00:23:46.880</a></span> | <span class="t">interactions and then we have you know after that summary we have the most recent human message and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1433" target="_blank">00:23:53.120</a></span> | <span class="t">then the ai is going to generate its response okay and that continues going continues going and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1438" target="_blank">00:23:58.800</a></span> | <span class="t">see that the the final summary here is going to be a lot longer okay and it's different that first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1443" target="_blank">00:24:03.520</a></span> | <span class="t">summary of course asking about his day uh imagine studies researching different types of conversational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1448" target="_blank">00:24:08.080</a></span> | <span class="t">memory the ai responds enthusiastically explaining that conversational memory includes short-term</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1453" target="_blank">00:24:13.200</a></span> | <span class="t">memory long-term memory contextual memory personalized memory and then inquires if james is focused on a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1457" target="_blank">00:24:17.680</a></span> | <span class="t">specific type of memory okay cool so we get essentially the summary is just getting uh longer and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1465" target="_blank">00:24:25.200</a></span> | <span class="t">longer as we go but at some point the idea is that it's not going to keep just growing and it should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1470" target="_blank">00:24:30.400</a></span> | <span class="t">actually be shorter than if you were saving every single interaction whilst maintaining as much of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1476" target="_blank">00:24:36.400</a></span> | <span class="t">information as possible but of course you're not going to maintain all of the information that you would with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1483" target="_blank">00:24:43.520</a></span> | <span class="t">for example the the buffer memory right with the summary you are going to lose information but hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1490" target="_blank">00:24:50.720</a></span> | <span class="t">less information than if you're just cutting interactions so you're trying to reduce your token count</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1497" target="_blank">00:24:57.520</a></span> | <span class="t">whilst maintaining as much information as possible now let's go and ask what is my name again it should be able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1505" target="_blank">00:25:05.520</a></span> | <span class="t">answer because we can see in the summary here that i introduced myself as james okay response your name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1513" target="_blank">00:25:13.360</a></span> | <span class="t">is james how is your research going okay so how's that cool let's see how we'd implement that so again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1520" target="_blank">00:25:20.880</a></span> | <span class="t">as before we're going to go with that conversation summary message history we're going to be importing a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1527" target="_blank">00:25:27.600</a></span> | <span class="t">system message uh we're going to be using that not for the lm that we're chatting with but for the lm that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1532" target="_blank">00:25:32.320</a></span> | <span class="t">will be generating our summary so actually that is not quite correct there's create a summary not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1540" target="_blank">00:25:40.880</a></span> | <span class="t">that it matters it's just the doctrine so we have our messages and we also have the lm so different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1545" target="_blank">00:25:45.600</a></span> | <span class="t">different tribute here to what we had before when we initialize the conversation summary message history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1551" target="_blank">00:25:51.920</a></span> | <span class="t">we need to passing in our lm we have the same methods as before we have add messages and clear and what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1559" target="_blank">00:25:59.280</a></span> | <span class="t">doing is as messages coming we extend with our current messages but then we're modifying those okay so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1567" target="_blank">00:26:07.120</a></span> | <span class="t">construct our like instructions to make a summary okay so that is here we have the system prompt uh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1575" target="_blank">00:26:15.360</a></span> | <span class="t">given the existing conversation summary and the new messages generate a new summary of the conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1579" target="_blank">00:26:19.840</a></span> | <span class="t">ensuring to maintain as much relevant information as possible okay then we have a human message here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1586" target="_blank">00:26:26.000</a></span> | <span class="t">through that we're passing the existing summary okay and then we're passing in the new messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1592" target="_blank">00:26:32.480</a></span> | <span class="t">okay cool so we format those and invoke the lm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1599" target="_blank">00:26:39.120</a></span> | <span class="t">here and then what we're doing is in the messages we're actually replacing the existing history that we had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1607" target="_blank">00:26:47.680</a></span> | <span class="t">before with a new history which is just a single system summary message okay let's see what we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1616" target="_blank">00:26:56.080</a></span> | <span class="t">as before we have that and get chat history exactly the same as before the only real difference is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1621" target="_blank">00:27:01.520</a></span> | <span class="t">we're passing in the lm parameter here and of course as we're passing in the lm parameter in here it does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1627" target="_blank">00:27:07.840</a></span> | <span class="t">also mean that we're going to have to include that in the configurable field spec and that we're going to need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1634" target="_blank">00:27:14.160</a></span> | <span class="t">include that when we're invoking our pipeline okay so we run that pass me the lm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1641" target="_blank">00:27:21.440</a></span> | <span class="t">now of course one side effect of generating summaries or everything is that way actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1648" target="_blank">00:27:28.640</a></span> | <span class="t">you know we're generating more so you are actually using quite a lot of tokens whether or not you are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1655" target="_blank">00:27:35.600</a></span> | <span class="t">saving tokens or not actually depends on the length of a conversation as a conversation gets longer if you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1661" target="_blank">00:27:41.120</a></span> | <span class="t">storing everything after a little while that the token usage is actually going to increase so if in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1668" target="_blank">00:27:48.560</a></span> | <span class="t">use case you expect to have shorter conversations you would be saving money and tokens by just using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1675" target="_blank">00:27:55.920</a></span> | <span class="t">standard buffer memory whereas if you're expecting very long conversations you would be saving tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1682" target="_blank">00:28:02.800</a></span> | <span class="t">some money by using the summary history okay so let's see what we got from there we have a summary of the conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1690" target="_blank">00:28:10.080</a></span> | <span class="t">james introduced himself by saying hi my name james i responded warmly asking hi james and no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1694" target="_blank">00:28:14.960</a></span> | <span class="t">interaction include details about token usage okay so we actually uh included everything here which we probably should not have done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1703" target="_blank">00:28:23.920</a></span> | <span class="t">why did we do that uh so in here we're including all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1712" target="_blank">00:28:32.560</a></span> | <span class="t">oh in here so using or including all of the content from the messages so i think maybe if we just do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1722" target="_blank">00:28:42.320</a></span> | <span class="t">x.content for x in messages that should resolve that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1729" target="_blank">00:28:49.760</a></span> | <span class="t">okay there we go so we quickly fix that so yeah before we're passing in the entire messages object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1737" target="_blank">00:28:57.920</a></span> | <span class="t">which obviously includes all of this information whereas actually we just want to be passing into content</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1743" target="_blank">00:29:03.760</a></span> | <span class="t">so we modified that and now we're getting what we expect okay cool and then we can keep going all right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1751" target="_blank">00:29:11.920</a></span> | <span class="t">so as we as we keep going the summary should get more like abstract like as we just saw here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1758" target="_blank">00:29:18.560</a></span> | <span class="t">literally just giving us the messages directly almost okay so we're getting the summary there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1764" target="_blank">00:29:24.720</a></span> | <span class="t">and we can keep going we're going to add just more messages to that we'll see the you know as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1770" target="_blank">00:29:30.400</a></span> | <span class="t">we'll get send those we'll get in a response send again get response we're just adding all of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1776" target="_blank">00:29:36.560</a></span> | <span class="t">invoking all that and i'll be of course adding everything into our message history okay cool so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1783" target="_blank">00:29:43.440</a></span> | <span class="t">we've run that let's see what the uh latest summary is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1786" target="_blank">00:29:46.480</a></span> | <span class="t">okay and then we have this so this is a summary that we have instead of our our chat history okay cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1797" target="_blank">00:29:57.360</a></span> | <span class="t">now finally let's see what's my name again we can just double check you know has my name in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1802" target="_blank">00:30:02.800</a></span> | <span class="t">so it should be able to tell us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1804" target="_blank">00:30:04.320</a></span> | <span class="t">okay cool so your name is james pretty interesting so let's have a quick look over at linesmith so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1817" target="_blank">00:30:17.760</a></span> | <span class="t">reason i want to do this is just to point out okay the different essentially token usage that we're getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1823" target="_blank">00:30:23.120</a></span> | <span class="t">with each one of these okay so we can see that we have these runnable message history which are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1827" target="_blank">00:30:27.360</a></span> | <span class="t">probably uh improved in naming there but we can see okay how long is each one of these taken how many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1834" target="_blank">00:30:34.960</a></span> | <span class="t">tokens are they also using come back to here we have this runnable message history and this is we'll go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1842" target="_blank">00:30:42.240</a></span> | <span class="t">through a few of these maybe to here i think we can see here this is that first interaction where we're using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1848" target="_blank">00:30:48.880</a></span> | <span class="t">the buffer memory and we can see how many tokens were used here so 112 tokens when we're asking what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1856" target="_blank">00:30:56.080</a></span> | <span class="t">is my name again okay then we modified this to include i think it was like 14 interactions or something on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1864" target="_blank">00:31:04.480</a></span> | <span class="t">those lines saying obviously increases number of tokens that we're using right so we can see that actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1869" target="_blank">00:31:09.440</a></span> | <span class="t">happening all in line stuff which is quite nice and we can compare okay how many tokens is each one of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1874" target="_blank">00:31:14.160</a></span> | <span class="t">these using now this is looking at the buffer window and then if we come down to here and look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1880" target="_blank">00:31:20.640</a></span> | <span class="t">this one so this is using our summary okay so our summary with what is my name again i actually use more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1887" target="_blank">00:31:27.600</a></span> | <span class="t">tokens in this scenario right which is interesting because we're trying to compress information the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1893" target="_blank">00:31:33.200</a></span> | <span class="t">those more is because there's not there hasn't been that many interactions as the conversation length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1899" target="_blank">00:31:39.440</a></span> | <span class="t">increases with the summary this total number of tokens especially if we prompt it correctly to keep that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1906" target="_blank">00:31:46.080</a></span> | <span class="t">low that should remain relatively small whereas with the buffer memory that will just keep increasing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1914" target="_blank">00:31:54.480</a></span> | <span class="t">and increasing as a as the conversation gets longer so useful little way of using line smith there to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1922" target="_blank">00:32:02.560</a></span> | <span class="t">just kind of figure out okay in terms of tokens and costs of what we're looking at for each of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1927" target="_blank">00:32:07.840</a></span> | <span class="t">memory types okay so our final memory type acts as a mix of the summary memory and the buffer memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1937" target="_blank">00:32:17.040</a></span> | <span class="t">so what it's going to do is keep the buffer up until an n number of tokens and then once a message exceeds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1945" target="_blank">00:32:25.920</a></span> | <span class="t">the n number of token limit for the buffer it is actually going to be added into our summary so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1953" target="_blank">00:32:33.280</a></span> | <span class="t">memory has the benefit of remembering in detail the most recent interactions whilst also not having limitation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1963" target="_blank">00:32:43.840</a></span> | <span class="t">of using too many tokens as a conversation gets longer and even potentially exceeding context windows if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1971" target="_blank">00:32:51.600</a></span> | <span class="t">try super hard so this is a very interesting approach now as before let's try the original way of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1979" target="_blank">00:32:59.280</a></span> | <span class="t">implementing this then we will go ahead and use our update method for implementing this so we come down to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1987" target="_blank">00:33:07.280</a></span> | <span class="t">here and we're going to do lang chain memory import conversation summary buffer memory okay a few things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=1995" target="_blank">00:33:15.040</a></span> | <span class="t">here lm for summary we have the n number of tokens that we can keep before they get added to the summary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2003" target="_blank">00:33:23.440</a></span> | <span class="t">and then return messages of course okay you can see again this is deprecated we use the conversation chain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2009" target="_blank">00:33:29.760</a></span> | <span class="t">and then we just pass in our memory there and then we can chat okay so super straightforward first message</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2017" target="_blank">00:33:37.520</a></span> | <span class="t">we'll add a few more here again we have to invoke because how memory type here is using the lm to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2026" target="_blank">00:33:46.560</a></span> | <span class="t">those summaries as it goes and let's see what they look like okay so we can see for the first message here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2032" target="_blank">00:33:52.560</a></span> | <span class="t">we have a human message and then an ai message then we come a little bit lower down again same thing human</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2040" target="_blank">00:34:00.080</a></span> | <span class="t">message is the first thing in our history here then it's a system message so this is at the point where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2046" target="_blank">00:34:06.560</a></span> | <span class="t">we've exceeded that 300 token limit and the memory type here is generating those summaries so that summary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2054" target="_blank">00:34:14.560</a></span> | <span class="t">comes in as a system message and we can see okay the human named james introduces himself and mentions he's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2060" target="_blank">00:34:20.240</a></span> | <span class="t">researching different types of conversation memory and so on and so on right okay cool so we have that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2066" target="_blank">00:34:26.320</a></span> | <span class="t">then let's come down a little bit further we can see okay so the summary there okay so that's what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2075" target="_blank">00:34:35.120</a></span> | <span class="t">that's what we have that is the implementation for the old version of this memory again we can see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2083" target="_blank">00:34:43.520</a></span> | <span class="t">deprecated so how do we implement this for our more recent versions of langchain and specifically 0.3 well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2092" target="_blank">00:34:52.720</a></span> | <span class="t">again we're using that runnable with message history and it looks a little more complicated than we were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2099" target="_blank">00:34:59.360</a></span> | <span class="t">getting before but it's actually just you know it's nothing too complex we're just creating a summary as we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2106" target="_blank">00:35:06.800</a></span> | <span class="t">didn't with the previous memory type but the decision for adding to that summary is based on in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2114" target="_blank">00:35:14.320</a></span> | <span class="t">actually the number of messages so i didn't go with the the langchain version where it's a number of tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2121" target="_blank">00:35:21.040</a></span> | <span class="t">i don't like that i prefer to go with messages so what i'm doing is saying okay less k messages okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2127" target="_blank">00:35:27.520</a></span> | <span class="t">once we exceed k messages the measures beyond that are going to be added to the memory okay cool so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2136" target="_blank">00:35:36.160</a></span> | <span class="t">let's see we first initialize our conversation summary buffer message history class with lm and k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2147" target="_blank">00:35:47.040</a></span> | <span class="t">okay so these two here so lm of course to create summaries and k is just the limit of number of messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2153" target="_blank">00:35:53.360</a></span> | <span class="t">that we want to keep before adding them to the summary or dropping them from our messages and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2158" target="_blank">00:35:58.160</a></span> | <span class="t">adding them to the summary okay so we will begin with okay do we have an existing summary so the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2167" target="_blank">00:36:07.840</a></span> | <span class="t">we set this in none is we can't extract the summary the existing summary unless it already exists and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2176" target="_blank">00:36:16.560</a></span> | <span class="t">only way we can do that is by checking okay do we have any messages if yes we want to check if within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2182" target="_blank">00:36:22.880</a></span> | <span class="t">those messages we have a system message because we're we're doing the same structure as what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2187" target="_blank">00:36:27.840</a></span> | <span class="t">have up here where the system message that first system message is actually our summary so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2192" target="_blank">00:36:32.720</a></span> | <span class="t">what we're doing here we're checking if there is a summary message already stored within our messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2197" target="_blank">00:36:37.760</a></span> | <span class="t">okay so we're checking for that if we find it we'll just do we have this little print statement so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2206" target="_blank">00:36:46.080</a></span> | <span class="t">can see that we found something and then we just make our existing summary i should actually move</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2212" target="_blank">00:36:52.400</a></span> | <span class="t">move this to the first instance here okay so that existing summary will be set to the first message</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2224" target="_blank">00:37:04.560</a></span> | <span class="t">okay and this would be a system message rather than a string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2229" target="_blank">00:37:09.600</a></span> | <span class="t">cool so we have that then we want to add any new messages to our history okay so we're sending the history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2240" target="_blank">00:37:20.240</a></span> | <span class="t">there and then we're saying okay if the length of our history is exceeds the k value that we set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2246" target="_blank">00:37:26.720</a></span> | <span class="t">we're going to say okay we found that many messages we're going to be dropping the latest it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2250" target="_blank">00:37:30.800</a></span> | <span class="t">be the latest two messages this i will say here one thing or one problem with this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2257" target="_blank">00:37:37.360</a></span> | <span class="t">is that we're not going to be saving that many tokens if we're summarizing every two messages so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2264" target="_blank">00:37:44.480</a></span> | <span class="t">what i would probably do is in in an actual like production setting i would probably say let's go up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2272" target="_blank">00:37:52.560</a></span> | <span class="t">to 20 messages and once we hit 20 messages let's take the previous 10 we're going to summarize them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2280" target="_blank">00:38:00.160</a></span> | <span class="t">and put them into our summary alongside any you know previous summary that already existed but in in you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2285" target="_blank">00:38:05.600</a></span> | <span class="t">know this is also fine as well okay so we say we found those messages we're going to drop the latest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2294" target="_blank">00:38:14.880</a></span> | <span class="t">two messages okay so we pull the the oldest messages out i should say not the latest it's the oldest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2304" target="_blank">00:38:24.640</a></span> | <span class="t">not the latest i want to keep the latest drop the oldest so we pull out the oldest messages and keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2311" target="_blank">00:38:31.440</a></span> | <span class="t">only the most recent messages okay then i'm saying okay if we if we don't have any old messages to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2319" target="_blank">00:38:39.520</a></span> | <span class="t">summarize we don't do anything we just return okay so this indicates that this has not been triggered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2326" target="_blank">00:38:46.560</a></span> | <span class="t">we would hit this but in the case this has been triggered and we do have old messages we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2334" target="_blank">00:38:54.560</a></span> | <span class="t">to come to here okay so this is we can see our system message prompt template saying giving the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2342" target="_blank">00:39:02.640</a></span> | <span class="t">existing conversation summary in the new messages generate a new summary of the conversation ensuring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2347" target="_blank">00:39:07.920</a></span> | <span class="t">to maintain as much relevant information as possible so if we want to be more conservative with tokens we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2353" target="_blank">00:39:13.200</a></span> | <span class="t">could modify this prompt here to say keep the summary to within the length of a single paragraph for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2360" target="_blank">00:39:20.560</a></span> | <span class="t">example and then we have our human message prompt template which can say okay here's the existing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2365" target="_blank">00:39:25.840</a></span> | <span class="t">compensation summary and here are our new messages now new messages here is actually the old messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2371" target="_blank">00:39:31.280</a></span> | <span class="t">but the way that we're framing it to the llm here is that we want to summarize the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2376" target="_blank">00:39:36.880</a></span> | <span class="t">conversation right it doesn't need to have the most recent messages that we're storing within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2381" target="_blank">00:39:41.680</a></span> | <span class="t">our buffer it doesn't need to know about those that's irrelevant to the summary so we just tell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2386" target="_blank">00:39:46.640</a></span> | <span class="t">it that we have these new matches and as far as this lm is concerned this is like the full set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2392" target="_blank">00:39:52.160</a></span> | <span class="t">interactions okay so then we would format those and invoke our lm and then we'll print out our new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2399" target="_blank">00:39:59.840</a></span> | <span class="t">summary so we can see what's going on there and we would prepend that new summary to our conversation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2407" target="_blank">00:40:07.520</a></span> | <span class="t">history okay and and this will work so we can just prepend it like this because we've already popped</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2417" target="_blank">00:40:17.200</a></span> | <span class="t">where was it up here if we have an existing summary we already popped that from the list so it's already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2424" target="_blank">00:40:24.880</a></span> | <span class="t">been pulled out of that list so it's okay for us to just we don't need to say like we don't need to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2431" target="_blank">00:40:31.440</a></span> | <span class="t">this because we've already dropped that initial system message if it existed okay and then we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2437" target="_blank">00:40:37.120</a></span> | <span class="t">the clear method as before so that's all of the logic for our conversational summary buffer memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2446" target="_blank">00:40:46.640</a></span> | <span class="t">okay so we can see what's going on here we can see what's going on here we define our get chat history</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2453" target="_blank">00:40:53.600</a></span> | <span class="t">function with the lm and k parameters there and then we'll also want to set the configurable fields</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2455" target="_blank">00:40:55.280</a></span> | <span class="t">again so that is just going to be called session id lm and k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2464" target="_blank">00:41:04.320</a></span> | <span class="t">okay so now we can invoke the k value to begin with is going to be four okay so we can see no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2472" target="_blank">00:41:12.800</a></span> | <span class="t">old messages to update summary with that's good let's invoke this a few times and let's see what we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2479" target="_blank">00:41:19.280</a></span> | <span class="t">okay so no old messages to update summary with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2486" target="_blank">00:41:26.560</a></span> | <span class="t">found six messages dropping the oldest two and then we have new summary in the conversation james</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2491" target="_blank">00:41:31.760</a></span> | <span class="t">introduced himself and first is interested in researching different types of conversational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2495" target="_blank">00:41:35.760</a></span> | <span class="t">memory right so you can see there's quite a lot in here at the moment so we would definitely want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2500" target="_blank">00:41:40.880</a></span> | <span class="t">prompt the lm the summary lm to keep that short otherwise we're just getting a ton of stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2508" target="_blank">00:41:48.800</a></span> | <span class="t">right but we can see that that is you know it's working it's functional so let's go back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2516" target="_blank">00:41:56.480</a></span> | <span class="t">and see if we can prompt it to be a little more concise so we come to here ensuring to maintain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2521" target="_blank">00:42:01.680</a></span> | <span class="t">as much relevant information as possible however we need to keep our summary concise the limit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2533" target="_blank">00:42:13.920</a></span> | <span class="t">is a single short paragraph okay something like this let's try and let's see what we get with that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2546" target="_blank">00:42:26.400</a></span> | <span class="t">okay so message one again nothing to update see this so new summary you can see it's a bit shorter it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2552" target="_blank">00:42:32.720</a></span> | <span class="t">doesn't have all those bullet points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2554" target="_blank">00:42:34.480</a></span> | <span class="t">okay so that seems better let's see so you can see the first summary is a bit shorter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2565" target="_blank">00:42:45.120</a></span> | <span class="t">but then as soon as we get to the second and third summaries the second summary is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2570" target="_blank">00:42:50.720</a></span> | <span class="t">slightly longer than the third one okay so we're going to be we're going to be losing a bit of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2576" target="_blank">00:42:56.000</a></span> | <span class="t">information in this case more than we were before but we're saving a ton of tokens so that's of course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2582" target="_blank">00:43:02.480</a></span> | <span class="t">a good thing and of course we could keep going and adding many interactions here and we should see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2588" target="_blank">00:43:08.080</a></span> | <span class="t">this conversation summary will be it should maintain that sort of length of around one short paragraph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2596" target="_blank">00:43:16.080</a></span> | <span class="t">so that is it for this chapter on conversation memory we've seen a few different memory types we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2604" target="_blank">00:43:24.080</a></span> | <span class="t">implemented their old deprecated versions so we can see what they were like and then we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2609" target="_blank">00:43:29.520</a></span> | <span class="t">re-implemented them for the latest versions of lang chain and to be honest using logic where we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2616" target="_blank">00:43:36.640</a></span> | <span class="t">getting much more into the weeds and that is in some ways okay it complicates things that is true but in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2624" target="_blank">00:43:44.080</a></span> | <span class="t">other ways it gives us a ton of control so we can modify those memory types as we did with that final</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2630" target="_blank">00:43:50.080</a></span> | <span class="t">summary buffer memory type we can modify those to our liking which is incredibly useful when you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2638" target="_blank">00:43:58.080</a></span> | <span class="t">actually building applications for the real world so that is it for this chapter we'll move on to the next one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=EtldFS3JbGs&t=2643" target="_blank">00:44:03.840</a></span> | <span class="t">that's it for this chapter we'll move on to the next chapter we'll see you next time</span></div></div></body></html>