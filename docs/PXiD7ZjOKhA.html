<html><head><title>Lesson 21: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 21: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA"><img src="https://i.ytimg.com/vi/PXiD7ZjOKhA/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=0">0:0</a> A super cool demo with miniai and CIFAR-10<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=175">2:55</a> The notebook<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=432">7:12</a> Experiment tracking and W&B callback<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=969">16:9</a> Fitting<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1035">17:15</a> Comments on experiment tracking<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1250">20:50</a> FID and KID, metrics for generated images<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1415">23:35</a> FID notebook (18_fid.ipynb)<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1867">31:7</a> Get the FID from an existing model<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2242">37:22</a> Covariance matrix<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2541">42:21</a> Matrix square root<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2777">46:17</a> Why it is called Fr√©chet Inception Distance (FID)<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2874">47:54</a> Some FID caveats<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3013">50:13</a> KID: Kernel Inception Distance<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3330">55:30</a> FID and KID plots<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3429">57:9</a> Real FID - The Inception network<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3676">61:16</a> Fixing (?) UNet feeding - DDPM_v3<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4129">68:49</a> Schedule experiments<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4492">74:52</a> Train DDPM_v3 and testing with FID<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4741">79:1</a> Denoising Difussion Implicit Models - DDIM<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5172">86:12</a> How does DDIM works?<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5415">90:15</a> Notation in Papers<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5541">92:21</a> DDIM paper<br><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6829">113:49</a> Wrapping up<br><br><div style="text-align: left;"><a href="./PXiD7ZjOKhA.html">Whisper Transcript</a> | <a href="./transcript_PXiD7ZjOKhA.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hello, Jono. Hello, Tanishk. Are you guys ready for lesson 21?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5" target="_blank">00:00:05.720</a></span> | <span class="t">Ready.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6" target="_blank">00:00:06.720</a></span> | <span class="t">Yep, I'm excited.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=7" target="_blank">00:00:07.720</a></span> | <span class="t">I don't know what I would have said if you had said no. So good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=12" target="_blank">00:00:12.760</a></span> | <span class="t">I'm actually particularly excited because I had a little bit of a peak preview of something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=16" target="_blank">00:00:16.640</a></span> | <span class="t">that Jono has been working on, which I think is a super cool demo of what's possible with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=24" target="_blank">00:00:24.480</a></span> | <span class="t">very little code with mini AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=27" target="_blank">00:00:27.040</a></span> | <span class="t">So let me turn it over to Jono.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=30" target="_blank">00:00:30.320</a></span> | <span class="t">Great, thanks, Jeremy. Yeah, so as you'll see, when it's back to Jeremy to talk through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=35" target="_blank">00:00:35.920</a></span> | <span class="t">some of the experiments and things we've been doing, we've been using the fashion reminisce</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=40" target="_blank">00:00:40.240</a></span> | <span class="t">dataset at a really small scale and really rapidly try out these different ideas and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=44" target="_blank">00:00:44.840</a></span> | <span class="t">see some maybe nuances or things that we'd like to explore further. And so as we were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=49" target="_blank">00:00:49.640</a></span> | <span class="t">doing that, I started to think that maybe it was about time to explore just ramping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=54" target="_blank">00:00:54.000</a></span> | <span class="t">up the level, like seeing if we can go to the next slightly larger datasets, slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=58" target="_blank">00:00:58.120</a></span> | <span class="t">harder difficulty, just to double check that these ideas still hold for longer training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=62" target="_blank">00:01:02.960</a></span> | <span class="t">runs and different more difficult data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=66" target="_blank">00:01:06.960</a></span> | <span class="t">That's a really good idea because I feel pretty confident that the learnings from fashion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=71" target="_blank">00:01:11.720</a></span> | <span class="t">reminisce are going to move across most of the time these things seem to, but sometimes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=77" target="_blank">00:01:17.720</a></span> | <span class="t">they don't and it can be very hard to predict. So it seems like a very wise choice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=83" target="_blank">00:01:23.000</a></span> | <span class="t">Yeah. And so we'll keep wrapping up, but as a next step, one above fashion enmost, I thought</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=90" target="_blank">00:01:30.280</a></span> | <span class="t">I'd look at this data called CIFAR10. And so CIFAR10 dataset is a very popular dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=95" target="_blank">00:01:35.920</a></span> | <span class="t">originally for things like image classification, but also now for any paper on generative modeling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=103" target="_blank">00:01:43.080</a></span> | <span class="t">It's kind of like the smallest dataset that you'll see in these papers. And so yeah, if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=108" target="_blank">00:01:48.600</a></span> | <span class="t">you look at the classification results, for example, pretty much every classification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=111" target="_blank">00:01:51.480</a></span> | <span class="t">paper since they started tracking has reported results on CIFAR10 as well as their larger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=117" target="_blank">00:01:57.600</a></span> | <span class="t">datasets. And likewise with image generation, very, very popular, all of the recent diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=124" target="_blank">00:02:04.040</a></span> | <span class="t">papers will usually report CIFAR10, add their image net, and then whatever large massive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=129" target="_blank">00:02:09.120</a></span> | <span class="t">dataset they're training on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=133" target="_blank">00:02:13.200</a></span> | <span class="t">We were somewhat notable in 2018 for managing to train. So for CIFAR10, 94% classification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=140" target="_blank">00:02:20.640</a></span> | <span class="t">is kind of the benchmark. So there was a competition a few years ago where we managed to get to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=145" target="_blank">00:02:25.000</a></span> | <span class="t">that point at a cost of like 26 cents worth of AWS time, I think, which won a big global</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=154" target="_blank">00:02:34.760</a></span> | <span class="t">competition. So I actually hate CIFAR10, but we had some real fun with it a few years ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=163" target="_blank">00:02:43.120</a></span> | <span class="t">Yeah. And it's good. It's a nice dataset for quickly testing things out, but we'll talk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=167" target="_blank">00:02:47.560</a></span> | <span class="t">about why we also like us as a group don't like it at all. And we'll pretty soon move</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=172" target="_blank">00:02:52.360</a></span> | <span class="t">on to something better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=175" target="_blank">00:02:55.320</a></span> | <span class="t">So one of the things you'll notice in this notebook, I'm basically using all of the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=179" target="_blank">00:02:59.560</a></span> | <span class="t">code that Jeremy is going to be looking at and explaining. So I won't go into too much,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=183" target="_blank">00:03:03.800</a></span> | <span class="t">but the data sets also on HuggingFace. So we can load it just like we did the fashion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=188" target="_blank">00:03:08.040</a></span> | <span class="t">Mnest. The images are three channel rather than single channel. So the shape of the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=198" target="_blank">00:03:18.680</a></span> | <span class="t">is slightly different to what we've been working with. That's weird. Yeah. So we have instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=206" target="_blank">00:03:26.280</a></span> | <span class="t">of the single channel image, we have a three channel red, green, and blue image. And this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=210" target="_blank">00:03:30.160</a></span> | <span class="t">is what a batch of data looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=211" target="_blank">00:03:31.520</a></span> | <span class="t">And you've got then two images in your batch. So that's batch by channel by height by width,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=216" target="_blank">00:03:36.840</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=217" target="_blank">00:03:37.840</a></span> | <span class="t">Back to our channel by height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=219" target="_blank">00:03:39.160</a></span> | <span class="t">That was a little confused by the 32 by 32 is it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=222" target="_blank">00:03:42.520</a></span> | <span class="t">Oh, yeah. It's fine. I got it now. Batch size in the arbitrary. And so if you plot these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=228" target="_blank">00:03:48.200</a></span> | <span class="t">one of the things, if you look at this, okay, I can see these are different classes. Like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=231" target="_blank">00:03:51.680</a></span> | <span class="t">I know this is an airplane, a frog, an airplane, but it's actually a puzzle with an airplane</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=235" target="_blank">00:03:55.560</a></span> | <span class="t">on the cover, a bird, a horse, a car. That one you squint, you can tell it's a dare,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=240" target="_blank">00:04:00.920</a></span> | <span class="t">but only if you really know what you're looking for. And so when we started to talk about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=244" target="_blank">00:04:04.880</a></span> | <span class="t">generating these images, this is actually quite frustrating. Like this, if I generated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=249" target="_blank">00:04:09.320</a></span> | <span class="t">this, I'd say this might be the model doing a really bad job. But it's actually that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=253" target="_blank">00:04:13.840</a></span> | <span class="t">is a boat, this is a dog. It's just that this is what the data looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=257" target="_blank">00:04:17.560</a></span> | <span class="t">And so I've actually got something that can help you out. I'll show later today, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=262" target="_blank">00:04:22.000</a></span> | <span class="t">is something like this. It's really actually hard to see whether it's good because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=266" target="_blank">00:04:26.360</a></span> | <span class="t">images are bad. It can be helpful to have a metric to generate that can see how good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=271" target="_blank">00:04:31.840</a></span> | <span class="t">samples are. So I'll be showing a metric for that later today.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=275" target="_blank">00:04:35.600</a></span> | <span class="t">Yeah. And that'll be great. And I hope to have like automated. But anyway, I just wanted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=279" target="_blank">00:04:39.960</a></span> | <span class="t">to flag like for visually inspecting these, it's not great. And so we don't really like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=283" target="_blank">00:04:43.760</a></span> | <span class="t">CIFAR 10 because it's hard to tell, but still a good one to test with. So the Noisify and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=290" target="_blank">00:04:50.520</a></span> | <span class="t">everything I'm following what Jeremy is going to be showing exactly, the code works without</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=294" target="_blank">00:04:54.560</a></span> | <span class="t">any changes because we're adding random noise in the same shape as our data. So even though</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=298" target="_blank">00:04:58.920</a></span> | <span class="t">our data now has three channels, the Noisify function still works fine. If we try and visualise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=304" target="_blank">00:05:04.120</a></span> | <span class="t">the noise based images because we're adding noise in the red pink blue channels, and some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=308" target="_blank">00:05:08.840</a></span> | <span class="t">of that's quite extreme values. Yeah, it looks slightly different, looks all crazy RGB. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=314" target="_blank">00:05:14.920</a></span> | <span class="t">you can see, for example, this frog doesn't have as much noise and it's vaguely visible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=319" target="_blank">00:05:19.840</a></span> | <span class="t">But it is, it's a many impossible task to look at this and tell what image is hiding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=323" target="_blank">00:05:23.840</a></span> | <span class="t">out all of that noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=324" target="_blank">00:05:24.840</a></span> | <span class="t">So I think this is really neat that you could use the same Noisify. Yeah, and it still,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=335" target="_blank">00:05:35.400</a></span> | <span class="t">it still works thanks to, it's not just that shape thing, but I guess just thanks to kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=339" target="_blank">00:05:39.840</a></span> | <span class="t">of PyTorch's broadcasting kind of stuff. This often happens, you can kind of change the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=345" target="_blank">00:05:45.960</a></span> | <span class="t">dimensions of things that just keeps working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=348" target="_blank">00:05:48.240</a></span> | <span class="t">Exactly. And we've been paying attention to those broadcasting rules and the right dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=352" target="_blank">00:05:52.560</a></span> | <span class="t">and so on. Cool. So I'm going to use the same sort of approach to learning unit, except</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=359" target="_blank">00:05:59.560</a></span> | <span class="t">that now obviously I need to specify three input channels and three output channels because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=363" target="_blank">00:06:03.520</a></span> | <span class="t">we're working with three channel images. But I did want to explore for this demo, like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=368" target="_blank">00:06:08.440</a></span> | <span class="t">okay, how could I maybe justify wanting to do this kind of experiment tracking thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=373" target="_blank">00:06:13.240</a></span> | <span class="t">that I'll talk about. And so I'm bumping up the size of the model substantially. I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=377" target="_blank">00:06:17.160</a></span> | <span class="t">gone from, this is the default settings that we were using for FashionM Nest, but the Diffuser's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=381" target="_blank">00:06:21.160</a></span> | <span class="t">default unit has what, many, 20 times as many parameters, 274 million versus 15 million.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=390" target="_blank">00:06:30.260</a></span> | <span class="t">So we're going to try a larger model. We're going to try some longer training. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=394" target="_blank">00:06:34.480</a></span> | <span class="t">I could just do the same training that we've always done just in the notebook, set up a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=401" target="_blank">00:06:41.800</a></span> | <span class="t">learner with progress CV to kind of plot the loss, subtract some metrics. But yeah, I don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=409" target="_blank">00:06:49.640</a></span> | <span class="t">know about you, but once it's beyond a few minutes training, I quickly get a patient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=414" target="_blank">00:06:54.320</a></span> | <span class="t">and I have to wait for it to finish before we can sample. So I'm doing the DDPM sample,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=418" target="_blank">00:06:58.000</a></span> | <span class="t">but I have to, I actually interrupted the training to say, I just want to get a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=421" target="_blank">00:07:01.400</a></span> | <span class="t">at what it looks like initially and to plot some samples. And again, the sampling function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=426" target="_blank">00:07:06.160</a></span> | <span class="t">works without any modification, but I'm passing in my size to be a three channel image. Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=432" target="_blank">00:07:12.560</a></span> | <span class="t">And so this is like, we could do it like this, but at some point I would like to A, keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=437" target="_blank">00:07:17.920</a></span> | <span class="t">track of what experiments I've tried and B, be able to see things as it's going over time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=444" target="_blank">00:07:24.040</a></span> | <span class="t">including like, I'd love to see what the samples look like if you generated after the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=447" target="_blank">00:07:27.480</a></span> | <span class="t">epoch, after the second epoch. And so that's where my little callback that I've been playing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=453" target="_blank">00:07:33.560</a></span> | <span class="t">with comes in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=454" target="_blank">00:07:34.560</a></span> | <span class="t">So just before you do that, I'll just mention like, I mean, there are simple ways you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=459" target="_blank">00:07:39.360</a></span> | <span class="t">do that, right? Like, you know, one popular way a lot of people do is that they'll save</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=463" target="_blank">00:07:43.800</a></span> | <span class="t">some sample images as files every epoch or two, or we could like, the same way that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=470" target="_blank">00:07:50.080</a></span> | <span class="t">have an updating plot, as we train with fast progress, we could have an updating set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=480" target="_blank">00:08:00.120</a></span> | <span class="t">sample images. So there's a few ways we could solve that. That wouldn't handle the tracking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=489" target="_blank">00:08:09.440</a></span> | <span class="t">that you mentioned of like looking over time at how different changes have improved things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=493" target="_blank">00:08:13.160</a></span> | <span class="t">or made them worse, whatever that would, I guess, would require you kind of like saving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=497" target="_blank">00:08:17.040</a></span> | <span class="t">multiple versions of a notebook or keeping some kind of research journal or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=501" target="_blank">00:08:21.840</a></span> | <span class="t">That'd be a bit fiddly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=504" target="_blank">00:08:24.600</a></span> | <span class="t">It is. And all of that's doable, but I also find like, I'm a little bit lazy sometimes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=508" target="_blank">00:08:28.640</a></span> | <span class="t">Maybe I don't write down what I'm trying or yeah, I've saved untitled member 37 notebooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=514" target="_blank">00:08:34.760</a></span> | <span class="t">So yeah, the idea that I wanted to show here is just that there are lots of other solutions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=519" target="_blank">00:08:39.600</a></span> | <span class="t">for this kind of experiment tracking and logging. And one that I really like is called Weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=524" target="_blank">00:08:44.080</a></span> | <span class="t">and Biases. And so I'll explain what's going on in the code here that I'm running a training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=530" target="_blank">00:08:50.160</a></span> | <span class="t">with this additional Weights and Biases callback. And what it's doing is it's allowing me to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=534" target="_blank">00:08:54.320</a></span> | <span class="t">log whatever I'd like. So I can log samples at a different--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=540" target="_blank">00:09:00.120</a></span> | <span class="t">Okay, so you're switching to a website here called wnb.ai. So that's where your callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=546" target="_blank">00:09:06.760</a></span> | <span class="t">is sending information to. Yeah, so Weights and Biases accounts are free</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=551" target="_blank">00:09:11.720</a></span> | <span class="t">for personal and academic use. And it's very, very, like, I don't think anyone hates Weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=555" target="_blank">00:09:15.840</a></span> | <span class="t">and Biases. But it's a very nice service. You sign in and you log in on your computer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=560" target="_blank">00:09:20.280</a></span> | <span class="t">or you get an authentication token. And then you're able to log these experiments and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=565" target="_blank">00:09:25.440</a></span> | <span class="t">can log into different projects. And what it gives you is for each experiment, anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=571" target="_blank">00:09:31.160</a></span> | <span class="t">that you call Weights and Biases.log at any step in the training, that's getting logged</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=576" target="_blank">00:09:36.720</a></span> | <span class="t">and sent to their server and stored somewhere where you can later access it and display</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=580" target="_blank">00:09:40.920</a></span> | <span class="t">it. They have these plots that you can visualize easily. And you can also share them very easily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=586" target="_blank">00:09:46.940</a></span> | <span class="t">in these reports that integrate this data sort of interactive thing. And why that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=593" target="_blank">00:09:53.640</a></span> | <span class="t">nice is that later you can go and look at-- So this is now the project that I'm logging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=597" target="_blank">00:09:57.720</a></span> | <span class="t">into. You can log multiple runs with different settings. And for each of those, you have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=604" target="_blank">00:10:04.160</a></span> | <span class="t">all of these things that you've tracked, like your training, loss, and validation. But you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=609" target="_blank">00:10:09.240</a></span> | <span class="t">can also track your learning rate if you're doing a learning rate schedule. And you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=614" target="_blank">00:10:14.120</a></span> | <span class="t">save your model as an artifact and it'll get saved on their server so you can see exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=619" target="_blank">00:10:19.080</a></span> | <span class="t">what run reproduced, what model. It logs the code. If you set that to-- You can save code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=625" target="_blank">00:10:25.600</a></span> | <span class="t">equals true. And then it creates a copy of your whole Python environment, what libraries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=629" target="_blank">00:10:29.260</a></span> | <span class="t">were installed, what code you ran. So being able to come back later and say, oh, these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=635" target="_blank">00:10:35.280</a></span> | <span class="t">images here, these look really good. I can go back and see, oh, that was this experiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=640" target="_blank">00:10:40.600</a></span> | <span class="t">here. I can check what settings I used. In the initialization, you can log whatever configuration</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=649" target="_blank">00:10:49.640</a></span> | <span class="t">details you'd like in any comments. And yeah, there's other frameworks for this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=656" target="_blank">00:10:56.440</a></span> | <span class="t">Yeah, in some ways, it's kind of-- initially, when I first saw Weights and Biases, it felt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=662" target="_blank">00:11:02.080</a></span> | <span class="t">a bit weird to me actually sending your information off to an external website because, I mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=668" target="_blank">00:11:08.920</a></span> | <span class="t">before Weights and Biases existed, the most popular way to do this was something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=672" target="_blank">00:11:12.880</a></span> | <span class="t">TensorBoard, which Google provides, which is actually a lot like this, but it's a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=677" target="_blank">00:11:17.940</a></span> | <span class="t">server that runs on your computer. And so like when you log things, it just puts it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=684" target="_blank">00:11:24.880</a></span> | <span class="t">into this little database on your computer, which is totally fine. But I guess actually,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=693" target="_blank">00:11:33.880</a></span> | <span class="t">there are some benefits to having somebody else run this service instead of running your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=700" target="_blank">00:11:40.200</a></span> | <span class="t">own little TensorBoard or whatever server. One is that you can have multiple people working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=707" target="_blank">00:11:47.500</a></span> | <span class="t">on a project collaborating. So I've done that before, where we will each be sending different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=712" target="_blank">00:11:52.520</a></span> | <span class="t">sets of hyperparameters, and then they'll end up in the same place. Or if you want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=718" target="_blank">00:11:58.200</a></span> | <span class="t">be really antisocial, you can interrupt your romantic dinner and look at your phone to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=723" target="_blank">00:12:03.440</a></span> | <span class="t">see how your training's going. So yeah, I'm not going to say it's always the best approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=731" target="_blank">00:12:11.260</a></span> | <span class="t">to doing things, but I think there's definitely benefits to using this kind of service. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=736" target="_blank">00:12:16.080</a></span> | <span class="t">it looks like you're showing us that you can also create reports for sharing this, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=740" target="_blank">00:12:20.200</a></span> | <span class="t">is also pretty nifty.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=741" target="_blank">00:12:21.600</a></span> | <span class="t">Yeah, yeah. So I like for working with other people or you want to show somebody the final</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=752" target="_blank">00:12:32.040</a></span> | <span class="t">results and being able to, yeah, pull together the results from some different runs or just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=760" target="_blank">00:12:40.160</a></span> | <span class="t">say, oh, by the way, here's a set of examples from my two most recent. And things track</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=767" target="_blank">00:12:47.720</a></span> | <span class="t">to different steps. What do you think of this? And being able to have this place where everyone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=773" target="_blank">00:12:53.840</a></span> | <span class="t">can go and they can inspect the different loss curves. For any run, they can say, oh,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=778" target="_blank">00:12:58.440</a></span> | <span class="t">what was the batch size for this? Let me go look at the info there. OK, I didn't log it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=785" target="_blank">00:13:05.000</a></span> | <span class="t">but I logged time in the epochs and the learning rate. So yeah, I find it quite nice, especially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=790" target="_blank">00:13:10.160</a></span> | <span class="t">in a team or if you're doing lots and lots of experiments to be able to have this permanent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=795" target="_blank">00:13:15.360</a></span> | <span class="t">record that somebody else deals with and may host the storage and the tracking. Yeah, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=801" target="_blank">00:13:21.720</a></span> | <span class="t">quite nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=802" target="_blank">00:13:22.720</a></span> | <span class="t">Wait, and this is all the code you had to write? That's amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=806" target="_blank">00:13:26.640</a></span> | <span class="t">Yeah. So this is using the callback system. The way Weights and Bices works is that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=812" target="_blank">00:13:32.280</a></span> | <span class="t">start an experiment with this 1db.init, and you can specify any configurational settings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=818" target="_blank">00:13:38.840</a></span> | <span class="t">that you used there. And then anything you need to log is 1db.log, and you pass in whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=825" target="_blank">00:13:45.000</a></span> | <span class="t">the name of your value is, again, logging the loss and then the value. And once you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=830" target="_blank">00:13:50.360</a></span> | <span class="t">done 1db.finish, and that syncs everything up and sends it to the server.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=833" target="_blank">00:13:53.760</a></span> | <span class="t">Oh, this is wild, the way you've inherited from Metric CV, and you replaced that underscore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=838" target="_blank">00:13:58.680</a></span> | <span class="t">log that we previously we used to allow fast progress to do the logging, and you've replaced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=843" target="_blank">00:14:03.400</a></span> | <span class="t">it to allow Weights and Bices to the logging. So yeah, it's really sweet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=848" target="_blank">00:14:08.520</a></span> | <span class="t">Yeah, yeah. So this is using the callback system. I wanted to do the things that Metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=854" target="_blank">00:14:14.320</a></span> | <span class="t">CV normally does, which is tracking different metrics that you pass in. So this will still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=858" target="_blank">00:14:18.480</a></span> | <span class="t">do that. And I just offload to the super like the original Metric CV method for things like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=863" target="_blank">00:14:23.960</a></span> | <span class="t">the after batch. But in addition to that, I'd also like to log the Weights and Bices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=869" target="_blank">00:14:29.440</a></span> | <span class="t">And so before I fit, I initialize the experiments, every batch, I'm going to log the loss after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=876" target="_blank">00:14:36.280</a></span> | <span class="t">every epoch, and the default metrics callback is going to accumulate the metrics and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=882" target="_blank">00:14:42.680</a></span> | <span class="t">on. And then it's going to call this underscore log function. So I chose to modify that to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=886" target="_blank">00:14:46.680</a></span> | <span class="t">say, I'm going to log my training loss, it's training, I'm going to log my validation loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=891" target="_blank">00:14:51.760</a></span> | <span class="t">if I'm doing validation, and I'd like to log some samples. And Weights and Bices is quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=896" target="_blank">00:14:56.320</a></span> | <span class="t">flexible in terms of what you can log, you can create images or videos or whatever. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=902" target="_blank">00:15:02.480</a></span> | <span class="t">it also takes a method with figure. And so I'm generating samples and plotting them with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=909" target="_blank">00:15:09.440</a></span> | <span class="t">show image and splitting back that map of the figure, which I can then log and that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=914" target="_blank">00:15:14.040</a></span> | <span class="t">becomes these pretty pictures. And that you can see over time, like every, every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=919" target="_blank">00:15:19.280</a></span> | <span class="t">that log function runs, which is after every epoch, you can go in and see what the images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=923" target="_blank">00:15:23.760</a></span> | <span class="t">look like. So maybe we can make your code even simpler in the future. If we had show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=929" target="_blank">00:15:29.480</a></span> | <span class="t">images, maybe it could have like a optional return fake parameter that returns the figure,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=935" target="_blank">00:15:35.520</a></span> | <span class="t">and then we could replace those four lines of code with one, I suspect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=939" target="_blank">00:15:39.960</a></span> | <span class="t">Yeah. Yeah. And I mean, this, I just sort of threw this together. It's quite early still.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=945" target="_blank">00:15:45.640</a></span> | <span class="t">You could also what I've done in the past is usually just create a PIL image where you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=950" target="_blank">00:15:50.400</a></span> | <span class="t">can, you know, make a grid or overlay a text or whatever else you'd like, and then just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=955" target="_blank">00:15:55.960</a></span> | <span class="t">log that as 1db.image. And otherwise, like apart from that, I'm just passing in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=961" target="_blank">00:16:01.440</a></span> | <span class="t">callback as an extra callback to my set of callbacks for the learner instead of a metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=967" target="_blank">00:16:07.920</a></span> | <span class="t">callback. And so when I call that fit, I still get my little progress bar, I still get this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=973" target="_blank">00:16:13.400</a></span> | <span class="t">printed out version because my log function still also prints those metrics just for debugging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=980" target="_blank">00:16:20.320</a></span> | <span class="t">But instead of having to like watch the progress in the notebook, I can set this running disconnect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=984" target="_blank">00:16:24.480</a></span> | <span class="t">from the server, go have dinner, and then I can check on my phone or whatever. What</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=988" target="_blank">00:16:28.520</a></span> | <span class="t">do the samples look like? And okay, cool. They're starting to look like less than random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=994" target="_blank">00:16:34.560</a></span> | <span class="t">nonsense, but still not necessarily recognizable. Maybe we need to train for longer. That can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=999" target="_blank">00:16:39.480</a></span> | <span class="t">be the next experiment. What I should probably do next is think of some extra metrics, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1004" target="_blank">00:16:44.200</a></span> | <span class="t">Jeremy's going to talk about that. So for now, that's pretty much all I had to show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1007" target="_blank">00:16:47.840</a></span> | <span class="t">is just to say, yeah, it's worth as you move to these longer, you know, 10 minutes, one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1012" target="_blank">00:16:52.400</a></span> | <span class="t">hour, 10 hours, these experiments, it's worth setting up a bit of infrastructure for yourself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1016" target="_blank">00:16:56.920</a></span> | <span class="t">so that you know what were the settings I used. And maybe you're saving the model so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1021" target="_blank">00:17:01.200</a></span> | <span class="t">you have the artifact as a result. And yeah, I like this Wix devices approach, but there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1026" target="_blank">00:17:06.080</a></span> | <span class="t">lots of others. The main thing is that you're doing something to track these experiments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1030" target="_blank">00:17:10.280</a></span> | <span class="t">beyond just, you know, creating for any different versions of your notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1034" target="_blank">00:17:14.600</a></span> | <span class="t">I love it. One thing I was going to note that, I don't know if many people know, but like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1039" target="_blank">00:17:19.040</a></span> | <span class="t">Wix and Biasis can also save the exact code that you used to run for that run. So like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1045" target="_blank">00:17:25.320</a></span> | <span class="t">if you make any changes to your code, and then you know that you don't know which version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1049" target="_blank">00:17:29.200</a></span> | <span class="t">of your code you use for this particular experiment, so then you can figure out exactly what code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1053" target="_blank">00:17:33.680</a></span> | <span class="t">you use. So it's all completely reproducible. And so I love, you know, weights and biases,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1058" target="_blank">00:17:38.440</a></span> | <span class="t">all these different features it has. And I use weights and biases all the time for my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1061" target="_blank">00:17:41.920</a></span> | <span class="t">own research, like almost daily, like I had to, you know, put it on just last night, chuck</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1066" target="_blank">00:17:46.400</a></span> | <span class="t">on it today morning. So it's like, I use it all the time for my own research. And it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1071" target="_blank">00:17:51.040</a></span> | <span class="t">and yeah, like I use it, especially to just know like, oh, this run had this particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1074" target="_blank">00:17:54.840</a></span> | <span class="t">config. And then like, yeah, the models go straight into weights and biases. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1079" target="_blank">00:17:59.120</a></span> | <span class="t">if I want to run a model on the test set, I literally actually take it off of weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1083" target="_blank">00:18:03.320</a></span> | <span class="t">and biases like downloaded for weights and biases and run it on the test set. So I use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1087" target="_blank">00:18:07.320</a></span> | <span class="t">it all the time. And also just having the ability to have everything reproducible and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1090" target="_blank">00:18:10.960</a></span> | <span class="t">know exactly what you were doing is very convenient, instead of having to like manually track it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1095" target="_blank">00:18:15.640</a></span> | <span class="t">in some sort of like, I guess, a big Excel sheet or some sort of journal or something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1100" target="_blank">00:18:20.080</a></span> | <span class="t">like that. Sometimes this is, you know, this is a lot more convenient, I feel so yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1105" target="_blank">00:18:25.480</a></span> | <span class="t">lest we get into too much billing for weights and biases, I'm going to put a slightly alternative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1111" target="_blank">00:18:31.760</a></span> | <span class="t">point of view, which is I don't use it or any experiment tracking framework myself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1120" target="_blank">00:18:40.760</a></span> | <span class="t">which is not to say maybe I could get some benefits by doing so, but I fairly intentionally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1126" target="_blank">00:18:46.400</a></span> | <span class="t">don't because I don't want to make it easy for myself to try 1000 different hyper parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1132" target="_blank">00:18:52.960</a></span> | <span class="t">or do kind of like, you know, directed, you know, sampling of things I like to be very,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1142" target="_blank">00:19:02.520</a></span> | <span class="t">like directed, you know. And so that's, that's kind of the workflow I'm looking for is one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1150" target="_blank">00:19:10.240</a></span> | <span class="t">that allows that to happen, right? Constantly going back and refactoring and thinking what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1154" target="_blank">00:19:14.360</a></span> | <span class="t">did I learn and how do I change things from here and never kind of doing like 17 learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1160" target="_blank">00:19:20.320</a></span> | <span class="t">rates and six architectures and whatever. Now, obviously, that's not something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1166" target="_blank">00:19:26.120</a></span> | <span class="t">John O is doing at the moment. I don't be so easy for him to get on if you want to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1172" target="_blank">00:19:32.440</a></span> | <span class="t">I can normally a script that just does a hundred runs with different models and different tasks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1177" target="_blank">00:19:37.520</a></span> | <span class="t">and then I can look at my weaknesses and say filter by the best loss, which is very tempting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1182" target="_blank">00:19:42.400</a></span> | <span class="t">So I would say to people like, yeah, definitely be aware that these tools exist. And I definitely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1187" target="_blank">00:19:47.600</a></span> | <span class="t">agree that as we do this, which is early 2023, weights and biases is by far the best one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1194" target="_blank">00:19:54.360</a></span> | <span class="t">I've seen. It has by far the best integration with fast AI. And as of today, if shadow is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1200" target="_blank">00:20:00.400</a></span> | <span class="t">pushed yet, it has by far the best integration with mini AI. I think also fast AI is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1208" target="_blank">00:20:08.160</a></span> | <span class="t">best library for using with weights and biases. It works in both ways. So yeah, no, it's there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1216" target="_blank">00:20:16.920</a></span> | <span class="t">Consider using it, but also consider not going crazy on on experiments because, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1227" target="_blank">00:20:27.040</a></span> | <span class="t">I think experiments have their place clearly, but also definitely thought out hypotheses,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1235" target="_blank">00:20:35.440</a></span> | <span class="t">testing them, changing your code is overall the approach that I think is best.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1240" target="_blank">00:20:40.880</a></span> | <span class="t">Well, thank you, John. I think that's awesome. I got some fun stuff to share as well, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1253" target="_blank">00:20:53.840</a></span> | <span class="t">at least I think it's fun. And what I wanted to share is like, well, the first of all,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1260" target="_blank">00:21:00.800</a></span> | <span class="t">I should say we had said, we all had said that we were going to look at units this week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1268" target="_blank">00:21:08.840</a></span> | <span class="t">We are not going to look at units this week, but we have good reason, which is that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1275" target="_blank">00:21:15.280</a></span> | <span class="t">had said we're going to go from foundations to stable diffusion. That was also a lie because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1280" target="_blank">00:21:20.920</a></span> | <span class="t">we're actually going beyond stable diffusion. And so we're actually going to start showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1286" target="_blank">00:21:26.240</a></span> | <span class="t">today some new research directions. I'm going to describe the process that I'm using at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1291" target="_blank">00:21:31.800</a></span> | <span class="t">the moment to investigate some new research directions. And we're also going to be looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1295" target="_blank">00:21:35.680</a></span> | <span class="t">at some other people's research directions that have gone beyond stable diffusion over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1301" target="_blank">00:21:41.560</a></span> | <span class="t">the past few months. So we will get to units, but we haven't quite finished, you know, as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1312" target="_blank">00:21:52.600</a></span> | <span class="t">it turns out, the training and sampling yet. Now, one challenge that I was having as I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1322" target="_blank">00:22:02.440</a></span> | <span class="t">started experimenting with new things was started getting to the point where actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1329" target="_blank">00:22:09.000</a></span> | <span class="t">the generated images looked pretty good and it felt like, you know, almost like being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1340" target="_blank">00:22:20.760</a></span> | <span class="t">a parent, you know, each time a new set of images would come out, I would want to convince</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1344" target="_blank">00:22:24.880</a></span> | <span class="t">myself that these were the most beautiful. And so, yeah, when they're crap, it's obvious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1353" target="_blank">00:22:33.200</a></span> | <span class="t">they're crap, you know, but when they're starting to look pretty good, it's very easy to convince</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1356" target="_blank">00:22:36.080</a></span> | <span class="t">yourself you're improving. So I wanted to have a metric which could tell me how good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1363" target="_blank">00:22:43.120</a></span> | <span class="t">they were. Now, unfortunately, there is no such metric. There's no metric that actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1370" target="_blank">00:22:50.040</a></span> | <span class="t">says do these images, would these images look to a human being like pictures of clothes?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1378" target="_blank">00:22:58.080</a></span> | <span class="t">Because only talking to a person can do that. But there are some metrics which give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1382" target="_blank">00:23:02.800</a></span> | <span class="t">an approximation of that. And as it turns out, these metrics are not actually a replacement</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1393" target="_blank">00:23:13.960</a></span> | <span class="t">for human beings looking at things, but they're a useful addition. So, and I certainly found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1402" target="_blank">00:23:22.840</a></span> | <span class="t">them useful. So I'm going to show you the two most common, well, there's really the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1406" target="_blank">00:23:26.280</a></span> | <span class="t">one most common metric, which is called FID, and I'm going to show another one called KID</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1412" target="_blank">00:23:32.120</a></span> | <span class="t">or KID. So let me describe and show how they work. And I'm going to demonstrate them using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1426" target="_blank">00:23:46.080</a></span> | <span class="t">the model we trained in the last lesson, which was in DDPM2. And you might remember, we trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1435" target="_blank">00:23:55.040</a></span> | <span class="t">one with mixed precision, and we saved it as fashion DDPM MP for mixed precision. Okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1444" target="_blank">00:24:04.760</a></span> | <span class="t">so this is all the usual imports and stuff. This is all the usual stuff. But there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1452" target="_blank">00:24:12.360</a></span> | <span class="t">slight difference this time, which is that we're going to try to get the FID for a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1458" target="_blank">00:24:18.000</a></span> | <span class="t">we've already trained. So basically, to get the model we've already trained to get its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1464" target="_blank">00:24:24.400</a></span> | <span class="t">FID, we can just torch.load it, right, and then .cuda to pop it on the GPU. So I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1471" target="_blank">00:24:31.200</a></span> | <span class="t">to call that the S model, which is the model for samples, the samples model. And this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1475" target="_blank">00:24:35.320</a></span> | <span class="t">just a copied and pasted DBPM from the last time. So that's for sampling. So we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1480" target="_blank">00:24:40.480</a></span> | <span class="t">to do sampling from that model. And so once we've sampled from the model, we're then going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1488" target="_blank">00:24:48.120</a></span> | <span class="t">to try and calculate this score called the FID. Now, what the FID is going to do is it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1496" target="_blank">00:24:56.720</a></span> | <span class="t">not going to say how good are these images. It's going to say how similar are they to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1505" target="_blank">00:25:05.360</a></span> | <span class="t">real images. And so the way we're going to do that is we're going to actually look specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1513" target="_blank">00:25:13.740</a></span> | <span class="t">at four of the images that we generated in these samples. We're going to look at some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1521" target="_blank">00:25:21.560</a></span> | <span class="t">statistics of some of the activations. So what we're going to do, we've generated these samples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1531" target="_blank">00:25:31.440</a></span> | <span class="t">and we're going to create a new data leader, which contains no training batches, and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1539" target="_blank">00:25:39.520</a></span> | <span class="t">contains one validation batch, which contains the samples. It doesn't actually matter what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1544" target="_blank">00:25:44.760</a></span> | <span class="t">the dependent variable is, so I just put in the same dependent variable that we already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1548" target="_blank">00:25:48.720</a></span> | <span class="t">had. And then what we're going to do is we're going to use that to extract some features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1558" target="_blank">00:25:58.520</a></span> | <span class="t">from a model. Now, what do we mean by that? So if you remember back to notebook 14, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1566" target="_blank">00:26:06.160</a></span> | <span class="t">created this thing called summary. And summary shows us at different blocks of our model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1575" target="_blank">00:26:15.080</a></span> | <span class="t">there are various different output shapes. In this case, it's a batch size of 102.4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1580" target="_blank">00:26:20.120</a></span> | <span class="t">And so after the first block, we had 16 channels, 28 by 28, and then we had 32 channels, 48</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1587" target="_blank">00:26:27.400</a></span> | <span class="t">by 14 and so forth until just before the final linear layer, we had the 1024 batches, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1598" target="_blank">00:26:38.640</a></span> | <span class="t">we had 512 channels with no height and width. Now, the idea of fit and kid is that the distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1609" target="_blank">00:26:49.000</a></span> | <span class="t">of these 512 channels for a real image has a particular kind of like signature, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1618" target="_blank">00:26:58.480</a></span> | <span class="t">It looks a particular way. And so what we're going to do is we're going to take our samples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1624" target="_blank">00:27:04.200</a></span> | <span class="t">we're going to run it through a model that's learned to predict, you know, fashion classes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1632" target="_blank">00:27:12.600</a></span> | <span class="t">and we're going to grab this layer, right? And then we're going to average it across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1638" target="_blank">00:27:18.760</a></span> | <span class="t">a batch, right, to get 512 numbers. And that's going to represent the mean of each of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1646" target="_blank">00:27:26.600</a></span> | <span class="t">channels. So those channels might represent, for example, does it have a pointed color?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1655" target="_blank">00:27:35.480</a></span> | <span class="t">Does it have, you know, smooth fabric? Does it have sharp heels and so forth, right? And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1666" target="_blank">00:27:46.240</a></span> | <span class="t">you could recognize that something's probably not a normal fashion image if it says, "Oh,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1671" target="_blank">00:27:51.640</a></span> | <span class="t">yes, it's got sharp heels and flowing fabric." It's like, "Oh, that doesn't sound like anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1678" target="_blank">00:27:58.640</a></span> | <span class="t">we recognize," right? So there are certain kind of like sets of means of these activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1685" target="_blank">00:28:05.280</a></span> | <span class="t">that don't make sense. So this is a metric for... it's not a metric for an individual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1693" target="_blank">00:28:13.840</a></span> | <span class="t">image necessarily, but it's across a whole lot of images. So if I generate a bunch of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1699" target="_blank">00:28:19.520</a></span> | <span class="t">fashion images, and I want to say, does this look like a bunch of fashion images? If I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1703" target="_blank">00:28:23.680</a></span> | <span class="t">look at the mean, like maybe X percent have this feature and X percent have that feature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1708" target="_blank">00:28:28.440</a></span> | <span class="t">So if I'm looking at those means, as like comparing the distribution within all these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1711" target="_blank">00:28:31.760</a></span> | <span class="t">images I generated, do roughly the same amount have sharp colors as those in the trend?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1717" target="_blank">00:28:37.160</a></span> | <span class="t">Yeah, that's a very good point, too.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1719" target="_blank">00:28:39.480</a></span> | <span class="t">Yeah, and it's actually gonna get even more sophisticated than that. But let's just start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1724" target="_blank">00:28:44.480</a></span> | <span class="t">at that level, which is this features.bin. So the basic idea here is that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1731" target="_blank">00:28:51.040</a></span> | <span class="t">to take our samples and we're going to pass them through a pre-trained model that has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1737" target="_blank">00:28:57.080</a></span> | <span class="t">learned to predict what type of fashion something is. And of course, we train some of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1744" target="_blank">00:29:04.720</a></span> | <span class="t">in this notebook. And specifically, we trained a nice 20 epoch one in the data augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1753" target="_blank">00:29:13.160</a></span> | <span class="t">section, which had a 94.3% accuracy. And so if we pass our samples through this model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1762" target="_blank">00:29:22.960</a></span> | <span class="t">we would expect to get some, you know, useful features. One thing that I found made this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1769" target="_blank">00:29:29.680</a></span> | <span class="t">a bit complicated, though, is that this model was trained using data that had gone through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1776" target="_blank">00:29:36.200</a></span> | <span class="t">this transformation of subtracting the mean and dividing by the standard deviation. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1784" target="_blank">00:29:44.200</a></span> | <span class="t">that's not what we're creating in our samples. And so, generally speaking, samples in most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1795" target="_blank">00:29:55.000</a></span> | <span class="t">of these kinds of diffusion models tend to be between negative one and one. So I actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1801" target="_blank">00:30:01.560</a></span> | <span class="t">added a new section to the very bottom of this notebook, which simply replaces the transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1808" target="_blank">00:30:08.520</a></span> | <span class="t">with something that goes from negative one to one and just creates those data loaders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1814" target="_blank">00:30:14.400</a></span> | <span class="t">and then trains something that can classify fashion. And I save this as not data aug, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1822" target="_blank">00:30:22.560</a></span> | <span class="t">data aug two. So this is just exactly the same as before, but it's a fashion classifier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1828" target="_blank">00:30:28.920</a></span> | <span class="t">where the inputs are expected to be between minus one and one. Having said that, it turns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1835" target="_blank">00:30:35.720</a></span> | <span class="t">out that our samples are not between minus one and one. But actually, if you go back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1845" target="_blank">00:30:45.360</a></span> | <span class="t">and you look at DDPM2, we just use TF dot to tensor, and that actually makes images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1854" target="_blank">00:30:54.520</a></span> | <span class="t">that are between zero and one. So actually, that's a bug. Okay, so our images have a bug,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1864" target="_blank">00:31:04.640</a></span> | <span class="t">which is they go between zero and one. So we'll look at fixing that in a moment. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1867" target="_blank">00:31:07.840</a></span> | <span class="t">for now, we're just trying to get the fit of our existing model. So let's do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1873" target="_blank">00:31:13.320</a></span> | <span class="t">So what we need to do is we need to take the output of our model, and we need to multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1881" target="_blank">00:31:21.360</a></span> | <span class="t">by two, so that'll be between zero and two, and subtract one. So that'll change our samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1886" target="_blank">00:31:26.520</a></span> | <span class="t">to be between minus one and one, and we can now pass them through our pre-trained fashion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1892" target="_blank">00:31:32.480</a></span> | <span class="t">classifier. Okay, so now, how do we get the output of that pooling layer? Because that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1900" target="_blank">00:31:40.480</a></span> | <span class="t">actually what we want to remind you. We want the output of this layer. So just to kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1915" target="_blank">00:31:55.200</a></span> | <span class="t">of flex our PyTorch muscles, I'm going to show a couple of ways to do it. So we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1922" target="_blank">00:32:02.440</a></span> | <span class="t">to load the model I just trained, the data or to model. And what we could do is, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1928" target="_blank">00:32:08.740</a></span> | <span class="t">we could use a hook. And we have a hooks callback. So we could just create a function, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1937" target="_blank">00:32:17.080</a></span> | <span class="t">just depends the output. So very straightforward. Okay, so that's what we want. We want the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1942" target="_blank">00:32:22.960</a></span> | <span class="t">output. And specifically, it's, so we've got these are all sequentials. So we can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1952" target="_blank">00:32:32.320</a></span> | <span class="t">go through and go, oh, one, two, three, four, five, the layer that we want. Okay, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1957" target="_blank">00:32:37.760</a></span> | <span class="t">that's the module that we want to hook. So once we've hooked that, we can pass that as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1963" target="_blank">00:32:43.480</a></span> | <span class="t">a callback. And we can then, it's a bit weird calling fit, I suppose, because we're saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1969" target="_blank">00:32:49.720</a></span> | <span class="t">train equals false, but we're just basically capturing. This is just to put make one batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1974" target="_blank">00:32:54.640</a></span> | <span class="t">go through and grab the outputs. So this means now in our hook, there's never gonna be thinking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1982" target="_blank">00:33:02.400</a></span> | <span class="t">called out P, because we put it there. And we can grab, for example, a few of those to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1989" target="_blank">00:33:09.000</a></span> | <span class="t">have a look. And yep, here, we've got a 64 by 512 set of features. Okay, so that's one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=1995" target="_blank">00:33:15.600</a></span> | <span class="t">way we can do it. Another way we could do it is that actually sequential models are what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2004" target="_blank">00:33:24.640</a></span> | <span class="t">called in Python collections, they have certain certain API that they're expected to support.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2011" target="_blank">00:33:31.960</a></span> | <span class="t">And out of something a collection can do like a list is you can call Dell to delete something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2019" target="_blank">00:33:39.120</a></span> | <span class="t">So we can delete this layer and this layer and be left with just these layers. And once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2028" target="_blank">00:33:48.880</a></span> | <span class="t">we do that, that means we can just call capture Preds, because now they don't have the last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2033" target="_blank">00:33:53.260</a></span> | <span class="t">two layers. So we can just delete layers eight and seven call capture Preds. And one nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2040" target="_blank">00:34:00.440</a></span> | <span class="t">thing about this is it's going to give us the entire 10,000 images in the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2048" target="_blank">00:34:08.560</a></span> | <span class="t">So that's what I ended up deciding to do. There's lots of other ways I played around with which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2052" target="_blank">00:34:12.320</a></span> | <span class="t">worked, but I decided to show these two as being two good, pretty good techniques. Okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2057" target="_blank">00:34:17.960</a></span> | <span class="t">so now we've got what do 1000 real images look like at the end of the pooling layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2065" target="_blank">00:34:25.240</a></span> | <span class="t">So now we need to do the same for our sample. So we'll load up our fashion DDPM MP, we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2074" target="_blank">00:34:34.240</a></span> | <span class="t">sample, let's just grab 256 images for now, make them go between minus one and one, make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2081" target="_blank">00:34:41.840</a></span> | <span class="t">sure they look okay. And as I described before, create a data loaders where the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2087" target="_blank">00:34:47.440</a></span> | <span class="t">set just has one batch, which contains our samples and call capture Preds. Okay, so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2100" target="_blank">00:35:00.000</a></span> | <span class="t">going to give us our features. And the reason why is because we're passing the sample to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2109" target="_blank">00:35:09.920</a></span> | <span class="t">model and model is the classifier, which we've deleted the last two layers from. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2119" target="_blank">00:35:19.720</a></span> | <span class="t">going to give us our 256 by 512. So now we can get the means now. That's not really enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2134" target="_blank">00:35:34.080</a></span> | <span class="t">to tell us whether something is looks like real images. So maybe I should draw here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2144" target="_blank">00:35:44.340</a></span> | <span class="t">So we started out with our batch of 256, 256, and our channels of 512. And we squished them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2171" target="_blank">00:36:11.680</a></span> | <span class="t">by taking their mean. So it's now just 256 a vector. So this is the, so wrong way around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2187" target="_blank">00:36:27.880</a></span> | <span class="t">We squished them this way, 512, because this is the main for each channel. Okay. And we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2202" target="_blank">00:36:42.320</a></span> | <span class="t">did exactly the same thing for the much bigger, you know, full set of real images. So this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2209" target="_blank">00:36:49.400</a></span> | <span class="t">is our samples and this is our real. But when we squish it, that was 10,000 by 512, we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2222" target="_blank">00:37:02.560</a></span> | <span class="t">again 512. So we could now compare these two, right? But, you know, you could absolutely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2234" target="_blank">00:37:14.280</a></span> | <span class="t">have some samples that don't look anything like images, but have similar averages for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2241" target="_blank">00:37:21.440</a></span> | <span class="t">each channel. So we do a second thing, which is we create a covariance matrix. Now, if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2250" target="_blank">00:37:30.320</a></span> | <span class="t">you've forgotten what this is, you should go back to our previous lesson where we looked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2253" target="_blank">00:37:33.600</a></span> | <span class="t">at it, but just remind you a covariance matrix says, in this case, we do it across the channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2261" target="_blank">00:37:41.200</a></span> | <span class="t">So it's going to be 512 by 512. So it's going to take each of these columns, and it says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2271" target="_blank">00:37:51.840</a></span> | <span class="t">in each cell, so here's cell one, one, basically it says, what's the difference between it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2281" target="_blank">00:38:01.680</a></span> | <span class="t">basically it's saying, what's the difference between each row, each element here and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2286" target="_blank">00:38:06.120</a></span> | <span class="t">mean of the whole column, multiplied by exactly the same thing for a different column. Now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2293" target="_blank">00:38:13.880</a></span> | <span class="t">on the diagonal, it's the same column twice. So that means that these in the diagonal is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2299" target="_blank">00:38:19.400</a></span> | <span class="t">just the variance, right? But more interestingly, the ones in the off diagonal, like here, is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2307" target="_blank">00:38:27.520</a></span> | <span class="t">actually saying, what's the relationship between column one and column two, right? So if column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2314" target="_blank">00:38:34.660</a></span> | <span class="t">one and column two are uncorrelated, then this would be zero, right? If they were identical,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2321" target="_blank">00:38:41.760</a></span> | <span class="t">right, then it would be the same as the variance in here. So it's how correlated are they.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2329" target="_blank">00:38:49.320</a></span> | <span class="t">And why is this interesting? Well, if we do the same, exactly the same thing for the reals,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2335" target="_blank">00:38:55.320</a></span> | <span class="t">that's going to give us another 512 by 512. And it's going to say things like, so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2341" target="_blank">00:39:01.200</a></span> | <span class="t">say this first column was kind of like that, you know, doesn't have pointy heels, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2348" target="_blank">00:39:08.920</a></span> | <span class="t">And sorry, heels, spell. And the second one might be, doesn't have flowing fabric, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2357" target="_blank">00:39:17.720</a></span> | <span class="t">And this is where we say, okay, if, you know, generally speaking, you would expect these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2363" target="_blank">00:39:23.300</a></span> | <span class="t">to be negatively correlated, right? So over here in the reals, this is probably going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2370" target="_blank">00:39:30.640</a></span> | <span class="t">to have a negative, right? Whereas if over here it was like zero or even worse if it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2376" target="_blank">00:39:36.760</a></span> | <span class="t">positive, it'd be like, oh, those are probably not real, right? Because it's very unlikely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2381" target="_blank">00:39:41.560</a></span> | <span class="t">you're going to have images that have both, where pointy heels are positively associated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2386" target="_blank">00:39:46.280</a></span> | <span class="t">with a flowing fabric. So we're basically looking for two data sets where their covariance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2396" target="_blank">00:39:56.560</a></span> | <span class="t">matrices are kind of the same and their means are also kind of the same. All right. So there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2408" target="_blank">00:40:08.760</a></span> | <span class="t">are ways of comparing these, you know, basically comparing two sets of data to say, are they,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2424" target="_blank">00:40:24.000</a></span> | <span class="t">you know, from the same distribution? And you can broadly think of it as being like, oh,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2428" target="_blank">00:40:28.440</a></span> | <span class="t">do they have pretty similar covariance matrices? So they have pretty similar mean vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2435" target="_blank">00:40:35.400</a></span> | <span class="t">And so this is basically what the fresh A inception distance does. Does that make sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2443" target="_blank">00:40:43.320</a></span> | <span class="t">so far, guys?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2445" target="_blank">00:40:45.600</a></span> | <span class="t">Yes. It's, when he's striking me now, I was from the similarity as to when we were talking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2453" target="_blank">00:40:53.280</a></span> | <span class="t">about like the style loss and those kinds of things. How do we get the types of features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2458" target="_blank">00:40:58.600</a></span> | <span class="t">that occur together without worrying about like which I data is in the data, the grams</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2464" target="_blank">00:41:04.080</a></span> | <span class="t">matrices or whatever. Yeah. Now the particular way of comparing. So, okay. So I've got the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2475" target="_blank">00:41:15.880</a></span> | <span class="t">means and I've got the covariances for my samples. And I've actually just created this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2484" target="_blank">00:41:24.080</a></span> | <span class="t">little calc stats, right? So I always, I'm showing you how I build things, not just things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2488" target="_blank">00:41:28.760</a></span> | <span class="t">that are built, right? So I always create things step by step and check their shapes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2492" target="_blank">00:41:32.680</a></span> | <span class="t">right? And then I paste them into our merge the cells, copy the cells and merge them into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2498" target="_blank">00:41:38.440</a></span> | <span class="t">functions. So here's something that gets the means and the covariance matrix. So then I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2507" target="_blank">00:41:47.000</a></span> | <span class="t">basically do recall that both for my sample features and for my features of the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2513" target="_blank">00:41:53.920</a></span> | <span class="t">data set or the test set and the data set. Now, what I now do with that, if they have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2521" target="_blank">00:42:01.600</a></span> | <span class="t">those, now they have those features, I can calculate this thing called the fresh A inception</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2525" target="_blank">00:42:05.080</a></span> | <span class="t">distance, which is here. And basically what happens is we multiply together the two covariance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2534" target="_blank">00:42:14.160</a></span> | <span class="t">matrices and that's now going to make them like bigger, right? So we now need to basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2542" target="_blank">00:42:22.640</a></span> | <span class="t">scale that down again. Now, if we were working with, you know, non-matrices, you know, if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2551" target="_blank">00:42:31.080</a></span> | <span class="t">you kind of like multiply two things together, then to kind of bring it back down to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2557" target="_blank">00:42:37.240</a></span> | <span class="t">original scale, you know, you could kind of like take the square root, right? So particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2561" target="_blank">00:42:41.800</a></span> | <span class="t">if it was by itself, you took the square root, you get back to the original. And so we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2565" target="_blank">00:42:45.960</a></span> | <span class="t">to do exactly the same thing to renormalize these matrices. The problem is that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2572" target="_blank">00:42:52.320</a></span> | <span class="t">got matrices and we need to take the matrix square root. Now the matrix square root, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2582" target="_blank">00:43:02.040</a></span> | <span class="t">might not have come across this before, but it exists and it's the thing where the matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2589" target="_blank">00:43:09.800</a></span> | <span class="t">square root of the matrix A times itself is A. Now, I'm going to slightly cheat because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2599" target="_blank">00:43:19.600</a></span> | <span class="t">we've used the float square root before and we did not re-implement it from scratch because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2605" target="_blank">00:43:25.120</a></span> | <span class="t">it's in the Python standard library and also it wouldn't be particularly interesting. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2609" target="_blank">00:43:29.320</a></span> | <span class="t">basically the way you can calculate the float square root from scratch is by using, there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2616" target="_blank">00:43:36.360</a></span> | <span class="t">lots of ways, but you know, the classic way that you might have done it in high school</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2619" target="_blank">00:43:39.680</a></span> | <span class="t">is to use Newton's method, which is where you basically can solve if you're trying to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2625" target="_blank">00:43:45.040</a></span> | <span class="t">calculate A equals root x, then you're basically saying A squared equals x, which means you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2637" target="_blank">00:43:57.360</a></span> | <span class="t">saying A squared minus x equals zero. And that's an equation that you can solve and you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2645" target="_blank">00:44:05.560</a></span> | <span class="t">solve it by basically taking the derivative and taking a step along the derivative a bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2649" target="_blank">00:44:09.880</a></span> | <span class="t">of times. You can basically do the same thing to calculate the matrix square root. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2661" target="_blank">00:44:21.880</a></span> | <span class="t">here it is, right? It's the Newton method, but because it's for matrices it's slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2666" target="_blank">00:44:26.960</a></span> | <span class="t">more complicated, so it's a short method and I'm not going to go through it, but it's basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2672" target="_blank">00:44:32.240</a></span> | <span class="t">the same deal. You go through up to 100 iterations and you basically do something like traveling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2680" target="_blank">00:44:40.320</a></span> | <span class="t">along that kind of derivative and then you say, okay, well, the result times itself ought</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2689" target="_blank">00:44:49.440</a></span> | <span class="t">to equal the original matrix. So let's subtract the matrix times itself from the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2694" target="_blank">00:44:54.960</a></span> | <span class="t">matrix and see whether the absolute value is small and if it is, we've calculated it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2700" target="_blank">00:45:00.920</a></span> | <span class="t">Okay. So that's basically how we do a matrix square root. So we do, that's that. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2707" target="_blank">00:45:07.400</a></span> | <span class="t">now that we have strictly speaking, implemented from scratch, we're allowed to use the one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2710" target="_blank">00:45:10.520</a></span> | <span class="t">that already exists. iTorch doesn't have one, sadly, so we have to use the one from SciPy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2717" target="_blank">00:45:17.520</a></span> | <span class="t">SciPy.minelk. So this is basically going to give us a measure of similarity between the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2728" target="_blank">00:45:28.280</a></span> | <span class="t">two covariance matrices. And then we, here's the measure of similarity between the two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2736" target="_blank">00:45:36.840</a></span> | <span class="t">mean matrices, which is just the sum of squared errors. And then basically for reasons that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2742" target="_blank">00:45:42.300</a></span> | <span class="t">aren't really interesting, but it's just normalizing, we subtract what's called the trace, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2746" target="_blank">00:45:46.640</a></span> | <span class="t">is the sum of the diagonal elements, and we subtract two times the trace of this thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2753" target="_blank">00:45:53.920</a></span> | <span class="t">And that's called the Frechet Inception Distance. So a bit hand wavy on the math, because I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2759" target="_blank">00:45:59.400</a></span> | <span class="t">don't think it's particularly relevant to anything, but it gives you a number which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2764" target="_blank">00:46:04.720</a></span> | <span class="t">represents how similar is, you know, this for the samples to this for some real data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2777" target="_blank">00:46:17.640</a></span> | <span class="t">Now it's weird, it's called Frechet Inception Distance when we've done nothing to do with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2782" target="_blank">00:46:22.400</a></span> | <span class="t">Inception. Well, the reason why is that people do not normally use the fast.ai part two custom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2790" target="_blank">00:46:30.960</a></span> | <span class="t">fashioned MNIST data org 2.pickle. They normally use a more famous model. They normally use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2798" target="_blank">00:46:38.200</a></span> | <span class="t">the Inception model, which was an image net winning model from Google Brain from a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2804" target="_blank">00:46:44.080</a></span> | <span class="t">years ago. There's no reason whatsoever that Inception is a good model to use for this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2811" target="_blank">00:46:51.120</a></span> | <span class="t">it just happens to be the one which the original paper used. And as a result, everybody now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2816" target="_blank">00:46:56.880</a></span> | <span class="t">uses that not because they sheep, but because you want to be able to compare your results</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2822" target="_blank">00:47:02.440</a></span> | <span class="t">with other papers results, perhaps. We actually don't. We actually want to compare our results</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2828" target="_blank">00:47:08.760</a></span> | <span class="t">from our other results, and we're going to get a much more accurate metric if we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2836" target="_blank">00:47:16.200</a></span> | <span class="t">a model that's good specifically at recognizing fashion. So that's why we're using this. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2843" target="_blank">00:47:23.840</a></span> | <span class="t">very, very few people bother to use this. Most people just hip install Python fit or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2850" target="_blank">00:47:30.000</a></span> | <span class="t">whatever it's called and use Inception, but it's actually better to use. Now, unless you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2855" target="_blank">00:47:35.000</a></span> | <span class="t">comparing to papers, it's better to use a model that you've trained on your data and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2858" target="_blank">00:47:38.680</a></span> | <span class="t">you know is good at that. So I guess this is not a fit, it's a... Well, maybe fit now stands</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2866" target="_blank">00:47:46.960</a></span> | <span class="t">for fashion, no fashion, MNIST. I don't know what it stands for. I should have did something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2874" target="_blank">00:47:54.920</a></span> | <span class="t">I wanted to bring up two other caveats of FID, especially then like in papers is like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2882" target="_blank">00:48:02.920</a></span> | <span class="t">the other thing is that FID is dependent on the number of samples that you use. So as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2888" target="_blank">00:48:08.800</a></span> | <span class="t">the number of samples they use for measuring FID, it's more accurate if you use more samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2895" target="_blank">00:48:15.580</a></span> | <span class="t">and it's less accurate if you use less samples. Well, that's actually biased. So if you use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2900" target="_blank">00:48:20.760</a></span> | <span class="t">less samples, it's too high specifically. Yeah. So in papers, you'll see them report</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2908" target="_blank">00:48:28.880</a></span> | <span class="t">how many samples they used. And so even then comparing to other papers and comparing between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2914" target="_blank">00:48:34.360</a></span> | <span class="t">different models and different things, you want to make sure that you're comparing with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2917" target="_blank">00:48:37.440</a></span> | <span class="t">the same amount of samples. Otherwise, it might just be high because they just use less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2921" target="_blank">00:48:41.400</a></span> | <span class="t">number of samples or something like this. So you want to make sure that's comparable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2925" target="_blank">00:48:45.640</a></span> | <span class="t">And then the other thing that is because I guess it's a kind of a side effect of using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2930" target="_blank">00:48:50.680</a></span> | <span class="t">the Inception network in these papers is the fact that all of these are at a size 299 by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2938" target="_blank">00:48:58.000</a></span> | <span class="t">299, which is like the size that the Inception model was trained. So actually, when you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2943" target="_blank">00:49:03.760</a></span> | <span class="t">applying this Inception network for measuring this distance, you're going to be resizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2948" target="_blank">00:49:08.680</a></span> | <span class="t">your images to 299 by 299, which in different cases that may not make much sense. So like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2955" target="_blank">00:49:15.520</a></span> | <span class="t">in our case, we're working with 32 by 32 or 28 by 28 images. These are very small images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2961" target="_blank">00:49:21.840</a></span> | <span class="t">and if you resize it to 299, or in other cases, this is now kind of an issue with some of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2967" target="_blank">00:49:27.960</a></span> | <span class="t">these latest models, you have these large 512 by 512 or 1024 by 1024 images. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2975" target="_blank">00:49:35.720</a></span> | <span class="t">you're, you know, kind of shrinking these images to 299 by 299. And you're losing a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2981" target="_blank">00:49:41.160</a></span> | <span class="t">lot of that detail and quality in those images. So actually, it's kind of become a problem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2986" target="_blank">00:49:46.840</a></span> | <span class="t">with some of these latest papers, when you look at the FID scores and how they're comparing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2990" target="_blank">00:49:50.720</a></span> | <span class="t">them. And then visually, when you see them, you can kind of notice, oh, yeah, these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2994" target="_blank">00:49:54.460</a></span> | <span class="t">much better images, but the FID score doesn't capture that as well, because you're actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=2999" target="_blank">00:49:59.120</a></span> | <span class="t">using these much smaller images. So there are a bunch of different caveats. And so FID,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3004" target="_blank">00:50:04.680</a></span> | <span class="t">you know, it's very good for like, yeah, it's nice and simple and automated for this sort</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3008" target="_blank">00:50:08.720</a></span> | <span class="t">of comparison, but you have to be aware of all these different caveats of this metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3012" target="_blank">00:50:12.720</a></span> | <span class="t">as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3013" target="_blank">00:50:13.840</a></span> | <span class="t">So excellent segue, because we're going to look at exactly those two things right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3020" target="_blank">00:50:20.320</a></span> | <span class="t">And in fact, there is a metric that compares the two distributions in a way that is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3027" target="_blank">00:50:27.720</a></span> | <span class="t">biased. So it's not necessarily higher or lower if you use more or less samples, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3033" target="_blank">00:50:33.760</a></span> | <span class="t">it's called the KID or KID, which is the kernel inception distance. It's actually significantly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3040" target="_blank">00:50:40.800</a></span> | <span class="t">simpler to calculate than the fresh A inception distance. And basically, what you do is you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3048" target="_blank">00:50:48.320</a></span> | <span class="t">create a bunch of groups, a bunch of partitions, and you go through each of those partitions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3054" target="_blank">00:50:54.880</a></span> | <span class="t">and you grab a few of your X's at a time and a few of your Y's at a time. And then you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3062" target="_blank">00:51:02.040</a></span> | <span class="t">calculate something called the MMD, which is here, which is basically that, again, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3071" target="_blank">00:51:11.560</a></span> | <span class="t">details don't really matter. We basically do a matrix product and we actually take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3080" target="_blank">00:51:20.480</a></span> | <span class="t">Q of it. This K is the kernel. And we basically do that for the first sample by its, compared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3087" target="_blank">00:51:27.640</a></span> | <span class="t">to itself, the second compared to itself, and the first compared to the second. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3093" target="_blank">00:51:33.560</a></span> | <span class="t">we then normalize them in various ways and add the two with themselves together and subtract</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3101" target="_blank">00:51:41.520</a></span> | <span class="t">the, with the other one. And this one actually does not use the stats. It doesn't use the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3110" target="_blank">00:51:50.320</a></span> | <span class="t">means and covariance metrics. It uses the features directly. And the actual final result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3120" target="_blank">00:52:00.720</a></span> | <span class="t">is basically the mean of this calculated across different little batches. Yeah, again, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3128" target="_blank">00:52:08.320</a></span> | <span class="t">math doesn't really matter as to exactly why all these are exactly what they are, but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3135" target="_blank">00:52:15.440</a></span> | <span class="t">going to give you, again, a measure of the similarity of these two distributions. At</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3141" target="_blank">00:52:21.560</a></span> | <span class="t">first I was confused as to why more people weren't using this because people don't tend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3146" target="_blank">00:52:26.560</a></span> | <span class="t">to use this and it doesn't have this, a nasty bias problem. And now that I've been using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3150" target="_blank">00:52:30.720</a></span> | <span class="t">it for a while, I know why, which is that it has a very high variance, which means when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3155" target="_blank">00:52:35.440</a></span> | <span class="t">I call it multiple times with just like samples with different random seeds, I get very different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3161" target="_blank">00:52:41.560</a></span> | <span class="t">values. And so I actually haven't found this used at all. So we left in the situation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3171" target="_blank">00:52:51.560</a></span> | <span class="t">which is, yeah, we don't actually have a good unbiased metric. And I think that's the truth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3177" target="_blank">00:52:57.340</a></span> | <span class="t">of where we are, the best practices. And even if we did, all I would tell you is like how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3184" target="_blank">00:53:04.580</a></span> | <span class="t">similar distributions are to each other. It doesn't actually tell you whether they look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3187" target="_blank">00:53:07.700</a></span> | <span class="t">any good, really. So that's why pretty much all good papers, they have a section on human</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3194" target="_blank">00:53:14.140</a></span> | <span class="t">testing. But I've definitely found this fairly useful for me for like comparing fashion images,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3202" target="_blank">00:53:22.040</a></span> | <span class="t">which particularly like humans are good at looking at like faces that are reasonably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3206" target="_blank">00:53:26.000</a></span> | <span class="t">high resolution and be like, "Oh, that eye looks kind of weird," but we're not good at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3209" target="_blank">00:53:29.880</a></span> | <span class="t">looking at 28 by 28 fashion images. So it's particularly helpful for stuff that our brains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3215" target="_blank">00:53:35.560</a></span> | <span class="t">aren't good at. So I basically wrapped this up into a class, which I call image eval for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3220" target="_blank">00:53:40.600</a></span> | <span class="t">evaluating images. And so what you're going to do is you're going to pass in a pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3226" target="_blank">00:53:46.520</a></span> | <span class="t">model for a classifier and your data loaders, which is the thing that we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3234" target="_blank">00:53:54.880</a></span> | <span class="t">to basically calculate the real images. So that's going to be the data loaders that were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3244" target="_blank">00:54:04.440</a></span> | <span class="t">in this learn, so the real images. And so what it's going to do in this class, then again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3252" target="_blank">00:54:12.520</a></span> | <span class="t">this is just copying and pasting the previous lines of code and putting them into a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3255" target="_blank">00:54:15.800</a></span> | <span class="t">This is going to be then something that we call capture preds on to get our features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3261" target="_blank">00:54:21.600</a></span> | <span class="t">for the real images, and then we can also calculate the stats for the real images. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3267" target="_blank">00:54:27.680</a></span> | <span class="t">so then we can call fit by calling calc fit, which is the thing we already had, passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3274" target="_blank">00:54:34.780</a></span> | <span class="t">in the stats for the real images and calculate the stats for the features from our samples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3282" target="_blank">00:54:42.640</a></span> | <span class="t">where the features, the thing that we've seen before, we pass in our samples, any random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3288" target="_blank">00:54:48.560</a></span> | <span class="t">Y value is fine, so I just have a single tensor there and call capture preds. So we can now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3294" target="_blank">00:54:54.600</a></span> | <span class="t">create an image eval object passing in our classifier, passing in our data loaders with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3303" target="_blank">00:55:03.240</a></span> | <span class="t">the real data, any other callbacks you want. And if we call fit, it takes about a quarter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3309" target="_blank">00:55:09.200</a></span> | <span class="t">of a second and 33.9 is the fit for our samples. So something that I think, okay, then kid,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3319" target="_blank">00:55:19.800</a></span> | <span class="t">kid's very going to be a very different scale. It's only 0.05, so kids are generally much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3324" target="_blank">00:55:24.200</a></span> | <span class="t">smaller than fits. So I'm mainly going to be looking at fits. And so here's what happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3331" target="_blank">00:55:31.320</a></span> | <span class="t">if we call fit on sample zero and then sample 50 and then sample 100 and so forth, all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3338" target="_blank">00:55:38.760</a></span> | <span class="t">way up to 900. And then we also do samples 975, 990, and 999. And so you can see over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3346" target="_blank">00:55:46.760</a></span> | <span class="t">time, our samples fits improved. So that's a good little test. There's something curious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3353" target="_blank">00:55:53.640</a></span> | <span class="t">about the fact that they stopped improving about here. So that's interesting. I've not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3359" target="_blank">00:55:59.120</a></span> | <span class="t">seen anybody plot this graph before. I don't know if Jono or Tanishk, if you guys have,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3363" target="_blank">00:56:03.280</a></span> | <span class="t">I feel like it's something people should be looking at because it's really telling you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3369" target="_blank">00:56:09.260</a></span> | <span class="t">it's your sampling, making consistent improvements.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3372" target="_blank">00:56:12.920</a></span> | <span class="t">And to clarify, this is like the predicted de-noised sample at the different stages during</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3377" target="_blank">00:56:17.860</a></span> | <span class="t">sampling, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3378" target="_blank">00:56:18.860</a></span> | <span class="t">Yes, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3379" target="_blank">00:56:19.860</a></span> | <span class="t">If I was to stop something now and just go straight to the predicted X error, what would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3383" target="_blank">00:56:23.960</a></span> | <span class="t">the fit be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3384" target="_blank">00:56:24.960</a></span> | <span class="t">So I just want to check our samples. Yeah, we preset, we add the X naught hat at each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3390" target="_blank">00:56:30.920</a></span> | <span class="t">time. Yep. Yep, exactly. Same for kid. And I was hoping that they would look the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3398" target="_blank">00:56:38.580</a></span> | <span class="t">and they do. So that's encouraging that kid and fit are basically measuring the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3403" target="_blank">00:56:43.480</a></span> | <span class="t">And then something else that I haven't seen people do, but I think it's a very good idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3407" target="_blank">00:56:47.040</a></span> | <span class="t">is to take the fit of an actual batch of data. Okay. And so that tells us how good we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3413" target="_blank">00:56:53.040</a></span> | <span class="t">get. Now that's a bit unfair because I think the different sizes, our data is 512, our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3422" target="_blank">00:57:02.440</a></span> | <span class="t">sample is 256, but anyway, it's a pretty huge difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3429" target="_blank">00:57:09.240</a></span> | <span class="t">And then, yeah, the second thing that Tanishk talked about, which I thought I'd actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3432" target="_blank">00:57:12.600</a></span> | <span class="t">show is what does it take to get a real fit to use the Inception Network? So I didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3440" target="_blank">00:57:20.920</a></span> | <span class="t">particularly feel like re-ellementing the Inception Network. So I guess I'm cheating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3444" target="_blank">00:57:24.240</a></span> | <span class="t">here. I'm just going to grab it from itorchfit. But there's absolutely no reason to study</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3449" target="_blank">00:57:29.800</a></span> | <span class="t">the Inception Network because it's totally obsolete at this point. And as Tanishk mentioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3457" target="_blank">00:57:37.120</a></span> | <span class="t">it wants 299 by 299 images, which actually you can just call resize input to have that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3463" target="_blank">00:57:43.160</a></span> | <span class="t">done for you. It also expects three-channel images. So what I did is I created a wrapper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3472" target="_blank">00:57:52.520</a></span> | <span class="t">for an Inception v3 model that when you call forward, it takes your batch and replicates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3485" target="_blank">00:58:05.000</a></span> | <span class="t">the channel three times. So that's basically creating a three-channel version of a black</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3492" target="_blank">00:58:12.160</a></span> | <span class="t">and white image just by replicating it three times. So with that wrapping, and again, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3498" target="_blank">00:58:18.480</a></span> | <span class="t">is good flexing of your PyTorch muscles. Try to make sure you can replicate this, that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3506" target="_blank">00:58:26.400</a></span> | <span class="t">you can get an Inception model working on your batch and MNIST samples. And yeah, then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3516" target="_blank">00:58:36.120</a></span> | <span class="t">from there, we can just pass that to our image eval instead. And so on our samples, that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3523" target="_blank">00:58:43.760</a></span> | <span class="t">gives us 63.8. And on a real batch of data, it gives 27.9. And I find this a good sign</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3531" target="_blank">00:58:51.720</a></span> | <span class="t">that this is much less effective than our real-fashioned MNIST classifier because that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3537" target="_blank">00:58:57.920</a></span> | <span class="t">only a difference of a ratio of three or so. The fact that our FID for real data using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3548" target="_blank">00:59:08.000</a></span> | <span class="t">a real classifier was 6.6, I think that's pretty encouraging. Yeah, so that is that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3558" target="_blank">00:59:18.080</a></span> | <span class="t">And we now have a FID. More specifically, we now have an image eval. Did you guys have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3566" target="_blank">00:59:26.420</a></span> | <span class="t">any questions or comments about that before we keep going?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3570" target="_blank">00:59:30.960</a></span> | <span class="t">No.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3571" target="_blank">00:59:31.960</a></span> | <span class="t">Let's begin that pretty much every other FIDGC reported is going to be set up for CIFAR-10,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3581" target="_blank">00:59:41.360</a></span> | <span class="t">tiny 32 by 32 pixels resized up to 299 and fed through Inception that was trained on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3586" target="_blank">00:59:46.400</a></span> | <span class="t">imaging, not CIFAR-10. Yeah, it's bearing in mind that, once again, this is a slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3591" target="_blank">00:59:51.880</a></span> | <span class="t">weird metric. And even things like the types of image, like the imagery sizing algorithms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3597" target="_blank">00:59:57.140</a></span> | <span class="t">in PyTorch Intensiflow might be slightly different. Or if you saved your images as JPEGs and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3602" target="_blank">01:00:02.640</a></span> | <span class="t">then reloaded them, your FID might be twice as bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3605" target="_blank">01:00:05.880</a></span> | <span class="t">Yeah, it makes a big difference. Yeah, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3609" target="_blank">01:00:09.880</a></span> | <span class="t">So just to reiterate, the takeaway from all of this that I get is that it's really useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3616" target="_blank">01:00:16.080</a></span> | <span class="t">Everything's the same, like using the same backbone model, using the same approach, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3620" target="_blank">01:00:20.440</a></span> | <span class="t">same number of samples, then you can compare it to other samples. But yeah, for one set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3627" target="_blank">01:00:27.000</a></span> | <span class="t">of experiments, a FIDGC might be good, because it's the way everything's set up. And for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3631" target="_blank">01:00:31.200</a></span> | <span class="t">another, that might be terrible. So if you want to compare to a paper or whatever is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3634" target="_blank">01:00:34.840</a></span> | <span class="t">very easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3636" target="_blank">01:00:36.880</a></span> | <span class="t">So I'm going to maybe the approach is that like, if you're doing your own experiments,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3642" target="_blank">01:00:42.640</a></span> | <span class="t">these sorts of metrics are good. But then if you're going to compare to other models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3646" target="_blank">01:00:46.040</a></span> | <span class="t">it's best to rely on human studies if you're comparing to other models. And that, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3650" target="_blank">01:00:50.600</a></span> | <span class="t">I think that's kind of the sort of approach or mindset that we should be having when it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3656" target="_blank">01:00:56.840</a></span> | <span class="t">comes to this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3657" target="_blank">01:00:57.840</a></span> | <span class="t">Yeah, or both, you know. But yeah, so we're going to see this is going to be very useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3662" target="_blank">01:01:02.680</a></span> | <span class="t">for us. And we're just going to be using the same, pretty much all the time, we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3669" target="_blank">01:01:09.000</a></span> | <span class="t">to use the same number of samples, and we're going to use the same fashion emitter-specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3673" target="_blank">01:01:13.960</a></span> | <span class="t">classifier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3676" target="_blank">01:01:16.000</a></span> | <span class="t">So the first thing I wanted to do was fix our bug. And to remind you, the bug was that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3681" target="_blank">01:01:21.760</a></span> | <span class="t">we had, we were feeding into our unit in DDPM v2 and the original DDPM images that go from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3691" target="_blank">01:01:31.560</a></span> | <span class="t">zero to one. And yeah, that's that's wrong. That's like nobody does that. Everybody feeds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3697" target="_blank">01:01:37.880</a></span> | <span class="t">in images that are from minus one to one. So that's very easy to fix. You just...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3704" target="_blank">01:01:44.840</a></span> | <span class="t">It drew me just to ask, like, why is that a bug? Why is it a bug? I mean, it's like everybody</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3710" target="_blank">01:01:50.680</a></span> | <span class="t">knows it's a bug because that's what everybody does. Like, I've never seen anybody do anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3714" target="_blank">01:01:54.960</a></span> | <span class="t">else and it's very easy to fix. So I fixed it by adding this to DDPM v2 and I reran it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3724" target="_blank">01:02:04.040</a></span> | <span class="t">and it didn't work. It made it worse. And this was the start of, you know, a few horrible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3734" target="_blank">01:02:14.400</a></span> | <span class="t">days of pain because, like, when you, you know, fix a bug and it makes things worse,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3742" target="_blank">01:02:22.240</a></span> | <span class="t">that generally suggests there's some other bug somewhere else that somehow is offset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3746" target="_blank">01:02:26.600</a></span> | <span class="t">your first bug. And so I had to go, you know, I basically went back through every other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3751" target="_blank">01:02:31.240</a></span> | <span class="t">notebook at every cell and I did find at least one bug elsewhere, which is that we hadn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3759" target="_blank">01:02:39.760</a></span> | <span class="t">been shuffling our training sets the whole time. So I fixed that, but it's got absolutely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3765" target="_blank">01:02:45.160</a></span> | <span class="t">nothing to do with this. And I ended up going through everything from scratch three times,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3769" target="_blank">01:02:49.760</a></span> | <span class="t">rerunning everything three times, checking every intermediate output three times. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3773" target="_blank">01:02:53.160</a></span> | <span class="t">days of, you know, depressing and annoying work and made no progress at all. At which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3780" target="_blank">01:03:00.840</a></span> | <span class="t">point I then asked Johnno's question to myself more carefully and provided a less driven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3789" target="_blank">01:03:09.240</a></span> | <span class="t">response to myself, which was, well, I don't know why everybody does this, actually. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3798" target="_blank">01:03:18.440</a></span> | <span class="t">I asked to Nishkan Johnno and I was like, oh, in Patreon, I was like, have you guys seen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3802" target="_blank">01:03:22.720</a></span> | <span class="t">any math, papers, whatever that's based on this particular input range? And yeah, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3815" target="_blank">01:03:35.920</a></span> | <span class="t">guys are both like, no, I haven't. It's just, it's just what everybody does. So at that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3823" target="_blank">01:03:43.920</a></span> | <span class="t">point, it raised the possibility that like, okay, maybe what everybody does is not the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3830" target="_blank">01:03:50.840</a></span> | <span class="t">right thing to do. And is there any reason to believe it is the right thing to do? Given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3837" target="_blank">01:03:57.840</a></span> | <span class="t">that it seemed like fixing the bug made it worse, maybe not. But then it's like, well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3845" target="_blank">01:04:05.680</a></span> | <span class="t">okay, we are pretty confident from everything we've learned and discussed that having centered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3851" target="_blank">01:04:11.000</a></span> | <span class="t">data is better than uncentered data. So having data that go from zero to one clearly seems</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3856" target="_blank">01:04:16.560</a></span> | <span class="t">weird. So maybe the issue is not that we've changed the center, but that we've scaled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3860" target="_blank">01:04:20.480</a></span> | <span class="t">it down so that rather than having a range of two, it's got a range of one. So at that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3865" target="_blank">01:04:25.480</a></span> | <span class="t">point, you know, I did something very simple, which was I did this, I subtracted 0.5. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3878" target="_blank">01:04:38.600</a></span> | <span class="t">now rather than going from 0 to 1, it goes from minus 0.5 to 0.5. And so the theory here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3885" target="_blank">01:04:45.200</a></span> | <span class="t">then was, okay, if our hypothesis is correct, which is that the negative one to one range</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3890" target="_blank">01:04:50.400</a></span> | <span class="t">has no foundational reason for being. And we've accidentally hit on something, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3896" target="_blank">01:04:56.400</a></span> | <span class="t">is that a range of one is better than a range of two. And this should be better still, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3901" target="_blank">01:05:01.000</a></span> | <span class="t">this is a range of one and it's centered properly. And so this is DDPMv3. And I ran that. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3908" target="_blank">01:05:08.360</a></span> | <span class="t">yes, it appeared to be better. And this is great because now I've got fit. I was able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3914" target="_blank">01:05:14.480</a></span> | <span class="t">to run fit on DDPMv2 and on DDPMv3, and it was dramatically, dramatically, dramatically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3920" target="_blank">01:05:20.280</a></span> | <span class="t">better. And in fact, I was running a lot of other experiments at the time, which we will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3928" target="_blank">01:05:28.040</a></span> | <span class="t">talk about soon. And like all of my experiments are totally falling apart when I fix the bug.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3933" target="_blank">01:05:33.600</a></span> | <span class="t">And once I did this, all the things that I thought weren't working suddenly started working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3942" target="_blank">01:05:42.960</a></span> | <span class="t">So this is often the case, I guess, is that bugs can highlight accidental discoveries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3952" target="_blank">01:05:52.800</a></span> | <span class="t">And the trick is always to be careful enough to recognize when that's happened. Some people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3961" target="_blank">01:06:01.480</a></span> | <span class="t">might remember the story. This is how the noble gases were discovered. A chemistry experiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3967" target="_blank">01:06:07.700</a></span> | <span class="t">went wrong and left behind some strange bubbles at the bottom of the test tube. And most people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3973" target="_blank">01:06:13.800</a></span> | <span class="t">would just be like, huh, whoops, bubbles. But people who are careful enough actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3979" target="_blank">01:06:19.080</a></span> | <span class="t">went, no, there shouldn't be bubbles there. Let's test them carefully. It's like they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3982" target="_blank">01:06:22.400</a></span> | <span class="t">don't react. Again, most people would be like, oh, that didn't work. The reaction failed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3988" target="_blank">01:06:28.160</a></span> | <span class="t">But if you're really careful, you'll be like, oh, maybe the fact they don't react is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3993" target="_blank">01:06:33.160</a></span> | <span class="t">interesting thing. So yes, being careful is not fair for the journey.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=3999" target="_blank">01:06:39.040</a></span> | <span class="t">When you say things like it didn't work or it was worse, when you first showed us this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4002" target="_blank">01:06:42.600</a></span> | <span class="t">thing, I kind of said, the images looked fine. The fit was slightly worse. But it was okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4009" target="_blank">01:06:49.520</a></span> | <span class="t">And if you trained it longer, it eventually got better mostly. There were some things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4013" target="_blank">01:06:53.040</a></span> | <span class="t">that sampling occasionally went wrong. One image in a hundred or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4018" target="_blank">01:06:58.120</a></span> | <span class="t">But it was like, this isn't like everything completely fell apart. He's just the truth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4022" target="_blank">01:07:02.800</a></span> | <span class="t">Women's was slightly worse than expected. And if you were doing the run and gun, try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4028" target="_blank">01:07:08.960</a></span> | <span class="t">a bunch of things, it's like, oh, well, I just doubled my training time and set a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4032" target="_blank">01:07:12.880</a></span> | <span class="t">runs going and looked at the weights and biases stats later. And oh, that seems like it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4035" target="_blank">01:07:15.720</a></span> | <span class="t">better now. We just needed to train for longer. And we have internet GQs and lots of money.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4041" target="_blank">01:07:21.600</a></span> | <span class="t">You would notice this. So yeah, it wasn't like, yeah, the fact that you picked up on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4047" target="_blank">01:07:27.640</a></span> | <span class="t">it showed that you had this deep intuition for where it should be at this stage in training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4052" target="_blank">01:07:32.040</a></span> | <span class="t">versus where it was, what the samples should look like. And you had the fit as well to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4056" target="_blank">01:07:36.120</a></span> | <span class="t">say like, okay, I would have expected a fit of nine and I'm getting 14. What's up here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4062" target="_blank">01:07:42.080</a></span> | <span class="t">And that was enough to start asking these questions and we all jumped on. We all started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4065" target="_blank">01:07:45.760</a></span> | <span class="t">to think where this came from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4068" target="_blank">01:07:48.080</a></span> | <span class="t">Yeah, I mean, definitely. I drive people crazy that I work with. I don't know why you guys</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4073" target="_blank">01:07:53.720</a></span> | <span class="t">aren't crazy yet, but with this kind of like, no, I need to know exactly why this is not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4080" target="_blank">01:08:00.920</a></span> | <span class="t">exactly what we expected. But yeah, this is why. To find that when something's mysterious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4088" target="_blank">01:08:08.080</a></span> | <span class="t">and weird, it means that there's something you didn't understand and that's an opportunity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4091" target="_blank">01:08:11.400</a></span> | <span class="t">to learn something new. So that's what we did. And so that was quite exciting because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4100" target="_blank">01:08:20.720</a></span> | <span class="t">yeah, going -0.5 to 0.5 made the fit better still. And I was definitely in, yeah, I moved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4109" target="_blank">01:08:29.040</a></span> | <span class="t">from this frame of mind from like total depression. I was so mad. I still remember when I spoke</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4116" target="_blank">01:08:36.360</a></span> | <span class="t">to Giotto, I was just so upset. And then I suddenly like, oh my gosh, we're actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4121" target="_blank">01:08:41.920</a></span> | <span class="t">onto something. So I started experimenting more and a bit more confidence at this point,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4128" target="_blank">01:08:48.640</a></span> | <span class="t">I guess. And one thing I started looking at was our schedule. We'd always been copying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4135" target="_blank">01:08:55.960</a></span> | <span class="t">and pasting this standard, again, set of stuff. And I started questioning everything. Why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4142" target="_blank">01:09:02.080</a></span> | <span class="t">is this the standard? Like, why are these numbers here? And we don't see any particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4148" target="_blank">01:09:08.600</a></span> | <span class="t">reason why those numbers were there. And I thought, well, we should maybe experiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4154" target="_blank">01:09:14.100</a></span> | <span class="t">with them. So to make it easier, I created a little function that would return a schedule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4160" target="_blank">01:09:20.920</a></span> | <span class="t">Now you could create a new class for a schedule, but something that's really cool is there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4165" target="_blank">01:09:25.480</a></span> | <span class="t">a thing in Python called Simplement namespace, which is a lot like a struct in C, basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4170" target="_blank">01:09:30.620</a></span> | <span class="t">lets you wrap up a little bunch of keys and values as if it's an object. So I created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4177" target="_blank">01:09:37.840</a></span> | <span class="t">this little simple namespace, which contains our alphas, our alphabars, and our sigmas for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4186" target="_blank">01:09:46.280</a></span> | <span class="t">our normal beta max, xs.02 namespace. This is what we always do. And then, yeah, there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4194" target="_blank">01:09:54.680</a></span> | <span class="t">another paper which mentions an alternative approach, which is cosine schedule, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4201" target="_blank">01:10:01.760</a></span> | <span class="t">is where you basically set alphabar equal to T as a fraction of big T times pi/2 cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4213" target="_blank">01:10:13.560</a></span> | <span class="t">of that squared. And if you make that your alphabar, you can then basically reverse back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4221" target="_blank">01:10:21.000</a></span> | <span class="t">out to calculate what alpha must have been. And so we can create a schedule for this cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4227" target="_blank">01:10:27.440</a></span> | <span class="t">schedule as well. And yeah, this cosine schedule is, I think, pretty recognized as being better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4237" target="_blank">01:10:37.840</a></span> | <span class="t">than this linear schedule. And so I thought, okay, it'll be interesting to look at how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4244" target="_blank">01:10:44.600</a></span> | <span class="t">they compare. And in fact, really all that matters is the alphabar. The alphabar is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4254" target="_blank">01:10:54.960</a></span> | <span class="t">total amount of noise that you're adding. So in DDPM, when we do noisify, it's alphabar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4266" target="_blank">01:11:06.320</a></span> | <span class="t">that we're actually using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4267" target="_blank">01:11:07.320</a></span> | <span class="t">It's the amount of the image and 1 minus alphabar, that's where it's the amount of noise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4273" target="_blank">01:11:13.160</a></span> | <span class="t">Exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4274" target="_blank">01:11:14.160</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4275" target="_blank">01:11:15.160</a></span> | <span class="t">Yeah. So I just printed those out, plotted those, for the normal linear schedule and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4281" target="_blank">01:11:21.600</a></span> | <span class="t">this cosine schedule. And you can really see the linear schedule. It really sucks badly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4287" target="_blank">01:11:27.480</a></span> | <span class="t">It's got a lot of time steps where it's basically about zero. And that's something we can't really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4299" target="_blank">01:11:39.360</a></span> | <span class="t">do anything with, you know, whereas the cosine schedule is really nice and smooth and there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4307" target="_blank">01:11:47.000</a></span> | <span class="t">not many steps which are nearly zero or nearly one. So I thought, so I was kind of inclined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4313" target="_blank">01:11:53.000</a></span> | <span class="t">to try using the cosine schedule, but then I thought, well, it'd be easy enough to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4317" target="_blank">01:11:57.360</a></span> | <span class="t">rid of this big flat bit by just increasing, by just decreasing beta max. That'd be another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4321" target="_blank">01:12:01.960</a></span> | <span class="t">thing we can do. So I tried, oh, sorry, first of all, I should mention that the other thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4326" target="_blank">01:12:06.880</a></span> | <span class="t">that's really important is the slope of these curves, because that's how much things are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4331" target="_blank">01:12:11.480</a></span> | <span class="t">stepping during the sampling process. And so here's the slope of the lin and the cosine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4338" target="_blank">01:12:18.120</a></span> | <span class="t">And you can see the cosine slope, really nice, right? You have this nice smooth curve, whereas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4344" target="_blank">01:12:24.640</a></span> | <span class="t">the linear is just a disaster. So yeah, if I change beta max to 0.01, that actually gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4354" target="_blank">01:12:34.320</a></span> | <span class="t">you nearly the same curve as the cosine. So I thought that was very interesting. It kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4361" target="_blank">01:12:41.480</a></span> | <span class="t">of made me think like, why on earth does everybody always use 0.02 as the default? And so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4367" target="_blank">01:12:47.160</a></span> | <span class="t">actually talked to Robin, who is one of the two lead authors on the stable diffusion paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4373" target="_blank">01:12:53.600</a></span> | <span class="t">And we talked about all of these things and he said, oh yeah, we noticed not exactly this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4378" target="_blank">01:12:58.520</a></span> | <span class="t">but we experimented with everything. And we noticed that when we decreased beta max, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4383" target="_blank">01:13:03.560</a></span> | <span class="t">got better results. And so actually stable diffusion uses beta max at 0.012. I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4390" target="_blank">01:13:10.200</a></span> | <span class="t">that might be a little bit higher than they should have picked, but it's certainly a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4392" target="_blank">01:13:12.520</a></span> | <span class="t">better than the normal default. So it's interesting talking to Robin to see all of these kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4397" target="_blank">01:13:17.600</a></span> | <span class="t">of experiments and things that we tried out, they had been there as well and noticed the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4405" target="_blank">01:13:25.600</a></span> | <span class="t">same things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4407" target="_blank">01:13:27.120</a></span> | <span class="t">But the inputs range as well, they have this magical factor of 0.1802 wherever they scale</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4413" target="_blank">01:13:33.960</a></span> | <span class="t">the latency by. And if you ask why they're like, oh yeah, we wanted to delay this to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4416" target="_blank">01:13:36.960</a></span> | <span class="t">be like roughly uniform range or whatever, but that's also like, that's reducing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4421" target="_blank">01:13:41.480</a></span> | <span class="t">range of your inputs to reasonable value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4424" target="_blank">01:13:44.160</a></span> | <span class="t">I think exactly. We independently discovered this idea. Yeah, exactly. Yeah, exactly. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4434" target="_blank">01:13:54.640</a></span> | <span class="t">we'll be talking more about like what's actually going on with that maybe next lesson. Anyway,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4443" target="_blank">01:14:03.160</a></span> | <span class="t">so here's the curves as well. They're also pretty close. So at this point I was kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4446" target="_blank">01:14:06.440</a></span> | <span class="t">of thinking, well, I'd like to like change as little as possible. So I'm going to keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4450" target="_blank">01:14:10.600</a></span> | <span class="t">using a linear schedule, but I'm just going to change beta max to 0.01 for my next version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4456" target="_blank">01:14:16.360</a></span> | <span class="t">of GDPM. So that's what I've got here, linear schedule, beta max, 0.01. And so that I wouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4462" target="_blank">01:14:22.360</a></span> | <span class="t">really have to change any of my code. I'd end up just put those in the same variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4465" target="_blank">01:14:25.520</a></span> | <span class="t">names that I've always used. So then noisify is exactly the same as it always has been.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4471" target="_blank">01:14:31.680</a></span> | <span class="t">So now I just repeat everything that I've done before. So now would I show a batch of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4477" target="_blank">01:14:37.800</a></span> | <span class="t">data? I can already see that there's more actually recognizable images, which I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4485" target="_blank">01:14:45.440</a></span> | <span class="t">is very encouraging. Previously, like almost all of them had been pure noise, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4490" target="_blank">01:14:50.480</a></span> | <span class="t">not a good sign. So, okay. So now I just train it exactly the same as GDPM v2. And so save</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4500" target="_blank">01:15:00.800</a></span> | <span class="t">this as fashion GDPM 3. Oh, and then the other things I've done here is, you know, this did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4508" target="_blank">01:15:08.040</a></span> | <span class="t">turn out to work pretty well. I actually decided let's keep going even further. So I actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4513" target="_blank">01:15:13.040</a></span> | <span class="t">doubled all of my channels from before, and I also increased the number of epochs by 3</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4519" target="_blank">01:15:19.960</a></span> | <span class="t">because things are going so well. I was like, how well could they go? So we've got a bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4523" target="_blank">01:15:23.400</a></span> | <span class="t">model trained for longer. It takes a few minutes. That's what the 25 here is the number of epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4531" target="_blank">01:15:31.880</a></span> | <span class="t">So samples exactly the same as it always has been. So create 512 samples and here they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4541" target="_blank">01:15:41.400</a></span> | <span class="t">And they definitely look to me, you know, great. Like they, I'm not sure I could recognize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4549" target="_blank">01:15:49.160</a></span> | <span class="t">whether these are real samples or generated samples. But luckily, you know, we can test</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4555" target="_blank">01:15:55.760</a></span> | <span class="t">them so we can load up our data org2, delete the last two layers, pass that to image val</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4564" target="_blank">01:16:04.720</a></span> | <span class="t">and get a fit for our samples. And it's eight. And then I chose 512 for a reason, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4572" target="_blank">01:16:12.960</a></span> | <span class="t">that's our batch size. So then I can compare that like with like for the fit for the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4577" target="_blank">01:16:17.920</a></span> | <span class="t">data at 6.6. So this is like hugely exciting to me. We've got down to a fit that is nearly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4586" target="_blank">01:16:26.060</a></span> | <span class="t">as good as real images. So I feel like this is, you know, in terms of image quality for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4597" target="_blank">01:16:37.040</a></span> | <span class="t">small unconditional sampling, I feel like we're done, you know, pretty much. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4606" target="_blank">01:16:46.960</a></span> | <span class="t">at this point, I was like, OK, well, can we make it faster? You know, at the same quality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4611" target="_blank">01:16:51.960</a></span> | <span class="t">And I just wanted to experiment with a few things, like really obvious ideas. And in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4615" target="_blank">01:16:55.560</a></span> | <span class="t">particular, I thought we're calling this a thousand times, which means we're calling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4629" target="_blank">01:17:09.160</a></span> | <span class="t">this a thousand times, just running the model. And that's slow. And most of the time you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4635" target="_blank">01:17:15.600</a></span> | <span class="t">just move a tiny bit. So the model is pretty much the same. It's, you know, the noise being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4641" target="_blank">01:17:21.040</a></span> | <span class="t">predicted is pretty much the same. So I just did something really obvious, which is I decided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4646" target="_blank">01:17:26.720</a></span> | <span class="t">let's only call the model every third time, you know, and maybe also just the last 50</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4654" target="_blank">01:17:34.000</a></span> | <span class="t">to help with fine tune. I don't know if that's necessary other than that. It's exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4659" target="_blank">01:17:39.280</a></span> | <span class="t">same. So now this is basically three times faster. And yeah, samples look basically the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4667" target="_blank">01:17:47.600</a></span> | <span class="t">same. So the feed is nine point seven eight versus eight point one. And this is like within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4672" target="_blank">01:17:52.880</a></span> | <span class="t">the normal variance of feed. So I don't know, like you'd have to run this a few times or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4677" target="_blank">01:17:57.360</a></span> | <span class="t">use bigger samples. But this is basically saying like, yeah, you probably don't need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4681" target="_blank">01:18:01.800</a></span> | <span class="t">to call the model a thousand times. I did something else slightly weird, which is I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4688" target="_blank">01:18:08.080</a></span> | <span class="t">basically said like, oh, let's create a different like schedule for how often we call the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4694" target="_blank">01:18:14.200</a></span> | <span class="t">which is I created this thing called sample app. It basically said when you're for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4698" target="_blank">01:18:18.520</a></span> | <span class="t">first few time steps, just do it every 10 and then for the next two, every nine and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4703" target="_blank">01:18:23.800</a></span> | <span class="t">then actually every eight and so forth. And just for the last hundred, do it every one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4708" target="_blank">01:18:28.480</a></span> | <span class="t">So that makes it even faster. Um, samples look good. This is, you know, it's definitely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4715" target="_blank">01:18:35.720</a></span> | <span class="t">worse though now, you know, but it's still not bad. So, um, yeah, I kind of felt like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4722" target="_blank">01:18:42.380</a></span> | <span class="t">all right, this is encouraging and this, this stuff before we fixed the minus one to one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4727" target="_blank">01:18:47.840</a></span> | <span class="t">thing was they looked really bad, you know, um, that's why I was thinking that my code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4733" target="_blank">01:18:53.040</a></span> | <span class="t">is full of bugs. Um, so at this point I'm thinking, okay, okay, okay. We can create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4737" target="_blank">01:18:57.560</a></span> | <span class="t">extremely high quality samples using DDPM. What's the like, you know, best paper out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4744" target="_blank">01:19:04.720</a></span> | <span class="t">there for doing it faster. And the most popular paper for doing it faster is DDIM. So I thought</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4752" target="_blank">01:19:12.920</a></span> | <span class="t">we might switch to this next. So we're now at the point where we're not actually going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4758" target="_blank">01:19:18.580</a></span> | <span class="t">to retrain our model at all, right? If you noticed with these different sampling approaches,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4766" target="_blank">01:19:26.000</a></span> | <span class="t">I didn't retrain the model at all. We're just saying, okay, we've got a model. The model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4770" target="_blank">01:19:30.560</a></span> | <span class="t">knows how to estimate the noise in an image. How do we use that to call it multiple times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4777" target="_blank">01:19:37.440</a></span> | <span class="t">to denoise using iterative refinement as Jono calls it. Um, and so DDIM is a, another way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4790" target="_blank">01:19:50.640</a></span> | <span class="t">of doing that. So, um, what we're going to do, so I'm going to show you how I built my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4800" target="_blank">01:20:00.200</a></span> | <span class="t">own DDIM from scratch. And, um, I kind of cheated, which is I, there's already an existing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4808" target="_blank">01:20:08.280</a></span> | <span class="t">one in diffusers. So I decided I will use that first, make sure everything works, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4815" target="_blank">01:20:15.520</a></span> | <span class="t">then I'll try and re-implement it from scratch myself. Um, so that's kind of like when there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4820" target="_blank">01:20:20.720</a></span> | <span class="t">an existing thing that works, you know, that's what I like to do. And it's been really good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4825" target="_blank">01:20:25.400</a></span> | <span class="t">to have my own DDIM from scratch because now I can modify it, you know, and I've made it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4830" target="_blank">01:20:30.780</a></span> | <span class="t">much more concise code than the diffusers version. So, um, now, um, we had created this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4841" target="_blank">01:20:41.320</a></span> | <span class="t">class called unit, which passed the tuple of X's through as individual parameters and returned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4852" target="_blank">01:20:52.920</a></span> | <span class="t">the dot sample. But not surprisingly, the, um, given that this comes from diffusers and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4858" target="_blank">01:20:58.840</a></span> | <span class="t">we want to use the diffusers schedulers, um, the diffusers, um, schedulers assume this has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4866" target="_blank">01:21:06.560</a></span> | <span class="t">not happened. It wants the X, you know, as a tuple and it expects to find the thing called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4871" target="_blank">01:21:11.560</a></span> | <span class="t">dot sample. So here's something crazy. When we save this thing, this pickle, it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4881" target="_blank">01:21:21.560</a></span> | <span class="t">really know anything about the code, right? It just knows that it's from a class called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4888" target="_blank">01:21:28.360</a></span> | <span class="t">unit. So we can actually lie. We can say, oh yeah, that class called unit. It's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4895" target="_blank">01:21:35.760</a></span> | <span class="t">the same as you connect 2D model with no other changes and Python doesn't know or care, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4903" target="_blank">01:21:43.120</a></span> | <span class="t">So this, we can now load up this model and it's going to use this unit. Okay. So this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4909" target="_blank">01:21:49.200</a></span> | <span class="t">is where it's useful to understand how Python works behind the scenes, right? It's, it's,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4913" target="_blank">01:21:53.720</a></span> | <span class="t">it's a very simple programming language. Um, so we've now got a model which we've trained,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4920" target="_blank">01:22:00.600</a></span> | <span class="t">but it's not, it's just going to, you know, use the dot sample on it. That means we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4924" target="_blank">01:22:04.320</a></span> | <span class="t">use it directly with the diffusers schedulers. So we'll start by actually repeating what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4930" target="_blank">01:22:10.040</a></span> | <span class="t">we already know how to do, which is use a DDPM scheduler. So we have to tell it what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4933" target="_blank">01:22:13.680</a></span> | <span class="t">beta we used to train. Um, and so we can grab some random data and so it could say, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4942" target="_blank">01:22:22.440</a></span> | <span class="t">we're going to start at time step 999. So let's create a batch of data and then predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4949" target="_blank">01:22:29.800</a></span> | <span class="t">the noise. And then this is the way the diffusers thing works. As you call scheduler.step and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4957" target="_blank">01:22:37.560</a></span> | <span class="t">that's the thing which does, um, those lines. That's the thing that calculates X, T given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4968" target="_blank">01:22:48.480</a></span> | <span class="t">noise. So that's what scheduler.step does. So that's why you pass in X, T and the time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4974" target="_blank">01:22:54.700</a></span> | <span class="t">step and the noise. Um, and that's going to give you a new set. And so I ran that as usual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4983" target="_blank">01:23:03.200</a></span> | <span class="t">first cell by cell to make sure I understood how it all worked. I then copied those cells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4987" target="_blank">01:23:07.240</a></span> | <span class="t">and merged them together and chucked them in a loop. So this is now going to go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4992" target="_blank">01:23:12.560</a></span> | <span class="t">all the time steps, use a progress bar to see how we're going, get the noise, call step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=4999" target="_blank">01:23:19.780</a></span> | <span class="t">and append. So this is just DDPM, but using diffusers and not surprisingly, um, it consists,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5008" target="_blank">01:23:28.240</a></span> | <span class="t">you know, basically the same results as, you know, nice results, very nice results that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5013" target="_blank">01:23:33.480</a></span> | <span class="t">we got from our own DDPM. And so we can now use the same code we've used before to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5020" target="_blank">01:23:40.040</a></span> | <span class="t">our image evaluator. And, um, I decided, yeah, we're now going to go right up to 2048 images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5028" target="_blank">01:23:48.880</a></span> | <span class="t">at a time. So it's now, this is the size I found it's big enough that it's recently stable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5034" target="_blank">01:23:54.860</a></span> | <span class="t">And so we now down to 3.7 for our feed, where else the data itself has a feed of 1.9. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5042" target="_blank">01:24:02.760</a></span> | <span class="t">again, it's showing that our DDPM is basically very nearly unrecognizably different from real</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5051" target="_blank">01:24:11.600</a></span> | <span class="t">data using its distribution of those activations. So then we can switch to DDIM by just saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5060" target="_blank">01:24:20.160</a></span> | <span class="t">DDIM scheduler. And so with DDIM, you can say, I don't want to do all thousand steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5065" target="_blank">01:24:25.120</a></span> | <span class="t">I just want to do 333 steps to every third. So that's basically a bit like, um, a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5075" target="_blank">01:24:35.680</a></span> | <span class="t">like this sample skip of doing every third. But DDIM as we'll see, does it in a smarter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5082" target="_blank">01:24:42.320</a></span> | <span class="t">way. Um, and so here's exactly the same code basically as before, but I put it into a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5091" target="_blank">01:24:51.000</a></span> | <span class="t">function. Okay. So I can basically pass in my model, the size, the scheduler. Um, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5098" target="_blank">01:24:58.840</a></span> | <span class="t">then there's a parameter called ADA, which is basically how much noise to add. Um, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5104" target="_blank">01:25:04.840</a></span> | <span class="t">uh, just add all the noise. Um, and so this is now going to take three times. This three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5110" target="_blank">01:25:10.920</a></span> | <span class="t">times faster. And yeah, the fit's basically the same. That's encouraging. So they weren't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5116" target="_blank">01:25:16.680</a></span> | <span class="t">added 200 steps. If it's basically the same, 100 steps. And at this point, okay, the fit's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5125" target="_blank">01:25:25.240</a></span> | <span class="t">getting worse. Um, and then 50 steps. We're still 25 steps. We're still, that's interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5138" target="_blank">01:25:38.160</a></span> | <span class="t">Like when you get down to 25 steps, like what does it look like? And you can see that they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5142" target="_blank">01:25:42.360</a></span> | <span class="t">kind of like, they're too smooth. You know, they don't have interesting, you know, fabric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5149" target="_blank">01:25:49.880</a></span> | <span class="t">swirls so much or buckles or logos or patterns as much, you know, as the, these ones, they've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5158" target="_blank">01:25:58.920</a></span> | <span class="t">got a lot more texture to them. So that's kind of what tends to happen. So you can still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5163" target="_blank">01:26:03.440</a></span> | <span class="t">like get something out pretty fast, but that's, that's kind of how they suffer. So, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5172" target="_blank">01:26:12.480</a></span> | <span class="t">So how does DDIM work? Well, DDIM, it's nice. It's actually, in my opinion, it makes things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5179" target="_blank">01:26:19.300</a></span> | <span class="t">a lot easier than DDPM. So there's basically an equation from the paper, which Tanishka</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5188" target="_blank">01:26:28.880</a></span> | <span class="t">will explain shortly. But basically what you do is I've, I've actually grabbed the sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5198" target="_blank">01:26:38.200</a></span> | <span class="t">function from, from here and I split it out into two bits. One bit is the bit that says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5208" target="_blank">01:26:48.920</a></span> | <span class="t">what are the time steps, creates that random starting point, loops through, finds what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5216" target="_blank">01:26:56.300</a></span> | <span class="t">my current A bar is, gets the noise, and then basically does the same as shed.step, calls</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5224" target="_blank">01:27:04.400</a></span> | <span class="t">some function, right? And then that's been pulled out. So this allows me to now create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5230" target="_blank">01:27:10.120</a></span> | <span class="t">my own different steps. So I go to the DDIM step and basically all I did was I took this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5242" target="_blank">01:27:22.820</a></span> | <span class="t">equation and I turned it into code. Actually this, this one is a second equation from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5248" target="_blank">01:27:28.600</a></span> | <span class="t">paper. Now it's a bit confusing, which is that the notation here is different. DDPM,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5256" target="_blank">01:27:36.800</a></span> | <span class="t">what it calls alpha bar, this paper calls alpha. So you've got to look out for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5263" target="_blank">01:27:43.280</a></span> | <span class="t">So basically you'll see, I basically go, I've got here XT, XT minus, okay, one minus alpha</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5270" target="_blank">01:27:50.800</a></span> | <span class="t">bar is, we've got to call that beta bar. So beta bar dot square root times noise. This</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5278" target="_blank">01:27:58.040</a></span> | <span class="t">here is the, this is the neural net, so this here is the noise. Okay. And here I've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5292" target="_blank">01:28:12.840</a></span> | <span class="t">my next XT is, oh sorry, yes, here's my A bar T1 square root times this. And you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5303" target="_blank">01:28:23.040</a></span> | <span class="t">see here it says predicted X naught. So here's my predicted X naught plus beta bar T1 minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5311" target="_blank">01:28:31.240</a></span> | <span class="t">sigma squared square root. Again, here's noise. That's the same thing as here. Okay. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5322" target="_blank">01:28:42.480</a></span> | <span class="t">plus a bit of random noise, which we only do if you're not at the last step. So yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5328" target="_blank">01:28:48.720</a></span> | <span class="t">so I can call that. So I just did it for, so rather than saying a hundred steps, I said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5336" target="_blank">01:28:56.120</a></span> | <span class="t">skip every, skip 10 steps. So do 10 steps at a time. So it's basically going to be a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5340" target="_blank">01:29:00.240</a></span> | <span class="t">hundred steps. And so you can see here actually, this is happened to do a bit better for my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5345" target="_blank">01:29:05.640</a></span> | <span class="t">hundred steps. It's not bad at all. So yeah, I mean, this has been getting to this point,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5359" target="_blank">01:29:19.000</a></span> | <span class="t">it's been a bit of a lifesaver to be honest, because, you know, I can now run a tooth,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5364" target="_blank">01:29:24.720</a></span> | <span class="t">you know, two batch of 2048 samples. I can sample them in under a minute, which doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5371" target="_blank">01:29:31.520</a></span> | <span class="t">feel painful. And so, you know, now at a point where I can actually get a pretty good measure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5378" target="_blank">01:29:38.400</a></span> | <span class="t">of how I'm doing, get a pretty reasonable amount of time and I can, you know, easily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5386" target="_blank">01:29:46.160</a></span> | <span class="t">compare it. And I got to admit, you know, the difference between a fit of five and eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5391" target="_blank">01:29:51.440</a></span> | <span class="t">and 11, I can't necessarily tell the difference. So for fashion, I think fit is better than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5397" target="_blank">01:29:57.640</a></span> | <span class="t">my eyes for this, as long as I use a consistent sample size. So yeah, Tanisha, did you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5406" target="_blank">01:30:06.320</a></span> | <span class="t">to talk a bit about, you know, the ideas of why we do this or where it comes from or what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5413" target="_blank">01:30:13.880</a></span> | <span class="t">the notation means?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5414" target="_blank">01:30:14.880</a></span> | <span class="t">Can I say a little bit before we do that, which is just that what you have there, Jeremy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5419" target="_blank">01:30:19.040</a></span> | <span class="t">which is like a screenshot from the paper and then the code that as close as possible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5424" target="_blank">01:30:24.480</a></span> | <span class="t">tries to follow that, like the difference that makes for people is huge. Like I've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5430" target="_blank">01:30:30.120</a></span> | <span class="t">a little research team that I'm doing some, you know, contract work with. And the fact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5435" target="_blank">01:30:35.040</a></span> | <span class="t">that like, it's called Alpha in the data and paper and Alpha elsewhere. And then in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5438" target="_blank">01:30:38.520</a></span> | <span class="t">code that they were copying and pasting from it was called A and B for Alpha and B done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5444" target="_blank">01:30:44.160</a></span> | <span class="t">And it's like you can get things kind of working by copying and pasting into things. And it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5448" target="_blank">01:30:48.720</a></span> | <span class="t">all just sort of kind of works. But just spending their time that actually take two screenshots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5452" target="_blank">01:30:52.640</a></span> | <span class="t">from the equation 14 and 16 from the paper and put them in there and rewrite the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5457" target="_blank">01:30:57.720</a></span> | <span class="t">so that it, you know, with some comments and things to say, like, this is what this is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5460" target="_blank">01:31:00.840</a></span> | <span class="t">this is that part from the equation. It's like, you know, the look of pain on their face</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5466" target="_blank">01:31:06.520</a></span> | <span class="t">when I said, oh, by the way, did you notice that like, it's called Alpha there and Alpha</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5469" target="_blank">01:31:09.400</a></span> | <span class="t">by there? They're like, yes, how could they do that? You know, it's just like, you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5472" target="_blank">01:31:12.880</a></span> | <span class="t">just tell how many hours have been spent, you know, like grinding text and saying what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5476" target="_blank">01:31:16.960</a></span> | <span class="t">wrong here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5477" target="_blank">01:31:17.960</a></span> | <span class="t">Yeah, and building this stuff in notebooks is such a good idea. Like we're doing MIDI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5483" target="_blank">01:31:23.920</a></span> | <span class="t">AI because the, you know, the next engineer to come along and work on that can see the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5491" target="_blank">01:31:31.960</a></span> | <span class="t">equation right there and you can add rows and stuff. So I think, you know, NVDev works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5499" target="_blank">01:31:39.000</a></span> | <span class="t">particularly well for this, this kind of development.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5502" target="_blank">01:31:42.520</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5503" target="_blank">01:31:43.520</a></span> | <span class="t">Yeah, before, before, before I talk about this, I just wanted to briefly, in the context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5511" target="_blank">01:31:51.720</a></span> | <span class="t">of all of these different notations, I recently created this meme, which I thought was, was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5518" target="_blank">01:31:58.320</a></span> | <span class="t">relevant in terms of like, each paper basically has a different diffusion model of me, different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5523" target="_blank">01:32:03.320</a></span> | <span class="t">notation. So it's just like this, but they all try to come up with their own universal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5527" target="_blank">01:32:07.440</a></span> | <span class="t">notation and it's just, just keeps proliferating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5530" target="_blank">01:32:10.360</a></span> | <span class="t">It's just to me, we should all use AMAL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5534" target="_blank">01:32:14.360</a></span> | <span class="t">Yes, exactly. We need to implement diffusion models in APLs. So yeah, the paper that Jeremy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5545" target="_blank">01:32:25.400</a></span> | <span class="t">had implemented was this denoising diffusion implicit model paper. And if you look at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5553" target="_blank">01:32:33.400</a></span> | <span class="t">paper again, you can see like the notation could be again, a little bit intimidating,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5558" target="_blank">01:32:38.680</a></span> | <span class="t">but when we walk through it, we'll see it's not too bad actually. So I'll just bring up,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5564" target="_blank">01:32:44.680</a></span> | <span class="t">I guess, some of the important equations and also comparing and contrasting, you know, DDPM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5573" target="_blank">01:32:53.120</a></span> | <span class="t">and the notation of DDPM and the equations with DIM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5577" target="_blank">01:32:57.280</a></span> | <span class="t">Not only is it not too bad, I actually discovered it's making life a lot. The DDIM notation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5583" target="_blank">01:33:03.640</a></span> | <span class="t">and equations are a lot easier to work with than DDPM. So I found my life is better since</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5590" target="_blank">01:33:10.440</a></span> | <span class="t">I discovered DDIM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5592" target="_blank">01:33:12.160</a></span> | <span class="t">Yes, yes. I think a lot of people prefer to use DDIM as well. Yeah. So yeah, basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5600" target="_blank">01:33:20.280</a></span> | <span class="t">in, let's see here. So yeah, so in both DDIM and in both DDIM and DDPM, we have this same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5612" target="_blank">01:33:32.120</a></span> | <span class="t">sort of equation. This equation is exactly the same. This is telling us the predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5620" target="_blank">01:33:40.920</a></span> | <span class="t">denoised image. So we predict our, but basically we predict the, you can see my pointer, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5629" target="_blank">01:33:49.260</a></span> | <span class="t">Just want to confirm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5630" target="_blank">01:33:50.260</a></span> | <span class="t">By the way, so the little double-headed arrow in the top right, does that, if you click</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5635" target="_blank">01:33:55.080</a></span> | <span class="t">that, do you get more room for us to see what's going on?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5638" target="_blank">01:33:58.960</a></span> | <span class="t">I'm sorry?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5639" target="_blank">01:33:59.960</a></span> | <span class="t">Yeah, I see. Yeah, that works much better. Yeah. So we have our predicted noise. So our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5651" target="_blank">01:34:11.600</a></span> | <span class="t">model is predicting the noise in the image. It is also passed in the time step, but this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5657" target="_blank">01:34:17.880</a></span> | <span class="t">is just emitted. It basically kind of is given in the XT, but our model also takes in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5663" target="_blank">01:34:23.320</a></span> | <span class="t">time step. And so it's predicting the noise in this XT, our noisy image. And we are trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5669" target="_blank">01:34:29.940</a></span> | <span class="t">to remove the noise. That's what this whole term here is, remove the noise. So because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5679" target="_blank">01:34:39.240</a></span> | <span class="t">our noise that we're predicting is unit variance noise. So we have to scale the variance of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5684" target="_blank">01:34:44.080</a></span> | <span class="t">our noise appropriately to remove it from our noisy image. So we have to scale the noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5691" target="_blank">01:34:51.080</a></span> | <span class="t">and subtract it out of the original image. And that's how we would get our predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5700" target="_blank">01:35:00.000</a></span> | <span class="t">denoised image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5701" target="_blank">01:35:01.000</a></span> | <span class="t">And I think we have to write this one before by looking at the equation for XT in the Noisify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5710" target="_blank">01:35:10.680</a></span> | <span class="t">function and rearranging it to solve for X naught. And that's what you get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5717" target="_blank">01:35:17.960</a></span> | <span class="t">Yes, that's basically what this is. So basically the idea is, okay, instead of noisifying it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5725" target="_blank">01:35:25.400</a></span> | <span class="t">where we're starting out with X0 and some noise and get an XT, we're doing the opposite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5730" target="_blank">01:35:30.780</a></span> | <span class="t">where we have some noise and we have XT. So how can we get X0? So that's what this equation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5736" target="_blank">01:35:36.000</a></span> | <span class="t">is. So that's the predicted X0 or our predicted clean image. And this equation is the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5743" target="_blank">01:35:43.000</a></span> | <span class="t">for both DDPM and DDIM, but these distributions are what's different between DDPM and DDIM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5750" target="_blank">01:35:50.840</a></span> | <span class="t">So we have these distribution, which tells us, okay, so if we have XT, which is our current</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5758" target="_blank">01:35:58.320</a></span> | <span class="t">noisy image, and X0, which is our clean image, can we find out what some sort of intermediate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5765" target="_blank">01:36:05.360</a></span> | <span class="t">noisy image is in that process? And that's XT minus one. So we have a distribution for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5772" target="_blank">01:36:12.760</a></span> | <span class="t">that. And so that tells us how to get such an image. And so this is in the DDPM paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5779" target="_blank">01:36:19.000</a></span> | <span class="t">they did to define some distribution and explain the math behind it. But yeah, basically, they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5785" target="_blank">01:36:25.200</a></span> | <span class="t">have some equations. So you have, again, a Gaussian distribution with some sort of mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5792" target="_blank">01:36:32.000</a></span> | <span class="t">and variance, but it's, again, some form of you have this sort of interpolation between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5798" target="_blank">01:36:38.840</a></span> | <span class="t">your original clean image and your noisy image. And that gives you your intermediate, slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5807" target="_blank">01:36:47.800</a></span> | <span class="t">less noisy image. So that's what this is giving. Given a clean image and a noisy image, you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5814" target="_blank">01:36:54.240</a></span> | <span class="t">slightly less noisy image. And so the sampling procedure that we do with DDPM basically is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5823" target="_blank">01:37:03.440</a></span> | <span class="t">predict the noisy, predict the X0, and then plug it into this distribution to give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5830" target="_blank">01:37:10.140</a></span> | <span class="t">your slightly less noisy image. So maybe it's worth drawing that out. So like if we had,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5839" target="_blank">01:37:19.280</a></span> | <span class="t">let's say, some sort of, like, I don't know, I'm just making some sort of, I don't know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5844" target="_blank">01:37:24.120</a></span> | <span class="t">maybe a lot of some sort of better, yeah, some sort of. So then, in this case, I'm showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5850" target="_blank">01:37:30.480</a></span> | <span class="t">a one-dimensional example. Let's say you have some sort of a point. So it's kind of a one-dimensional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5855" target="_blank">01:37:35.920</a></span> | <span class="t">example that's still in the sort of 2D space. But let's say you have any point on this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5862" target="_blank">01:37:42.200</a></span> | <span class="t">it represents an actual image that you want to sample from, right? So this is where your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5866" target="_blank">01:37:46.680</a></span> | <span class="t">distribution of actual images would lie. And you want to estimate this. So when this sort</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5873" target="_blank">01:37:53.400</a></span> | <span class="t">of algorithm that we've been seeing here says that, okay, if we take some random point,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5880" target="_blank">01:38:00.160</a></span> | <span class="t">this is some random point that we choose, you know, when we start out. And what we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5885" target="_blank">01:38:05.240</a></span> | <span class="t">is we learned this function, the score function, to take us to this manifold, but it's only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5890" target="_blank">01:38:10.400</a></span> | <span class="t">going to be accurate in some space. So it's going to be accurate, you know, it's only,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5895" target="_blank">01:38:15.000</a></span> | <span class="t">it would be accurate in some area. So we get an estimate of the score function and it tells</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5900" target="_blank">01:38:20.040</a></span> | <span class="t">us the direction to move in. And it's going to give us the direction to predict our denoised</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5906" target="_blank">01:38:26.880</a></span> | <span class="t">image, right? So basically, like, let's say, let's say this, let's say you actually, your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5913" target="_blank">01:38:33.600</a></span> | <span class="t">score function, sorry, so let's say your score function is actually in reality, some curve,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5918" target="_blank">01:38:38.520</a></span> | <span class="t">okay? So it's in reality, some curve that points to your, oops, it points here. So that's your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5923" target="_blank">01:38:43.640</a></span> | <span class="t">score function. And you know, the value here, that's what score function basically means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5928" target="_blank">01:38:48.280</a></span> | <span class="t">your gradient. Yeah. Yes, yes, it's a gradient. So, you know, we have, again, doing some form</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5934" target="_blank">01:38:54.720</a></span> | <span class="t">of, in this case, I guess you would say gradient ascent, because you're not really minimizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5940" target="_blank">01:39:00.120</a></span> | <span class="t">the score, you're maximizing it. You want, sorry, you're maximizing your, the likelihood</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5945" target="_blank">01:39:05.360</a></span> | <span class="t">of that data point being an actual data point. You want to go towards it. So you're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5950" target="_blank">01:39:10.840</a></span> | <span class="t">the sort of gradient ascent process. So you're following the gradient to get to that. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5957" target="_blank">01:39:17.920</a></span> | <span class="t">when we estimate epsilon theta and predict our noise, what we're doing is we're getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5964" target="_blank">01:39:24.280</a></span> | <span class="t">the score value here. And then so we can, you know, follow that. And we follow it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5970" target="_blank">01:39:30.720</a></span> | <span class="t">some point. I'm being kind of exaggerating here. But this point will now represent our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5978" target="_blank">01:39:38.920</a></span> | <span class="t">x zero hat. Yeah. So, yeah, our x or hat. So, and in reality, you know, that's not maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5987" target="_blank">01:39:47.980</a></span> | <span class="t">that's not going to be some point that is an actual point, it wouldn't be next to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5992" target="_blank">01:39:52.920</a></span> | <span class="t">distribution. So, you know, it's, it's not going to be a very good estimate of a clean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=5998" target="_blank">01:39:58.240</a></span> | <span class="t">image at the beginning. But, you know, we only have that estimate at the beginning at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6002" target="_blank">01:40:02.920</a></span> | <span class="t">this point, and we have to follow it all the way to to some place. So this is where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6007" target="_blank">01:40:07.880</a></span> | <span class="t">follow it to. And then we want to find some sort of x t minus one. So that's what our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6016" target="_blank">01:40:16.160</a></span> | <span class="t">next point is. And so that's what our second distribution tells us. And it basically takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6022" target="_blank">01:40:22.900</a></span> | <span class="t">us all the way, takes us all the way back to maybe some point here. And now we can re-estimate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6030" target="_blank">01:40:30.080</a></span> | <span class="t">the the the score function or our gradient over there, you know, do this prediction of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6035" target="_blank">01:40:35.200</a></span> | <span class="t">noise. And, you know, it may be more accurate of a of a score function. And maybe we go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6040" target="_blank">01:40:40.880</a></span> | <span class="t">somewhere here. And then we re-estimate and get another point and then we follow it. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6047" target="_blank">01:40:47.240</a></span> | <span class="t">so that's kind of this iterative process where we're trying to follow this the score function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6052" target="_blank">01:40:52.740</a></span> | <span class="t">to your own point. And in order to do so, we first have to estimate our x zero hat and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6058" target="_blank">01:40:58.360</a></span> | <span class="t">then and then basically add back some noise and to get, you know, a little bit again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6067" target="_blank">01:41:07.120</a></span> | <span class="t">a new estimate and keep falling and add back a little bit more noise and keep estimating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6071" target="_blank">01:41:11.400</a></span> | <span class="t">So that's what we're doing here in these two steps. We have our x zero hat, and then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6076" target="_blank">01:41:16.920</a></span> | <span class="t">have this distribution. And that's how we do it regular DDPM. And it's that I think that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6083" target="_blank">01:41:23.160</a></span> | <span class="t">the maybe where the sort of broken it up in two steps is a bit clearer. And I don't think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6090" target="_blank">01:41:30.040</a></span> | <span class="t">the DDPM paper really clarifies that really talks about it too much. But the DDPM paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6096" target="_blank">01:41:36.740</a></span> | <span class="t">also really hammers that point home, I think, and especially in their in their update equation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6102" target="_blank">01:41:42.720</a></span> | <span class="t">So the other so that's the deep DDPM, but then with DDPM, just the one thing is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6112" target="_blank">01:41:52.320</a></span> | <span class="t">you look at your prediction, use that to make a step that you also add back some additional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6116" target="_blank">01:41:56.920</a></span> | <span class="t">noise that's always fixed. Right. There's no parameter to control how much extra noise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6121" target="_blank">01:42:01.960</a></span> | <span class="t">you add back at each step. Right, exactly. So oops. So yeah, so then you're, let's see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6130" target="_blank">01:42:10.200</a></span> | <span class="t">here. Yeah, so yeah, basically, you won't be exactly at this point, you could be, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6134" target="_blank">01:42:14.400</a></span> | <span class="t">know, you're in that general vicinity, and, you know, adding that noise also helps with,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6139" target="_blank">01:42:19.520</a></span> | <span class="t">you know, you don't want to fall into, you know, specific modes where it's like, oh,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6146" target="_blank">01:42:26.280</a></span> | <span class="t">you know, this is the most likely data point, you want to add some noise where you can like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6150" target="_blank">01:42:30.200</a></span> | <span class="t">explore other data points as well. So yeah, there's some, you know, the noise also can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6156" target="_blank">01:42:36.080</a></span> | <span class="t">help and that's something you really can't control with DDPM. And this is something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6160" target="_blank">01:42:40.920</a></span> | <span class="t">DDIM explores a little bit further is in terms of the noise and even trying to get rid of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6165" target="_blank">01:42:45.600</a></span> | <span class="t">the noise altogether in DDIM. So with the DDIM paper, the main difference is literally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6174" target="_blank">01:42:54.160</a></span> | <span class="t">this one equation, that's all all really it is in terms of changing this distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6181" target="_blank">01:43:01.360</a></span> | <span class="t">where you predict the less noisy equation, the less noisy, sorry, the less noisy image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6190" target="_blank">01:43:10.640</a></span> | <span class="t">And basically, as you can see, it's just a, you have this additional parameter now, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6198" target="_blank">01:43:18.360</a></span> | <span class="t">is sigma. And the sigma controls how much noise, like we were just mentioning, is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6205" target="_blank">01:43:25.280</a></span> | <span class="t">to be part of this process. And you can actually, for example, if you want, you could set sigma</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6209" target="_blank">01:43:29.800</a></span> | <span class="t">to zero. And then you can see here, now you have a variance, that would be zero. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6214" target="_blank">01:43:34.440</a></span> | <span class="t">this becomes a completely deterministic process. So if you want, this could be completely deterministic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6221" target="_blank">01:43:41.840</a></span> | <span class="t">So that's one aspect of it. And then, yeah, so the other, the other aspects of that, right,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6232" target="_blank">01:43:52.880</a></span> | <span class="t">the reason is called DDIM is just not DDPM, because it's like not probabilistic anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6237" target="_blank">01:43:57.840</a></span> | <span class="t">It can be made deterministic. So the name was changed for that reason. But the other thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6244" target="_blank">01:44:04.280</a></span> | <span class="t">is like, you would think that you've kind of changed the model altogether with a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6248" target="_blank">01:44:08.920</a></span> | <span class="t">distribution altogether. And so you say, oh, wouldn't you have to like trade a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6254" target="_blank">01:44:14.160</a></span> | <span class="t">model for this purpose? But it turns out the math works out where the same model objective</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6259" target="_blank">01:44:19.840</a></span> | <span class="t">would work well with this distribution as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6263" target="_blank">01:44:23.120</a></span> | <span class="t">And in fact, I think that's what they were setting out from the very beginning is what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6267" target="_blank">01:44:27.840</a></span> | <span class="t">kind of other models can we get with the same objective. And so this is what they're able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6274" target="_blank">01:44:34.600</a></span> | <span class="t">to do is you can make some, you can have this new parameter that you can introduce, in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6280" target="_blank">01:44:40.040</a></span> | <span class="t">case, kind of controlling the stochasticity of the model. And it still can be, you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6290" target="_blank">01:44:50.000</a></span> | <span class="t">still use the same exact trained model that you had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6295" target="_blank">01:44:55.320</a></span> | <span class="t">So what this means is that this actually is just a new sampling algorithm, and not anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6300" target="_blank">01:45:00.480</a></span> | <span class="t">new with the training itself. And this is just, yeah, just like we talked about a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6305" target="_blank">01:45:05.680</a></span> | <span class="t">way of sampling the model. And then, so yeah, this is how, you know, given now this equation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6313" target="_blank">01:45:13.800</a></span> | <span class="t">then you can rewrite your x t minus one term. And again, we're doing the same sort of thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6318" target="_blank">01:45:18.360</a></span> | <span class="t">where we split it up into predicting the x zero, and then adding back to go back to your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6327" target="_blank">01:45:27.400</a></span> | <span class="t">x t. And also, if you need to add a little bit of noise back in, like Jonathan was saying,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6335" target="_blank">01:45:35.080</a></span> | <span class="t">you can do so, you have this extra term here, and the sigma controls that term.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6341" target="_blank">01:45:41.440</a></span> | <span class="t">And again, like we said, you have to be, again, looking at the DDI equation versus the DDPM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6348" target="_blank">01:45:48.080</a></span> | <span class="t">equation, you have to be careful of the alphas here are referring to alpha bars in the DDPM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6353" target="_blank">01:45:53.960</a></span> | <span class="t">equation. So that's the other caveat. So yeah, and this you have this sigma t set to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6362" target="_blank">01:46:02.840</a></span> | <span class="t">particular value will give you back DDPM. So sometimes instead, instead, they will write,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6370" target="_blank">01:46:10.240</a></span> | <span class="t">basically, Jeremy mentioned this sort of, I guess, eta, which is equal to basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6380" target="_blank">01:46:20.520</a></span> | <span class="t">yeah, so it's just basically, eta is sigma is equal to eta times this coefficient. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6388" target="_blank">01:46:28.840</a></span> | <span class="t">sorry, let me just go back. So basically, yeah, in reality, you take, you have eta here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6403" target="_blank">01:46:43.600</a></span> | <span class="t">so it's like, yeah, this is where eta would go. So if it's one, it becomes regular DDPM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6408" target="_blank">01:46:48.800</a></span> | <span class="t">and if it's zero, of course, that's a determinant case. So this is where the eta that, you know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6413" target="_blank">01:46:53.320</a></span> | <span class="t">all these API's and in the code that we have, also the code that Jeremy was showing, they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6419" target="_blank">01:46:59.240</a></span> | <span class="t">have eta equals to one, which of course, which they say is corresponding to regular DDPM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6426" target="_blank">01:47:06.280</a></span> | <span class="t">This is actually where the eta would go in the equation. So finally, it's like, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6434" target="_blank">01:47:14.200</a></span> | <span class="t">you could pass in sigma, right? Like if you weren't trying to match it in clean use papers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6438" target="_blank">01:47:18.080</a></span> | <span class="t">you could just say, oh, well, we have this parameter sigma that controls the amount of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6440" target="_blank">01:47:20.760</a></span> | <span class="t">noise. So let's just take in a big more scale as an argument. But for convenience, they said,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6445" target="_blank">01:47:25.760</a></span> | <span class="t">let's create this new thing, eta, where zero means sigma is equal to zero, which if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6451" target="_blank">01:47:31.320</a></span> | <span class="t">look at the equation that works, one means we match the amount of noise that's in like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6457" target="_blank">01:47:37.600</a></span> | <span class="t">vanilla DDPM. And so then that gives you like a nice slice. So you could say eta equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6462" target="_blank">01:47:42.240</a></span> | <span class="t">two or eight equals 0.7 or whatever. But it's like, but a meaningful unit of one equals the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6468" target="_blank">01:47:48.480</a></span> | <span class="t">same as this previous reference work. Well, it's also convenient because it's sigma t,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6474" target="_blank">01:47:54.360</a></span> | <span class="t">which is to say different time steps, unless you choose eta equals zero, in which case it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6480" target="_blank">01:48:00.240</a></span> | <span class="t">doesn't matter. Different time steps probably want different amounts of noise. And so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6487" target="_blank">01:48:07.040</a></span> | <span class="t">a reasonable way of scaling that noise. Then the last thing of importance, which is of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6496" target="_blank">01:48:16.240</a></span> | <span class="t">course, one of the reasons that we were exploring this as the first place is to be able to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6501" target="_blank">01:48:21.560</a></span> | <span class="t">this sort of rapid sampling. So the basic idea here is that you can define a similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6512" target="_blank">01:48:32.440</a></span> | <span class="t">distribution where again, the math works out similarly, where now you have, let's say you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6520" target="_blank">01:48:40.080</a></span> | <span class="t">have some subset of diffusion steps. So in this case, it uses tau variable. So for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6526" target="_blank">01:48:46.080</a></span> | <span class="t">if you say, let's say subset of diffusion steps. So if it's like 10 diffusion steps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6532" target="_blank">01:48:52.760</a></span> | <span class="t">then tau one would just be zero, then tau two would be 10. You just keep going all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6537" target="_blank">01:48:57.920</a></span> | <span class="t">way up to say a thousand, but you've only got the, sorry, tau two would be a hundred.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6542" target="_blank">01:49:02.720</a></span> | <span class="t">And then you go all the way up to a thousand. And so you'd get 10 diffusion steps. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6548" target="_blank">01:49:08.200</a></span> | <span class="t">what they're referring to when they have this, I guess this tau variable here. And so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6556" target="_blank">01:49:16.880</a></span> | <span class="t">can do these sorts of similar equation and similar derivation to show that this distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6564" target="_blank">01:49:24.400</a></span> | <span class="t">here again, meets the sort of objective that you use for training. And you can now use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6571" target="_blank">01:49:31.160</a></span> | <span class="t">this for a faster sampling, where basically all you have to do is you have to just select</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6577" target="_blank">01:49:37.400</a></span> | <span class="t">the appropriate alpha bar. And sorry, this one I've written out. So this one, actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6583" target="_blank">01:49:43.480</a></span> | <span class="t">the alpha bar is the regular alpha bar that we've talked about. But basically, sorry,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6587" target="_blank">01:49:47.960</a></span> | <span class="t">it's a little bit confusing switching between different notations. But basically, you have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6594" target="_blank">01:49:54.760</a></span> | <span class="t">this distribution and then you just have to select the appropriate alpha bars and it follows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6601" target="_blank">01:50:01.000</a></span> | <span class="t">the math the same in terms of you have appropriate sampling process. So yeah, and I guess that's,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6611" target="_blank">01:50:11.600</a></span> | <span class="t">it makes it a lot simpler in terms of doing this, I guess, accelerated sampling. Yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6621" target="_blank">01:50:21.080</a></span> | <span class="t">I guess with any other note, maybe other comments that maybe you guys had, or was this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6627" target="_blank">01:50:27.240</a></span> | <span class="t">Yeah, the key for me is that in this equation, we just have one, we only need one parameter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6639" target="_blank">01:50:39.360</a></span> | <span class="t">which is the alpha bar or alpha depending which notation is raised and everything else</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6643" target="_blank">01:50:43.480</a></span> | <span class="t">is calculated from that. And so we don't have the, what DDPM calls the alpha or beta anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6654" target="_blank">01:50:54.720</a></span> | <span class="t">And that's more convenient for doing this kind of smaller number of steps, because we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6661" target="_blank">01:51:01.960</a></span> | <span class="t">just jump straight from time step to alpha bar. And we can also then, as particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6670" target="_blank">01:51:10.240</a></span> | <span class="t">convenient with the cosine schedule, because you can calculate the inverse of the cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6676" target="_blank">01:51:16.240</a></span> | <span class="t">schedule function, which means you can also go from an alpha bar to a T. So it's really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6680" target="_blank">01:51:20.960</a></span> | <span class="t">easy to like, say like, oh, what would alpha bar be 10 time steps previously to this one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6687" target="_blank">01:51:27.680</a></span> | <span class="t">you know, it's just, you could just call a function. We don't need, yeah, we don't need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6691" target="_blank">01:51:31.440</a></span> | <span class="t">anything else. And so actually the original cosine schedule paper has to fuss around with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6698" target="_blank">01:51:38.960</a></span> | <span class="t">various like kind of epsilon style small numbers that they add to things to avoid getting weird</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6707" target="_blank">01:51:47.920</a></span> | <span class="t">numerical problems. And so yeah, when we only deal with alpha bar, all that stuff also goes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6713" target="_blank">01:51:53.640</a></span> | <span class="t">away. So yeah, so looking, if you're looking at the DDIM code, you know, it's simpler code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6724" target="_blank">01:52:04.600</a></span> | <span class="t">with less parameters than our DDPM code. And of course, it's dramatically faster. And it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6731" target="_blank">01:52:11.400</a></span> | <span class="t">also more flexible because we've got this eta thing we can play with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6734" target="_blank">01:52:14.800</a></span> | <span class="t">Yes. Yeah, that's the other thing. It's like this idea of like, yeah, controlling stochasticity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6741" target="_blank">01:52:21.800</a></span> | <span class="t">I think that's something that's interesting to explore. And we've been exploring that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6746" target="_blank">01:52:26.040</a></span> | <span class="t">a bit now. And I think we'll continue to explore that in terms of deterministic versus stochasticity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6751" target="_blank">01:52:31.480</a></span> | <span class="t">So yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6752" target="_blank">01:52:32.480</a></span> | <span class="t">So it's worth talking about this, the sigma in the middle equation you've got there. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6757" target="_blank">01:52:37.280</a></span> | <span class="t">you've got the sigma t eta t adding the random noise. And intuitively, it makes sense that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6762" target="_blank">01:52:42.880</a></span> | <span class="t">if you're adding random noise there, you would need to have less, you want to move less back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6768" target="_blank">01:52:48.640</a></span> | <span class="t">towards xt, which is your noisy image. So that's why, you know, you've got the 1 minus alpha</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6775" target="_blank">01:52:55.460</a></span> | <span class="t">t minus 1 minus sigma squared. And then you're taking the square root of that. So basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6782" target="_blank">01:53:02.160</a></span> | <span class="t">that's just sigma, the square root of the squared. So you're subtracting sigma t from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6788" target="_blank">01:53:08.520</a></span> | <span class="t">the direction pointing to xt and adding it to the random noise, or vice versa. So yes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6794" target="_blank">01:53:14.920</a></span> | <span class="t">you know, that everything's there for a reason, you know, yes. And the predicted x0, that entire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6804" target="_blank">01:53:24.960</a></span> | <span class="t">equation we've derived previously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6808" target="_blank">01:53:28.840</a></span> | <span class="t">And it remains the same in pretty much any diffusion model methodology.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6812" target="_blank">01:53:32.360</a></span> | <span class="t">Well, as long as we'll be talking about actually some places where it's going to change probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6818" target="_blank">01:53:38.760</a></span> | <span class="t">next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6819" target="_blank">01:53:39.760</a></span> | <span class="t">Well, yeah, I guess it's another thing where you're predicting the noise. Yes. Yes. Yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6824" target="_blank">01:53:44.980</a></span> | <span class="t">If you're predicting the noise, yes, there'll be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6827" target="_blank">01:53:47.000</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6828" target="_blank">01:53:48.000</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6829" target="_blank">01:53:49.000</a></span> | <span class="t">So I think, you know, we'll probably, yeah, let's wrap it up here so that we leave ourselves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6838" target="_blank">01:53:58.060</a></span> | <span class="t">plenty of time to cover the kind of new research directions next lesson more in more detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6843" target="_blank">01:54:03.560</a></span> | <span class="t">But as I mentioned, in terms of where we're at, just like we hit a kind of like, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6849" target="_blank">01:54:09.960</a></span> | <span class="t">we can really predict classes for Fashioned MNIST a few weeks ago, where I think we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6855" target="_blank">01:54:15.600</a></span> | <span class="t">there now, and we can do stable diffusion sampling and units, except for the unit architecture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6864" target="_blank">01:54:24.520</a></span> | <span class="t">or unconditional generation now, we basically can do Fashioned MNIST almost so it's unrecognizably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6872" target="_blank">01:54:32.440</a></span> | <span class="t">different to the real samples, and DDIM is the scheduler that the original stable diffusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6879" target="_blank">01:54:39.480</a></span> | <span class="t">paper used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6883" target="_blank">01:54:43.080</a></span> | <span class="t">So yeah, you know, we're actually about to go beyond stable diffusion for our sampling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6893" target="_blank">01:54:53.140</a></span> | <span class="t">and unit training now. So I think we've, yeah, definitely meeting our stretch goals so far,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6903" target="_blank">01:55:03.440</a></span> | <span class="t">and all from scratch, with weights and biases, experiment logging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6911" target="_blank">01:55:11.600</a></span> | <span class="t">And you know, if you wanted to have fun, there's no reason you couldn't like have a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6917" target="_blank">01:55:17.400</a></span> | <span class="t">call back that instead logs things into a SQL like database, and then you could write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6921" target="_blank">01:55:21.600</a></span> | <span class="t">a little front end to show your experiments, you know, that'd be fun as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6927" target="_blank">01:55:27.920</a></span> | <span class="t">Yeah, I mean, you could do also send you a text message when the loss gets good enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6933" target="_blank">01:55:33.160</a></span> | <span class="t">Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6934" target="_blank">01:55:34.160</a></span> | <span class="t">Alright, well, thanks, guys. That was really fun.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6938" target="_blank">01:55:38.760</a></span> | <span class="t">Thanks, everybody.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6940" target="_blank">01:55:40.200</a></span> | <span class="t">Alright, bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6941" target="_blank">01:55:41.200</a></span> | <span class="t">Jizzle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6942" target="_blank">01:55:42.200</a></span> | <span class="t">Okay, talk to you later, then. We're bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=PXiD7ZjOKhA&t=6945" target="_blank">01:55:45.120</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>