<html><head><title>How to Build a Bert WordPiece Tokenizer in Python and HuggingFace</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>How to Build a Bert WordPiece Tokenizer in Python and HuggingFace</h2><a href="https://www.youtube.com/watch?v=cR4qMSIvX28"><img src="https://i.ytimg.com/vi_webp/cR4qMSIvX28/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=221">3:41</a> WordPiece Tokenizer<br><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=354">5:54</a> Download Data Sets<br><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=446">7:26</a> HuggingFace<br><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=641">10:41</a> Dataset<br><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1140">19:0</a> Tokenizer<br><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1483">24:43</a> Tokenizer Walkthrough<br><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1582">26:22</a> Tokenizer Code<br><br><div style="text-align: left;"><a href="./cR4qMSIvX28.html">Whisper Transcript</a> | <a href="./transcript_cR4qMSIvX28.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi, welcome to this video. We're going to cover how we can build a tokenizer for BERT from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=6" target="_blank">00:00:06.960</a></span> | <span class="t">So typically when we're using transform models we have three main components so we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=19" target="_blank">00:00:19.440</a></span> | <span class="t">tokenizer which obviously what we're going to what we're going to cover here we have the core model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=25" target="_blank">00:00:25.520</a></span> | <span class="t">and we also have a head so the tokenizer is obviously what converts our text into into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=33" target="_blank">00:00:33.360</a></span> | <span class="t">tokens that BERT can read the core model is is BERT itself so BERT has like kind of like a core</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=40" target="_blank">00:00:40.240</a></span> | <span class="t">which we build or train through pre-training and then there's also a head which allows us to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=46" target="_blank">00:00:46.400</a></span> | <span class="t">specialized tasks so we have like a Q&A head or a classification head and so on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=54" target="_blank">00:00:54.400</a></span> | <span class="t">now a lot of the time what we can do is just head over to the Hug & Face website over here and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=63" target="_blank">00:01:03.440</a></span> | <span class="t">can say okay we have all these tasks over here if I want a model for a question answering I can click</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=69" target="_blank">00:01:09.440</a></span> | <span class="t">on here and typically there's usually something we can use but obviously it depends on your use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=75" target="_blank">00:01:15.760</a></span> | <span class="t">case your language and a lot of different things so if we find that there isn't really a model that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=82" target="_blank">00:01:22.240</a></span> | <span class="t">suits what we need or it doesn't perform well on our own data that's where we would start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=87" target="_blank">00:01:27.520</a></span> | <span class="t">considering okay do we need to build our own transformer so in that case at the very least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=94" target="_blank">00:01:34.880</a></span> | <span class="t">we're probably going to need to build or train from scratch a core model and the tokenizer or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=102" target="_blank">00:01:42.480</a></span> | <span class="t">transformer head so we definitely need those two parts and sometimes we'll find that we also need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=110" target="_blank">00:01:50.080</a></span> | <span class="t">tokenizers but not always because you think okay we already have tokenizers for say our task is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=115" target="_blank">00:01:55.840</a></span> | <span class="t">something to do in the English language but the model doesn't perform very well in our specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=120" target="_blank">00:02:00.960</a></span> | <span class="t">data set it doesn't mean that it doesn't it hasn't been tokenized properly it can still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=125" target="_blank">00:02:05.680</a></span> | <span class="t">tokenize all that text probably pretty well as long as it's like standard English but what we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=132" target="_blank">00:02:12.320</a></span> | <span class="t">find is that the model just doesn't quite understand the style of language being used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=137" target="_blank">00:02:17.840</a></span> | <span class="t">so for example if Bert is trained on blogs on the internet it's probably not going to do as well on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=146" target="_blank">00:02:26.560</a></span> | <span class="t">governmental or financial reports so that's the sort of area where you think okay we're probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=153" target="_blank">00:02:33.200</a></span> | <span class="t">going to need to retrain the core model so it can better understand the style of language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=158" target="_blank">00:02:38.320</a></span> | <span class="t">used in there and then the head is like I said before that's where we are training it specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=164" target="_blank">00:02:44.960</a></span> | <span class="t">for a specific use case so for Q&A we'd probably want to train our model on a specific question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=172" target="_blank">00:02:52.320</a></span> | <span class="t">answering data set yeah so that it can it can start answering our questions now in that case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=180" target="_blank">00:03:00.480</a></span> | <span class="t">and it's in English we probably don't need the tokenizer but sometimes we do need a tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=185" target="_blank">00:03:05.200</a></span> | <span class="t">because maybe your use case is in a less common language and in that case you probably will need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=194" target="_blank">00:03:14.800</a></span> | <span class="t">to build your own tokenizer for Bert and that's really the sort of use case that we would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=201" target="_blank">00:03:21.040</a></span> | <span class="t">looking at in this video so we'll cover that building a word piece tokenizer which is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=207" target="_blank">00:03:27.280</a></span> | <span class="t">tokenized user by Bert and we'll also have a look at how we can get or where we can get good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=213" target="_blank">00:03:33.200</a></span> | <span class="t">multilingual data sets from as well so let's move on to what the Bert tokenizer is and what it does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=220" target="_blank">00:03:40.320</a></span> | <span class="t">okay so like I said before the Bert tokenizer it's called a word piece tokenizer so this this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=227" target="_blank">00:03:47.600</a></span> | <span class="t">letter this text up here word piece and it's pretty straightforward what it does is it breaks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=234" target="_blank">00:03:54.880</a></span> | <span class="t">your words into chunks or pieces of words hence word piece so for example the word surf it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=242" target="_blank">00:04:02.480</a></span> | <span class="t">probably most likely going to return a single token which would be surf whereas word surfing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=248" target="_blank">00:04:08.160</a></span> | <span class="t">the the ing at the end of surf is a pretty common part of a word in English at least so what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=254" target="_blank">00:04:14.480</a></span> | <span class="t">would find is this word here would probably get broken out into these two tokens now where we see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=260" target="_blank">00:04:20.320</a></span> | <span class="t">this prefix the double hashtag that's the standard prefix used to indicate that this is a piece of a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=267" target="_blank">00:04:27.200</a></span> | <span class="t">word rather than a word itself and then we see that further down as well so surfboarding gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=272" target="_blank">00:04:32.480</a></span> | <span class="t">broken into three tokens and then if we for example compare that to snowboarding snowboarding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=278" target="_blank">00:04:38.800</a></span> | <span class="t">surfboarding are obviously kind of similar because they are both boarding sports the difference being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=284" target="_blank">00:04:44.480</a></span> | <span class="t">one is on surf the other one is on snow and before we even feed these tokens into Bert we're making</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=292" target="_blank">00:04:52.560</a></span> | <span class="t">that very easy for Bert to identify where the similarities are between those two objects because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=299" target="_blank">00:04:59.280</a></span> | <span class="t">Bert knows that okay one of them is surf one of them is snow but both of them are boarding so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=305" target="_blank">00:05:05.200</a></span> | <span class="t">is helping Bert from the start which is I think pretty cool now when we're training a tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=313" target="_blank">00:05:13.680</a></span> | <span class="t">we need a lot of text data so well when I say a lot we let's say two million paragraphs is probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=323" target="_blank">00:05:23.520</a></span> | <span class="t">a good sign point although ideally you want as much as you can so what we will use for training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=332" target="_blank">00:05:32.560</a></span> | <span class="t">our data is something called the oscar data set or oscar corpus now oscar is just a huge multilingual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=342" target="_blank">00:05:42.640</a></span> | <span class="t">data set that contains and just an insane amount of unstructured text so it's very very good and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=349" target="_blank">00:05:49.440</a></span> | <span class="t">we can access it through hugging face which is super useful so over in in our code first if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=358" target="_blank">00:05:58.720</a></span> | <span class="t">want to we want to download data sets we need to pip install something called data sets a pip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=365" target="_blank">00:06:05.280</a></span> | <span class="t">install data sets I already have installed so I'm just going to go from data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=371" target="_blank">00:06:11.760</a></span> | <span class="t">import load data set okay and then through that we can use the data sets dot list data sets method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=385" target="_blank">00:06:25.920</a></span> | <span class="t">let me sorry let me import data sets as well import data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=393" target="_blank">00:06:33.680</a></span> | <span class="t">okay and this will give us a very big list probably a little bit too big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=399" target="_blank">00:06:39.040</a></span> | <span class="t">showing us all the data sets that are currently available in the data sets library which is quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=405" target="_blank">00:06:45.840</a></span> | <span class="t">a lot I think it's like a thousand just a fair bit over a thousand now okay so we have all of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=414" target="_blank">00:06:54.400</a></span> | <span class="t">which is a lot how many let me length data sets dot list data sets my internet is very bad um at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=427" target="_blank">00:07:07.280</a></span> | <span class="t">the moment so it takes forever to download anything but that there are data sets and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=433" target="_blank">00:07:13.840</a></span> | <span class="t">is one way of viewing those data sets but an easier way this is how many we have in all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=439" target="_blank">00:07:19.200</a></span> | <span class="t">hugging face and there's new ones being added like every day so but an easy way of doing this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=445" target="_blank">00:07:25.120</a></span> | <span class="t">to go to google type in data sets view or hugging face that is its viewer and just click on a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=452" target="_blank">00:07:32.240</a></span> | <span class="t">streamlet hugging face so this is a streamlet app hugging face of bill that allow you to go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=459" target="_blank">00:07:39.120</a></span> | <span class="t">their data sets so you see over here we go over to data sets and I'm going to type in Oscar because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=466" target="_blank">00:07:46.080</a></span> | <span class="t">that's the one we'll be using Oscar okay I type Oscar and then on the right we should it should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=472" target="_blank">00:07:52.960</a></span> | <span class="t">pop up so within Oscar we have all these different data sets so the first one here is Africans</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=478" target="_blank">00:07:58.720</a></span> | <span class="t">the the language and then you have all these other ones down here I'm going to using Italian as my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=486" target="_blank">00:08:06.320</a></span> | <span class="t">example here but Italian has a lot of data so if I click on here it doesn't actually show you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=494" target="_blank">00:08:14.000</a></span> | <span class="t">anything which is a little bit annoying but it's because it's just a huge data set it can't show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=498" target="_blank">00:08:18.400</a></span> | <span class="t">you everything so in fact so that is 101 gigabytes 102 gigabytes of data there so it's a lot but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=507" target="_blank">00:08:27.840</a></span> | <span class="t">that's good for us because we need a lot of data for training so if we want to download that data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=513" target="_blank">00:08:33.200</a></span> | <span class="t">set we need to do this so we write data sets or data sets and it's just a variable name and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=519" target="_blank">00:08:39.920</a></span> | <span class="t">want to write load data set and then in here we need to write the data set name so it's Oscar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=526" target="_blank">00:08:46.880</a></span> | <span class="t">and then we need to specify which part of the data set it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=531" target="_blank">00:08:51.200</a></span> | <span class="t">so over here it's a subset it's unshuffled deduplicated it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=538" target="_blank">00:08:58.080</a></span> | <span class="t">if I can can't select it so never mind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=547" target="_blank">00:09:07.840</a></span> | <span class="t">so deduplicated it and it's also unshuffled unshuffled deduplicated it so right looks looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=556" target="_blank">00:09:16.800</a></span> | <span class="t">good and then the other thing that we can do is we can write split and we can specify how much of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=563" target="_blank">00:09:23.120</a></span> | <span class="t">the data we'd like now when you when you use this split it's still going to download the full data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=569" target="_blank">00:09:29.760</a></span> | <span class="t">set to your uh to your machine which is a little bit annoying but this is how it works so I found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=576" target="_blank">00:09:36.480</a></span> | <span class="t">that this isn't particularly useful unless you're just loading it from your machine and you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=580" target="_blank">00:09:40.640</a></span> | <span class="t">saying okay I only want a certain amount of data what you can do if so this is a 101 gigabytes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=588" target="_blank">00:09:48.480</a></span> | <span class="t">it's a lot if you don't want to download all that you can write streaming equals true and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=594" target="_blank">00:09:54.560</a></span> | <span class="t">very useful so what this will do is create an iterator and you can iterate through this object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=599" target="_blank">00:09:59.360</a></span> | <span class="t">and download your your data or samples one at a time now because I already have my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=606" target="_blank">00:10:06.880</a></span> | <span class="t">my data downloaded onto my machine I'm going to use the split method so I am going to take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=617" target="_blank">00:10:17.200</a></span> | <span class="t">first I'm going to say 500,000 items simply because I mean obviously you want to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=627" target="_blank">00:10:27.200</a></span> | <span class="t">more samples than this but I'm just going to use this many because otherwise the loading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=632" target="_blank">00:10:32.880</a></span> | <span class="t">times on all this is is pretty long I don't want to be waiting for too long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=637" target="_blank">00:10:37.680</a></span> | <span class="t">and we also need to specify which data set or subset we're using here so typically we have our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=650" target="_blank">00:10:50.320</a></span> | <span class="t">train validation or tests in our data sets we I think we always have the train set in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=657" target="_blank">00:10:57.840</a></span> | <span class="t">and then we can have validation test sets as well so we'll load that and then what I'm going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=665" target="_blank">00:11:05.280</a></span> | <span class="t">is I'm going to create a new directory where I'm going to store all of these text files so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=673" target="_blank">00:11:13.120</a></span> | <span class="t">when we're training the tokenizer it expects plain text files that where each sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=679" target="_blank">00:11:19.680</a></span> | <span class="t">separate by a new line so I'm going to go ahead and create that data set for us so I'm going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=688" target="_blank">00:11:28.240</a></span> | <span class="t">make directory I'm going to call this Oscar and then what I'm going to do is loop through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=695" target="_blank">00:11:35.280</a></span> | <span class="t">our data here and convert them into the file format that we need so first thing I want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=703" target="_blank">00:11:43.520</a></span> | <span class="t">is import tqdm auto import tqdm so from and I'm using this so that we have a progress bar so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=713" target="_blank">00:11:53.440</a></span> | <span class="t">can see where we are in that process because this can take a while so I'm going to create this text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=720" target="_blank">00:12:00.880</a></span> | <span class="t">data list so populate this with all of our text and I'm going to use this file count so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=727" target="_blank">00:12:07.760</a></span> | <span class="t">zero so this is just going to loop through and we're going to create all our text files using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=733" target="_blank">00:12:13.840</a></span> | <span class="t">this here so what I want to do is for sample in tqdm tqdm data set yes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=744" target="_blank">00:12:24.400</a></span> | <span class="t">for now I'm just going to pass okay and let's run that and we see that we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=751" target="_blank">00:12:31.840</a></span> | <span class="t">this this bar this tqdm bar you see we're not even doing anything at the moment and it's already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=759" target="_blank">00:12:39.920</a></span> | <span class="t">taking a long time to to process the data so I'm actually going to let's I'm going to go down to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=766" target="_blank">00:12:46.800</a></span> | <span class="t">50 000 so I'm not waiting too long so let me modify that 50 000 and and that should be a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=777" target="_blank">00:12:57.280</a></span> | <span class="t">bit quicker okay it's much better now first thing I want to do is we're going to be splitting each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=785" target="_blank">00:13:05.120</a></span> | <span class="t">sample by a newline character so I want to first remove any newline characters that are already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=790" target="_blank">00:13:10.640</a></span> | <span class="t">within each sample otherwise we're going to be splitting our samples like midway through a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=796" target="_blank">00:13:16.560</a></span> | <span class="t">sentence so on sample equals sample and in here so if I can I show you I can show you a sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=806" target="_blank">00:13:26.400</a></span> | <span class="t">yeah we have id and then we also have the text we want the text obviously so we just wrote text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=812" target="_blank">00:13:32.080</a></span> | <span class="t">and we're going to replace newline characters if there are any hopefully there's not any way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=817" target="_blank">00:13:37.360</a></span> | <span class="t">with space and then what we want to do is just append that to our text data so text data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=824" target="_blank">00:13:44.800</a></span> | <span class="t">append sample and what we want to do so we can put all this in a single file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=833" target="_blank">00:13:53.440</a></span> | <span class="t">but then that leaves us with one single file which is huge so I mean for 50 000 samples it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=839" target="_blank">00:13:59.920</a></span> | <span class="t">really a problem but we're not going to typically be using that many samples it's going to be more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=846" target="_blank">00:14:06.080</a></span> | <span class="t">like 5 million 50 million or so on so what I like to do is just split the data into multiple text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=854" target="_blank">00:14:14.160</a></span> | <span class="t">files so what I do is I say if the length of the text data is equal to let's say 5 000 at that point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=865" target="_blank">00:14:25.120</a></span> | <span class="t">I want you to save the text data and then restart again and start populating a new new file so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=873" target="_blank">00:14:33.280</a></span> | <span class="t">say with open so we need to open the file we need to save it into this oscar directory that we built</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=880" target="_blank">00:14:40.160</a></span> | <span class="t">before so oscar and I'm just going to call it file file file count dot text so you convert this into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=892" target="_blank">00:14:52.960</a></span> | <span class="t">an f string I'm not sure why it's why it's highlighting everything here and we are writing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=902" target="_blank">00:15:02.560</a></span> | <span class="t">that file so with that that's why we want to do fp.write and then we just write our text data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=912" target="_blank">00:15:12.560</a></span> | <span class="t">write our text data but we also so this is a list and what we want to do is we want to join</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=919" target="_blank">00:15:19.120</a></span> | <span class="t">every item in that list separated by a new line character so we write this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=925" target="_blank">00:15:25.920</a></span> | <span class="t">and that creates our files now at this point we've created a file and our text data still has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=934" target="_blank">00:15:34.880</a></span> | <span class="t">5 000 items in it and we're going to start looping through and populating it with even more items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=940" target="_blank">00:15:40.480</a></span> | <span class="t">so what we need to do now is re or initialize or empty our text data variable so that's empty again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=947" target="_blank">00:15:47.280</a></span> | <span class="t">it can start counting from zero all the way up to five thousand again okay and so at this point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=952" target="_blank">00:15:52.800</a></span> | <span class="t">we're saving our file so this will be initially file underscore zero dot text but if we loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=961" target="_blank">00:16:01.360</a></span> | <span class="t">through again and and do it again it's still going to be zero so we need to make sure we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=965" target="_blank">00:16:05.120</a></span> | <span class="t">increasing that file count so that it's not remaining the same just overwriting the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=971" target="_blank">00:16:11.120</a></span> | <span class="t">file over and over again okay and what you can also do if you want is you can add another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=980" target="_blank">00:16:20.800</a></span> | <span class="t">so this down here with open you can add that just in case there's any leftover items at the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=988" target="_blank">00:16:28.960</a></span> | <span class="t">there that haven't been saved into this neat 5000 chunk i'm not going to do that now you can add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=995" target="_blank">00:16:35.680</a></span> | <span class="t">that in if you want to okay so it looks pretty good the only thing that we we do need here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1000" target="_blank">00:16:40.480</a></span> | <span class="t">actually make sure the encoding is utf-8 otherwise we'll get i think we'll get an error if we if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1008" target="_blank">00:16:48.400</a></span> | <span class="t">miss that okay so that will or should create all of our data so let's let me open that directory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1017" target="_blank">00:16:57.440</a></span> | <span class="t">here on the left so we have this empty oscar directory i'm going to run this and we should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1026" target="_blank">00:17:06.240</a></span> | <span class="t">see it get populated so it's pretty quick there we go so we're building all these plain text files</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1032" target="_blank">00:17:12.880</a></span> | <span class="t">here and if we open that we ignore that and we see that we get all of these so each row here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1043" target="_blank">00:17:23.680</a></span> | <span class="t">is a new sample okay and as you can see it's all all italian so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1050" target="_blank">00:17:30.640</a></span> | <span class="t">that's our data it's ready and what we can do is move on to actually training the the tokenizer so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1060" target="_blank">00:17:40.640</a></span> | <span class="t">the first thing we actually need to do is get a list of all those files and that we can pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1066" target="_blank">00:17:46.000</a></span> | <span class="t">on to our tokenizer so to do that we'll use the pathlib library so from pathlib import path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1074" target="_blank">00:17:54.160</a></span> | <span class="t">and we just go string x for x in path so our so here we need to specify the directory where our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1090" target="_blank">00:18:10.160</a></span> | <span class="t">files will be found so that is just oscar and at the end here we just add this glob and here we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1097" target="_blank">00:18:17.360</a></span> | <span class="t">don't for in this case we don't need to do this because if we if we just use path here it will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1104" target="_blank">00:18:24.480</a></span> | <span class="t">just select all of the files in that directory and in our case we we can actually do that because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1109" target="_blank">00:18:29.760</a></span> | <span class="t">there's no other files other than the text files but it's good practice to just in case there is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1115" target="_blank">00:18:35.440</a></span> | <span class="t">anything else in there we can use a we can use this function here to say within this directory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1123" target="_blank">00:18:43.200</a></span> | <span class="t">just select all text files okay and then let's have a look so in pass we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1130" target="_blank">00:18:50.480</a></span> | <span class="t">we should have all of our files and let's see how many of those we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1139" target="_blank">00:18:59.280</a></span> | <span class="t">okay so we have 10 of those so in total yep 50 000 in in total samples there because you have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1146" target="_blank">00:19:06.480</a></span> | <span class="t">5 000 in each file okay so now let's initialize our plain tokenizer so we want to do from tokenizers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1155" target="_blank">00:19:15.840</a></span> | <span class="t">so if you don't have tokenizers installed super easy all you have to do is do pip install tokenizers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1163" target="_blank">00:19:23.200</a></span> | <span class="t">again this is another hug and face library like transformers or data sets which we used before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1169" target="_blank">00:19:29.360</a></span> | <span class="t">and from transformers we want to import the bert word piece tokenizer which is shown as there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1176" target="_blank">00:19:36.000</a></span> | <span class="t">so we load that and then our tokenizer we initialize it with bert word piece tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1182" target="_blank">00:19:42.640</a></span> | <span class="t">again and then in here we have a few a few different variables which are useful to to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1189" target="_blank">00:19:49.120</a></span> | <span class="t">understand so first one is clean text so this just removes obvious characters that we don't want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1197" target="_blank">00:19:57.200</a></span> | <span class="t">and converts all white space into spaces so we can say that's true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1203" target="_blank">00:20:03.600</a></span> | <span class="t">we have handle chinese characters now this you can say i'll leave it as false but but what this does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1215" target="_blank">00:20:15.280</a></span> | <span class="t">is if it sees a chinese character in your training data what it's going to do is just add spaces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1221" target="_blank">00:20:21.440</a></span> | <span class="t">around that character which as far as i know allows but at least when we're tokenizing those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1228" target="_blank">00:20:28.240</a></span> | <span class="t">chinese characters it allows them to be better represented i assume but i obviously i don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1235" target="_blank">00:20:35.760</a></span> | <span class="t">know chinese and i have never trained anything in chinese so i don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1242" target="_blank">00:20:42.400</a></span> | <span class="t">but that's what it does strip accents so this is a pretty relevant one for us so this is say if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1249" target="_blank">00:20:49.440</a></span> | <span class="t">have like an e like this it will convert it into this obviously for romance languages like italian</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1258" target="_blank">00:20:58.800</a></span> | <span class="t">we those accents are pretty important so we don't want to we don't want to strip those it's also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1266" target="_blank">00:21:06.160</a></span> | <span class="t">strip not string and then the final one lowercase so this is if we want to if we want to view this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1275" target="_blank">00:21:15.200</a></span> | <span class="t">is equal to this we would set low case equal to true in this case we i you know for me i'm happy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1283" target="_blank">00:21:23.360</a></span> | <span class="t">to have those capital characters as being equal to low case characters that's completely fine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1289" target="_blank">00:21:29.600</a></span> | <span class="t">so that initializes handle chinese sorry handle chinese characters like this so that initializes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1299" target="_blank">00:21:39.680</a></span> | <span class="t">our tokenizer now we we train it so tokenizer dot train in here we need to first pass our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1306" target="_blank">00:21:46.960</a></span> | <span class="t">files so the is it pass that we use up here yeah pass so training it with those we want to set the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1314" target="_blank">00:21:54.960</a></span> | <span class="t">vocab size so this is the number of tokens that we can have within our tokenizer it can be very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1322" target="_blank">00:22:02.400</a></span> | <span class="t">small for us because we we don't have that much data in there i want to set the min frequency</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1328" target="_blank">00:22:08.640</a></span> | <span class="t">which initially i thought oh that must mean that you know the minimum number of times a token must</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1335" target="_blank">00:22:15.040</a></span> | <span class="t">be found in the data for it to be added to the vocabulary but it's not it's actually the the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1340" target="_blank">00:22:20.720</a></span> | <span class="t">minimum number of times that the it must see two different tokens or characters together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1348" target="_blank">00:22:28.800</a></span> | <span class="t">in order for it to consider these as actually a token by themselves so so merged together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1354" target="_blank">00:22:34.320</a></span> | <span class="t">so typically i think people use two for that which is fine special tokens so these are the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1363" target="_blank">00:22:43.360</a></span> | <span class="t">special tokens i use by bert special underscore tokens and for that we will have padding so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1371" target="_blank">00:22:51.280</a></span> | <span class="t">padding token the unknown token the classifier token which we put the start of every every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1378" target="_blank">00:22:58.720</a></span> | <span class="t">sequence let me put this on a new line we have the separator token which we put the end of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1387" target="_blank">00:23:07.200</a></span> | <span class="t">of a sequence and then we also have the mask token which is pretty important if we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1393" target="_blank">00:23:13.200</a></span> | <span class="t">training that core model we also have limit the alphabet so this is the number of different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1400" target="_blank">00:23:20.560</a></span> | <span class="t">characters that we can see within our vocab so limit alphabet so we'll go with 1000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1408" target="_blank">00:23:28.400</a></span> | <span class="t">and word pieces prefix so this is what we saw before in the example where we had the two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1417" target="_blank">00:23:37.120</a></span> | <span class="t">um the two hashes and this like i said it just indicates a piece of a word rather than a full</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1425" target="_blank">00:23:45.040</a></span> | <span class="t">word and that should be it actually so i don't think there's really anything else that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1430" target="_blank">00:23:50.480</a></span> | <span class="t">important for us so we'll train that make sure hopefully it will work again this can take a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1438" target="_blank">00:23:58.080</a></span> | <span class="t">little bit well this will take a little bit of time even without our smaller smaller data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1445" target="_blank">00:24:05.680</a></span> | <span class="t">so let's see what it's showing us it's not i don't know why i think i need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1451" target="_blank">00:24:11.600</a></span> | <span class="t">install something here because i just get this blank output i think it's supposed to be a loading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1457" target="_blank">00:24:17.680</a></span> | <span class="t">bar and then what we we do at this point is we probably want to save our new tokenizer so i'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1466" target="_blank">00:24:26.240</a></span> | <span class="t">going to save it as new tokenizer and i just write tokenizer dot save model and that is going to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1477" target="_blank">00:24:37.520</a></span> | <span class="t">to new tokenizer directory so new tokenizer okay and that will save this vocab dot text file and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1486" target="_blank">00:24:46.880</a></span> | <span class="t">if we we just have a quick look at what that has inside so come over here so we have new tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1495" target="_blank">00:24:55.840</a></span> | <span class="t">vocab dot text and then in here we can see all of our all of our tokens okay so the way that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1504" target="_blank">00:25:04.000</a></span> | <span class="t">the way that this works yeah so you can actually see you know how we use that alphabet the limit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1510" target="_blank">00:25:10.640</a></span> | <span class="t">alphabet we can see that there are 1000 tokens so this stops at 1005 and then go all the way up here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1519" target="_blank">00:25:19.120</a></span> | <span class="t">so it begins at row six so that's the 1000 alphabet characters so single characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1526" target="_blank">00:25:26.160</a></span> | <span class="t">that are within or allowed within our tokenizer now the oscar data set is just pulled from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1532" target="_blank">00:25:32.800</a></span> | <span class="t">internet so you do get a lot of random stuff in there so we have well we have a lot of chinese</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1539" target="_blank">00:25:39.600</a></span> | <span class="t">characters when we're dealing with italian but if we come down here we start to see some of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1544" target="_blank">00:25:44.240</a></span> | <span class="t">italian words and these are the tokens so our text our tokenizer is going to read our text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1552" target="_blank">00:25:52.080</a></span> | <span class="t">it's going to split it out into these tokens so like the abb op fin it's going to split out into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1561" target="_blank">00:26:01.040</a></span> | <span class="t">those and then the next step is to convert those into token ids which are represented by the row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1566" target="_blank">00:26:06.640</a></span> | <span class="t">numbers of those tokens so if it's all fin in in the in the text it would replace that with the fin</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1574" target="_blank">00:26:14.720</a></span> | <span class="t">token and then it would replace the fin token with this 2201 now let's let's see how it works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1583" target="_blank">00:26:23.760</a></span> | <span class="t">so first thing is well how do we load that tokenizer we we do it as we normally would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1590" target="_blank">00:26:30.720</a></span> | <span class="t">so from transformers import we're using a bet tokenizer so import bet tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1597" target="_blank">00:26:37.280</a></span> | <span class="t">and we'll say tokenizer equals a bet tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1604" target="_blank">00:26:44.880</a></span> | <span class="t">from pre-trained and all we do is we point that to where we save it so it's a new tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1614" target="_blank">00:26:54.560</a></span> | <span class="t">and that should load okay so first i want to say tokenizer and i'm going to tokenize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1621" target="_blank">00:27:01.680</a></span> | <span class="t">ciao come over and this is just hi how are you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1627" target="_blank">00:27:07.280</a></span> | <span class="t">and we see that we get these these tokens here so we have number two here which if you probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1637" target="_blank">00:27:17.520</a></span> | <span class="t">don't remember in our in our text file at the top we had our special tokens row number two we had the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1643" target="_blank">00:27:23.840</a></span> | <span class="t">cls token so the classified token which we always put at the start of a sequence and at the end we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1650" target="_blank">00:27:30.720</a></span> | <span class="t">also have this three which is the separator token now if we just go and open that vocab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1659" target="_blank">00:27:39.680</a></span> | <span class="t">file that we built so it's a new tokenizer new tokenizer vocab.txt if we read that in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1668" target="_blank">00:27:48.960</a></span> | <span class="t">so let's write vocab fp.read and we want to split by new line characters so split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1682" target="_blank">00:28:02.560</a></span> | <span class="t">like so because every token is is separated by a new line we can see let's have a look at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1690" target="_blank">00:28:10.400</a></span> | <span class="t">special tokens so we have padding unknown cls at position number two and separate position number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1697" target="_blank">00:28:17.120</a></span> | <span class="t">three so if i were to go number two we'd get cls which aligns to to what we have here so what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1705" target="_blank">00:28:25.040</a></span> | <span class="t">can do is we could take all of these values and we could use them to identify from this vocab and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1713" target="_blank">00:28:33.600</a></span> | <span class="t">we can do it using tokenizer decode by the way as well but i'm going to do it by indexing in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1720" target="_blank">00:28:40.240</a></span> | <span class="t">vocab file that we built just to you know show that that's what the vocab file actually is that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1726" target="_blank">00:28:46.800</a></span> | <span class="t">how it's used so if i write that out so we have take this i want to access input ids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1744" target="_blank">00:29:04.480</a></span> | <span class="t">okay and what i'm going to do is say for i in that list can you print vocab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1754" target="_blank">00:29:14.400</a></span> | <span class="t">vocab i and at the end we'll just add a space okay and then we get this so cls the starting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1766" target="_blank">00:29:26.000</a></span> | <span class="t">classified token ciao exclamation mark call me that question mark separate a token which marks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1772" target="_blank">00:29:32.320</a></span> | <span class="t">the end of our our sentence which i think is is pretty cool now let's let's try that with something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1779" target="_blank">00:29:39.120</a></span> | <span class="t">else so we'll take this again do i want okay so yeah we'll just do this so what i say a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1788" target="_blank">00:29:48.320</a></span> | <span class="t">when in italy is ok peter niente and ok peter niente means i understood nothing which is very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1800" target="_blank">00:30:00.320</a></span> | <span class="t">useful so if i print that out we see that we get cls ok peter niente separator now what we're seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1811" target="_blank">00:30:11.520</a></span> | <span class="t">here is you know full words we're not seeing any word pieces so if i can find it i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1822" target="_blank">00:30:22.240</a></span> | <span class="t">this will hopefully return a word piece so response stability like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1829" target="_blank">00:30:29.120</a></span> | <span class="t">let me try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1832" target="_blank">00:30:32.320</a></span> | <span class="t">this will hopefully return a few word pieces yes there we go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1839" target="_blank">00:30:39.600</a></span> | <span class="t">okay so we see a respond see billy tap and these are our different word pieces so this gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1850" target="_blank">00:30:50.240</a></span> | <span class="t">separated into not just a single token but four tokens which is is pretty cool now i think i mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1858" target="_blank">00:30:58.560</a></span> | <span class="t">that's it for for this video don't think yeah i mean it's nothing nothing else i want to i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1867" target="_blank">00:31:07.120</a></span> | <span class="t">we need to cover that's pretty much everything we really need to know for building a word piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1871" target="_blank">00:31:11.680</a></span> | <span class="t">tokenizer for for using with with bert so yeah thank you very much for watching and i will see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cR4qMSIvX28&t=1878" target="_blank">00:31:18.400</a></span> | <span class="t">see you in the next one. Bye.</span></div></div></body></html>