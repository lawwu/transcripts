<html><head><title>AugSBERT: Domain Transfer for Sentence Transformers</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>AugSBERT: Domain Transfer for Sentence Transformers</h2><a href="https://www.youtube.com/watch?v=a8jyue22SJM"><img src="https://i.ytimg.com/vi/a8jyue22SJM/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=0">0:0</a> Why Use Domain Transfer<br><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=248">4:8</a> Strategy Outline<br><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=365">6:5</a> Train Source Cross-Encoder<br><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=764">12:44</a> Cross-Encoder Outcome<br><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=912">15:12</a> Labeling Target Data<br><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1231">20:31</a> Training Bi-encoder<br><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1438">23:58</a> Evaluator Bi-encoder Performance<br><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1688">28:8</a> Final Points<br><br><div style="text-align: left;"><a href="./a8jyue22SJM.html">Whisper Transcript</a> | <a href="./transcript_a8jyue22SJM.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we're going to talk about how we can train language models across different domains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=6" target="_blank">00:00:06.880</a></span> | <span class="t">Now to do this we're going to be using what is called the augmented expert training strategy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=13" target="_blank">00:00:13.200</a></span> | <span class="t">And we're going to be using the domain transfer flavor of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=17" target="_blank">00:00:17.680</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=19" target="_blank">00:00:19.440</a></span> | <span class="t">the training strategy is used where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=22" target="_blank">00:00:22.160</a></span> | <span class="t">You have some data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=25" target="_blank">00:00:25.280</a></span> | <span class="t">But not enough or you in our case with domain transfer. We have some data in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=31" target="_blank">00:00:31.360</a></span> | <span class="t">One domain so say maybe we have quora question pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=35" target="_blank">00:00:35.600</a></span> | <span class="t">But we need sac overflow question pairs and all we have on the sac overflow side</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=42" target="_blank">00:00:42.080</a></span> | <span class="t">are unlabeled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=44" target="_blank">00:00:44.720</a></span> | <span class="t">question pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=46" target="_blank">00:00:46.400</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=47" target="_blank">00:00:47.360</a></span> | <span class="t">What we're essentially doing is using that source data set the for example quora question pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=54" target="_blank">00:00:54.000</a></span> | <span class="t">to train a model that can then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=56" target="_blank">00:00:56.080</a></span> | <span class="t">Transfer its knowledge and label the sac overflow question pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=62" target="_blank">00:01:02.640</a></span> | <span class="t">Now we don't need to stick with question pairs and question pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=65" target="_blank">00:01:05.600</a></span> | <span class="t">We can have and go from question pairs to semantic similarity pairs or anything else</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=71" target="_blank">00:01:11.120</a></span> | <span class="t">but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=72" target="_blank">00:01:12.400</a></span> | <span class="t">We do have to make sure that our source domain and target domain are at least similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=77" target="_blank">00:01:17.680</a></span> | <span class="t">and we can think of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=81" target="_blank">00:01:21.440</a></span> | <span class="t">required similarity as a bridge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=84" target="_blank">00:01:24.160</a></span> | <span class="t">across a gap between the source domain and target main the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=89" target="_blank">00:01:29.440</a></span> | <span class="t">Great that gap. So the the less overlap those two domains have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=94" target="_blank">00:01:34.880</a></span> | <span class="t">the greater this gap here is and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=98" target="_blank">00:01:38.080</a></span> | <span class="t">If this gap is bigger, we obviously need a bigger stronger bridge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=103" target="_blank">00:01:43.200</a></span> | <span class="t">And we can think of that bridge as our model. We need a bigger stronger model to bridge these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=110" target="_blank">00:01:50.320</a></span> | <span class="t">longer or greater gaps between the two domains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=114" target="_blank">00:01:54.640</a></span> | <span class="t">So in this video, we're going to be going through one example, but I have tested these five different data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=122" target="_blank">00:02:02.560</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=124" target="_blank">00:02:04.400</a></span> | <span class="t">What we can see is the n-gram similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=128" target="_blank">00:02:08.100</a></span> | <span class="t">So this is how many n-grams overlap between the two data sets as a as a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=135" target="_blank">00:02:15.840</a></span> | <span class="t">So this is not a perfect measure of similarity, of course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=140" target="_blank">00:02:20.960</a></span> | <span class="t">because it's only capturing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=142" target="_blank">00:02:22.960</a></span> | <span class="t">Syntactical overlap and it's not really capturing whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=147" target="_blank">00:02:27.440</a></span> | <span class="t">the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=149" target="_blank">00:02:29.360</a></span> | <span class="t">two data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=151" target="_blank">00:02:31.280</a></span> | <span class="t">Have the same language structure or talking about the same topics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=155" target="_blank">00:02:35.200</a></span> | <span class="t">that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=157" target="_blank">00:02:37.520</a></span> | <span class="t">Much although it does help and this is just a very simple measure to help us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=162" target="_blank">00:02:42.640</a></span> | <span class="t">figure out whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=165" target="_blank">00:02:45.280</a></span> | <span class="t">The two domains that we're trying to transfer across</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=170" target="_blank">00:02:50.000</a></span> | <span class="t">will be easy to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=172" target="_blank">00:02:52.000</a></span> | <span class="t">bridge or not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=174" target="_blank">00:02:54.080</a></span> | <span class="t">so we would expect from this that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=176" target="_blank">00:02:56.560</a></span> | <span class="t">Medical question pairs down here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=179" target="_blank">00:02:59.600</a></span> | <span class="t">Because of this these lower similarity scores it would probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=183" target="_blank">00:03:03.860</a></span> | <span class="t">Not be the best domain transfer to these different domains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=190" target="_blank">00:03:10.080</a></span> | <span class="t">Whereas these different domains stsb rte</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=195" target="_blank">00:03:15.100</a></span> | <span class="t">Mrpc and quora question pairs are all reasonably similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=199" target="_blank">00:03:19.500</a></span> | <span class="t">So we'd expect the performance or the transfer or ease of transfer between those domains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=205" target="_blank">00:03:25.500</a></span> | <span class="t">to be much smoother</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=208" target="_blank">00:03:28.300</a></span> | <span class="t">But like I said, this isn't perfect and in fact one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=213" target="_blank">00:03:33.820</a></span> | <span class="t">best domain transfer performances that I saw was from the medical question pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=221" target="_blank">00:03:41.580</a></span> | <span class="t">to the quora question pairs, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=224" target="_blank">00:03:44.780</a></span> | <span class="t">Obviously makes sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=226" target="_blank">00:03:46.680</a></span> | <span class="t">Semantically because question pairs will probably have more of a similar structure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=231" target="_blank">00:03:51.340</a></span> | <span class="t">than entailment pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=233" target="_blank">00:03:53.900</a></span> | <span class="t">Which is what we have up here with rt or just semantic textual similarity pairs as we have up here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=240" target="_blank">00:04:00.540</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=242" target="_blank">00:04:02.380</a></span> | <span class="t">That does make sense logically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=244" target="_blank">00:04:04.380</a></span> | <span class="t">But it's not really reflected in this chart here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=247" target="_blank">00:04:07.820</a></span> | <span class="t">so this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=250" target="_blank">00:04:10.460</a></span> | <span class="t">overall</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=252" target="_blank">00:04:12.120</a></span> | <span class="t">Strategy that we're going to follow with domain transfer augmented experts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=256" target="_blank">00:04:16.700</a></span> | <span class="t">so the first step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=259" target="_blank">00:04:19.640</a></span> | <span class="t">is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=260" target="_blank">00:04:20.760</a></span> | <span class="t">to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=261" target="_blank">00:04:21.960</a></span> | <span class="t">Get our data. So we're going to have a labeled source data set which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=265" target="_blank">00:04:25.640</a></span> | <span class="t">The earlier example would have been the quora question pairs and we're also going to have the unlabeled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=271" target="_blank">00:04:31.020</a></span> | <span class="t">Target data set which would be our stack overflow question pairs. We're not actually going to use those two examples. We're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=277" target="_blank">00:04:37.800</a></span> | <span class="t">from here we're going to go with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=281" target="_blank">00:04:41.060</a></span> | <span class="t">mrpc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=282" target="_blank">00:04:42.740</a></span> | <span class="t">As our source data set and stsb as our target data set. So we'll go ahead and we'll get our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=289" target="_blank">00:04:49.780</a></span> | <span class="t">labeled source data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=292" target="_blank">00:04:52.420</a></span> | <span class="t">So that's going to be mrpc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=294" target="_blank">00:04:54.420</a></span> | <span class="t">And we'll train a cross encoder model with it. Now. The reason i'll just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=299" target="_blank">00:04:59.780</a></span> | <span class="t">Quickly mention is the reason we're training a cross encoder model rather than a by encoder model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=305" target="_blank">00:05:05.620</a></span> | <span class="t">Which is a sentence transformer is because we need less data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=309" target="_blank">00:05:09.300</a></span> | <span class="t">to train a good cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=311" target="_blank">00:05:11.860</a></span> | <span class="t">and the cross encoder here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=314" target="_blank">00:05:14.340</a></span> | <span class="t">Is only used to label the target data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=317" target="_blank">00:05:17.940</a></span> | <span class="t">So we need less data to train a good cross encoder, but cross encoders are also slow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=324" target="_blank">00:05:24.020</a></span> | <span class="t">Which is why we don't use a cross encoder over here as our final model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=327" target="_blank">00:05:27.860</a></span> | <span class="t">so we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=329" target="_blank">00:05:29.780</a></span> | <span class="t">Basically using that greater performance with less data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=332" target="_blank">00:05:32.980</a></span> | <span class="t">to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=335" target="_blank">00:05:35.140</a></span> | <span class="t">Build a data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=336" target="_blank">00:05:36.820</a></span> | <span class="t">over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=338" target="_blank">00:05:38.100</a></span> | <span class="t">That can train a fast sentence transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=341" target="_blank">00:05:41.080</a></span> | <span class="t">Over here to a similar level or similar performance to that cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=346" target="_blank">00:05:46.500</a></span> | <span class="t">That's basically what we're doing. It's knowledge distillation from our cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=352" target="_blank">00:05:52.660</a></span> | <span class="t">All the way over to our sentence transformer. That's all we're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=357" target="_blank">00:05:57.460</a></span> | <span class="t">So let's jump over to the code and we'll have a look at how we do those or form those first two steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=364" target="_blank">00:06:04.900</a></span> | <span class="t">Okay, so we're starting with the source domain mrpc as I said, and the target domain is scsb</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=371" target="_blank">00:06:11.220</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=372" target="_blank">00:06:12.820</a></span> | <span class="t">First thing we do is get that source data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=375" target="_blank">00:06:15.060</a></span> | <span class="t">So we use hugging face data sets for this so you may need to pip install that so just pip install</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=383" target="_blank">00:06:23.060</a></span> | <span class="t">data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=385" target="_blank">00:06:25.860</a></span> | <span class="t">And from data sets we import load data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=388" target="_blank">00:06:28.580</a></span> | <span class="t">So this is just going to load the mrpc data set from hugging face</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=393" target="_blank">00:06:33.940</a></span> | <span class="t">which is stored in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=395" target="_blank">00:06:35.780</a></span> | <span class="t">Larger glue data set and mrpc is like a subset of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=400" target="_blank">00:06:40.740</a></span> | <span class="t">And then we're taking the train split from there and we can see the data set features here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=406" target="_blank">00:06:46.500</a></span> | <span class="t">So we have sentence one and two which are sentence pairs that we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=410" target="_blank">00:06:50.180</a></span> | <span class="t">learning from to in order to label the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=414" target="_blank">00:06:54.660</a></span> | <span class="t">Scsb sentence pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=417" target="_blank">00:06:57.140</a></span> | <span class="t">And we also have the label as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=419" target="_blank">00:06:59.140</a></span> | <span class="t">And we only have three point six thousand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=423" target="_blank">00:07:03.300</a></span> | <span class="t">Samples here, which is quite a small number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=426" target="_blank">00:07:06.340</a></span> | <span class="t">Particularly for a sentence transformer. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=429" target="_blank">00:07:09.220</a></span> | <span class="t">That's why we're going with the cross encoder here so that can build something that has good performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=434" target="_blank">00:07:14.980</a></span> | <span class="t">Whereas a sentence transformer might need a little more data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=439" target="_blank">00:07:19.860</a></span> | <span class="t">Although not necessarily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=442" target="_blank">00:07:22.980</a></span> | <span class="t">Um, so we need to first format that data for training and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=449" target="_blank">00:07:29.380</a></span> | <span class="t">to do that we we just go through each row in the data set that we just downloaded and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=455" target="_blank">00:07:35.300</a></span> | <span class="t">Sentence transformers always uses this input example object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=460" target="_blank">00:07:40.500</a></span> | <span class="t">So all we're doing here is creating a an empty list and then within that empty list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=465" target="_blank">00:07:45.620</a></span> | <span class="t">We're populating it with these input examples, which contain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=469" target="_blank">00:07:49.700</a></span> | <span class="t">sentence pairs here and also a label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=472" target="_blank">00:07:52.980</a></span> | <span class="t">And then behind the scenes we're using pytorch. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=478" target="_blank">00:07:58.340</a></span> | <span class="t">We also need to initialize a pytorch data loader with those input examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=484" target="_blank">00:08:04.260</a></span> | <span class="t">And we're using batch size 16 and also shuffling that data as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=487" target="_blank">00:08:07.860</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=490" target="_blank">00:08:10.340</a></span> | <span class="t">That's our our data's ready for training the cross encoder and then we move on to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=496" target="_blank">00:08:16.660</a></span> | <span class="t">if we'd like to we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=499" target="_blank">00:08:19.460</a></span> | <span class="t">Move on to adding this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=501" target="_blank">00:08:21.120</a></span> | <span class="t">Validation set as well, which is useful because then we get a performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=506" target="_blank">00:08:26.660</a></span> | <span class="t">from our source validation set if possible, you really probably want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=512" target="_blank">00:08:32.260</a></span> | <span class="t">Switch this out for the target data set validation set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=516" target="_blank">00:08:36.660</a></span> | <span class="t">So this would be in our case it would be stsb i'm not going to do that here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=524" target="_blank">00:08:44.180</a></span> | <span class="t">just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=526" target="_blank">00:08:46.180</a></span> | <span class="t">to emulate in in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=528" target="_blank">00:08:48.180</a></span> | <span class="t">Like an actual project you may not have this validation data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=532" target="_blank">00:08:52.900</a></span> | <span class="t">From your target domain, but I would I would definitely recommend if you do have the time to just manually label something so that you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=539" target="_blank">00:08:59.540</a></span> | <span class="t">Check out performance you'll want you will want to do that later anyway</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=543" target="_blank">00:09:03.540</a></span> | <span class="t">But for now, we'll just use source data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=546" target="_blank">00:09:06.660</a></span> | <span class="t">We're using this cross encoder because training the cross encoder and it's coming from this cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=553" target="_blank">00:09:13.240</a></span> | <span class="t">Section of sentence transformers library and it's a correlation evaluator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=557" target="_blank">00:09:17.640</a></span> | <span class="t">okay, so that's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=560" target="_blank">00:09:20.740</a></span> | <span class="t">check the correlation between the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=562" target="_blank">00:09:22.740</a></span> | <span class="t">Labels that we have here. So the true labels in our validation set and the predicted labels from the cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=570" target="_blank">00:09:30.580</a></span> | <span class="t">So cross encoder does not output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=572" target="_blank">00:09:32.660</a></span> | <span class="t">Sentence vectors like a sentence transformer. It outputs a similarity score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=577" target="_blank">00:09:37.700</a></span> | <span class="t">And then we just initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=581" target="_blank">00:09:41.720</a></span> | <span class="t">That correlation value we're using from input examples. So we're using input examples up here. So we use that there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=590" target="_blank">00:09:50.580</a></span> | <span class="t">and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=591" target="_blank">00:09:51.380</a></span> | <span class="t">yeah, that's our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=593" target="_blank">00:09:53.220</a></span> | <span class="t">Training and validation data. I'm ready to go so we can go ahead and start training the cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=599" target="_blank">00:09:59.620</a></span> | <span class="t">so for training the cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=602" target="_blank">00:10:02.260</a></span> | <span class="t">we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=603" target="_blank">00:10:03.380</a></span> | <span class="t">Load this cross encoder object from sentence transformers again just using a vert base. Okay, so that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=609" target="_blank">00:10:09.620</a></span> | <span class="t">initial model that we're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=612" target="_blank">00:10:12.340</a></span> | <span class="t">to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=614" target="_blank">00:10:14.180</a></span> | <span class="t">Initialize our cross encoder from a search coming from the hooking face models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=619" target="_blank">00:10:19.460</a></span> | <span class="t">hope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=620" target="_blank">00:10:20.740</a></span> | <span class="t">um and the number of labels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=623" target="_blank">00:10:23.060</a></span> | <span class="t">So this you can change this if you are training a cross encoder that you'd like to predict nli</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=629" target="_blank">00:10:29.780</a></span> | <span class="t">Labels, for example, so you'd have zero one two, which would be your contradiction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=634" target="_blank">00:10:34.840</a></span> | <span class="t">neutral and entailment classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=638" target="_blank">00:10:38.020</a></span> | <span class="t">You would put something like three because you you have three labels and you want to output three labels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=643" target="_blank">00:10:43.860</a></span> | <span class="t">But for us we want to output a similarity score. So we just have one label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=648" target="_blank">00:10:48.420</a></span> | <span class="t">Then we have here we have number of epochs now anything more than one you're probably going to over fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=653" target="_blank">00:10:53.460</a></span> | <span class="t">so I would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=655" target="_blank">00:10:55.140</a></span> | <span class="t">I think always stick with one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=657" target="_blank">00:10:57.140</a></span> | <span class="t">um, unless you really have reason to do otherwise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=662" target="_blank">00:11:02.020</a></span> | <span class="t">And here we have the percentage of warm-up steps that we're going to use so this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=668" target="_blank">00:11:08.980</a></span> | <span class="t">Number of steps where we're not going to be training at the full learning rate, but we're going to be gradually increasing up to that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=677" target="_blank">00:11:17.140</a></span> | <span class="t">full learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=679" target="_blank">00:11:19.060</a></span> | <span class="t">So it's quite high 35, but it's what tends to work best. I found find with cross encoders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=685" target="_blank">00:11:25.380</a></span> | <span class="t">a higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=687" target="_blank">00:11:27.380</a></span> | <span class="t">Percentage of warm-up steps tends to work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=689" target="_blank">00:11:29.620</a></span> | <span class="t">reasonably well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=692" target="_blank">00:11:32.420</a></span> | <span class="t">And then over here we have our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=695" target="_blank">00:11:35.620</a></span> | <span class="t">optimizer parameters which is another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=698" target="_blank">00:11:38.580</a></span> | <span class="t">Training parameter that I modified a little bit. So here we're using slightly higher than the default of two e to the minus five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=705" target="_blank">00:11:45.540</a></span> | <span class="t">We're using five e to the minus five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=707" target="_blank">00:11:47.540</a></span> | <span class="t">Now everything else is as you usually would with the crossing coder. So we're using the fit method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=713" target="_blank">00:11:53.140</a></span> | <span class="t">We will do that with a sentence transformer as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=716" target="_blank">00:11:56.340</a></span> | <span class="t">the train data loader, this is slightly different to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=720" target="_blank">00:12:00.020</a></span> | <span class="t">sentence transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=722" target="_blank">00:12:02.580</a></span> | <span class="t">Parameter, but otherwise everything is exactly the same way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=726" target="_blank">00:12:06.260</a></span> | <span class="t">So passing in our source data, which is the training data loader that we created earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=731" target="_blank">00:12:11.860</a></span> | <span class="t">We have our evaluator number of epochs warm-up steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=734" target="_blank">00:12:14.900</a></span> | <span class="t">Learning rate and where we are going to save the model so that a source is going to be mrpc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=741" target="_blank">00:12:21.160</a></span> | <span class="t">cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=743" target="_blank">00:12:23.780</a></span> | <span class="t">um, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=745" target="_blank">00:12:25.220</a></span> | <span class="t">That trains our model. It doesn't take long. You can see here. It's it took on this computer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=750" target="_blank">00:12:30.420</a></span> | <span class="t">14 seconds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=753" target="_blank">00:12:33.140</a></span> | <span class="t">very quick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=754" target="_blank">00:12:34.660</a></span> | <span class="t">And then we can go ahead and label the target data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=758" target="_blank">00:12:38.100</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=760" target="_blank">00:12:40.100</a></span> | <span class="t">That's on to the next step. So let me actually go back to here. So we've just we're going to kind of cross these off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=767" target="_blank">00:12:47.060</a></span> | <span class="t">so we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=768" target="_blank">00:12:48.180</a></span> | <span class="t">Labeled source data and we train our cross encoder. Okay, so this is our performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=774" target="_blank">00:12:54.200</a></span> | <span class="t">of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=776" target="_blank">00:12:56.180</a></span> | <span class="t">Cross encoder models. So that is the the source models over here on different target data sets over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=782" target="_blank">00:13:02.820</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=784" target="_blank">00:13:04.900</a></span> | <span class="t">the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=786" target="_blank">00:13:06.180</a></span> | <span class="t">Source model for mrpc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=788" target="_blank">00:13:08.680</a></span> | <span class="t">on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=791" target="_blank">00:13:11.460</a></span> | <span class="t">Stsb target data over here. So this is a the validation set of the stsb target data is what we are aiming for. So this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=798" target="_blank">00:13:18.420</a></span> | <span class="t">0.63 now we should be able to get a better performance than this I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=802" target="_blank">00:13:22.900</a></span> | <span class="t">Uh, but we'll have a look and we can also see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=805" target="_blank">00:13:25.940</a></span> | <span class="t">I I said the stsb is quite easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=808" target="_blank">00:13:28.820</a></span> | <span class="t">As a data set to get good results on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=813" target="_blank">00:13:33.220</a></span> | <span class="t">And we can see that here because all of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=815" target="_blank">00:13:35.940</a></span> | <span class="t">uh do achieve better performance, but what we or what I really want to focus on here is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=822" target="_blank">00:13:42.660</a></span> | <span class="t">The bird based on case performance as a benchmark</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=825" target="_blank">00:13:45.800</a></span> | <span class="t">because this is what you would get if you didn't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=829" target="_blank">00:13:49.380</a></span> | <span class="t">your any any training data or which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=832" target="_blank">00:13:52.980</a></span> | <span class="t">We don't we don't have any target domain training data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=837" target="_blank">00:13:57.140</a></span> | <span class="t">Instead where we're kind of using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=840" target="_blank">00:14:00.660</a></span> | <span class="t">Or expert training strategy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=842" target="_blank">00:14:02.820</a></span> | <span class="t">to train from the source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=845" target="_blank">00:14:05.540</a></span> | <span class="t">data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=847" target="_blank">00:14:07.540</a></span> | <span class="t">So these are our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=850" target="_blank">00:14:10.020</a></span> | <span class="t">benchmarks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=851" target="_blank">00:14:11.620</a></span> | <span class="t">and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=852" target="_blank">00:14:12.500</a></span> | <span class="t">we can see that the from from here, so we have these red circles which represent that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=858" target="_blank">00:14:18.980</a></span> | <span class="t">The model performance has decreased from that benchmark and then the blue ones over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=866" target="_blank">00:14:26.740</a></span> | <span class="t">they represent that the model performance has increased from the benchmark and then we also have gray, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=872" target="_blank">00:14:32.740</a></span> | <span class="t">To indicate that it was the same value or maybe a couple of points higher, but not that much higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=880" target="_blank">00:14:40.660</a></span> | <span class="t">So we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=884" target="_blank">00:14:44.500</a></span> | <span class="t">straight away that the worse and we can see that it does perform worse so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=890" target="_blank">00:14:50.660</a></span> | <span class="t">all of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=892" target="_blank">00:14:52.900</a></span> | <span class="t">Glue data sets don't really correlate so much with the medical question pairs and we can see a lot more red in this column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=899" target="_blank">00:14:59.460</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=901" target="_blank">00:15:01.700</a></span> | <span class="t">that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=902" target="_blank">00:15:02.820</a></span> | <span class="t">To be expected in the other glue data sets. We see a lot more gray and blue so the results either similar or better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=911" target="_blank">00:15:11.540</a></span> | <span class="t">So obviously the next bit is is this target domain part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=916" target="_blank">00:15:16.180</a></span> | <span class="t">We're not going to be doing this optional augment data because it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=922" target="_blank">00:15:22.660</a></span> | <span class="t">tend to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=924" target="_blank">00:15:24.100</a></span> | <span class="t">At least for these data sets. I didn't find this to help much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=928" target="_blank">00:15:28.500</a></span> | <span class="t">But if you if you do want to see how to do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=932" target="_blank">00:15:32.260</a></span> | <span class="t">the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=934" target="_blank">00:15:34.340</a></span> | <span class="t">last video that we did on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=936" target="_blank">00:15:36.340</a></span> | <span class="t">augmented expert last article</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=938" target="_blank">00:15:38.880</a></span> | <span class="t">Does cover that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=941" target="_blank">00:15:41.460</a></span> | <span class="t">Augmentation of data using something called random sampling. So we're just taking random samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=947" target="_blank">00:15:47.380</a></span> | <span class="t">from our data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=950" target="_blank">00:15:50.260</a></span> | <span class="t">And creating new pairs with that and then labeling them with our cross encoder. That's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=954" target="_blank">00:15:54.900</a></span> | <span class="t">All it all there is to it. So but for this I didn't find any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=959" target="_blank">00:15:59.620</a></span> | <span class="t">Significant performance increase it did increase the performance for a couple of the models a little bit but not not a huge amount</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=966" target="_blank">00:16:06.260</a></span> | <span class="t">So I I think for the time it takes it's probably not worth covering in some cases</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=972" target="_blank">00:16:12.180</a></span> | <span class="t">But if you think it might help especially if you had a small data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=975" target="_blank">00:16:15.140</a></span> | <span class="t">I would check out the other video and an article so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=980" target="_blank">00:16:20.900</a></span> | <span class="t">We need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=982" target="_blank">00:16:22.820</a></span> | <span class="t">Get out on label target data and then we're going to skip that step. So we'll just just cross it out and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=989" target="_blank">00:16:29.060</a></span> | <span class="t">We are going to label it with our cross encoder. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=993" target="_blank">00:16:33.620</a></span> | <span class="t">From up here. We're going to take that and label this this target data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=998" target="_blank">00:16:38.420</a></span> | <span class="t">so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1000" target="_blank">00:16:40.260</a></span> | <span class="t">Have a look at how we do that. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1002" target="_blank">00:16:42.260</a></span> | <span class="t">Yeah the labeling that target data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1006" target="_blank">00:16:46.180</a></span> | <span class="t">First we need target data. It's same again. We're just going to download that from the plugin face data sets library. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1013" target="_blank">00:16:53.460</a></span> | <span class="t">We're coming from the glue like larger data sets again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1017" target="_blank">00:16:57.940</a></span> | <span class="t">Um, but this time we're using stsb, which is quite an easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1022" target="_blank">00:17:02.260</a></span> | <span class="t">Data set to get good results on to be honest, so I wouldn't expect this sort of forms for everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1028" target="_blank">00:17:08.420</a></span> | <span class="t">Um, but this is just the example we're going to use here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1035" target="_blank">00:17:15.220</a></span> | <span class="t">And so we're obviously using the training split as well and we can see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1039" target="_blank">00:17:19.620</a></span> | <span class="t">Okay in that data set we have the features sentence one sentence two, and we also have the label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1044" target="_blank">00:17:24.180</a></span> | <span class="t">so obviously we don't actually need to use a cross encoder to create our labels, uh, but we are going to because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1051" target="_blank">00:17:31.220</a></span> | <span class="t">That's the whole point of this training strategy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1055" target="_blank">00:17:35.140</a></span> | <span class="t">And I just couldn't find a reasonable reasonably good data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1060" target="_blank">00:17:40.580</a></span> | <span class="t">that didn't have the labels already, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1064" target="_blank">00:17:44.340</a></span> | <span class="t">We're just pretending they don't exist. So you didn't this here. It's not there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1069" target="_blank">00:17:49.300</a></span> | <span class="t">Um if you if you're struggling to train across encoder or you can just download it from here, by the way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1077" target="_blank">00:17:57.780</a></span> | <span class="t">Um, or if it's taking a long time, I mean it shouldn't take that long, but I know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1081" target="_blank">00:18:01.700</a></span> | <span class="t">on on some machines it can take a while so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1085" target="_blank">00:18:05.300</a></span> | <span class="t">Just if you're following along this in real time, just I'll do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1091" target="_blank">00:18:11.300</a></span> | <span class="t">having any issues</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1094" target="_blank">00:18:14.340</a></span> | <span class="t">So we have our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1096" target="_blank">00:18:16.020</a></span> | <span class="t">Our target data and what we do is we zip those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1099" target="_blank">00:18:19.940</a></span> | <span class="t">sentence one sentence two together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1102" target="_blank">00:18:22.580</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1105" target="_blank">00:18:25.140</a></span> | <span class="t">I'll delete that. Let's say we have sentence one and we have the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1110" target="_blank">00:18:30.660</a></span> | <span class="t">I don't know what it could be. It could be I think it's something like a plane</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1115" target="_blank">00:18:35.220</a></span> | <span class="t">Our plane is taking off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1118" target="_blank">00:18:38.020</a></span> | <span class="t">And we would have basically a tuple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1124" target="_blank">00:18:44.440</a></span> | <span class="t">Where we have the first sentence and we also have the second related sentence, which is something like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1130" target="_blank">00:18:50.600</a></span> | <span class="t">An airplane</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1134" target="_blank">00:18:54.200</a></span> | <span class="t">Lands I don't think it's lands. It is something to taking off as well, but I don't remember what exactly it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1142" target="_blank">00:19:02.520</a></span> | <span class="t">So you would get something like this and then the next one would be something else like um the dog</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1152" target="_blank">00:19:12.200</a></span> | <span class="t">runs and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1154" target="_blank">00:19:14.200</a></span> | <span class="t">I don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1156" target="_blank">00:19:16.280</a></span> | <span class="t">the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1157" target="_blank">00:19:17.160</a></span> | <span class="t">The dog warps. Okay, so something like that. So we're getting these like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1161" target="_blank">00:19:21.880</a></span> | <span class="t">tuples of sentence pairs and we're feeding them into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1165" target="_blank">00:19:25.800</a></span> | <span class="t">The predict method of our cross encoder and that will return a set of scores. Obviously these here would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1172" target="_blank">00:19:32.200</a></span> | <span class="t">Reasonably high similarity because they're talking about similar topic not necessarily the same got warps and runs and lands and taking off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1181" target="_blank">00:19:41.160</a></span> | <span class="t">But they they would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1183" target="_blank">00:19:43.160</a></span> | <span class="t">so reasonably high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1185" target="_blank">00:19:45.160</a></span> | <span class="t">and then what i'm going to do, so this just makes things easier in terms of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1190" target="_blank">00:19:50.120</a></span> | <span class="t">Seeing what we actually what we're actually working with what we're looking at. So i'm just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1195" target="_blank">00:19:55.480</a></span> | <span class="t">Pass those sentence ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1198" target="_blank">00:19:58.040</a></span> | <span class="t">Under sentence twos and then there's a new spores into a pattern state frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1202" target="_blank">00:20:02.600</a></span> | <span class="t">And then we can see everything here. So we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1205" target="_blank">00:20:05.800</a></span> | <span class="t">A plane is taking off and an airplane is taking off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1209" target="_blank">00:20:09.400</a></span> | <span class="t">So that's that was the the first two I was talking about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1212" target="_blank">00:20:12.040</a></span> | <span class="t">And then we have all the labels that our cross encoder is predicting now. All these are pretty high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1216" target="_blank">00:20:16.920</a></span> | <span class="t">because these are all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1219" target="_blank">00:20:19.080</a></span> | <span class="t">very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1220" target="_blank">00:20:20.120</a></span> | <span class="t">similar semantically similar pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1222" target="_blank">00:20:22.280</a></span> | <span class="t">So that's why that's what we would expect but later on there are other pairs which are less similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1229" target="_blank">00:20:29.160</a></span> | <span class="t">And then we we move on to training the by encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1236" target="_blank">00:20:36.060</a></span> | <span class="t">So let's quickly switch back to our visual again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1239" target="_blank">00:20:39.260</a></span> | <span class="t">okay, so now we have identified or we've downloaded our unlabeled target data cross off and we've also labeled it using our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1248" target="_blank">00:20:48.700</a></span> | <span class="t">Cross encoder model. So the final step as we saw is training our by encoder with that labeled target data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1256" target="_blank">00:20:56.780</a></span> | <span class="t">So let's have a look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1259" target="_blank">00:20:59.100</a></span> | <span class="t">How we would do that. So we have our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1263" target="_blank">00:21:03.500</a></span> | <span class="t">labeled target data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1265" target="_blank">00:21:05.500</a></span> | <span class="t">In this pandas data frame here. So we're just going to iterate through the rows in our data frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1271" target="_blank">00:21:11.100</a></span> | <span class="t">And i'm going to append all those input examples as we did before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1275" target="_blank">00:21:15.500</a></span> | <span class="t">to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1277" target="_blank">00:21:17.180</a></span> | <span class="t">This data list here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1279" target="_blank">00:21:19.180</a></span> | <span class="t">Okay, and we have our sentence pairs and we have the predicted labels in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1286" target="_blank">00:21:26.380</a></span> | <span class="t">So once we've created those that list of input examples again, we're just pushing all of that to a pytorch data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1293" target="_blank">00:21:33.820</a></span> | <span class="t">and from there we can go on and initialize our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1298" target="_blank">00:21:38.380</a></span> | <span class="t">our sentence transformer so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1301" target="_blank">00:21:41.100</a></span> | <span class="t">To do that. We are using models and sentence transformer from the sentence transformers library and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1308" target="_blank">00:21:48.380</a></span> | <span class="t">So the sentence transformer takes the typical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1313" target="_blank">00:21:53.020</a></span> | <span class="t">transformer like bert and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1316" target="_blank">00:21:56.600</a></span> | <span class="t">What</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1317" target="_blank">00:21:57.640</a></span> | <span class="t">Bert outputs is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1319" target="_blank">00:21:59.640</a></span> | <span class="t">512 word vectors and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1322" target="_blank">00:22:02.340</a></span> | <span class="t">What we want is one single sentence vector for from our sentence transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1329" target="_blank">00:22:09.020</a></span> | <span class="t">so to do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1331" target="_blank">00:22:11.480</a></span> | <span class="t">we need a way of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1333" target="_blank">00:22:13.640</a></span> | <span class="t">Translating those 512 word vectors into a single vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1337" target="_blank">00:22:17.720</a></span> | <span class="t">And we do that by pooling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1341" target="_blank">00:22:21.000</a></span> | <span class="t">all of those 512 tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1344" target="_blank">00:22:24.760</a></span> | <span class="t">Into one token by taking the average value across each dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1349" target="_blank">00:22:29.260</a></span> | <span class="t">And that that's all we that's all we do there. So that's why we have this bert layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1355" target="_blank">00:22:35.320</a></span> | <span class="t">Followed by a pooling layer. I was just taking the mean pooling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1359" target="_blank">00:22:39.880</a></span> | <span class="t">And then we combine both of those into a single sentence transformer object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1365" target="_blank">00:22:45.160</a></span> | <span class="t">And that's our that's our sentence transformer initialized, but obviously we need to train it. So we come down here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1374" target="_blank">00:22:54.120</a></span> | <span class="t">To train it on the data. We have at the moment we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1376" target="_blank">00:22:56.760</a></span> | <span class="t">Continuous values in our labels from zero to one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1380" target="_blank">00:23:00.920</a></span> | <span class="t">So what we can use is the cosine similarity loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1384" target="_blank">00:23:04.440</a></span> | <span class="t">So we initialize that and then again, we don't want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1389" target="_blank">00:23:09.640</a></span> | <span class="t">Overfit so epochs is set to one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1393" target="_blank">00:23:13.000</a></span> | <span class="t">And this time we're using a lower number of warmup steps, which is 10 this time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1398" target="_blank">00:23:18.680</a></span> | <span class="t">and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1400" target="_blank">00:23:20.200</a></span> | <span class="t">We train with that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1402" target="_blank">00:23:22.760</a></span> | <span class="t">So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1404" target="_blank">00:23:24.760</a></span> | <span class="t">Once that is done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1406" target="_blank">00:23:26.840</a></span> | <span class="t">We are completely ready to train and we just call model fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1411" target="_blank">00:23:31.080</a></span> | <span class="t">So train objectives is slightly different to what we saw the cross encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1415" target="_blank">00:23:35.720</a></span> | <span class="t">Bit method, but everything else is the same. We're just using the default value here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1421" target="_blank">00:23:41.000</a></span> | <span class="t">So two e to minus five, so you don't really need to remove that if you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1424" target="_blank">00:23:44.520</a></span> | <span class="t">but if you do want to change that I put that in so you can see where you would change that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1431" target="_blank">00:23:51.640</a></span> | <span class="t">And yeah, we're ready to train we go ahead and train and see how that performs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1437" target="_blank">00:23:57.560</a></span> | <span class="t">so we evaluate it this time we're not using cross encoder, so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1442" target="_blank">00:24:02.920</a></span> | <span class="t">The evaluator is slightly different this time using a embedding similarity evaluator, which is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1449" target="_blank">00:24:09.480</a></span> | <span class="t">Take two sentence vectors and it's going to calculate the similarity between them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1455" target="_blank">00:24:15.560</a></span> | <span class="t">and then it's going to compare that to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1459" target="_blank">00:24:19.160</a></span> | <span class="t">That predicted similarity to the true similarity as per our validation set here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1465" target="_blank">00:24:25.320</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1467" target="_blank">00:24:27.480</a></span> | <span class="t">In that validation set we we do have these labels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1471" target="_blank">00:24:31.400</a></span> | <span class="t">But in stsb those labels are from the or in the range zero to five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1476" target="_blank">00:24:36.120</a></span> | <span class="t">so we use this lambda function to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1479" target="_blank">00:24:39.640</a></span> | <span class="t">Divide everything by five which brings us into a range of zero to one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1484" target="_blank">00:24:44.040</a></span> | <span class="t">Which is what we need for this embedding similarity evaluator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1488" target="_blank">00:24:48.840</a></span> | <span class="t">And then as we did before we're creating that list of input examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1493" target="_blank">00:24:53.340</a></span> | <span class="t">and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1495" target="_blank">00:24:55.400</a></span> | <span class="t">Then we can initialize the evaluator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1497" target="_blank">00:24:57.880</a></span> | <span class="t">So we're using the embedding similarity evaluator from input examples again because we have input examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1503" target="_blank">00:25:03.660</a></span> | <span class="t">and we're passing in our input examples data and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1508" target="_blank">00:25:08.040</a></span> | <span class="t">Right csv is false. That just means I will print the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1512" target="_blank">00:25:12.200</a></span> | <span class="t">score to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1516" target="_blank">00:25:16.280</a></span> | <span class="t">To our notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1517" target="_blank">00:25:17.960</a></span> | <span class="t">and then to actually evaluate all we do is pass the model to our evaluator and it will do everything of course and we get a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1525" target="_blank">00:25:25.880</a></span> | <span class="t">similarity here or a correlation score of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1531" target="_blank">00:25:31.720</a></span> | <span class="t">0.76 which is is pretty good. Um, you would you would think of you can think of something like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1542" target="_blank">00:25:42.600</a></span> | <span class="t">0.5 is kind of like your moderate correlation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1546" target="_blank">00:25:46.620</a></span> | <span class="t">And 0.8 is like high correlation so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1554" target="_blank">00:25:54.760</a></span> | <span class="t">Pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1557" target="_blank">00:25:57.160</a></span> | <span class="t">Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1558" target="_blank">00:25:58.440</a></span> | <span class="t">And if we for the final quick part, I just want to have a look at the other performances that I found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1565" target="_blank">00:26:05.000</a></span> | <span class="t">Because not everything is going to be as good as that what we just got there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1570" target="_blank">00:26:10.120</a></span> | <span class="t">So we can see so this is what we just did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1572" target="_blank">00:26:12.760</a></span> | <span class="t">Over here. We got 76 just now. So we got slightly higher than what I got before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1579" target="_blank">00:26:19.560</a></span> | <span class="t">So we got 76 here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1582" target="_blank">00:26:22.680</a></span> | <span class="t">um, but obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1584" target="_blank">00:26:24.920</a></span> | <span class="t">like I said stsb is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1587" target="_blank">00:26:27.080</a></span> | <span class="t">an easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1589" target="_blank">00:26:29.480</a></span> | <span class="t">Data set to get good results on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1591" target="_blank">00:26:31.480</a></span> | <span class="t">And the others are more difficult. So the rest of them are you're more in this moderate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1598" target="_blank">00:26:38.660</a></span> | <span class="t">um similarity range or correlation range, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1601" target="_blank">00:26:41.780</a></span> | <span class="t">The medical question pair states actually perform better with the bi encoder training than the cross encoder training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1609" target="_blank">00:26:49.540</a></span> | <span class="t">but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1611" target="_blank">00:26:51.220</a></span> | <span class="t">Nonetheless, they're still within the same sort of range</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1613" target="_blank">00:26:53.620</a></span> | <span class="t">That I would expect it's not it's not a massive improvement. It's this is a benchmark down here and there are a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1621" target="_blank">00:27:01.300</a></span> | <span class="t">percentage points better which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1624" target="_blank">00:27:04.500</a></span> | <span class="t">Is is probably reasonable particularly because they were not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1628" target="_blank">00:27:08.340</a></span> | <span class="t">These blue data sets were not that similar to our medical question pairs data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1634" target="_blank">00:27:14.660</a></span> | <span class="t">So that that makes sense and then the other ones. Yeah, they're all sort of within that moderate range</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1642" target="_blank">00:27:22.020</a></span> | <span class="t">Um the one that that's which did surprise me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1645" target="_blank">00:27:25.540</a></span> | <span class="t">Although it does make sense. I mean the question pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1648" target="_blank">00:27:28.980</a></span> | <span class="t">um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1650" target="_blank">00:27:30.980</a></span> | <span class="t">is this one here, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1653" target="_blank">00:27:33.380</a></span> | <span class="t">The the transfer from from medical question pairs to quora question pairs was pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1659" target="_blank">00:27:39.540</a></span> | <span class="t">and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1661" target="_blank">00:27:41.060</a></span> | <span class="t">I suppose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1662" target="_blank">00:27:42.340</a></span> | <span class="t">If you have a look at here we from core question pairs and medical question pairs. It's not as good and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1667" target="_blank">00:27:47.380</a></span> | <span class="t">Maybe because the language in core question pairs is simpler than the medical question pairs. I'm not sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1673" target="_blank">00:27:53.700</a></span> | <span class="t">But from medical question pairs to core question pairs. It worked quite well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1679" target="_blank">00:27:59.300</a></span> | <span class="t">So that I suppose points out where that n-gram similarity doesn't always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1684" target="_blank">00:28:04.660</a></span> | <span class="t">Correlate exactly to what you would expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1687" target="_blank">00:28:07.860</a></span> | <span class="t">But anyway, I think the results from this are probably pretty typical from what you can expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1694" target="_blank">00:28:14.660</a></span> | <span class="t">now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1696" target="_blank">00:28:16.900</a></span> | <span class="t">I think this can be really useful if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1699" target="_blank">00:28:19.780</a></span> | <span class="t">If you really don't have any any label data within your target domain to at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1708" target="_blank">00:28:28.180</a></span> | <span class="t">Squeeze out a few percentage points of performance more than you would be able to without</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1713" target="_blank">00:28:33.700</a></span> | <span class="t">this training strategy, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1716" target="_blank">00:28:36.500</a></span> | <span class="t">For that reason, I think this can be quite useful. Um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1720" target="_blank">00:28:40.420</a></span> | <span class="t">Whether or not it is the best approach to take will depend on your on your data. Um,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1727" target="_blank">00:28:47.540</a></span> | <span class="t">So I think it's useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1730" target="_blank">00:28:50.180</a></span> | <span class="t">Not always the best option</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1732" target="_blank">00:28:52.500</a></span> | <span class="t">But definitely something useful to know about and be able to apply if you need it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1738" target="_blank">00:28:58.420</a></span> | <span class="t">So yeah, that's it. Um, thank you very much for watching. I hope it's been useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=a8jyue22SJM&t=1745" target="_blank">00:29:05.380</a></span> | <span class="t">And I will see you again in the next one</span></div></div></body></html>