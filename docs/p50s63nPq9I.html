<html><head><title>Lesson 4 - Deep Learning for Coders (2020)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 4 - Deep Learning for Coders (2020)</h2><a href="https://www.youtube.com/watch?v=p50s63nPq9I"><img src="https://i.ytimg.com/vi_webp/p50s63nPq9I/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=0">0:0</a> Review of Lesson 3 + SGD<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=189">3:9</a> MNIST Loss Function<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=356">5:56</a> What is a Dataset in PyTorch?<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=467">7:47</a> Initializing our parameters<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=651">10:51</a> Predicting images with matrix multiplication<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=867">14:27</a> Why you shouldn't use accuracy loss function to update parameters<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1120">18:40</a> Creating a good loss function<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1632">27:12</a> Updating parameters with mini-batches and DataLoader<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1998">33:18</a> Putting it all together<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2610">43:30</a> Refactoring and Creating an optimizer<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2930">48:50</a> The DataLoaders class<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2972">49:32</a> The Learner class<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3069">51:9</a> Adding a non-linearity to create a neural network<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3713">61:53</a> Looking at what the NN is learning by looking at the parameters<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3929">65:29</a> Comparing the results with the fastai toolkit<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3979">66:19</a> Jargon review<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4110">68:30</a> Is there a rule of thumb for which non-linearity to choose?<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4183">69:43</a> Pet breeds image classification<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4630">77:10</a> Presizing<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4971">82:51</a> Checking and debugging a DataBlock<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5080">84:40</a> Presizing (question)<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5145">85:45</a> Training model to clean your data<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5206">86:46</a> How fastai chooses a loss function<br><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6709">111:49</a> Data Ethics and Efficacy of Masks for COVID-19<br><br><div style="text-align: left;"><a href="./p50s63nPq9I.html">Whisper Transcript</a> | <a href="./transcript_p50s63nPq9I.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Welcome back. And here is lesson 4, which is where we get deep into the weeds of exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=12" target="_blank">00:00:12.320</a></span> | <span class="t">what is going on when we are training a neural network. And we started looking at this in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=18" target="_blank">00:00:18.280</a></span> | <span class="t">the previous lesson, we were looking at spicastic gradient descent. And so to remind you, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=25" target="_blank">00:00:25.200</a></span> | <span class="t">were looking at what Arthur Samuel said. Suppose we arrange for some automatic means of testing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=31" target="_blank">00:00:31.600</a></span> | <span class="t">the effectiveness of any current weight assignment, or we would call it parameter assignment in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=37" target="_blank">00:00:37.760</a></span> | <span class="t">terms of actual performance and provide a mechanism for altering the weight assignment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=42" target="_blank">00:00:42.880</a></span> | <span class="t">so as to maximize that performance. So we could make that entirely automatic and a machine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=48" target="_blank">00:00:48.600</a></span> | <span class="t">so programmed would learn from its experience. And that was our goal. So our initial attempt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=56" target="_blank">00:00:56.360</a></span> | <span class="t">on the MNIST data set was not really based on that. We didn't really have any parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=63" target="_blank">00:01:03.940</a></span> | <span class="t">So then last week we tried to figure out how we could parameterize it, how we could create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=70" target="_blank">00:01:10.000</a></span> | <span class="t">a function that had parameters. And what we thought we could do would be to have something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=75" target="_blank">00:01:15.720</a></span> | <span class="t">where say the probability of being some particular number was expressed in terms of the pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=81" target="_blank">00:01:21.640</a></span> | <span class="t">of that number and some weights, and then we would just multiply them together and add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=88" target="_blank">00:01:28.520</a></span> | <span class="t">them up. So we looked at how stochastic gradient descent worked last week. And the basic idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=100" target="_blank">00:01:40.740</a></span> | <span class="t">is that we start out by initializing the parameters randomly. We use them to make a prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=109" target="_blank">00:01:49.240</a></span> | <span class="t">using a function such as this one. We then see how good that prediction is by measuring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=118" target="_blank">00:01:58.040</a></span> | <span class="t">using a loss function. We then calculate the gradient which is how much would the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=123" target="_blank">00:02:03.320</a></span> | <span class="t">change if I changed one parameter by a little bit. We then use that to make a small step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=131" target="_blank">00:02:11.320</a></span> | <span class="t">to change each of the parameters by a little bit by multiplying the learning rate by the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=136" target="_blank">00:02:16.560</a></span> | <span class="t">gradient to get a new set of predictions. And so we went round and round and round a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=140" target="_blank">00:02:20.520</a></span> | <span class="t">few times until eventually we decided to stop. And so these are the basic seven steps that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=150" target="_blank">00:02:30.440</a></span> | <span class="t">we went through. And so we did that for simple quadratic equation. And we had something which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=160" target="_blank">00:02:40.080</a></span> | <span class="t">looked like this. And so by the end, we had this nice sample of a curve getting closer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=169" target="_blank">00:02:49.080</a></span> | <span class="t">and closer and closer. So I have a little summary at the start of this section, summarizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=179" target="_blank">00:02:59.920</a></span> | <span class="t">gradient descent that Silva and I have in the notebooks in the book of what we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=184" target="_blank">00:03:04.960</a></span> | <span class="t">did. So you can review that and make sure it makes sense to you. So now let's use this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=192" target="_blank">00:03:12.140</a></span> | <span class="t">to create our MNIST threes versus sevens model. And so to create a model, we're going to need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=200" target="_blank">00:03:20.720</a></span> | <span class="t">to create something that we can pass into a function like, let's see where it was, passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=209" target="_blank">00:03:29.520</a></span> | <span class="t">to a function like this one. So we need just some pixels that are all lined up and some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=214" target="_blank">00:03:34.960</a></span> | <span class="t">parameters that are all lined up. And then we're going to sum them up. So our X's are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=224" target="_blank">00:03:44.000</a></span> | <span class="t">going to be pixels. And so in this case, because we're just going to multiply each pixel by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=228" target="_blank">00:03:48.800</a></span> | <span class="t">a parameter and add them up, the fact that they're laid out in a grid is not important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=234" target="_blank">00:03:54.500</a></span> | <span class="t">So let's reshape those grids and turn them into vectors. The way we reshape things in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=242" target="_blank">00:04:02.960</a></span> | <span class="t">PyTorch is by using the View method. And so the View method, you can pass to it how large</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=250" target="_blank">00:04:10.500</a></span> | <span class="t">you want each dimension to be. And so in this case, we want the number of columns to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=258" target="_blank">00:04:18.520</a></span> | <span class="t">equal to the total number of pixels in each picture, which is 28 times 28, because they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=264" target="_blank">00:04:24.760</a></span> | <span class="t">28 by 28 images. And then the number of rows will be however many rows there are in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=269" target="_blank">00:04:29.840</a></span> | <span class="t">data. And so if you just use minus one, when you call View, that means, you know, as many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=276" target="_blank">00:04:36.480</a></span> | <span class="t">as there are in the data. So this will create something of the same with the same total</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=280" target="_blank">00:04:40.560</a></span> | <span class="t">number of elements that we had before. So we can grab all our threes. We can concatenate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=287" target="_blank">00:04:47.000</a></span> | <span class="t">them, torch.cat, with all of our 7s, and then reshape that into a matrix where each row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=295" target="_blank">00:04:55.840</a></span> | <span class="t">is one image with all of the rows and columns of the image all lined up in a single vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=302" target="_blank">00:05:02.480</a></span> | <span class="t">So then we're going to need labels. So that's our x. So we're going to need labels. Our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=307" target="_blank">00:05:07.480</a></span> | <span class="t">labels will be a 1 for each of the threes and a 0 for each of the 7s. So basically we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=315" target="_blank">00:05:15.280</a></span> | <span class="t">going to create an is3 model. So that's going to create a vector. We actually need it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=324" target="_blank">00:05:24.960</a></span> | <span class="t">be a matrix in PyTorch. So unsqueeze will add an additional unit dimension to wherever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=336" target="_blank">00:05:36.880</a></span> | <span class="t">I've asked for. So here in position 1. So in other words, this is going to turn it from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=341" target="_blank">00:05:41.140</a></span> | <span class="t">something which is a vector of 12,396 long into a matrix with 12,396 rows and one column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=352" target="_blank">00:05:52.960</a></span> | <span class="t">That's just what PyTorch expects to see. So now we're going to turn our x and y into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=360" target="_blank">00:06:00.280</a></span> | <span class="t">data set. And a data set is a very specific concept in PyTorch. It's something which we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=367" target="_blank">00:06:07.480</a></span> | <span class="t">can index into using square brackets. And when we do so, it's expected to return a tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=377" target="_blank">00:06:17.980</a></span> | <span class="t">So here if we look at, we're going to create this data set. And when we index into it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=388" target="_blank">00:06:28.160</a></span> | <span class="t">it's going to return a tuple containing our independent variable and our dependent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=394" target="_blank">00:06:34.160</a></span> | <span class="t">for each particular row. And so to do that, we can use the Python zip function, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=401" target="_blank">00:06:41.860</a></span> | <span class="t">takes one element of the first thing and combines it with, concatenates it with one element</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=408" target="_blank">00:06:48.680</a></span> | <span class="t">of the second thing. And then it does that again and again and again. And so then if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=412" target="_blank">00:06:52.880</a></span> | <span class="t">we create a list of those, it gives us a data set. It gives us a list, which when we index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=420" target="_blank">00:07:00.280</a></span> | <span class="t">into it, it's going to contain one image and one label. And so here you can see why there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=427" target="_blank">00:07:07.440</a></span> | <span class="t">my label and my image. I won't print out the whole thing, but it's a 784 long vector. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=435" target="_blank">00:07:15.240</a></span> | <span class="t">that's a really important concept. A data set is something that you can index into and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=440" target="_blank">00:07:20.100</a></span> | <span class="t">get back a tuple. And here I am, this is called destructuring the tuple, which means I'm taking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=446" target="_blank">00:07:26.960</a></span> | <span class="t">the two parts of the tuple and putting the first part in one variable and the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=450" target="_blank">00:07:30.980</a></span> | <span class="t">part in the other variable, which is something we do a lot in Python. It's pretty handy. A</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=455" target="_blank">00:07:35.160</a></span> | <span class="t">lot of other languages support that as well. Repeat the same three steps for a validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=460" target="_blank">00:07:40.600</a></span> | <span class="t">set. So we've now got a training data set and a validation data set. Right. So now we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=469" target="_blank">00:07:49.220</a></span> | <span class="t">need to initialize our parameters. And so to do that, as we've discussed, we just do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=476" target="_blank">00:07:56.080</a></span> | <span class="t">it randomly. So here's a function that, given some size, some shape if you like, will randomly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=485" target="_blank">00:08:05.200</a></span> | <span class="t">initialize using a normal random number distribution in PyTorch. That's what randin does. And we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=493" target="_blank">00:08:13.160</a></span> | <span class="t">can hit Shift + Tab to see how that works. Okay. And it says here that it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=505" target="_blank">00:08:25.120</a></span> | <span class="t">have a variance of 1. So I probably shouldn't have called this standard deviation. I probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=509" target="_blank">00:08:29.640</a></span> | <span class="t">should call this variance actually. So multiply it by the variance to change its variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=515" target="_blank">00:08:35.400</a></span> | <span class="t">to whatever is requested, which will default to 1. And then as we talked about when it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=521" target="_blank">00:08:41.400</a></span> | <span class="t">comes to calculating our gradients, we have to tell PyTorch which things we want gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=528" target="_blank">00:08:48.000</a></span> | <span class="t">for. And the way we do that is requires grad underscore. Remember this underscore at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=533" target="_blank">00:08:53.240</a></span> | <span class="t">end is a special magic symbol, which tells PyTorch that we want this function to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=539" target="_blank">00:08:59.320</a></span> | <span class="t">change the thing that it's referring to. So this will change this tensor such that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=548" target="_blank">00:09:08.400</a></span> | <span class="t">requires gradients. So here's some weights. So our weights are going to need to be 28</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=555" target="_blank">00:09:15.400</a></span> | <span class="t">by 28 by 1 shape, 28 by 28 because every pixel is going to need a weight. And then 1 because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=564" target="_blank">00:09:24.400</a></span> | <span class="t">we're going to need again, we're going to need to have that unit access to make it into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=569" target="_blank">00:09:29.680</a></span> | <span class="t">a column. So that's what PyTorch expects. So there's our weights. Now just weights by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=580" target="_blank">00:09:40.380</a></span> | <span class="t">pixels actually isn't going to be enough because weights by pixels will always equal 0 when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=585" target="_blank">00:09:45.960</a></span> | <span class="t">the pixels are equal to 0. It has a 0 intercept. So we really want something which like wx</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=590" target="_blank">00:09:50.880</a></span> | <span class="t">plus b, a line. So the b is we call the bias. And so that's just going to be a single number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=598" target="_blank">00:09:58.640</a></span> | <span class="t">So let's grab a single number for our bias. So remember I told you there's a difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=604" target="_blank">00:10:04.880</a></span> | <span class="t">between the parameters and weights, so actually speaking. So here the weights are the w in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=611" target="_blank">00:10:11.560</a></span> | <span class="t">this equation, the bias is b in this equation, and the weights and bias together is the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=620" target="_blank">00:10:20.440</a></span> | <span class="t">of the function. They're all the things that we're going to change. They're all the things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=623" target="_blank">00:10:23.320</a></span> | <span class="t">that have gradients that we're going to update. So there's an important bit of jargon for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=628" target="_blank">00:10:28.360</a></span> | <span class="t">you. The weights and biases of the model are the parameters. So we can, yes question. What's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=639" target="_blank">00:10:39.600</a></span> | <span class="t">the difference between gradient descent and stochastic gradient descent? So far we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=646" target="_blank">00:10:46.360</a></span> | <span class="t">only done gradient descent. We'll be doing stochastic gradient descent in a few minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=651" target="_blank">00:10:51.160</a></span> | <span class="t">So we can now create a calculated prediction for one image. So we can take an image such</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=656" target="_blank">00:10:56.500</a></span> | <span class="t">as the first one and multiply by the weights. We need to transpose them to make them line</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=661" target="_blank">00:11:01.980</a></span> | <span class="t">up in terms of the rows and columns and add it up and add the bias and there is a prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=671" target="_blank">00:11:11.480</a></span> | <span class="t">We want to do that for every image. We could do that with a for loop and that would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=677" target="_blank">00:11:17.040</a></span> | <span class="t">really, really slow. It wouldn't run on the GPU and it wouldn't run in optimized C code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=684" target="_blank">00:11:24.120</a></span> | <span class="t">So we actually want to use always to do kind of like looping over pixels looping over images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=690" target="_blank">00:11:30.640</a></span> | <span class="t">You always need to try to make sure you're doing that without a Python or loop. In this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=695" target="_blank">00:11:35.480</a></span> | <span class="t">case doing this calculation for lots of rows and columns is a mathematical operation called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=703" target="_blank">00:11:43.200</a></span> | <span class="t">matrix model play. So if you've forgotten your matrix multiplication or maybe never</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=709" target="_blank">00:11:49.960</a></span> | <span class="t">quite got around to it at high school. It would be a good idea to have a look at Khan</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=715" target="_blank">00:11:55.160</a></span> | <span class="t">Academy or something to learn about what it is, but it's actually, I'll give you the quick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=720" target="_blank">00:12:00.880</a></span> | <span class="t">answer. This is from Wikipedia. If these are two matrices A and B, then this element here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=728" target="_blank">00:12:08.960</a></span> | <span class="t">1, 2 in the output is going to be equal to the first bit here times the first bit here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=736" target="_blank">00:12:16.840</a></span> | <span class="t">plus the second bit here times the second bit here. So it's going to be B12 times A11</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=743" target="_blank">00:12:23.320</a></span> | <span class="t">plus B22 times A12. That's, you can see the orange matches the orange. Ditto for over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=751" target="_blank">00:12:31.520</a></span> | <span class="t">here. This would be equal to B13 times A31 plus B23 times A32 and so forth for every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=758" target="_blank">00:12:38.760</a></span> | <span class="t">part. Here's a great picture of that in action. If you look at matrix multiplication.xyz, another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=774" target="_blank">00:12:54.480</a></span> | <span class="t">way to think of it is we can kind of flip the second bit over on top and then multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=780" target="_blank">00:13:00.640</a></span> | <span class="t">each bit together and add them up, multiply each bit together and add them up. And you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=785" target="_blank">00:13:05.560</a></span> | <span class="t">can see always the second one here and ends up in the second spot and the first one ends</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=789" target="_blank">00:13:09.320</a></span> | <span class="t">up in the first spot. And that's what matrix multiplication is. So we can do our multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=802" target="_blank">00:13:22.920</a></span> | <span class="t">and add up by using matrix multiplication. And in Python and therefore PyTorch matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=810" target="_blank">00:13:30.240</a></span> | <span class="t">multiplication is the @ sign operator. So when you see @ that means matrix multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=818" target="_blank">00:13:38.100</a></span> | <span class="t">So here is our 20.2336. If I do a matrix multiply of our training set by our weights and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=830" target="_blank">00:13:50.800</a></span> | <span class="t">we add the bias and here is our 20.336 for the first one. And you can see though it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=836" target="_blank">00:13:56.040</a></span> | <span class="t">doing every single one. So that's really important is that matrix multiplication gives us an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=842" target="_blank">00:14:02.960</a></span> | <span class="t">optimized way to do these simple linear functions for as many kind of rows and columns as we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=848" target="_blank">00:14:08.800</a></span> | <span class="t">want. So this is one of the two fundamental equations of any neural network. Some rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=858" target="_blank">00:14:18.520</a></span> | <span class="t">of data, rows and columns of data, matrix multiply, some weights, add some bias. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=863" target="_blank">00:14:23.960</a></span> | <span class="t">the second one which we'll see in a moment is an activation function. So that is some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=871" target="_blank">00:14:31.700</a></span> | <span class="t">predictions from our randomly initialized model. So we can check how good our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=876" target="_blank">00:14:36.960</a></span> | <span class="t">is. And so to do that we can decide that anything greater than zero we will call a 3 and anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=886" target="_blank">00:14:46.280</a></span> | <span class="t">less than zero we will call a 7. So preds greater than zero tells us whether or not something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=894" target="_blank">00:14:54.280</a></span> | <span class="t">is predicted to be a 3 or not. Then turn that into a float. So rather than true and false</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=899" target="_blank">00:14:59.760</a></span> | <span class="t">make it 1 and 0 because that's what our training set contains. And then check whether our thresholded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=907" target="_blank">00:15:07.080</a></span> | <span class="t">predictions are equal to our training set. And this will return true every time a row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=915" target="_blank">00:15:15.200</a></span> | <span class="t">is correctly predicted and false otherwise. So if we take all those trues and falses and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=920" target="_blank">00:15:20.800</a></span> | <span class="t">turn them into floats so that'll be ones and zeros and then take their mean it's 0.49.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=926" target="_blank">00:15:26.720</a></span> | <span class="t">So not surprisingly our randomly initialized model is right about half the time at predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=931" target="_blank">00:15:31.480</a></span> | <span class="t">threes from sevens. I added one more method here which is .item. Without .item this would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=939" target="_blank">00:15:39.520</a></span> | <span class="t">return a tensor. It's a rank 0 tensor it has no rows it has no columns it just it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=946" target="_blank">00:15:46.160</a></span> | <span class="t">a number on its own. But I actually wanted to unwrap it to create a normal Python scalar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=952" target="_blank">00:15:52.360</a></span> | <span class="t">mainly just because I wanted to see the easily see the full set of decimal places. And the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=957" target="_blank">00:15:57.720</a></span> | <span class="t">reason for that is I want to show you how we're going to calculate the derivative on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=961" target="_blank">00:16:01.960</a></span> | <span class="t">the accuracy by changing a parameter by a tiny bit. So let's take one parameter which will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=969" target="_blank">00:16:09.680</a></span> | <span class="t">be weight 0 and multiply it by 1.0001. And so that's going to make it a little bit bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=979" target="_blank">00:16:19.160</a></span> | <span class="t">And then if I calculate how the accuracy changes based on the change in that weight that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=988" target="_blank">00:16:28.080</a></span> | <span class="t">be the gradient of the accuracy with respect to that parameter. So I can do that by calculating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=996" target="_blank">00:16:36.520</a></span> | <span class="t">my new set of predictions and then I can threshold them and then I can check whether they're equal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1000" target="_blank">00:16:40.400</a></span> | <span class="t">to the training set and then take the mean and I get back exactly the same number. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1009" target="_blank">00:16:49.080</a></span> | <span class="t">remember that gradient is equal to rise over run if you remember back to your calculus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1018" target="_blank">00:16:58.760</a></span> | <span class="t">or if you'd forgotten your calculus hopefully you've reviewed it on Khan Academy. So the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1025" target="_blank">00:17:05.000</a></span> | <span class="t">change in the y so y new minus y old which is 0.4912 etc minus 0.4912 etc which is 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1038" target="_blank">00:17:18.400</a></span> | <span class="t">divided by this change will give us 0. So at this point we have a problem our derivative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1046" target="_blank">00:17:26.480</a></span> | <span class="t">is 0 so we have 0 gradients which means our step will be 0 which means our prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1054" target="_blank">00:17:34.340</a></span> | <span class="t">will be unchanged. Okay so we have a problem and our problem is that our gradient is 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1065" target="_blank">00:17:45.720</a></span> | <span class="t">and with a gradient of 0 we can't take a step and we can't get better predictions. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1073" target="_blank">00:17:53.400</a></span> | <span class="t">intuitively speaking the reason that our gradient is 0 is because when we change a single pixel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1079" target="_blank">00:17:59.800</a></span> | <span class="t">by a tiny bit we might not ever in any way change an actual prediction to change from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1087" target="_blank">00:18:07.000</a></span> | <span class="t">a 3 predicting a 3 to a 7 or vice versa because we have this threshold. Okay and so in other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1097" target="_blank">00:18:17.800</a></span> | <span class="t">words our accuracy loss function here is very bumpy it's like flat step flat step flat step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1107" target="_blank">00:18:27.720</a></span> | <span class="t">so it's got this 0 gradient all over the place. So what we need to do is use something other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1115" target="_blank">00:18:35.280</a></span> | <span class="t">than accuracy as our loss function. So let's try and create a new function and what this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1126" target="_blank">00:18:46.040</a></span> | <span class="t">new function is going to do is it's going to give us a better value kind of in much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1134" target="_blank">00:18:54.240</a></span> | <span class="t">the same way that accuracy gives a better value. So this is the loss remember a small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1138" target="_blank">00:18:58.960</a></span> | <span class="t">loss is better so it'll give us a lower loss when the accuracy is better but it won't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1145" target="_blank">00:19:05.240</a></span> | <span class="t">a 0 gradient. So it means that a slightly better prediction needs to have a slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1154" target="_blank">00:19:14.160</a></span> | <span class="t">better loss. So let's have a look at an example let's say our targets our labels of like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1163" target="_blank">00:19:23.600</a></span> | <span class="t">is 3 oh there's just three rows three images here 1 0 1 okay and we've made some predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1172" target="_blank">00:19:32.020</a></span> | <span class="t">from a neural net and those predictions gave us 0.9 0.4 0.2. So now consider this loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1182" target="_blank">00:19:42.660</a></span> | <span class="t">a loss function we're going to use torch.where which is basically the same as this list comprehension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1189" target="_blank">00:19:49.080</a></span> | <span class="t">it's basically an if statement. So it's going to say for where target equals 1 we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1196" target="_blank">00:19:56.840</a></span> | <span class="t">to return 1 minus predictions so here target is 1 so it'll be 1 minus 0.9 and where target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1203" target="_blank">00:20:03.400</a></span> | <span class="t">is not 1 it'll just be predictions. So for these examples here the first one target equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1212" target="_blank">00:20:12.080</a></span> | <span class="t">1 will be 1 minus 0.9 which is 0.1 the next one is target equals 0 so it will be the prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1223" target="_blank">00:20:23.600</a></span> | <span class="t">just 0.4 and then for the third one it's a 1 for target so it'll be 1 minus prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1230" target="_blank">00:20:30.360</a></span> | <span class="t">which is 0.8 and so you can see here when the prediction is correct correct in other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1237" target="_blank">00:20:37.720</a></span> | <span class="t">words it's a number you know it's a high number when the target is 1 and a low number when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1243" target="_blank">00:20:43.320</a></span> | <span class="t">the target is 0 these numbers are going to be smaller. So the worst one is when we predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1250" target="_blank">00:20:50.040</a></span> | <span class="t">0.2 so we're pretty we really thought that was actually a 0 but it's actually a 1 so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1256" target="_blank">00:20:56.480</a></span> | <span class="t">we ended up with a 0.8 here because this is 1 minus prediction 1 minus 0.2 is 0.8. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1265" target="_blank">00:21:05.680</a></span> | <span class="t">we can then take the mean of all of these to calculate a loss. So if you think about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1272" target="_blank">00:21:12.400</a></span> | <span class="t">it this loss will be the smallest if the predictions are exactly right. So if we did predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1287" target="_blank">00:21:27.280</a></span> | <span class="t">is actually identical to the targets then this will be 0 0 0 okay or else if they were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1299" target="_blank">00:21:39.280</a></span> | <span class="t">exactly wrong let's say they were 1 minus then it's 1 1 1. So it's going to be the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1310" target="_blank">00:21:50.000</a></span> | <span class="t">will be better i.e. smaller when the predictions are closer to the targets and so here we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1319" target="_blank">00:21:59.240</a></span> | <span class="t">now take the mean and when we do we get here 0.433. So let's say we change this last bad</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1330" target="_blank">00:22:10.920</a></span> | <span class="t">one this inaccurate prediction from 0.2 to 0.8 and the loss gets better from 0.43 to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1341" target="_blank">00:22:21.200</a></span> | <span class="t">0.23. This is just this function is torch.where.mean. So this is actually pretty good this is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1348" target="_blank">00:22:28.760</a></span> | <span class="t">a loss function which pretty closely tracks accuracy whereas the accuracy is better the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1353" target="_blank">00:22:33.920</a></span> | <span class="t">loss will be smaller but also it doesn't have these zero gradients because every time we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1359" target="_blank">00:22:39.280</a></span> | <span class="t">change the prediction the loss changes because the prediction is literally part of the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1365" target="_blank">00:22:45.280</a></span> | <span class="t">that's pretty neat isn't it. One problem is this is only going to work well as long as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1371" target="_blank">00:22:51.080</a></span> | <span class="t">the predictions are between 0 and 1 otherwise this 1 minus prediction thing is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1375" target="_blank">00:22:55.440</a></span> | <span class="t">look a bit funny. So we should try and find a way to ensure that the predictions are always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1381" target="_blank">00:23:01.440</a></span> | <span class="t">between 0 and 1 and that's also going to just make a lot more intuitive sense because you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1387" target="_blank">00:23:07.080</a></span> | <span class="t">know we like to be able to kind of think of these as if they're like probabilities or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1390" target="_blank">00:23:10.540</a></span> | <span class="t">at least nicely scaled numbers. So we need some function that can take our numbers have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1400" target="_blank">00:23:20.120</a></span> | <span class="t">a look. It's something which can take these big numbers and turn them all into numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1407" target="_blank">00:23:27.680</a></span> | <span class="t">between 0 and 1 and it so happens that we have exactly the right function it's called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1416" target="_blank">00:23:36.200</a></span> | <span class="t">the sigmoid function. So the sigmoid function looks like this. If you pass in a really small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1422" target="_blank">00:23:42.080</a></span> | <span class="t">number you get a number very close to 0 if you pass in a big number you get a number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1427" target="_blank">00:23:47.000</a></span> | <span class="t">very close to 1 it never gets past 1 and it never goes smaller than 0 and then it's kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1434" target="_blank">00:23:54.400</a></span> | <span class="t">of like the smooth curve between and in the middle it looks a lot like the y = x line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1441" target="_blank">00:24:01.000</a></span> | <span class="t">This is the definition of the sigmoid function. It's 1 over 1 plus e to the minus x. What</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1451" target="_blank">00:24:11.120</a></span> | <span class="t">is x? x is just e to the power of something. So if we look at e it's just a number like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1464" target="_blank">00:24:24.960</a></span> | <span class="t">pi this is a simple it's just a number that has a particular value. So if we go e squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1474" target="_blank">00:24:34.120</a></span> | <span class="t">and we look at it's going to be a tensor, use pytorch, make it a float, there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1490" target="_blank">00:24:50.080</a></span> | <span class="t">You can see that these are the same number so that's what torch.exp means. Okay so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1500" target="_blank">00:25:00.640</a></span> | <span class="t">know for me when I see these kinds of interesting functions I don't worry too much about the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1506" target="_blank">00:25:06.560</a></span> | <span class="t">definition. What I care about is the shape. So you can have a play around with graphing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1512" target="_blank">00:25:12.240</a></span> | <span class="t">calculators or whatever to kind of see why it is that you end up with this shape from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1516" target="_blank">00:25:16.920</a></span> | <span class="t">this particular equation but for me I just never think about that. It never really matters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1524" target="_blank">00:25:24.760</a></span> | <span class="t">to me. What's important is this sigmoid shape which is what we want. It's something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1529" target="_blank">00:25:29.520</a></span> | <span class="t">squashes every number to be between 0 and 1. So we can change MNIST_LOST to be exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1539" target="_blank">00:25:39.040</a></span> | <span class="t">the same as it was before but first we can make everything into sigmoid first and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1545" target="_blank">00:25:45.920</a></span> | <span class="t">use torch.where. So that is a loss function that has all the properties we want. It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1552" target="_blank">00:25:52.840</a></span> | <span class="t">something which is going to be have not have any of those nasty 0 gradients and we've ensured</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1559" target="_blank">00:25:59.480</a></span> | <span class="t">that the input to the where is between 0 and 1. So the reason we did this is because our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1571" target="_blank">00:26:11.960</a></span> | <span class="t">accuracy was kind of what we really care about is a good accuracy. We can't use it to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1580" target="_blank">00:26:20.400</a></span> | <span class="t">our gradients just to create our step to improve our parameters. So we can change our accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1593" target="_blank">00:26:33.400</a></span> | <span class="t">to another function that is similar in terms of it it's better when the accuracy is better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1599" target="_blank">00:26:39.640</a></span> | <span class="t">but it also does not have these 0 gradients. And so you can see now where why we have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1604" target="_blank">00:26:44.940</a></span> | <span class="t">metric and a loss. The metric is the thing we actually care about. The loss is the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1610" target="_blank">00:26:50.280</a></span> | <span class="t">that's similar to what we care about that has a nicely behaved gradient. Sometimes the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1619" target="_blank">00:26:59.320</a></span> | <span class="t">you care about your metric does have a nicely defined gradient and you can use it directly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1623" target="_blank">00:27:03.520</a></span> | <span class="t">as a loss. For example, we often use mean squared error but for classification unfortunately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1630" target="_blank">00:27:10.560</a></span> | <span class="t">not. So we need to now use this to update the parameters. And so there's a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1642" target="_blank">00:27:22.160</a></span> | <span class="t">ways we could do this. One would be to loop through every image, calculate a prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1648" target="_blank">00:27:28.240</a></span> | <span class="t">for that image and then calculate a loss and then do a step and then step through the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1658" target="_blank">00:27:38.160</a></span> | <span class="t">and then do that again for the next image and the next image and the next image. That's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1662" target="_blank">00:27:42.440</a></span> | <span class="t">going to be really slow because we're doing a single step for a single image. So that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1669" target="_blank">00:27:49.600</a></span> | <span class="t">would mean an epoch would take quite a while. We could go much faster by doing every single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1675" target="_blank">00:27:55.680</a></span> | <span class="t">image in the dataset. So a big matrix multiplication, it can all be paralyzed on the GPU and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1683" target="_blank">00:28:03.480</a></span> | <span class="t">so then we can we could then do a step based on the gradients looking at the entire dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1692" target="_blank">00:28:12.960</a></span> | <span class="t">But now that's going to be like a lot of work to just update the weights once. And remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1699" target="_blank">00:28:19.960</a></span> | <span class="t">sometimes our datasets have millions or tens of millions of items. So that's probably a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1705" target="_blank">00:28:25.320</a></span> | <span class="t">bad idea too. So why not compromise? Let's grab a few data items at a time to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1713" target="_blank">00:28:33.680</a></span> | <span class="t">our loss and our step. If we grab a few data items at a time, those two data items are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1719" target="_blank">00:28:39.280</a></span> | <span class="t">called a mini-batch. And a mini-batch just means a few pieces of data. And so the size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1727" target="_blank">00:28:47.520</a></span> | <span class="t">of your mini-batch is called, not surprisingly, the batch size. So the bigger the batch size,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1733" target="_blank">00:28:53.000</a></span> | <span class="t">the closer you get to the full size of your dataset, the longer it's going to do take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1736" target="_blank">00:28:56.960</a></span> | <span class="t">to calculate a single set of losses, a single step. But the more accurate it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1744" target="_blank">00:29:04.360</a></span> | <span class="t">be, it's going to be like the gradients are going to be much closer to the true dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1749" target="_blank">00:29:09.440</a></span> | <span class="t">gradients. And then the smaller the batch size, the faster each step will be able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1754" target="_blank">00:29:14.600</a></span> | <span class="t">do, but those steps will represent a smaller number of items. And so they won't be such</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1759" target="_blank">00:29:19.920</a></span> | <span class="t">an accurate approximation of the real gradient of the whole dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1768" target="_blank">00:29:28.000</a></span> | <span class="t">Is there a reason the mean of the loss is calculated over, say, doing a median, since</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1772" target="_blank">00:29:32.680</a></span> | <span class="t">the median is less prone to getting influenced by outliers? In the example you gave, if the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1779" target="_blank">00:29:39.720</a></span> | <span class="t">third point, which was wrongly predicted as an outlier, then the derivative would push</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1784" target="_blank">00:29:44.840</a></span> | <span class="t">the function away while doing SGD, and a median could be better in that case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1790" target="_blank">00:29:50.680</a></span> | <span class="t">Honestly, I've never tried using a median. The problem with a median is it ends up really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1798" target="_blank">00:29:58.640</a></span> | <span class="t">only caring about one number, which is the number in the middle. So it could end up really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1805" target="_blank">00:30:05.680</a></span> | <span class="t">pretty much ignoring all of the things at each end. In fact, all it really cares about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1810" target="_blank">00:30:10.520</a></span> | <span class="t">is the order of things. So my guess is that you would end up with something that is only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1815" target="_blank">00:30:15.720</a></span> | <span class="t">good at predicting one thing in the middle, but I haven't tried it. It would be interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1822" target="_blank">00:30:22.280</a></span> | <span class="t">to see. Well, I guess the other thing that would happen with a median is you would have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1827" target="_blank">00:30:27.520</a></span> | <span class="t">a lot of zero gradients, I think, because it's picking the thing in the middle and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1832" target="_blank">00:30:32.200</a></span> | <span class="t">could, you know, change your values and the thing in the middle. Well, it wouldn't be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1837" target="_blank">00:30:37.760</a></span> | <span class="t">zero gradients, but bumpy gradients. I think in the middle would suddenly jump to being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1841" target="_blank">00:30:41.040</a></span> | <span class="t">a different item. So it might not behave very well. That's my guess. You should try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1850" target="_blank">00:30:50.200</a></span> | <span class="t">Okay. So how do we ask for a few items at a time? It turns out that PyTorch and FastAI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1859" target="_blank">00:30:59.840</a></span> | <span class="t">provide something to do that for you. You can pass in any data set to this class called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1867" target="_blank">00:31:07.320</a></span> | <span class="t">data loader and it will grab a few items from that data set at a time. You can ask for how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1873" target="_blank">00:31:13.200</a></span> | <span class="t">many by asking for a batch size. And then you can, as you can see, it will grab a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1880" target="_blank">00:31:20.720</a></span> | <span class="t">items at a time until it's grabbed all of them. So here I'm saying let's create a collection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1885" target="_blank">00:31:25.560</a></span> | <span class="t">that just contains all the numbers from 0 to 14. Let's pass that into a data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1891" target="_blank">00:31:31.200</a></span> | <span class="t">with a batch size of 5. And then that's going to be something, it's called an iterator in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1896" target="_blank">00:31:36.640</a></span> | <span class="t">Python. It's something that you can ask for one more thing from an iterator. If you pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1900" target="_blank">00:31:40.520</a></span> | <span class="t">an iterator to list in Python, it returns all of the things from the iterator. So here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1905" target="_blank">00:31:45.920</a></span> | <span class="t">are my three mini batches and you'll see here all the numbers from 0 to 15 appear. They</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1911" target="_blank">00:31:51.320</a></span> | <span class="t">appear in a random order and they appear five at a time. They appear in random order because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1915" target="_blank">00:31:55.880</a></span> | <span class="t">shuffle equals true. So normally in the training set we ask for things to be shuffled. So it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1921" target="_blank">00:32:01.640</a></span> | <span class="t">gives us a little bit more randomization. More randomization is good because it makes it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1927" target="_blank">00:32:07.040</a></span> | <span class="t">harder for it to kind of learn what the data set looks like. So that's what a data loader,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1934" target="_blank">00:32:14.160</a></span> | <span class="t">that's how a data loader is created. Now remember though that our data sets actually return tuples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1945" target="_blank">00:32:25.480</a></span> | <span class="t">And here I've just got single ints. So let's actually create a tuple. So if we enumerate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1950" target="_blank">00:32:30.640</a></span> | <span class="t">all the letters of English, then that means that returns 0a1b2c, etc. Let's make that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1958" target="_blank">00:32:38.360</a></span> | <span class="t">our data set. So if we pass that to a data loader with a batch size of 6, and as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1965" target="_blank">00:32:45.360</a></span> | <span class="t">can see it returns tuples containing 6 of the first things and the associated 6 of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1975" target="_blank">00:32:55.920</a></span> | <span class="t">second things. So this is like our independent variable and this is like our dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1983" target="_blank">00:33:03.760</a></span> | <span class="t">And so and then at the end, you know, the batch size won't necessarily exactly divide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1990" target="_blank">00:33:10.520</a></span> | <span class="t">nicely into the full size of the data set. You might end up with a smaller batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=1999" target="_blank">00:33:19.640</a></span> | <span class="t">So basically then we already have a data set, remember. And so we could pass it to a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2006" target="_blank">00:33:26.440</a></span> | <span class="t">loader and then we can basically say this, an iterator in Python is something that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2011" target="_blank">00:33:31.200</a></span> | <span class="t">can actually loop through. So when we say for in data loader, it's going to return a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2017" target="_blank">00:33:37.160</a></span> | <span class="t">tuple. We can de-structure it into the first bit and the second bit. And so that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2024" target="_blank">00:33:44.160</a></span> | <span class="t">to be our x and y. We can calculate our predictions, we can calculate our loss from the predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2030" target="_blank">00:33:50.000</a></span> | <span class="t">and the targets, we can ask it to calculate our gradients and then we can update our parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2037" target="_blank">00:33:57.800</a></span> | <span class="t">just like we did in our toy SGD example for the quadratic equation. So let's reinitialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2045" target="_blank">00:34:05.240</a></span> | <span class="t">our weights and bias with the same two lines of code before. Let's create the data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2050" target="_blank">00:34:10.120</a></span> | <span class="t">this time from our actual MNIST data set and create a nice big batch size. So we did plenty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2055" target="_blank">00:34:15.560</a></span> | <span class="t">of work each time. And just to take a look, let's just grab the first thing from the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2060" target="_blank">00:34:20.960</a></span> | <span class="t">loader. First is a fast AI function, which just grabs the first thing from an iterator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2066" target="_blank">00:34:26.720</a></span> | <span class="t">Just it's useful to look at, you know, kind of an arbitrary mini batch. So here is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2073" target="_blank">00:34:33.000</a></span> | <span class="t">shape. We're going to have the first mini batch is 256 rows of 784 long, that's 28 by 28.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2080" target="_blank">00:34:40.520</a></span> | <span class="t">So 256 flattened out images and 256 labels that are one long because that's just the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2088" target="_blank">00:34:48.160</a></span> | <span class="t">number zero or the number one, depending on whether it's a three or a seven. Do the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2093" target="_blank">00:34:53.400</a></span> | <span class="t">for the validation set. So here's our validation data loader. And so let's grab a batch here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2105" target="_blank">00:35:05.960</a></span> | <span class="t">testing, pass it into, well, why do we do that? We should, yeah, I guess, yeah, actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2118" target="_blank">00:35:18.560</a></span> | <span class="t">for our testing, I'm going to just manually grab the first four things just so that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2123" target="_blank">00:35:23.640</a></span> | <span class="t">can make sure everything lines up. So let's grab just the first four things. We'll call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2127" target="_blank">00:35:27.760</a></span> | <span class="t">that a batch. Pass it into that linear function we created earlier. Remember linear was just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2143" target="_blank">00:35:43.080</a></span> | <span class="t">batch at weights matrix, multiply plus bias. And so that's going to give us four results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2154" target="_blank">00:35:54.840</a></span> | <span class="t">That's a prediction for each of those four images. And so then we can calculate the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2160" target="_blank">00:36:00.760</a></span> | <span class="t">using that loss function we just used. And let's just grab the first four items of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2165" target="_blank">00:36:05.040</a></span> | <span class="t">training set and there's the loss. Okay. And so now we can calculate the gradients. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2172" target="_blank">00:36:12.960</a></span> | <span class="t">so the gradients are 784 by one. So in other words, it's a column where every weight as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2181" target="_blank">00:36:21.160</a></span> | <span class="t">a gradient, it's what's the change in loss for a small change in that parameter. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2188" target="_blank">00:36:28.760</a></span> | <span class="t">then the bias has a gradient that's a single number because the bias is just a single number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2194" target="_blank">00:36:34.880</a></span> | <span class="t">So, we can take those three steps and put it in a function. So if you pass, if you,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2202" target="_blank">00:36:42.320</a></span> | <span class="t">this is calculate gradient, you pass it an X batch or Y batch in some model, then it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2207" target="_blank">00:36:47.200</a></span> | <span class="t">going to calculate the predictions, calculate the loss and do the backward step. And here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2212" target="_blank">00:36:52.920</a></span> | <span class="t">we see calculate gradient. And so we can get the, just to take a look, the mean of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2217" target="_blank">00:36:57.960</a></span> | <span class="t">weights gradient and the bias gradient. And there it is. If I call it a second time and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2225" target="_blank">00:37:05.320</a></span> | <span class="t">look, notice I have not done any step here. This is exactly the same parameters. I get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2231" target="_blank">00:37:11.520</a></span> | <span class="t">a different value. That's a concern. You would expect to get the same gradient every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2237" target="_blank">00:37:17.840</a></span> | <span class="t">you called it with the same data. Why have the gradients changed? That's because loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2244" target="_blank">00:37:24.640</a></span> | <span class="t">dot backward does not just calculate the gradients. It calculates the gradients and adds them to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2252" target="_blank">00:37:32.000</a></span> | <span class="t">the existing gradients, the things in the dot grad attribute. The reasons for that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2259" target="_blank">00:37:39.280</a></span> | <span class="t">come to you later, but for now the thing to know is just it does that. So actually what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2264" target="_blank">00:37:44.120</a></span> | <span class="t">we need to do is to call grad dot zero underscore. So dot zero returns a tensor containing zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2273" target="_blank">00:37:53.440</a></span> | <span class="t">And remember underscore does it in place. So that updates the weights dot grad attribute,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2278" target="_blank">00:37:58.840</a></span> | <span class="t">which is a tensor to contain zeros. So now if I do that and call it again, I will get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2285" target="_blank">00:38:05.680</a></span> | <span class="t">exactly the same number. So here is how you train one epoch with SGD. Loop through the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2294" target="_blank">00:38:14.960</a></span> | <span class="t">data loader, grabbing the X batch and the Y batch, calculate the gradient, prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2301" target="_blank">00:38:21.440</a></span> | <span class="t">loss backward. Go through each of the parameters and we're going to be passing those in. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2308" target="_blank">00:38:28.760</a></span> | <span class="t">there's going to be the 768 weights and the one bias. And then for each of those, update</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2315" target="_blank">00:38:35.760</a></span> | <span class="t">the parameter to go minus equals gradient times learning rate. That's our gradient descent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2323" target="_blank">00:38:43.280</a></span> | <span class="t">step and then zero it out for the next time around the loop. I'm not just saying p minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2331" target="_blank">00:38:51.680</a></span> | <span class="t">equals. I'm saying p dot data minus equals. And the reason for that is that remember PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2338" target="_blank">00:38:58.920</a></span> | <span class="t">keeps track of all of the calculations we do so that it can calculate the gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2345" target="_blank">00:39:05.200</a></span> | <span class="t">Well I don't want to calculate in the gradient of my gradient descent step. That's like not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2350" target="_blank">00:39:10.760</a></span> | <span class="t">part of the model, right? So dot data is a special attribute in PyTorch where if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2356" target="_blank">00:39:16.720</a></span> | <span class="t">write to it, it tells PyTorch not to update the gradients using that calculation. So this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2365" target="_blank">00:39:25.120</a></span> | <span class="t">is your most basic standard SGD stochastic gradient descent loop. So now we can answer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2372" target="_blank">00:39:32.480</a></span> | <span class="t">that earlier question. The difference between stochastic gradient descent and gradient descent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2377" target="_blank">00:39:37.680</a></span> | <span class="t">is that gradient descent does not have this here that loops through each mini-batch. For</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2386" target="_blank">00:39:46.080</a></span> | <span class="t">gradient descent, it does it on the whole data set each time around. So train epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2391" target="_blank">00:39:51.720</a></span> | <span class="t">for gradient descent would simply not have the for loop at all, but instead it would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2397" target="_blank">00:39:57.760</a></span> | <span class="t">calculate the gradient for the whole data set and update the parameters based on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2401" target="_blank">00:40:01.960</a></span> | <span class="t">whole data set, which we never really do in practice. We always use mini-batches of various</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2407" target="_blank">00:40:07.920</a></span> | <span class="t">sizes. Okay, so we can take the function we had before where we compare the predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2421" target="_blank">00:40:21.800</a></span> | <span class="t">to whether that, well we used to be comparing the predictions to whether they were greater</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2426" target="_blank">00:40:26.160</a></span> | <span class="t">or less than zero, right? But now that we're doing the sigmoid, remember the sigmoid will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2431" target="_blank">00:40:31.400</a></span> | <span class="t">squish everything between 0 and 1. So now we should compare the predictions to whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2435" target="_blank">00:40:35.880</a></span> | <span class="t">they're greater than 0.5 or not. If they're greater than 0.5, just look back at our sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2441" target="_blank">00:40:41.040</a></span> | <span class="t">function. So 0, what used to be 0 is now on the sigmoid is 0.5. Okay, so we need just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2452" target="_blank">00:40:52.840</a></span> | <span class="t">to make that slight change to our measure of accuracy. So to calculate the accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2463" target="_blank">00:41:03.360</a></span> | <span class="t">for some X batch and some Y batch, this is actually assumed this is actually the predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2469" target="_blank">00:41:09.960</a></span> | <span class="t">Then we take the sigmoid of the predictions, we compare them to 0.5 to tell us whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2475" target="_blank">00:41:15.240</a></span> | <span class="t">it's a 3 or not, we check what the actual target was to see which ones are correct,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2480" target="_blank">00:41:20.640</a></span> | <span class="t">and then we take the mean of those after converting the Booleans to floats. So we can check that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2487" target="_blank">00:41:27.720</a></span> | <span class="t">Accuracy, let's take our batch, put it through our simple linear model, compare it to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2493" target="_blank">00:41:33.880</a></span> | <span class="t">four items of the training set, and there's the accuracy. So if we do that for every batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2501" target="_blank">00:41:41.120</a></span> | <span class="t">in the validation set, then we can loop through with a list comprehension every batch in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2506" target="_blank">00:41:46.800</a></span> | <span class="t">validation set, get the accuracy based on some model, stack those all up together so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2516" target="_blank">00:41:56.080</a></span> | <span class="t">that this is a list, right? So if we want to turn that list into a tensor where the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2521" target="_blank">00:42:01.000</a></span> | <span class="t">items of the list of the tensor are the items of the list, that's what stack does. So we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2526" target="_blank">00:42:06.600</a></span> | <span class="t">can stack up all those, take the mean, convert it to a standard Python scalar by calling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2534" target="_blank">00:42:14.160</a></span> | <span class="t">dot item, round it to four decimal places just for display. And so here is our validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2541" target="_blank">00:42:21.880</a></span> | <span class="t">set accuracy as you would expect. It's about 50% because it's random. So we can now train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2548" target="_blank">00:42:28.480</a></span> | <span class="t">for one epoch. So we can say, remember train epoch needed the parameters. So our parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2557" target="_blank">00:42:37.400</a></span> | <span class="t">in this case are the weights tensor and the bias tensor. So train one epoch using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2564" target="_blank">00:42:44.360</a></span> | <span class="t">linear one model with the learning rate of one with these two parameters and then validate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2572" target="_blank">00:42:52.460</a></span> | <span class="t">and look at that. Our accuracy is now 68.8%. So we've trained an epoch. So let's just repeat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2582" target="_blank">00:43:02.880</a></span> | <span class="t">that 20 times, train and validate. And you can see the accuracy goes up and up and up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2589" target="_blank">00:43:09.840</a></span> | <span class="t">and up and up to about 97%. So that's cool. We've built an SGD optimizer of a simple linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2601" target="_blank">00:43:21.120</a></span> | <span class="t">function that is getting about 97% on our simplified MNIST where there's just the threes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2608" target="_blank">00:43:28.360</a></span> | <span class="t">and the sevenths. So a lot of steps there. Let's simplify this through some refactoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2617" target="_blank">00:43:37.280</a></span> | <span class="t">So the kind of simple refactoring we're going to do, we're going to do a couple, but the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2620" target="_blank">00:43:40.800</a></span> | <span class="t">basic idea is we're going to create something called an optimizer class. The first thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2625" target="_blank">00:43:45.520</a></span> | <span class="t">we'll do is we'll get rid of the linear one function. Remember the linear one function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2633" target="_blank">00:43:53.480</a></span> | <span class="t">does x at w plus b. There's actually a class in PyTorch that does that equation for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2643" target="_blank">00:44:03.840</a></span> | <span class="t">So we might as well use it. It's called nn.linear. And nn.linear does two things. It does that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2651" target="_blank">00:44:11.440</a></span> | <span class="t">function for us and it also initializes the parameters for us. So we don't have to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2659" target="_blank">00:44:19.360</a></span> | <span class="t">writes and bias in it params anymore. We just create an nn.linear class and that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2667" target="_blank">00:44:27.280</a></span> | <span class="t">to create a matrix of size 28 by 28 comma 1 and a bias of size 1. It will set requires</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2675" target="_blank">00:44:35.680</a></span> | <span class="t">grad equals true for us. It's all going to be encapsulated in this class and then when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2680" target="_blank">00:44:40.240</a></span> | <span class="t">I call that as a function, it's going to do my x at w plus b. So to see the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2691" target="_blank">00:44:51.320</a></span> | <span class="t">in it, we would expect it to contain 784 weights and one bias. We can just call dot parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2698" target="_blank">00:44:58.800</a></span> | <span class="t">and we can de-structure it to w comma b and see, yep, it is 784 and 1 for the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2706" target="_blank">00:45:06.720</a></span> | <span class="t">and bias. So that's cool. So this is just, you know, it could be an interesting exercise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2712" target="_blank">00:45:12.760</a></span> | <span class="t">for you to create this class yourself from scratch. You should be able to at this point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2719" target="_blank">00:45:19.320</a></span> | <span class="t">so that you can confirm that you can recreate something that behaves exactly like an nn.linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2726" target="_blank">00:45:26.440</a></span> | <span class="t">So now that we've got this object which contains our parameters in a parameters method, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2733" target="_blank">00:45:33.760</a></span> | <span class="t">can now create an optimizer. So for our optimizer, we're going to pass it the parameters to optimize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2739" target="_blank">00:45:39.380</a></span> | <span class="t">and a learning rate. We'll store them away and we'll have something called step which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2745" target="_blank">00:45:45.600</a></span> | <span class="t">goes through each parameter and does that thing we just saw. p dot data minus equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2750" target="_blank">00:45:50.600</a></span> | <span class="t">p dot grad times learning rate and it's also going to have something called zero grad which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2755" target="_blank">00:45:55.760</a></span> | <span class="t">goes through each parameter and zeros it out or we could even just set it to none. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2761" target="_blank">00:46:01.920</a></span> | <span class="t">the thing we're going to call basic optimizer. So those are exactly the same lines of code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2766" target="_blank">00:46:06.320</a></span> | <span class="t">we've already seen wrapped up into a class. So we can now create an optimizer passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2771" target="_blank">00:46:11.940</a></span> | <span class="t">in the parameters of the linear model for these and our learning rate. And so now our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2778" target="_blank">00:46:18.400</a></span> | <span class="t">training loop is loop through each mini batch in the data loader, calculate the gradient,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2784" target="_blank">00:46:24.920</a></span> | <span class="t">opt dot step, opt dot zero grad, that's it. Validation function doesn't have to change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2795" target="_blank">00:46:35.640</a></span> | <span class="t">and so let's put our training loop into a function that's going to loop through a bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2798" target="_blank">00:46:38.640</a></span> | <span class="t">of epochs, call an epoch, print validate epoch and then run it and it's the same. We're getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2809" target="_blank">00:46:49.880</a></span> | <span class="t">a slightly different result here but much the same idea. Okay so that's cool right we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2819" target="_blank">00:46:59.880</a></span> | <span class="t">now refactoring using you know create our own optimizer and using faster pytorch is built</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2828" target="_blank">00:47:08.120</a></span> | <span class="t">in nn.linear class and you know by the way we don't actually need to use our own basic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2834" target="_blank">00:47:14.560</a></span> | <span class="t">optimizer. Not surprisingly pytorch comes with something which does exactly this and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2840" target="_blank">00:47:20.120</a></span> | <span class="t">not surprisingly it's called SGD. So and actually this SGD is provided by fastai, fastai and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2846" target="_blank">00:47:26.920</a></span> | <span class="t">pytorch provide some overlapping functionality they work much the same way. So you can pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2853" target="_blank">00:47:33.520</a></span> | <span class="t">to SGD your parameters and your learning rate just like basic optimizer. Okay and train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2860" target="_blank">00:47:40.800</a></span> | <span class="t">it and get the same result. So as you can see these classes that are in fastai and pytorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2869" target="_blank">00:47:49.120</a></span> | <span class="t">are not mysterious they're just pretty you know in wrappers around functionality that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2877" target="_blank">00:47:57.960</a></span> | <span class="t">we've now written ourself. So there's quite a few steps there and if you haven't done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2883" target="_blank">00:48:03.880</a></span> | <span class="t">gradient descent before then there's a lot of unpacking. So this lesson is kind of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2892" target="_blank">00:48:12.400</a></span> | <span class="t">key lesson it's the one where you know like we should you know really take a stop and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2897" target="_blank">00:48:17.720</a></span> | <span class="t">a deep breath at this point and make sure you're comfortable. What's a data set? What's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2903" target="_blank">00:48:23.520</a></span> | <span class="t">a data loader? What's nn.linear? What's SGD? And if you you know if any or all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2911" target="_blank">00:48:31.440</a></span> | <span class="t">don't make sense go back to where we defined it from scratch using Python code. Well the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2918" target="_blank">00:48:38.080</a></span> | <span class="t">data loader we didn't define from scratch but it you know the functionality is not particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2922" target="_blank">00:48:42.680</a></span> | <span class="t">interesting. You could certainly create your own from scratch if you wanted to that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2927" target="_blank">00:48:47.080</a></span> | <span class="t">be another pretty good exercise. Let's refactor some more. Fastai has a data loaders class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2938" target="_blank">00:48:58.720</a></span> | <span class="t">which is as we've mentioned before is a tiny class that just you pass it a bunch of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2945" target="_blank">00:49:05.120</a></span> | <span class="t">loaders and it just stores them away as a dot train and a dot valid. Even though it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2950" target="_blank">00:49:10.200</a></span> | <span class="t">a tiny class it's it's super handy because with that we now have a single object that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2956" target="_blank">00:49:16.800</a></span> | <span class="t">knows all the data we have and so it can make sure that your training data loader is shuffled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2962" target="_blank">00:49:22.800</a></span> | <span class="t">and your validation loader isn't shuffled you know make sure everything works properly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2968" target="_blank">00:49:28.020</a></span> | <span class="t">So that's what the data loaders class is you can pass in the training and valid data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2973" target="_blank">00:49:33.840</a></span> | <span class="t">and then the next thing we have in fastai is the learner class and the learner class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2978" target="_blank">00:49:38.520</a></span> | <span class="t">is something where we're going to pass in our data loaders. We're going to pass in our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2984" target="_blank">00:49:44.560</a></span> | <span class="t">model we're going to pass in our optimization function we're going to pass in our loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2991" target="_blank">00:49:51.880</a></span> | <span class="t">we're going to pass in our metrics. So all the stuff we've just done manually that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=2998" target="_blank">00:49:58.120</a></span> | <span class="t">all learner does is it's just going to do that for us so it's just going to call this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3004" target="_blank">00:50:04.320</a></span> | <span class="t">train model and this train epoch it's just you know it's inside learner. So now if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3011" target="_blank">00:50:11.120</a></span> | <span class="t">go learn.fit you can see again it's doing the same thing getting the same result and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3020" target="_blank">00:50:20.000</a></span> | <span class="t">it's got some nice functionality it's printing it out into a pretty table for us and it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3023" target="_blank">00:50:23.460</a></span> | <span class="t">showing us the losses and the accuracy and how long it takes but there's nothing magic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3028" target="_blank">00:50:28.480</a></span> | <span class="t">right you've been able to do exactly the same thing by hand using Python and PyTorch. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3037" target="_blank">00:50:37.080</a></span> | <span class="t">these abstractions are here to like let you write less code and to save some time and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3041" target="_blank">00:50:41.880</a></span> | <span class="t">to save some cognitive overhead but they're not doing anything you can't do yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3049" target="_blank">00:50:49.120</a></span> | <span class="t">And that's important right because if the if they're doing things you can't do yourself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3054" target="_blank">00:50:54.920</a></span> | <span class="t">then you can't customize them you can't debug them you know you can't profile them. So we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3062" target="_blank">00:51:02.400</a></span> | <span class="t">want to make sure that the stuff we're using is stuff that we understand what it's doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3069" target="_blank">00:51:09.380</a></span> | <span class="t">So this is just a linear function is not great we want a neural network. So how do we turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3078" target="_blank">00:51:18.520</a></span> | <span class="t">this into a neural network or remember this is a linear function x at w plus b to turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3087" target="_blank">00:51:27.320</a></span> | <span class="t">it into a neural network we have two linear functions exactly the same but with different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3094" target="_blank">00:51:34.160</a></span> | <span class="t">weights and different biases and in between this magic line of code which takes the result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3100" target="_blank">00:51:40.920</a></span> | <span class="t">of our first linear function and then does a max between that and 0. So a max of res</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3108" target="_blank">00:51:48.760</a></span> | <span class="t">and 0 is going to take any negative numbers and turn them into zeros. So we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3115" target="_blank">00:51:55.000</a></span> | <span class="t">do a linear function we're going to replace the negatives with 0 and then we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3119" target="_blank">00:51:59.960</a></span> | <span class="t">to take that and put it through another linear function that believe it or not is a neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3125" target="_blank">00:52:05.360</a></span> | <span class="t">net. So w1 and w2 are weight tensors b1 and b2 are bias tensors just like before so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3133" target="_blank">00:52:13.200</a></span> | <span class="t">can initialize them just like before and we could now call exactly the same training code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3139" target="_blank">00:52:19.720</a></span> | <span class="t">that we did before to roll these. So res.max 0 is called a rectified linear unit which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3152" target="_blank">00:52:32.880</a></span> | <span class="t">you will always see referred to as ReLU and so here is and in PyTorch it already has this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3162" target="_blank">00:52:42.140</a></span> | <span class="t">function it's called f.relu and so if we plot it you can see it's as you'd expect it's 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3169" target="_blank">00:52:49.480</a></span> | <span class="t">for all negative numbers and then it's y equals x for positive numbers. So you know here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3179" target="_blank">00:52:59.440</a></span> | <span class="t">some jargon rectified linear unit sounds scary sounds complicated but it's actually this incredibly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3186" target="_blank">00:53:06.720</a></span> | <span class="t">tiny line of code this incredibly simple function and this happens a lot in deep learning things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3194" target="_blank">00:53:14.080</a></span> | <span class="t">that sound complicated and sophisticated and impressive turn out to be normally super simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3201" target="_blank">00:53:21.080</a></span> | <span class="t">frankly at least once you know what it is. So why do we do linear layer ReLU linear layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3211" target="_blank">00:53:31.000</a></span> | <span class="t">well if we got rid of the middle if we got rid of the middle ReLU and just went linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3222" target="_blank">00:53:42.960</a></span> | <span class="t">layer linear layer then you could rewrite that as a single linear layer when you multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3229" target="_blank">00:53:49.560</a></span> | <span class="t">things and add and then multiply things and add and you can just change the coefficients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3234" target="_blank">00:53:54.440</a></span> | <span class="t">and make it into a single multiply and then add. So no matter how many linear layers we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3238" target="_blank">00:53:58.700</a></span> | <span class="t">stack on top of each other we can never make anything more kind of effective than a simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3245" target="_blank">00:54:05.760</a></span> | <span class="t">linear model but if you put a non-linearity between the linear layers then actually you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3253" target="_blank">00:54:13.120</a></span> | <span class="t">have the opposite this is now where something called the universal approximation theorem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3258" target="_blank">00:54:18.480</a></span> | <span class="t">holds which is that if the size of the weight and bias matrices are big enough this can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3264" target="_blank">00:54:24.720</a></span> | <span class="t">actually approximate any arbitrary function including the function of how do I recognize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3271" target="_blank">00:54:31.480</a></span> | <span class="t">threes from sevens or or whatever. So that's kind of amazing right this tiny thing is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3280" target="_blank">00:54:40.520</a></span> | <span class="t">a universal function approximator as long as you have w1 b1 w2 and b2 have the right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3288" target="_blank">00:54:48.360</a></span> | <span class="t">numbers and we know how to make them the right numbers you use SGD could take a very long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3293" target="_blank">00:54:53.840</a></span> | <span class="t">time could take a lot of memory but the basic idea is that there is some solution to any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3302" target="_blank">00:55:02.000</a></span> | <span class="t">computable problem and this is one of the biggest challenges a lot of beginners have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3309" target="_blank">00:55:09.840</a></span> | <span class="t">to deep learning is that there's nothing else to it like there's often this like okay how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3317" target="_blank">00:55:17.120</a></span> | <span class="t">do I make a neural net oh that is a neural net or how do I do deep learning training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3324" target="_blank">00:55:24.040</a></span> | <span class="t">where there's gd there's things to like make it train a bit faster there's you know things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3330" target="_blank">00:55:30.920</a></span> | <span class="t">to mean you need a few less parameters but everything from here is just performance tweaks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3341" target="_blank">00:55:41.640</a></span> | <span class="t">honestly right so this is you know this is the key understanding of training a neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3350" target="_blank">00:55:50.400</a></span> | <span class="t">network okay we can simplify things a bit more we already know that we can use nn.linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3359" target="_blank">00:55:59.960</a></span> | <span class="t">to replace the weight and bias so let's do that for both of the linear layers and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3368" target="_blank">00:56:08.760</a></span> | <span class="t">since we're simply taking the result of one function and passing it into the next and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3379" target="_blank">00:56:19.320</a></span> | <span class="t">take the result of that function pass it to the next and so forth and then return the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3382" target="_blank">00:56:22.840</a></span> | <span class="t">end this is called function composition function composition is when you just take the result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3388" target="_blank">00:56:28.440</a></span> | <span class="t">of one function pass it to a new one take a result of one function pass it to a new one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3393" target="_blank">00:56:33.560</a></span> | <span class="t">and so every pretty much neural network is just doing function composition of linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3399" target="_blank">00:56:39.820</a></span> | <span class="t">layers and these are called activation functions or non-linearities so PyTorch provides something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3407" target="_blank">00:56:47.360</a></span> | <span class="t">to do function composition for us and it's called nn.sequential so it's going to do a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3413" target="_blank">00:56:53.360</a></span> | <span class="t">linear layer pass the result to a value pass the result to a linear layer you'll see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3419" target="_blank">00:56:59.440</a></span> | <span class="t">I'm not using f.relu I'm using nn.relu this is identical returns exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3424" target="_blank">00:57:04.920</a></span> | <span class="t">but this is a class rather than a function yes Rachel by using the non-linearity won't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3435" target="_blank">00:57:15.440</a></span> | <span class="t">using a function that makes all negative output zero make many of the gradients in the network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3439" target="_blank">00:57:19.760</a></span> | <span class="t">zero and stop the learning process due to many zero gradients well that's a fantastic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3447" target="_blank">00:57:27.100</a></span> | <span class="t">question and the answer is yes it does but there won't be zero for every image and remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3455" target="_blank">00:57:35.920</a></span> | <span class="t">the mini batches are shuffled so even if it's zero for every image in one mini batch it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3461" target="_blank">00:57:41.760</a></span> | <span class="t">won't be for the next mini batch and it won't be the next time around we go for another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3465" target="_blank">00:57:45.120</a></span> | <span class="t">epoch so yes it can create zeros and if if the neural net ends up with a set of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3475" target="_blank">00:57:55.380</a></span> | <span class="t">such that lots and lots of inputs end up as zeros you can end up with whole mini batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3482" target="_blank">00:58:02.080</a></span> | <span class="t">that is zero and you can end up in a situation where some of the neurons remain inactive inactive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3494" target="_blank">00:58:14.280</a></span> | <span class="t">means they're zero and they're basically dead units and this is a huge problem it basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3501" target="_blank">00:58:21.960</a></span> | <span class="t">means you're wasting computation so there's a few tricks to avoid that which we'll be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3507" target="_blank">00:58:27.120</a></span> | <span class="t">learning about a lot one simple trick is to not make this thing flat here but just make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3514" target="_blank">00:58:34.680</a></span> | <span class="t">it a less steep line that's called a leaky value leaky rectified linear unit and they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3523" target="_blank">00:58:43.560</a></span> | <span class="t">help a bit as we'll learn though even better is to make sure that we just kind of initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3529" target="_blank">00:58:49.400</a></span> | <span class="t">to sensible initial values that are not too big and not too small and step by sensible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3535" target="_blank">00:58:55.440</a></span> | <span class="t">amounts that are particularly not too big and generally if we do that we can keep things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3541" target="_blank">00:59:01.360</a></span> | <span class="t">in the zone where they're positive most of the time but we are going to learn about how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3546" target="_blank">00:59:06.420</a></span> | <span class="t">to actually analyze inside a network and find out how many dead units we have how many of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3550" target="_blank">00:59:10.640</a></span> | <span class="t">these zeros we have because as this as you point out they are they are bad news they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3555" target="_blank">00:59:15.960</a></span> | <span class="t">don't do any work and they'll continue to not do any work if if enough of the inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3562" target="_blank">00:59:22.880</a></span> | <span class="t">end up being zero okay so now that we've got a neural net we can use exactly the same learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3575" target="_blank">00:59:35.240</a></span> | <span class="t">we had before but this time we'll pass in the simple net instead of the linear one everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3581" target="_blank">00:59:41.260</a></span> | <span class="t">else is the same and we can call fit just like before and generally as your models get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3588" target="_blank">00:59:48.040</a></span> | <span class="t">deeper though here we've gone from one layer to and I'm only counting the parameterized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3593" target="_blank">00:59:53.920</a></span> | <span class="t">layers as layers you could say it's three I'm just going to call it two there's two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3598" target="_blank">00:59:58.180</a></span> | <span class="t">trainable layers so I've gone from one layer to I've checked dropped my learning rate from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3603" target="_blank">01:00:03.080</a></span> | <span class="t">one to zero point one because the deeper models you know tend to be kind of bumpier less nicely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3610" target="_blank">01:00:10.120</a></span> | <span class="t">behaved so often you need to use lower learning rates and so we train it for a while okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3616" target="_blank">01:00:16.360</a></span> | <span class="t">and we can actually find out what that training looks like by looking inside our learner and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3624" target="_blank">01:00:24.000</a></span> | <span class="t">there's an attribute we create for you called recorder and that's going to record well everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3629" target="_blank">01:00:29.720</a></span> | <span class="t">that appears in this table basically well these three things the training loss the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3634" target="_blank">01:00:34.360</a></span> | <span class="t">loss and the accuracy or any metrics so recorder dot values contains that kind of table of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3642" target="_blank">01:00:42.240</a></span> | <span class="t">results and so item number two of each row will be the accuracy and so the the capital</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3653" target="_blank">01:00:53.380</a></span> | <span class="t">L class which I'm using here as a nice little method called item got that will will get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3663" target="_blank">01:01:03.880</a></span> | <span class="t">the second item from every row and then I can plot that to see how the training went</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3672" target="_blank">01:01:12.360</a></span> | <span class="t">and I can get the final accuracy like so by grabbing the last row of the table and grabbing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3679" target="_blank">01:01:19.380</a></span> | <span class="t">the second index two zero one two and my final accuracy not bad ninety eight point three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3687" target="_blank">01:01:27.680</a></span> | <span class="t">percent so this is pretty amazing we now have a function that can solve any problem to any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3696" target="_blank">01:01:36.760</a></span> | <span class="t">level of accuracy if we can find the right parameters and we have a way to find hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3703" target="_blank">01:01:43.000</a></span> | <span class="t">the best or at least a very good set of parameters for any function so this is kind of the magic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3711" target="_blank">01:01:51.000</a></span> | <span class="t">yes Rachel how could we use what we're learning here to get an idea of what the network is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3717" target="_blank">01:01:57.960</a></span> | <span class="t">learning along the way like Xylor and Fergus did more or less we will look at that later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3727" target="_blank">01:02:07.480</a></span> | <span class="t">not in the full detail of their paper but basically you can look in the dot parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3734" target="_blank">01:02:14.840</a></span> | <span class="t">to see the values of those parameters and at this point well I mean why don't you try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3741" target="_blank">01:02:21.320</a></span> | <span class="t">it yourself right you've actually got now the parameters so if you want to grab the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3748" target="_blank">01:02:28.780</a></span> | <span class="t">model you can actually see learn dot model so we can we can look inside learn dot model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3758" target="_blank">01:02:38.000</a></span> | <span class="t">to see the actual model that we just trained and you can see it's got the three things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3767" target="_blank">01:02:47.880</a></span> | <span class="t">in it the linear the value of the linear and what I kind of like to do is to put that into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3773" target="_blank">01:02:53.320</a></span> | <span class="t">a variable make it a bit easy to work with and you can grab one layer by indexing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3782" target="_blank">01:03:02.960</a></span> | <span class="t">you can look at the parameters and that just gives me a something called a generator it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3790" target="_blank">01:03:10.760</a></span> | <span class="t">something that will give me a list of the parameters when I ask for them so I can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3794" target="_blank">01:03:14.600</a></span> | <span class="t">go weight comma bias equals to de-structure them and so the weight is 30 by 784 because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3810" target="_blank">01:03:30.120</a></span> | <span class="t">that's what I asked for so one of the things to note here is that to create a neural net</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3820" target="_blank">01:03:40.400</a></span> | <span class="t">so something with more than one layer I actually have 30 outputs not just one right so I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3827" target="_blank">01:03:47.240</a></span> | <span class="t">kind of generating lots of you can think of generating lots of features so it's kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3830" target="_blank">01:03:50.520</a></span> | <span class="t">like 30 different linear linear models here and then I combine those 30 back into one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3838" target="_blank">01:03:58.680</a></span> | <span class="t">so you could look at one of those by having a look at yeah so there's there's the numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3848" target="_blank">01:04:08.900</a></span> | <span class="t">in the first row we could reshape that into the original shape of the images and we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3864" target="_blank">01:04:24.800</a></span> | <span class="t">even have a look and there it is right so you can see this is something so this is cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3875" target="_blank">01:04:35.120</a></span> | <span class="t">right we can actually see here we've got something which is which is kind of learning to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3886" target="_blank">01:04:46.280</a></span> | <span class="t">things at the top and the bottom and the middle and so we could look at the second one okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3894" target="_blank">01:04:54.120</a></span> | <span class="t">no idea what that's showing and so some of them are kind of you know I've probably got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3899" target="_blank">01:04:59.680</a></span> | <span class="t">far more than I need which is why they're not that obvious but you can see yeah here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3904" target="_blank">01:05:04.960</a></span> | <span class="t">another thing it's looking pretty similar here's something that's kind of looking for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3909" target="_blank">01:05:09.920</a></span> | <span class="t">this little bit in the middle so yeah this is the basic idea to understand the features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3917" target="_blank">01:05:17.920</a></span> | <span class="t">that are not the first layer but later layers you have to be a bit more sophisticated but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3923" target="_blank">01:05:23.960</a></span> | <span class="t">yeah to see the first layer ones you can you can just plot them okay so then you know just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3933" target="_blank">01:05:33.280</a></span> | <span class="t">to compare we could use the full fast AI toolkit so grab our data loaders by using data loaders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3941" target="_blank">01:05:41.160</a></span> | <span class="t">from folder as we've done before and create a CNN learner and a ResNet and fit it for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3947" target="_blank">01:05:47.520</a></span> | <span class="t">a single epoch and whoa 99.7 right so we did 40 epochs and got 98.3 as I said using all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3959" target="_blank">01:05:59.560</a></span> | <span class="t">the tricks you can really speed things up and make things a lot better and so by the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3965" target="_blank">01:06:05.640</a></span> | <span class="t">end of this course or at least both parts of this course you'll be able to from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3973" target="_blank">01:06:13.900</a></span> | <span class="t">get this 99.7 in a single epoch all right so jargon so jargon just to remind us value function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3990" target="_blank">01:06:30.200</a></span> | <span class="t">that returns zero for negatives many batch a few inputs and labels which optionally are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=3998" target="_blank">01:06:38.280</a></span> | <span class="t">randomly selected the forward pass is the bit where we calculate the predictions the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4003" target="_blank">01:06:43.560</a></span> | <span class="t">loss is the function that we're going to take the derivative of and then the gradient is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4008" target="_blank">01:06:48.480</a></span> | <span class="t">the derivative of the loss with respect to each parameter the backward pass is when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4014" target="_blank">01:06:54.680</a></span> | <span class="t">calculate those gradients gradient descent is that full thing of taking a step in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4020" target="_blank">01:07:00.080</a></span> | <span class="t">direction opposite to the gradients by after calculating the loss and then the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4024" target="_blank">01:07:04.760</a></span> | <span class="t">rate is the size of the step that we take other things to know perhaps the two most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4037" target="_blank">01:07:17.960</a></span> | <span class="t">important pieces of jargon are all of the numbers that are in a neural network the numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4043" target="_blank">01:07:23.520</a></span> | <span class="t">that we're learning are called parameters and then the numbers that we're calculating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4049" target="_blank">01:07:29.240</a></span> | <span class="t">so every value that's calculated every matrix multiplication element that's calculated they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4055" target="_blank">01:07:35.160</a></span> | <span class="t">called activations so activations and parameters are all of the numbers in the neural net and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4062" target="_blank">01:07:42.420</a></span> | <span class="t">so be very careful when I say from here on in in these lessons activations or parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4068" target="_blank">01:07:48.760</a></span> | <span class="t">you got to make sure you know what those mean because that's that's the entire basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4073" target="_blank">01:07:53.360</a></span> | <span class="t">almost the entire set of numbers that exist inside a neural net so activations are calculated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4079" target="_blank">01:07:59.600</a></span> | <span class="t">parameters are learned we're doing this stuff with tensors and tensors are just regularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4087" target="_blank">01:08:07.600</a></span> | <span class="t">shaped arrays rank 0 tensors we call scalars rank 1 tensors we call vectors rank 2 tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4094" target="_blank">01:08:14.540</a></span> | <span class="t">we call matrices and we continue on to rank 3 tensors rank 4 tensors and so forth and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4101" target="_blank">01:08:21.520</a></span> | <span class="t">rank 5 tensors are very common in deep learning so don't be scared of going up to higher numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4107" target="_blank">01:08:27.400</a></span> | <span class="t">of dimensions okay so let's have a break oh we've got a question okay is there a rule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4115" target="_blank">01:08:35.700</a></span> | <span class="t">of thumb for what non-linearity to choose given that there are many yeah there are many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4121" target="_blank">01:08:41.840</a></span> | <span class="t">non-linearities to choose from and it doesn't generally matter very much which you choose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4126" target="_blank">01:08:46.440</a></span> | <span class="t">so let's choose ReLU or leaky ReLU or yeah whatever any anyone should work fine later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4136" target="_blank">01:08:56.640</a></span> | <span class="t">on we'll look at the minor differences between between them but it's not so much something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4142" target="_blank">01:09:02.960</a></span> | <span class="t">that you pick on a per problem it's more like some take a little bit longer and a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4148" target="_blank">01:09:08.040</a></span> | <span class="t">bit more accurate and some a bit faster and a little bit less accurate that's a good question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4154" target="_blank">01:09:14.320</a></span> | <span class="t">okay so before you move on it's really important that you finish the questionnaire for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4158" target="_blank">01:09:18.560</a></span> | <span class="t">chapter because there's a whole lot of concepts that we've just done so you know try to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4164" target="_blank">01:09:24.680</a></span> | <span class="t">through the questionnaire go back and relook at the notebook and please run the code through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4170" target="_blank">01:09:30.920</a></span> | <span class="t">the experiments and make sure it makes sense all right let's have a seven minute break</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4177" target="_blank">01:09:37.000</a></span> | <span class="t">see you back here in seven minutes time okay welcome back so now that we know how to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4191" target="_blank">01:09:51.560</a></span> | <span class="t">and train a neural net let's cycle back and look deeper at some applications and so we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4199" target="_blank">01:09:59.200</a></span> | <span class="t">going to try to kind of interpolate in from one end we've done the kind of from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4205" target="_blank">01:10:05.800</a></span> | <span class="t">version at the other end we've done the kind of four lines of code version and we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4210" target="_blank">01:10:10.320</a></span> | <span class="t">to gradually nibble at each end until we find ourselves in the middle and we've we've we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4215" target="_blank">01:10:15.680</a></span> | <span class="t">touched on all of it so let's go back up to the kind of the four lines of code version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4220" target="_blank">01:10:20.960</a></span> | <span class="t">and and delve a little deeper so let's go back to pets and let's think though about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4233" target="_blank">01:10:33.000</a></span> | <span class="t">like how do you actually you know start with a new data set and figure out how to use it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4244" target="_blank">01:10:44.920</a></span> | <span class="t">so it you know the data sets we provide it's easy enough to untie them you just say untie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4250" target="_blank">01:10:50.320</a></span> | <span class="t">that or download it and untie it if it's a data set that you're getting you can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4257" target="_blank">01:10:57.320</a></span> | <span class="t">use the terminal or either or python or whatever so let's assume we have a path that's pointing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4265" target="_blank">01:11:05.000</a></span> | <span class="t">at something so initially you don't you don't know what that something is so we can start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4272" target="_blank">01:11:12.480</a></span> | <span class="t">by doing ls to have a look and see what's inside there so the pets data set that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4277" target="_blank">01:11:17.720</a></span> | <span class="t">saw in lesson one contains three things annotations images and models and you'll see we have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4285" target="_blank">01:11:25.520</a></span> | <span class="t">little trick here where we say path dot base path equals and then the path to our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4291" target="_blank">01:11:31.600</a></span> | <span class="t">and that's just does a little simple thing where when we print it out it just doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4295" target="_blank">01:11:35.640</a></span> | <span class="t">show us it just shows us relative to this path is a bit convenient so if you go and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4304" target="_blank">01:11:44.960</a></span> | <span class="t">have a look at the read me for the original pets data set it tells you what these images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4311" target="_blank">01:11:51.200</a></span> | <span class="t">and annotations folders are and not surprisingly the images path if we go path images that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4318" target="_blank">01:11:58.640</a></span> | <span class="t">how we use path lib to grab a subdirectory and then ls we can see here are the names</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4325" target="_blank">01:12:05.920</a></span> | <span class="t">that the paths to the images as it mentions here most functions and methods in fast a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4332" target="_blank">01:12:12.920</a></span> | <span class="t">which return a collection don't return a python list but they return a capital L and a capital</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4340" target="_blank">01:12:20.440</a></span> | <span class="t">L as we briefly mentioned is basically an enhanced list one of the enhancements is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4346" target="_blank">01:12:26.200</a></span> | <span class="t">way it prints the representation of it starts by showing you how many items there are in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4351" target="_blank">01:12:31.080</a></span> | <span class="t">the list in the collection so there's seven thousand three hundred and ninety four images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4356" target="_blank">01:12:36.800</a></span> | <span class="t">and it if there's more than ten things it truncates it and just says dot dot dot to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4363" target="_blank">01:12:43.480</a></span> | <span class="t">avoid filling up your screen so there's a couple of little conveniences there and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4371" target="_blank">01:12:51.160</a></span> | <span class="t">we can see from this output that the file name as we mentioned in lesson one if the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4380" target="_blank">01:13:00.080</a></span> | <span class="t">first letter is a capital it means it's a cat and if the first letter is lowercase it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4386" target="_blank">01:13:06.640</a></span> | <span class="t">means it's a dog but this time we've got to do something a bit more complex well a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4390" target="_blank">01:13:10.760</a></span> | <span class="t">more complex which is figure out what breed it is and so you can see the breed is kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4396" target="_blank">01:13:16.320</a></span> | <span class="t">of everything up to after the in the file name it's everything up to the the last underscore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4402" target="_blank">01:13:22.280</a></span> | <span class="t">and before this number is the breed so we want to label everything with its breed so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4410" target="_blank">01:13:30.200</a></span> | <span class="t">we're going to take advantage of this structure so the way I would do this is to use a regular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4421" target="_blank">01:13:41.940</a></span> | <span class="t">expression a regular expression is something that looks at a string and basically lets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4426" target="_blank">01:13:46.880</a></span> | <span class="t">you kind of pull it apart into its pieces in very flexible way it's this kind of simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4431" target="_blank">01:13:51.520</a></span> | <span class="t">little language for doing that if you haven't used regular expressions before please google</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4438" target="_blank">01:13:58.520</a></span> | <span class="t">regular expression tutorial now and look it's going to be like one of the most useful tools</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4443" target="_blank">01:14:03.120</a></span> | <span class="t">you'll come across in your life I use them almost every day I will go to details about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4450" target="_blank">01:14:10.000</a></span> | <span class="t">how to use them since there's so many great tutorials and there's also a lot of great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4453" target="_blank">01:14:13.360</a></span> | <span class="t">like exercises you know there's regex regex is short for regular expression there's regex</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4458" target="_blank">01:14:18.680</a></span> | <span class="t">crosswords there's regex Q&A there's all kinds of cool regex things a lot of people like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4464" target="_blank">01:14:24.760</a></span> | <span class="t">me love this tool in order to there's also a regex lesson in the fast AI NLP course maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4473" target="_blank">01:14:33.400</a></span> | <span class="t">even two regex lessons oh yeah I'm sorry for forgetting about the fast AI NLP course what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4480" target="_blank">01:14:40.400</a></span> | <span class="t">an excellent resource that is so regular expressions are a bit hard to get right the first time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4490" target="_blank">01:14:50.680</a></span> | <span class="t">so the best thing to do is to get a sample string so it's a good way to do that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4494" target="_blank">01:14:54.880</a></span> | <span class="t">be to just grab one of the file names thought it's pop it in F name and then you can experiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4502" target="_blank">01:15:02.160</a></span> | <span class="t">with regular expressions so re is the regular expression module in Python and find all will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4511" target="_blank">01:15:11.760</a></span> | <span class="t">just grab all the parts of a regular expression that have parentheses around them so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4517" target="_blank">01:15:17.400</a></span> | <span class="t">regular expression and are is a special kind of string in Python which basically says don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4522" target="_blank">01:15:22.960</a></span> | <span class="t">treat backslash as special because normally in Python like backslash N means a new line</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4529" target="_blank">01:15:29.520</a></span> | <span class="t">so here's a string which I'm going to capture any letter one or more times followed by an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4539" target="_blank">01:15:39.680</a></span> | <span class="t">underscore followed by a digit one or more times followed by anything I probably should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4547" target="_blank">01:15:47.600</a></span> | <span class="t">have used backslash dot that's fine followed by the letters jpg followed by the end of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4552" target="_blank">01:15:52.560</a></span> | <span class="t">the string and so if I call that regular expression against my file names name oh looks good right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4562" target="_blank">01:16:02.880</a></span> | <span class="t">so we kind of check it out so now that seems to work we can create a data block where the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4569" target="_blank">01:16:09.400</a></span> | <span class="t">independent variables are images the dependent variables are categories just like before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4575" target="_blank">01:16:15.040</a></span> | <span class="t">get items is going to be get image files we're going to split it randomly as per usual and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4583" target="_blank">01:16:23.580</a></span> | <span class="t">then we're going to get the label by calling regex labeler which is a just a handy little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4593" target="_blank">01:16:33.000</a></span> | <span class="t">fast a class which labels things with a regular expression we can't call the regular expression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4599" target="_blank">01:16:39.920</a></span> | <span class="t">this particular expression directly on the path lib path object we actually want to call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4605" target="_blank">01:16:45.040</a></span> | <span class="t">it on the name attribute and fast AI has a nice little function called using atra using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4612" target="_blank">01:16:52.040</a></span> | <span class="t">attribute which takes this function and changes it to a function which will be passed this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4618" target="_blank">01:16:58.080</a></span> | <span class="t">attribute that's going to be using regex labeler on the name attribute and then from that data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4628" target="_blank">01:17:08.520</a></span> | <span class="t">block we can create the data loaders as usual there's two interesting lines here resize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4636" target="_blank">01:17:16.160</a></span> | <span class="t">and all transforms all transforms we have seen before in notebook 2 in the section called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4648" target="_blank">01:17:28.000</a></span> | <span class="t">data augmentation and so all transforms was the thing which can zoom in and zoom out and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4656" target="_blank">01:17:36.040</a></span> | <span class="t">warp and rotate and change contrast and change brightness and so forth and flip to kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4663" target="_blank">01:17:43.000</a></span> | <span class="t">give us almost it's like giving us more data being generated synthetically from the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4667" target="_blank">01:17:47.960</a></span> | <span class="t">we already have and we also learned about random resize crop which is a kind of a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4679" target="_blank">01:17:59.680</a></span> | <span class="t">cool way of getting ensuring you get square images at the same time that you're augmenting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4688" target="_blank">01:18:08.600</a></span> | <span class="t">the data here we have a resize to a really large image but you know by deep learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4697" target="_blank">01:18:17.320</a></span> | <span class="t">standards 460 by 460 is a really large image and then we're using all transforms with a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4704" target="_blank">01:18:24.280</a></span> | <span class="t">size so that's actually going to use random resize crop to a smaller size why are we doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4710" target="_blank">01:18:30.240</a></span> | <span class="t">that this particular combination of two steps does something which I think is unique to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4720" target="_blank">01:18:40.060</a></span> | <span class="t">fast AI which we call pre-sizing and the best way is I will show you this beautiful example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4728" target="_blank">01:18:48.800</a></span> | <span class="t">of some PowerPoint wizardry that I'm so excited about to show how pre-sizing works what pre-sizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4736" target="_blank">01:18:56.820</a></span> | <span class="t">does is that first step where we say resize to 460 by 460 is it grabs a square and it grabs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4745" target="_blank">01:19:05.480</a></span> | <span class="t">it randomly if it's a kind of landscape orientation photo it'll grab it randomly so it'll take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4751" target="_blank">01:19:11.360</a></span> | <span class="t">the whole height and randomly grab somewhere from along the side if it's a portrait orientation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4758" target="_blank">01:19:18.400</a></span> | <span class="t">then it'll grab it you know take the full width and grab a random bit from top to bottom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4765" target="_blank">01:19:25.480</a></span> | <span class="t">so then we take this area here and here it is right and so that's what the first resize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4770" target="_blank">01:19:30.780</a></span> | <span class="t">does and then the second org transforms bit will grab a random warped crop possibly rotated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4781" target="_blank">01:19:41.360</a></span> | <span class="t">from in here and we'll turn that into a square and so it does so there's two steps it's first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4790" target="_blank">01:19:50.420</a></span> | <span class="t">of all resize to a square that's big and then the second step is do a kind of rotation and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4796" target="_blank">01:19:56.400</a></span> | <span class="t">warping and zooming stage to something smaller in this case 224 by 224 because this first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4805" target="_blank">01:20:05.880</a></span> | <span class="t">step creates something that's square and always is the same size the second step can happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4812" target="_blank">01:20:12.360</a></span> | <span class="t">on the GPU and because normally things like rotating and image warping actually pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4817" target="_blank">01:20:17.400</a></span> | <span class="t">slow also normally doing a zoom and a rotate and a warp actually is really destructive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4827" target="_blank">01:20:27.560</a></span> | <span class="t">to the image because each one of those things requires an interpolation step but it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4832" target="_blank">01:20:32.640</a></span> | <span class="t">just slow it actually makes the image really quite low quality so we do it in a very special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4840" target="_blank">01:20:40.120</a></span> | <span class="t">way in fast AI I think it's unique where we do all of these kind of coordinate transforms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4847" target="_blank">01:20:47.560</a></span> | <span class="t">like rotations and warps and zooms and so forth not on the actual pixels but instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4854" target="_blank">01:20:54.960</a></span> | <span class="t">we kind of keep track of the changing coordinate values in a non-lossy way so the full floating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4861" target="_blank">01:21:01.600</a></span> | <span class="t">point value and then once at the very end we then do the interpolation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4868" target="_blank">01:21:08.840</a></span> | <span class="t">The results are quite striking here is what the difference looks like hopefully you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4876" target="_blank">01:21:16.080</a></span> | <span class="t">see this on on the video on the left is our pre-sizing approach and on the right is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4884" target="_blank">01:21:24.160</a></span> | <span class="t">standard approach that other libraries use and you can see that the one on the right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4888" target="_blank">01:21:28.600</a></span> | <span class="t">is a lot less nicely focused and it also has like weird things like this should be grass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4896" target="_blank">01:21:36.040</a></span> | <span class="t">here but it's actually got its kind of bum-sticking way out this has a little bit of weird distortions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4901" target="_blank">01:21:41.600</a></span> | <span class="t">this has got loads of weird distortions so you can see the pre-sized version really ends</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4906" target="_blank">01:21:46.660</a></span> | <span class="t">up way way better and I think we have a question Rachel are the blocks in the data block and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4915" target="_blank">01:21:55.520</a></span> | <span class="t">ordered list do they specify the input and output structures respectively are there always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4921" target="_blank">01:22:01.080</a></span> | <span class="t">two blocks or can there be more than two for example if you wanted a segmentation model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4925" target="_blank">01:22:05.960</a></span> | <span class="t">would the second block be something about segmentation so so yeah this is an ordered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4934" target="_blank">01:22:14.400</a></span> | <span class="t">list so the first item says I want to create an image and then the second item says I want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4940" target="_blank">01:22:20.880</a></span> | <span class="t">to create a category so that's my independent and dependent variable you can have one thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4946" target="_blank">01:22:26.200</a></span> | <span class="t">here you can have three things here you can have any amount of things here you want obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4951" target="_blank">01:22:31.040</a></span> | <span class="t">the vast majority of the time it'll be two normally there's an independent variable and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4954" target="_blank">01:22:34.600</a></span> | <span class="t">a dependent variable we'll be seeing this in more detail later although if you go back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4959" target="_blank">01:22:39.600</a></span> | <span class="t">to the earlier lesson when we introduced data blocks I do have a picture kind of showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4963" target="_blank">01:22:43.660</a></span> | <span class="t">how these pieces fit together. So after you've put together your data block created your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4976" target="_blank">01:22:56.720</a></span> | <span class="t">data loaders you want to make sure it's working correctly so the obvious thing to do for computer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4982" target="_blank">01:23:02.240</a></span> | <span class="t">vision data block is show batch and show batch will show you the items and you can kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4991" target="_blank">01:23:11.960</a></span> | <span class="t">just make sure they look sensible that looks like the labels are reasonable if you add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=4996" target="_blank">01:23:16.480</a></span> | <span class="t">a unique equals true then it's going to show you the same image with all the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5001" target="_blank">01:23:21.240</a></span> | <span class="t">augmentations this is a good way to make sure your augmentations work if you make a mistake</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5006" target="_blank">01:23:26.000</a></span> | <span class="t">in your data block in this example there's no resize so the different images are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5012" target="_blank">01:23:32.160</a></span> | <span class="t">to be different sizes so it'll be impossible to collate them into a batch so if you call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5019" target="_blank">01:23:39.600</a></span> | <span class="t">dot summary this is a really neat thing which will go through and tell you everything that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5026" target="_blank">01:23:46.400</a></span> | <span class="t">happening so I collecting the items how many did I find what happened when I split them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5032" target="_blank">01:23:52.240</a></span> | <span class="t">what are the different variables independent dependent variables I'm creating let's try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5037" target="_blank">01:23:57.720</a></span> | <span class="t">and create one of these here's a step create my image create categorize here's what the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5046" target="_blank">01:24:06.800</a></span> | <span class="t">first thing gave me an American Bulldog is the final sample is this image this size this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5053" target="_blank">01:24:13.400</a></span> | <span class="t">category and then eventually it says oh it's not possible to collate your items I tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5060" target="_blank">01:24:20.400</a></span> | <span class="t">to collate the zero index members of your tuples so in other words that's the independent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5064" target="_blank">01:24:24.800</a></span> | <span class="t">variable and I got this was size 500 by 375 this was 375 by 500 oh I can't collate these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5072" target="_blank">01:24:32.560</a></span> | <span class="t">into a tensor because they're different sizes so this is a super great debugging tool for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5077" target="_blank">01:24:37.680</a></span> | <span class="t">debugging your data blocks you have a question how does the item transforms pre-size work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5086" target="_blank">01:24:46.320</a></span> | <span class="t">if the resize is smaller than the image is a whole width or height still taken or is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5091" target="_blank">01:24:51.600</a></span> | <span class="t">it just a random crop with the resize value so if you remember back to lesson two we looked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5104" target="_blank">01:25:04.000</a></span> | <span class="t">at the different ways of creating these things you can use squish you can use pad or you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5116" target="_blank">01:25:16.080</a></span> | <span class="t">can use crop so if your image is smaller than the precise value then squish will really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5123" target="_blank">01:25:23.940</a></span> | <span class="t">be zoom so it will just swell stretch it'll stretch it and then pad and crop will do much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5131" target="_blank">01:25:31.980</a></span> | <span class="t">the same thing and so you'll just end up with a you know the same just looks like these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5137" target="_blank">01:25:37.280</a></span> | <span class="t">but it'll be a kind of lower more pixelated lower resolution because it's having to zoom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5141" target="_blank">01:25:41.560</a></span> | <span class="t">in a little bit okay so a lot of people say that you should do a hell of a lot of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5152" target="_blank">01:25:52.120</a></span> | <span class="t">cleaning before you model we don't we say model as soon as you can because remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5159" target="_blank">01:25:59.360</a></span> | <span class="t">what we found in in notebook two your your model can teach you about the problems in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5166" target="_blank">01:26:06.840</a></span> | <span class="t">your data so as soon as I've got to a point where I have a data block that's working and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5172" target="_blank">01:26:12.680</a></span> | <span class="t">I have data loaders I'm going to build a model and so here I'm you know it also tells me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5177" target="_blank">01:26:17.460</a></span> | <span class="t">how I'm going so I'm getting seven percent error well that's actually really good for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5183" target="_blank">01:26:23.080</a></span> | <span class="t">a pets model and so at this point now that I have a model I can do that stuff we learned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5187" target="_blank">01:26:27.200</a></span> | <span class="t">about earlier in O2 the notebook O2 where we train our model and use it to clean the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5192" target="_blank">01:26:32.640</a></span> | <span class="t">data so we can look at the classification a confusion matrix top losses the image cleaner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5200" target="_blank">01:26:40.480</a></span> | <span class="t">widget you know so forth okay now one thing interesting here is in notebook four we included</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5215" target="_blank">01:26:55.600</a></span> | <span class="t">a loss function when we created a learner and here we don't pass in a loss function why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5221" target="_blank">01:27:01.360</a></span> | <span class="t">is that that's because first AI will try to automatically pick a somewhat sensible loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5228" target="_blank">01:27:08.040</a></span> | <span class="t">function for you and so for a image classification task it knows what loss function is the normal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5236" target="_blank">01:27:16.400</a></span> | <span class="t">one to pick and it's done it for you but let's have a look and see what it actually did pick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5244" target="_blank">01:27:24.360</a></span> | <span class="t">so we could have a look at learn dot loss funk and we will see it is cross entropy loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5257" target="_blank">01:27:37.880</a></span> | <span class="t">what on earth is cross entropy loss I'm glad you asked let's find out cross entropy loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5266" target="_blank">01:27:46.320</a></span> | <span class="t">is really much the same as the MNIST lost we created with that with that sigmoid and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5274" target="_blank">01:27:54.200</a></span> | <span class="t">the one minus predictions and predictions but it's it's a kind of extended version of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5281" target="_blank">01:28:01.440</a></span> | <span class="t">that and the extended version of that is that that torch dot where that we looked at in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5289" target="_blank">01:28:09.080</a></span> | <span class="t">notebook four only works when you have a binary outcome in that case it was is it a three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5295" target="_blank">01:28:15.440</a></span> | <span class="t">or not but in this case it we've got which of the 37 pet breeds is it so we want to kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5304" target="_blank">01:28:24.280</a></span> | <span class="t">of create something just like that sigmoid and torch dot where that which also works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5311" target="_blank">01:28:31.280</a></span> | <span class="t">nicely for more than two categories so let's see how we can do that so first of all let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5321" target="_blank">01:28:41.940</a></span> | <span class="t">grab a batch yes question why do we want to build a model before cleaning the data I would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5332" target="_blank">01:28:52.480</a></span> | <span class="t">think a clean data set would help in training yeah absolutely a clean data set helps in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5339" target="_blank">01:28:59.600</a></span> | <span class="t">training but remember as we saw in notebook 02 an initial model helps you clean the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5348" target="_blank">01:29:08.040</a></span> | <span class="t">set so remember how plot top losses helped us identify mislabeled images and the confusion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5355" target="_blank">01:29:15.800</a></span> | <span class="t">matrix helped us recognize which things we were getting confused and might need you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5360" target="_blank">01:29:20.560</a></span> | <span class="t">fixing and the image classifier cleaner actually let us find things like an image that contained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5367" target="_blank">01:29:27.400</a></span> | <span class="t">two bears rather than one bear and clean it up so a model is just a fantastic way to help</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5374" target="_blank">01:29:34.080</a></span> | <span class="t">you zoom in on the data that matters which things seem to have the problems which things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5379" target="_blank">01:29:39.600</a></span> | <span class="t">are most important stuff like that so you would go through and you clean it with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5384" target="_blank">01:29:44.800</a></span> | <span class="t">model helping you and then you go back and train it again with the clean data thanks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5390" target="_blank">01:29:50.720</a></span> | <span class="t">for that great question okay so in order to understand cross-entropy loss let's grab a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5399" target="_blank">01:29:59.960</a></span> | <span class="t">batch of data which we can use dls.one batch and that's going to grab a batch from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5409" target="_blank">01:30:09.280</a></span> | <span class="t">training set we could also go first dls.train and that's going to do exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5421" target="_blank">01:30:21.560</a></span> | <span class="t">and so then we can de-structure that into the independent and dependent variable and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5425" target="_blank">01:30:25.160</a></span> | <span class="t">so the dependent variable shows us we've got a batch size of 64 but shows us the 64 categories</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5441" target="_blank">01:30:41.480</a></span> | <span class="t">and remember those numbers simply refer to the index of into the vocab so for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5447" target="_blank">01:30:47.320</a></span> | <span class="t">16 is a boxer and so that all happens for you automatically when we say show batch it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5455" target="_blank">01:30:55.500</a></span> | <span class="t">shows us those strings so here's a first mini-batch and so now we can view the predictions that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5464" target="_blank">01:31:04.880</a></span> | <span class="t">is the activations of the final layer of the network by calling get preds and you can pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5471" target="_blank">01:31:11.320</a></span> | <span class="t">in a data loader and a data loader can really be anything that's going to return a sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5480" target="_blank">01:31:20.640</a></span> | <span class="t">of many batches so we can just pass in a list containing our mini-batch as a data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5486" target="_blank">01:31:26.920</a></span> | <span class="t">and so that's going to get the predictions for one mini-batch but here's some predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5492" target="_blank">01:31:32.080</a></span> | <span class="t">okay so the actual predictions if we go preds 0.sum to grab the predictions for the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5502" target="_blank">01:31:42.240</a></span> | <span class="t">image and add them all up they add up to 1 and there are 37 of them so that makes sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5511" target="_blank">01:31:51.080</a></span> | <span class="t">right it's like the very first thing is what is the probability that that is a else vocab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5520" target="_blank">01:32:00.440</a></span> | <span class="t">so the first thing is what's the probability it's an Abyssinian cat it's 10 to the negative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5525" target="_blank">01:32:05.400</a></span> | <span class="t">6 you see and so forth so it's basically like it's not this it's not this it's not this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5531" target="_blank">01:32:11.480</a></span> | <span class="t">and you can look through and oh here this one here you know obviously what I think it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5535" target="_blank">01:32:15.680</a></span> | <span class="t">is so how did it you know so we obviously want the probabilities to sum to one because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5544" target="_blank">01:32:24.920</a></span> | <span class="t">it would be pretty weird if if they didn't it would say you know that the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5550" target="_blank">01:32:30.320</a></span> | <span class="t">of being one of these things is more than one or less than one which would be extremely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5554" target="_blank">01:32:34.760</a></span> | <span class="t">odd so how do we go about creating these predictions where each one is between 0 and 1 and they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5565" target="_blank">01:32:45.320</a></span> | <span class="t">all add up to 1 to do that we use something called softmax softmax is basically an extension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5574" target="_blank">01:32:54.000</a></span> | <span class="t">of sigmoid to handle more than two levels two categories so remember the sigmoid function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5581" target="_blank">01:33:01.560</a></span> | <span class="t">look like this and we use that for our threes versus sevens model so what if we want 37</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5591" target="_blank">01:33:11.960</a></span> | <span class="t">categories rather than two categories we need one activation for every category so actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5599" target="_blank">01:33:19.560</a></span> | <span class="t">the threes and sevens model rather than thinking of that as an is three model we could actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5607" target="_blank">01:33:27.000</a></span> | <span class="t">say oh that has two categories so that's actually create two activations one representing how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5612" target="_blank">01:33:32.200</a></span> | <span class="t">three like something is and one representing how seven like something is so let's say you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5619" target="_blank">01:33:39.960</a></span> | <span class="t">know let's just say that we have six MNIST digits and these were the can I do this and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5635" target="_blank">01:33:55.160</a></span> | <span class="t">this first column were the activations of my model for for one activation and the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5645" target="_blank">01:34:05.240</a></span> | <span class="t">column was for a second activation so my final layer actually has two activations now so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5650" target="_blank">01:34:10.120</a></span> | <span class="t">this is like how much like a three is it and this is how much like a seven is it but this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5654" target="_blank">01:34:14.440</a></span> | <span class="t">one is not at all like a three and it's slightly not like a seven this is very much like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5661" target="_blank">01:34:21.040</a></span> | <span class="t">three and not much like a seven and so forth so we can take that model and rather having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5665" target="_blank">01:34:25.840</a></span> | <span class="t">rather than having one activation for like is three we can have two activations for how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5670" target="_blank">01:34:30.920</a></span> | <span class="t">much like a three how much like a seven so if we take the sigmoid of that we get two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5678" target="_blank">01:34:38.720</a></span> | <span class="t">numbers between naught and one but they don't add up to one so that doesn't make any sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5686" target="_blank">01:34:46.960</a></span> | <span class="t">it can't be point six six chance it's a three and point five six chance it's a seven because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5691" target="_blank">01:34:51.880</a></span> | <span class="t">every digit in that data set is only one or the other so that's not going to work but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5698" target="_blank">01:34:58.800</a></span> | <span class="t">what we could do is we could take the difference between this value and this value and say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5705" target="_blank">01:35:05.240</a></span> | <span class="t">that's how likely it is to be a three so in other words this one here with a high number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5710" target="_blank">01:35:10.360</a></span> | <span class="t">here and a low number here is very likely to be a three so we could basically say in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5717" target="_blank">01:35:17.400</a></span> | <span class="t">the binary case these activations that what really matters is their relative confidence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5724" target="_blank">01:35:24.220</a></span> | <span class="t">of being a three versus a seven so we could calculate the difference between column one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5729" target="_blank">01:35:29.900</a></span> | <span class="t">and column two or column index zero and column index one right and here's the difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5735" target="_blank">01:35:35.240</a></span> | <span class="t">between the two columns there's that big difference and we could take the sigmoid of that right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5743" target="_blank">01:35:43.600</a></span> | <span class="t">and so this is now giving us a single number between naught and one and so then since we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5750" target="_blank">01:35:50.680</a></span> | <span class="t">wanted two columns we could make column index zero the sigmoid and column index one could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5757" target="_blank">01:35:57.840</a></span> | <span class="t">be one minus that and now look these all add up to one so here's probability of three probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5766" target="_blank">01:36:06.900</a></span> | <span class="t">of seven for the second one probably three probably seven and so forth so like that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5774" target="_blank">01:36:14.840</a></span> | <span class="t">a way that we could go from having two activations for every image to creating two probabilities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5787" target="_blank">01:36:27.840</a></span> | <span class="t">each of which is between naught and one and each pair of which adds to one great how do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5795" target="_blank">01:36:35.640</a></span> | <span class="t">we extend that to more than two columns to extend it to more than two columns we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5802" target="_blank">01:36:42.040</a></span> | <span class="t">this function which is called softmax those softmax is equal to e to the x divided by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5813" target="_blank">01:36:53.200</a></span> | <span class="t">sum of e to the x just to show you if I go softmax on my activations I get point six</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5825" target="_blank">01:37:05.200</a></span> | <span class="t">oh two five point three nine seven five point six oh two five point three nine seven five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5830" target="_blank">01:37:10.200</a></span> | <span class="t">I get exactly the same thing right so softmax in the binary case is identical to the sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5840" target="_blank">01:37:20.040</a></span> | <span class="t">that we just looked at but in the multi-category case we basically end up with something like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5848" target="_blank">01:37:28.000</a></span> | <span class="t">this let's say we were doing the teddy bear grizzly bear brown bear and for that remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5853" target="_blank">01:37:33.800</a></span> | <span class="t">our neural net is going to have the final layer will have three activations so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5858" target="_blank">01:37:38.360</a></span> | <span class="t">say it was point oh two negative two point four nine one point two five so to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5863" target="_blank">01:37:43.480</a></span> | <span class="t">softmax I first go e to the power of each of these three things so here's e to the power</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5869" target="_blank">01:37:49.160</a></span> | <span class="t">of point oh two e to the power of negative two point four nine e to the power of three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5874" target="_blank">01:37:54.080</a></span> | <span class="t">point four e to the power of one point two five okay then I add them up so there's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5879" target="_blank">01:37:59.160</a></span> | <span class="t">sum of the x and then softmax will simply be one point oh two divided by four point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5885" target="_blank">01:38:05.160</a></span> | <span class="t">six and then this one will be point oh eight divided by four point six and this one will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5889" target="_blank">01:38:09.640</a></span> | <span class="t">be three point four nine divided by four point six so since each one of these represents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5895" target="_blank">01:38:15.240</a></span> | <span class="t">each number divided by the sum that means that the total is one okay and because all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5903" target="_blank">01:38:23.160</a></span> | <span class="t">of these are positive and each one is an item divided by the sum it means all of these must</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5908" target="_blank">01:38:28.600</a></span> | <span class="t">be between naught and one so this shows you that softmax always gives you numbers between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5915" target="_blank">01:38:35.300</a></span> | <span class="t">naught and one and they always add up to one so to do that in practice you can just call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5922" target="_blank">01:38:42.320</a></span> | <span class="t">torch dot softmax and it will give you this result of this this function so you should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5931" target="_blank">01:38:51.120</a></span> | <span class="t">experiment with this in your own time you know write this out by hand and try putting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5937" target="_blank">01:38:57.600</a></span> | <span class="t">in these numbers right and and see how that you get back the numbers I claim you're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5943" target="_blank">01:39:03.920</a></span> | <span class="t">to get back make sure this makes sense to you so one of the interesting points about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5948" target="_blank">01:39:08.480</a></span> | <span class="t">softmax is remember I told you that exp is e to the power of something and now what that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5956" target="_blank">01:39:16.840</a></span> | <span class="t">means is that e to the power of something grows very very fast right so like exp of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5969" target="_blank">01:39:29.420</a></span> | <span class="t">four is fifty four exp of eight is twenty nine two thousand nine hundred and eighty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5981" target="_blank">01:39:41.040</a></span> | <span class="t">right it grows super fast and what that means is that if you have one activation that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5987" target="_blank">01:39:47.480</a></span> | <span class="t">just a bit bigger than the others its softmax will be a lot bigger than the others so intuitively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=5994" target="_blank">01:39:54.320</a></span> | <span class="t">the softmax function really wants to pick one class among the others which is generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6002" target="_blank">01:40:02.160</a></span> | <span class="t">what you want right when you're trying to train a classifier to say which breed is it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6007" target="_blank">01:40:07.840</a></span> | <span class="t">you kind of want it to pick one and kind of go for it right and so that's what softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6013" target="_blank">01:40:13.600</a></span> | <span class="t">does that's not what you always want so sometimes at inference time you want it to be a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6021" target="_blank">01:40:21.200</a></span> | <span class="t">cautious and so you kind of got to remember that softmax isn't always the perfect approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6026" target="_blank">01:40:26.840</a></span> | <span class="t">but it's the default it's what we use most of the time and it works well on a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6031" target="_blank">01:40:31.320</a></span> | <span class="t">situations so that is softmax now in the binary case for the MNIST 3 versus 7 this was how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6043" target="_blank">01:40:43.320</a></span> | <span class="t">we calculated MNIST loss we took the sigmoid and then we did either one minus that or that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6049" target="_blank">01:40:49.200</a></span> | <span class="t">as our loss function which is fine as you saw it it worked right and so we could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6059" target="_blank">01:40:59.940</a></span> | <span class="t">this exactly the same thing we can't use torch.where anymore because targets aren't just 0 or 1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6067" target="_blank">01:41:07.000</a></span> | <span class="t">targets could be any number from 0 to 36 so we could do that by replacing the torch.where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6074" target="_blank">01:41:14.600</a></span> | <span class="t">with indexing so here's an example for the binary case let's say these are our targets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6081" target="_blank">01:41:21.160</a></span> | <span class="t">0 1 0 1 1 0 and these are our softmax activations which we calculated before they're just some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6088" target="_blank">01:41:28.880</a></span> | <span class="t">random numbers just for a toy example so one way to do instead of doing torch.where we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6097" target="_blank">01:41:37.240</a></span> | <span class="t">instead have a look at this I could grab all the numbers from 0 to 5 and if I index into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6106" target="_blank">01:41:46.160</a></span> | <span class="t">here with all the numbers from 0 to 5 and then my targets 0 1 0 1 0 1 0 then what that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6118" target="_blank">01:41:58.480</a></span> | <span class="t">going to do is it's going to pick the row 0 it'll pick 0.6 and then for row 1 it'll pick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6126" target="_blank">01:42:06.960</a></span> | <span class="t">1.49 for row 2 it'll pick 0.13 for row 4 it'll pick 1.003 and so forth so this is a super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6142" target="_blank">01:42:22.040</a></span> | <span class="t">nifty indexing expression which you should definitely play with right and it's basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6150" target="_blank">01:42:30.400</a></span> | <span class="t">this trick of passing multiple things to the PyTorch indexer the first thing says which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6156" target="_blank">01:42:36.840</a></span> | <span class="t">rows should you return and the second thing says for each of those rows which column should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6162" target="_blank">01:42:42.120</a></span> | <span class="t">you return so this is returning all the rows and these columns for each one and so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6170" target="_blank">01:42:50.080</a></span> | <span class="t">is actually identical to torch.where so isn't that tricky and so the nice thing is we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6179" target="_blank">01:42:59.280</a></span> | <span class="t">now use that for more than just two values and so here's here's the fully worked out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6188" target="_blank">01:43:08.320</a></span> | <span class="t">thing so I've got my threes column I've got my sevens column here's that target is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6193" target="_blank">01:43:13.240</a></span> | <span class="t">indexes from 0 1 2 3 4 5 and so here 0 0.6 1 1.49 0 2.13 and so forth so yeah this works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6209" target="_blank">01:43:29.080</a></span> | <span class="t">just as well with more than two columns so we can add you know for doing a full MNIST</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6215" target="_blank">01:43:35.840</a></span> | <span class="t">you know so all the digits from 0 to 9 we could have 10 columns and we would just be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6220" target="_blank">01:43:40.320</a></span> | <span class="t">indexing into the 10 so this thing we're doing where we're going minus our activations matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6232" target="_blank">01:43:52.240</a></span> | <span class="t">all of the numbers from 0 to n and then our targets is exactly the same as something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6238" target="_blank">01:43:58.640</a></span> | <span class="t">already exists in PyTorch called f dot nll loss as you can see exactly the same that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6245" target="_blank">01:44:05.400</a></span> | <span class="t">again we're kind of seeing that these things inside PyTorch and fast.ai are just little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6251" target="_blank">01:44:11.080</a></span> | <span class="t">shortcuts for stuff we can write ourself and our loss stands for negative log likelihood</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6258" target="_blank">01:44:18.720</a></span> | <span class="t">again sounds complex but actually it's just this indexing expression rather confusingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6267" target="_blank">01:44:27.360</a></span> | <span class="t">there's no log in it we'll see why in a moment so let's talk about logs so this locks this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6278" target="_blank">01:44:38.840</a></span> | <span class="t">loss function works quite well as we saw in the notebook 04 it's basically this it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6285" target="_blank">01:44:45.320</a></span> | <span class="t">exactly the same as we do in notebook 04 just a different way of expressing it but we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6291" target="_blank">01:44:51.120</a></span> | <span class="t">actually make it better because remember the probabilities we're looking at are between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6297" target="_blank">01:44:57.120</a></span> | <span class="t">0 and 1 so they can't be smaller than 0 they can't be greater than 1 which means that if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6302" target="_blank">01:45:02.400</a></span> | <span class="t">our model is trying to decide whether to predict 0.99 or 0.999 it's going to think that those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6308" target="_blank">01:45:08.620</a></span> | <span class="t">numbers are very very close together but won't really care but actually if you think about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6314" target="_blank">01:45:14.320</a></span> | <span class="t">the error you know if there's like a thousand things then this would like be 10 things are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6322" target="_blank">01:45:22.600</a></span> | <span class="t">wrong and this would be like one thing is wrong but this is really like 10 times better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6328" target="_blank">01:45:28.240</a></span> | <span class="t">than this so really what we'd like to do is to transform the numbers between 0 and 1 to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6336" target="_blank">01:45:36.040</a></span> | <span class="t">instead be between negative infinity and infinity and there's a function that does exactly that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6342" target="_blank">01:45:42.160</a></span> | <span class="t">which is called logarithm okay so as the so the numbers we could have can be between 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6352" target="_blank">01:45:52.560</a></span> | <span class="t">and 1 and as we get closer and closer to 0 it goes down to infinity and then at 1 it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6364" target="_blank">01:46:04.880</a></span> | <span class="t">going to be 0 and we can't go above 0 because our loss function we want to be negative so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6377" target="_blank">01:46:17.240</a></span> | <span class="t">this logarithm in case you forgot hopefully you vaguely remember what logarithm is from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6382" target="_blank">01:46:22.200</a></span> | <span class="t">high school but the basically the definition is this if you have some number that is y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6388" target="_blank">01:46:28.600</a></span> | <span class="t">that is b to the power of a then logarithm is defined such that a equals the logarithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6396" target="_blank">01:46:36.640</a></span> | <span class="t">of y, b in other words it tells you b to the power of what equals y which is not that interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6412" target="_blank">01:46:52.040</a></span> | <span class="t">of itself but one of the really interesting things about logarithms is this very cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6417" target="_blank">01:46:57.560</a></span> | <span class="t">relationship which is that log of a times b equals log of a plus log of b and we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6425" target="_blank">01:47:05.040</a></span> | <span class="t">that all the time in deep learning and machine learning because this number here a times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6433" target="_blank">01:47:13.040</a></span> | <span class="t">b can get very very big or very very small if you multiply things a lot of small things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6438" target="_blank">01:47:18.220</a></span> | <span class="t">together you'll get a tiny number if you multiply a lot of big things together you'll get a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6442" target="_blank">01:47:22.200</a></span> | <span class="t">huge number it can get so big or so small that the kind of the precision in your computer's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6448" target="_blank">01:47:28.480</a></span> | <span class="t">floating point gets really bad where else this thing here adding is not going to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6455" target="_blank">01:47:35.360</a></span> | <span class="t">out of control so we really love using logarithms like particularly in a deep neural net where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6462" target="_blank">01:47:42.560</a></span> | <span class="t">there's lots of layers we're kind of multiplying and adding many times so this kind of tends</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6467" target="_blank">01:47:47.680</a></span> | <span class="t">to come out quite nicely so when we take the probabilities that we saw before the things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6485" target="_blank">01:48:05.160</a></span> | <span class="t">that came out of this function and we take their logs and we take the mean that is called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6496" target="_blank">01:48:16.080</a></span> | <span class="t">negative log likelihood and so this ends up being kind of a really nicely behaved number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6503" target="_blank">01:48:23.640</a></span> | <span class="t">because of this property of the log that we described so if you take the softmax and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6511" target="_blank">01:48:31.240</a></span> | <span class="t">take the log and then pass that to an LL loss because remember that didn't actually take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6517" target="_blank">01:48:37.680</a></span> | <span class="t">the log at all despite the name that gives you cross entropy loss so that leaves an obvious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6527" target="_blank">01:48:47.120</a></span> | <span class="t">question of why doesn't an LL loss actually take the log and the reason for that is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6535" target="_blank">01:48:55.040</a></span> | <span class="t">it's more convenient computationally to actually take the log back at the softmax step so PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6541" target="_blank">01:49:01.800</a></span> | <span class="t">has a function called log softmax and so since it's actually easier to do the log at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6551" target="_blank">01:49:11.880</a></span> | <span class="t">softmax stage it's just faster and more accurate PyTorch assumes that you use soft logmax and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6558" target="_blank">01:49:18.280</a></span> | <span class="t">then pass that to an LL loss so an LL loss does not do the log it assumes that you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6565" target="_blank">01:49:25.000</a></span> | <span class="t">done the log beforehand so log softmax followed by an LL loss is the definition of cross entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6571" target="_blank">01:49:31.460</a></span> | <span class="t">loss in PyTorch so that's our loss function and so you can pass that some activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6578" target="_blank">01:49:38.200</a></span> | <span class="t">and some targets and get back a number and pretty much everything in PyTorch every one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6584" target="_blank">01:49:44.700</a></span> | <span class="t">of these kinds of functions you can either use the nn version as a class like this and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6591" target="_blank">01:49:51.000</a></span> | <span class="t">then call that object as if it's a function or you can just use f dot with the camel case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6597" target="_blank">01:49:57.560</a></span> | <span class="t">name as a function directly and as you can see they're exactly the same number people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6604" target="_blank">01:50:04.960</a></span> | <span class="t">normally use the class version in the documentation in PyTorch you'll see it normally uses the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6611" target="_blank">01:50:11.560</a></span> | <span class="t">class version so we'll tend to use the class version as well you'll see that it's returning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6618" target="_blank">01:50:18.200</a></span> | <span class="t">a single number and that's because it takes the mean because a loss needs to be as we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6622" target="_blank">01:50:22.720</a></span> | <span class="t">discussed the mean but if you want to see the underlying numbers before taking the mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6628" target="_blank">01:50:28.560</a></span> | <span class="t">you can just pass in reduction equals none and that shows you the individual cross entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6634" target="_blank">01:50:34.080</a></span> | <span class="t">losses before taking the mean. Okay great so this is a good place to stop with our discussion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6657" target="_blank">01:50:57.160</a></span> | <span class="t">of loss functions and such things Rachel were there any questions about this? Why does the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6672" target="_blank">01:51:12.560</a></span> | <span class="t">loss function need to be negative? Well I mean I guess it doesn't but it's we want something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6683" target="_blank">01:51:23.780</a></span> | <span class="t">that the lower it is the better and we kind of need it to cut off somewhere I have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6695" target="_blank">01:51:35.720</a></span> | <span class="t">think about this more during the week because it's a bit tired yeah let me refresh my memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6704" target="_blank">01:51:44.760</a></span> | <span class="t">when I'm awake. Okay now next week well note not for the video next week actually happened</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6719" target="_blank">01:51:59.320</a></span> | <span class="t">last week so the thing I'm about to say is actually. So next week we're going to be talking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6727" target="_blank">01:52:07.180</a></span> | <span class="t">about data ethics and I wanted to kind of segue into that by talking about how my week's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6734" target="_blank">01:52:14.200</a></span> | <span class="t">gone because a week or two ago in I did a as part of a lesson I actually talked about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6745" target="_blank">01:52:25.680</a></span> | <span class="t">the efficacy of masks and specifically wearing masks in public and I pointed out that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6753" target="_blank">01:52:33.840</a></span> | <span class="t">efficacy of masks seemed like it could be really high and maybe everybody should be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6758" target="_blank">01:52:38.520</a></span> | <span class="t">wearing them and somehow I found myself as the face of a global advocacy campaign and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6772" target="_blank">01:52:52.200</a></span> | <span class="t">so if you go to masksforall.co you'll find a website talking about masks and I've been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6789" target="_blank">01:53:09.800</a></span> | <span class="t">on you know TV shows in South Africa and the US and England and Australia and on radio</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6797" target="_blank">01:53:17.480</a></span> | <span class="t">and blah blah blah talking about masks why is this well it's because as a data scientist</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6808" target="_blank">01:53:28.840</a></span> | <span class="t">you know I noticed that the data around masks seem to be getting misunderstood and it seemed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6816" target="_blank">01:53:36.560</a></span> | <span class="t">that that misunderstanding was costing possibly hundreds of thousands of lives you know literally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6823" target="_blank">01:53:43.680</a></span> | <span class="t">in the places that were using masks it seemed to be associated with you know orders of magnitude</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6829" target="_blank">01:53:49.720</a></span> | <span class="t">fewer deaths and one of the things we're talking about next week is like you know what's your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6836" target="_blank">01:53:56.480</a></span> | <span class="t">role as a data scientist and you know I strongly believe that it's to understand the data and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6843" target="_blank">01:54:03.920</a></span> | <span class="t">then do something about it and so nobody was talking about this so I ended up writing an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6852" target="_blank">01:54:12.320</a></span> | <span class="t">article that appeared in the Washington Post that basically called on people to really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6858" target="_blank">01:54:18.760</a></span> | <span class="t">consider wearing masks which is this article and you know I was lucky I managed to kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6872" target="_blank">01:54:32.800</a></span> | <span class="t">of get a huge team of brilliant not huge a pretty decent sized team of brilliant volunteers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6879" target="_blank">01:54:39.120</a></span> | <span class="t">who helped you know kind of build this website and kind of some PR folks and stuff like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6885" target="_blank">01:54:45.080</a></span> | <span class="t">but what this came clear was and I was talking to politicians you know senators staffers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6894" target="_blank">01:54:54.120</a></span> | <span class="t">what was becoming clear is that people weren't convinced by the science which is fair enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6901" target="_blank">01:55:01.200</a></span> | <span class="t">because it's it's hard to you know when the WHO and the CDC is saying you don't need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6907" target="_blank">01:55:07.960</a></span> | <span class="t">wear a mask and some random data scientist is saying but doesn't seem to be what the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6912" target="_blank">01:55:12.640</a></span> | <span class="t">data is showing you know you've got half a brain you would pick the WHO and the CDC not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6917" target="_blank">01:55:17.680</a></span> | <span class="t">the random data scientist so I really felt like I if I was going to be an effective advocate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6923" target="_blank">01:55:23.240</a></span> | <span class="t">I needed sort the science out and it you know credentialism is strong and so it wouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6931" target="_blank">01:55:31.040</a></span> | <span class="t">be enough for me to say it I needed to find other people to say it though I put together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6934" target="_blank">01:55:34.600</a></span> | <span class="t">a team of 19 scientists including you know a professor of sociology a professor of aerosol</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6946" target="_blank">01:55:46.320</a></span> | <span class="t">dynamics the founder of an African movement that's that kind of studied preventative methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6954" target="_blank">01:55:54.000</a></span> | <span class="t">for tuberculosis a Stanford professor who studies mask disposal and cleaning methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6965" target="_blank">01:56:05.960</a></span> | <span class="t">a bunch of Chinese scientists who study epidemiology modeling a UCLA professor who is one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6976" target="_blank">01:56:16.680</a></span> | <span class="t">top infectious disease epidemiologists experts and so forth so like this kind of all-star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6984" target="_blank">01:56:24.320</a></span> | <span class="t">team of people from all around the world and I had never met any of these people before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6989" target="_blank">01:56:29.640</a></span> | <span class="t">so well no not quite true I knew Austin a little bit and I knew Zainip a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=6994" target="_blank">01:56:34.440</a></span> | <span class="t">I knew Lex a little bit but on the whole you know and well Reshma we all know she's awesome</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7003" target="_blank">01:56:43.280</a></span> | <span class="t">so it was great to actually have a fast AI community person there too and so but yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7010" target="_blank">01:56:50.160</a></span> | <span class="t">I kind of tried to pull together people from you know as many geographies as possible and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7016" target="_blank">01:56:56.720</a></span> | <span class="t">as many areas of expertise as possible and you know the kind of the global community</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7023" target="_blank">01:57:03.520</a></span> | <span class="t">helped me find papers about about everything about you know how different materials work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7032" target="_blank">01:57:12.840</a></span> | <span class="t">about how droplets form about epidemiology about case studies of people infecting with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7043" target="_blank">01:57:23.280</a></span> | <span class="t">and without masks blah blah blah and we ended up in the last week basically we wrote this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7049" target="_blank">01:57:29.600</a></span> | <span class="t">paper it contains 84 citations and you know we basically worked around the clock on it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7060" target="_blank">01:57:40.600</a></span> | <span class="t">as a team and it's out and it's been sent to a number of some of the earlier versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7069" target="_blank">01:57:49.640</a></span> | <span class="t">three or four days ago we sent her some governments so one of the things is I in this team I tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7075" target="_blank">01:57:55.560</a></span> | <span class="t">to look for people who were you know working closely with government leaders not just that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7080" target="_blank">01:58:00.600</a></span> | <span class="t">they're scientists and so this this went out to a number of government ministers and in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7087" target="_blank">01:58:07.360</a></span> | <span class="t">the last few days I've heard that it was a very significant part of decisions by governments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7095" target="_blank">01:58:15.600</a></span> | <span class="t">to change their to change their guidelines around masks and you know the fights not over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7105" target="_blank">01:58:25.280</a></span> | <span class="t">by any means in particular the UK is a bit of a holdout but I'm going to be on ITV tomorrow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7113" target="_blank">01:58:33.600</a></span> | <span class="t">and then BBC the next day you know it's it's kind of required stepping out to be a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7119" target="_blank">01:58:39.760</a></span> | <span class="t">more than just a data scientist I've had to pull together you know politicians and staffers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7126" target="_blank">01:58:46.080</a></span> | <span class="t">I've had to you know you know hustle with the media to try and get you know coverage</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7133" target="_blank">01:58:53.560</a></span> | <span class="t">and you know today I'm now starting to do a lot of work with unions to try to get unions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7138" target="_blank">01:58:58.460</a></span> | <span class="t">to understand this you know it's really a case of like saying okay as a data scientist</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7143" target="_blank">01:59:03.920</a></span> | <span class="t">and income in conjunction with real scientists we've built this really strong understanding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7151" target="_blank">01:59:11.000</a></span> | <span class="t">that masks you know this simple but incredibly powerful tool that doesn't do anything unless</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7158" target="_blank">01:59:18.400</a></span> | <span class="t">I can effectively communicate this to decision makers so today I was you know on the phone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7164" target="_blank">01:59:24.480</a></span> | <span class="t">to you know one of the top union leaders in the country explaining what this means basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7173" target="_blank">01:59:33.040</a></span> | <span class="t">it turns out that in buses in America the kind of the air conditioning is set up so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7178" target="_blank">01:59:38.000</a></span> | <span class="t">that it blows from the back to the front and there's actually case studies in the medical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7182" target="_blank">01:59:42.440</a></span> | <span class="t">literature of how people that are seated kind of downwind of an air conditioning unit in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7189" target="_blank">01:59:49.600</a></span> | <span class="t">a restaurant ended up all getting sick with COVID-19 and so we can see why like bus drivers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7196" target="_blank">01:59:56.200</a></span> | <span class="t">are dying because they're like they're right in the wrong spot here and their passengers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7202" target="_blank">02:00:02.800</a></span> | <span class="t">aren't wearing masks so I kind of try to explain this science to union leaders so that they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7211" target="_blank">02:00:11.360</a></span> | <span class="t">understand that to keep the workers safe it's not enough just for the driver to wear a mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7217" target="_blank">02:00:17.160</a></span> | <span class="t">but all the people on the bus need to be wearing masks as well so you know all of this is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7223" target="_blank">02:00:23.040</a></span> | <span class="t">to say you know as data scientists I think we have a responsibility to study the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7234" target="_blank">02:00:34.520</a></span> | <span class="t">and then do something about it it's not just a research you know exercise it's not just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7240" target="_blank">02:00:40.680</a></span> | <span class="t">a computation exercise you know what's the point of doing things if it doesn't lead to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7246" target="_blank">02:00:46.360</a></span> | <span class="t">anything so yeah so next week we'll be talking about this a lot more but I think you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7258" target="_blank">02:00:58.560</a></span> | <span class="t">this is a really to me kind of interesting example of how digging into the data can lead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7267" target="_blank">02:01:07.320</a></span> | <span class="t">to really amazing things happening and and in this case I strongly believe and a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7273" target="_blank">02:01:13.600</a></span> | <span class="t">of people are telling me they strongly believe that this kind of advocacy work that's come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7278" target="_blank">02:01:18.600</a></span> | <span class="t">out of this data analysis is already saving lives and so I hope this might help inspire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7284" target="_blank">02:01:24.920</a></span> | <span class="t">you to to take your data analysis and to take it to places that it really makes a difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=p50s63nPq9I&t=7291" target="_blank">02:01:31.640</a></span> | <span class="t">so thank you very much and I'll see you next week.</span></div></div></body></html>