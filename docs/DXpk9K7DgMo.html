<html><head><title>Using NEW MPT-7B in Hugging Face and LangChain</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Using NEW MPT-7B in Hugging Face and LangChain</h2><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo"><img src="https://i.ytimg.com/vi/DXpk9K7DgMo/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=0">0:0</a> Open Source LLMs like MPT-7B<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=50">0:50</a> MPT-7B Models in Hugging Face<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=149">2:29</a> Python setup<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=256">4:16</a> Initializing MPT-7B-Instruct<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=388">6:28</a> Initializing the MPT-7B tokenizer<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=430">7:10</a> Stopping Criteria and HF Pipeline<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=592">9:52</a> Hugging Face Pipeline<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=858">14:18</a> Generating Text with Hugging Face<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=961">16:1</a> Implementing MPT-7B in LangChain<br><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1028">17:8</a> Final Thoughts on Open Source LLMs<br><br><div style="text-align: left;"><a href="./DXpk9K7DgMo.html">Whisper Transcript</a> | <a href="./transcript_DXpk9K7DgMo.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we're gonna talk about using open source models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=3" target="_blank">00:00:03.140</a></span> | <span class="t">in Hugging Face and LangChain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=5" target="_blank">00:00:05.480</a></span> | <span class="t">We're going to be focusing specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=7" target="_blank">00:00:07.400</a></span> | <span class="t">on the MPT7B model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=10" target="_blank">00:00:10.360</a></span> | <span class="t">which I'm sure some of you have heard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=12" target="_blank">00:00:12.600</a></span> | <span class="t">as one of these fine-tuned versions of this model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=16" target="_blank">00:00:16.600</a></span> | <span class="t">actually has a context window of 65,000 tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=21" target="_blank">00:00:21.600</a></span> | <span class="t">which is pretty huge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=25" target="_blank">00:00:25.000</a></span> | <span class="t">At the moment of recording this video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=28" target="_blank">00:00:28.200</a></span> | <span class="t">GPT-4, the one that's generally available to people,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=32" target="_blank">00:00:32.280</a></span> | <span class="t">has a context window of 8,000 tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=35" target="_blank">00:00:35.800</a></span> | <span class="t">and they have a version that goes up to 32,000,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=40" target="_blank">00:00:40.200</a></span> | <span class="t">but I'm actually not aware of anyone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=42" target="_blank">00:00:42.000</a></span> | <span class="t">that has access to that at the moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=44" target="_blank">00:00:44.280</a></span> | <span class="t">So basically we're limited with GPT-4 to 8,000 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=49" target="_blank">00:00:49.280</a></span> | <span class="t">Now, MPT7B, like I said,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=53" target="_blank">00:00:53.880</a></span> | <span class="t">we can have that super huge model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=55" target="_blank">00:00:55.920</a></span> | <span class="t">but there are also a lot of other models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=57" target="_blank">00:00:57.720</a></span> | <span class="t">that are available as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=59" target="_blank">00:00:59.120</a></span> | <span class="t">So let me just go ahead and show you those very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=62" target="_blank">00:01:02.200</a></span> | <span class="t">So just head over to Hugging Face,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=64" target="_blank">00:01:04.480</a></span> | <span class="t">which is where we're gonna pull these models from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=66" target="_blank">00:01:06.920</a></span> | <span class="t">And you can see actually straight away,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=68" target="_blank">00:01:08.960</a></span> | <span class="t">we have these four models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=70" target="_blank">00:01:10.840</a></span> | <span class="t">So the MPT7B is the core, that's the pre-trained model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=75" target="_blank">00:01:15.840</a></span> | <span class="t">that's the foundation model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=77" target="_blank">00:01:17.840</a></span> | <span class="t">Then we have StoryWriter, Chat, and Instruct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=79" target="_blank">00:01:19.640</a></span> | <span class="t">These are all fine-tuned models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=81" target="_blank">00:01:21.280</a></span> | <span class="t">So StoryWriter is the one you've probably heard about,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=84" target="_blank">00:01:24.000</a></span> | <span class="t">which has a max context window of 65,000 tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=89" target="_blank">00:01:29.000</a></span> | <span class="t">which is pretty huge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=90" target="_blank">00:01:30.880</a></span> | <span class="t">And in reality, it actually goes up to higher.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=93" target="_blank">00:01:33.640</a></span> | <span class="t">So I believe they say, ah, here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=96" target="_blank">00:01:36.920</a></span> | <span class="t">So we demonstrate generations as long as 84,000 tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=101" target="_blank">00:01:41.280</a></span> | <span class="t">which is, I would say, pretty impressive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=104" target="_blank">00:01:44.400</a></span> | <span class="t">And then if we, actually, we can come over to here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=107" target="_blank">00:01:47.240</a></span> | <span class="t">scroll down, and we can see the other models as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=110" target="_blank">00:01:50.200</a></span> | <span class="t">So we have this Chat model, the Instruct model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=112" target="_blank">00:01:52.640</a></span> | <span class="t">and obviously the Foundation model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=114" target="_blank">00:01:54.160</a></span> | <span class="t">We're gonna be using the Instruct model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=115" target="_blank">00:01:55.720</a></span> | <span class="t">because, I mean, most of the use cases I see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=120" target="_blank">00:02:00.200</a></span> | <span class="t">kind of rely on us providing instructions to these models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=124" target="_blank">00:02:04.600</a></span> | <span class="t">And therefore, I think most people out there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=127" target="_blank">00:02:07.960</a></span> | <span class="t">actually are going to want to use this model, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=130" target="_blank">00:02:10.400</a></span> | <span class="t">Because, yeah, we can give it instructions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=132" target="_blank">00:02:12.480</a></span> | <span class="t">it's gonna be able to follow them better than the others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=135" target="_blank">00:02:15.280</a></span> | <span class="t">So, yeah, we're gonna see how we can use this both.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=138" target="_blank">00:02:18.840</a></span> | <span class="t">So initially in HuggingFace,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=140" target="_blank">00:02:20.120</a></span> | <span class="t">we're gonna see how we can load that into HuggingFace,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=142" target="_blank">00:02:22.000</a></span> | <span class="t">and then we're gonna see how we can take that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=144" target="_blank">00:02:24.400</a></span> | <span class="t">and actually load it into LimeChain,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=145" target="_blank">00:02:25.960</a></span> | <span class="t">which obviously has a few more features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=148" target="_blank">00:02:28.000</a></span> | <span class="t">on the agent side of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=149" target="_blank">00:02:29.520</a></span> | <span class="t">Okay, so the first thing we're gonna want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=151" target="_blank">00:02:31.600</a></span> | <span class="t">is actually do a few pip installs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=155" target="_blank">00:02:35.240</a></span> | <span class="t">So we have Transformers, Accelerate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=157" target="_blank">00:02:37.640</a></span> | <span class="t">So Accelerate, we need that in order to basically optimize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=161" target="_blank">00:02:41.280</a></span> | <span class="t">how we're running this on our GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=164" target="_blank">00:02:44.320</a></span> | <span class="t">We will want to run this on a GPU,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=166" target="_blank">00:02:46.040</a></span> | <span class="t">otherwise you're going to be waiting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=168" target="_blank">00:02:48.240</a></span> | <span class="t">an impossibly long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=170" target="_blank">00:02:50.000</a></span> | <span class="t">So, yeah, if you don't have access to a GPU,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=173" target="_blank">00:02:53.600</a></span> | <span class="t">I would recommend you figure that out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=177" target="_blank">00:02:57.360</a></span> | <span class="t">So right now I'm running this on Colab,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=179" target="_blank">00:02:59.280</a></span> | <span class="t">and actually there'll be a link to this notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=181" target="_blank">00:03:01.160</a></span> | <span class="t">as well on the top of the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=183" target="_blank">00:03:03.000</a></span> | <span class="t">So from Colab, you can run on GPU, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=185" target="_blank">00:03:05.960</a></span> | <span class="t">So you just go to Runtime, Change Runtime Type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=189" target="_blank">00:03:09.920</a></span> | <span class="t">You initially maybe on None, so you click GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=193" target="_blank">00:03:13.560</a></span> | <span class="t">GPU Type, so I'm using T4, which is the smallest one on here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=197" target="_blank">00:03:17.120</a></span> | <span class="t">and the standard version of T4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=199" target="_blank">00:03:19.080</a></span> | <span class="t">you can get on the free version of Colab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=202" target="_blank">00:03:22.080</a></span> | <span class="t">But for me, that wasn't actually big enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=205" target="_blank">00:03:25.720</a></span> | <span class="t">to run the MPT7B model, unfortunately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=210" target="_blank">00:03:30.720</a></span> | <span class="t">So I'm currently on Colab Pro now, thanks to this model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=215" target="_blank">00:03:35.760</a></span> | <span class="t">And with that, I can switch up to the high-RAM version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=221" target="_blank">00:03:41.280</a></span> | <span class="t">Now, obviously you have to pay for that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=223" target="_blank">00:03:43.440</a></span> | <span class="t">but you don't have to pay that much, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=226" target="_blank">00:03:46.640</a></span> | <span class="t">It's not a significant cost.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=229" target="_blank">00:03:49.800</a></span> | <span class="t">But of course, I know this will be limiting for some people,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=232" target="_blank">00:03:52.640</a></span> | <span class="t">but this is the best and cheapest option</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=235" target="_blank">00:03:55.440</a></span> | <span class="t">I can find right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=237" target="_blank">00:03:57.240</a></span> | <span class="t">Okay, so back on the installers, we have INOPS.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=239" target="_blank">00:03:59.920</a></span> | <span class="t">So this is, again, it's used by the MPT model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=242" target="_blank">00:04:02.880</a></span> | <span class="t">Naturally, we're gonna be using LangChain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=244" target="_blank">00:04:04.760</a></span> | <span class="t">And do I use Wikipedia here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=247" target="_blank">00:04:07.160</a></span> | <span class="t">I actually don't think I use this anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=249" target="_blank">00:04:09.440</a></span> | <span class="t">And Xform is just for an optimization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=252" target="_blank">00:04:12.120</a></span> | <span class="t">in our transform functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=255" target="_blank">00:04:15.360</a></span> | <span class="t">Okay, once we have all those installed,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=257" target="_blank">00:04:17.520</a></span> | <span class="t">we come down here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=258" target="_blank">00:04:18.360</a></span> | <span class="t">and this is where we initialize the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=261" target="_blank">00:04:21.160</a></span> | <span class="t">Okay, so like I said, we're gonna be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=262" target="_blank">00:04:22.760</a></span> | <span class="t">the instruct model, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=265" target="_blank">00:04:25.200</a></span> | <span class="t">One thing, so if you do want to use StoryWriter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=268" target="_blank">00:04:28.480</a></span> | <span class="t">and you want to use that huge context window,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=271" target="_blank">00:04:31.360</a></span> | <span class="t">you would go StoryWriter, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=275" target="_blank">00:04:35.200</a></span> | <span class="t">And then here, you would write,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=277" target="_blank">00:04:37.400</a></span> | <span class="t">I don't know, what is it, 65,000, which is kind of nuts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=282" target="_blank">00:04:42.160</a></span> | <span class="t">But in order to run that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=283" target="_blank">00:04:43.400</a></span> | <span class="t">you're gonna definitely need more than a T4 GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=286" target="_blank">00:04:46.280</a></span> | <span class="t">Basically, the higher the max sequence length is,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=289" target="_blank">00:04:49.040</a></span> | <span class="t">the bigger your GPU memory is going to need to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=292" target="_blank">00:04:52.360</a></span> | <span class="t">So yeah, you need something big to run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=295" target="_blank">00:04:55.280</a></span> | <span class="t">But we're just gonna stick with this, instruct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=297" target="_blank">00:04:57.800</a></span> | <span class="t">This 2048 is the typical or the standard sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=302" target="_blank">00:05:02.640</a></span> | <span class="t">for these other models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=304" target="_blank">00:05:04.200</a></span> | <span class="t">So instruct, or the base model, the foundation model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=307" target="_blank">00:05:07.360</a></span> | <span class="t">instruct and chat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=308" target="_blank">00:05:08.640</a></span> | <span class="t">And this is also something important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=310" target="_blank">00:05:10.800</a></span> | <span class="t">So the trust remote code, we have to have that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=313" target="_blank">00:05:13.120</a></span> | <span class="t">because essentially the MPT models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=316" target="_blank">00:05:16.720</a></span> | <span class="t">are not fully supported by HuggingFace yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=319" target="_blank">00:05:19.920</a></span> | <span class="t">So we have to rely on this remote code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=322" target="_blank">00:05:22.720</a></span> | <span class="t">that is basically stored in the model directory for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=327" target="_blank">00:05:27.480</a></span> | <span class="t">to set up all the endpoints and everything for the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=330" target="_blank">00:05:30.840</a></span> | <span class="t">Okay, then we switch the model to evaluation mode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=335" target="_blank">00:05:35.200</a></span> | <span class="t">So that just switches a few options within the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=339" target="_blank">00:05:39.560</a></span> | <span class="t">that says, okay, we're not training,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=341" target="_blank">00:05:41.280</a></span> | <span class="t">we're now performing inference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=343" target="_blank">00:05:43.240</a></span> | <span class="t">Okay, we're now doing predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=345" target="_blank">00:05:45.000</a></span> | <span class="t">And then we want to move our model to device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=348" target="_blank">00:05:48.400</a></span> | <span class="t">So the device, we decided here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=350" target="_blank">00:05:50.880</a></span> | <span class="t">Okay, so CUDA, and then we have CUDA current device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=354" target="_blank">00:05:54.120</a></span> | <span class="t">If we scroll down to the end here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=355" target="_blank">00:05:55.640</a></span> | <span class="t">we should see what that moved it to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=358" target="_blank">00:05:58.080</a></span> | <span class="t">Yeah, so model loaded to CUDA at zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=361" target="_blank">00:06:01.160</a></span> | <span class="t">Now, just one thing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=362" target="_blank">00:06:02.560</a></span> | <span class="t">this takes a little bit of time to run, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=365" target="_blank">00:06:05.160</a></span> | <span class="t">Like here, it just took a minute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=366" target="_blank">00:06:06.840</a></span> | <span class="t">I think that's because most of the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=368" target="_blank">00:06:08.920</a></span> | <span class="t">was probably already downloaded for me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=370" target="_blank">00:06:10.640</a></span> | <span class="t">If you're downloading and initializing this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=372" target="_blank">00:06:12.640</a></span> | <span class="t">expect to wait like five, 10 minutes, at least on Colab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=377" target="_blank">00:06:17.120</a></span> | <span class="t">But once that has been downloaded,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=378" target="_blank">00:06:18.920</a></span> | <span class="t">you should be good to use it to basically initialize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=383" target="_blank">00:06:23.920</a></span> | <span class="t">And it will just take like a minute or so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=386" target="_blank">00:06:26.280</a></span> | <span class="t">because you only need to download it once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=388" target="_blank">00:06:28.440</a></span> | <span class="t">Okay, and then we initialize our tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=391" target="_blank">00:06:31.280</a></span> | <span class="t">So the tokenizer is actually using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=394" target="_blank">00:06:34.080</a></span> | <span class="t">Luther AI's GPT Neox 20B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=398" target="_blank">00:06:38.160</a></span> | <span class="t">This is just, this is a tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=400" target="_blank">00:06:40.040</a></span> | <span class="t">So when I say tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=401" target="_blank">00:06:41.960</a></span> | <span class="t">it's basically the thing that will translate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=404" target="_blank">00:06:44.600</a></span> | <span class="t">from human readable plain text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=407" target="_blank">00:06:47.760</a></span> | <span class="t">to transformer or large language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=411" target="_blank">00:06:51.080</a></span> | <span class="t">readable token IDs, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=413" target="_blank">00:06:53.200</a></span> | <span class="t">So it's gonna convert like the word V</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=415" target="_blank">00:06:55.920</a></span> | <span class="t">into the token ID 41, for example, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=420" target="_blank">00:07:00.320</a></span> | <span class="t">And then they get fed into the large language model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=423" target="_blank">00:07:03.720</a></span> | <span class="t">Now the MPT7B model was trained using this tokenizer here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=427" target="_blank">00:07:07.840</a></span> | <span class="t">Right, so we have to use that tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=430" target="_blank">00:07:10.000</a></span> | <span class="t">Then what we need to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=431" target="_blank">00:07:11.280</a></span> | <span class="t">is define a stopping criteria of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=433" target="_blank">00:07:13.600</a></span> | <span class="t">So I should, I don't know if I mentioned this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=435" target="_blank">00:07:15.800</a></span> | <span class="t">but right now what we're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=437" target="_blank">00:07:17.240</a></span> | <span class="t">is actually initializing the honey face pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=440" target="_blank">00:07:20.920</a></span> | <span class="t">So within that pipeline, we have the large language model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=443" target="_blank">00:07:23.920</a></span> | <span class="t">the tokenizer, both of those we've just created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=446" target="_blank">00:07:26.440</a></span> | <span class="t">and also stopping criteria object, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=448" target="_blank">00:07:28.840</a></span> | <span class="t">Stopping criteria object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=450" target="_blank">00:07:30.960</a></span> | <span class="t">let me come down to where we create it, is this here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=455" target="_blank">00:07:35.440</a></span> | <span class="t">Okay, so basically MPT7B has been trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=460" target="_blank">00:07:40.440</a></span> | <span class="t">to add this particular bit of text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=463" target="_blank">00:07:43.440</a></span> | <span class="t">at the end of its generations,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=465" target="_blank">00:07:45.280</a></span> | <span class="t">when it's like, okay, I'm finished, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=468" target="_blank">00:07:48.600</a></span> | <span class="t">But there's nothing within that model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=471" target="_blank">00:07:51.640</a></span> | <span class="t">that will stop it from actually generating text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=474" target="_blank">00:07:54.440</a></span> | <span class="t">at that point, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=475" target="_blank">00:07:55.840</a></span> | <span class="t">It will just, it will generate this, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=478" target="_blank">00:07:58.320</a></span> | <span class="t">And then it will actually just continue generating text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=483" target="_blank">00:08:03.320</a></span> | <span class="t">And the text that it generates after this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=485" target="_blank">00:08:05.240</a></span> | <span class="t">is generally just going to be gibberish</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=487" target="_blank">00:08:07.200</a></span> | <span class="t">because it's been trained to generate this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=489" target="_blank">00:08:09.960</a></span> | <span class="t">at the end of a meaningful answer, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=492" target="_blank">00:08:12.800</a></span> | <span class="t">After generating this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=494" target="_blank">00:08:14.040</a></span> | <span class="t">it's able to just begin generating anything, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=497" target="_blank">00:08:17.760</a></span> | <span class="t">It's not going to be useful stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=500" target="_blank">00:08:20.960</a></span> | <span class="t">So what we need to do is define this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=504" target="_blank">00:08:24.560</a></span> | <span class="t">as a stopping criteria for the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=506" target="_blank">00:08:26.560</a></span> | <span class="t">We need to go in there and say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=508" target="_blank">00:08:28.080</a></span> | <span class="t">okay, when the model says end of text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=510" target="_blank">00:08:30.640</a></span> | <span class="t">when it gives this token to us, we stop, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=513" target="_blank">00:08:33.280</a></span> | <span class="t">We need to specify that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=515" target="_blank">00:08:35.280</a></span> | <span class="t">And we do that using this stopping criteria list object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=519" target="_blank">00:08:39.960</a></span> | <span class="t">Okay, so that requires a stopping criteria object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=524" target="_blank">00:08:44.360</a></span> | <span class="t">which we've defined here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=525" target="_blank">00:08:45.680</a></span> | <span class="t">So, I mean, you can see this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=528" target="_blank">00:08:48.000</a></span> | <span class="t">So these parameters are just the default parameters needed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=531" target="_blank">00:08:51.440</a></span> | <span class="t">by this stopping criteria object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=533" target="_blank">00:08:53.840</a></span> | <span class="t">And basically what it's going to do is say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=536" target="_blank">00:08:56.800</a></span> | <span class="t">okay, for SUP ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=538" target="_blank">00:08:58.600</a></span> | <span class="t">So we have these SUP token IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=541" target="_blank">00:09:01.200</a></span> | <span class="t">Maybe I can just show you these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=543" target="_blank">00:09:03.240</a></span> | <span class="t">Maybe that's easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=544" target="_blank">00:09:04.440</a></span> | <span class="t">So SUP token IDs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=549" target="_blank">00:09:09.160</a></span> | <span class="t">and it's just going to be a few integers, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=552" target="_blank">00:09:12.560</a></span> | <span class="t">Those integers, actually it's one integer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=555" target="_blank">00:09:15.440</a></span> | <span class="t">which represents this, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=557" target="_blank">00:09:17.880</a></span> | <span class="t">So I said before the tokenized,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=559" target="_blank">00:09:19.480</a></span> | <span class="t">it translates from plain text to the token IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=562" target="_blank">00:09:22.240</a></span> | <span class="t">That's what this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=563" target="_blank">00:09:23.080</a></span> | <span class="t">This is the plain text version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=564" target="_blank">00:09:24.800</a></span> | <span class="t">This is the token ID version, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=567" target="_blank">00:09:27.080</a></span> | <span class="t">And it's going to say, okay, for the SUP ID here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=570" target="_blank">00:09:30.560</a></span> | <span class="t">so actually just for zero,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=572" target="_blank">00:09:32.800</a></span> | <span class="t">if the input IDs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=574" target="_blank">00:09:34.960</a></span> | <span class="t">so the last input ID is equal to that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=578" target="_blank">00:09:38.400</a></span> | <span class="t">we're going to say, okay, it's time to stop, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=581" target="_blank">00:09:41.480</a></span> | <span class="t">Otherwise it's not time to stop, you can keep going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=584" target="_blank">00:09:44.480</a></span> | <span class="t">And that's it, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=586" target="_blank">00:09:46.440</a></span> | <span class="t">So that gives us our stopping criteria object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=589" target="_blank">00:09:49.240</a></span> | <span class="t">And then we just pass that into our pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=592" target="_blank">00:09:52.920</a></span> | <span class="t">So the pipeline is basically the tokenization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=597" target="_blank">00:09:57.120</a></span> | <span class="t">the model and the generation from that model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=600" target="_blank">00:10:00.520</a></span> | <span class="t">and then also this stopping criteria,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=602" target="_blank">00:10:02.680</a></span> | <span class="t">all packaged into a nice little function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=604" target="_blank">00:10:04.960</a></span> | <span class="t">So within that pipeline,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=607" target="_blank">00:10:07.120</a></span> | <span class="t">we pass in obviously our model, our tokenizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=609" target="_blank">00:10:09.280</a></span> | <span class="t">and the stopping criteria,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=610" target="_blank">00:10:10.640</a></span> | <span class="t">but there's also a few things we need as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=613" target="_blank">00:10:13.360</a></span> | <span class="t">So return full text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=615" target="_blank">00:10:15.360</a></span> | <span class="t">So if we have this false,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=616" target="_blank">00:10:16.720</a></span> | <span class="t">it's just going to return the generated part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=619" target="_blank">00:10:19.920</a></span> | <span class="t">or generate portion of some text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=623" target="_blank">00:10:23.200</a></span> | <span class="t">And that's fine, you can do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=624" target="_blank">00:10:24.400</a></span> | <span class="t">There's actually no problem with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=626" target="_blank">00:10:26.440</a></span> | <span class="t">But if you want to use this in light chain,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=628" target="_blank">00:10:28.680</a></span> | <span class="t">we need to return the generated text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=631" target="_blank">00:10:31.600</a></span> | <span class="t">and also the input text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=633" target="_blank">00:10:33.840</a></span> | <span class="t">We need to return full text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=635" target="_blank">00:10:35.480</a></span> | <span class="t">because we're going to be using line chain later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=637" target="_blank">00:10:37.320</a></span> | <span class="t">That's why we set return full text equal to true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=640" target="_blank">00:10:40.280</a></span> | <span class="t">If you were just wanting to use this and hung and face,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=642" target="_blank">00:10:42.400</a></span> | <span class="t">you don't need to, you don't need to have this as true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=645" target="_blank">00:10:45.360</a></span> | <span class="t">Then our task here is text generation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=649" target="_blank">00:10:49.000</a></span> | <span class="t">Okay, so this just says, okay, we want to generate text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=651" target="_blank">00:10:51.840</a></span> | <span class="t">The device here is important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=653" target="_blank">00:10:53.560</a></span> | <span class="t">We obviously want to use our CUDA enabled GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=655" target="_blank">00:10:55.920</a></span> | <span class="t">So we set that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=656" target="_blank">00:10:56.880</a></span> | <span class="t">And then we have a few other model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=659" target="_blank">00:10:59.080</a></span> | <span class="t">specific parameters down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=661" target="_blank">00:11:01.160</a></span> | <span class="t">Or we could call them generation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=662" target="_blank">00:11:02.600</a></span> | <span class="t">specific parameters as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=664" target="_blank">00:11:04.520</a></span> | <span class="t">So the temperature is like the randomness of your output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=668" target="_blank">00:11:08.160</a></span> | <span class="t">Zero is the minimum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=669" target="_blank">00:11:09.200</a></span> | <span class="t">It's basically zero randomness</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=671" target="_blank">00:11:11.640</a></span> | <span class="t">and one is maximum randomness.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=674" target="_blank">00:11:14.080</a></span> | <span class="t">Okay, so imagine it's kind of like how random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=678" target="_blank">00:11:18.280</a></span> | <span class="t">the predicted tokens or the next words are going to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=682" target="_blank">00:11:22.560</a></span> | <span class="t">Then we have top P.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=683" target="_blank">00:11:23.600</a></span> | <span class="t">So top P is basically we're going to select</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=687" target="_blank">00:11:27.560</a></span> | <span class="t">from the top tokens on each prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=690" target="_blank">00:11:30.360</a></span> | <span class="t">from whose probability adds up to 15%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=693" target="_blank">00:11:33.240</a></span> | <span class="t">And I would recommend if you want to read about this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=696" target="_blank">00:11:36.440</a></span> | <span class="t">I'd recommend looking at this page from Cohere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=699" target="_blank">00:11:39.360</a></span> | <span class="t">So there'll be a link at the top of the video right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=703" target="_blank">00:11:43.200</a></span> | <span class="t">They explain this really nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=705" target="_blank">00:11:45.000</a></span> | <span class="t">So yeah, you can kind of see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=707" target="_blank">00:11:47.640</a></span> | <span class="t">they use 0.15 here as well, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=710" target="_blank">00:11:50.760</a></span> | <span class="t">So consider only top tokens whose likelihoods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=714" target="_blank">00:11:54.000</a></span> | <span class="t">add up to that 15% and then ignore the others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=716" target="_blank">00:11:56.520</a></span> | <span class="t">So with each step, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=718" target="_blank">00:11:58.680</a></span> | <span class="t">Each generation step, you're predicting the next token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=722" target="_blank">00:12:02.480</a></span> | <span class="t">or the next word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=723" target="_blank">00:12:03.520</a></span> | <span class="t">You can think of it like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=725" target="_blank">00:12:05.040</a></span> | <span class="t">And by setting top P equals 0.15,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=729" target="_blank">00:12:09.160</a></span> | <span class="t">we're just going to consider the possible next words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=733" target="_blank">00:12:13.680</a></span> | <span class="t">'cause we're predicting for all of the words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=735" target="_blank">00:12:15.680</a></span> | <span class="t">in that tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=737" target="_blank">00:12:17.520</a></span> | <span class="t">We're going to consider the top words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=741" target="_blank">00:12:21.560</a></span> | <span class="t">whose together their likelihood adds up to 15%, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=747" target="_blank">00:12:27.240</a></span> | <span class="t">The total, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=749" target="_blank">00:12:29.040</a></span> | <span class="t">So you can see that there, they visualize it very nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=752" target="_blank">00:12:32.240</a></span> | <span class="t">I don't think my explanation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=754" target="_blank">00:12:34.880</a></span> | <span class="t">can compare to this visualization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=757" target="_blank">00:12:37.520</a></span> | <span class="t">Okay, and then we have top K.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=759" target="_blank">00:12:39.440</a></span> | <span class="t">This is another value, kind of similar thing, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=762" target="_blank">00:12:42.160</a></span> | <span class="t">So top K, if we come up to here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=765" target="_blank">00:12:45.640</a></span> | <span class="t">and this is easy to explain,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=767" target="_blank">00:12:47.720</a></span> | <span class="t">we're picking from the top K tokens, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=771" target="_blank">00:12:51.160</a></span> | <span class="t">So in this case, if you had top K equal to one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=775" target="_blank">00:12:55.400</a></span> | <span class="t">it would only select United</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=777" target="_blank">00:12:57.680</a></span> | <span class="t">or it could only decide on selecting United.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=780" target="_blank">00:13:00.600</a></span> | <span class="t">If you had top K equal to two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=781" target="_blank">00:13:01.960</a></span> | <span class="t">you could do United or Netherlands.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=784" target="_blank">00:13:04.240</a></span> | <span class="t">Top K equal to three,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=785" target="_blank">00:13:05.200</a></span> | <span class="t">you could choose any of these top three, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=788" target="_blank">00:13:08.240</a></span> | <span class="t">That is what the top K is actually doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=792" target="_blank">00:13:12.200</a></span> | <span class="t">And actually you can visualize that here as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=795" target="_blank">00:13:15.080</a></span> | <span class="t">Okay, and okay, what I've done here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=797" target="_blank">00:13:17.920</a></span> | <span class="t">set top K equal to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=799" target="_blank">00:13:19.320</a></span> | <span class="t">That's because I don't want to consider top K</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=802" target="_blank">00:13:22.120</a></span> | <span class="t">because I'm already defining the limits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=805" target="_blank">00:13:25.800</a></span> | <span class="t">on the number of tokens to decide from using top P, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=810" target="_blank">00:13:30.200</a></span> | <span class="t">So I don't activate the top K there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=812" target="_blank">00:13:32.760</a></span> | <span class="t">Then we have the max, not max,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=815" target="_blank">00:13:35.480</a></span> | <span class="t">max number of tokens to generate in the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=818" target="_blank">00:13:38.400</a></span> | <span class="t">So with each generation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=820" target="_blank">00:13:40.200</a></span> | <span class="t">I'm saying I don't want you to generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=821" target="_blank">00:13:41.920</a></span> | <span class="t">any more than 64 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=823" target="_blank">00:13:43.480</a></span> | <span class="t">You can increase that, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=825" target="_blank">00:13:45.280</a></span> | <span class="t">So the max context window,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=826" target="_blank">00:13:46.880</a></span> | <span class="t">so that's inputs and outputs for this model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=830" target="_blank">00:13:50.240</a></span> | <span class="t">we've already set it to,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=832" target="_blank">00:13:52.200</a></span> | <span class="t">it's a max sequence time from earlier, 2048.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=835" target="_blank">00:13:55.480</a></span> | <span class="t">So you can go much higher than 64 that I've set here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=839" target="_blank">00:13:59.080</a></span> | <span class="t">And then also we have this repetition penalty.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=842" target="_blank">00:14:02.280</a></span> | <span class="t">That's super important because otherwise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=844" target="_blank">00:14:04.800</a></span> | <span class="t">this is going to start repeating things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=847" target="_blank">00:14:07.480</a></span> | <span class="t">over and over again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=848" target="_blank">00:14:08.680</a></span> | <span class="t">So the default value for that actually is one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=850" target="_blank">00:14:10.960</a></span> | <span class="t">in that we can see more repetition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=853" target="_blank">00:14:13.600</a></span> | <span class="t">We switch that to 1.1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=854" target="_blank">00:14:14.920</a></span> | <span class="t">and we're generally not going to see that anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=858" target="_blank">00:14:18.360</a></span> | <span class="t">Okay, so let's run this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=860" target="_blank">00:14:20.960</a></span> | <span class="t">So we say, explain to me the difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=863" target="_blank">00:14:23.400</a></span> | <span class="t">between nuclear fission and fusion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=866" target="_blank">00:14:26.080</a></span> | <span class="t">So this is from an example somewhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=868" target="_blank">00:14:28.680</a></span> | <span class="t">I think it was Hugging Face,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=870" target="_blank">00:14:30.680</a></span> | <span class="t">but I don't actually remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=873" target="_blank">00:14:33.000</a></span> | <span class="t">where I got that from exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=874" target="_blank">00:14:34.600</a></span> | <span class="t">Anyone does know, feel free to mention that in the comments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=879" target="_blank">00:14:39.000</a></span> | <span class="t">So we have the input, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=882" target="_blank">00:14:42.200</a></span> | <span class="t">So we said return full text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=886" target="_blank">00:14:46.280</a></span> | <span class="t">So we have the input here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=887" target="_blank">00:14:47.680</a></span> | <span class="t">And then we also have the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=888" target="_blank">00:14:48.760</a></span> | <span class="t">So nuclear fission is a process that splits heavy atoms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=891" target="_blank">00:14:51.440</a></span> | <span class="t">into smaller, lighter ones, so on and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=893" target="_blank">00:14:53.960</a></span> | <span class="t">Nuclear fusion occurs when two light</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=896" target="_blank">00:14:56.720</a></span> | <span class="t">atomic nuclei are combined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=898" target="_blank">00:14:58.840</a></span> | <span class="t">As far as I know, that is correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=901" target="_blank">00:15:01.680</a></span> | <span class="t">So that looks pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=903" target="_blank">00:15:03.440</a></span> | <span class="t">And then I've also added a note here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=905" target="_blank">00:15:05.120</a></span> | <span class="t">on if you'd like to use the Triton optimized implementations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=910" target="_blank">00:15:10.120</a></span> | <span class="t">So Triton in this scenario, as far as I understand,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=914" target="_blank">00:15:14.040</a></span> | <span class="t">is the way that the attention is implemented.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=917" target="_blank">00:15:17.480</a></span> | <span class="t">It can be implemented either in PyTorch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=919" target="_blank">00:15:19.600</a></span> | <span class="t">which is what we're using by default.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=921" target="_blank">00:15:21.800</a></span> | <span class="t">It can be implemented with flash attention or using Triton.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=926" target="_blank">00:15:26.800</a></span> | <span class="t">And if you use Triton, it's gonna use more memory,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=930" target="_blank">00:15:30.560</a></span> | <span class="t">but it will be faster</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=931" target="_blank">00:15:31.640</a></span> | <span class="t">when you're actually performing inference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=933" target="_blank">00:15:33.560</a></span> | <span class="t">So you can do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=934" target="_blank">00:15:34.960</a></span> | <span class="t">The reason I haven't used it here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=936" target="_blank">00:15:36.040</a></span> | <span class="t">is because the install takes just an insanely long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=940" target="_blank">00:15:40.200</a></span> | <span class="t">So I just gave up with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=943" target="_blank">00:15:43.520</a></span> | <span class="t">But as far as I know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=945" target="_blank">00:15:45.400</a></span> | <span class="t">this sort of setup here should work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=947" target="_blank">00:15:47.600</a></span> | <span class="t">So you pip install Triton and you go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=949" target="_blank">00:15:49.960</a></span> | <span class="t">and then this should work, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=952" target="_blank">00:15:52.320</a></span> | <span class="t">Just be wary of that added memory usage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=955" target="_blank">00:15:55.160</a></span> | <span class="t">So yeah, we've seen, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=956" target="_blank">00:15:56.800</a></span> | <span class="t">this is how we're gonna use this in the HuggingFace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=959" target="_blank">00:15:59.600</a></span> | <span class="t">So generating text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=961" target="_blank">00:16:01.440</a></span> | <span class="t">Now let's move on to the LineChain side of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=964" target="_blank">00:16:04.240</a></span> | <span class="t">So how do we implement this in LineChain?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=966" target="_blank">00:16:06.680</a></span> | <span class="t">Okay, so we're gonna use this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=967" target="_blank">00:16:07.960</a></span> | <span class="t">with the simplest chain possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=970" target="_blank">00:16:10.160</a></span> | <span class="t">So the LLM chain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=971" target="_blank">00:16:11.840</a></span> | <span class="t">For the LLM, we're going to initialize it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=973" target="_blank">00:16:13.880</a></span> | <span class="t">via the HuggingFace pipeline,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=975" target="_blank">00:16:15.440</a></span> | <span class="t">which is basically local HuggingFace model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=978" target="_blank">00:16:18.400</a></span> | <span class="t">And for that, we need our pipeline,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=980" target="_blank">00:16:20.400</a></span> | <span class="t">which we have conveniently already initialized up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=983" target="_blank">00:16:23.760</a></span> | <span class="t">So we just pass that into there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=986" target="_blank">00:16:26.840</a></span> | <span class="t">We have our prompt template.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=989" target="_blank">00:16:29.560</a></span> | <span class="t">Okay, nothing, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=991" target="_blank">00:16:31.600</a></span> | <span class="t">It's just the instruction here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=993" target="_blank">00:16:33.560</a></span> | <span class="t">So basically we have some inputs and that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=996" target="_blank">00:16:36.560</a></span> | <span class="t">I'm just defining that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=997" target="_blank">00:16:37.720</a></span> | <span class="t">so that we can define this LLM chain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1000" target="_blank">00:16:40.200</a></span> | <span class="t">Okay, we initialize that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1002" target="_blank">00:16:42.200</a></span> | <span class="t">And then we come down to here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1003" target="_blank">00:16:43.280</a></span> | <span class="t">and we can use the LLM chain to predict.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1006" target="_blank">00:16:46.040</a></span> | <span class="t">And for the prediction,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1007" target="_blank">00:16:47.640</a></span> | <span class="t">we just pass in those instructions again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1010" target="_blank">00:16:50.160</a></span> | <span class="t">Okay, so same question as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1011" target="_blank">00:16:51.800</a></span> | <span class="t">So in this case, we should get pretty much the same answer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1015" target="_blank">00:16:55.360</a></span> | <span class="t">So we can run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1016" target="_blank">00:16:56.880</a></span> | <span class="t">Okay, and the output we get there is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1018" target="_blank">00:16:58.680</a></span> | <span class="t">So as far as I can tell,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1020" target="_blank">00:17:00.600</a></span> | <span class="t">it's pretty much the same as what we got last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1024" target="_blank">00:17:04.600</a></span> | <span class="t">Okay, so looks good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1028" target="_blank">00:17:08.120</a></span> | <span class="t">And with that, we've now implemented MPT7B</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1030" target="_blank">00:17:10.720</a></span> | <span class="t">in both HuggingFace and also LineChain as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1035" target="_blank">00:17:15.120</a></span> | <span class="t">So naturally, if you just want to generate texts,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1038" target="_blank">00:17:18.280</a></span> | <span class="t">you can use HuggingFace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1039" target="_blank">00:17:19.440</a></span> | <span class="t">But obviously, if you want to have access</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1041" target="_blank">00:17:21.160</a></span> | <span class="t">to all of the features that LineChain offers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1044" target="_blank">00:17:24.200</a></span> | <span class="t">all the chains, agents, all this sort of stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1046" target="_blank">00:17:26.840</a></span> | <span class="t">then you obviously just take on this actual set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1050" target="_blank">00:17:30.120</a></span> | <span class="t">and you have your originally HuggingFace pipeline</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1053" target="_blank">00:17:33.840</a></span> | <span class="t">now integrated with LineChain,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1056" target="_blank">00:17:36.480</a></span> | <span class="t">which I think is pretty cool and super easy to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1059" target="_blank">00:17:39.320</a></span> | <span class="t">It's not that difficult.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1060" target="_blank">00:17:40.800</a></span> | <span class="t">So with that, that's the end of this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1063" target="_blank">00:17:43.800</a></span> | <span class="t">We've explored how we can actually begin</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1066" target="_blank">00:17:46.520</a></span> | <span class="t">using open source models in LineChain,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1069" target="_blank">00:17:49.520</a></span> | <span class="t">which I think opens up a lot of opportunities for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1072" target="_blank">00:17:52.600</a></span> | <span class="t">You know, fine tuning models, just using smaller models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1076" target="_blank">00:17:56.720</a></span> | <span class="t">Maybe you don't always need like a big GPT-4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1080" target="_blank">00:18:00.160</a></span> | <span class="t">for all of our use cases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1083" target="_blank">00:18:03.000</a></span> | <span class="t">So I think this is the sort of thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1085" target="_blank">00:18:05.560</a></span> | <span class="t">where we'll see a lot more going forwards,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1087" target="_blank">00:18:07.760</a></span> | <span class="t">a lot more open source, smaller model is being used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1090" target="_blank">00:18:10.840</a></span> | <span class="t">Of course, I still think OpenAI is gonna be used plenty,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1094" target="_blank">00:18:14.240</a></span> | <span class="t">because honestly, in terms of performance,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1096" target="_blank">00:18:16.400</a></span> | <span class="t">there are no open source models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1098" target="_blank">00:18:18.000</a></span> | <span class="t">that are genuinely comparable to GPT-3.5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1102" target="_blank">00:18:22.440</a></span> | <span class="t">or GPT-4 at the moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1104" target="_blank">00:18:24.280</a></span> | <span class="t">You know, maybe going forwards, there will be eventually,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1106" target="_blank">00:18:26.920</a></span> | <span class="t">but right now, we're not quite there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1109" target="_blank">00:18:29.560</a></span> | <span class="t">So yeah, that's it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1111" target="_blank">00:18:31.680</a></span> | <span class="t">I hope all this has been interesting and useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1114" target="_blank">00:18:34.240</a></span> | <span class="t">Thank you very much for watching</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1115" target="_blank">00:18:35.960</a></span> | <span class="t">and I will see you again in the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1117" target="_blank">00:18:37.800</a></span> | <span class="t">Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1118" target="_blank">00:18:38.640</a></span> | <span class="t">(gentle music)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1122" target="_blank">00:18:42.120</a></span> | <span class="t">(gentle music)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1124" target="_blank">00:18:44.720</a></span> | <span class="t">(gentle music)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1127" target="_blank">00:18:47.320</a></span> | <span class="t">(gentle music)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1129" target="_blank">00:18:49.920</a></span> | <span class="t">(gentle music)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=DXpk9K7DgMo&t=1132" target="_blank">00:18:52.500</a></span> | <span class="t">you</span></div></div></body></html>