<html><head><title>Lesson 8 (2019) - Deep Learning from the Foundations</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 8 (2019) - Deep Learning from the Foundations</h2><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg"><img src="https://i.ytimg.com/vi_webp/4u8FxNEDUeg/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=40">0:40</a> Overview<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=312">5:12</a> Bottomup<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=407">6:47</a> Why Swift<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=650">10:50</a> Swift for Tensorflow<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=890">14:50</a> The Game<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1020">17:0</a> Why do this<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1127">18:47</a> Homework<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1182">19:42</a> Remember Part 1<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1261">21:1</a> Three Steps to Training a Good Model<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1390">23:10</a> Reading Papers<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1525">25:25</a> Symbols<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1690">28:10</a> Jupiter Notebooks<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1976">32:56</a> Run Notebook<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2053">34:13</a> Notebook to Script<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2160">36:0</a> Standard Library<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2318">38:38</a> Plot<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2392">39:52</a> Matrix Multiplication<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2676">44:36</a> Removing Python<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2712">45:12</a> Elementwise Addition<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2762">46:2</a> Frobenius Norm<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2930">48:50</a> Recap<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2966">49:26</a> Replace inner loop<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3111">51:51</a> Broadcasting<br><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3425">57:5</a> Columns<br><br><div style="text-align: left;"><a href="./4u8FxNEDUeg.html">Whisper Transcript</a> | <a href="./transcript_4u8FxNEDUeg.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">So, welcome back to part two of what previously was called Practical Deep Learning for Coders,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=8" target="_blank">00:00:08.960</a></span> | <span class="t">but part two is not called that, as you will see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=11" target="_blank">00:00:11.680</a></span> | <span class="t">It's called Deep Learning from the Foundations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=15" target="_blank">00:00:15.680</a></span> | <span class="t">It's lesson eight because it's lesson eight of the full journey, lesson one of part two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=20" target="_blank">00:00:20.440</a></span> | <span class="t">or lesson eight, mod seven, as we sometimes call it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=26" target="_blank">00:00:26.540</a></span> | <span class="t">So those of you, I know a lot of you do every year's course and keep coming back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=30" target="_blank">00:00:30.280</a></span> | <span class="t">For those of you doing that, this will not look at all familiar to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=33" target="_blank">00:00:33.720</a></span> | <span class="t">It's a very different part two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=36" target="_blank">00:00:36.240</a></span> | <span class="t">We're really excited about it and hope you like it as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=40" target="_blank">00:00:40.520</a></span> | <span class="t">The basic idea of deep learning from the foundations is that we are going to implement much of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=46" target="_blank">00:00:46.200</a></span> | <span class="t">the fast AI library from foundations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=49" target="_blank">00:00:49.640</a></span> | <span class="t">Now, talk about exactly what I mean by foundations in a moment, but it basically means from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=55" target="_blank">00:00:55.880</a></span> | <span class="t">So we'll be looking at basic matrix calculus and creating a training loop from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=61" target="_blank">00:01:01.200</a></span> | <span class="t">and creating an optimizer from scratch and lots of different layers and architectures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=65" target="_blank">00:01:05.360</a></span> | <span class="t">and so forth, and not just to create some kind of dumbed down library that's not useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=71" target="_blank">00:01:11.760</a></span> | <span class="t">for anything, but to actually build from scratch something you can train cutting edge world-class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=77" target="_blank">00:01:17.720</a></span> | <span class="t">models with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=79" target="_blank">00:01:19.440</a></span> | <span class="t">So that's the goal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=81" target="_blank">00:01:21.080</a></span> | <span class="t">We've never done it before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=82" target="_blank">00:01:22.080</a></span> | <span class="t">I don't think anybody's ever done this before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=84" target="_blank">00:01:24.500</a></span> | <span class="t">So I don't exactly know how far we'll get, but this is the journey that we're on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=89" target="_blank">00:01:29.360</a></span> | <span class="t">We'll see how we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=90" target="_blank">00:01:30.600</a></span> | <span class="t">So in the process, we will be having to read and implement papers because the fast AI library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=97" target="_blank">00:01:37.040</a></span> | <span class="t">is full of implemented papers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=100" target="_blank">00:01:40.160</a></span> | <span class="t">So you're not going to be able to do this if you're not reading and implementing papers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=104" target="_blank">00:01:44.160</a></span> | <span class="t">Along the way, we'll be implementing much of PyTorch as well, as you'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=112" target="_blank">00:01:52.520</a></span> | <span class="t">We'll also be going deeper into solving some applications that are not kind of fully baked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=120" target="_blank">00:02:00.960</a></span> | <span class="t">into the fast AI library yet, so it's going to require a lot of custom work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=125" target="_blank">00:02:05.720</a></span> | <span class="t">So things like object detection, sequence to sequence with attention, transformer and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=130" target="_blank">00:02:10.680</a></span> | <span class="t">the transform Excel, cycleGAN, audio, stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=137" target="_blank">00:02:17.360</a></span> | <span class="t">We'll also be doing a deeper dive into some performance considerations like doing distributed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=142" target="_blank">00:02:22.200</a></span> | <span class="t">multi-GPU training, using the new just-in-time compiler, which we'll just call JIT from now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=148" target="_blank">00:02:28.560</a></span> | <span class="t">on, CUDA and C++, stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=152" target="_blank">00:02:32.680</a></span> | <span class="t">So that's the first five lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=154" target="_blank">00:02:34.720</a></span> | <span class="t">And then the last two lessons, implementing some subset of that in Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=164" target="_blank">00:02:44.000</a></span> | <span class="t">So this is otherwise known as impractical deep learning for coders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=168" target="_blank">00:02:48.880</a></span> | <span class="t">Because really none of this is stuff that you're going to go and use right away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=172" target="_blank">00:02:52.960</a></span> | <span class="t">It's kind of the opposite of part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=175" target="_blank">00:02:55.520</a></span> | <span class="t">Part one was like, oh, we've been spending 20 minutes on this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=178" target="_blank">00:02:58.160</a></span> | <span class="t">You can now create a world-class vision classification model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=183" target="_blank">00:03:03.960</a></span> | <span class="t">This is not that, because you already know how to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=188" target="_blank">00:03:08.200</a></span> | <span class="t">And so back in the earlier years, part two used to be more of the same thing, but it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=193" target="_blank">00:03:13.520</a></span> | <span class="t">was kind of like more advanced types of model, more advanced architectures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=199" target="_blank">00:03:19.400</a></span> | <span class="t">But there's a couple of reasons we've changed this year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=201" target="_blank">00:03:21.600</a></span> | <span class="t">The first is so many papers come out now, because this whole area has increased in scale</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=208" target="_blank">00:03:28.360</a></span> | <span class="t">so quickly, that I can't pick out for you the 12 papers to do in the next seven weeks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=214" target="_blank">00:03:34.560</a></span> | <span class="t">that you really need to know, because there's too many.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=217" target="_blank">00:03:37.880</a></span> | <span class="t">And it's also kind of pointless, because once you get into it, you realize that all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=221" target="_blank">00:03:41.120</a></span> | <span class="t">papers pretty much say minor variations on the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=226" target="_blank">00:03:46.080</a></span> | <span class="t">So instead, what I want to be able to do is show you the foundations that let you read</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=230" target="_blank">00:03:50.840</a></span> | <span class="t">the 12 papers you care about and realize like, oh, that's just that thing with this minor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=235" target="_blank">00:03:55.800</a></span> | <span class="t">tweak.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=236" target="_blank">00:03:56.800</a></span> | <span class="t">And I now have all the tools I need to implement that and test it and experiment with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=241" target="_blank">00:04:01.340</a></span> | <span class="t">So that's kind of a really key issue in why we want to go in this direction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=249" target="_blank">00:04:09.600</a></span> | <span class="t">Also it's increasingly clear that, you know, we used to call part two cutting edge deep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=254" target="_blank">00:04:14.720</a></span> | <span class="t">learning for coders, but it's increasingly clear that the cutting edge of deep learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=259" target="_blank">00:04:19.120</a></span> | <span class="t">is really about engineering, not about papers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=264" target="_blank">00:04:24.880</a></span> | <span class="t">The difference between really effective people in deep learning and the rest is really about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=269" target="_blank">00:04:29.200</a></span> | <span class="t">who can like make things encode that work properly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=273" target="_blank">00:04:33.820</a></span> | <span class="t">And there's very few of those people.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=276" target="_blank">00:04:36.120</a></span> | <span class="t">So really, the goal of this part two is to deepen your practice so you can understand,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=284" target="_blank">00:04:44.920</a></span> | <span class="t">you know, the things that you care about and build the things you care about and have them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=288" target="_blank">00:04:48.120</a></span> | <span class="t">work and perform at a reasonable speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=293" target="_blank">00:04:53.120</a></span> | <span class="t">So that's where we're trying to head to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=296" target="_blank">00:04:56.200</a></span> | <span class="t">And so it's impractical in the sense that like none of these are things that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=300" target="_blank">00:05:00.200</a></span> | <span class="t">going to go probably straight away and say, here's this thing I built, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=305" target="_blank">00:05:05.340</a></span> | <span class="t">Probably Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=306" target="_blank">00:05:06.340</a></span> | <span class="t">Because Swift, we're actually going to be learning a language in a library that as you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=310" target="_blank">00:05:10.480</a></span> | <span class="t">see is far from ready for use, and I'll describe why we're doing that in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=316" target="_blank">00:05:16.080</a></span> | <span class="t">So part one of this course was top down, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=320" target="_blank">00:05:20.960</a></span> | <span class="t">So that you got the context you needed to understand, you got the motivation you needed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=324" target="_blank">00:05:24.520</a></span> | <span class="t">to keep going, and you got the results you needed to make it useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=329" target="_blank">00:05:29.400</a></span> | <span class="t">But bottom up is useful too.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=330" target="_blank">00:05:30.920</a></span> | <span class="t">And we started doing some bottom up at the end of part one, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=334" target="_blank">00:05:34.980</a></span> | <span class="t">But really bottom up lets you, when you've built everything from the bottom yourself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=341" target="_blank">00:05:41.560</a></span> | <span class="t">then you can see the connections between all the different things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=344" target="_blank">00:05:44.380</a></span> | <span class="t">You can see they're all variations of the same thing, you know?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=347" target="_blank">00:05:47.500</a></span> | <span class="t">And then you can customize, rather than picking algorithm A or algorithm B, you create your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=352" target="_blank">00:05:52.600</a></span> | <span class="t">own algorithm to solve your own problem doing just the things you need it to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=358" target="_blank">00:05:58.040</a></span> | <span class="t">And then you can make sure that it performs well, that you can debug it, profile it, maintain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=365" target="_blank">00:06:05.760</a></span> | <span class="t">it, because you understand all of the pieces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=368" target="_blank">00:06:08.720</a></span> | <span class="t">So normally when people say bottom up in this world, in this field, they mean bottom up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=375" target="_blank">00:06:15.080</a></span> | <span class="t">with math.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=376" target="_blank">00:06:16.880</a></span> | <span class="t">I don't mean that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=378" target="_blank">00:06:18.160</a></span> | <span class="t">I mean bottom up with code, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=380" target="_blank">00:06:20.780</a></span> | <span class="t">So today, step one will be to implement matrix multiplication from scratch in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=390" target="_blank">00:06:30.240</a></span> | <span class="t">Because bottom up with code means that you can experiment really deeply on every part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=396" target="_blank">00:06:36.440</a></span> | <span class="t">of every bit of the system.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=398" target="_blank">00:06:38.360</a></span> | <span class="t">You can see exactly what's going in, exactly what's coming out, and you can figure out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=401" target="_blank">00:06:41.820</a></span> | <span class="t">why your model's not training well, or why it's slow, or why it's giving the wrong answer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=406" target="_blank">00:06:46.200</a></span> | <span class="t">or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=408" target="_blank">00:06:48.440</a></span> | <span class="t">So why Swift?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=411" target="_blank">00:06:51.000</a></span> | <span class="t">What are these two lessons about?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=412" target="_blank">00:06:52.280</a></span> | <span class="t">And be clear, we are only talking the last two lessons, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=415" target="_blank">00:06:55.800</a></span> | <span class="t">You know, our focus, as I'll describe, is still very much Python and PyTorch, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=423" target="_blank">00:07:03.580</a></span> | <span class="t">But there's something very exciting going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=427" target="_blank">00:07:07.320</a></span> | <span class="t">The first exciting thing is this guy's face you see here, Chris Latner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=431" target="_blank">00:07:11.400</a></span> | <span class="t">Chris is unique, as far as I know, as being somebody who has built, I think, what is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=437" target="_blank">00:07:17.320</a></span> | <span class="t">world's most widely used compiler framework, LLVM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=441" target="_blank">00:07:21.920</a></span> | <span class="t">He's built the default C and C++ compiler for Mac, being Clang.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=449" target="_blank">00:07:29.600</a></span> | <span class="t">And he's built what's probably like the world's fastest growing fairly new computer language,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=455" target="_blank">00:07:35.920</a></span> | <span class="t">being Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=457" target="_blank">00:07:37.840</a></span> | <span class="t">And he's now dedicating his life to deep learning, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=462" target="_blank">00:07:42.160</a></span> | <span class="t">So we haven't had somebody from that world come into our world before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=467" target="_blank">00:07:47.040</a></span> | <span class="t">And so when you actually look at stuff like the internals of something like TensorFlow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=473" target="_blank">00:07:53.060</a></span> | <span class="t">it looks like something that was built by a bunch of deep learning people, not by a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=477" target="_blank">00:07:57.080</a></span> | <span class="t">bunch of compiler people, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=479" target="_blank">00:07:59.840</a></span> | <span class="t">And so I've been wanting for over 20 years for there to be a good numerical programming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=487" target="_blank">00:08:07.040</a></span> | <span class="t">language that was built by somebody that really gets programming languages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=492" target="_blank">00:08:12.000</a></span> | <span class="t">And it's never happened, you know?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=494" target="_blank">00:08:14.480</a></span> | <span class="t">So we've had like, in the early days, it was elispstat in LISP, and then it was R and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=501" target="_blank">00:08:21.440</a></span> | <span class="t">it was Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=502" target="_blank">00:08:22.440</a></span> | <span class="t">None of these languages were built to be good at data analysis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=510" target="_blank">00:08:30.400</a></span> | <span class="t">They weren't built by people that really deeply understood compilers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=514" target="_blank">00:08:34.720</a></span> | <span class="t">They certainly weren't built for today's kind of modern, highly parallel processor situation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=520" target="_blank">00:08:40.160</a></span> | <span class="t">we're in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=522" target="_blank">00:08:42.580</a></span> | <span class="t">But Swift was, Swift is, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=524" target="_blank">00:08:44.780</a></span> | <span class="t">And so we've got this unique situation where for the first time, you know, a really widely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=529" target="_blank">00:08:49.960</a></span> | <span class="t">used language, a really well-designed language from the ground up, is actually being targeted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=538" target="_blank">00:08:58.980</a></span> | <span class="t">towards numeric programming and deep learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=541" target="_blank">00:09:01.360</a></span> | <span class="t">So there's no way I'm missing out on that boat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=545" target="_blank">00:09:05.600</a></span> | <span class="t">And I don't want you to miss out on it either.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=549" target="_blank">00:09:09.160</a></span> | <span class="t">I should mention there's another language which you could possibly put in there, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=552" target="_blank">00:09:12.440</a></span> | <span class="t">is a language called Julia, which has maybe as much potential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=557" target="_blank">00:09:17.720</a></span> | <span class="t">But it's, you know, it's about ten times less used than Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=562" target="_blank">00:09:22.200</a></span> | <span class="t">It doesn't have the same level of community.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=564" target="_blank">00:09:24.880</a></span> | <span class="t">But I would still say it's super exciting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=566" target="_blank">00:09:26.280</a></span> | <span class="t">So I'd say, like, maybe there's two languages which you might want to seriously consider</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=571" target="_blank">00:09:31.720</a></span> | <span class="t">picking one and spending some time with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=576" target="_blank">00:09:36.080</a></span> | <span class="t">Julia is actually further along.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=578" target="_blank">00:09:38.600</a></span> | <span class="t">Swift is very early days in this world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=580" target="_blank">00:09:40.400</a></span> | <span class="t">But that's one of the things I'm excited about for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=582" target="_blank">00:09:42.780</a></span> | <span class="t">So I actually spent some time over the Christmas break kind of digging into numeric programming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=589" target="_blank">00:09:49.480</a></span> | <span class="t">in Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=590" target="_blank">00:09:50.920</a></span> | <span class="t">And I was delighted to find that I could create code from scratch that was competitive with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=600" target="_blank">00:10:00.520</a></span> | <span class="t">the fastest hand-tuned vendor linear algebra libraries, even though I am -- was and remain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=609" target="_blank">00:10:09.880</a></span> | <span class="t">pretty incompetent at Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=611" target="_blank">00:10:11.640</a></span> | <span class="t">I found it was a language that, you know, was really delightful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=615" target="_blank">00:10:15.120</a></span> | <span class="t">It was expressive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=616" target="_blank">00:10:16.120</a></span> | <span class="t">It was concise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=617" target="_blank">00:10:17.120</a></span> | <span class="t">But it was also very performant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=618" target="_blank">00:10:18.760</a></span> | <span class="t">And I could write everything in Swift, you know, rather than having to kind of get to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=624" target="_blank">00:10:24.160</a></span> | <span class="t">some layer where it's like, oh, that's crude DNN now or that's MKL now or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=629" target="_blank">00:10:29.080</a></span> | <span class="t">So that got me pretty enthusiastic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=634" target="_blank">00:10:34.080</a></span> | <span class="t">And so the really exciting news, as I'm sure you've heard, is that Chris Latner himself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=639" target="_blank">00:10:39.720</a></span> | <span class="t">is going to come and join us for the last two lessons, and we're going to teach Swift</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=645" target="_blank">00:10:45.200</a></span> | <span class="t">for deep learning together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=648" target="_blank">00:10:48.520</a></span> | <span class="t">So Swift for deep learning means Swift for TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=653" target="_blank">00:10:53.360</a></span> | <span class="t">That's specifically the library that Chris and his team at Google are working on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=661" target="_blank">00:11:01.480</a></span> | <span class="t">We will call that S for TF when I write it down because I couldn't be bothered typing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=664" target="_blank">00:11:04.840</a></span> | <span class="t">Swift for TensorFlow every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=667" target="_blank">00:11:07.920</a></span> | <span class="t">Swift for TensorFlow has some pros and cons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=672" target="_blank">00:11:12.960</a></span> | <span class="t">PyTorch has some pros and cons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=675" target="_blank">00:11:15.400</a></span> | <span class="t">And interestingly, they're the opposite of each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=679" target="_blank">00:11:19.800</a></span> | <span class="t">PyTorch and Python's pros are you can get stuff done right now with this amazing ecosystem,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=687" target="_blank">00:11:27.840</a></span> | <span class="t">fantastic documentation and tutorials.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=690" target="_blank">00:11:30.800</a></span> | <span class="t">You know, it's just a really great practical system for solving problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=698" target="_blank">00:11:38.440</a></span> | <span class="t">And to be clear, Swift for TensorFlow is not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=702" target="_blank">00:11:42.040</a></span> | <span class="t">It's not any of those things right now, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=704" target="_blank">00:11:44.160</a></span> | <span class="t">It's really early.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=707" target="_blank">00:11:47.280</a></span> | <span class="t">Almost nothing works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=709" target="_blank">00:11:49.280</a></span> | <span class="t">You have to learn a whole new language if you don't know Swift already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=712" target="_blank">00:11:52.480</a></span> | <span class="t">There's very little ecosystem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=713" target="_blank">00:11:53.880</a></span> | <span class="t">Now, I'm not sure about Swift in particular, but the kind of Swift for TensorFlow and Swift</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=718" target="_blank">00:11:58.640</a></span> | <span class="t">for deep learning and even Swift for numeric programming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=721" target="_blank">00:12:01.360</a></span> | <span class="t">I was kind of surprised when I got into it to find there was hardly any documentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=726" target="_blank">00:12:06.480</a></span> | <span class="t">about Swift for numeric programming, even though I was pretty delighted by the experience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=731" target="_blank">00:12:11.960</a></span> | <span class="t">People have had this view that Swift is kind of for iPhone programming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=738" target="_blank">00:12:18.400</a></span> | <span class="t">I guess that's kind of how it was marketed, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=740" target="_blank">00:12:20.840</a></span> | <span class="t">But actually it's an incredibly well-designed, incredibly powerful language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=747" target="_blank">00:12:27.680</a></span> | <span class="t">And then TensorFlow, I mean, to be honest, I'm not a huge fan of TensorFlow in general.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=753" target="_blank">00:12:33.600</a></span> | <span class="t">I mean, if I was, we wouldn't have switched away from it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=757" target="_blank">00:12:37.000</a></span> | <span class="t">But it's getting a lot better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=758" target="_blank">00:12:38.880</a></span> | <span class="t">TensorFlow 2 is certainly improving.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=762" target="_blank">00:12:42.520</a></span> | <span class="t">And the bits of it I particularly don't like are largely the bits that Swift for TensorFlow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=767" target="_blank">00:12:47.120</a></span> | <span class="t">will avoid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=768" target="_blank">00:12:48.120</a></span> | <span class="t">But I think long-term, the kind of things I see happening, like there's this fantastic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=774" target="_blank">00:12:54.200</a></span> | <span class="t">new kind of compiler project called MLIR, which Chris is also co-leading, which I think actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=781" target="_blank">00:13:01.400</a></span> | <span class="t">has the potential long-term to allow Swift to replace most of the yucky bits or maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=787" target="_blank">00:13:07.520</a></span> | <span class="t">even all of the yucky bits of TensorFlow with stuff where Swift is actually talking directly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=791" target="_blank">00:13:11.920</a></span> | <span class="t">to LLVM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=793" target="_blank">00:13:13.800</a></span> | <span class="t">You'll be hearing a lot more about LLVM in the coming, in the last two weeks, the last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=797" target="_blank">00:13:17.560</a></span> | <span class="t">two lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=798" target="_blank">00:13:18.560</a></span> | <span class="t">Basically, it's the compiler infrastructure that kind of everybody uses, that Julia uses,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=806" target="_blank">00:13:26.680</a></span> | <span class="t">that Clang uses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=808" target="_blank">00:13:28.920</a></span> | <span class="t">And Swift is this kind of almost this thin layer on top of it, where when you write stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=814" target="_blank">00:13:34.400</a></span> | <span class="t">in Swift, it's really easy for LLVM to compile it down to super-fast optimized code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=823" target="_blank">00:13:43.640</a></span> | <span class="t">Which is like the opposite of Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=826" target="_blank">00:13:46.120</a></span> | <span class="t">With Python, as you'll see today, we almost never actually write Python code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=831" target="_blank">00:13:51.880</a></span> | <span class="t">We write code in Python that gets turned into some other language or library, and that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=836" target="_blank">00:13:56.960</a></span> | <span class="t">what gets run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=838" target="_blank">00:13:58.560</a></span> | <span class="t">And this mismatch, this impedance mismatch between what I'm trying to write and what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=843" target="_blank">00:14:03.680</a></span> | <span class="t">actually gets run makes it very hard to do the kind of deep dives that we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=847" target="_blank">00:14:07.600</a></span> | <span class="t">do in this course, as you'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=851" target="_blank">00:14:11.280</a></span> | <span class="t">It's kind of a frustrating experience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=854" target="_blank">00:14:14.760</a></span> | <span class="t">So I'm excited about getting involved in these very early days for impractical deep learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=860" target="_blank">00:14:20.440</a></span> | <span class="t">in Swift for TensorFlow, because it means that me and those of you that want to follow along</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=867" target="_blank">00:14:27.080</a></span> | <span class="t">can be the pioneers in something that I think is going to take over this field.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=874" target="_blank">00:14:34.000</a></span> | <span class="t">We'll be the first in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=875" target="_blank">00:14:35.320</a></span> | <span class="t">We'll be the ones that understand it really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=877" target="_blank">00:14:37.960</a></span> | <span class="t">And in your portfolio, you can actually point at things and say, "That library that everybody</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=882" target="_blank">00:14:42.080</a></span> | <span class="t">is, I wrote that."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=884" target="_blank">00:14:44.440</a></span> | <span class="t">This piece of documentation that's like on the Swift for TensorFlow website, I wrote that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=889" target="_blank">00:14:49.040</a></span> | <span class="t">That's the opportunity that you have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=891" target="_blank">00:14:51.700</a></span> | <span class="t">So let's put that aside for the next five weeks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=897" target="_blank">00:14:57.600</a></span> | <span class="t">And let's try to create a really high bar for the Swift for TensorFlow team to have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=903" target="_blank">00:15:03.720</a></span> | <span class="t">try to re-implement before six weeks' time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=906" target="_blank">00:15:06.760</a></span> | <span class="t">We're going to try to implement as much of fast AI and many parts of PyTorch as we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=911" target="_blank">00:15:11.880</a></span> | <span class="t">and then see if the Swift for TensorFlow team can help us build that in Swift in five weeks'</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=918" target="_blank">00:15:18.320</a></span> | <span class="t">time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=919" target="_blank">00:15:19.320</a></span> | <span class="t">So the goal is to recreate fast AI from the foundations and much of PyTorch like matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=926" target="_blank">00:15:26.200</a></span> | <span class="t">multiplication, a lot of torch.nn, torch.optm, dataset, data loader from the foundations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=934" target="_blank">00:15:34.040</a></span> | <span class="t">And this is the game we're going to play.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=935" target="_blank">00:15:35.880</a></span> | <span class="t">The game we're going to play is we're only allowed to use these bits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=939" target="_blank">00:15:39.000</a></span> | <span class="t">We're allowed to use pure Python, anything in the Python standard library, any non-data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=945" target="_blank">00:15:45.920</a></span> | <span class="t">science modules, so like a requests library for HTTP or whatever, we can use PyTorch but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=953" target="_blank">00:15:53.000</a></span> | <span class="t">only for creating arrays, random number generation, and indexing into arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=960" target="_blank">00:16:00.440</a></span> | <span class="t">We can use the fastai.datasets library because that's the thing that has access to like MNIST</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=964" target="_blank">00:16:04.440</a></span> | <span class="t">and stuff, so we don't have to worry about writing our own HTTP stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=968" target="_blank">00:16:08.480</a></span> | <span class="t">And we can use matplotlib.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=969" target="_blank">00:16:09.480</a></span> | <span class="t">We don't have to write our own plotting library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=971" target="_blank">00:16:11.800</a></span> | <span class="t">That's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=972" target="_blank">00:16:12.800</a></span> | <span class="t">That's the game.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=973" target="_blank">00:16:13.800</a></span> | <span class="t">So we're going to try and recreate all of this from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=978" target="_blank">00:16:18.440</a></span> | <span class="t">And then the rules are that each time we have replicated some piece of fastai or PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=984" target="_blank">00:16:24.560</a></span> | <span class="t">from the foundations, we can then use the real version if we want to, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=990" target="_blank">00:16:30.560</a></span> | <span class="t">So that's the game we're going to play.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=994" target="_blank">00:16:34.240</a></span> | <span class="t">What I've discovered as I started doing that is that I started actually making things a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=997" target="_blank">00:16:37.680</a></span> | <span class="t">lot better than fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=999" target="_blank">00:16:39.840</a></span> | <span class="t">So I'm now realizing that fastai version 1 is kind of a disappointment because there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1003" target="_blank">00:16:43.720</a></span> | <span class="t">was a whole lot of things I could have done better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1005" target="_blank">00:16:45.960</a></span> | <span class="t">And so you'll find the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1007" target="_blank">00:16:47.600</a></span> | <span class="t">As you go along this journey, you'll find decisions that I made or the PyTorch teammate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1011" target="_blank">00:16:51.480</a></span> | <span class="t">or whatever where you think, what if they'd made a different decision there?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1015" target="_blank">00:16:55.880</a></span> | <span class="t">And you can maybe come up with more examples of things that we could do differently, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1022" target="_blank">00:17:02.680</a></span> | <span class="t">So why would you do this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1023" target="_blank">00:17:03.960</a></span> | <span class="t">Well, the main reason is so that you can really experiment, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1028" target="_blank">00:17:08.320</a></span> | <span class="t">So you can really understand what's going on in your models, what's really going on in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1031" target="_blank">00:17:11.480</a></span> | <span class="t">your training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1033" target="_blank">00:17:13.000</a></span> | <span class="t">And you'll actually find that in the experiments that we're going to do in the next couple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1037" target="_blank">00:17:17.400</a></span> | <span class="t">of classes, we're going to actually come up with some new insights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1042" target="_blank">00:17:22.600</a></span> | <span class="t">If you can create something from scratch yourself, you know that you understand it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1048" target="_blank">00:17:28.160</a></span> | <span class="t">And then once you've created something from scratch and you really understand it, then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1050" target="_blank">00:17:30.920</a></span> | <span class="t">you can tweak everything, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1052" target="_blank">00:17:32.840</a></span> | <span class="t">But you suddenly realize that there's not this object detection system and this confident</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1058" target="_blank">00:17:38.840</a></span> | <span class="t">architecture and that optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1061" target="_blank">00:17:41.640</a></span> | <span class="t">They're all like a kind of semi-arbitrary bunch of particular knobs and choices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1067" target="_blank">00:17:47.040</a></span> | <span class="t">And that it's pretty likely that your particular problem would want a different set of knobs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1071" target="_blank">00:17:51.960</a></span> | <span class="t">and choices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1073" target="_blank">00:17:53.080</a></span> | <span class="t">So you can change all of these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1077" target="_blank">00:17:57.120</a></span> | <span class="t">For those of you looking to contribute to open source, to fast AI or to PyTorch, you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1083" target="_blank">00:18:03.040</a></span> | <span class="t">be able to, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1084" target="_blank">00:18:04.640</a></span> | <span class="t">Because you'll understand how it's all built up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1086" target="_blank">00:18:06.320</a></span> | <span class="t">You'll understand what bits are working well, which bits need help.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1089" target="_blank">00:18:09.560</a></span> | <span class="t">You know how to contribute tests or documentation or new features or create your own libraries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1097" target="_blank">00:18:17.200</a></span> | <span class="t">And for those of you interested in going deeper into research, you'll be implementing papers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1103" target="_blank">00:18:23.280</a></span> | <span class="t">which means you'll be able to correlate the code that you're writing with the paper that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1107" target="_blank">00:18:27.160</a></span> | <span class="t">you're reading.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1108" target="_blank">00:18:28.160</a></span> | <span class="t">And if you're a poor mathematician like I am, then you'll find that you'll be getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1113" target="_blank">00:18:33.720</a></span> | <span class="t">a much better understanding of papers that you might otherwise have thought were beyond</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1118" target="_blank">00:18:38.360</a></span> | <span class="t">you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1119" target="_blank">00:18:39.360</a></span> | <span class="t">And you realize that all those Greek symbols actually just map to pieces of code that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1124" target="_blank">00:18:44.120</a></span> | <span class="t">already very familiar with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1128" target="_blank">00:18:48.080</a></span> | <span class="t">So there are a lot of opportunities in part one to blog and to do interesting things,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1135" target="_blank">00:18:55.240</a></span> | <span class="t">but the opportunities are much greater now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1137" target="_blank">00:18:57.160</a></span> | <span class="t">In part two, you can be doing homework that's actually at the cutting edge, actually doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1142" target="_blank">00:19:02.080</a></span> | <span class="t">experiments people haven't done before, making observations people haven't made before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1146" target="_blank">00:19:06.800</a></span> | <span class="t">Because you're getting to the point where you're a more competent deep learning practitioner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1152" target="_blank">00:19:12.560</a></span> | <span class="t">than the vast majority that are out there, and we're looking at stuff that other people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1156" target="_blank">00:19:16.960</a></span> | <span class="t">haven't looked at before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1157" target="_blank">00:19:17.960</a></span> | <span class="t">So please try doing lots of experiments, particularly in your domain area, and consider writing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1166" target="_blank">00:19:26.880</a></span> | <span class="t">things down, especially if it's not perfect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1172" target="_blank">00:19:32.080</a></span> | <span class="t">So write stuff down for the you of six months ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1178" target="_blank">00:19:38.880</a></span> | <span class="t">That's your audience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1180" target="_blank">00:19:40.720</a></span> | <span class="t">Okay, so I am going to be assuming that you remember the contents of part one, which was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1191" target="_blank">00:19:51.520</a></span> | <span class="t">these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1192" target="_blank">00:19:52.520</a></span> | <span class="t">Here's the contents of part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1195" target="_blank">00:19:55.200</a></span> | <span class="t">In practice, it's very unlikely you remember all of these things because nobody's perfect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1200" target="_blank">00:20:00.480</a></span> | <span class="t">So what I'm actually expecting you to do is as I'm going on about something which you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1205" target="_blank">00:20:05.040</a></span> | <span class="t">thinking I don't know what he's talking about, that you'll go back and watch the video about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1210" target="_blank">00:20:10.680</a></span> | <span class="t">that thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1212" target="_blank">00:20:12.020</a></span> | <span class="t">Don't just keep blasting forwards, because I'm assuming that you already know the content</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1217" target="_blank">00:20:17.200</a></span> | <span class="t">of part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1219" target="_blank">00:20:19.280</a></span> | <span class="t">Particularly if you're less confident about the second half of part one, where we went</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1224" target="_blank">00:20:24.040</a></span> | <span class="t">a little bit deeper into what's an activation, and what's a parameter really, and exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1228" target="_blank">00:20:28.680</a></span> | <span class="t">how does SGD work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1230" target="_blank">00:20:30.360</a></span> | <span class="t">Particularly in today's lesson, I'm going to assume that you really get that stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1236" target="_blank">00:20:36.400</a></span> | <span class="t">So if you don't, then go back and re-look at those videos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1242" target="_blank">00:20:42.020</a></span> | <span class="t">Go back to that SGD from scratch and take your time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1247" target="_blank">00:20:47.600</a></span> | <span class="t">I've kind of designed this course to keep most people busy up until the next course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1255" target="_blank">00:20:55.720</a></span> | <span class="t">So feel free to take your time and dig deeply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1262" target="_blank">00:21:02.040</a></span> | <span class="t">So the most important thing, though, is we're going to try and make sure that you can train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1265" target="_blank">00:21:05.960</a></span> | <span class="t">really good models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1267" target="_blank">00:21:07.780</a></span> | <span class="t">And there are three steps to training a really good model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1271" target="_blank">00:21:11.560</a></span> | <span class="t">Step one is to create something with way more capacity you need, and basically no regularization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1278" target="_blank">00:21:18.320</a></span> | <span class="t">and overfit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1280" target="_blank">00:21:20.140</a></span> | <span class="t">So overfit means what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1283" target="_blank">00:21:23.320</a></span> | <span class="t">It means that your training loss is lower than your validation loss?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1289" target="_blank">00:21:29.640</a></span> | <span class="t">No.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1290" target="_blank">00:21:30.640</a></span> | <span class="t">No, it doesn't mean that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1291" target="_blank">00:21:31.960</a></span> | <span class="t">Remember, it doesn't mean that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1293" target="_blank">00:21:33.840</a></span> | <span class="t">A well-fit model will almost always have training loss lower than the validation loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1300" target="_blank">00:21:40.000</a></span> | <span class="t">Remember that overfit means you have actually personally seen your validation error getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1305" target="_blank">00:21:45.200</a></span> | <span class="t">worse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1306" target="_blank">00:21:46.200</a></span> | <span class="t">Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1307" target="_blank">00:21:47.200</a></span> | <span class="t">Until you see that happening, you're not overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1309" target="_blank">00:21:49.360</a></span> | <span class="t">So step one is overfit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1311" target="_blank">00:21:51.280</a></span> | <span class="t">And then step two is reduce overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1314" target="_blank">00:21:54.520</a></span> | <span class="t">And then step three, okay, there is no step three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1317" target="_blank">00:21:57.640</a></span> | <span class="t">Well, I guess step three is to visualize the inputs and outputs and stuff like that, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1321" target="_blank">00:22:01.960</a></span> | <span class="t">That is to experiment and see what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1325" target="_blank">00:22:05.640</a></span> | <span class="t">So one is pretty easy normally, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1330" target="_blank">00:22:10.660</a></span> | <span class="t">Two is the hard bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1332" target="_blank">00:22:12.560</a></span> | <span class="t">It's not really that hard, but it's basically these are the five things that you can do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1338" target="_blank">00:22:18.080</a></span> | <span class="t">in order of priority.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1339" target="_blank">00:22:19.320</a></span> | <span class="t">If you can get more data, you should.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1341" target="_blank">00:22:21.560</a></span> | <span class="t">If you can do more data augmentation, you should.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1344" target="_blank">00:22:24.000</a></span> | <span class="t">If you can use a more generalizable architecture, you should.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1347" target="_blank">00:22:27.040</a></span> | <span class="t">And then if all those things are done, then you can start adding regularization like drop-out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1351" target="_blank">00:22:31.920</a></span> | <span class="t">or weight decay, but remember, at that point, you're reducing the effective capacity of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1361" target="_blank">00:22:41.080</a></span> | <span class="t">your model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1362" target="_blank">00:22:42.080</a></span> | <span class="t">So it's less good than the first three things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1364" target="_blank">00:22:44.240</a></span> | <span class="t">And then last of all, reduce the architecture complexity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1368" target="_blank">00:22:48.920</a></span> | <span class="t">And most people, most beginners especially, start with reducing the complexity of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1374" target="_blank">00:22:54.680</a></span> | <span class="t">architecture, but that should be the last thing that you try.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1378" target="_blank">00:22:58.440</a></span> | <span class="t">Unless your architecture is so complex that it's too slow for your problem, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1384" target="_blank">00:23:04.400</a></span> | <span class="t">So that's kind of a summary of what we want to be able to do that we learned about in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1389" target="_blank">00:23:09.080</a></span> | <span class="t">part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1391" target="_blank">00:23:11.880</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1394" target="_blank">00:23:14.560</a></span> | <span class="t">So we're going to be reading papers, which we didn't really do in part one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1398" target="_blank">00:23:18.680</a></span> | <span class="t">And papers look something like this, which if you're anything like me, that's terrifying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1405" target="_blank">00:23:25.320</a></span> | <span class="t">But I'm not going to lie, it's still the case that when I start looking at a new paper,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1410" target="_blank">00:23:30.520</a></span> | <span class="t">every single time I think I'm not smart enough to understand this, I just can't get past</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1417" target="_blank">00:23:37.880</a></span> | <span class="t">that immediate reaction because I just look at this stuff and I just go, that's not something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1422" target="_blank">00:23:42.800</a></span> | <span class="t">that I understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1423" target="_blank">00:23:43.800</a></span> | <span class="t">But then I remember, this is the Adam paper, and you've all seen Adam implemented in one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1429" target="_blank">00:23:49.540</a></span> | <span class="t">cell of Microsoft Excel, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1433" target="_blank">00:23:53.320</a></span> | <span class="t">When it actually comes down to it, every time I do get to the point where I understand if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1437" target="_blank">00:23:57.520</a></span> | <span class="t">I've implemented a paper, I go, oh my God, that's all it is, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1443" target="_blank">00:24:03.100</a></span> | <span class="t">So a big part of reading papers, especially if you're less mathematically inclined than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1447" target="_blank">00:24:07.720</a></span> | <span class="t">I am, is just getting past the fear of the Greek letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1454" target="_blank">00:24:14.280</a></span> | <span class="t">I'll say something else about Greek letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1456" target="_blank">00:24:16.920</a></span> | <span class="t">There are lots of them, right? And it's very hard to read something that you can't actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1464" target="_blank">00:24:24.160</a></span> | <span class="t">pronounce, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1465" target="_blank">00:24:25.800</a></span> | <span class="t">Because you're just saying to yourself, oh, squiggle bracket one plus squiggle one, G</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1470" target="_blank">00:24:30.040</a></span> | <span class="t">squiggle one minus squiggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1471" target="_blank">00:24:31.920</a></span> | <span class="t">And it's like all the squiggles, you just get lost, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1474" target="_blank">00:24:34.520</a></span> | <span class="t">So believe it or not, it actually really helps to go and learn the Greek alphabet so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1480" target="_blank">00:24:40.160</a></span> | <span class="t">can pronounce alpha times one plus beta one, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1485" target="_blank">00:24:45.320</a></span> | <span class="t">Whenever you can start talking to other people about it, you can actually read it out loud.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1489" target="_blank">00:24:49.440</a></span> | <span class="t">It makes a big difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1490" target="_blank">00:24:50.940</a></span> | <span class="t">So learn to pronounce the Greek letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1494" target="_blank">00:24:54.400</a></span> | <span class="t">Note that the people that write these papers are generally not selected for their outstanding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1499" target="_blank">00:24:59.720</a></span> | <span class="t">clarity of communication, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1502" target="_blank">00:25:02.860</a></span> | <span class="t">So you will often find that there'll be a blog post or a tutorial that does a better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1508" target="_blank">00:25:08.880</a></span> | <span class="t">job of explaining the concept than the paper does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1511" target="_blank">00:25:11.960</a></span> | <span class="t">So don't be afraid to go and look for those as well, but do go back to the paper, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1516" target="_blank">00:25:16.560</a></span> | <span class="t">Because in the end, the paper's the one that's hopefully got it mainly right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1522" target="_blank">00:25:22.680</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1526" target="_blank">00:25:26.080</a></span> | <span class="t">One of the tricky things about reading papers is the equations have symbols and you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1530" target="_blank">00:25:30.200</a></span> | <span class="t">know what they mean and you can't Google for them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1533" target="_blank">00:25:33.760</a></span> | <span class="t">So a couple of good resources, if you see symbols you don't recognize, Wikipedia has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1539" target="_blank">00:25:39.480</a></span> | <span class="t">an excellent list of mathematical symbols page that you can scroll through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1544" target="_blank">00:25:44.800</a></span> | <span class="t">And even better, de-techify is a website where you can draw a symbol you don't recognize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1551" target="_blank">00:25:51.040</a></span> | <span class="t">and it uses the power of machine learning to find similar symbols.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1557" target="_blank">00:25:57.200</a></span> | <span class="t">There are lots of symbols that look a bit the same, so you will have to use some level</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1560" target="_blank">00:26:00.140</a></span> | <span class="t">of judgment, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1561" target="_blank">00:26:01.680</a></span> | <span class="t">But the thing that it shows here is the LaTeX name and you can then Google for the LaTeX</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1567" target="_blank">00:26:07.240</a></span> | <span class="t">name to find out what that thing means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1572" target="_blank">00:26:12.080</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1574" target="_blank">00:26:14.320</a></span> | <span class="t">So let's start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1580" target="_blank">00:26:20.640</a></span> | <span class="t">Here's what we're going to do over the next couple of lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1584" target="_blank">00:26:24.040</a></span> | <span class="t">We're going to try to create a pretty competent modern CNN model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1591" target="_blank">00:26:31.960</a></span> | <span class="t">And we actually already have this bit because we did that in the last course, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1599" target="_blank">00:26:39.840</a></span> | <span class="t">We already have our layers for creating a ResNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1602" target="_blank">00:26:42.180</a></span> | <span class="t">We actually got a pretty good result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1604" target="_blank">00:26:44.720</a></span> | <span class="t">So we just have to do all these things, okay, to get us from here to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1611" target="_blank">00:26:51.680</a></span> | <span class="t">This is just the next couple of lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1613" target="_blank">00:26:53.080</a></span> | <span class="t">After that we're going to go a lot further, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1616" target="_blank">00:26:56.920</a></span> | <span class="t">So today we're going to try to get to at least the point where we've got the backward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1620" target="_blank">00:27:00.720</a></span> | <span class="t">pass going, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1622" target="_blank">00:27:02.120</a></span> | <span class="t">So remember, we're going to build a model that takes an input array and we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1627" target="_blank">00:27:07.280</a></span> | <span class="t">to try and create a simple, fully connected network, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1630" target="_blank">00:27:10.240</a></span> | <span class="t">So it's going to have one hidden layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1632" target="_blank">00:27:12.360</a></span> | <span class="t">So we're going to start with some input, do a matrix multiply, do a value, do a matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1637" target="_blank">00:27:17.440</a></span> | <span class="t">multiply, do a loss function, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1641" target="_blank">00:27:21.200</a></span> | <span class="t">And so that's a forward pass and that'll tell us our loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1644" target="_blank">00:27:24.960</a></span> | <span class="t">And then we will calculate the gradients of the weights and biases with respect to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1652" target="_blank">00:27:32.520</a></span> | <span class="t">weights and biases in order to basically multiply them by some learning rate, which we will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1658" target="_blank">00:27:38.520</a></span> | <span class="t">then subtract off the parameters to get our new set of parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1663" target="_blank">00:27:43.120</a></span> | <span class="t">And we'll repeat that lots of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1666" target="_blank">00:27:46.280</a></span> | <span class="t">So to get to our fully connected backward pass, we will need to first of all have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1671" target="_blank">00:27:51.680</a></span> | <span class="t">fully connected forward pass and the fully connected forward pass means we will need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1675" target="_blank">00:27:55.480</a></span> | <span class="t">to have some initialized parameters and we'll need a value and we will also need to be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1681" target="_blank">00:28:01.440</a></span> | <span class="t">to do matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1684" target="_blank">00:28:04.660</a></span> | <span class="t">So let's start there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1691" target="_blank">00:28:11.440</a></span> | <span class="t">So let's start at 00 exports notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1699" target="_blank">00:28:19.600</a></span> | <span class="t">And what I'm showing you here is how I'm going to go about building up our library in Jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1706" target="_blank">00:28:26.700</a></span> | <span class="t">notebooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1708" target="_blank">00:28:28.580</a></span> | <span class="t">A lot of very smart people have assured me that it is impossible to do effective library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1716" target="_blank">00:28:36.080</a></span> | <span class="t">development in Jupyter notebooks, which is a shame because I've built a library in Jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1721" target="_blank">00:28:41.760</a></span> | <span class="t">notebooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1723" target="_blank">00:28:43.440</a></span> | <span class="t">So anyway, people will often tell you things are impossible, but I will tell you my point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1727" target="_blank">00:28:47.920</a></span> | <span class="t">of view, which is that I've been programming for over 30 years and in the time I've been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1735" target="_blank">00:28:55.560</a></span> | <span class="t">using Jupyter notebooks to do my development, I would guess I'm about two to three times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1740" target="_blank">00:29:00.160</a></span> | <span class="t">more productive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1742" target="_blank">00:29:02.160</a></span> | <span class="t">I've built a lot more useful stuff in the last two or three years than I did beforehand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1748" target="_blank">00:29:08.640</a></span> | <span class="t">I'm not saying you have to do things this way either, but this is how I develop and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1754" target="_blank">00:29:14.280</a></span> | <span class="t">hopefully you find some of this useful as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1756" target="_blank">00:29:16.840</a></span> | <span class="t">So I'll show you how.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1760" target="_blank">00:29:20.880</a></span> | <span class="t">We need to do a couple of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1762" target="_blank">00:29:22.400</a></span> | <span class="t">We can't just create one giant notebook with our whole library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1766" target="_blank">00:29:26.360</a></span> | <span class="t">Somehow we have to be able to pull out those little gems, those bits of code where we think,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1771" target="_blank">00:29:31.280</a></span> | <span class="t">oh, this is good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1772" target="_blank">00:29:32.520</a></span> | <span class="t">Let's keep this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1773" target="_blank">00:29:33.520</a></span> | <span class="t">We have to be able to pull that out into a package that we reuse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1777" target="_blank">00:29:37.520</a></span> | <span class="t">So in order to tell our system that here is a cell that I want you to keep and reuse,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1784" target="_blank">00:29:44.480</a></span> | <span class="t">I use this special comment, hash export at the top of the cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1790" target="_blank">00:29:50.200</a></span> | <span class="t">And then I have a program called notebook to script, which goes through the notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1796" target="_blank">00:29:56.800</a></span> | <span class="t">and finds those cells and puts them into a Python module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1802" target="_blank">00:30:02.520</a></span> | <span class="t">So let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1803" target="_blank">00:30:03.640</a></span> | <span class="t">So if I run this cell, okay, so if I run this cell and then I head over and notice I don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1812" target="_blank">00:30:12.640</a></span> | <span class="t">have to type all of exports because I have tab completion, even for file names in jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1819" target="_blank">00:30:19.240</a></span> | <span class="t">notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1820" target="_blank">00:30:20.240</a></span> | <span class="t">So tab is enough and I could either run this here or I could go back to my console and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1828" target="_blank">00:30:28.200</a></span> | <span class="t">run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1829" target="_blank">00:30:29.200</a></span> | <span class="t">So let's run it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1830" target="_blank">00:30:30.560</a></span> | <span class="t">Okay, so that says converted exports.ipanb to nb00.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1836" target="_blank">00:30:36.640</a></span> | <span class="t">And what I've done is I've made it so that these things go into a directory called exp</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1840" target="_blank">00:30:40.920</a></span> | <span class="t">for exported modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1843" target="_blank">00:30:43.320</a></span> | <span class="t">And here is that nb00.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1846" target="_blank">00:30:46.360</a></span> | <span class="t">And there it is, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1847" target="_blank">00:30:47.360</a></span> | <span class="t">So you can see other than a standard header, it's got the contents of that one cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1852" target="_blank">00:30:52.240</a></span> | <span class="t">So now I can import that at the top of my next notebook from exp nb00 import star.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1861" target="_blank">00:31:01.560</a></span> | <span class="t">And I can create a test that that variable equals that value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1867" target="_blank">00:31:07.960</a></span> | <span class="t">So let's see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1870" target="_blank">00:31:10.900</a></span> | <span class="t">It does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1871" target="_blank">00:31:11.900</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1872" target="_blank">00:31:12.900</a></span> | <span class="t">And notice there's a lot of test frameworks around, but it's not always helpful to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1878" target="_blank">00:31:18.480</a></span> | <span class="t">them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1879" target="_blank">00:31:19.480</a></span> | <span class="t">Like here we've created a test framework or the start of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1883" target="_blank">00:31:23.880</a></span> | <span class="t">I've created a function called test, which checks whether A and B return true or false</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1889" target="_blank">00:31:29.720</a></span> | <span class="t">based on this comparison function by using assert.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1894" target="_blank">00:31:34.460</a></span> | <span class="t">And then I've created something called test equals, which calls test passing in A and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1898" target="_blank">00:31:38.840</a></span> | <span class="t">B and operated dot equals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1901" target="_blank">00:31:41.360</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1902" target="_blank">00:31:42.360</a></span> | <span class="t">So if they're wrong, assertion error equals test, test one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1909" target="_blank">00:31:49.960</a></span> | <span class="t">Whoops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1910" target="_blank">00:31:50.960</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1911" target="_blank">00:31:51.960</a></span> | <span class="t">So we've been able to write a test, which so far has basically tested that our little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1915" target="_blank">00:31:55.960</a></span> | <span class="t">module exporter thing works correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1920" target="_blank">00:32:00.560</a></span> | <span class="t">We probably want to be able to run these tests somewhere other than just inside a notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1924" target="_blank">00:32:04.440</a></span> | <span class="t">. So we have a little program called run notebook dot P Y and you pass it the name of a notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1934" target="_blank">00:32:14.560</a></span> | <span class="t">And it runs it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1936" target="_blank">00:32:16.920</a></span> | <span class="t">So I should save this one with our failing test so you can see it fail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1944" target="_blank">00:32:24.600</a></span> | <span class="t">So first time it passed and then I make the failing test and you can see here it is assertion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1947" target="_blank">00:32:27.960</a></span> | <span class="t">error and tells you exactly where it happened.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1950" target="_blank">00:32:30.840</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1951" target="_blank">00:32:31.840</a></span> | <span class="t">So we now have an automatable unit testing framework in our Jupyter Notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1961" target="_blank">00:32:41.240</a></span> | <span class="t">I'll point out that the contents of these two Python scripts, let's look at them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1971" target="_blank">00:32:51.840</a></span> | <span class="t">So the first one was run notebook dot P Y, which is our test runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1976" target="_blank">00:32:56.180</a></span> | <span class="t">There is the entirety of it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1978" target="_blank">00:32:58.280</a></span> | <span class="t">So there's a thing called nb format, so if you condor install nb format, then it basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1984" target="_blank">00:33:04.060</a></span> | <span class="t">lets you execute a notebook and it prints out any errors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1988" target="_blank">00:33:08.140</a></span> | <span class="t">So that's the entirety of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1990" target="_blank">00:33:10.500</a></span> | <span class="t">You'll notice that I'm using a library called fire.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=1994" target="_blank">00:33:14.920</a></span> | <span class="t">Fire is a really neat library that lets you take any function like this one and automatically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2000" target="_blank">00:33:20.600</a></span> | <span class="t">converts it into a command line interface.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2003" target="_blank">00:33:23.640</a></span> | <span class="t">So here I've got a function called run notebook and then it says fire, run notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2008" target="_blank">00:33:28.960</a></span> | <span class="t">So if I now go Python, run notebook, then it says, oh, this function received no value,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2017" target="_blank">00:33:37.000</a></span> | <span class="t">path, usage, run notebook, path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2019" target="_blank">00:33:39.920</a></span> | <span class="t">So you can see that what it did was it converted my function into a command line interface,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2026" target="_blank">00:33:46.200</a></span> | <span class="t">which is really great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2027" target="_blank">00:33:47.200</a></span> | <span class="t">And it handles things like optional arguments and classes and it's super useful, particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2032" target="_blank">00:33:52.920</a></span> | <span class="t">for this kind of Jupiter first development, because you can grab stuff that's in Jupiter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2037" target="_blank">00:33:57.560</a></span> | <span class="t">and turn it into a script often by just copying and pasting the function or exporting it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2042" target="_blank">00:34:02.720</a></span> | <span class="t">And then just add this one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2047" target="_blank">00:34:07.120</a></span> | <span class="t">The other one notebook to script is not much more complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2057" target="_blank">00:34:17.880</a></span> | <span class="t">It's one screen of code, which again, the main thing here is to call fire, which calls</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2063" target="_blank">00:34:23.400</a></span> | <span class="t">this one function and you'll see basically it uses JSON.load because notebooks are JSON.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2069" target="_blank">00:34:29.880</a></span> | <span class="t">The reason I mentioned this to you is that Jupiter notebook comes with this whole kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2075" target="_blank">00:34:35.920</a></span> | <span class="t">of ecosystem of libraries and APIs and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2080" target="_blank">00:34:40.640</a></span> | <span class="t">And on the whole, I hate them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2083" target="_blank">00:34:43.080</a></span> | <span class="t">I find it's just JSON.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2084" target="_blank">00:34:44.880</a></span> | <span class="t">I find that just doing JSON.load is the easiest way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2089" target="_blank">00:34:49.240</a></span> | <span class="t">And specifically I build my Jupiter notebook infrastructure inside Jupiter notebooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2095" target="_blank">00:34:55.000</a></span> | <span class="t">So here's how it looks, right, import JSON, JSON.load this file and gives you an array</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2103" target="_blank">00:35:03.640</a></span> | <span class="t">and there's the contents of source, my first row, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2108" target="_blank">00:35:08.880</a></span> | <span class="t">So if you do want to play around with doing stuff in Jupiter notebook, it's a really great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2113" target="_blank">00:35:13.560</a></span> | <span class="t">environment for kind of automating stuff and running scripts on it and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2120" target="_blank">00:35:20.080</a></span> | <span class="t">So there's that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2122" target="_blank">00:35:22.320</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2123" target="_blank">00:35:23.420</a></span> | <span class="t">So that's the entire contents of our development infrastructure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2128" target="_blank">00:35:28.440</a></span> | <span class="t">We now have a test.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2129" target="_blank">00:35:29.440</a></span> | <span class="t">Let's make it pass again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2130" target="_blank">00:35:30.720</a></span> | <span class="t">One of the great things about having unit tests in notebooks is that when one does fail,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2136" target="_blank">00:35:36.960</a></span> | <span class="t">you open up a notebook, which can have pros saying, this is what this test does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2142" target="_blank">00:35:42.160</a></span> | <span class="t">It's implementing this part of this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2144" target="_blank">00:35:44.060</a></span> | <span class="t">You can see all the stuff above it that's setting up all the context for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2146" target="_blank">00:35:46.960</a></span> | <span class="t">You can check in each input and output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2148" target="_blank">00:35:48.800</a></span> | <span class="t">It's a really great way to fix those failing tests because you've got the whole truly literate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2154" target="_blank">00:35:54.680</a></span> | <span class="t">programming experience all around it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2157" target="_blank">00:35:57.740</a></span> | <span class="t">So I think that works great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2159" target="_blank">00:35:59.840</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2160" target="_blank">00:36:00.840</a></span> | <span class="t">So before we start doing matrix multiply, we need some matrices to multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2166" target="_blank">00:36:06.500</a></span> | <span class="t">So these are some of the things that are allowed by our rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2169" target="_blank">00:36:09.480</a></span> | <span class="t">We've got some stuff that's part of the standard library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2172" target="_blank">00:36:12.560</a></span> | <span class="t">This is the fast AI data sets library to let us grab the data sets we need some more standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2177" target="_blank">00:36:17.220</a></span> | <span class="t">library stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2178" target="_blank">00:36:18.220</a></span> | <span class="t">We're only allowed to use this for indexing and array creation that plot lab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2183" target="_blank">00:36:23.000</a></span> | <span class="t">There you go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2185" target="_blank">00:36:25.260</a></span> | <span class="t">So let's grab Evanist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2187" target="_blank">00:36:27.600</a></span> | <span class="t">So to grab Evanist, we just don't, we can use faster data sets to download it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2194" target="_blank">00:36:34.160</a></span> | <span class="t">And then we can use a standard library gzip to open it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2198" target="_blank">00:36:38.480</a></span> | <span class="t">And then we can pickle.load it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2200" target="_blank">00:36:40.560</a></span> | <span class="t">So in Python, the kind of standard serialization format is called pickle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2204" target="_blank">00:36:44.660</a></span> | <span class="t">And so this Evanist version on deeplearning.net is stored in that, in that format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2209" target="_blank">00:36:49.620</a></span> | <span class="t">And so we can, it's basically gives us a tuple of tuples of data sets like so x train, y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2215" target="_blank">00:36:55.680</a></span> | <span class="t">train, x valid, y valid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2218" target="_blank">00:36:58.800</a></span> | <span class="t">It actually contains NumPy arrays, but NumPy arrays are not allowed in our foundations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2225" target="_blank">00:37:05.720</a></span> | <span class="t">So we have to convert them into tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2228" target="_blank">00:37:08.700</a></span> | <span class="t">So we can just use the Python map to map the tensor function over each of these four arrays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2236" target="_blank">00:37:16.600</a></span> | <span class="t">to get back four tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2239" target="_blank">00:37:19.200</a></span> | <span class="t">A lot of you will be more familiar with NumPy arrays than PyTorch tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2246" target="_blank">00:37:26.040</a></span> | <span class="t">But you know, everything you can do in NumPy arrays, you can also do in PyTorch tensors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2251" target="_blank">00:37:31.300</a></span> | <span class="t">you can also do it on the GPU and have all this nice deeplearning infrastructure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2256" target="_blank">00:37:36.800</a></span> | <span class="t">So it's a good idea to get used to using PyTorch tensors, in my opinion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2262" target="_blank">00:37:42.280</a></span> | <span class="t">So we can now grab the number of rows and number of columns in the training search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2269" target="_blank">00:37:49.200</a></span> | <span class="t">And we can take a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2271" target="_blank">00:37:51.520</a></span> | <span class="t">So here's Evanist, hopefully pretty familiar to you already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2276" target="_blank">00:37:56.320</a></span> | <span class="t">It's 50,000 rows by 784 columns, and the y data looks something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2284" target="_blank">00:38:04.120</a></span> | <span class="t">The y shape is just 50,000 rows, and the minimum and maximum of the dependent variable is zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2291" target="_blank">00:38:11.360</a></span> | <span class="t">to nine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2292" target="_blank">00:38:12.360</a></span> | <span class="t">So hopefully that all looks pretty familiar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2294" target="_blank">00:38:14.680</a></span> | <span class="t">So let's add some tests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2296" target="_blank">00:38:16.260</a></span> | <span class="t">So the n should be equal to the shape of the y, should be equal to 50,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2304" target="_blank">00:38:24.920</a></span> | <span class="t">The number of columns should be equal to 28 by 28, because that's how many pixels there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2309" target="_blank">00:38:29.120</a></span> | <span class="t">are in Evanist, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2311" target="_blank">00:38:31.320</a></span> | <span class="t">And we're just using that test equals function that we created just above.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2318" target="_blank">00:38:38.400</a></span> | <span class="t">So now we can plot it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2320" target="_blank">00:38:40.520</a></span> | <span class="t">Okay, so we've got a float tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2324" target="_blank">00:38:44.160</a></span> | <span class="t">And we pass that to imshow after casting it to a 28 by 28.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2329" target="_blank">00:38:49.960</a></span> | <span class="t">Dot view is really important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2331" target="_blank">00:38:51.160</a></span> | <span class="t">I think we saw it a few times in part one, but get very familiar with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2334" target="_blank">00:38:54.420</a></span> | <span class="t">This is how we reshape our 768 long vector into a 28 by 28 matrix that's suitable for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2343" target="_blank">00:39:03.040</a></span> | <span class="t">plotting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2344" target="_blank">00:39:04.040</a></span> | <span class="t">Okay, so there's our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2346" target="_blank">00:39:06.900</a></span> | <span class="t">And let's start by creating a simple linear model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2353" target="_blank">00:39:13.920</a></span> | <span class="t">So for a linear model, we're going to need to basically have something where y equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2359" target="_blank">00:39:19.540</a></span> | <span class="t">a x plus b. And so our a will be a bunch of weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2366" target="_blank">00:39:26.480</a></span> | <span class="t">So it's going to be to be 784 by 10 matrix, because we've got 784 coming in and 10 going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2374" target="_blank">00:39:34.680</a></span> | <span class="t">out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2375" target="_blank">00:39:35.680</a></span> | <span class="t">So that's going to allow us to take in our independent variable and map it to something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2380" target="_blank">00:39:40.880</a></span> | <span class="t">which we compare to our dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2384" target="_blank">00:39:44.320</a></span> | <span class="t">And then for our bias, we'll just start with 10 zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2389" target="_blank">00:39:49.720</a></span> | <span class="t">So if we're going to do y equals a x plus b, then we're going to need a matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2396" target="_blank">00:39:56.560</a></span> | <span class="t">So almost everything we do in deep learning is basically matrix multiplication or a variant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2404" target="_blank">00:40:04.360</a></span> | <span class="t">thereof affine functions, as we call them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2408" target="_blank">00:40:08.180</a></span> | <span class="t">So you want to be very comfortable with matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2412" target="_blank">00:40:12.480</a></span> | <span class="t">So this cool website, matrix multiplication dot x, y, z, shows us exactly what happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2417" target="_blank">00:40:17.200</a></span> | <span class="t">when we multiply these two matrices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2423" target="_blank">00:40:23.320</a></span> | <span class="t">So we take the first column of the first row and the first row, and we multiply each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2429" target="_blank">00:40:29.240</a></span> | <span class="t">them element-wise, and then we add them up, and that gives us that one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2436" target="_blank">00:40:36.680</a></span> | <span class="t">And now you can see we've got two sets going on at the same time, so that gives us two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2439" target="_blank">00:40:39.520</a></span> | <span class="t">more, and then two more, and then the final one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2445" target="_blank">00:40:45.580</a></span> | <span class="t">And that's our matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2447" target="_blank">00:40:47.800</a></span> | <span class="t">So we have to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2452" target="_blank">00:40:52.000</a></span> | <span class="t">So we've got a few loops going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2455" target="_blank">00:40:55.240</a></span> | <span class="t">We've got the loop of this thing scrolling down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2458" target="_blank">00:40:58.960</a></span> | <span class="t">We've got the loop of these two rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2461" target="_blank">00:41:01.200</a></span> | <span class="t">They're really columns, so we flip them around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2463" target="_blank">00:41:03.960</a></span> | <span class="t">And then we've got the loop of the multiply and add.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2466" target="_blank">00:41:06.920</a></span> | <span class="t">So we're going to need three loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2470" target="_blank">00:41:10.700</a></span> | <span class="t">And so here's our three loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2473" target="_blank">00:41:13.360</a></span> | <span class="t">And notice this is not going to work unless the number of columns here and the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2483" target="_blank">00:41:23.640</a></span> | <span class="t">of rows here are the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2486" target="_blank">00:41:26.960</a></span> | <span class="t">So let's grab the number of rows and columns of A, and the number of rows and columns of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2493" target="_blank">00:41:33.440</a></span> | <span class="t">B, and make sure that AC equals BR, just to double check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2500" target="_blank">00:41:40.160</a></span> | <span class="t">And then let's create something of size AR by BC, because the size of this is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2505" target="_blank">00:41:45.000</a></span> | <span class="t">be AR by BC with zeros in, and then have our three loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2514" target="_blank">00:41:54.320</a></span> | <span class="t">And then right in the middle, let's do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2522" target="_blank">00:42:02.800</a></span> | <span class="t">OK, so right in the middle, the result in I comma J is going to be AIK by BKJ.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2536" target="_blank">00:42:16.040</a></span> | <span class="t">And this is the vast majority of what we're going to be doing in deep learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2540" target="_blank">00:42:20.800</a></span> | <span class="t">So get very, very comfortable with that equation, because we're going to be seeing it in three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2547" target="_blank">00:42:27.040</a></span> | <span class="t">or four different variants of notation and style in the next few weeks, in the next few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2553" target="_blank">00:42:33.440</a></span> | <span class="t">minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2554" target="_blank">00:42:34.440</a></span> | <span class="t">OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2555" target="_blank">00:42:35.440</a></span> | <span class="t">And it's got kind of a few interesting things going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2558" target="_blank">00:42:38.040</a></span> | <span class="t">This I here appears also over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2561" target="_blank">00:42:41.720</a></span> | <span class="t">This J here appears also over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2565" target="_blank">00:42:45.000</a></span> | <span class="t">And then the K in the loop appears twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2569" target="_blank">00:42:49.840</a></span> | <span class="t">And look, it's got to be the same number in each place, because this is the bit where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2573" target="_blank">00:42:53.160</a></span> | <span class="t">we're multiplying together the element-wise things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2576" target="_blank">00:42:56.640</a></span> | <span class="t">So there it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2577" target="_blank">00:42:57.960</a></span> | <span class="t">So let's create a nice small version, grab the first five rows of the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2582" target="_blank">00:43:02.760</a></span> | <span class="t">We'll call that M1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2584" target="_blank">00:43:04.000</a></span> | <span class="t">And grab our weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2585" target="_blank">00:43:05.000</a></span> | <span class="t">We'll call that M2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2587" target="_blank">00:43:07.960</a></span> | <span class="t">Grab our weight matrix, call that M2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2590" target="_blank">00:43:10.560</a></span> | <span class="t">And then here's their sizes, five, because we just grabbed the first five rows, five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2595" target="_blank">00:43:15.400</a></span> | <span class="t">by 784, OK, multiplied by 784 by 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2600" target="_blank">00:43:20.280</a></span> | <span class="t">So these match as they should.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2603" target="_blank">00:43:23.200</a></span> | <span class="t">And so now we can go ahead and do that matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2606" target="_blank">00:43:26.560</a></span> | <span class="t">And it's done, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2608" target="_blank">00:43:28.560</a></span> | <span class="t">And it's given us 50,000-- sorry, length of-- sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2614" target="_blank">00:43:34.720</a></span> | <span class="t">It's given us T1.shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2620" target="_blank">00:43:40.800</a></span> | <span class="t">As you would expect, a five rows by 10 column output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2625" target="_blank">00:43:45.240</a></span> | <span class="t">And it took about a second.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2628" target="_blank">00:43:48.640</a></span> | <span class="t">So it took about a second for five rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2631" target="_blank">00:43:51.520</a></span> | <span class="t">Our data set, MNIST, is 50,000 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2634" target="_blank">00:43:54.800</a></span> | <span class="t">So it's going to take about 50,000 seconds to do a single matrix multiplication in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2642" target="_blank">00:44:02.920</a></span> | <span class="t">So imagine doing MNIST where every layer for every pass took about 10 hours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2652" target="_blank">00:44:12.560</a></span> | <span class="t">Not going to work, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2654" target="_blank">00:44:14.300</a></span> | <span class="t">So that's why we don't really write things in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2657" target="_blank">00:44:17.800</a></span> | <span class="t">Like, when we say Python is too slow, we don't mean 20% too slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2664" target="_blank">00:44:24.600</a></span> | <span class="t">We mean thousands of times too slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2667" target="_blank">00:44:27.940</a></span> | <span class="t">So let's see if we can speed this up by 50,000 times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2673" target="_blank">00:44:33.080</a></span> | <span class="t">Because if we could do that, it might just be fast enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2676" target="_blank">00:44:36.260</a></span> | <span class="t">So the way we speed things up is we start in the innermost loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2681" target="_blank">00:44:41.160</a></span> | <span class="t">And we make each bit faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2683" target="_blank">00:44:43.840</a></span> | <span class="t">So the way to make Python faster is to remove Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2689" target="_blank">00:44:49.840</a></span> | <span class="t">And the way we remove Python is by passing our computation down to something that's written</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2694" target="_blank">00:44:54.760</a></span> | <span class="t">in something other than Python, like PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2698" target="_blank">00:44:58.520</a></span> | <span class="t">Because PyTorch behind the scenes is using a library called A10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2704" target="_blank">00:45:04.720</a></span> | <span class="t">And so we want to get this going down to the A10 library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2707" target="_blank">00:45:07.480</a></span> | <span class="t">So the way we do that is to take advantage of something called element-wise operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2712" target="_blank">00:45:12.680</a></span> | <span class="t">So you've seen them before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2714" target="_blank">00:45:14.800</a></span> | <span class="t">For example, if I have two tensors, A and B, both of length three, I can add them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2723" target="_blank">00:45:23.080</a></span> | <span class="t">And when I add them together, it simply adds together the corresponding items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2727" target="_blank">00:45:27.960</a></span> | <span class="t">So that's called element-wise addition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2731" target="_blank">00:45:31.360</a></span> | <span class="t">Or I could do less than, in which case it's going to do element-wise less than.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2737" target="_blank">00:45:37.340</a></span> | <span class="t">So what percentage of A is less than the corresponding item of B, A less than B dot float dot mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2748" target="_blank">00:45:48.120</a></span> | <span class="t">We can do element-wise operations on things not just of rank one, but we could do it on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2753" target="_blank">00:45:53.640</a></span> | <span class="t">a rank two tensor, also known as a matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2758" target="_blank">00:45:58.660</a></span> | <span class="t">So here's our rank two tensor, M. Let's calculate the Frobenius norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2767" target="_blank">00:46:07.160</a></span> | <span class="t">How many people know about the Frobenius norm?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2770" target="_blank">00:46:10.040</a></span> | <span class="t">Right, almost nobody.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2772" target="_blank">00:46:12.240</a></span> | <span class="t">And it looks kind of terrifying, right, but actually it's just this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2778" target="_blank">00:46:18.520</a></span> | <span class="t">It's a matrix times itself dot sum dot square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2785" target="_blank">00:46:25.080</a></span> | <span class="t">So here's the first time we're going to start trying to translate some equations into code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2791" target="_blank">00:46:31.720</a></span> | <span class="t">to help us understand these equations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2794" target="_blank">00:46:34.720</a></span> | <span class="t">So this says, when you see something like A with two sets of double lines around it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2801" target="_blank">00:46:41.640</a></span> | <span class="t">and an F underneath, that means we are calculating the Frobenius norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2806" target="_blank">00:46:46.720</a></span> | <span class="t">So any time you see this, and you will, it actually pops up semi-regularly in deep learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2810" target="_blank">00:46:50.600</a></span> | <span class="t">literature, when you see this, what it actually means is this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2817" target="_blank">00:46:57.500</a></span> | <span class="t">As you probably know, capital sigma means sum, and this says we're going to sum over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2823" target="_blank">00:47:03.120</a></span> | <span class="t">two for loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2825" target="_blank">00:47:05.240</a></span> | <span class="t">The first for loop will be called i, and we'll go from 1 to n.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2830" target="_blank">00:47:10.760</a></span> | <span class="t">And the second for loop will also be called j, and will also go from 1 to n.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2836" target="_blank">00:47:16.360</a></span> | <span class="t">And in these nested for loops, we're going to grab something out of a matrix A, that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2842" target="_blank">00:47:22.640</a></span> | <span class="t">position i, j.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2845" target="_blank">00:47:25.120</a></span> | <span class="t">We're going to square it, and then we're going to add all of those together, and then we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2850" target="_blank">00:47:30.120</a></span> | <span class="t">take the square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2853" target="_blank">00:47:33.400</a></span> | <span class="t">Which is that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2857" target="_blank">00:47:37.440</a></span> | <span class="t">Now I have something to admit to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2860" target="_blank">00:47:40.440</a></span> | <span class="t">I can't write LaTeX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2862" target="_blank">00:47:42.860</a></span> | <span class="t">And yet I did create this Jupyter notebook, so it looks a lot like I created some LaTeX,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2867" target="_blank">00:47:47.920</a></span> | <span class="t">which is certainly the impression I like to give people sometimes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2871" target="_blank">00:47:51.120</a></span> | <span class="t">But the way I actually write LaTeX is I find somebody else who wrote it, and then I copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2875" target="_blank">00:47:55.480</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2876" target="_blank">00:47:56.480</a></span> | <span class="t">So the way you do this most of the time is you Google for Frobenius Norm, you find the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2881" target="_blank">00:48:01.680</a></span> | <span class="t">wiki page for Frobenius Norm, you click edit next to the equation, and you copy and paste</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2887" target="_blank">00:48:07.880</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2889" target="_blank">00:48:09.720</a></span> | <span class="t">So that's a really good way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2891" target="_blank">00:48:11.680</a></span> | <span class="t">And check dollar signs or even two dollar signs around it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2893" target="_blank">00:48:13.960</a></span> | <span class="t">Two dollar signs make it a bit bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2896" target="_blank">00:48:16.880</a></span> | <span class="t">So that's way one to get equations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2899" target="_blank">00:48:19.760</a></span> | <span class="t">Method two is if it's in a paper on archive, did you know on archive you can click on download</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2906" target="_blank">00:48:26.440</a></span> | <span class="t">other formats in the top right, and then download source, and that will actually give you the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2912" target="_blank">00:48:32.080</a></span> | <span class="t">original tech source, and then you can copy and paste their LaTeX.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2918" target="_blank">00:48:38.040</a></span> | <span class="t">So I'll be showing you a bunch of equations during these lessons, and I can promise you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2921" target="_blank">00:48:41.880</a></span> | <span class="t">one thing, I wrote none of them by hand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2924" target="_blank">00:48:44.800</a></span> | <span class="t">So this one was stolen from Wikipedia.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2928" target="_blank">00:48:48.920</a></span> | <span class="t">All right, so you now know how to implement the Frobenius Norm from scratch in TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2938" target="_blank">00:48:58.480</a></span> | <span class="t">You could also have written it, of course, as m.pal2, but that would be illegal under</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2947" target="_blank">00:49:07.160</a></span> | <span class="t">our rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2948" target="_blank">00:49:08.160</a></span> | <span class="t">We're not allowed to use PAL yet, so that's why we did it that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2954" target="_blank">00:49:14.680</a></span> | <span class="t">So that's just doing the element-wise multiplication of a rank two tensor with itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2960" target="_blank">00:49:20.880</a></span> | <span class="t">One times one, two times two, three times three, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2967" target="_blank">00:49:27.120</a></span> | <span class="t">So that is enough information to replace this loop, because this loop is just going through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2976" target="_blank">00:49:36.120</a></span> | <span class="t">the first row of A and the first column of B, and doing an element-wise multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2983" target="_blank">00:49:43.760</a></span> | <span class="t">and sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2985" target="_blank">00:49:45.800</a></span> | <span class="t">So our new version is going to have two loops, not three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2988" target="_blank">00:49:48.680</a></span> | <span class="t">Here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2990" target="_blank">00:49:50.440</a></span> | <span class="t">So this is all the same, but now we've replaced the inner loop, and you'll see that basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=2999" target="_blank">00:49:59.520</a></span> | <span class="t">it looks exactly the same as before, but where it used to say k, it now says colon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3004" target="_blank">00:50:04.680</a></span> | <span class="t">So in pytorch and numpy, colon means the entirety of that axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3011" target="_blank">00:50:11.860</a></span> | <span class="t">So Rachel, help me remember the order of rows and columns when we talk about matrices, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3021" target="_blank">00:50:21.480</a></span> | <span class="t">is the song.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3022" target="_blank">00:50:22.480</a></span> | <span class="t">Row by column, row by column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3025" target="_blank">00:50:25.920</a></span> | <span class="t">So that's the song.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3026" target="_blank">00:50:26.920</a></span> | <span class="t">So i is the row number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3030" target="_blank">00:50:30.120</a></span> | <span class="t">So this is row number i, the whole row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3034" target="_blank">00:50:34.560</a></span> | <span class="t">And this is column number j, the whole column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3039" target="_blank">00:50:39.160</a></span> | <span class="t">So multiply all of column j by all of row i, and that gives us back a rank one tensor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3046" target="_blank">00:50:46.840</a></span> | <span class="t">which we add up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3049" target="_blank">00:50:49.160</a></span> | <span class="t">That's exactly the same as what we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3051" target="_blank">00:50:51.520</a></span> | <span class="t">And so now that takes 1.45 milliseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3055" target="_blank">00:50:55.280</a></span> | <span class="t">We've removed one line of code, and it's 178 times faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3060" target="_blank">00:51:00.360</a></span> | <span class="t">So we successfully got rid of that inner loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3063" target="_blank">00:51:03.720</a></span> | <span class="t">And so now this is running in C. We didn't really write Python here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3070" target="_blank">00:51:10.360</a></span> | <span class="t">We wrote kind of a Python-ish thing that said, please call this C code for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3076" target="_blank">00:51:16.040</a></span> | <span class="t">And that made it 178 times faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3079" target="_blank">00:51:19.140</a></span> | <span class="t">Let's check that it's right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3080" target="_blank">00:51:20.720</a></span> | <span class="t">We can't really check that it's equal, because floats are sometimes changed slightly, depending</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3087" target="_blank">00:51:27.200</a></span> | <span class="t">on how you calculate them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3088" target="_blank">00:51:28.640</a></span> | <span class="t">So instead, let's create something called near, which calls torch.all_close to some tolerance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3095" target="_blank">00:51:35.480</a></span> | <span class="t">And then we'll create a test_near function that calls our test function using our near</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3099" target="_blank">00:51:39.400</a></span> | <span class="t">comparison.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3102" target="_blank">00:51:42.880</a></span> | <span class="t">And let's see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3103" target="_blank">00:51:43.880</a></span> | <span class="t">Yep.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3104" target="_blank">00:51:44.880</a></span> | <span class="t">Passes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3105" target="_blank">00:51:45.880</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3106" target="_blank">00:51:46.880</a></span> | <span class="t">So we've now got our matrix multiplication at 65 microseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3112" target="_blank">00:51:52.760</a></span> | <span class="t">Now we need to get rid of this loop, because now this is our innermost loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3118" target="_blank">00:51:58.200</a></span> | <span class="t">And to do that, we're going to have to use something called broadcasting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3122" target="_blank">00:52:02.000</a></span> | <span class="t">Who here is familiar with broadcasting?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3125" target="_blank">00:52:05.200</a></span> | <span class="t">About half.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3126" target="_blank">00:52:06.200</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3127" target="_blank">00:52:07.200</a></span> | <span class="t">That's what I figured.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3128" target="_blank">00:52:08.200</a></span> | <span class="t">So broadcasting is about the most powerful tool we have in our toolbox for writing code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3136" target="_blank">00:52:16.560</a></span> | <span class="t">in Python that runs at C speed, or in fact, with PyTorch, if you put it on the GPU, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3144" target="_blank">00:52:24.360</a></span> | <span class="t">going to run at CUDA speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3147" target="_blank">00:52:27.900</a></span> | <span class="t">It allows us to get rid of nearly all of our loops, as you'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3153" target="_blank">00:52:33.960</a></span> | <span class="t">The term "broadcasting" comes from NumPy, but the idea actually goes all the way back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3158" target="_blank">00:52:38.280</a></span> | <span class="t">to APL from 1962.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3163" target="_blank">00:52:43.400</a></span> | <span class="t">And it's a really, really powerful technique.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3166" target="_blank">00:52:46.480</a></span> | <span class="t">A lot of people consider it a different way of programming, where we get rid of all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3170" target="_blank">00:52:50.360</a></span> | <span class="t">our for loops and replace them with these implicit, broadcasted loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3178" target="_blank">00:52:58.600</a></span> | <span class="t">In fact, you've seen broadcasting before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3181" target="_blank">00:53:01.940</a></span> | <span class="t">Remember our tensor A, which contains 10, 6, 4?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3186" target="_blank">00:53:06.000</a></span> | <span class="t">If you say A greater than 0, then on the left-hand side, you've got to rank one tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3192" target="_blank">00:53:12.160</a></span> | <span class="t">On the right-hand side, you've got a scalar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3194" target="_blank">00:53:14.360</a></span> | <span class="t">And yet somehow it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3196" target="_blank">00:53:16.640</a></span> | <span class="t">And the reason why is that this value 0 is broadcast three times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3202" target="_blank">00:53:22.800</a></span> | <span class="t">It becomes 0, 0, 0, and then it does an element-wise comparison.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3208" target="_blank">00:53:28.000</a></span> | <span class="t">So every time, for example, you've normalized a dataset by subtracting the mean and divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3213" target="_blank">00:53:33.560</a></span> | <span class="t">by the standard deviation in a kind of one line like this, you've actually been broadcasting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3219" target="_blank">00:53:39.400</a></span> | <span class="t">You're broadcasting a scalar to a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3225" target="_blank">00:53:45.420</a></span> | <span class="t">So A plus one also broadcasts a scalar to a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3230" target="_blank">00:53:50.600</a></span> | <span class="t">And the tensor doesn't have to be rank one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3232" target="_blank">00:53:52.680</a></span> | <span class="t">Here we can multiply our rank two tensor by two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3237" target="_blank">00:53:57.340</a></span> | <span class="t">So there's the simplest kind of broadcasting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3239" target="_blank">00:53:59.520</a></span> | <span class="t">And any time you do that, you're not operating at Python speed, you're operating at C or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3246" target="_blank">00:54:06.280</a></span> | <span class="t">CUDA speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3247" target="_blank">00:54:07.800</a></span> | <span class="t">So that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3251" target="_blank">00:54:11.100</a></span> | <span class="t">We can also broadcast a vector to a matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3255" target="_blank">00:54:15.800</a></span> | <span class="t">So here's a rank one tensor C. And here's our previous rank two tensor M. So M's shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3264" target="_blank">00:54:24.840</a></span> | <span class="t">is 3, 3, C's shape is 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3269" target="_blank">00:54:29.660</a></span> | <span class="t">And yet M plus C does something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3274" target="_blank">00:54:34.320</a></span> | <span class="t">What did it do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3276" target="_blank">00:54:36.320</a></span> | <span class="t">10, 20, 30 plus 1, 2, 3, 10, 20, 30 plus 4, 5, 6, 10, 20, 30 plus 7, 8, 9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3286" target="_blank">00:54:46.560</a></span> | <span class="t">It's broadcast this row across each row of the matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3294" target="_blank">00:54:54.200</a></span> | <span class="t">And it's doing that at C speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3297" target="_blank">00:54:57.800</a></span> | <span class="t">So this, there's no loop, but it sure looks as if there was a loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3304" target="_blank">00:55:04.480</a></span> | <span class="t">C plus M does exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3308" target="_blank">00:55:08.600</a></span> | <span class="t">So we can write C dot expand as M. And it shows us what C would look like when broadcast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3319" target="_blank">00:55:19.440</a></span> | <span class="t">to M. 10, 20, 30, 10, 20, 30, 10, 20, 30.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3323" target="_blank">00:55:23.000</a></span> | <span class="t">So you can see M plus T is the same as C plus M. So basically it's creating or acting as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3333" target="_blank">00:55:33.240</a></span> | <span class="t">if it's creating this bigger rank two tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3339" target="_blank">00:55:39.740</a></span> | <span class="t">So this is pretty cool because it now means that any time we need to do something between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3344" target="_blank">00:55:44.040</a></span> | <span class="t">a vector and a matrix, we can do it at C speed with no loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3351" target="_blank">00:55:51.920</a></span> | <span class="t">Now you might be worrying though that this looks pretty memory intensive if we're kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3356" target="_blank">00:55:56.060</a></span> | <span class="t">of turning all of our rows into big matrices, but fear not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3360" target="_blank">00:56:00.260</a></span> | <span class="t">Because you can look inside the actual memory used by PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3365" target="_blank">00:56:05.040</a></span> | <span class="t">So here T is a 3 by 3 matrix, but T dot storage tells us that actually it's only storing one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3372" target="_blank">00:56:12.040</a></span> | <span class="t">copy of that data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3375" target="_blank">00:56:15.760</a></span> | <span class="t">T dot shape tells us that T knows it's meant to be a 3 by 3 matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3381" target="_blank">00:56:21.280</a></span> | <span class="t">And T dot stride tells us that it knows that when it's going from column to column, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3386" target="_blank">00:56:26.780</a></span> | <span class="t">should take one step through the storage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3390" target="_blank">00:56:30.800</a></span> | <span class="t">But when it goes from row to row, it should take zero steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3395" target="_blank">00:56:35.780</a></span> | <span class="t">And so that's how calm it repeats 10, 20, 30, 10, 20, 30, 10, 20, 30.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3400" target="_blank">00:56:40.680</a></span> | <span class="t">So this is a really powerful thing that appears in pretty much every linear algebra library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3404" target="_blank">00:56:44.680</a></span> | <span class="t">you'll come across is this idea that you can actually create tensors that behave like higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3411" target="_blank">00:56:51.600</a></span> | <span class="t">rank things than they're actually stored as.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3415" target="_blank">00:56:55.680</a></span> | <span class="t">So this is really neat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3416" target="_blank">00:56:56.680</a></span> | <span class="t">It basically means that this broadcasting functionality gives us C like speed with no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3421" target="_blank">00:57:01.760</a></span> | <span class="t">additional memory overhead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3424" target="_blank">00:57:04.680</a></span> | <span class="t">Okay, what if we wanted to take a column instead of a row?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3432" target="_blank">00:57:12.820</a></span> | <span class="t">So in other words, a rank 2 tensor of shape 3, 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3441" target="_blank">00:57:21.520</a></span> | <span class="t">We can create a rank 2 tensor of shape 3, 1 from a rank 1 tensor by using the unsqueeze</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3450" target="_blank">00:57:30.240</a></span> | <span class="t">method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3453" target="_blank">00:57:33.040</a></span> | <span class="t">Unsqueeze adds an additional dimension of size 1 to wherever we ask for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3459" target="_blank">00:57:39.880</a></span> | <span class="t">So unsqueeze 0, let's check this out, unsqueeze 0 is of shape 1, 3, it puts the new dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3469" target="_blank">00:57:49.500</a></span> | <span class="t">in position 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3472" target="_blank">00:57:52.000</a></span> | <span class="t">Unsqueeze 1 is shape 3, 1, it creates the new axis in position 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3478" target="_blank">00:57:58.760</a></span> | <span class="t">So unsqueeze 0 looks a lot like C, but now rather than being a rank 1 tensor, it's now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3487" target="_blank">00:58:07.960</a></span> | <span class="t">a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3489" target="_blank">00:58:09.840</a></span> | <span class="t">See how it's got two square brackets around it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3492" target="_blank">00:58:12.680</a></span> | <span class="t">See how its size is 1, 3?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3496" target="_blank">00:58:16.880</a></span> | <span class="t">As more interestingly, C.unsqueeze 1 now looks like a column, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3503" target="_blank">00:58:23.340</a></span> | <span class="t">It's also a rank 2 tensor, but it's 3 rows by one column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3508" target="_blank">00:58:28.280</a></span> | <span class="t">Why is this interesting?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3510" target="_blank">00:58:30.400</a></span> | <span class="t">Because we can say, well actually before we do, I'll just mention writing .unsqueeze is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3517" target="_blank">00:58:37.920</a></span> | <span class="t">kind of clunky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3519" target="_blank">00:58:39.540</a></span> | <span class="t">So PyTorch and NumPy have a neat trick, which is that you can index into an array with a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3526" target="_blank">00:58:46.520</a></span> | <span class="t">special value none, and none means squeeze a new axis in here please.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3533" target="_blank">00:58:53.960</a></span> | <span class="t">So you can see that C none colon is exactly the same shape, 1, 3, as C.unsqueeze 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3543" target="_blank">00:59:03.160</a></span> | <span class="t">And C colon, none is exactly the same shape as C.unsqueeze 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3549" target="_blank">00:59:09.120</a></span> | <span class="t">So I hardly ever use unsqueeze unless I'm like particularly trying to demonstrate something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3552" target="_blank">00:59:12.740</a></span> | <span class="t">for teaching purposes, I pretty much always use none.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3555" target="_blank">00:59:15.520</a></span> | <span class="t">Apart from anything else, I can add additional axes this way, or else with unsqueeze you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3562" target="_blank">00:59:22.320</a></span> | <span class="t">have to go to unsqueeze, unsqueeze, unsqueeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3565" target="_blank">00:59:25.200</a></span> | <span class="t">So this is handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3568" target="_blank">00:59:28.960</a></span> | <span class="t">So why did we do all that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3570" target="_blank">00:59:30.880</a></span> | <span class="t">The reason we did all that is because if we go C colon, none, so in other words we turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3580" target="_blank">00:59:40.800</a></span> | <span class="t">it into a column, kind of a columnar shape, so it's now of shape 3, 1, .expandas, it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3590" target="_blank">00:59:50.520</a></span> | <span class="t">now say 10, 20, 30, 10, 20, 30, 10, 20, 30, but it says 10, 10, 10, 20, 20, 20, 30, 30.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3596" target="_blank">00:59:56.720</a></span> | <span class="t">So in other words it's getting broadcast along columns instead of rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3601" target="_blank">01:00:01.520</a></span> | <span class="t">So as you might expect, if I take that and add it to M, then I get the result of broadcasting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3612" target="_blank">01:00:12.880</a></span> | <span class="t">the column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3614" target="_blank">01:00:14.340</a></span> | <span class="t">So it's now not 11, 22, 33, but 11, 12, 13.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3625" target="_blank">01:00:25.120</a></span> | <span class="t">So everything makes more sense in Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3629" target="_blank">01:00:29.120</a></span> | <span class="t">Let's look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3630" target="_blank">01:00:30.320</a></span> | <span class="t">So here's broadcasting in Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3633" target="_blank">01:00:33.400</a></span> | <span class="t">Here is a 1, 3 shape rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3642" target="_blank">01:00:42.640</a></span> | <span class="t">So we can use the rows and columns functions in Excel to get the rows and columns of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3649" target="_blank">01:00:49.400</a></span> | <span class="t">object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3651" target="_blank">01:00:51.560</a></span> | <span class="t">Here is a 3 by 1, rank 2 tensor, again rows and columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3659" target="_blank">01:00:59.960</a></span> | <span class="t">And here is a 3 by 3, rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3665" target="_blank">01:01:05.240</a></span> | <span class="t">As you can see, rows by columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3667" target="_blank">01:01:07.760</a></span> | <span class="t">So here's what happens if we broadcast this to be the shape of M.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3681" target="_blank">01:01:21.360</a></span> | <span class="t">And here is the result of that C plus M. And here's what happens if we broadcast this to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3689" target="_blank">01:01:29.480</a></span> | <span class="t">that shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3691" target="_blank">01:01:31.420</a></span> | <span class="t">And here is the result of that addition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3694" target="_blank">01:01:34.760</a></span> | <span class="t">And there it is, 11, 12, 13, 24, 25, 26.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3703" target="_blank">01:01:43.360</a></span> | <span class="t">So basically what's happening is when we broadcast, it's taking the thing which has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3711" target="_blank">01:01:51.240</a></span> | <span class="t">unit axis and is kind of effectively copying that unit axis so it is as long as the larger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3718" target="_blank">01:01:58.980</a></span> | <span class="t">tensor on that axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3721" target="_blank">01:02:01.180</a></span> | <span class="t">But it doesn't really copy it, it just pretends as if it's been copied.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3726" target="_blank">01:02:06.780</a></span> | <span class="t">So we can use that to get rid of our loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3734" target="_blank">01:02:14.400</a></span> | <span class="t">So this was the loop we were trying to get rid of, going through each of range BC.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3746" target="_blank">01:02:26.240</a></span> | <span class="t">And so here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3747" target="_blank">01:02:27.760</a></span> | <span class="t">So now we are not anymore going through that loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3750" target="_blank">01:02:30.840</a></span> | <span class="t">So now rather than setting CI comma J, we can set the entire row of CI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3758" target="_blank">01:02:38.720</a></span> | <span class="t">This is the same as CI comma colon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3762" target="_blank">01:02:42.900</a></span> | <span class="t">Every time there's a trailing colon in NumPy or PyTorch, you can delete it optionally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3771" target="_blank">01:02:51.440</a></span> | <span class="t">You don't have to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3772" target="_blank">01:02:52.920</a></span> | <span class="t">So before, we had a few of those, right, let's see if we can find one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3783" target="_blank">01:03:03.840</a></span> | <span class="t">Here's one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3784" target="_blank">01:03:04.840</a></span> | <span class="t">Comma colon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3785" target="_blank">01:03:05.840</a></span> | <span class="t">So I'm claiming we could have got rid of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3787" target="_blank">01:03:07.640</a></span> | <span class="t">Let's see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3788" target="_blank">01:03:08.800</a></span> | <span class="t">Yep, still torch size 1 comma 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3793" target="_blank">01:03:13.040</a></span> | <span class="t">And similar thing, any time you see any number of colon commas at the start, you can replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3799" target="_blank">01:03:19.660</a></span> | <span class="t">them with a single ellipsis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3802" target="_blank">01:03:22.760</a></span> | <span class="t">Which in this case doesn't save us anything because there's only one of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3805" target="_blank">01:03:25.520</a></span> | <span class="t">But if you've got like a really high-rank tensor, that can be super convenient, especially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3810" target="_blank">01:03:30.040</a></span> | <span class="t">if you want to do something where the rank of the tensor could vary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3813" target="_blank">01:03:33.400</a></span> | <span class="t">You don't know how big it's going to be ahead of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3820" target="_blank">01:03:40.880</a></span> | <span class="t">So we're going to set the whole of row I, and we don't need that colon, though it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3826" target="_blank">01:03:46.840</a></span> | <span class="t">matter if it's there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3828" target="_blank">01:03:48.760</a></span> | <span class="t">And we're going to set it to the whole of row I of A.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3835" target="_blank">01:03:55.800</a></span> | <span class="t">And then now that we've got row I of A, that is a rank 1 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3841" target="_blank">01:04:01.840</a></span> | <span class="t">So let's turn it into a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3845" target="_blank">01:04:05.880</a></span> | <span class="t">So it's now got a new-- and see how this is minus 1?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3851" target="_blank">01:04:11.520</a></span> | <span class="t">So minus 1 always means the last dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3855" target="_blank">01:04:15.840</a></span> | <span class="t">So how else could we have written that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3858" target="_blank">01:04:18.440</a></span> | <span class="t">We could also have written it like that with a special value none.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3868" target="_blank">01:04:28.200</a></span> | <span class="t">So this is of now length whatever the size of A is, which is AR.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3878" target="_blank">01:04:38.440</a></span> | <span class="t">So it's of shape AR comma 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3883" target="_blank">01:04:43.760</a></span> | <span class="t">So that is a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3890" target="_blank">01:04:50.120</a></span> | <span class="t">And B is also a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3891" target="_blank">01:04:51.960</a></span> | <span class="t">That's the entirety of our matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3895" target="_blank">01:04:55.280</a></span> | <span class="t">And so this is going to get broadcast over this, which is exactly what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3901" target="_blank">01:05:01.320</a></span> | <span class="t">We want it to get rid of that loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3903" target="_blank">01:05:03.280</a></span> | <span class="t">And then, so that's going to return, because it broadcast, it's actually going to return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3907" target="_blank">01:05:07.680</a></span> | <span class="t">a rank 2 tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3909" target="_blank">01:05:09.640</a></span> | <span class="t">And then that rank 2 tensor, we want to sum it up over the rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3915" target="_blank">01:05:15.640</a></span> | <span class="t">And so sum, you can give it a dimension argument to say which axis to sum over.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3922" target="_blank">01:05:22.280</a></span> | <span class="t">So this one is kind of our most mind-bending broadcast of the lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3928" target="_blank">01:05:28.160</a></span> | <span class="t">So I'm going to leave this as a bit of homework for you to go back and convince yourself as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3934" target="_blank">01:05:34.300</a></span> | <span class="t">to why this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3935" target="_blank">01:05:35.380</a></span> | <span class="t">So maybe put it in Excel or do it on paper if it's not already clear to you why this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3942" target="_blank">01:05:42.280</a></span> | <span class="t">works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3943" target="_blank">01:05:43.840</a></span> | <span class="t">But this is sure handy, because before we were broadcasting that, we were at 1.39 milliseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3953" target="_blank">01:05:53.680</a></span> | <span class="t">After using that broadcasting, we're down to 250 microseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3958" target="_blank">01:05:58.720</a></span> | <span class="t">So at this point, we're now 3,200 times faster than Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3966" target="_blank">01:06:06.680</a></span> | <span class="t">And it's not just speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3967" target="_blank">01:06:07.760</a></span> | <span class="t">Once you get used to this style of coding, getting rid of these loops I find really reduces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3973" target="_blank">01:06:13.020</a></span> | <span class="t">a lot of errors in my code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3976" target="_blank">01:06:16.040</a></span> | <span class="t">It takes a while to get used to, but once you're used to it, it's a really comfortable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3978" target="_blank">01:06:18.960</a></span> | <span class="t">way of programming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3983" target="_blank">01:06:23.960</a></span> | <span class="t">Once you get to kind of higher ranked tensors, this broadcasting can start getting a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3989" target="_blank">01:06:29.680</a></span> | <span class="t">complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3990" target="_blank">01:06:30.680</a></span> | <span class="t">So what you need to do instead of trying to keep it all in your head is apply the simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3995" target="_blank">01:06:35.240</a></span> | <span class="t">broadcasting rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3998" target="_blank">01:06:38.920</a></span> | <span class="t">Here are the rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=3999" target="_blank">01:06:39.920</a></span> | <span class="t">Some here, in NumPy and PyTorch and TensorFlow, it's all the same rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4005" target="_blank">01:06:45.120</a></span> | <span class="t">What we do is we compare the shapes element-wise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4011" target="_blank">01:06:51.280</a></span> | <span class="t">So let's look at a slightly interesting example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4018" target="_blank">01:06:58.280</a></span> | <span class="t">Here is our rank1 tensor C, and let's insert a leading unit axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4026" target="_blank">01:07:06.280</a></span> | <span class="t">So this is a shape 1,3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4028" target="_blank">01:07:08.200</a></span> | <span class="t">See how there's two square brackets?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4031" target="_blank">01:07:11.720</a></span> | <span class="t">And here's the version with a, sorry, this one's a preceding axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4037" target="_blank">01:07:17.420</a></span> | <span class="t">This one's a trailing axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4038" target="_blank">01:07:18.680</a></span> | <span class="t">So this is shape 3,1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4043" target="_blank">01:07:23.960</a></span> | <span class="t">And we should take a look at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4045" target="_blank">01:07:25.760</a></span> | <span class="t">So just to remind you, that looks like a column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4054" target="_blank">01:07:34.120</a></span> | <span class="t">What if we went C, none, colon, times C, colon, colon, what on earth is that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4063" target="_blank">01:07:43.640</a></span> | <span class="t">And so let's go back to Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4067" target="_blank">01:07:47.680</a></span> | <span class="t">Here's our row version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4069" target="_blank">01:07:49.920</a></span> | <span class="t">Here's our column version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4071" target="_blank">01:07:51.740</a></span> | <span class="t">What happens is it says, okay, you want to multiply this by this, element-wise, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4077" target="_blank">01:07:57.120</a></span> | <span class="t">This is not the at sign.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4078" target="_blank">01:07:58.360</a></span> | <span class="t">This is asterisk, so element-wise multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4081" target="_blank">01:08:01.280</a></span> | <span class="t">And it broadcasts this to be the same number of rows as that, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4088" target="_blank">01:08:08.880</a></span> | <span class="t">And it broadcasts this to be the same number of columns as that, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4094" target="_blank">01:08:14.520</a></span> | <span class="t">And then it simply multiplies those together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4100" target="_blank">01:08:20.720</a></span> | <span class="t">That's it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4102" target="_blank">01:08:22.000</a></span> | <span class="t">So the rule that it's using, you can do the same thing with greater than, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4107" target="_blank">01:08:27.840</a></span> | <span class="t">The rule that it's using is, let's look at the two shapes, 1, 3 and 3,1, and see if they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4113" target="_blank">01:08:33.760</a></span> | <span class="t">compatible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4114" target="_blank">01:08:34.760</a></span> | <span class="t">They're compatible if, element-wise, they're either the same number or one of them is 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4122" target="_blank">01:08:42.640</a></span> | <span class="t">So in this case, 1 is compatible with 3 because one of them is 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4127" target="_blank">01:08:47.400</a></span> | <span class="t">And 3 is compatible with 1 because one of them is 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4131" target="_blank">01:08:51.160</a></span> | <span class="t">And so what happens is, if it's 1, that dimension is broadcast to make it the same size as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4137" target="_blank">01:08:57.160</a></span> | <span class="t">bigger one, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4139" target="_blank">01:08:59.600</a></span> | <span class="t">So 3,1 became 3,3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4143" target="_blank">01:09:03.600</a></span> | <span class="t">So this one was multiplied 3 times down the rows, and this one was multiplied 3 times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4148" target="_blank">01:09:08.200</a></span> | <span class="t">down the columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4151" target="_blank">01:09:11.180</a></span> | <span class="t">And then there's one more rule, which is that they don't even have to be the same rank,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4155" target="_blank">01:09:15.880</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4156" target="_blank">01:09:16.880</a></span> | <span class="t">So something that we do a lot with image normalization is we normalize images by channel, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4164" target="_blank">01:09:24.480</a></span> | <span class="t">So you might have an image which is 256 by 256 by 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4168" target="_blank">01:09:28.160</a></span> | <span class="t">And then you've got the per-channel mean, which is just a rank 1 tensor of size 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4173" target="_blank">01:09:33.960</a></span> | <span class="t">They're actually compatible because what it does is, anywhere that there's a missing dimension,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4179" target="_blank">01:09:39.440</a></span> | <span class="t">it inserts a 1 there at the start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4182" target="_blank">01:09:42.200</a></span> | <span class="t">It inserts leading dimensions and inserts a 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4184" target="_blank">01:09:44.580</a></span> | <span class="t">So that's why actually you can normalize by channel with no lines of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4192" target="_blank">01:09:52.920</a></span> | <span class="t">Mind you, in PyTorch, it's actually channel by height by width, so it's slightly different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4198" target="_blank">01:09:58.080</a></span> | <span class="t">But this is the basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4200" target="_blank">01:10:00.740</a></span> | <span class="t">So this is super cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4202" target="_blank">01:10:02.440</a></span> | <span class="t">We're going to take a break, but we're getting pretty close.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4206" target="_blank">01:10:06.320</a></span> | <span class="t">My goal was to make our Python code 50,000 times faster, we're up to 4,000 times faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4214" target="_blank">01:10:14.000</a></span> | <span class="t">And the reason this is really important is because if we're going to be like doing our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4219" target="_blank">01:10:19.120</a></span> | <span class="t">own stuff, like building things that people haven't built before, we need to know how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4225" target="_blank">01:10:25.520</a></span> | <span class="t">to write code that we can write quickly and concisely, but operates fast enough that it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4231" target="_blank">01:10:31.160</a></span> | <span class="t">actually useful, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4232" target="_blank">01:10:32.720</a></span> | <span class="t">And so this broadcasting trick is perhaps the most important trick to know about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4238" target="_blank">01:10:38.700</a></span> | <span class="t">So let's have a six-minute break, and I'll see you back here at 8 o'clock.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4244" target="_blank">01:10:44.520</a></span> | <span class="t">So broadcasting, when I first started teaching deep learning here, and I asked how many people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4254" target="_blank">01:10:54.960</a></span> | <span class="t">are familiar with broadcasting, this is back when we used to do it in the piano, almost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4258" target="_blank">01:10:58.840</a></span> | <span class="t">no hands went up, so I used to kind of say this is like my secret magic trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4264" target="_blank">01:11:04.640</a></span> | <span class="t">I think it's really cool, it's kind of really cool that now half of you have already heard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4268" target="_blank">01:11:08.120</a></span> | <span class="t">of it, and it's kind of sad because it's now not my secret magic trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4271" target="_blank">01:11:11.440</a></span> | <span class="t">It's like here's something half of you already knew, but the other half of you, there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4277" target="_blank">01:11:17.800</a></span> | <span class="t">reason that people are learning this quickly and it's because it's super cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4282" target="_blank">01:11:22.680</a></span> | <span class="t">Here's another magic trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4283" target="_blank">01:11:23.840</a></span> | <span class="t">How many people here know Einstein summation notation?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4287" target="_blank">01:11:27.480</a></span> | <span class="t">Okay, good, good, almost nobody.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4290" target="_blank">01:11:30.680</a></span> | <span class="t">So it's not as cool as broadcasting, but it is still very, very cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4297" target="_blank">01:11:37.080</a></span> | <span class="t">Let me show you, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4298" target="_blank">01:11:38.800</a></span> | <span class="t">And this is a technique which I don't think it was invented by Einstein, I think it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4303" target="_blank">01:11:43.240</a></span> | <span class="t">popularized by Einstein as a way of dealing with these high rank tensor kind of reductions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4309" target="_blank">01:11:49.600</a></span> | <span class="t">that we used in the general relativity, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4313" target="_blank">01:11:53.960</a></span> | <span class="t">Here's the trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4315" target="_blank">01:11:55.440</a></span> | <span class="t">This is the innermost part of our original matrix multiplication for loop, remember?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4325" target="_blank">01:12:05.120</a></span> | <span class="t">And here's the version when we removed the innermost loop and replaced it with an element-wise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4329" target="_blank">01:12:09.960</a></span> | <span class="t">product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4330" target="_blank">01:12:10.960</a></span> | <span class="t">And you'll notice that what happened was that the repeated K got replaced with a colon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4337" target="_blank">01:12:17.640</a></span> | <span class="t">Okay, so what's this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4341" target="_blank">01:12:21.280</a></span> | <span class="t">What if I move, okay, so first of all, let's get rid of the names of everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4349" target="_blank">01:12:29.640</a></span> | <span class="t">And let's move this to the end and put it after an arrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4359" target="_blank">01:12:39.720</a></span> | <span class="t">And let's keep getting rid of the names of everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4370" target="_blank">01:12:50.040</a></span> | <span class="t">And get rid of the commas and replace spaces with commas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4380" target="_blank">01:13:00.240</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4383" target="_blank">01:13:03.160</a></span> | <span class="t">And now I just created Einstein summation notation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4387" target="_blank">01:13:07.280</a></span> | <span class="t">So Einstein summation notation is like a mini language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4391" target="_blank">01:13:11.960</a></span> | <span class="t">You put it inside a string, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4395" target="_blank">01:13:15.160</a></span> | <span class="t">And what it says is, however many, so there's an arrow, right, and on the left of the arrow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4399" target="_blank">01:13:19.880</a></span> | <span class="t">is the input and on the right of the arrow is the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4404" target="_blank">01:13:24.000</a></span> | <span class="t">How many inputs do you have?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4406" target="_blank">01:13:26.080</a></span> | <span class="t">Well they're delimited by comma, so in this case there's two inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4412" target="_blank">01:13:32.520</a></span> | <span class="t">The inputs, what's the rank of each input?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4415" target="_blank">01:13:35.200</a></span> | <span class="t">It's however many letters there are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4416" target="_blank">01:13:36.800</a></span> | <span class="t">So this is a rank two input and this is another rank two input and this is a rank two output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4423" target="_blank">01:13:43.960</a></span> | <span class="t">How big are the inputs?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4425" target="_blank">01:13:45.880</a></span> | <span class="t">This is one is the size i by k, this one is the size k by j, and the output is of size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4433" target="_blank">01:13:53.120</a></span> | <span class="t">i by j.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4434" target="_blank">01:13:54.440</a></span> | <span class="t">When you see the same letter appearing in different places, it's referring to the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4438" target="_blank">01:13:58.520</a></span> | <span class="t">size dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4440" target="_blank">01:14:00.360</a></span> | <span class="t">So this is of size i, the output is always has, also has i rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4446" target="_blank">01:14:06.120</a></span> | <span class="t">This has j columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4447" target="_blank">01:14:07.400</a></span> | <span class="t">The output also has j columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4449" target="_blank">01:14:09.200</a></span> | <span class="t">Alright.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4450" target="_blank">01:14:10.200</a></span> | <span class="t">So we know how to go from the input shape to the output shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4453" target="_blank">01:14:13.880</a></span> | <span class="t">What about the k?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4456" target="_blank">01:14:16.360</a></span> | <span class="t">You look for any place that a letter is repeated and you do a dot product over that dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4463" target="_blank">01:14:23.920</a></span> | <span class="t">In other words, it's just like the way we replaced k with colon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4469" target="_blank">01:14:29.720</a></span> | <span class="t">So this is going to create something of size i by j by doing dot products over these shared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4477" target="_blank">01:14:37.960</a></span> | <span class="t">k's, which is matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4482" target="_blank">01:14:42.040</a></span> | <span class="t">So that's how you write matrix multiplication with Einstein summation notation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4488" target="_blank">01:14:48.120</a></span> | <span class="t">And then all you just do is go torch dot insum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4492" target="_blank">01:14:52.560</a></span> | <span class="t">If you go to the PI torch insum docs or docs of most of the major libraries, you can find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4501" target="_blank">01:15:01.560</a></span> | <span class="t">all kinds of cool examples of insum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4503" target="_blank">01:15:03.640</a></span> | <span class="t">You can use it for transpose, diagonalization, tracing, all kinds of things, batch wise versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4510" target="_blank">01:15:10.840</a></span> | <span class="t">of just about everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4511" target="_blank">01:15:11.960</a></span> | <span class="t">So for example, if PI torch didn't have batch wise matrix multiplication, I just created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4522" target="_blank">01:15:22.520</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4523" target="_blank">01:15:23.760</a></span> | <span class="t">There's batch wise matrix multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4525" target="_blank">01:15:25.920</a></span> | <span class="t">So there's all kinds of things you can kind of invent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4528" target="_blank">01:15:28.400</a></span> | <span class="t">And often it's quite handy if you kind of need to put a transpose in somewhere or tweak</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4532" target="_blank">01:15:32.680</a></span> | <span class="t">things to be a little bit different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4534" target="_blank">01:15:34.320</a></span> | <span class="t">You can use this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4535" target="_blank">01:15:35.440</a></span> | <span class="t">So that's Einstein summation notation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4537" target="_blank">01:15:37.360</a></span> | <span class="t">Size matmul and that's now taken us down to 57 microseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4544" target="_blank">01:15:44.080</a></span> | <span class="t">So we're now 16,000 times faster than Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4549" target="_blank">01:15:49.320</a></span> | <span class="t">I will say something about Einstein.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4553" target="_blank">01:15:53.680</a></span> | <span class="t">It's a travesty that this exists because we've got a little mini language inside Python in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4559" target="_blank">01:15:59.600</a></span> | <span class="t">a string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4560" target="_blank">01:16:00.600</a></span> | <span class="t">I mean, that's horrendous.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4563" target="_blank">01:16:03.560</a></span> | <span class="t">You shouldn't be writing programming languages inside a string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4567" target="_blank">01:16:07.920</a></span> | <span class="t">This is as bad as a regex, you know, like regular expressions are also mini languages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4573" target="_blank">01:16:13.160</a></span> | <span class="t">inside a string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4574" target="_blank">01:16:14.160</a></span> | <span class="t">You want your languages to be like typed and have an Intelli sense and like be things that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4579" target="_blank">01:16:19.400</a></span> | <span class="t">you can like, you know, extend this, this mini language does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4584" target="_blank">01:16:24.840</a></span> | <span class="t">It's amazing, but there's so few things that it actually does, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4589" target="_blank">01:16:29.440</a></span> | <span class="t">What I actually want to be able to do is create like any kind of arbitrary combination of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4595" target="_blank">01:16:35.000</a></span> | <span class="t">any axes and any operations and any reductions I like in any order in the actual language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4600" target="_blank">01:16:40.680</a></span> | <span class="t">I'm writing in, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4602" target="_blank">01:16:42.800</a></span> | <span class="t">So that's actually what APL does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4606" target="_blank">01:16:46.780</a></span> | <span class="t">That's actually what J and K do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4608" target="_blank">01:16:48.840</a></span> | <span class="t">These are the J and K are the languages that kind of came out of APL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4612" target="_blank">01:16:52.200</a></span> | <span class="t">This is a kind of a series of languages that have been around for about 60 years and everybody's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4617" target="_blank">01:16:57.600</a></span> | <span class="t">pretty much failed to notice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4621" target="_blank">01:17:01.680</a></span> | <span class="t">My hope is that things like Swift and Julia will give us this, like the ability to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4629" target="_blank">01:17:09.720</a></span> | <span class="t">write stuff in actual Swift and actual Julia that we can run in an actual debugger and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4634" target="_blank">01:17:14.680</a></span> | <span class="t">use an actual profiler and do arbitrary stuff that's really fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4640" target="_blank">01:17:20.360</a></span> | <span class="t">But actually, Swift seems like it might go even quite a bit faster than Einstein in an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4648" target="_blank">01:17:28.480</a></span> | <span class="t">even more flexible way, thanks to this new compiler infrastructure called MLIR, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4653" target="_blank">01:17:33.560</a></span> | <span class="t">actually builds off this and really exciting new research in the compiler world, kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4658" target="_blank">01:17:38.040</a></span> | <span class="t">been coming over the last few years, particularly coming out of a system called Halide, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4662" target="_blank">01:17:42.960</a></span> | <span class="t">is H-A-L-I-D-E, which is this super cool language that basically showed it's possible to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4669" target="_blank">01:17:49.840</a></span> | <span class="t">a language that can create very, very, very, like totally optimized linear algebra computations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4677" target="_blank">01:17:57.840</a></span> | <span class="t">in a really flexible, convenient way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4680" target="_blank">01:18:00.520</a></span> | <span class="t">And since that came along, there's been all kinds of cool research using these techniques</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4687" target="_blank">01:18:07.320</a></span> | <span class="t">like something called polyhedral compilation, which kind of have the promise that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4693" target="_blank">01:18:13.640</a></span> | <span class="t">going to be able to hopefully, within the next couple of years, write Swift code that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4700" target="_blank">01:18:20.240</a></span> | <span class="t">runs as fast as the next thing I'm about to show you, because the next thing I'm about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4704" target="_blank">01:18:24.360</a></span> | <span class="t">to show you is the PyTorch operation called matmul.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4710" target="_blank">01:18:30.720</a></span> | <span class="t">And matmul takes 8a microseconds, which is 50,000 times faster than Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4719" target="_blank">01:18:39.920</a></span> | <span class="t">Why is it so fast?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4721" target="_blank">01:18:41.400</a></span> | <span class="t">Well, if you think about what you're doing when you do a matrix multiply of something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4725" target="_blank">01:18:45.800</a></span> | <span class="t">that's like 50,000 by 768 by 768 by 10, these are things that aren't going to fit in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4736" target="_blank">01:18:56.280</a></span> | <span class="t">cache in your CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4738" target="_blank">01:18:58.200</a></span> | <span class="t">So if you do the kind of standard thing of going down all the rows and across all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4741" target="_blank">01:19:01.400</a></span> | <span class="t">columns, by the time you've got to the end and you go back to exactly the same column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4745" target="_blank">01:19:05.360</a></span> | <span class="t">again, it forgot the contents and has to go back to RAM and pull it in again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4750" target="_blank">01:19:10.240</a></span> | <span class="t">So if you're smart, what you do is you break your matrix up into little smaller matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4754" target="_blank">01:19:14.540</a></span> | <span class="t">and you do a little bit at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4756" target="_blank">01:19:16.280</a></span> | <span class="t">And that way, everything is kind of in cache and it goes super fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4759" target="_blank">01:19:19.440</a></span> | <span class="t">Now, normally, to do that, you have to write kind of assembly language code, particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4765" target="_blank">01:19:25.360</a></span> | <span class="t">if you want to kind of get it all running in your vector processor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4769" target="_blank">01:19:29.200</a></span> | <span class="t">And that's how you get these 18 microseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4772" target="_blank">01:19:32.300</a></span> | <span class="t">So currently, to get a fast matrix multiply, things like PyTorch, they don't even write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4777" target="_blank">01:19:37.540</a></span> | <span class="t">it themselves, they basically push that off to something called a BLAS, B-L-A-S, a BLAS</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4782" target="_blank">01:19:42.920</a></span> | <span class="t">is a Basic Linear Algebra Subprograms Library, where companies like Intel and AMD and NVIDIA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4791" target="_blank">01:19:51.120</a></span> | <span class="t">write these things for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4792" target="_blank">01:19:52.720</a></span> | <span class="t">So you can look up KuBLAS, for example, and this is like NVIDIA's version of BLAS.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4797" target="_blank">01:19:57.920</a></span> | <span class="t">Or you could look up MKL and this is Intel's version of BLAS and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4804" target="_blank">01:20:04.640</a></span> | <span class="t">And this is kind of awful because, you know, the program is limited to this like subset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4811" target="_blank">01:20:11.480</a></span> | <span class="t">of things that your BLAS can handle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4815" target="_blank">01:20:15.800</a></span> | <span class="t">And to use it, you don't really get to write it in Python, you kind of have to write the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4821" target="_blank">01:20:21.200</a></span> | <span class="t">one thing that happens to be turned into that pre-existing BLAS call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4826" target="_blank">01:20:26.000</a></span> | <span class="t">So this is kind of why we need to do better, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4829" target="_blank">01:20:29.560</a></span> | <span class="t">And there are people working on this and there are people actually in Chris Latner's team</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4835" target="_blank">01:20:35.600</a></span> | <span class="t">working on this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4836" target="_blank">01:20:36.600</a></span> | <span class="t">You know, there's some really cool stuff like there's something called Tensor Comprehensions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4841" target="_blank">01:20:41.720</a></span> | <span class="t">which is like really originally came in PyTorch, and I think they're now inside Chris's team</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4847" target="_blank">01:20:47.040</a></span> | <span class="t">at Google, where people are basically saying, hey, here are ways to like compile these much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4852" target="_blank">01:20:52.360</a></span> | <span class="t">more general things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4853" target="_blank">01:20:53.360</a></span> | <span class="t">And this is what we want as more advanced practitioners.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4857" target="_blank">01:20:57.840</a></span> | <span class="t">Anyway, for now, in PyTorch world, we're stuck at this level, which is to recognize there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4865" target="_blank">01:21:05.680</a></span> | <span class="t">are some things this is, you know, three times faster than the best we can do in an even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4873" target="_blank">01:21:13.520</a></span> | <span class="t">vaguely flexible way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4875" target="_blank">01:21:15.920</a></span> | <span class="t">And if we compare it to the actually flexible way, which is broadcasting, we had 254, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4886" target="_blank">01:21:26.680</a></span> | <span class="t">so still over 10 times better, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4890" target="_blank">01:21:30.280</a></span> | <span class="t">So wherever possible today, we want to use operations that are predefined in our library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4897" target="_blank">01:21:37.160</a></span> | <span class="t">particularly for things that kind of operate over lots of rows and columns, the things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4901" target="_blank">01:21:41.480</a></span> | <span class="t">we're kind of dealing with this memory caching stuff is going to be complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4906" target="_blank">01:21:46.600</a></span> | <span class="t">So keep an eye out for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4909" target="_blank">01:21:49.280</a></span> | <span class="t">Matrix modification is so common and useful that it's actually got its own operator, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4915" target="_blank">01:21:55.000</a></span> | <span class="t">is at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4916" target="_blank">01:21:56.240</a></span> | <span class="t">These are actually calling the exact same code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4918" target="_blank">01:21:58.160</a></span> | <span class="t">So they're the exact same speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4922" target="_blank">01:22:02.360</a></span> | <span class="t">At is not actually just matrix modification at covers a much broader array of kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4930" target="_blank">01:22:10.440</a></span> | <span class="t">tensor reductions across different levels of axes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4935" target="_blank">01:22:15.120</a></span> | <span class="t">So it's worth checking out what matball can do, because often it'll be able to handle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4939" target="_blank">01:22:19.800</a></span> | <span class="t">things like batch wise or matrix versus vectors, don't think of it as being only something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4945" target="_blank">01:22:25.760</a></span> | <span class="t">that can do rank two by rank two, because it's a little bit more flexible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4950" target="_blank">01:22:30.560</a></span> | <span class="t">OK, so that's that we have matrix multiplication, and so now we're allowed to use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4959" target="_blank">01:22:39.000</a></span> | <span class="t">And so we're going to use it to try to create a forward pass, which means we first need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4965" target="_blank">01:22:45.760</a></span> | <span class="t">value and matrix initialization, because remember, a model contains parameters which start out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4973" target="_blank">01:22:53.680</a></span> | <span class="t">randomly initialized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4975" target="_blank">01:22:55.880</a></span> | <span class="t">And then we use the gradients to gradually update them with SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4980" target="_blank">01:23:00.400</a></span> | <span class="t">So let's do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4987" target="_blank">01:23:07.720</a></span> | <span class="t">So here is O2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4991" target="_blank">01:23:11.600</a></span> | <span class="t">So let's start by importing NBO1, and I just copied and pasted the three lines we used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=4998" target="_blank">01:23:18.560</a></span> | <span class="t">to grab the data, and I'm just going to pop them into a function so we can use it to grab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5002" target="_blank">01:23:22.160</a></span> | <span class="t">MNIST when we need it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5004" target="_blank">01:23:24.680</a></span> | <span class="t">And now that we know about broadcasting, let's create a normalization function that takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5009" target="_blank">01:23:29.760</a></span> | <span class="t">our tensor and subtracts the means and divides by the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5015" target="_blank">01:23:35.800</a></span> | <span class="t">So now let's grab our data, OK, and pop it into x, y, x, y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5022" target="_blank">01:23:42.320</a></span> | <span class="t">Let's grab the mean and standard deviation, and notice that they're not 0 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5028" target="_blank">01:23:48.720</a></span> | <span class="t">Why would they be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5029" target="_blank">01:23:49.720</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5030" target="_blank">01:23:50.720</a></span> | <span class="t">But we want them to be 0 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5031" target="_blank">01:23:51.720</a></span> | <span class="t">And we're going to be seeing a lot of why we want them to be 0 and 1 over the next couple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5036" target="_blank">01:23:56.880</a></span> | <span class="t">of lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5037" target="_blank">01:23:57.880</a></span> | <span class="t">But for now, let's just take my word for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5040" target="_blank">01:24:00.520</a></span> | <span class="t">We want them to be 0 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5042" target="_blank">01:24:02.120</a></span> | <span class="t">So that means that we need to subtract the mean, divide by the standard deviation, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5047" target="_blank">01:24:07.680</a></span> | <span class="t">not for the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5049" target="_blank">01:24:09.720</a></span> | <span class="t">We don't subtract the validation set's mean and divide by the validation set's standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5053" target="_blank">01:24:13.640</a></span> | <span class="t">deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5054" target="_blank">01:24:14.640</a></span> | <span class="t">Because if we did, those two data sets would be on totally different scales, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5060" target="_blank">01:24:20.200</a></span> | <span class="t">So if the training set was mainly green frogs, and the validation set was mainly red frogs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5068" target="_blank">01:24:28.200</a></span> | <span class="t">right, then if we normalize with the validation sets mean and variance, we would end up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5074" target="_blank">01:24:34.880</a></span> | <span class="t">them both having the same average coloration, and we wouldn't be able to tell the two apart,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5080" target="_blank">01:24:40.320</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5081" target="_blank">01:24:41.320</a></span> | <span class="t">So that's an important thing to remember when normalizing, is to always make sure your validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5085" target="_blank">01:24:45.440</a></span> | <span class="t">and training set are normalized in the same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5088" target="_blank">01:24:48.920</a></span> | <span class="t">So after doing that, get it twice, okay, so after doing that, our mean is pretty close</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5100" target="_blank">01:25:00.800</a></span> | <span class="t">to 0, and our standard deviation is very close to 1, and it would be nice to have something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5105" target="_blank">01:25:05.360</a></span> | <span class="t">to easily check that these are true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5107" target="_blank">01:25:07.000</a></span> | <span class="t">So let's create a test near 0 function, and then test that the mean is near 0, and 1 minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5113" target="_blank">01:25:13.200</a></span> | <span class="t">the standard deviation is near 0, and that's all good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5118" target="_blank">01:25:18.200</a></span> | <span class="t">Let's define N and M and C the same as before, so the size of the training set and the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5125" target="_blank">01:25:25.440</a></span> | <span class="t">of activations we're going to eventually need in our model being C, and let's try to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5131" target="_blank">01:25:31.120</a></span> | <span class="t">our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5135" target="_blank">01:25:35.040</a></span> | <span class="t">Okay, so the model is going to have one hidden layer, and normally we would want the final</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5145" target="_blank">01:25:45.800</a></span> | <span class="t">output to have 10 activations, because we would use cross-entropy against those 10 activations,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5152" target="_blank">01:25:52.360</a></span> | <span class="t">but to simplify things for now, we're going to not use cross-entropy, we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5156" target="_blank">01:25:56.660</a></span> | <span class="t">mean squared error, which means we're going to have one activation, okay, which makes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5161" target="_blank">01:26:01.040</a></span> | <span class="t">no sense from our modeling point of view, we'll fix that later, but just to simplify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5164" target="_blank">01:26:04.200</a></span> | <span class="t">things for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5165" target="_blank">01:26:05.500</a></span> | <span class="t">So let's create a simple neural net with a single hidden layer and a single output activation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5173" target="_blank">01:26:13.600</a></span> | <span class="t">which we're going to use mean squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5175" target="_blank">01:26:15.880</a></span> | <span class="t">So let's pick a hidden size, so the number of hidden will make 50, okay, so our two layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5182" target="_blank">01:26:22.040</a></span> | <span class="t">we're going to need two weight matrices and two bias vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5186" target="_blank">01:26:26.240</a></span> | <span class="t">So here are our two weight matrices, W1 and W2, so they're random numbers, normal random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5193" target="_blank">01:26:33.800</a></span> | <span class="t">numbers of size M, which is the number of columns, 768, by NH, number of hidden, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5200" target="_blank">01:26:40.560</a></span> | <span class="t">then this one is NH by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5205" target="_blank">01:26:45.500</a></span> | <span class="t">Now our inputs now are mean zero, standard deviation 1, the inputs to the first layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5214" target="_blank">01:26:54.360</a></span> | <span class="t">We want the inputs to the second layer to also be mean zero, standard deviation 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5220" target="_blank">01:27:00.680</a></span> | <span class="t">Well, how are we going to do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5225" target="_blank">01:27:05.080</a></span> | <span class="t">Because if we just grab some normal random numbers and then we define a function called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5234" target="_blank">01:27:14.160</a></span> | <span class="t">linear, this is our linear layer, which is X by W plus B, and then create T, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5240" target="_blank">01:27:20.760</a></span> | <span class="t">the activation of that linear layer with our validation set and our weights and biases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5248" target="_blank">01:27:28.000</a></span> | <span class="t">We have a mean of minus 5 and a standard deviation of 27, which is terrible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5256" target="_blank">01:27:36.560</a></span> | <span class="t">So I'm going to let you work through this at home, but once you actually look at what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5263" target="_blank">01:27:43.040</a></span> | <span class="t">happens when you multiply those things together and add them up, as you do in matrix multiplication,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5269" target="_blank">01:27:49.160</a></span> | <span class="t">you'll see that you're not going to end up with 0, 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5271" target="_blank">01:27:51.760</a></span> | <span class="t">But if instead you divide by square root m, so root 768, then it's actually damn good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5287" target="_blank">01:28:07.800</a></span> | <span class="t">So this is a simplified version of something which PyTorch calls Keiming initialization,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5295" target="_blank">01:28:15.200</a></span> | <span class="t">named after Keiming He who wrote a paper, or was the lead writer of a paper that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5300" target="_blank">01:28:20.720</a></span> | <span class="t">going to look at in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5304" target="_blank">01:28:24.400</a></span> | <span class="t">So the weights, rand n gives you random numbers with a mean of 0 and a standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5313" target="_blank">01:28:33.400</a></span> | <span class="t">of 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5315" target="_blank">01:28:35.100</a></span> | <span class="t">So if you divide by root m, it will have a mean of 0 and a standard deviation of 1 on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5320" target="_blank">01:28:40.440</a></span> | <span class="t">root m.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5321" target="_blank">01:28:41.440</a></span> | <span class="t">So we can test this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5326" target="_blank">01:28:46.520</a></span> | <span class="t">So in general, normal random numbers of mean 0 and standard deviation of 1 over root of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5337" target="_blank">01:28:57.000</a></span> | <span class="t">whatever this is, so here it's m and here it's nh, will give you an output of 0, 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5344" target="_blank">01:29:04.640</a></span> | <span class="t">Now this may seem like a pretty minor issue, but as we're going to see in the next couple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5348" target="_blank">01:29:08.960</a></span> | <span class="t">of lessons, it's like the thing that matters when it comes to training neural nets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5354" target="_blank">01:29:14.760</a></span> | <span class="t">It's actually, in the last few months, people have really been noticing how important this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5360" target="_blank">01:29:20.400</a></span> | <span class="t">is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5361" target="_blank">01:29:21.480</a></span> | <span class="t">There are things like fix-up initialization, where these folks actually trained a 10,000-layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5372" target="_blank">01:29:32.800</a></span> | <span class="t">deep neural network with no normalization layers, just by basically doing careful initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5382" target="_blank">01:29:42.420</a></span> | <span class="t">So it's really, people are really spending a lot of time now thinking like, okay, how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5387" target="_blank">01:29:47.640</a></span> | <span class="t">we initialize things is really important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5389" target="_blank">01:29:49.800</a></span> | <span class="t">And you know, we've had a lot of success with things like one cycle training and super convergence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5396" target="_blank">01:29:56.480</a></span> | <span class="t">which is all about what happens in those first few iterations, and it really turns out that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5402" target="_blank">01:30:02.760</a></span> | <span class="t">it's all about initializations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5404" target="_blank">01:30:04.980</a></span> | <span class="t">So we're going to be spending a lot of time studying this in depth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5409" target="_blank">01:30:09.960</a></span> | <span class="t">So the first thing I'm going to point out is that this is actually not how our first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5415" target="_blank">01:30:15.360</a></span> | <span class="t">layer is defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5417" target="_blank">01:30:17.520</a></span> | <span class="t">Our first layer is actually defined like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5419" target="_blank">01:30:19.980</a></span> | <span class="t">It's got a ReLU on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5422" target="_blank">01:30:22.000</a></span> | <span class="t">So first let's define ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5423" target="_blank">01:30:23.920</a></span> | <span class="t">So ReLU is just grab our data and replace any negatives with zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5429" target="_blank">01:30:29.760</a></span> | <span class="t">That's all Clamp min means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5432" target="_blank">01:30:32.640</a></span> | <span class="t">Now there's lots of ways I could have written this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5435" target="_blank">01:30:35.200</a></span> | <span class="t">But if you can do it with something that's like a single function in PyTorch, it's almost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5439" target="_blank">01:30:39.160</a></span> | <span class="t">always faster because that thing's generally written in C for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5442" target="_blank">01:30:42.280</a></span> | <span class="t">So try to find the thing that's as close to what you want as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5445" target="_blank">01:30:45.840</a></span> | <span class="t">There's a lot of functions in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5447" target="_blank">01:30:47.840</a></span> | <span class="t">So that's a good way of implementing ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5451" target="_blank">01:30:51.880</a></span> | <span class="t">And unfortunately, that does not have a mean zero and standard deviation of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5459" target="_blank">01:30:59.200</a></span> | <span class="t">Why not?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5461" target="_blank">01:31:01.360</a></span> | <span class="t">Well, where's my stylus?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5466" target="_blank">01:31:06.480</a></span> | <span class="t">Okay, so we had some data that had a mean of zero and a standard deviation of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5483" target="_blank">01:31:23.240</a></span> | <span class="t">And then we took everything that was smaller than zero and removed it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5493" target="_blank">01:31:33.880</a></span> | <span class="t">So that obviously does not have a mean of zero and it obviously now has about half the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5500" target="_blank">01:31:40.680</a></span> | <span class="t">standard deviation that it used to have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5504" target="_blank">01:31:44.680</a></span> | <span class="t">So this was one of the fantastic insights and one of the most extraordinary papers of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5513" target="_blank">01:31:53.720</a></span> | <span class="t">the last few years.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5515" target="_blank">01:31:55.440</a></span> | <span class="t">It was the paper from the 2015 ImageNet winners led by the person we've mentioned, Kaiming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5522" target="_blank">01:32:02.600</a></span> | <span class="t">He.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5524" target="_blank">01:32:04.280</a></span> | <span class="t">Kaiming at that time was at Microsoft Research.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5527" target="_blank">01:32:07.720</a></span> | <span class="t">And this is full of great ideas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5532" target="_blank">01:32:12.400</a></span> | <span class="t">Reading papers from competition winners is a very, very good idea because they tend to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5537" target="_blank">01:32:17.600</a></span> | <span class="t">be, you know, normal papers will have like one tiny tweak that they spend pages and pages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5542" target="_blank">01:32:22.720</a></span> | <span class="t">trying to justify why they should be accepted into NeurIPS, whereas competition winners</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5547" target="_blank">01:32:27.520</a></span> | <span class="t">have 20 good ideas and only time to mention them in passing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5551" target="_blank">01:32:31.400</a></span> | <span class="t">This paper introduced us to ResNets, PreluLayers, and Kaiming initialization amongst others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5559" target="_blank">01:32:39.800</a></span> | <span class="t">So here is section 2.2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5568" target="_blank">01:32:48.340</a></span> | <span class="t">Section 2.2, initialization of filter weights or rectifiers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5571" target="_blank">01:32:51.800</a></span> | <span class="t">What's a rectifier?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5572" target="_blank">01:32:52.800</a></span> | <span class="t">A rectifier is a rectified linear unit or rectifier network is any neural network with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5578" target="_blank">01:32:58.880</a></span> | <span class="t">rectifier linear units in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5581" target="_blank">01:33:01.120</a></span> | <span class="t">This is only 2015, but it already reads like something from another age in so many ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5587" target="_blank">01:33:07.060</a></span> | <span class="t">Like even the word rectifier units and traditional sigmoid activation networks, no one uses sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5593" target="_blank">01:33:13.080</a></span> | <span class="t">activations anymore, you know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5595" target="_blank">01:33:15.160</a></span> | <span class="t">So a lot's changed since 2015.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5596" target="_blank">01:33:16.820</a></span> | <span class="t">So when you read these papers, you kind of have to keep these things in mind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5599" target="_blank">01:33:19.840</a></span> | <span class="t">They describe how what happens if you train very deep models with more than eight layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5609" target="_blank">01:33:29.480</a></span> | <span class="t">So things have changed, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5611" target="_blank">01:33:31.360</a></span> | <span class="t">But anyway, they said that in the old days, people used to initialize these with random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5616" target="_blank">01:33:36.100</a></span> | <span class="t">Gaussian distributions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5617" target="_blank">01:33:37.920</a></span> | <span class="t">So this is a Gaussian distribution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5619" target="_blank">01:33:39.960</a></span> | <span class="t">It's just a fancy word for normal or bell shaped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5624" target="_blank">01:33:44.840</a></span> | <span class="t">And when you do that, they tend to not train very well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5629" target="_blank">01:33:49.960</a></span> | <span class="t">And the reason why, they point out, or actually Glorow and Benjio pointed out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5635" target="_blank">01:33:55.120</a></span> | <span class="t">Let's look at that paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5638" target="_blank">01:33:58.820</a></span> | <span class="t">So you'll see two initializations come up all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5641" target="_blank">01:34:01.600</a></span> | <span class="t">One is either Kaiming or Her initialization, which is this one, or the other you'll see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5645" target="_blank">01:34:05.840</a></span> | <span class="t">a lot is Glorow or Xavier initialization, again, named after Xavier Glorow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5654" target="_blank">01:34:14.960</a></span> | <span class="t">This is a really interesting paper to read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5656" target="_blank">01:34:16.640</a></span> | <span class="t">It's a slightly older one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5657" target="_blank">01:34:17.640</a></span> | <span class="t">It's from 2010.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5658" target="_blank">01:34:18.640</a></span> | <span class="t">It's been massively influential.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5660" target="_blank">01:34:20.760</a></span> | <span class="t">And one of the things you'll notice if you read it is it's very readable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5667" target="_blank">01:34:27.120</a></span> | <span class="t">It's very practical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5669" target="_blank">01:34:29.120</a></span> | <span class="t">And the actual final result they come up with is it's incredibly simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5675" target="_blank">01:34:35.200</a></span> | <span class="t">And we're actually going to be re-implementing much of the stuff in this paper over the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5679" target="_blank">01:34:39.520</a></span> | <span class="t">couple of lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5681" target="_blank">01:34:41.440</a></span> | <span class="t">But basically, they describe one suggestion for how to initialize neural nets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5692" target="_blank">01:34:52.480</a></span> | <span class="t">And they suggest this particular approach, which is root six over the root of the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5700" target="_blank">01:35:00.360</a></span> | <span class="t">of input filters plus the number of output filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5705" target="_blank">01:35:05.720</a></span> | <span class="t">And so what happened was Kaiming Her and that team pointed out that that does not account</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5712" target="_blank">01:35:12.760</a></span> | <span class="t">for the impact of a ReLU, the thing that we just noticed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5718" target="_blank">01:35:18.840</a></span> | <span class="t">So this is a big problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5720" target="_blank">01:35:20.400</a></span> | <span class="t">If your variance halves each layer and you have a massive deep network with like eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5727" target="_blank">01:35:27.600</a></span> | <span class="t">layers, then you've got one over two to the eight squishes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5732" target="_blank">01:35:32.200</a></span> | <span class="t">Like by the end, it's all gone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5733" target="_blank">01:35:33.880</a></span> | <span class="t">And if you want to be fancy like the fix up people with 10,000 layers, forget it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5741" target="_blank">01:35:41.200</a></span> | <span class="t">Your gradients have totally disappeared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5743" target="_blank">01:35:43.240</a></span> | <span class="t">So this is totally unacceptable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5745" target="_blank">01:35:45.360</a></span> | <span class="t">So they do something super genius smart.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5749" target="_blank">01:35:49.080</a></span> | <span class="t">They replace the one on the top with a two on the top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5753" target="_blank">01:35:53.160</a></span> | <span class="t">So this, which is not to take anything away from this, it's a fantastic paper, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5757" target="_blank">01:35:57.800</a></span> | <span class="t">But in the end, the thing they do is to stick a two on the top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5762" target="_blank">01:36:02.400</a></span> | <span class="t">So we can do that by taking that exact equation we just used and sticking a two on the top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5769" target="_blank">01:36:09.560</a></span> | <span class="t">And if we do, then the result is much closer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5776" target="_blank">01:36:16.120</a></span> | <span class="t">It's not perfect, right, but it actually varies quite a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5779" target="_blank">01:36:19.200</a></span> | <span class="t">It's really random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5780" target="_blank">01:36:20.440</a></span> | <span class="t">Sometimes it's quite close.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5781" target="_blank">01:36:21.440</a></span> | <span class="t">Sometimes it's further away, but it's certainly a lot better than it was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5785" target="_blank">01:36:25.040</a></span> | <span class="t">So that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5787" target="_blank">01:36:27.560</a></span> | <span class="t">And it's really worth reading.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5792" target="_blank">01:36:32.160</a></span> | <span class="t">So law homework for this week is to read 2.2 of the ResNet paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5801" target="_blank">01:36:41.240</a></span> | <span class="t">And what you'll see is that they describe what happens in the forward pass of a neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5807" target="_blank">01:36:47.000</a></span> | <span class="t">net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5808" target="_blank">01:36:48.000</a></span> | <span class="t">And they point out that for the conv layer, this is the response, Y equals WX plus B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5813" target="_blank">01:36:53.040</a></span> | <span class="t">Now if you're concentrating, that might be confusing because a conv layer isn't quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5819" target="_blank">01:36:59.480</a></span> | <span class="t">Y equals WX plus B. A conv layer has a convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5822" target="_blank">01:37:02.880</a></span> | <span class="t">But you remember in part one, I pointed out this neat article from Matt Clinesmith where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5828" target="_blank">01:37:08.800</a></span> | <span class="t">he showed that CNNs in convolutions actually are just matrix multiplications with a bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5835" target="_blank">01:37:15.840</a></span> | <span class="t">of zeros and some tideweights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5838" target="_blank">01:37:18.360</a></span> | <span class="t">So this is basically all they're saying here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5840" target="_blank">01:37:20.740</a></span> | <span class="t">So sometimes there are these kind of like throwaway lines in papers that are actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5844" target="_blank">01:37:24.840</a></span> | <span class="t">quite deep and worth thinking about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5847" target="_blank">01:37:27.200</a></span> | <span class="t">So they point out that you can just think of this as a linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5850" target="_blank">01:37:30.800</a></span> | <span class="t">And then they basically take you through step by step what happens to the variance of your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5858" target="_blank">01:37:38.080</a></span> | <span class="t">network depending on the initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5861" target="_blank">01:37:41.820</a></span> | <span class="t">And so just try to get to this point here, get as far as backward propagation case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5866" target="_blank">01:37:46.400</a></span> | <span class="t">So you've got about, I don't know, six paragraphs to read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5871" target="_blank">01:37:51.720</a></span> | <span class="t">None of the math notation is weird.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5874" target="_blank">01:37:54.520</a></span> | <span class="t">Maybe this one is if you haven't seen this before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5876" target="_blank">01:37:56.740</a></span> | <span class="t">This is exactly the same as sigma, but instead of doing a sum, you do a product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5882" target="_blank">01:38:02.120</a></span> | <span class="t">So this is a great way to kind of warm up your paper reading muscles is to try and read</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5885" target="_blank">01:38:05.760</a></span> | <span class="t">this section.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5888" target="_blank">01:38:08.480</a></span> | <span class="t">And then if that's going well, you can keep going with the backward propagation case because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5893" target="_blank">01:38:13.840</a></span> | <span class="t">the forward pass does a matrix multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5897" target="_blank">01:38:17.440</a></span> | <span class="t">And as we'll see in a moment, the backward pass does a matrix multiply with a transpose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5901" target="_blank">01:38:21.640</a></span> | <span class="t">of the matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5902" target="_blank">01:38:22.800</a></span> | <span class="t">So the backward pass is slightly different, but it's nearly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5907" target="_blank">01:38:27.200</a></span> | <span class="t">And so then at the end of that, they will eventually come up with their suggestion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5915" target="_blank">01:38:35.720</a></span> | <span class="t">Let's see if we can find it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5917" target="_blank">01:38:37.360</a></span> | <span class="t">Oh yeah, here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5920" target="_blank">01:38:40.880</a></span> | <span class="t">They suggest root two over nL, where nL is the number of input activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5931" target="_blank">01:38:51.240</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5933" target="_blank">01:38:53.240</a></span> | <span class="t">So that's what we're using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5935" target="_blank">01:38:55.900</a></span> | <span class="t">That is called climbing initialization, and it gives us a pretty nice variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5940" target="_blank">01:39:00.500</a></span> | <span class="t">It doesn't give us a very nice mean though.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5943" target="_blank">01:39:03.600</a></span> | <span class="t">And the reason it doesn't give us a very nice mean is because as we saw, we deleted everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5947" target="_blank">01:39:07.020</a></span> | <span class="t">below the axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5949" target="_blank">01:39:09.280</a></span> | <span class="t">So naturally, our main is now half, not zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5954" target="_blank">01:39:14.680</a></span> | <span class="t">I haven't seen anybody talk about this in the literature, but something I was just trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5960" target="_blank">01:39:20.480</a></span> | <span class="t">over the last week is something kind of obvious, which is to replace value with not just x.plantmin,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5968" target="_blank">01:39:28.280</a></span> | <span class="t">but x.plantmin minus 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5971" target="_blank">01:39:31.440</a></span> | <span class="t">And in my brief experiments, that seems to help.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5975" target="_blank">01:39:35.160</a></span> | <span class="t">So there's another thing that you could try out and see if it actually helps or if I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5978" target="_blank">01:39:38.600</a></span> | <span class="t">just imagining things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5980" target="_blank">01:39:40.240</a></span> | <span class="t">It certainly returns you to the correct mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5984" target="_blank">01:39:44.760</a></span> | <span class="t">Okay, so now that we have this formula, we can replace it with init.climbing_normal according</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5994" target="_blank">01:39:54.720</a></span> | <span class="t">to our rules, because it's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=5997" target="_blank">01:39:57.720</a></span> | <span class="t">And let's check that it does the same thing, and it does, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6006" target="_blank">01:40:06.840</a></span> | <span class="t">So again, we've got this about half mean and bit under one standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6012" target="_blank">01:40:12.960</a></span> | <span class="t">You'll notice here I had to add something extra, which is mode equals fan out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6018" target="_blank">01:40:18.200</a></span> | <span class="t">What does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6022" target="_blank">01:40:22.440</a></span> | <span class="t">What it means is explained here, fan in or fan out, fan in preserves the magnitude of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6030" target="_blank">01:40:30.360</a></span> | <span class="t">variance in the forward pass, fan out preserves the magnitudes in the backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6035" target="_blank">01:40:35.120</a></span> | <span class="t">Basically, all it's saying is, are you dividing by root m or root nh?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6042" target="_blank">01:40:42.680</a></span> | <span class="t">Because if you divide by root m, as you'll see in that part of the paper I was suggesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6046" target="_blank">01:40:46.760</a></span> | <span class="t">you read, that will keep the variance at one during the forward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6050" target="_blank">01:40:50.920</a></span> | <span class="t">But if you use nh, it will give you the right unit variance in the backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6057" target="_blank">01:40:57.240</a></span> | <span class="t">So it's weird that I had to say fan out, because according to the documentation, that's for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6061" target="_blank">01:41:01.080</a></span> | <span class="t">the backward pass to keep the unit variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6065" target="_blank">01:41:05.680</a></span> | <span class="t">So why did I need that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6068" target="_blank">01:41:08.080</a></span> | <span class="t">Well, it's because our weight shape is 784 by 50, but if you actually create a linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6078" target="_blank">01:41:18.920</a></span> | <span class="t">layer with PyTorch of the same dimensions, it creates it of 50 by 784.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6087" target="_blank">01:41:27.040</a></span> | <span class="t">It's the opposite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6089" target="_blank">01:41:29.120</a></span> | <span class="t">So how can that possibly work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6090" target="_blank">01:41:30.600</a></span> | <span class="t">And these are the kind of things that it's useful to know how to dig into.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6093" target="_blank">01:41:33.840</a></span> | <span class="t">So how is this working?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6097" target="_blank">01:41:37.500</a></span> | <span class="t">So to find out how it's working, you have to look in the source code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6100" target="_blank">01:41:40.640</a></span> | <span class="t">So you can either set up Visual Studio code or something like that and kind of set it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6104" target="_blank">01:41:44.760</a></span> | <span class="t">up so you can jump between things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6106" target="_blank">01:41:46.880</a></span> | <span class="t">It's a nice way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6108" target="_blank">01:41:48.320</a></span> | <span class="t">Or you can just do it here with question mark, question mark.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6111" target="_blank">01:41:51.840</a></span> | <span class="t">And you can see that this is the forward function, and it calls something called f.linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6119" target="_blank">01:41:59.240</a></span> | <span class="t">In PyTorch, capital F always refers to the torch.nn.functional module, because you like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6127" target="_blank">01:42:07.680</a></span> | <span class="t">it's used everywhere, so they decided that's worth a single letter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6131" target="_blank">01:42:11.220</a></span> | <span class="t">So torch.nn.functional.linear is what it calls, and let's look at how that's defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6138" target="_blank">01:42:18.320</a></span> | <span class="t">Input.matmal.weight.t, t means transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6143" target="_blank">01:42:23.340</a></span> | <span class="t">So now we know in PyTorch, a linear layer doesn't just do a matrix product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6148" target="_blank">01:42:28.780</a></span> | <span class="t">It does a matrix product with a transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6152" target="_blank">01:42:32.080</a></span> | <span class="t">So in other words, it's actually going to turn this into 784 by 50 and then do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6157" target="_blank">01:42:37.160</a></span> | <span class="t">And so that's why we kind of had to give it the opposite information when we were trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6161" target="_blank">01:42:41.800</a></span> | <span class="t">to do it with our linear layer, which doesn't have transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6165" target="_blank">01:42:45.800</a></span> | <span class="t">So the main reason I show you that is to kind of show you how you can dig in to the PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6169" target="_blank">01:42:49.480</a></span> | <span class="t">source code, see exactly what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6172" target="_blank">01:42:52.400</a></span> | <span class="t">And when you come across these kind of questions, you want to be able to answer them yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6177" target="_blank">01:42:57.580</a></span> | <span class="t">Which also then leads to the question, if this is how linear layers can be initialized,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6183" target="_blank">01:43:03.360</a></span> | <span class="t">what about convolutional layers?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6185" target="_blank">01:43:05.400</a></span> | <span class="t">What does PyTorch do for convolutional layers?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6188" target="_blank">01:43:08.300</a></span> | <span class="t">So we could look inside torch.nn.conf2d, and when I looked at it, I noticed that it basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6194" target="_blank">01:43:14.480</a></span> | <span class="t">doesn't have any code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6195" target="_blank">01:43:15.480</a></span> | <span class="t">It just has documentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6197" target="_blank">01:43:17.420</a></span> | <span class="t">All of the code actually gets passed down to something called _convnd.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6202" target="_blank">01:43:22.480</a></span> | <span class="t">And so you need to know how to find these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6206" target="_blank">01:43:26.160</a></span> | <span class="t">And so if you go to the very bottom, you can find the file name it's in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6210" target="_blank">01:43:30.240</a></span> | <span class="t">And so you see this is actually torch.nn.modules.conf.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6214" target="_blank">01:43:34.840</a></span> | <span class="t">So we can find torch.nn.modules.conf._convnd.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6221" target="_blank">01:43:41.080</a></span> | <span class="t">And so here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6222" target="_blank">01:43:42.920</a></span> | <span class="t">And here's how it initializes things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6225" target="_blank">01:43:45.740</a></span> | <span class="t">And it calls chiming_uniform, which is basically the same as chiming_normal, but it's uniform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6230" target="_blank">01:43:50.800</a></span> | <span class="t">instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6232" target="_blank">01:43:52.260</a></span> | <span class="t">But it has a special multiplier of math.square root 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6237" target="_blank">01:43:57.440</a></span> | <span class="t">And that is not documented anywhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6239" target="_blank">01:43:59.240</a></span> | <span class="t">I have no idea where it comes from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6241" target="_blank">01:44:01.760</a></span> | <span class="t">And in my experiments, this seems to work pretty badly, as you'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6248" target="_blank">01:44:08.600</a></span> | <span class="t">So it's kind of useful to look inside the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6251" target="_blank">01:44:11.040</a></span> | <span class="t">And when you're writing your own code, presumably somebody put this here for a reason.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6255" target="_blank">01:44:15.440</a></span> | <span class="t">Wouldn't it have been nice if they had a URL above it with a link to the paper that they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6259" target="_blank">01:44:19.200</a></span> | <span class="t">implementing so we could see what's going on?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6262" target="_blank">01:44:22.720</a></span> | <span class="t">So it's always a good idea, always to put some comments in your code to let the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6266" target="_blank">01:44:26.520</a></span> | <span class="t">person know what the hell are you doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6269" target="_blank">01:44:29.600</a></span> | <span class="t">So that particular thing, I have a strong feeling, isn't great, as you'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6276" target="_blank">01:44:36.000</a></span> | <span class="t">So we're going to try this thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6278" target="_blank">01:44:38.960</a></span> | <span class="t">It's attracting 0.5 from our ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6281" target="_blank">01:44:41.320</a></span> | <span class="t">So this is pretty cool, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6283" target="_blank">01:44:43.240</a></span> | <span class="t">We've already designed our own new activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6288" target="_blank">01:44:48.960</a></span> | <span class="t">Is it great?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6289" target="_blank">01:44:49.960</a></span> | <span class="t">Is it terrible?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6290" target="_blank">01:44:50.960</a></span> | <span class="t">I don't know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6291" target="_blank">01:44:51.960</a></span> | <span class="t">But it's this kind of level of tweak, which is kind of-- when people write papers, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6297" target="_blank">01:44:57.840</a></span> | <span class="t">is the level of-- it's like a minor change to one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6300" target="_blank">01:45:00.960</a></span> | <span class="t">It'll be interesting to see how much it helps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6303" target="_blank">01:45:03.400</a></span> | <span class="t">But if I use it, then you can see here, yep, now I have a mean of 0 thereabouts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6312" target="_blank">01:45:12.080</a></span> | <span class="t">And interestingly, I've also noticed it helps my variance a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6315" target="_blank">01:45:15.760</a></span> | <span class="t">All of my variance, remember, was generally around 0.7 to 0.8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6319" target="_blank">01:45:19.200</a></span> | <span class="t">But now it's generally above 0.8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6321" target="_blank">01:45:21.640</a></span> | <span class="t">So it helps both, which makes sense as to why I think I'm seeing these better results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6328" target="_blank">01:45:28.720</a></span> | <span class="t">So now we have ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6330" target="_blank">01:45:30.860</a></span> | <span class="t">We have a linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6332" target="_blank">01:45:32.640</a></span> | <span class="t">We have init.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6334" target="_blank">01:45:34.000</a></span> | <span class="t">So we can do a forward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6337" target="_blank">01:45:37.920</a></span> | <span class="t">So we're now up to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6342" target="_blank">01:45:42.920</a></span> | <span class="t">And so here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6344" target="_blank">01:45:44.160</a></span> | <span class="t">And remember, in PyTorch, a model can just be a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6347" target="_blank">01:45:47.660</a></span> | <span class="t">And so here's our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6348" target="_blank">01:45:48.800</a></span> | <span class="t">It's just a function that does one linear layer, one ReLU layer, and one more linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6354" target="_blank">01:45:54.260</a></span> | <span class="t">layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6356" target="_blank">01:45:56.680</a></span> | <span class="t">And let's try running it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6358" target="_blank">01:45:58.040</a></span> | <span class="t">And OK, it takes eight milliseconds to run the model on the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6363" target="_blank">01:46:03.000</a></span> | <span class="t">So it's plenty fast enough to train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6366" target="_blank">01:46:06.200</a></span> | <span class="t">It's looking good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6369" target="_blank">01:46:09.160</a></span> | <span class="t">Add an assert to make sure the shape seems sensible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6373" target="_blank">01:46:13.700</a></span> | <span class="t">So the next thing we need for our forward pass is a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6378" target="_blank">01:46:18.080</a></span> | <span class="t">And as I said, we're going to simplify things for now by using mean squared error, even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6383" target="_blank">01:46:23.400</a></span> | <span class="t">though that's obviously a dumb idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6386" target="_blank">01:46:26.240</a></span> | <span class="t">Our model is returning something of size 10,000 by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6391" target="_blank">01:46:31.720</a></span> | <span class="t">But mean squared error, you would expect it just to be a single vector of size 10,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6397" target="_blank">01:46:37.680</a></span> | <span class="t">So I want to get rid of this unit axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6400" target="_blank">01:46:40.640</a></span> | <span class="t">In PyTorch, the thing to add a unit axis we've learned is called squeeze-- sorry, unsqueeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6407" target="_blank">01:46:47.120</a></span> | <span class="t">The thing to get rid of a unit axis, therefore, is called squeeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6409" target="_blank">01:46:49.760</a></span> | <span class="t">So we just go output.squeeze to get rid of that unit axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6415" target="_blank">01:46:55.300</a></span> | <span class="t">But actually, now I think about it-- this is lazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6419" target="_blank">01:46:59.400</a></span> | <span class="t">Because output.squeeze gets rid of all unit axes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6423" target="_blank">01:47:03.080</a></span> | <span class="t">And we very commonly see on the fastAO forums people saying that their code's broken.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6428" target="_blank">01:47:08.260</a></span> | <span class="t">And it's when they've got squeeze.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6431" target="_blank">01:47:11.020</a></span> | <span class="t">And it's that one case where maybe they had a batch size of size 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6435" target="_blank">01:47:15.080</a></span> | <span class="t">And so that 1,1 would get squeezed down to a scalar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6439" target="_blank">01:47:19.240</a></span> | <span class="t">And things would break.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6440" target="_blank">01:47:20.380</a></span> | <span class="t">So rather than just calling squeeze, it's actually better to say which dimension you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6443" target="_blank">01:47:23.800</a></span> | <span class="t">want to squeeze, which we could write either 1 or minus 1, it would be the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6448" target="_blank">01:47:28.320</a></span> | <span class="t">And this is going to be more resilient now to that weird edge case of a batch size of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6452" target="_blank">01:47:32.740</a></span> | <span class="t">size 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6453" target="_blank">01:47:33.880</a></span> | <span class="t">OK, so output minus target squared main-- that's main squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6461" target="_blank">01:47:41.000</a></span> | <span class="t">So remember, in PyTorch, loss functions can just be functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6466" target="_blank">01:47:46.560</a></span> | <span class="t">For main squared error, we're going to have to make sure these are floats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6468" target="_blank">01:47:48.920</a></span> | <span class="t">So let's convert them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6470" target="_blank">01:47:50.340</a></span> | <span class="t">So now we can calculate some predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6473" target="_blank">01:47:53.400</a></span> | <span class="t">That's the shape of our predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6475" target="_blank">01:47:55.240</a></span> | <span class="t">And we can calculate our main squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6477" target="_blank">01:47:57.560</a></span> | <span class="t">So there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6478" target="_blank">01:47:58.560</a></span> | <span class="t">So we've done a forward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6481" target="_blank">01:48:01.440</a></span> | <span class="t">So we're up to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6483" target="_blank">01:48:03.520</a></span> | <span class="t">A forward pass is useless.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6485" target="_blank">01:48:05.520</a></span> | <span class="t">What we need is a backward pass, because that's the thing that tells us how to update our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6489" target="_blank">01:48:09.680</a></span> | <span class="t">parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6491" target="_blank">01:48:11.200</a></span> | <span class="t">So we need gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6493" target="_blank">01:48:13.600</a></span> | <span class="t">OK, how much do you want to know about matrix calculus?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6497" target="_blank">01:48:17.440</a></span> | <span class="t">I don't know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6499" target="_blank">01:48:19.160</a></span> | <span class="t">It's up to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6500" target="_blank">01:48:20.160</a></span> | <span class="t">But if you want to know everything about matrix calculus, I can point you to this excellent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6505" target="_blank">01:48:25.040</a></span> | <span class="t">paper by Terrence Parr and Jeremy Howard, which tells you everything about matrix calculus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6514" target="_blank">01:48:34.320</a></span> | <span class="t">from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6517" target="_blank">01:48:37.480</a></span> | <span class="t">So this is a few weeks work to get through, but it absolutely assumes nothing at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6524" target="_blank">01:48:44.360</a></span> | <span class="t">So basically, Terrence and I both felt like, oh, we don't know any of this stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6532" target="_blank">01:48:52.560</a></span> | <span class="t">Let's learn all of it and tell other people.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6535" target="_blank">01:48:55.080</a></span> | <span class="t">And so we wrote it with that in mind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6538" target="_blank">01:48:58.200</a></span> | <span class="t">And so this will take you all the way up to knowing everything that you need for deep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6543" target="_blank">01:49:03.920</a></span> | <span class="t">learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6546" target="_blank">01:49:06.000</a></span> | <span class="t">You can actually get away with a lot less.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6549" target="_blank">01:49:09.320</a></span> | <span class="t">But if you're here, maybe it's worth it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6552" target="_blank">01:49:12.560</a></span> | <span class="t">But I'll tell you what you do need to know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6555" target="_blank">01:49:15.040</a></span> | <span class="t">What you need to know is the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6560" target="_blank">01:49:20.520</a></span> | <span class="t">Because let me point something out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6566" target="_blank">01:49:26.480</a></span> | <span class="t">We start with some input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6573" target="_blank">01:49:33.920</a></span> | <span class="t">We start with some input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6576" target="_blank">01:49:36.320</a></span> | <span class="t">And we stick it through the first linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6580" target="_blank">01:49:40.260</a></span> | <span class="t">And then we stick it through ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6582" target="_blank">01:49:42.960</a></span> | <span class="t">And then we stick it through the second linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6586" target="_blank">01:49:46.120</a></span> | <span class="t">And then we stick it through MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6589" target="_blank">01:49:49.160</a></span> | <span class="t">And that gives us our predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6591" target="_blank">01:49:51.920</a></span> | <span class="t">Or to put it another way, we start with x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6600" target="_blank">01:50:00.840</a></span> | <span class="t">And we put it through the function lin1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6605" target="_blank">01:50:05.040</a></span> | <span class="t">And then we take the output of that, and we put it through the function ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6610" target="_blank">01:50:10.080</a></span> | <span class="t">And then we take the output of that, and we put it through the function lin2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6614" target="_blank">01:50:14.920</a></span> | <span class="t">And then we take the output of that, and we put it through the function MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6620" target="_blank">01:50:20.380</a></span> | <span class="t">And strictly speaking, MSE has a second argument, which is the actual target value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6630" target="_blank">01:50:30.840</a></span> | <span class="t">And we want the gradient of the output with respect to the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6640" target="_blank">01:50:40.240</a></span> | <span class="t">So it's a function of a function of a function of a function of a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6643" target="_blank">01:50:43.480</a></span> | <span class="t">So if we simplify that down a bit, we could just say, what if it's just like y equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6649" target="_blank">01:50:49.680</a></span> | <span class="t">f of x-- sorry, y equals f of u and u equals f of x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6660" target="_blank">01:51:00.640</a></span> | <span class="t">So that's like a function of a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6662" target="_blank">01:51:02.480</a></span> | <span class="t">Simplify it a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6664" target="_blank">01:51:04.160</a></span> | <span class="t">And the derivative is that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6673" target="_blank">01:51:13.480</a></span> | <span class="t">That's the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6676" target="_blank">01:51:16.360</a></span> | <span class="t">If that doesn't look familiar to you, or you've forgotten it, go to Khan Academy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6680" target="_blank">01:51:20.680</a></span> | <span class="t">Khan Academy has some great tutorials on the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6683" target="_blank">01:51:23.920</a></span> | <span class="t">But this is actually the thing we need to know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6686" target="_blank">01:51:26.440</a></span> | <span class="t">Because once you know that, then all you need to know is the derivative of each bit on its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6692" target="_blank">01:51:32.040</a></span> | <span class="t">own, and you just multiply them all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6697" target="_blank">01:51:37.400</a></span> | <span class="t">And if you ever forget the chain rule, just cross-multiply.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6701" target="_blank">01:51:41.960</a></span> | <span class="t">So that would be dy/dx, cross out to the u's, you get dy/dx.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6710" target="_blank">01:51:50.680</a></span> | <span class="t">And if you went to a fancy school, they would have told you not to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6715" target="_blank">01:51:55.400</a></span> | <span class="t">They said you can't treat calculus like this, because they're special magic small things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6723" target="_blank">01:52:03.040</a></span> | <span class="t">Actually you can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6724" target="_blank">01:52:04.840</a></span> | <span class="t">There's actually a different way of treating calculus called the calculus of infinitesimals,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6730" target="_blank">01:52:10.720</a></span> | <span class="t">where all of this just makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6732" target="_blank">01:52:12.540</a></span> | <span class="t">And you suddenly realize you actually can do this exact thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6737" target="_blank">01:52:17.580</a></span> | <span class="t">So any time you see a derivative, just remember that all it's actually doing is it's taking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6745" target="_blank">01:52:25.640</a></span> | <span class="t">some function, and it's saying, as you go across a little bit, how much do you go up?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6754" target="_blank">01:52:34.600</a></span> | <span class="t">And that it's dividing that change in y divided by that change in x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6761" target="_blank">01:52:41.240</a></span> | <span class="t">That's literally what it is, where y and x, you must make them small numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6766" target="_blank">01:52:46.160</a></span> | <span class="t">So they behave very sensibly when you just think of them as a small change in y over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6772" target="_blank">01:52:52.760</a></span> | <span class="t">a small change in x, as I just did, showing you the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6777" target="_blank">01:52:57.280</a></span> | <span class="t">So to do the chain rule, we're going to have to start with the very last function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6784" target="_blank">01:53:04.720</a></span> | <span class="t">The very last function on the outside was the loss function, mean squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6789" target="_blank">01:53:09.800</a></span> | <span class="t">So we just do each bit separately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6792" target="_blank">01:53:12.600</a></span> | <span class="t">So the gradient of the loss with respect to output of previous layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6806" target="_blank">01:53:26.000</a></span> | <span class="t">So the output of the previous layer, the MSC is just input minus target squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6814" target="_blank">01:53:34.740</a></span> | <span class="t">And so the derivative of that is just 2 times input minus target, because the derivative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6818" target="_blank">01:53:38.840</a></span> | <span class="t">of blah squared is 2 times blah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6822" target="_blank">01:53:42.920</a></span> | <span class="t">So that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6824" target="_blank">01:53:44.680</a></span> | <span class="t">Now I need to store that gradient somewhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6827" target="_blank">01:53:47.520</a></span> | <span class="t">Now the thing is that for the chain rule, I'm going to need to multiply all these things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6831" target="_blank">01:53:51.760</a></span> | <span class="t">together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6833" target="_blank">01:53:53.280</a></span> | <span class="t">So if I store it inside the dot g attribute of the previous layer, because remember this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6840" target="_blank">01:54:00.520</a></span> | <span class="t">is the previous layer, then when the previous layer, so the input of MSC is the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6847" target="_blank">01:54:07.800</a></span> | <span class="t">the output of the previous layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6850" target="_blank">01:54:10.640</a></span> | <span class="t">So if I store it away in here, I can then quite comfortably refer to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6856" target="_blank">01:54:16.600</a></span> | <span class="t">So here, look, ReLU, let's do ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6862" target="_blank">01:54:22.960</a></span> | <span class="t">So ReLU is this, okay, what's the gradient there?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6872" target="_blank">01:54:32.240</a></span> | <span class="t">0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6873" target="_blank">01:54:33.240</a></span> | <span class="t">What's the gradient there?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6875" target="_blank">01:54:35.640</a></span> | <span class="t">1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6877" target="_blank">01:54:37.400</a></span> | <span class="t">So therefore, that's the gradient of the ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6882" target="_blank">01:54:42.480</a></span> | <span class="t">It's just imp greater than 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6885" target="_blank">01:54:45.280</a></span> | <span class="t">But we need the chain rule, so we need to multiply this by the gradient of the next layer, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6893" target="_blank">01:54:53.520</a></span> | <span class="t">remember we store it away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6896" target="_blank">01:54:56.900</a></span> | <span class="t">So we can just grab it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6899" target="_blank">01:54:59.100</a></span> | <span class="t">So this is really cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6901" target="_blank">01:55:01.880</a></span> | <span class="t">So same thing for the linear layer, the gradient is simply, and this is where the matrix calculus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6908" target="_blank">01:55:08.000</a></span> | <span class="t">comes in, the gradient of a matrix product is simply the matrix product with the transpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6913" target="_blank">01:55:13.980</a></span> | <span class="t">So you can either read all that stuff I showed you, or you can take my word for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6919" target="_blank">01:55:19.520</a></span> | <span class="t">So here's the cool thing, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6922" target="_blank">01:55:22.640</a></span> | <span class="t">Here's the function which does the forward pass that we've already seen, and then it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6928" target="_blank">01:55:28.640</a></span> | <span class="t">goes backwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6929" target="_blank">01:55:29.640</a></span> | <span class="t">It calls each of the gradients backwards, right, in reverse order, because we know we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6933" target="_blank">01:55:33.080</a></span> | <span class="t">need that for the chain rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6935" target="_blank">01:55:35.300</a></span> | <span class="t">And you can notice that every time we're passing in the result of the forward pass, and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6942" target="_blank">01:55:42.340</a></span> | <span class="t">also has access, as we discussed, to the gradient of the next layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6949" target="_blank">01:55:49.800</a></span> | <span class="t">This is called backpropagation, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6952" target="_blank">01:55:52.280</a></span> | <span class="t">So when people say, as they love to do, backpropagation is not just the chain rule, they're basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6960" target="_blank">01:56:00.080</a></span> | <span class="t">lying to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6961" target="_blank">01:56:01.320</a></span> | <span class="t">Backpropagation is the chain rule, where we just save away all the intermediate calculations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6966" target="_blank">01:56:06.240</a></span> | <span class="t">so we don't have to calculate them again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6969" target="_blank">01:56:09.560</a></span> | <span class="t">So this is a full forward and backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6978" target="_blank">01:56:18.280</a></span> | <span class="t">One interesting thing here is this value here, loss, this value here, loss, we never actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6986" target="_blank">01:56:26.980</a></span> | <span class="t">use it, because the loss never actually appears in the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6993" target="_blank">01:56:33.980</a></span> | <span class="t">I mean, just by the way, you still probably want it to be able to print it out, or whatever,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=6998" target="_blank">01:56:38.800</a></span> | <span class="t">but it's actually not something that appears in the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7002" target="_blank">01:56:42.400</a></span> | <span class="t">So that's it, so w1.g, w2.g, et cetera, they now contain all of our gradients, which we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7011" target="_blank">01:56:51.320</a></span> | <span class="t">going to use for the optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7015" target="_blank">01:56:55.180</a></span> | <span class="t">And so let's cheat and use PyTorch autograd to check our results, because PyTorch can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7022" target="_blank">01:57:02.000</a></span> | <span class="t">do this for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7023" target="_blank">01:57:03.860</a></span> | <span class="t">So let's clone all of our weights and biases and input, and then turn on requires-grad</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7033" target="_blank">01:57:13.420</a></span> | <span class="t">for all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7034" target="_blank">01:57:14.420</a></span> | <span class="t">So requires-grad_ is how you take a PyTorch tensor and turn it into a magical autogradified</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7041" target="_blank">01:57:21.060</a></span> | <span class="t">PyTorch tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7042" target="_blank">01:57:22.460</a></span> | <span class="t">So what it's now going to do is everything that gets calculated with test tensor, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7046" target="_blank">01:57:26.380</a></span> | <span class="t">basically going to keep track of what happened.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7050" target="_blank">01:57:30.340</a></span> | <span class="t">So it basically keeps track of these steps, so that then it can do these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7055" target="_blank">01:57:35.200</a></span> | <span class="t">It's not actually that magical, you could totally write it yourself, you just need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7059" target="_blank">01:57:39.460</a></span> | <span class="t">make sure that each time you do an operation, you remember what it is, and so then you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7064" target="_blank">01:57:44.760</a></span> | <span class="t">just go back through them in reverse order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7068" target="_blank">01:57:48.000</a></span> | <span class="t">Okay, so now that we've done requires-grad, we can now just do the forward pass like so,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7076" target="_blank">01:57:56.880</a></span> | <span class="t">that gives us loss in PyTorch, you say loss.backward, and now we can test that, and remember PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7083" target="_blank">01:58:03.080</a></span> | <span class="t">doesn't store things in .g, it stores them in .grad, and we can test them, and all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7089" target="_blank">01:58:09.380</a></span> | <span class="t">our gradients were correct, or at least they're the same as PyTorch's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7095" target="_blank">01:58:15.120</a></span> | <span class="t">So that's pretty interesting, right, I mean that's an actual neural network that kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7102" target="_blank">01:58:22.840</a></span> | <span class="t">of contains all the main pieces that we're going to need, and we've written all these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7108" target="_blank">01:58:28.520</a></span> | <span class="t">pieces from scratch, so there's nothing magical here, but let's do some cool refactoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7115" target="_blank">01:58:35.960</a></span> | <span class="t">I really love this refactoring, and this is massively inspired by and very closely stolen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7122" target="_blank">01:58:42.040</a></span> | <span class="t">from the PyTorch API, but it's kind of interesting, I didn't have the PyTorch API in mind as I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7127" target="_blank">01:58:47.400</a></span> | <span class="t">did this, but as I kept refactoring, I kind of noticed like, oh, I just recreated the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7132" target="_blank">01:58:52.920</a></span> | <span class="t">PyTorch API, that makes perfect sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7135" target="_blank">01:58:55.500</a></span> | <span class="t">So let's take each of our layers, relu and linear, and create classes, right, and for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7144" target="_blank">01:59:04.280</a></span> | <span class="t">the forward, let's use dundercall, now do you remember that dundercall means that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7150" target="_blank">01:59:10.040</a></span> | <span class="t">can now treat this as if it was a function, right, so if you call this class just with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7153" target="_blank">01:59:13.800</a></span> | <span class="t">parentheses, it calls this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7157" target="_blank">01:59:17.260</a></span> | <span class="t">And let's save the input, let's save the output, and let's return the output, right,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7165" target="_blank">01:59:25.120</a></span> | <span class="t">and then backward, do you remember this was our backward pass, okay, so it's exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7170" target="_blank">01:59:30.000</a></span> | <span class="t">same as we had before, okay, but we're going to save it inside self.input.gradient, so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7175" target="_blank">01:59:35.880</a></span> | <span class="t">is exactly the same code as we had here, okay, but I've just moved the forward and backward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7182" target="_blank">01:59:42.200</a></span> | <span class="t">into the same class, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7185" target="_blank">01:59:45.240</a></span> | <span class="t">So here's linear, forward, exactly the same, but each time I'm saving the input, I'm saving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7191" target="_blank">01:59:51.720</a></span> | <span class="t">the output, I'm returning the output, and then here's our backward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7202" target="_blank">02:00:02.560</a></span> | <span class="t">One thing to notice, the backward pass here, for linear, we don't just want the gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7211" target="_blank">02:00:11.720</a></span> | <span class="t">of the outputs with respect to the inputs, we also need the gradient of the outputs with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7217" target="_blank">02:00:17.640</a></span> | <span class="t">respect to the weights and the output with respect to the biases, right, so that's why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7221" target="_blank">02:00:21.560</a></span> | <span class="t">we've got three lots of dot g's going on here, okay, so there's our linear layers forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7232" target="_blank">02:00:32.360</a></span> | <span class="t">and backward, and then we've got our mean squared error, okay, so there's our forward,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7246" target="_blank">02:00:46.160</a></span> | <span class="t">and we'll save away both the input and the target for using later, and there's our gradient,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7251" target="_blank">02:00:51.000</a></span> | <span class="t">again, same as before, two times input minus target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7255" target="_blank">02:00:55.940</a></span> | <span class="t">So with this refactoring, we can now create our model, we can just say let's create a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7262" target="_blank">02:01:02.320</a></span> | <span class="t">class and create something called dot layers with a list of all of our layers, all right,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7267" target="_blank">02:01:07.720</a></span> | <span class="t">notice I'm not using any PyTorch machinery, this is all from scratch, let's define loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7274" target="_blank">02:01:14.200</a></span> | <span class="t">and then let's define call, and it's going to go through each layer and say x equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7279" target="_blank">02:01:19.440</a></span> | <span class="t">lx, so this is how I do that function composition, we're just calling the function on the result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7284" target="_blank">02:01:24.880</a></span> | <span class="t">of the previous thing, okay, and then at the other very end call self dot loss on that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7291" target="_blank">02:01:31.640</a></span> | <span class="t">and then for backward we do the exact opposite, we go self dot loss dot backward and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7296" target="_blank">02:01:36.240</a></span> | <span class="t">we go through the reversed layers and call backward on each one, right, and remember the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7301" target="_blank">02:01:41.120</a></span> | <span class="t">backward passes are going to save the gradient away inside the dot g, so with that, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7311" target="_blank">02:01:51.640</a></span> | <span class="t">just set all of our gradients to none so that we know we're not cheating, we can then create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7315" target="_blank">02:01:55.600</a></span> | <span class="t">our model, right, this class model, and call it, and we can call it as if it was a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7323" target="_blank">02:02:03.480</a></span> | <span class="t">because we have done to call, right, so this is going to call done to call, and then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7330" target="_blank">02:02:10.720</a></span> | <span class="t">can call backward, and then we can check that our gradients are correct, right, so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7337" target="_blank">02:02:17.080</a></span> | <span class="t">nice, one thing that's not nice is, holy crap that took a long time, let's run it, there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7346" target="_blank">02:02:26.800</a></span> | <span class="t">we go, 3.4 seconds, so that was really really slow, so we'll come back to that, I don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7356" target="_blank">02:02:36.840</a></span> | <span class="t">like duplicate code, there's a lot of duplicate code here, self dot imp equals imp, return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7362" target="_blank">02:02:42.040</a></span> | <span class="t">self dot out, that's messy, so let's get rid of it, so what we could do is we could create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7368" target="_blank">02:02:48.520</a></span> | <span class="t">a new class called module, which basically does the self dot imp equals imp, and return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7374" target="_blank">02:02:54.340</a></span> | <span class="t">self dot out for us, and so now we're not going to use done to call to implement our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7381" target="_blank">02:03:01.240</a></span> | <span class="t">forward, we're going to have a call something called self dot forward, which we will initially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7386" target="_blank">02:03:06.140</a></span> | <span class="t">set to raise exception, not implemented, and backward is going to call self dot bwd, passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7394" target="_blank">02:03:14.160</a></span> | <span class="t">in the thing that we just saved, and so now relu has something called forward, which just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7400" target="_blank">02:03:20.540</a></span> | <span class="t">has that, so we're now basically back to where we were, and backward just has that, right,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7407" target="_blank">02:03:27.360</a></span> | <span class="t">so now look how neat that is, and we also realized that this thing we were doing to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7419" target="_blank">02:03:39.880</a></span> | <span class="t">the derivative of the output of the linear layer with respect to the weights, where we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7426" target="_blank">02:03:46.840</a></span> | <span class="t">doing an unsqueeze and an unsqueeze, which is basically a big adder product and a sum,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7431" target="_blank">02:03:51.840</a></span> | <span class="t">we could actually re-express that with einsum, okay, and when we do that, so our code is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7440" target="_blank">02:04:00.580</a></span> | <span class="t">now neater, and our 3.4 seconds is down to 143 milliseconds, okay, so thank you again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7448" target="_blank">02:04:08.320</a></span> | <span class="t">to einsum, so you'll see this now, look, model equals model, loss equals bla, bla dot backward,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7459" target="_blank">02:04:19.320</a></span> | <span class="t">and now the gradients are all there, that looks almost exactly like PyTorch, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7465" target="_blank">02:04:25.780</a></span> | <span class="t">we can see why, why it's done this way, why do we have to inherit from nn dot module,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7471" target="_blank">02:04:31.960</a></span> | <span class="t">why do we have to define forward, this is why, right, it lets PyTorch factor out all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7477" target="_blank">02:04:37.600</a></span> | <span class="t">this duplicate stuff, so all we have to do is do the implementation, so I think that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7483" target="_blank">02:04:43.680</a></span> | <span class="t">pretty fun, and then once we realized, we thought more about it, more like what are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7489" target="_blank">02:04:49.840</a></span> | <span class="t">we doing with this einsum, and we actually realized that it's exactly the same as just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7494" target="_blank">02:04:54.360</a></span> | <span class="t">doing input dot transpose times output, so we replaced the einsum with a matrix product,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7501" target="_blank">02:05:01.600</a></span> | <span class="t">and that's 140 milliseconds, and so now we've basically implemented nn dot linear and nn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7510" target="_blank">02:05:10.520</a></span> | <span class="t">dot module, so let's now use nn dot linear and nn dot module, because we're allowed to,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7517" target="_blank">02:05:17.140</a></span> | <span class="t">that's the rules, and the forward pass is almost exactly the same speed as our forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7521" target="_blank">02:05:21.760</a></span> | <span class="t">pass, and their backward pass is about twice as fast, I'm guessing that's because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7529" target="_blank">02:05:29.360</a></span> | <span class="t">calculating all of the gradients, and they're not calculating all of them, only the ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7534" target="_blank">02:05:34.080</a></span> | <span class="t">they need, but it's basically the same thing. So at this point, we're ready in the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7542" target="_blank">02:05:42.960</a></span> | <span class="t">lesson to do a training loop. We have something, we have a multi-layer fully connected neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7552" target="_blank">02:05:52.320</a></span> | <span class="t">network, what her paper would call a rectified network, we have matrix multiply organized,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7561" target="_blank">02:06:01.440</a></span> | <span class="t">we have our forward and backward passes organized, it's all nicely refactored out into classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7566" target="_blank">02:06:06.960</a></span> | <span class="t">and a module class, so in the next lesson, we will see how far we can get, hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7573" target="_blank">02:06:13.820</a></span> | <span class="t">we will build a high quality, fast ResNet, and we're also going to take a very deep dive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7583" target="_blank">02:06:23.120</a></span> | <span class="t">into optimizers and callbacks and training loops and normalization methods. Any questions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7591" target="_blank">02:06:31.200</a></span> | <span class="t">before we go? No? That's great. Okay, thanks everybody, see you on the forums.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=4u8FxNEDUeg&t=7597" target="_blank">02:06:37.440</a></span> | <span class="t">(audience applauds)</span></div></div></body></html>