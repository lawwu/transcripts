<html><head><title>Lesson 12: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 12: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=_xIzPbCgutY"><img src="https://i.ytimg.com/vi/_xIzPbCgutY/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=15">0:15</a> CLIP Interrogator & how it works<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=652">10:52</a> Matrix multiplication refresher<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=719">11:59</a> Einstein summation<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1114">18:34</a> Matrix multiplication put on to the GPU<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2011">33:31</a> Clustering (Meanshift)<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2225">37:5</a> Create Synthetic Centroids<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2507">41:47</a> Mean shift algorithm<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2857">47:37</a> Plotting gaussian kernels<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3213">53:33</a> Calculating distances between points<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3462">57:42</a> Calculating distances between points (illustrated)<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3865">64:25</a> Getting the weights and weighted average of all the points<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4313">71:53</a> Matplotlib animations<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4534">75:34</a> Accelerating our work by putting it on the GPU<br><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5853">97:33</a> Calculus refresher<br><br><div style="text-align: left;"><a href="./_xIzPbCgutY.html">Whisper Transcript</a> | <a href="./transcript__xIzPbCgutY.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi everybody, welcome back to lesson 12 of Practical Deep Learning for Coders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=9" target="_blank">00:00:09.480</a></span> | <span class="t">So got a lot of stuff to cover today so let's dive straight in and I actually thought I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=13" target="_blank">00:00:13.700</a></span> | <span class="t">would start by sharing something which I've seen been getting a lot of attention recently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=20" target="_blank">00:00:20.380</a></span> | <span class="t">which is the Clip Interrogator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=22" target="_blank">00:00:22.700</a></span> | <span class="t">So the Clip Interrogator is a hugging face basis I guess radio app where I uploaded my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=28" target="_blank">00:00:28.440</a></span> | <span class="t">image here and it's output, let's just zoom in a bit, it's output a text prompt for creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=42" target="_blank">00:00:42.440</a></span> | <span class="t">a clip embedding from I guess.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=46" target="_blank">00:00:46.760</a></span> | <span class="t">So I've seen a lot of folks on Twitter and elsewhere on the internet saying that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=53" target="_blank">00:00:53.240</a></span> | <span class="t">is producing the clip prompt that would generate this image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=61" target="_blank">00:01:01.880</a></span> | <span class="t">And generally speaking the clip, the prompts it creates a rather rude, my one's less rude</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=68" target="_blank">00:01:08.240</a></span> | <span class="t">than the some although you know extremely long forehead maybe not thanks very much but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=71" target="_blank">00:01:11.960</a></span> | <span class="t">your personal data avatar, funny professional photo, I don't know what tectonics is meant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=79" target="_blank">00:01:19.160</a></span> | <span class="t">to mean here without eyebrows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=82" target="_blank">00:01:22.160</a></span> | <span class="t">So this doesn't actually return the clip prompt that would generate this photo at all and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=93" target="_blank">00:01:33.000</a></span> | <span class="t">the fact that some people are saying that makes me realize that some people have no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=96" target="_blank">00:01:36.880</a></span> | <span class="t">idea what's going on with stable diffusion so I thought we might take this as an opportunity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=101" target="_blank">00:01:41.840</a></span> | <span class="t">to explain why we can't do that and what we can try and do instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=108" target="_blank">00:01:48.720</a></span> | <span class="t">So let's imagine that my friend took a photo and of himself and he wanted to send me his</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=122" target="_blank">00:02:02.480</a></span> | <span class="t">photo and he thought he would compress it a whole lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=126" target="_blank">00:02:06.620</a></span> | <span class="t">So what he did was he put it through the clip image encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=134" target="_blank">00:02:14.120</a></span> | <span class="t">So that's going to take this big image and it's going to turn it into an embedding and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=145" target="_blank">00:02:25.360</a></span> | <span class="t">the embedding is much much smaller than the image it's just a vector of a few floats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=155" target="_blank">00:02:35.680</a></span> | <span class="t">So then my friend hopes that they could send me this embedding and so they send that over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=166" target="_blank">00:02:46.200</a></span> | <span class="t">at an email and they say there you go Jeremy there's a clip embedding of the photo I wanted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=169" target="_blank">00:02:49.680</a></span> | <span class="t">to send you so now you just have to decode it to turn it back into a picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=180" target="_blank">00:03:00.080</a></span> | <span class="t">So now I've got the embedding and I have to decode it. How would you do that? Well you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=191" target="_blank">00:03:11.980</a></span> | <span class="t">can't. Okay we have a function here or let's call it f which is the clip image encoder which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=200" target="_blank">00:03:20.040</a></span> | <span class="t">takes as import an image which I'll call x and returns an embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=206" target="_blank">00:03:26.800</a></span> | <span class="t">Does that mean that there is some other function and inverse functions we normally write with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=211" target="_blank">00:03:31.720</a></span> | <span class="t">a minus one an inverse function with which I can take that embedding let's say we call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=217" target="_blank">00:03:37.880</a></span> | <span class="t">that y we pass it y and it would give us back our photo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=233" target="_blank">00:03:53.520</a></span> | <span class="t">And so y remember is f of x so to put it another way this is f inverse of f of f of y. So an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=241" target="_blank">00:04:01.880</a></span> | <span class="t">inverse function is something that undoes a function and so that gives you back y. Is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=248" target="_blank">00:04:08.320</a></span> | <span class="t">there an inverse function for the clip image encoder? Well not everything has an has an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=257" target="_blank">00:04:17.240</a></span> | <span class="t">inverse function. For example consider the function like let's say in Python which takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=266" target="_blank">00:04:26.200</a></span> | <span class="t">f of x return 0. Can you invert that function? If you get back you pass in 3 you get back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=280" target="_blank">00:04:40.880</a></span> | <span class="t">0. Is there a function that's going to take the output and give you back the input? No</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=287" target="_blank">00:04:47.200</a></span> | <span class="t">of course not because you just threw the whole thing away. So not all functions can be inverted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=294" target="_blank">00:04:54.400</a></span> | <span class="t">and indeed in this case we've started with a function which is whatever 512 by 512 by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=301" target="_blank">00:05:01.600</a></span> | <span class="t">3 say and we've turned it into about something much much smaller. I can't remember exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=309" target="_blank">00:05:09.240</a></span> | <span class="t">how big a clip image encoding encoding is embedding is but it's much smaller. So clearly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=314" target="_blank">00:05:14.000</a></span> | <span class="t">we're losing something. But what I could do is I could put it through a diffusion process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=327" target="_blank">00:05:27.560</a></span> | <span class="t">and so remember a diffusion process is something where we have learned we have taught or I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=334" target="_blank">00:05:34.480</a></span> | <span class="t">don't know taught an algorithm has learned to take some noise so we could start with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=341" target="_blank">00:05:41.960</a></span> | <span class="t">some noise and we could start with an image embedding. We haven't done this before but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=347" target="_blank">00:05:47.200</a></span> | <span class="t">we could do that. We could train something that takes noise in an image embedding and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=351" target="_blank">00:05:51.120</a></span> | <span class="t">removes a bit of the noise and we could run that a bunch of times. And it wouldn't give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=357" target="_blank">00:05:57.800</a></span> | <span class="t">us back the original picture but hopefully it would give us something back if it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=362" target="_blank">00:06:02.920</a></span> | <span class="t">conditional. So remember using the conditional diffusion approach we'd get back something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=368" target="_blank">00:06:08.040</a></span> | <span class="t">that might be something like our original image. So that's what diffusion is right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=375" target="_blank">00:06:15.040</a></span> | <span class="t">Diffusion is something that takes an embedding and inverts an encoder to give you back something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=382" target="_blank">00:06:22.920</a></span> | <span class="t">that hopefully might generate that embedding. Now of course remember we don't actually get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=388" target="_blank">00:06:28.320</a></span> | <span class="t">image embeddings when we do prompts in stable diffusion instead we have text embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=399" target="_blank">00:06:39.320</a></span> | <span class="t">But if you remember that actually doesn't matter because you remember how we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=405" target="_blank">00:06:45.600</a></span> | <span class="t">or we open AI trained clip so that they had various pictures along with their captions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=416" target="_blank">00:06:56.160</a></span> | <span class="t">and they trained an algorithm that was explicitly designed to make it so that each image returned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=424" target="_blank">00:07:04.600</a></span> | <span class="t">a embedding for the image that was similar to the embedding that the text encoder created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=432" target="_blank">00:07:12.200</a></span> | <span class="t">for the caption. And remember all of the stuff that didn't match it was trained to be different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=439" target="_blank">00:07:19.960</a></span> | <span class="t">And so that means that a text embedding which describes this picture and the actual image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=447" target="_blank">00:07:27.520</a></span> | <span class="t">embedding of this picture should be very similar if they're clip embeddings. That's the definition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=452" target="_blank">00:07:32.920</a></span> | <span class="t">of clip embeddings. So you see this idea that you could take a text or image embedding and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=460" target="_blank">00:07:40.120</a></span> | <span class="t">turn it back into an image perfectly makes no sense. This is the very definition of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=468" target="_blank">00:07:48.760</a></span> | <span class="t">thing we're trying to do when we do clip. And because what we're basically trying to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=474" target="_blank">00:07:54.000</a></span> | <span class="t">do is invert the embedding function these kinds of problems are generally referred to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=482" target="_blank">00:08:02.080</a></span> | <span class="t">as inverse problems. So stable diffusion is something that attempts to approximate the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=489" target="_blank">00:08:09.600</a></span> | <span class="t">solution to an inverse problem. So why does that mean that clip interrogator is not actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=501" target="_blank">00:08:21.360</a></span> | <span class="t">inverting the picture to give us back the text. Well it's just as nonsensical if we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=507" target="_blank">00:08:27.360</a></span> | <span class="t">got an image embedding right trying to undo that to get back to the picture and trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=514" target="_blank">00:08:34.480</a></span> | <span class="t">to undo that to get back to a suitable prompt is equally infeasible. Both of them require</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=524" target="_blank">00:08:44.680</a></span> | <span class="t">inverting an encoder and that just doesn't exist. The best we can do is the best we know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=530" target="_blank">00:08:50.880</a></span> | <span class="t">how to do at the moment is to approximate that using a diffusion process. OK. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=539" target="_blank">00:08:59.680</a></span> | <span class="t">why these texts that it spits back are fun and interesting but they are not the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=548" target="_blank">00:09:08.520</a></span> | <span class="t">that you can put back into stable diffusion and have it generate the same photo. And the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=554" target="_blank">00:09:14.440</a></span> | <span class="t">nice thing is that actually the code for this is available. And you can take a look at it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=564" target="_blank">00:09:24.560</a></span> | <span class="t">It's the app. And you'll see what it does is it has a big list of let's have a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=574" target="_blank">00:09:34.040</a></span> | <span class="t">at some examples. So it has a big this has big lists of examples for example a big list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=584" target="_blank">00:09:44.280</a></span> | <span class="t">of artists and it has a big list of mediums and a big list of movements and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=598" target="_blank">00:09:58.800</a></span> | <span class="t">It's got all this hard coded pieces of text. And so what it does is it basically mixes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=607" target="_blank">00:10:07.840</a></span> | <span class="t">and matches those various things together to see which one works well and it combines</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=614" target="_blank">00:10:14.840</a></span> | <span class="t">it with the output of something called the blip language model which is not designed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=620" target="_blank">00:10:20.880</a></span> | <span class="t">to give you an exactly accurate description of an image but it has been specifically trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=627" target="_blank">00:10:27.680</a></span> | <span class="t">to give an OK ish caption for an image and it actually works reasonably well. But again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=633" target="_blank">00:10:33.160</a></span> | <span class="t">it's not it's not the inverse of the clip encoder. So OK so that's how that all works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=652" target="_blank">00:10:52.920</a></span> | <span class="t">So where we had got to was that we had done matrix multiplication with broadcasting where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=659" target="_blank">00:10:59.760</a></span> | <span class="t">we had broadcast the the entire column from the right hand matrix all at once. And that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=672" target="_blank">00:11:12.880</a></span> | <span class="t">allowed us to get it down to a point where we only have one for loop written in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=678" target="_blank">00:11:18.400</a></span> | <span class="t">And generally speaking we do not want to be doing loop looping through too many things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=683" target="_blank">00:11:23.320</a></span> | <span class="t">in Python because that's a slow bit. So the two inner loops we originally had which just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=689" target="_blank">00:11:29.880</a></span> | <span class="t">remind us originally were here these two inner loops looping through 10 and then to 784 respectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=701" target="_blank">00:11:41.120</a></span> | <span class="t">have been replaced with a single line of code. So that was pretty great. And our times now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=707" target="_blank">00:11:47.680</a></span> | <span class="t">is increased is improved by 5000 times. So we're 5000 times faster than we started out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=716" target="_blank">00:11:56.400</a></span> | <span class="t">So another trick that we can use which I'm a big fan of is something called Einstein</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=721" target="_blank">00:12:01.760</a></span> | <span class="t">summation. And Einstein summation is a compact representation for representing products and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=731" target="_blank">00:12:11.000</a></span> | <span class="t">sums. And this is an example of an Einstein summation. And what we're going to do now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=740" target="_blank">00:12:20.120</a></span> | <span class="t">is we're going to replicate our matrix product with an Einstein summation. And believe it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=745" target="_blank">00:12:25.320</a></span> | <span class="t">or not the entire thing can be pushed down to just these characters which is pretty amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=752" target="_blank">00:12:32.200</a></span> | <span class="t">So let me explain what's happening here. The arrow is separating the left hand side from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=757" target="_blank">00:12:37.080</a></span> | <span class="t">the right hand side. The left hand side is the inputs. The right hand side is the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=763" target="_blank">00:12:43.960</a></span> | <span class="t">The comma is between each input so there are two inputs. The letters are just names that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=769" target="_blank">00:12:49.920</a></span> | <span class="t">you're giving to the number of rows and the number of columns. So the first matrix we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=774" target="_blank">00:12:54.440</a></span> | <span class="t">multiplying by has i rows and k columns. The second has k rows and j columns. It's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=787" target="_blank">00:13:07.160</a></span> | <span class="t">to go through a process which creates a new matrix that actually this is not even doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=793" target="_blank">00:13:13.600</a></span> | <span class="t">this is not yet doing the matrix multiplication. This is without the sum. This one's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=797" target="_blank">00:13:17.840</a></span> | <span class="t">to create a new matrix that contains i rows and k - well how do we say it - i faces and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=804" target="_blank">00:13:24.800</a></span> | <span class="t">k rows and j columns so a rank 3 tensor. So the number of letters is going to be the rank.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=815" target="_blank">00:13:35.000</a></span> | <span class="t">And the rules of how this works is that if you repeat letters between input arrays - so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=820" target="_blank">00:13:40.440</a></span> | <span class="t">here's my inputs i, k and k, j we've got a repeated letter - it means that values along</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=826" target="_blank">00:13:46.440</a></span> | <span class="t">those axes will be multiplied together. So it means that each item in each row of sorry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=836" target="_blank">00:13:56.000</a></span> | <span class="t">in each yeah across a row will be multiplied by each item down each column to create this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=844" target="_blank">00:14:04.720</a></span> | <span class="t">i by k by j output tensor. So to remind you our first matrix is 5 by 784. That's m1. Our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=854" target="_blank">00:14:14.560</a></span> | <span class="t">second matrix is 7084 by 10. That's m2. So i is 5, k is 784 and j is 10. So if I do this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=869" target="_blank">00:14:29.680</a></span> | <span class="t">torch.insum then I will end up with a i by k by j. It'll be 5 by 784 by 10. And if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=879" target="_blank">00:14:39.480</a></span> | <span class="t">have a look I've run it here on these two tensors m1 and m2 and the shape of the result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=885" target="_blank">00:14:45.640</a></span> | <span class="t">is 5 plus 784 by 10. And what it contains is the original five rows of m1, the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=894" target="_blank">00:14:54.440</a></span> | <span class="t">ten columns of m2 and then for the other 784 that dimension they're all multiplied together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=902" target="_blank">00:15:02.400</a></span> | <span class="t">because it's been copied between the two arguments to the iinsum. And so if we now sum up that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=914" target="_blank">00:15:14.720</a></span> | <span class="t">over this dimension we get back. So what we get back if we go back to the original matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=927" target="_blank">00:15:27.080</a></span> | <span class="t">multiply we do we had 10.94 negative negative 0.68 etc. And so now with this Einstein summation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=937" target="_blank">00:15:37.440</a></span> | <span class="t">version we've got back exactly the same thing. Because what it's done is it's taken each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=947" target="_blank">00:15:47.600</a></span> | <span class="t">of these columns by rows multiply them together to get this 5 by 784 by 10 and then add it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=956" target="_blank">00:15:56.800</a></span> | <span class="t">up that's 784 for each one which is exactly what matrix multiplication does. But we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=964" target="_blank">00:16:04.000</a></span> | <span class="t">going to use one of the two things from Einstein summation. The second one says if we omit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=969" target="_blank">00:16:09.800</a></span> | <span class="t">a letter from the output so the bit on the right of the arrow it means those values will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=974" target="_blank">00:16:14.960</a></span> | <span class="t">be summed. So if we remove this k which gives us i k and k j goes to i j so we've removed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=986" target="_blank">00:16:26.480</a></span> | <span class="t">the k entirely that means that sum happens automatically. So if we run this as you see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=993" target="_blank">00:16:33.560</a></span> | <span class="t">we get back again matrix multiplication. So Einstein summation notation is you know it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1004" target="_blank">00:16:44.720</a></span> | <span class="t">takes some practice getting used to but it's very convenient. And once you get used to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1009" target="_blank">00:16:49.880</a></span> | <span class="t">it it's actually a really nice way of thinking about what's going on. And as we'll see in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1014" target="_blank">00:16:54.440</a></span> | <span class="t">lots of examples often you can really simplify your code by using just a tiny little Einstein</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1021" target="_blank">00:17:01.160</a></span> | <span class="t">summation. And it doesn't even have to be a sum right. You don't have to admit any letters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1028" target="_blank">00:17:08.040</a></span> | <span class="t">if you're just doing products. So maybe it's a bit misnamed. So we can now define our map</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1034" target="_blank">00:17:14.720</a></span> | <span class="t">mole as simply this torch dot own sum. So if we now check it test close that the original</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1044" target="_blank">00:17:24.280</a></span> | <span class="t">result is equal to this new map mole. And yes it is. And let's see how the speed looks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1050" target="_blank">00:17:30.640</a></span> | <span class="t">15 milliseconds. OK. And that was for the whole thing. So compared to 600 milliseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1062" target="_blank">00:17:42.920</a></span> | <span class="t">So as you can see this is much faster than even the very fast broadcasting approach we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1067" target="_blank">00:17:47.840</a></span> | <span class="t">used. So this is a pretty good trick is torch dot own sum. OK. But of course we don't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1076" target="_blank">00:17:56.800</a></span> | <span class="t">to do any of those things because PyTorch already knows how to do map mole. So there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1081" target="_blank">00:18:01.120</a></span> | <span class="t">two ways we can run map mole directly in PyTorch. You can use this special at operator. So X</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1088" target="_blank">00:18:08.840</a></span> | <span class="t">train at weights is the same as map mole train comma weights. As you see test place. Or you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1095" target="_blank">00:18:15.360</a></span> | <span class="t">can say torch dot map mole. And interestingly as you can see here the speed is about the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1102" target="_blank">00:18:22.400</a></span> | <span class="t">same as the own sum. So there's no particular harm no particular reason not to do an own</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1107" target="_blank">00:18:27.440</a></span> | <span class="t">sum. So when I say own sum that stands for Einstein summation notation. All right. Let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1114" target="_blank">00:18:34.960</a></span> | <span class="t">go faster still. Currently we're just using my CPU. But I have a GPU. It would be nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1122" target="_blank">00:18:42.440</a></span> | <span class="t">to use it. So how does a GPU work. An Nvidia GPU and indeed pretty much all GPUs. The way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1136" target="_blank">00:18:56.040</a></span> | <span class="t">they work is that they do lots and lots of things in parallel. And you have to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1143" target="_blank">00:19:03.160</a></span> | <span class="t">tell the GPU what are all the things you want to do in parallel one at a time. And so what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1149" target="_blank">00:19:09.440</a></span> | <span class="t">we're going to do is we're going to write in pure Python something that works like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1154" target="_blank">00:19:14.520</a></span> | <span class="t">GPU except it won't actually be in parallel so it won't be fast at all. But the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1159" target="_blank">00:19:19.280</a></span> | <span class="t">thing we have to do if we're going to get something working in parallel is we have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1163" target="_blank">00:19:23.240</a></span> | <span class="t">create a function that can calculate just one thing even if a thousand other things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1168" target="_blank">00:19:28.760</a></span> | <span class="t">are happening at the same time it won't interact with anything else. And there's actually a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1175" target="_blank">00:19:35.080</a></span> | <span class="t">very easy way to think about matrix multiplication in this way which is what if we try to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1181" target="_blank">00:19:41.440</a></span> | <span class="t">something which just as we've done here fills in a single a single item of the result. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1192" target="_blank">00:19:52.360</a></span> | <span class="t">how do we create something that just fills in a row 0 column 0. Well what we could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1200" target="_blank">00:20:00.000</a></span> | <span class="t">is we could create a new map model where we're going to pass in the coordinates of the place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1206" target="_blank">00:20:06.320</a></span> | <span class="t">that we want to fill in. So we're going to start by passing it 0 comma 0. We'll pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1212" target="_blank">00:20:12.800</a></span> | <span class="t">it the matrix matrices we want to multiply and we'll pass in a tensor that we've prefilled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1219" target="_blank">00:20:19.040</a></span> | <span class="t">in with zeros to put the result into. So we're going to say okay the result is torch dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1223" target="_blank">00:20:23.240</a></span> | <span class="t">zeros rows by columns call map model for location 0 comma 0 passing in those two matrices and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1232" target="_blank">00:20:32.800</a></span> | <span class="t">the bunch of zeros matrix ready to put the result in. And if we call that we get the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1238" target="_blank">00:20:38.120</a></span> | <span class="t">answer in cell 0 0. So here's an implementation of that. So the implementation is first of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1244" target="_blank">00:20:44.840</a></span> | <span class="t">all we've been past the 0 comma 0 coordinates. So let's destructure them. So hopefully you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1250" target="_blank">00:20:50.600</a></span> | <span class="t">been experimenting with destructuring because it's so important you see it all the time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1254" target="_blank">00:20:54.560</a></span> | <span class="t">into i and j. That's the row in the column. Make sure that that is inside the bounds of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1260" target="_blank">00:21:00.640</a></span> | <span class="t">our output matrix. And we're going to start by start at 0 and loop through all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1269" target="_blank">00:21:09.360</a></span> | <span class="t">rows of A and all of the columns of B for i and j. Sorry all of the columns of A and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1276" target="_blank">00:21:16.440</a></span> | <span class="t">all of the rows of B for i and j. Just like the very innermost loop of our very first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1283" target="_blank">00:21:23.200</a></span> | <span class="t">Python attempt. And then at the end pop that into the output. So here's something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1289" target="_blank">00:21:29.400</a></span> | <span class="t">fills in one piece of the grid successfully. So we could call this row by columns times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1298" target="_blank">00:21:38.240</a></span> | <span class="t">each time passing in a different grid. And we could do that in parallel because none</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1302" target="_blank">00:21:42.200</a></span> | <span class="t">of those different locations interact with any other location. So something which can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1308" target="_blank">00:21:48.240</a></span> | <span class="t">calculate a little piece of of an output on a GPU is called a kernel. So we'd call this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1315" target="_blank">00:21:55.240</a></span> | <span class="t">a kernel. And so now we can create something called launch kernel. We pass it the kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1321" target="_blank">00:22:01.000</a></span> | <span class="t">So that's the function. Here's an example launch kernel passing in the function. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1327" target="_blank">00:22:07.240</a></span> | <span class="t">how many rows and how many columns are there in the output grid. And then give me any arguments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1334" target="_blank">00:22:14.720</a></span> | <span class="t">that you need to calculate it. So in Python star args just says any additional arguments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1342" target="_blank">00:22:22.040</a></span> | <span class="t">that you pass are going to be put into an array called args. If you use something like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1347" target="_blank">00:22:27.520</a></span> | <span class="t">C you might have seen like variadic arguments parameters. It's the same basic idea. So we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1355" target="_blank">00:22:35.160</a></span> | <span class="t">going to be calling launch kernel. We're going to be saying launch the kernel matmul using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1361" target="_blank">00:22:41.280</a></span> | <span class="t">all the rows of A all the columns of B and then the args which are going to be in star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1366" target="_blank">00:22:46.440</a></span> | <span class="t">args are going to be M1 the first matrix M2 the second matrix and res another torch.zeros</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1372" target="_blank">00:22:52.720</a></span> | <span class="t">we just created. So launch kernel is going to loop through the rows of A and then for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1382" target="_blank">00:23:02.160</a></span> | <span class="t">each row of A it'll loop through the columns of B and call the kernel which is matmul on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1390" target="_blank">00:23:10.200</a></span> | <span class="t">that grid location passing in M1 M2 and res. So starargs here is going to unpack that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1398" target="_blank">00:23:18.860</a></span> | <span class="t">pass them as three separate arguments. And if I run that and all of that you'll see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1408" target="_blank">00:23:28.800</a></span> | <span class="t">done it. It's filled in the exact same matrix. OK so that's actually not fast at all. It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1416" target="_blank">00:23:36.680</a></span> | <span class="t">not doing anything in parallel but it's the basic idea. So now to actually do it in parallel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1421" target="_blank">00:23:41.880</a></span> | <span class="t">we have to use something called CUDA. So CUDA is a programming model for NVIDIA GPUs and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1429" target="_blank">00:23:49.080</a></span> | <span class="t">to program in CUDA from Python the easiest way currently to do that is with something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1434" target="_blank">00:23:54.320</a></span> | <span class="t">called number. And number is a compiler where you've seen it actually already for non GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1439" target="_blank">00:23:59.760</a></span> | <span class="t">It's a compiler that takes Python code and spits out you know compiled fast machine code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1447" target="_blank">00:24:07.440</a></span> | <span class="t">If you use its CUDA module it'll actually spit out GPU accelerated CUDA code. So rather</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1453" target="_blank">00:24:13.880</a></span> | <span class="t">than using an N-Git like before we now say at CUDA.Git and it behaves a little bit differently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1462" target="_blank">00:24:22.680</a></span> | <span class="t">But you'll see that this matmul let me copy the other one over so you can compare it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1467" target="_blank">00:24:27.640</a></span> | <span class="t">our Python one. Now Python matmul and this CUDA.Git matmul look I think identical except</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1475" target="_blank">00:24:35.600</a></span> | <span class="t">for one thing instead of passing in the grid there's a special magic thing called CUDA.grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1481" target="_blank">00:24:41.800</a></span> | <span class="t">and you say how many dimensions does my grid have and you unpack it. So that's you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1485" target="_blank">00:24:45.780</a></span> | <span class="t">have to it's just a little convenience that number does for you. You don't have to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1492" target="_blank">00:24:52.060</a></span> | <span class="t">over the grid it passes it over for you so it doesn't need this grid. Other than that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1497" target="_blank">00:24:57.280</a></span> | <span class="t">these two are identical but the decorator is going to compile that into GPU code. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1503" target="_blank">00:25:03.840</a></span> | <span class="t">now we need to create our output tensor just like before and we need to do something else</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1511" target="_blank">00:25:11.040</a></span> | <span class="t">which is we have to take our input matrices and our output so our input tensors matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1519" target="_blank">00:25:19.400</a></span> | <span class="t">in this case in the output tensor and we have to move them to the GPU. I should say copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1523" target="_blank">00:25:23.760</a></span> | <span class="t">them to the GPU so CUDA device copies a tensor to the GPU and so we've got three things getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1531" target="_blank">00:25:31.800</a></span> | <span class="t">copied to the GPU here and therefore we store the three things over here. Another way I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1539" target="_blank">00:25:39.660</a></span> | <span class="t">could have written this is I could have said map which I kind of quite like doing a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1546" target="_blank">00:25:46.960</a></span> | <span class="t">which is CUDA device to each of these arguments and this would be the same thing. This is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1559" target="_blank">00:25:59.520</a></span> | <span class="t">going to call CUDA device on X train and put it in here on weights and put it in here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1565" target="_blank">00:26:05.140</a></span> | <span class="t">on R and put it in here. That's a slightly more convenient way to do it. Okay so we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1576" target="_blank">00:26:16.920</a></span> | <span class="t">got our 50,000 by 10 output that's just all zeros of course that's just how we created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1581" target="_blank">00:26:21.380</a></span> | <span class="t">it and now we're going to try and fill it in. There is a there's a particular detail</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1592" target="_blank">00:26:32.380</a></span> | <span class="t">that you don't have to worry about too much which is in CUDA they don't just have a grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1599" target="_blank">00:26:39.520</a></span> | <span class="t">but there's also a concept of blocks and there's something we call here TPB which is threads</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1605" target="_blank">00:26:45.140</a></span> | <span class="t">per block. This is just a detail of the CUDA programming model you don't have to worry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1610" target="_blank">00:26:50.240</a></span> | <span class="t">about too much you can just basically copy this and what it's going to do is it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1615" target="_blank">00:26:55.240</a></span> | <span class="t">to call each grid item in parallel and with a number of different processes basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1624" target="_blank">00:27:04.060</a></span> | <span class="t">So this is just the code which turns the grid into blocks and so you don't have to worry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1629" target="_blank">00:27:09.840</a></span> | <span class="t">too much about the details of that you just always run it. Okay and so now how do you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1638" target="_blank">00:27:18.720</a></span> | <span class="t">call the equivalent of launch kernel well it's it's a slightly weird way to do it but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1647" target="_blank">00:27:27.380</a></span> | <span class="t">it works fine you call matmul but because matmul has CUDA.jit it's got a special thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1652" target="_blank">00:27:32.860</a></span> | <span class="t">which is you have to put something in square brackets afterwards which is you have to tell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1656" target="_blank">00:27:36.900</a></span> | <span class="t">it how many blocks per grid that's just the result from the previous cell and how many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1661" target="_blank">00:27:41.580</a></span> | <span class="t">threads per block in each of the two dimensions. So again you can just copy and paste this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1666" target="_blank">00:27:46.140</a></span> | <span class="t">from my version but then you pass in the three arguments to the function this will be A B</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1672" target="_blank">00:27:52.380</a></span> | <span class="t">and C and this will this is this is how you launch a kernel so this will launch the kernel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1677" target="_blank">00:27:57.700</a></span> | <span class="t">matmul on the GPU. At the end of it RG is going to get filled in it's gone it's on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1685" target="_blank">00:28:05.340</a></span> | <span class="t">GPU which is not much good to us so we now have to copy it back to the CPU which is called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1690" target="_blank">00:28:10.300</a></span> | <span class="t">the host copy to host to run that and it's done and test close shows us that our result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1697" target="_blank">00:28:17.840</a></span> | <span class="t">is similar to our original results so it seems to be working so that's great. So I see Siva</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1705" target="_blank">00:28:25.260</a></span> | <span class="t">on the YouTube chat is finding that it's not working on his Mac that's right so this will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1712" target="_blank">00:28:32.460</a></span> | <span class="t">only work on an Nvidia GPU as basically all of the GPU nearly all the GPU stuff we look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1718" target="_blank">00:28:38.420</a></span> | <span class="t">at only works on Nvidia GPUs. Mac GPUs are gradually starting to get a little bit of support</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1728" target="_blank">00:28:48.020</a></span> | <span class="t">from machine learning libraries but it's taking quite a while it's been you know it's got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1734" target="_blank">00:28:54.500</a></span> | <span class="t">quite a way to go as I say this at least towards the end of 2022 if this works for you and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1739" target="_blank">00:28:59.980</a></span> | <span class="t">later on that's yeah that's great. Okay so let's time how fast that is. Okay so that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1748" target="_blank">00:29:08.220</a></span> | <span class="t">was three point six one milliseconds and so if we compare that to the PyTorch matmul on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1755" target="_blank">00:29:15.580</a></span> | <span class="t">CPU that was 15 milliseconds so that's great so it's faster still so how much faster. Oh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1765" target="_blank">00:29:25.140</a></span> | <span class="t">by the way we can actually go faster than that which is we can use the exact same code we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1770" target="_blank">00:29:30.660</a></span> | <span class="t">had from the PyTorch op but here's a trick if you just take your tensor and write dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1777" target="_blank">00:29:37.180</a></span> | <span class="t">CUDA after it it copies it over to the GPU if it's on a if it's on a Nvidia GPU do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1785" target="_blank">00:29:45.460</a></span> | <span class="t">same for weights dot CUDA so these are our two CUDA versions and now I can do the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1790" target="_blank">00:29:50.660</a></span> | <span class="t">thing and this will actually run on the GPU and then to copy it back to the host you just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1796" target="_blank">00:29:56.820</a></span> | <span class="t">say dot CPU so if we look to see how fast that is 458 microseconds so oh that is somebody</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1809" target="_blank">00:30:09.940</a></span> | <span class="t">just pointed out that I wrote the wrong thing here one e neg three okay so how much faster</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1817" target="_blank">00:30:17.220</a></span> | <span class="t">is that well 458 microseconds our original on the whole data set was 663 microseconds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1826" target="_blank">00:30:26.260</a></span> | <span class="t">so compared to our broadcast version we are another thousand times faster so overall this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1835" target="_blank">00:30:35.580</a></span> | <span class="t">version here compared to our original version which was here the difference in performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1850" target="_blank">00:30:50.560</a></span> | <span class="t">is 5 million X so when you see people say yeah Python can be pretty slow can be better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1865" target="_blank">00:31:05.460</a></span> | <span class="t">to run stuff on the GPU if possible we're not talking about a 20% change we're talking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1871" target="_blank">00:31:11.440</a></span> | <span class="t">about a 5 million X change so that's a big deal and so that's why you need to be running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1881" target="_blank">00:31:21.060</a></span> | <span class="t">stuff on the GPU all right some folks on YouTube are wondering how on earth I'm running CUDA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1895" target="_blank">00:31:35.620</a></span> | <span class="t">when I'm on a Mac and given it says localhost here that's because I'm using something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1901" target="_blank">00:31:41.940</a></span> | <span class="t">SSH tunneling which we might get to sometime I suspect my live coding from the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1907" target="_blank">00:31:47.220</a></span> | <span class="t">course might have covered that already but this is basically you can use a Jupyter notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1912" target="_blank">00:31:52.500</a></span> | <span class="t">that's running anywhere in the world from your own machine using something called SSH</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1917" target="_blank">00:31:57.700</a></span> | <span class="t">tunneling which is a good thing to look up okay one person asks if Einstein summation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1928" target="_blank">00:32:08.300</a></span> | <span class="t">borrows anything from APL yes it does actually so it's kind of the other way around actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1936" target="_blank">00:32:16.100</a></span> | <span class="t">APL borrows it from Einstein notation so I don't know if you remember I mentioned that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1942" target="_blank">00:32:22.020</a></span> | <span class="t">when Iverson when he developed APL was heavily influenced by tensor analysis and so this Einstein</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1952" target="_blank">00:32:32.940</a></span> | <span class="t">notation is very heavily used there if you'll notice a key thing that happens in Einstein</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1959" target="_blank">00:32:39.300</a></span> | <span class="t">notation is there's no loop you know there isn't this kind of Sigma you know I from here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1965" target="_blank">00:32:45.820</a></span> | <span class="t">to here and then you put the I inside the function that you're summing up everything's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1970" target="_blank">00:32:50.620</a></span> | <span class="t">implicit and APL takes that a very long way and and J takes it even further which is what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1980" target="_blank">00:33:00.060</a></span> | <span class="t">can Iverson developed after APL and this kind of general idea of removing the index is very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1988" target="_blank">00:33:08.100</a></span> | <span class="t">important in APL and it's become very important in numpy pytorch tensor flow and so forth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=1998" target="_blank">00:33:18.060</a></span> | <span class="t">so finally we know how to multiply matrices congratulations so let's practice that let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2009" target="_blank">00:33:29.220</a></span> | <span class="t">practice what we've learned so we're going to go to zero to main shift to practice this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2021" target="_blank">00:33:41.580</a></span> | <span class="t">and so we're going to try to exercise our kind of tensor manipulation operation muscles</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2030" target="_blank">00:33:50.260</a></span> | <span class="t">in this section and the key actually endpoint for this is the homework and so what you need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2038" target="_blank">00:33:58.720</a></span> | <span class="t">to be doing is getting yourself to a point that you can implement something like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2042" target="_blank">00:34:02.860</a></span> | <span class="t">but for a different algorithm why do we care about this because this is like learning your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2051" target="_blank">00:34:11.020</a></span> | <span class="t">times table your times tables if you're doing you know mathematics it's this kind of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2058" target="_blank">00:34:18.300</a></span> | <span class="t">thing that's going to come up all the time and if you're not good at your times tables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2063" target="_blank">00:34:23.740</a></span> | <span class="t">everything else a lot more a lot of other things particularly at primary school in high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2067" target="_blank">00:34:27.500</a></span> | <span class="t">school you know they they get difficult you get slower and it's frustrating and you spend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2077" target="_blank">00:34:37.340</a></span> | <span class="t">time thinking about these mechanical operations rather than getting your work done it is it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2083" target="_blank">00:34:43.820</a></span> | <span class="t">important that when you have an idea about something you want to try or debug or profile</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2088" target="_blank">00:34:48.740</a></span> | <span class="t">or whatever that you can quickly translate that into working code and the way that code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2094" target="_blank">00:34:54.500</a></span> | <span class="t">is written for GPUs or even for fast running on CPUs is using broadcasting Einstein notation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2110" target="_blank">00:35:10.020</a></span> | <span class="t">matrix modifications and so forth so you've got to you've got to got to got to practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2116" target="_blank">00:35:16.180</a></span> | <span class="t">super important so we're going to practice it by running by developing a clustering algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2128" target="_blank">00:35:28.180</a></span> | <span class="t">and the clustering algorithm we're going to work on is something called mean shift clustering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2134" target="_blank">00:35:34.060</a></span> | <span class="t">which hopefully you've never heard of before and I say that because I just think it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2137" target="_blank">00:35:37.420</a></span> | <span class="t">really funny algorithm that not many people have come across excuse me and I think you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2145" target="_blank">00:35:45.620</a></span> | <span class="t">find it really useful so what is cluster analysis cluster analysis is very different to anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2153" target="_blank">00:35:53.980</a></span> | <span class="t">that we've worked on in this course so far and that there isn't a dependent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2158" target="_blank">00:35:58.820</a></span> | <span class="t">that we're trying to match but instead we're just trying to find are there groups of similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2166" target="_blank">00:36:06.180</a></span> | <span class="t">things in this data and those groups we call clusters and as you can see from the wiki</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2171" target="_blank">00:36:11.860</a></span> | <span class="t">page there's all kinds of applications of cluster analysis across many different areas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2180" target="_blank">00:36:20.980</a></span> | <span class="t">I will say that sometimes cluster analysis can be overused or misused it's really best</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2188" target="_blank">00:36:28.820</a></span> | <span class="t">for when your various columns are the same kind of thing and have the same kind of scale</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2201" target="_blank">00:36:41.940</a></span> | <span class="t">for example pixels are all the same kind of thing they're all pixels so one of the examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2207" target="_blank">00:36:47.500</a></span> | <span class="t">they use is market research so I wouldn't use cluster analysis for socio demographic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2214" target="_blank">00:36:54.300</a></span> | <span class="t">inputs because they're all different kinds of things but the example they give here makes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2218" target="_blank">00:36:58.380</a></span> | <span class="t">a lot of sense which is looking at data from surveys if you've got a whole bunch of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2223" target="_blank">00:37:03.340</a></span> | <span class="t">from one to five answers on surveys alright so let's take a look at this and the way I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2231" target="_blank">00:37:11.660</a></span> | <span class="t">like to build my algorithms is to create some often to create some synthetic data that I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2237" target="_blank">00:37:17.340</a></span> | <span class="t">know how I want it to behave and so we're going to create six clusters and each cluster</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2243" target="_blank">00:37:23.300</a></span> | <span class="t">is going to have 750 samples in it so first of all I'm going to randomly create six centroids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2254" target="_blank">00:37:34.460</a></span> | <span class="t">and so the centroid is going to be like the middle of where my clusters are so I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2260" target="_blank">00:37:40.020</a></span> | <span class="t">to randomly create them I need to end clusters by two so I need an X and a Y coordinate for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2265" target="_blank">00:37:45.300</a></span> | <span class="t">each one and so I'm now going to randomly generate data around those six centroids okay so to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2279" target="_blank">00:37:59.980</a></span> | <span class="t">do that I'm going to call a little function I made here called sample and I'm going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2286" target="_blank">00:38:06.860</a></span> | <span class="t">run it on each of those six centroids and so I'll show you what that looks like so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2296" target="_blank">00:38:16.380</a></span> | <span class="t">what that data looks like so the X's are the six centroids and the colored dots is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2302" target="_blank">00:38:22.340</a></span> | <span class="t">data so if you were given this data without the X's the idea would be to come back with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2311" target="_blank">00:38:31.340</a></span> | <span class="t">figuring out where the X's would have been like where are the where are these clustering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2315" target="_blank">00:38:35.160</a></span> | <span class="t">around and so if you can get clusters that that's that's the goal here is to find out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2319" target="_blank">00:38:39.820</a></span> | <span class="t">that there's a few discreetly distinctly different types of data in your data set so for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2326" target="_blank">00:38:46.300</a></span> | <span class="t">for images I've used this before to discover that there are some images that look completely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2331" target="_blank">00:38:51.840</a></span> | <span class="t">different to all the other ones for example they were taken at nighttime or they're of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2335" target="_blank">00:38:55.460</a></span> | <span class="t">a different object or something like that so how does sample work well we're passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2341" target="_blank">00:39:01.780</a></span> | <span class="t">in the centroid and so what we want is we're going to get back so each of those centroids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2356" target="_blank">00:39:16.860</a></span> | <span class="t">contains an X and a Y so multivariate normal is just like normal it's going to give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2361" target="_blank">00:39:21.460</a></span> | <span class="t">back normally distributed data but more than one item that's why it's multivariate and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2367" target="_blank">00:39:27.700</a></span> | <span class="t">so we passed in two means a mean for X and a mean for our Y and so that's the mean that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2373" target="_blank">00:39:33.700</a></span> | <span class="t">we're going to get and our standard deviation is going to be 5 why do we use torch.diag 5,5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2382" target="_blank">00:39:42.220</a></span> | <span class="t">that's because we're saying that's because that for multivariate normal distributions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2387" target="_blank">00:39:47.740</a></span> | <span class="t">there's not just one standard deviation for each column that you get back there could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2392" target="_blank">00:39:52.940</a></span> | <span class="t">also be a connection between columns the columns might not be independent so you actually need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2398" target="_blank">00:39:58.940</a></span> | <span class="t">so it's called a covariance matrix not just to make not just a variance we discussed that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2405" target="_blank">00:40:05.420</a></span> | <span class="t">a little bit more in lesson 9b if you're interested in learning more about that okay so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2410" target="_blank">00:40:10.420</a></span> | <span class="t">something that's going to give us back random columns of data with this mean and this standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2415" target="_blank">00:40:15.100</a></span> | <span class="t">deviation and this is the number of samples that we want and this is coming from PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2421" target="_blank">00:40:21.940</a></span> | <span class="t">so PyTorch has a whole bunch of different distributions that you can use which can be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2426" target="_blank">00:40:26.500</a></span> | <span class="t">very handy so there's our data okay so remember for clustering we we don't know the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2436" target="_blank">00:40:36.180</a></span> | <span class="t">colors and we don't know where the X's are that's kind of our job is to figure that out we might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2442" target="_blank">00:40:42.620</a></span> | <span class="t">just briefly also look at how to plot so in this case we want to plot the X's and we want to plot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2449" target="_blank">00:40:49.140</a></span> | <span class="t">the data so it looks like this so all I do is I loop through each centroid and I grab that centroid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2457" target="_blank">00:40:57.740</a></span> | <span class="t">samples and they're just all done in order so I grab it from i times n samples up to i plus 1 times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2467" target="_blank">00:41:07.740</a></span> | <span class="t">n samples and then I create a scatterplot with the samples on them and what I've done is I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2475" target="_blank">00:41:15.420</a></span> | <span class="t">created an axis here and you'll see why later that we can also pass one in but I'm not passing one in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2481" target="_blank">00:41:21.740</a></span> | <span class="t">so you create a plot and an axis and so in that plotlib you can keep plotting things on the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2487" target="_blank">00:41:27.980</a></span> | <span class="t">axis so then I plot on the centroid a big X which is black and then I a smaller X which is what is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2501" target="_blank">00:41:41.100</a></span> | <span class="t">that magenta and so that's how I get these X's so that's how plot data works okay so how do we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2509" target="_blank">00:41:49.300</a></span> | <span class="t">create something now that starts with all the dots and returns where the X's are we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2516" target="_blank">00:41:56.500</a></span> | <span class="t">a particular algorithm particular clustering algorithm called mean shift and mean shift is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2532" target="_blank">00:42:12.220</a></span> | <span class="t">a nice clustering approach because you don't have to say how many clusters there are so it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2538" target="_blank">00:42:18.180</a></span> | <span class="t">that often that you actually got to know how many clusters there are so we don't have to say quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2542" target="_blank">00:42:22.140</a></span> | <span class="t">a few things like the very popular K means require you to say how many instead we just have to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2548" target="_blank">00:42:28.060</a></span> | <span class="t">them in called a bandwidth which we'll learn about which can actually be chosen automatically and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2552" target="_blank">00:42:32.940</a></span> | <span class="t">can also handle clusters of any shape so they don't have to be ball shaped like they were they are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2558" target="_blank">00:42:38.020</a></span> | <span class="t">here they can be kind of like L shaped or lips shaped or whatever and so what here's what's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2564" target="_blank">00:42:44.900</a></span> | <span class="t">to happen we're going to pick some point so let's say we pick that point just there okay and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2583" target="_blank">00:43:03.940</a></span> | <span class="t">what we now do is we go through each data point so we'll pick the first one and so we then find the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2591" target="_blank">00:43:11.380</a></span> | <span class="t">distance between that point and every other point okay so we're going to have to say what is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2607" target="_blank">00:43:27.180</a></span> | <span class="t">distance between that point and that point and that point and that point and that point and also the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2614" target="_blank">00:43:34.020</a></span> | <span class="t">ones further away that point and that point and you do it for every single point compared to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2620" target="_blank">00:43:40.260</a></span> | <span class="t">one that we're currently looking at okay so we get all of those as a big list and now what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2630" target="_blank">00:43:50.800</a></span> | <span class="t">going to do is we're going to take a weighted average of all of those points now that's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2640" target="_blank">00:44:00.780</a></span> | <span class="t">interesting without the weighting if we just take our average of all of the points and how far away</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2646" target="_blank">00:44:06.060</a></span> | <span class="t">they are we're going to end up somewhere here right this is the average of all the points but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2651" target="_blank">00:44:11.140</a></span> | <span class="t">the key is that we're going to take an average and just find the right spot the key is we need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2661" target="_blank">00:44:21.460</a></span> | <span class="t">find an average that is weighted by how far away things are so for example this one over here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2668" target="_blank">00:44:28.980</a></span> | <span class="t">a very long way away from our point of interest and so it should have a very low weight in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2676" target="_blank">00:44:36.660</a></span> | <span class="t">weighted average whereas this point here which is very close should have a very high weight in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2683" target="_blank">00:44:43.620</a></span> | <span class="t">our weighted average so what we do is we create weights for every point compared to the one that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2691" target="_blank">00:44:51.540</a></span> | <span class="t">we're currently interested in using a what's called a Gaussian kernel that we'll look at but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2696" target="_blank">00:44:56.420</a></span> | <span class="t">the key thing to know is that points that are further away from our point of interest which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2702" target="_blank">00:45:02.180</a></span> | <span class="t">is this one are going to have lower weights that's what we mean there they're penalized the rate at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2707" target="_blank">00:45:07.980</a></span> | <span class="t">which weights four to zero is determined by this thing that we set at the start called the bandwidth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2712" target="_blank">00:45:12.740</a></span> | <span class="t">and that's going to be the standard deviation of our Gaussian so we take an average of all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2719" target="_blank">00:45:19.900</a></span> | <span class="t">points in the data set a weighted average weighted by how far away they are so for our point of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2726" target="_blank">00:45:26.420</a></span> | <span class="t">interest right the this point is going to get a big weight this point is going to get a big weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2738" target="_blank">00:45:38.020</a></span> | <span class="t">this point is going to get a big weight that point is going to get a tiny weight that points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2743" target="_blank">00:45:43.900</a></span> | <span class="t">going to get an even tinier weight so it's mainly going to be a weighted average of these points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2754" target="_blank">00:45:54.700</a></span> | <span class="t">that are nearby and the weighted average of those points I would guess is going to be somewhere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2760" target="_blank">00:46:00.380</a></span> | <span class="t">around about here right and would have a similar thing for the weighted average of the points near</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2767" target="_blank">00:46:07.300</a></span> | <span class="t">this one that's going to probably be somewhere around about here or maybe over here and so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2775" target="_blank">00:46:15.300</a></span> | <span class="t">going to move all of these points in closer it's almost like a gravity right they're kind of going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2780" target="_blank">00:46:20.340</a></span> | <span class="t">to be moved like closer and closer in towards this kind of gravitational center and then these ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2793" target="_blank">00:46:33.100</a></span> | <span class="t">will go towards their own gravitational center and so forth okay so let's take a look at it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2802" target="_blank">00:46:42.380</a></span> | <span class="t">all right so what's the Gaussian kernel this is the Gaussian kernel which was a sign in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2816" target="_blank">00:46:56.820</a></span> | <span class="t">original March for Science back in the days when the idea of not following scientists was considered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2824" target="_blank">00:47:04.100</a></span> | <span class="t">socially unacceptable we used to have much for these things if you remember so this is this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2828" target="_blank">00:47:08.500</a></span> | <span class="t">not normal so this is the definition of the Gaussian kernel which is also known as the normal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2833" target="_blank">00:47:13.980</a></span> | <span class="t">distribution this is the shape of it sure you've seen it before and here is that formula copied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2843" target="_blank">00:47:23.820</a></span> | <span class="t">directly off the science March sign okay here we go see the square root 2 pi etc okay and this here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2855" target="_blank">00:47:35.860</a></span> | <span class="t">is the standard deviation now what does that look like it's very helpful to have something that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2861" target="_blank">00:47:41.460</a></span> | <span class="t">can very quickly plot any function that doesn't come with matplotlib but it's very easy to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2867" target="_blank">00:47:47.940</a></span> | <span class="t">one just say oh let's as X let's use all the numbers from 0 to 10 a hundred of them spaced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2874" target="_blank">00:47:54.660</a></span> | <span class="t">evenly that's what lens base does in linearly spaced 100 numbers in this range that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2880" target="_blank">00:48:00.780</a></span> | <span class="t">to be our X's so plot those X's and plot f of X is the wise so here's a very nice little plot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2886" target="_blank">00:48:06.620</a></span> | <span class="t">fuck we want and here it is and as you can see here we've now got something where if you are this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2897" target="_blank">00:48:17.820</a></span> | <span class="t">like very close to the point of interest you're going to get a very high weight and if you're a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2903" target="_blank">00:48:23.100</a></span> | <span class="t">long way away from the point of interest you'll get a very low weight so that's the key thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2908" target="_blank">00:48:28.420</a></span> | <span class="t">that we wanted to remember is something that penalizes further away points more now you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2918" target="_blank">00:48:38.380</a></span> | <span class="t">notice here I managed to plot this function for a bandwidth of 2.5 and the way I did that was using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2928" target="_blank">00:48:48.700</a></span> | <span class="t">this special thing from funk tools called partial now the first thing to point out here is that very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2934" target="_blank">00:48:54.580</a></span> | <span class="t">often drives me crazy I see people trying to find out what something is in Jupiter and the way they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2940" target="_blank">00:49:00.780</a></span> | <span class="t">do it is they'll scroll up to the top of the notebook and search through the imports and try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2944" target="_blank">00:49:04.540</a></span> | <span class="t">to find it that is the dumb way to do it the smart way to do it is just to type it and press shift</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2949" target="_blank">00:49:09.740</a></span> | <span class="t">enter and it'll tell you where it comes from and you can get its help with question mark and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2955" target="_blank">00:49:15.780</a></span> | <span class="t">can get its source code with two question marks okay so just type it to find out where it comes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2960" target="_blank">00:49:20.820</a></span> | <span class="t">from okay so this is as save as mentioned in the chat also known as carrying or partial function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2969" target="_blank">00:49:29.340</a></span> | <span class="t">application this creates a new function so let's just grab it we create a new function and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2979" target="_blank">00:49:39.980</a></span> | <span class="t">function f is is the function Gaussian but it's going to automatically pass BW equals 2.5 this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2987" target="_blank">00:49:47.340</a></span> | <span class="t">a partially applied function so I could type f of 4 for example that's going to be a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=2996" target="_blank">00:49:56.500</a></span> | <span class="t">there we go and you can see that's exactly what this is go up to 4 go across yep about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3010" target="_blank">00:50:10.500</a></span> | <span class="t">0.44 so we use partial function application all the time it's a very very very important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3017" target="_blank">00:50:17.260</a></span> | <span class="t">tool without it for example plotting this function would have been more complicated with it it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3023" target="_blank">00:50:23.300</a></span> | <span class="t">trivially easy I guess the alternative like one alternative which would be fine but slightly more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3030" target="_blank">00:50:30.460</a></span> | <span class="t">clunky would be we could create a little function in line so we could have said oh plot a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3036" target="_blank">00:50:36.300</a></span> | <span class="t">that I'm going to define right now which is called lamb which is lambda X which is Gaussian of X with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3047" target="_blank">00:50:47.740</a></span> | <span class="t">a bandwidth of 0.2 0.5 you could do that too you know it's it's fine but but yeah partials I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3054" target="_blank">00:50:54.740</a></span> | <span class="t">are a bit neater a bit less to think about they often produce some neater and clearer code okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3065" target="_blank">00:51:05.940</a></span> | <span class="t">why did we decide to make the bandwidth 2.5 as a rule of thumb choose a band width which covers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3076" target="_blank">00:51:16.500</a></span> | <span class="t">about a third of the data so if we kind of found ourselves somewhere over here right a band which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3085" target="_blank">00:51:25.220</a></span> | <span class="t">which covers about a third of the data would be enough to cover two clusters ish so it would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3093" target="_blank">00:51:33.180</a></span> | <span class="t">kind of like this big so somewhere in the middle there so that's the basic idea yeah so but you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3104" target="_blank">00:51:44.940</a></span> | <span class="t">can play around with bandwidths and get different amounts of clusters I should mention like often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3111" target="_blank">00:51:51.700</a></span> | <span class="t">when you see something that's kind of on the complicated side like a Gaussian you can often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3116" target="_blank">00:51:56.660</a></span> | <span class="t">simplify things I think most implementations and write-ups I've seen talk about using Gaussians</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3122" target="_blank">00:52:02.500</a></span> | <span class="t">but if you look at the shape of it it looks a lot like this shape so this is a triangular weighting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3130" target="_blank">00:52:10.140</a></span> | <span class="t">which is just using clamp min so it's just using a linear with clamp min and yeah it occurred to me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3140" target="_blank">00:52:20.380</a></span> | <span class="t">that we could probably use this just as well so I did find it I decided to define this triangular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3144" target="_blank">00:52:24.900</a></span> | <span class="t">weighting and then we can try both anyway so we'll start with we're going to use the Gaussian version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3150" target="_blank">00:52:30.340</a></span> | <span class="t">all right so we're going to be move literally moving all the points towards their kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3161" target="_blank">00:52:41.140</a></span> | <span class="t">center of gravity so we don't want to mess up our original data so we clone it that's a pie torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3166" target="_blank">00:52:46.820</a></span> | <span class="t">thing is dot clone it's very handy and so big X is our matrix of data I mean it's actually a that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3181" target="_blank">00:53:01.180</a></span> | <span class="t">right matrix of data yeah and then little X will be our first point and it's pretty common to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3190" target="_blank">00:53:10.700</a></span> | <span class="t">big X capital letters for matrices so this is our data this is the first point okay so there it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3201" target="_blank">00:53:21.580</a></span> | <span class="t">we've got to start at twenty six point two twenty six point three so twenty six point two twenty six</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3208" target="_blank">00:53:28.460</a></span> | <span class="t">point three so somewhere up here so little X its shape is just it's a rank one tensor of shape two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3219" target="_blank">00:53:39.580</a></span> | <span class="t">big X is a rank two tensor of 1500 data points by two the X and Y and if we call X none that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3232" target="_blank">00:53:52.940</a></span> | <span class="t">add a unit access to that and the reason I'm going to show you that is because we want to find the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3238" target="_blank">00:53:58.580</a></span> | <span class="t">distance from little X to everything in big X and the way we do a distance is with minus but you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3246" target="_blank">00:54:06.580</a></span> | <span class="t">wouldn't be able to go you wouldn't be able to go X minus big X and get the right actually do you get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3258" target="_blank">00:54:18.140</a></span> | <span class="t">the right answer let's think about that X dot shape oh you've got that already oh no actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3266" target="_blank">00:54:26.540</a></span> | <span class="t">that is going to work isn't it so yes all right so you can see why we've got these two versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3273" target="_blank">00:54:33.460</a></span> | <span class="t">here if we do X none we've got something of shape 1 comma 2 now we can subtract that from something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3281" target="_blank">00:54:41.300</a></span> | <span class="t">of shape 1500 comma 2 because the twos match up because they're the same and the 1500 and the 1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3289" target="_blank">00:54:49.140</a></span> | <span class="t">matches up because you remember our numpy rules everything matches up to a unit axis so it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3294" target="_blank">00:54:54.980</a></span> | <span class="t">to copy this matrix across every row of this matrix and it works but do you remember there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3306" target="_blank">00:55:06.980</a></span> | <span class="t">a special trick which is if you've got two shapes of different lengths we can use the shorter length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3316" target="_blank">00:55:16.860</a></span> | <span class="t">and it's going to add unit axes to the front to make it as long as necessary so we actually don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3322" target="_blank">00:55:22.780</a></span> | <span class="t">need the X none we can just use little X and it works because it's going to say is this compatible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3331" target="_blank">00:55:31.500</a></span> | <span class="t">with this well the last axis remember we go right to left the last axis matches the second last axis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3338" target="_blank">00:55:38.460</a></span> | <span class="t">oh it doesn't exist so we pretend that there's a unit axis and so it's going to do exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3343" target="_blank">00:55:43.980</a></span> | <span class="t">same thing as this so if you have not studied the broadcasting from last week carefully that might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3357" target="_blank">00:55:57.500</a></span> | <span class="t">not have made a lot of sense to you and so definitely at this point you might want to pause</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3361" target="_blank">00:56:01.820</a></span> | <span class="t">the video and go back and reread the numpy broadcasting rules and last time and practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3367" target="_blank">00:56:07.100</a></span> | <span class="t">them because that's what we just did we use numpy broadcasting rules and we're going to be doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3371" target="_blank">00:56:11.980</a></span> | <span class="t">this dozens more times throughout the rest of the course and many more times in fact in this lesson</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3376" target="_blank">00:56:16.460</a></span> | <span class="t">okay so now i think it's a pretty good place to have a pause so i'll see you back here in nine minutes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3386" target="_blank">00:56:26.220</a></span> | <span class="t">hi everybody welcome back so we had got to the point where we had managed to get the distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3395" target="_blank">00:56:35.180</a></span> | <span class="t">between our first point x and all of the other points in the data and so we're just looking at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3402" target="_blank">00:56:42.540</a></span> | <span class="t">the first eight of them here so the very first distance is of course zero on the x axis and zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3408" target="_blank">00:56:48.860</a></span> | <span class="t">on the y axis because it is the first point the other thing is that because we the way we created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3417" target="_blank">00:56:57.340</a></span> | <span class="t">the clusters is they're all kind of next to each other in the list so these are all in the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3422" target="_blank">00:57:02.060</a></span> | <span class="t">clusters so none of them are too far away from each other so now that we've got all the distances</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3427" target="_blank">00:57:07.740</a></span> | <span class="t">it's easy enough to well not that the distances on x and y it's easy enough to get the distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3434" target="_blank">00:57:14.460</a></span> | <span class="t">the kind of Euclidean distance so we can just square that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3439" target="_blank">00:57:19.340</a></span> | <span class="t">that difference and sum and square root and actually maybe this is a good time to talk about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3451" target="_blank">00:57:31.260</a></span> | <span class="t">norms and to talk about what we just did there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3453" target="_blank">00:57:33.580</a></span> | <span class="t">we've got all these data points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3464" target="_blank">00:57:44.140</a></span> | <span class="t">um so here's one of our data points and here's the other one of our data points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3476" target="_blank">00:57:56.140</a></span> | <span class="t">and there's some um you know distance across the x axis and there's some distance along the y axis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3487" target="_blank">00:58:07.340</a></span> | <span class="t">so we could call that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3490" target="_blank">00:58:10.860</a></span> | <span class="t">change in x and change in y and one way to think about this distance then is it's this distance here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3503" target="_blank">00:58:23.580</a></span> | <span class="t">um so to calculate that we can use Pythagoras so a squared plus b squared equals c squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3515" target="_blank">00:58:35.900</a></span> | <span class="t">or in our case so this would be c a and b say so in our case it would be the square root</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3528" target="_blank">00:58:48.940</a></span> | <span class="t">of the change in x squared plus the change in y squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3533" target="_blank">00:58:53.740</a></span> | <span class="t">and rather than saying square root we could say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3539" target="_blank">00:58:59.980</a></span> | <span class="t">to the power of a half another way of saying the same thing but there's a different way we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3551" target="_blank">00:59:11.500</a></span> | <span class="t">find the distance we could first go along here and then go up here and so that one would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3564" target="_blank">00:59:24.940</a></span> | <span class="t">change in x if you like to the one plus change in y to the one to the power of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3574" target="_blank">00:59:34.700</a></span> | <span class="t">one oneth i'm writing it a slightly odd way for reasons you'll see in a moment it's just this otherwise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3580" target="_blank">00:59:40.300</a></span> | <span class="t">um in general if we've got a whole list of numbers we can add them up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3593" target="_blank">00:59:53.180</a></span> | <span class="t">let's say there are some list v we can add them up we can do each one to the power of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3604" target="_blank">01:00:04.060</a></span> | <span class="t">some number alpha and take that sum to the one over alpha</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3611" target="_blank">01:00:11.980</a></span> | <span class="t">and this thing here is called a norm so you might remember we came across that last week</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3623" target="_blank">01:00:23.020</a></span> | <span class="t">and we come across it again this week they basically come up i don't know they might end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3627" target="_blank">01:00:27.260</a></span> | <span class="t">up coming up every week they come up all the time particularly because the two norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3633" target="_blank">01:00:33.260</a></span> | <span class="t">which we could write like this or we could write like this or we could write like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3640" target="_blank">01:00:40.700</a></span> | <span class="t">they're all the two norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3643" target="_blank">01:00:43.020</a></span> | <span class="t">this is just saying it's this equation for alpha equals two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3661" target="_blank">01:01:01.420</a></span> | <span class="t">and stefano's pointing out we should actually have an absolute value i'm not going to worry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3664" target="_blank">01:01:04.460</a></span> | <span class="t">about that we're just doing real numbers here so we'll keep things simple oh well i guess for a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3669" target="_blank">01:01:09.580</a></span> | <span class="t">higher than one no you're probably right for something like three yeah i guess we do need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3674" target="_blank">01:01:14.620</a></span> | <span class="t">an absolute value there that's a good point because okay we could have this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3681" target="_blank">01:01:21.020</a></span> | <span class="t">and so the distance actually has to be the absolute value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3687" target="_blank">01:01:27.980</a></span> | <span class="t">so the change in x is the absolute value of that distance uh yes thank you stefano okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3694" target="_blank">01:01:34.860</a></span> | <span class="t">so we'll have the absolute value okay so the two norm is what happens when alpha equals two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3700" target="_blank">01:01:40.380</a></span> | <span class="t">and we would call this in this case we would call this the euclidean distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3712" target="_blank">01:01:52.140</a></span> | <span class="t">but actually where it comes up more often is when you're doing like a loss function so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3719" target="_blank">01:01:59.660</a></span> | <span class="t">mean squared error is just uh well the root mean squared error i should say is just the two norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3730" target="_blank">01:02:10.620</a></span> | <span class="t">whereas the mean absolute error is the one norm and these are also known as l2 and l1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3743" target="_blank">01:02:23.020</a></span> | <span class="t">plus and remember what we saw in that paper last week we saw it in this form there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3749" target="_blank">01:02:29.980</a></span> | <span class="t">two up here which is where they got rid of the square root again so that would have just been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3758" target="_blank">01:02:38.380</a></span> | <span class="t">change in x squared plus change in y squared and now we don't even need the parentheses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3763" target="_blank">01:02:43.580</a></span> | <span class="t">oopsie dozy okay okay so all of this is to say that for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3775" target="_blank">01:02:55.660</a></span> | <span class="t">you know this comes up all the time because we're very very often interested in distances</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3784" target="_blank">01:03:04.700</a></span> | <span class="t">and errors and things like that um i'm trying to think i don't feel like i've ever seen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3790" target="_blank">01:03:10.540</a></span> | <span class="t">anything other than one or two so although it is a general concept i don't think we're going to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3799" target="_blank">01:03:19.020</a></span> | <span class="t">probably things other than one or two in this course i'd be excited if we do that would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3804" target="_blank">01:03:24.220</a></span> | <span class="t">kind of cool so here we're taking the euclidean distance which is the two norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3814" target="_blank">01:03:34.780</a></span> | <span class="t">so this has got eight things in it because we've summed it over dimension one so here's your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3828" target="_blank">01:03:48.220</a></span> | <span class="t">first homework is to rewrite using torch.insum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3834" target="_blank">01:03:54.940</a></span> | <span class="t">you won't be able to get rid of the x minus x you'll still need to have that in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3840" target="_blank">01:04:00.940</a></span> | <span class="t">but when you've got a multiply followed by a sum now you won't be able to get rid of the square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3847" target="_blank">01:04:07.020</a></span> | <span class="t">root either you should be able to get rid of the multiply and the sum by doing it in a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3851" target="_blank">01:04:11.340</a></span> | <span class="t">torch.insum so we're summing up over the first dimension which is this dimension so in other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3856" target="_blank">01:04:16.940</a></span> | <span class="t">words we're summing up the x and the y axes okay so now we can get the uh the weights by passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3870" target="_blank">01:04:30.380</a></span> | <span class="t">those distances into our gaussian and so as we would expect the biggest weights it gets up to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3877" target="_blank">01:04:37.980</a></span> | <span class="t">point one six so the closest one is itself it's going to be a big weight these other ones get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3885" target="_blank">01:04:45.820</a></span> | <span class="t">reasonable weights and the ones that are in totally different clusters have weights small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3888" target="_blank">01:04:48.860</a></span> | <span class="t">enough that at three significant figures they appear to be zero okay so we've got our weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3894" target="_blank">01:04:54.860</a></span> | <span class="t">so there are the weights are a 1500 long vector and of course the original data is 1500 by two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3905" target="_blank">01:05:05.180</a></span> | <span class="t">the x and the y for each one so we now want a weighted average we want this data we want its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3913" target="_blank">01:05:13.500</a></span> | <span class="t">average weighted by this so normally an average is the um is the sum of your data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3929" target="_blank">01:05:29.660</a></span> | <span class="t">divided by account that's a normal average a weighted average each item in your data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3940" target="_blank">01:05:40.460</a></span> | <span class="t">let's put some eyes around here just to be more clear each item in your data is going to have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3945" target="_blank">01:05:45.260</a></span> | <span class="t">different weight and so you multiply each one by the weights and so rather than dividing by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3952" target="_blank">01:05:52.940</a></span> | <span class="t">n which is just the sum of ones we would divide by the sum of weights so this is an important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3960" target="_blank">01:06:00.700</a></span> | <span class="t">concept to be familiar with weighted averages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3970" target="_blank">01:06:10.060</a></span> | <span class="t">so we need to multiply every one of these x's by this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3976" target="_blank">01:06:16.140</a></span> | <span class="t">okay so can we say weight times x no all right why didn't that work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3986" target="_blank">01:06:26.700</a></span> | <span class="t">so remember we go right to left so first of all it's going to say let's look at the two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=3996" target="_blank">01:06:36.540</a></span> | <span class="t">and multiply that by the 15 are they compatible things are compatible if they're equal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4001" target="_blank">01:06:41.580</a></span> | <span class="t">or if at least one of them is one these are not equal and they're not one so they're not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4008" target="_blank">01:06:48.140</a></span> | <span class="t">compatible that's why it says the size of a tensor a must match now when it says match it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4019" target="_blank">01:06:59.420</a></span> | <span class="t">mean they have to be the same one of them can be one okay that's what it means to match they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4023" target="_blank">01:07:03.500</a></span> | <span class="t">either equal or one of them is one so that doesn't work on the other hand what if this was 1500 comma</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4033" target="_blank">01:07:13.740</a></span> | <span class="t">one if it was 1500 comma one then they would match because the one and the two match because one of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4043" target="_blank">01:07:23.980</a></span> | <span class="t">them is a unit axis and the 1500 and the 1500 match because they're the same so that's what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4050" target="_blank">01:07:30.620</a></span> | <span class="t">going to do because that would then copy this to every one of these which is what we want we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4057" target="_blank">01:07:37.260</a></span> | <span class="t">want weights for each of these x y tuples so to add the trailing unit axis we say every row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4067" target="_blank">01:07:47.500</a></span> | <span class="t">and a trailing unit axis so that's what that shape looks like so we can now multiply that by x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4076" target="_blank">01:07:56.940</a></span> | <span class="t">and as you can see it's now weighting each of them and so each of these x's and y's down the bottom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4083" target="_blank">01:08:03.020</a></span> | <span class="t">they're all zero so we can sum that up and then divide by the sum of weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4089" target="_blank">01:08:09.820</a></span> | <span class="t">so let's now write a function that puts all this together so you can see this really important way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4098" target="_blank">01:08:18.540</a></span> | <span class="t">of like to me the the only way that makes sense to do particularly scientific numerical programming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4105" target="_blank">01:08:25.260</a></span> | <span class="t">i actually do all my programming this way but particularly scientific and numerical programming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4109" target="_blank">01:08:29.340</a></span> | <span class="t">is write it all out step by step check every piece have it all there documented for you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4114" target="_blank">01:08:34.460</a></span> | <span class="t">and for others and then copy the cells merge them together and indent them to indent its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4121" target="_blank">01:08:41.980</a></span> | <span class="t">control right spread bracket and put a function header on top so here's all those things we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4127" target="_blank">01:08:47.980</a></span> | <span class="t">did and now rather than just grabbing the first x we enumerate through all of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4134" target="_blank">01:08:54.380</a></span> | <span class="t">so that's the distance we had before that's the weight we had before there's the product we had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4139" target="_blank">01:08:59.900</a></span> | <span class="t">before and then finally sum across the rows divide by the sum of the weights so that's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4145" target="_blank">01:09:05.500</a></span> | <span class="t">calculate for the ith it's going to move so it's actually changing capital x so it's changing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4154" target="_blank">01:09:14.780</a></span> | <span class="t">ith thing and capital x so that it's now the weighted sum oh actually sorry the weighted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4159" target="_blank">01:09:19.980</a></span> | <span class="t">average of all of the other data weighted by how far it is away so that's going to do a single step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4168" target="_blank">01:09:28.060</a></span> | <span class="t">so the mean shift update is extremely straightforward which is clone the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4173" target="_blank">01:09:33.660</a></span> | <span class="t">iterate a few times and do the update</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4180" target="_blank">01:09:40.780</a></span> | <span class="t">so if we run it take 600 milliseconds and what i've done is i've plotted the centroids moved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4190" target="_blank">01:09:50.860</a></span> | <span class="t">by two pixels or two well not two pixels two units so that you can see them and so you can see the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4197" target="_blank">01:09:57.180</a></span> | <span class="t">dots is where our data is and they're dots now because every single data point is on top of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4201" target="_blank">01:10:01.980</a></span> | <span class="t">each other on a cluster and so you can see they are now in the correct spots so it has successfully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4207" target="_blank">01:10:07.580</a></span> | <span class="t">clustered our data so that's great news and so we could test out our hypothesis could we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4213" target="_blank">01:10:13.340</a></span> | <span class="t">triangular just as well as we could have used gaussian so control slash comments and uncomments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4218" target="_blank">01:10:18.060</a></span> | <span class="t">yeah we got exactly the same results so that's good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4223" target="_blank">01:10:23.500</a></span> | <span class="t">it's really important to know these keyboard shortcuts hit h to get a list of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4232" target="_blank">01:10:32.940</a></span> | <span class="t">some things that are really important don't have keyboard shortcuts so if you click help edit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4237" target="_blank">01:10:37.740</a></span> | <span class="t">keyboard shortcuts there's a list of all the things jupiter can do and you can add keyboard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4242" target="_blank">01:10:42.940</a></span> | <span class="t">shortcuts to things that don't have them so for example i always add keyboard shortcuts to run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4249" target="_blank">01:10:49.100</a></span> | <span class="t">all cells above and run all cells below as you can see i type q and then a for above and q and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4254" target="_blank">01:10:54.620</a></span> | <span class="t">then b for below all right now that was kind of boring in a way because it did five steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4265" target="_blank">01:11:05.900</a></span> | <span class="t">um but we just saw the result what did it look like one step at a time um this isn't just fun</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4275" target="_blank">01:11:15.580</a></span> | <span class="t">it's really important to be able to see things happening one step at a time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4279" target="_blank">01:11:19.980</a></span> | <span class="t">because there are so many algorithms we do which are like updating weights or updating data you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4284" target="_blank">01:11:24.460</a></span> | <span class="t">know so if a stable diffusion for example you're very likely to want to show you know you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4289" target="_blank">01:11:29.100</a></span> | <span class="t">incrementally denoising and so forth so in my opinion it's important to know how to do animations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4295" target="_blank">01:11:35.180</a></span> | <span class="t">and i found the documentation for this unnecessarily complicated because it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4302" target="_blank">01:11:42.540</a></span> | <span class="t">lot of it's about how to make them performant but most of the time we probably don't care too much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4306" target="_blank">01:11:46.940</a></span> | <span class="t">about that so i want to show you a little trick a simple way to create animations without any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4311" target="_blank">01:11:51.580</a></span> | <span class="t">trouble so matplotlib.animation has something called func animation that's what we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4317" target="_blank">01:11:57.660</a></span> | <span class="t">to create an animation you have to create a function and the function you're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4325" target="_blank">01:12:05.420</a></span> | <span class="t">calling func animation passing in the name of that function and saying how many times to run it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4331" target="_blank">01:12:11.180</a></span> | <span class="t">and that's what this frames argument this says run this function this many times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4338" target="_blank">01:12:18.700</a></span> | <span class="t">and then create an animation that that basically contains the result of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4343" target="_blank">01:12:23.020</a></span> | <span class="t">with a 500 millisecond interval between each one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4345" target="_blank">01:12:25.820</a></span> | <span class="t">so what's this do one going to do to create one frame of animation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4353" target="_blank">01:12:33.100</a></span> | <span class="t">we will call our one update here it is one update right we're going to call this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4363" target="_blank">01:12:43.660</a></span> | <span class="t">that's going to update our axes and then we're going to have an axis which we've created here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4370" target="_blank">01:12:50.540</a></span> | <span class="t">so we're going to clear whatever was on the plot before and plot our new data on that axis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4378" target="_blank">01:12:58.220</a></span> | <span class="t">and then the only other thing you need to do is that the very first time it calls it we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4386" target="_blank">01:13:06.700</a></span> | <span class="t">plot it before running and d is going to be passed automatically the frame number so for the zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4394" target="_blank">01:13:14.300</a></span> | <span class="t">frame we're going to not do the update we're just going to plot the data as it is already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4399" target="_blank">01:13:19.420</a></span> | <span class="t">i guess another way we could have done that would have been just to say if d then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4411" target="_blank">01:13:31.980</a></span> | <span class="t">do the update i suppose that should work too maybe it's even simpler let's see if i just broke it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4418" target="_blank">01:13:38.940</a></span> | <span class="t">okay so we're going to clone our data we're going to create our figure in our subplots we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4424" target="_blank">01:13:44.380</a></span> | <span class="t">to call func animation calling do one five times and then we're going to display the animation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4431" target="_blank">01:13:51.340</a></span> | <span class="t">and so let's see so html takes some html and displays it and two js html creates some html</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4439" target="_blank">01:13:59.580</a></span> | <span class="t">so that's why it's created this html includes javascript and so we'll click run one two three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4446" target="_blank">01:14:06.300</a></span> | <span class="t">four five there's the five steps so if i click loop you'll see them running again and again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4450" target="_blank">01:14:10.700</a></span> | <span class="t">fantastic so that's how easy it is to create a matplotlib animation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4459" target="_blank">01:14:19.660</a></span> | <span class="t">so hopefully now you can use that to play around with some fun stable diffusion animations as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4468" target="_blank">01:14:28.700</a></span> | <span class="t">you don't just have to use touch a shtml you can also create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4473" target="_blank">01:14:33.820</a></span> | <span class="t">you can also create movies for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4481" target="_blank">01:14:41.420</a></span> | <span class="t">so you can call two html five video would be another option</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4492" target="_blank">01:14:52.540</a></span> | <span class="t">and you can save an animation as a movie file so there's all these different options for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4499" target="_blank">01:14:59.180</a></span> | <span class="t">but hopefully that's enough to get you started so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4501" target="_blank">01:15:01.980</a></span> | <span class="t">for your homework i would like you when you create your k-means or whatever to try to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4511" target="_blank">01:15:11.500</a></span> | <span class="t">create your own animation or create an animation of some stable diffusion thing that you're playing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4518" target="_blank">01:15:18.140</a></span> | <span class="t">with so don't forget this important ax.clear you without the ax.clear it prints it on top of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4525" target="_blank">01:15:25.660</a></span> | <span class="t">last one which sometimes is what you want to be fair but in this case it's not what i wanted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4531" target="_blank">01:15:31.260</a></span> | <span class="t">all right so kind of slow half a second for not that much data i'm sure would be nice it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4540" target="_blank">01:15:40.940</a></span> | <span class="t">faster well the good news is we can gpu accelerate it the bad news is it's not going to gpu accelerate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4550" target="_blank">01:15:50.620</a></span> | <span class="t">that well because of this loop this is looping 1500 times if we so looping is not going to run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4561" target="_blank">01:16:01.180</a></span> | <span class="t">on the gpu so the best we could do with this would be to move all this to the gpu now the problem is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4566" target="_blank">01:16:06.940</a></span> | <span class="t">that calling something on the gpu 1500 times from python is a really bad idea because there's this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4574" target="_blank">01:16:14.860</a></span> | <span class="t">kind of huge communication overhead of this kind of flow of control and data switching back between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4581" target="_blank">01:16:21.660</a></span> | <span class="t">the cpu and the gpu it's the kernel launching overhead it's bad news so you don't want to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4589" target="_blank">01:16:29.820</a></span> | <span class="t">a really big fast python loop that inside it calls cuda code it calls gpu code so we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4599" target="_blank">01:16:39.180</a></span> | <span class="t">to make all of this run without the loop which we could do with broadcasting so let's roll up our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4609" target="_blank">01:16:49.260</a></span> | <span class="t">sleeves and try to get the broadcast version of this working so generally speaking the way we tend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4615" target="_blank">01:16:55.180</a></span> | <span class="t">to do things with broadcasting on a gpu is we create batches or mini batches so to create batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4623" target="_blank">01:17:03.820</a></span> | <span class="t">or mini batches we normally just call them batches nowadays we create a batch size so let's say we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4629" target="_blank">01:17:09.740</a></span> | <span class="t">going to do a batch size of five so we're going to do five at a time all right so how do we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4637" target="_blank">01:17:17.420</a></span> | <span class="t">five at a time this is only doing one at a time how do we do five at a time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4642" target="_blank">01:17:22.060</a></span> | <span class="t">as before let's clone our data and this time little x for our testing so we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4649" target="_blank">01:17:29.180</a></span> | <span class="t">everything ahead of time little tests as we always do this is not now x zero anymore but it's x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4655" target="_blank">01:17:35.580</a></span> | <span class="t">colon bs so it's the first five this is now the first five items okay so little x is now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4663" target="_blank">01:17:43.180</a></span> | <span class="t">a five by two matrix this is our mini batch the first five items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4666" target="_blank">01:17:46.860</a></span> | <span class="t">as before our data itself is 1500 by two all right so we need a distance calculation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4674" target="_blank">01:17:54.780</a></span> | <span class="t">but previously our distance calculation um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4679" target="_blank">01:17:59.340</a></span> | <span class="t">previously our distance calculation only worked if little x was a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4686" target="_blank">01:18:06.460</a></span> | <span class="t">number and it returned just the distances from that to everything in big x but we need something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4694" target="_blank">01:18:14.940</a></span> | <span class="t">that's actually going to be um return a matrix right we've got um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4702" target="_blank">01:18:22.380</a></span> | <span class="t">um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4704" target="_blank">01:18:24.380</a></span> | <span class="t">let's see we've got five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4707" target="_blank">01:18:27.660</a></span> | <span class="t">by two in little x and then in big x we've got something much bigger not to scale obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4724" target="_blank">01:18:44.940</a></span> | <span class="t">we've got 1500 by two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4731" target="_blank">01:18:51.180</a></span> | <span class="t">and what is the distance between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4734" target="_blank">01:18:54.700</a></span> | <span class="t">these two things well if you think about it there's going to be a distance between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4745" target="_blank">01:19:05.740</a></span> | <span class="t">item one and item one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4749" target="_blank">01:19:09.500</a></span> | <span class="t">but there's also going to be a distance between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4756" target="_blank">01:19:16.060</a></span> | <span class="t">item one and item two and there's going to be a distance between let's use a different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4762" target="_blank">01:19:22.380</a></span> | <span class="t">color for the next one item two and item one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4767" target="_blank">01:19:27.180</a></span> | <span class="t">right so the output of this is actually going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4775" target="_blank">01:19:35.980</a></span> | <span class="t">a matrix the distances are actually going to give us a matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4783" target="_blank">01:19:43.100</a></span> | <span class="t">where i mean it doesn't matter which way around we do it we can decide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4786" target="_blank">01:19:46.220</a></span> | <span class="t">if we do it this way around for each of the five things in the mini batch there will be 1500</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4793" target="_blank">01:19:53.180</a></span> | <span class="t">distances the distance between every one so we're going to need to do broadcasting to do this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4801" target="_blank">01:20:01.420</a></span> | <span class="t">calculation so this is the function that we're going to create and it's going to create this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4813" target="_blank">01:20:13.260</a></span> | <span class="t">as you can see five by 1500 output but let's see uh how we get it so can we do x minus x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4825" target="_blank">01:20:25.660</a></span> | <span class="t">no we can't why is that that's because big x is 1500 by two and little x is five by two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4835" target="_blank">01:20:35.740</a></span> | <span class="t">so it's going to look at remember our rules right to left are these compatible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4843" target="_blank">01:20:43.660</a></span> | <span class="t">yes they are they're the same are these compatible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4853" target="_blank">01:20:53.980</a></span> | <span class="t">no they're not okay because they're different so that's not possible to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4860" target="_blank">01:21:00.060</a></span> | <span class="t">what if though we wanted to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4865" target="_blank">01:21:05.580</a></span> | <span class="t">what if we insert in big x an axis at the start here and in little x we add an axis in the middle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4880" target="_blank">01:21:20.540</a></span> | <span class="t">here then now these are compatible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4884" target="_blank">01:21:24.940</a></span> | <span class="t">because you've got they're the same because i should use arrows really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4893" target="_blank">01:21:33.500</a></span> | <span class="t">these are compatible because one of them is a one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4898" target="_blank">01:21:38.220</a></span> | <span class="t">and these are compatible because one of them is the one as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4903" target="_blank">01:21:43.420</a></span> | <span class="t">so they are all compatible and what it's going to do is it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4908" target="_blank">01:21:48.620</a></span> | <span class="t">do this attraction between these directly and it's going to copy this across all 1500 rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4918" target="_blank">01:21:58.220</a></span> | <span class="t">it'll copy it this is going to be copied and then this sorry across five rows and then this will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4925" target="_blank">01:22:05.580</a></span> | <span class="t">copied across these 1500 rows because that's what broadcasting does i mean it's not really copying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4931" target="_blank">01:22:11.340</a></span> | <span class="t">but it's effectively copying and so that gives us we can now subtract them and that gives us what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4940" target="_blank">01:22:20.460</a></span> | <span class="t">we wanted which is five by 1500 and there's also by two because there's both the x and the y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4947" target="_blank">01:22:27.420</a></span> | <span class="t">so that's why this works that's what this is doing here it's taking this attraction it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4954" target="_blank">01:22:34.540</a></span> | <span class="t">squaring them and then summing over that last shortest axis summing over the x and the y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4962" target="_blank">01:22:42.140</a></span> | <span class="t">squares and then take square root i don't know why i said torch dot square root we could just put dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4966" target="_blank">01:22:46.780</a></span> | <span class="t">square root at the end but same same in fact it's worth mentioning that so most things that you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4973" target="_blank">01:22:53.180</a></span> | <span class="t">do on tensors you can either write torch dot as a function or you can write it as a method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4982" target="_blank">01:23:02.220</a></span> | <span class="t">generally speaking both should be fine not everything but most things work in both spots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4988" target="_blank">01:23:08.540</a></span> | <span class="t">okay so now we've got this matrix which is five by 1500 and the nice thing is that our Gaussian</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=4998" target="_blank">01:23:18.220</a></span> | <span class="t">kernel doesn't actually have to be changed to get the weights believe it or not and the reason for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5003" target="_blank">01:23:23.980</a></span> | <span class="t">that is now how do we get the source code i could move back up there or i can just type Gaussian</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5009" target="_blank">01:23:29.020</a></span> | <span class="t">question mark question mark and see it and the nice thing is that this is just this is a scalar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5016" target="_blank">01:23:36.620</a></span> | <span class="t">so it broadcasts over anything and then this is also just a scalar so this is all going to work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5025" target="_blank">01:23:45.100</a></span> | <span class="t">fine without any fiddling around okay so now we've got a five by 1500 weight so that's the weight for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5038" target="_blank">01:23:58.380</a></span> | <span class="t">each of the five things our mini battery each of the 1500 things each of them is compared to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5042" target="_blank">01:24:02.460</a></span> | <span class="t">and then we've got the shape of the data itself x dot shape which is the 1500 points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5049" target="_blank">01:24:09.900</a></span> | <span class="t">so now we want to apply each one of these weights to each of these columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5057" target="_blank">01:24:17.420</a></span> | <span class="t">so we need to add a unit axis to the end so to add a unit axis to the end we could say colon comma</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5067" target="_blank">01:24:27.420</a></span> | <span class="t">colon comma none but dot dot dot means all of the axes up until however many you need so in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5074" target="_blank">01:24:34.380</a></span> | <span class="t">case the last one common none so this is going to add an axis to the end so this is going to turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5081" target="_blank">01:24:41.420</a></span> | <span class="t">this is going to turn weight dot shape from five comma 1500 to five comma 1500 comma one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5087" target="_blank">01:24:47.580</a></span> | <span class="t">and this is going to add an axis to the start remember it's the same as x none comma colon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5094" target="_blank">01:24:54.300</a></span> | <span class="t">comma colon and so let's check our rules left right to left these are compatible because one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5104" target="_blank">01:25:04.300</a></span> | <span class="t">of them is one these are compatible because they're both the same and these are compatible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5111" target="_blank">01:25:11.420</a></span> | <span class="t">because one of them is one okay so it's going to be um copying each weight across to each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5122" target="_blank">01:25:22.540</a></span> | <span class="t">the x and y which is what we want we want to um we want to weight both of those components</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5127" target="_blank">01:25:27.820</a></span> | <span class="t">and it's going to copy each of the 1500 points sorry each of the point five times because we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5137" target="_blank">01:25:37.820</a></span> | <span class="t">do in fact want to weight every one of the five things in our mini batch a separate set of weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5142" target="_blank">01:25:42.220</a></span> | <span class="t">for each of them so that sounds perfect so that's how i think through these calculations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5149" target="_blank">01:25:49.260</a></span> | <span class="t">okay so we can now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5155" target="_blank">01:25:55.820</a></span> | <span class="t">do that multiplication which is going to give us something of five by 1500 by two because we end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5164" target="_blank">01:26:04.540</a></span> | <span class="t">up with the maximum of our ranks and then we sum up over those 1500 points and that's going to give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5172" target="_blank">01:26:12.700</a></span> | <span class="t">us now five new data points um now something that you might notice here is that we've got a product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5189" target="_blank">01:26:29.100</a></span> | <span class="t">and a sum and when you see a product and a sum that tells you that maybe we should use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5199" target="_blank">01:26:39.660</a></span> | <span class="t">a sum so in this case we've got our weight we've got five by 1500 so let's call those i and j</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5213" target="_blank">01:26:53.420</a></span> | <span class="t">those for the five and 1500 we've got the x is 1500 by two now we want to take the product of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5220" target="_blank">01:27:00.860</a></span> | <span class="t">that and that so we need to use the same name for this rows so we use j again okay and then k is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5230" target="_blank">01:27:10.940</a></span> | <span class="t">number of rows that's the two and then we want to end up with i by k so torch.insum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5237" target="_blank">01:27:17.900</a></span> | <span class="t">gives exactly the same result that's great but you might recognize this that's exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5245" target="_blank">01:27:25.820</a></span> | <span class="t">the same ironsum we had just before when we were doing matrix multiplication oh that is a matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5251" target="_blank">01:27:31.500</a></span> | <span class="t">multiplication we've just reinvented matrix multiplication using uh this rather nifty trick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5261" target="_blank">01:27:41.180</a></span> | <span class="t">so we could also just use that and so you know again this is like um what i was just playing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5269" target="_blank">01:27:49.260</a></span> | <span class="t">around with this morning as i started to look at this and i was thinking like oh you know can we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5273" target="_blank">01:27:53.900</a></span> | <span class="t">simplify this i don't like this kind of like messing around with axes and summing over dimensions and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5279" target="_blank">01:27:59.820</a></span> | <span class="t">whatnot and so it's nice to get things down to i and sum or better still getting down to matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5285" target="_blank">01:28:05.180</a></span> | <span class="t">model applies it's just clearer you know it's stuff that we all recognize because we use them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5289" target="_blank">01:28:09.660</a></span> | <span class="t">all the time they all work performance would be pretty similar i suspect um okay so now that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5299" target="_blank">01:28:19.980</a></span> | <span class="t">got that we then need to do our sum and we've got our five points this is our five uh denominators</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5310" target="_blank">01:28:30.860</a></span> | <span class="t">so we've got our numerator that we calculated up here for our weighted uh for our weighted average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5316" target="_blank">01:28:36.540</a></span> | <span class="t">the denominator is just the sum of the weights remember and so numerator divided by denominator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5321" target="_blank">01:28:41.820</a></span> | <span class="t">is our answer so again we've gone through every step we've checked out all the dimensions all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5327" target="_blank">01:28:47.420</a></span> | <span class="t">along the way so nothing's going to surprise us don't try and write a function like this just bang</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5333" target="_blank">01:28:53.180</a></span> | <span class="t">from scratch right you've got to drive yourself crazy instead do it step by step so here's our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5339" target="_blank">01:28:59.500</a></span> | <span class="t">mean shift algorithm clone the data go through five iterations and now go from naught to n</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5348" target="_blank">01:29:08.460</a></span> | <span class="t">batch size at a time so python has something called slices so we can create a slice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5358" target="_blank">01:29:18.140</a></span> | <span class="t">of x starting at one up to i plus batch size right unless you've gone past n which goes use n</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5367" target="_blank">01:29:27.100</a></span> | <span class="t">and so then we're just copying and pasting each of the lines of code that we had before actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5372" target="_blank">01:29:32.860</a></span> | <span class="t">i just copy the cells and merge them of course i don't actually copy and paste because it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5376" target="_blank">01:29:36.140</a></span> | <span class="t">so boring and there's my final step to create the new xs and so notice here s is not a single thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5385" target="_blank">01:29:45.740</a></span> | <span class="t">it's a slice of things you might not have seen slice before but this is just internally what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5390" target="_blank">01:29:50.780</a></span> | <span class="t">python's doing when you use colon and it's very convenient when you need to use the same slice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5395" target="_blank">01:29:55.340</a></span> | <span class="t">multiple times okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5399" target="_blank">01:29:59.340</a></span> | <span class="t">so let's do that using CUDA i would run it first without CUDA but i mean i've done all the steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5409" target="_blank">01:30:09.900</a></span> | <span class="t">before so it should be fine um so pop it on the GPU and run beam shift and let's see how long that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5417" target="_blank">01:30:17.660</a></span> | <span class="t">takes it takes one millisecond and previously without GPU it took 400 milliseconds and you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5425" target="_blank">01:30:25.740</a></span> | <span class="t">the other thing we should probably think about doing is looking at other batch sizes as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5430" target="_blank">01:30:30.460</a></span> | <span class="t">because now we're looping over batches right so if we make the batch size bigger that for loop is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5438" target="_blank">01:30:38.460</a></span> | <span class="t">going to do less looping so what if we make that 16 will that be any faster i actually never tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5445" target="_blank">01:30:45.900</a></span> | <span class="t">this before that's interesting it's actually slower</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5452" target="_blank">01:30:52.540</a></span> | <span class="t">huh there you go fascinating what if it was eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5463" target="_blank">01:31:03.020</a></span> | <span class="t">amazing so the big batches don't quite seem to be working so well for some reason so i wonder if i've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5469" target="_blank">01:31:09.020</a></span> | <span class="t">hang on what's going on why is it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5473" target="_blank">01:31:13.340</a></span> | <span class="t">why is it changing how it should be uh my batch size was five why is it slower suddenly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5482" target="_blank">01:31:22.140</a></span> | <span class="t">i think it's just a bit varying is probably the answer so it just varies a lot okay so it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5492" target="_blank">01:31:32.380</a></span> | <span class="t">seem like changing the batch size is changing much here um so that's fine so we'll just leave it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5499" target="_blank">01:31:39.500</a></span> | <span class="t">where it was and then check looking at the data oh that looks lovely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5503" target="_blank">01:31:43.740</a></span> | <span class="t">oh i see thank you people on youtube pointing out that i'm passing batch size so i actually need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5515" target="_blank">01:31:55.180</a></span> | <span class="t">to put it here all right so if we used a batch size of five no wonder it was messing up oh look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5521" target="_blank">01:32:01.420</a></span> | <span class="t">at that i've totally made it slow now 157 milliseconds ha ha okay 64 13 milliseconds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5533" target="_blank">01:32:13.660</a></span> | <span class="t">all right finally that makes much more sense 256</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5536" target="_blank">01:32:16.700</a></span> | <span class="t">1024 okay so the bigger bigger is better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5543" target="_blank">01:32:23.740</a></span> | <span class="t">and i guess we could actually do all 5000 at once probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5550" target="_blank">01:32:30.460</a></span> | <span class="t">okay nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5552" target="_blank">01:32:32.780</a></span> | <span class="t">all right thank you youtube friends for solving that bizarre mystery</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5562" target="_blank">01:32:42.540</a></span> | <span class="t">okay all right so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5569" target="_blank">01:32:49.980</a></span> | <span class="t">that's pretty great i mean you know to see um that we can gpu optimizer mean shift</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5579" target="_blank">01:32:59.740</a></span> | <span class="t">like actually googled for this to see if it's been done before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5583" target="_blank">01:33:03.020</a></span> | <span class="t">um and it's the kind of thing that people like write papers about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5590" target="_blank">01:33:10.620</a></span> | <span class="t">um so i think it's great that we can do it so easily with pytorch and it's the kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5600" target="_blank">01:33:20.220</a></span> | <span class="t">thing that previously had been considered you know a very challenging academic problem to solve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5608" target="_blank">01:33:28.540</a></span> | <span class="t">so maybe you can do something similar with some of these now i haven't told you what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5613" target="_blank">01:33:33.100</a></span> | <span class="t">these are so part of the homework is to go read about them and learn about them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5616" target="_blank">01:33:36.380</a></span> | <span class="t">db scan funnily enough actually is an algorithm that i accidentally invented and then discovered a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5623" target="_blank">01:33:43.580</a></span> | <span class="t">year later had already been invented that was a long time ago i was playing around with j which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5629" target="_blank">01:33:49.340</a></span> | <span class="t">is the successor to apl on a very old windows phone um and i had a long plane flight and i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5637" target="_blank">01:33:57.500</a></span> | <span class="t">came up with an algorithm and implemented the whole thing on my phone using j um and then discovered a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5642" target="_blank">01:34:02.780</a></span> | <span class="t">year later that i just invented db scan this is actually a really cool algorithm and it's got a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5647" target="_blank">01:34:07.580</a></span> | <span class="t">lot of similarities to mean shift um lsh comes up all the time um so that's great um and in fact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5657" target="_blank">01:34:17.580</a></span> | <span class="t">i have a strong feeling and i've been thinking about this for a while that something like lsh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5663" target="_blank">01:34:23.340</a></span> | <span class="t">could be used to speed this whole thing up a lot um because if you think about it and again maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5668" target="_blank">01:34:28.300</a></span> | <span class="t">they're already this already exists i don't know but if you think about it when we did that distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5673" target="_blank">01:34:33.420</a></span> | <span class="t">calculation the the vast majority of the the weights are nearly zero and so it seems pointless</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5682" target="_blank">01:34:42.540</a></span> | <span class="t">to create that big you know kind of eventually 1500 by 1500 matrix um that's slow it would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5691" target="_blank">01:34:51.900</a></span> | <span class="t">much better if we just found the ones that were like pretty close by and just took their average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5697" target="_blank">01:34:57.260</a></span> | <span class="t">and so you want an optimized nearest neighbors basically and so um this is an example of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5705" target="_blank">01:35:05.260</a></span> | <span class="t">something that can give you a uh an up a kind of a fast nearest neighbors algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5709" target="_blank">01:35:09.740</a></span> | <span class="t">um or you know there are things like kd trees and opt trees and stuff like that so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5717" target="_blank">01:35:17.420</a></span> | <span class="t">if you want to like have a bonus bonus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5722" target="_blank">01:35:22.060</a></span> | <span class="t">invent a new mean shift algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5726" target="_blank">01:35:26.780</a></span> | <span class="t">which picks only the closest points to avoid quadratic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5742" target="_blank">01:35:42.860</a></span> | <span class="t">type all right so not very often you get an assignment which is to invent a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5751" target="_blank">01:35:51.020</a></span> | <span class="t">mean shift algorithm i guess a super super bonus super super bonus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5757" target="_blank">01:35:57.660</a></span> | <span class="t">publish a paper that describes it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5764" target="_blank">01:36:04.780</a></span> | <span class="t">all right you definitely get four points if you do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5770" target="_blank">01:36:10.780</a></span> | <span class="t">we'll give you a number of points equal to the impact factor of the journal you get it published in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5774" target="_blank">01:36:14.220</a></span> | <span class="t">okay um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5778" target="_blank">01:36:18.060</a></span> | <span class="t">so what i want to do now is move on to calculus which for some of us may not be our favorite topic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5800" target="_blank">01:36:40.620</a></span> | <span class="t">that's funny stefano wrote the ironsome version here already i didn't notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5804" target="_blank">01:36:44.300</a></span> | <span class="t">okay always ahead of his time that guy um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5807" target="_blank">01:36:47.980</a></span> | <span class="t">let's talk about calculus um if you're not um super comfortable with derivatives and what they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5817" target="_blank">01:36:57.020</a></span> | <span class="t">are and why we care um three blue one brown has a wonderful series called the essence of calculus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5823" target="_blank">01:37:03.420</a></span> | <span class="t">which i strongly recommend watching um it's just a pleasure actually to watch uh as it's everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5830" target="_blank">01:37:10.780</a></span> | <span class="t">that is on three blue one brown a pleasure to watch um the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5837" target="_blank">01:37:17.900</a></span> | <span class="t">and so we're not going to get into back prop today instead we're just going to have a quick chat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5845" target="_blank">01:37:25.820</a></span> | <span class="t">about about calculus where do we start so the good news is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5860" target="_blank">01:37:40.300</a></span> | <span class="t">just like you don't have to know much linear algebra at all you basically just need to know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5865" target="_blank">01:37:45.740</a></span> | <span class="t">about matrix multiplication um you also don't need to know um much calculus at all um just derivatives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5875" target="_blank">01:37:55.740</a></span> | <span class="t">so let's think about like what derivatives are so i'm going to borrow actually the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5884" target="_blank">01:38:04.060</a></span> | <span class="t">starting point that um three blue one brown uses one of their videos is to consider a car</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5891" target="_blank">01:38:11.740</a></span> | <span class="t">and we're going to see um how far away from home it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5894" target="_blank">01:38:14.860</a></span> | <span class="t">at various time points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5899" target="_blank">01:38:19.340</a></span> | <span class="t">okay so after a minute let's say after a second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5906" target="_blank">01:38:26.700</a></span> | <span class="t">it's traveled five meters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5912" target="_blank">01:38:32.780</a></span> | <span class="t">and then after two seconds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5918" target="_blank">01:38:38.620</a></span> | <span class="t">it's traveled 10 meters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5923" target="_blank">01:38:43.260</a></span> | <span class="t">okay and after three seconds you can probably guess it's traveled 15 meters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5929" target="_blank">01:38:49.740</a></span> | <span class="t">so there's this concept here of uh um yeah got it the wrong way around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5943" target="_blank">01:39:03.340</a></span> | <span class="t">obviously so time distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5951" target="_blank">01:39:11.660</a></span> | <span class="t">okay so um there's this concept of yeah of like location it's like how far how far have you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5965" target="_blank">01:39:25.740</a></span> | <span class="t">traveled um at a particular point in time so we can look at one of these points and find out how far</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5972" target="_blank">01:39:32.620</a></span> | <span class="t">that car is gone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5973" target="_blank">01:39:33.660</a></span> | <span class="t">we could also take two points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5979" target="_blank">01:39:39.020</a></span> | <span class="t">and we can say where did it start at the start of those two points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5985" target="_blank">01:39:45.260</a></span> | <span class="t">and where did it finish at the end of those two points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5988" target="_blank">01:39:48.940</a></span> | <span class="t">and we can say between those two points how much time passed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=5996" target="_blank">01:39:56.300</a></span> | <span class="t">and how far did they travel in two seconds they traveled 10 meters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6002" target="_blank">01:40:02.620</a></span> | <span class="t">so we could now also say all right well the slope of something is rise over run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6014" target="_blank">01:40:14.940</a></span> | <span class="t">oopsie dozy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6022" target="_blank">01:40:22.140</a></span> | <span class="t">10 meters in two seconds and notice we don't just divide the numbers we also divide the units</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6031" target="_blank">01:40:31.900</a></span> | <span class="t">we get five meters per second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6036" target="_blank">01:40:36.300</a></span> | <span class="t">so um this here is now change the dimensions entirely we're now not looking at distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6048" target="_blank">01:40:48.380</a></span> | <span class="t">but we're looking at speed or velocity and it's equal to rise over run it's equal to the rate of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6059" target="_blank">01:40:59.660</a></span> | <span class="t">change and what it says really is as time the x-axis goes up by one second what happens to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6077" target="_blank">01:41:17.180</a></span> | <span class="t">distance in meters as one second passes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6083" target="_blank">01:41:23.260</a></span> | <span class="t">how does the number of meters change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6093" target="_blank">01:41:33.100</a></span> | <span class="t">and so maybe these aren't points at all maybe there's a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6102" target="_blank">01:41:42.300</a></span> | <span class="t">right it's a continuum of points and so you can do that for the function so the function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6108" target="_blank">01:41:48.380</a></span> | <span class="t">is a function of time distance is a function of time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6113" target="_blank">01:41:53.820</a></span> | <span class="t">and so we could say what's the slope of that function and we can get the slope from point a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6123" target="_blank">01:42:03.660</a></span> | <span class="t">to point b using rise over run so from t1 to t2 the amount of distance that's uh the amount of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6133" target="_blank">01:42:13.900</a></span> | <span class="t">time that's passed is t2 minus t1 that's how much time has passed let's say this is t1 this is t2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6149" target="_blank">01:42:29.260</a></span> | <span class="t">and the distance that they've traveled while they've moved from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6153" target="_blank">01:42:33.100</a></span> | <span class="t">wherever they are at the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6159" target="_blank">01:42:39.100</a></span> | <span class="t">to wherever they were at the start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6163" target="_blank">01:42:43.100</a></span> | <span class="t">so that's the change in distance divided by the change in time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6169" target="_blank">01:42:49.020</a></span> | <span class="t">change in distance divided by change in time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6178" target="_blank">01:42:58.140</a></span> | <span class="t">okay let's say that's y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6181" target="_blank">01:43:01.580</a></span> | <span class="t">so another way um now the thing is when we talk about calculus we talk about finding a slope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6191" target="_blank">01:43:11.340</a></span> | <span class="t">but we talk about finding a slope of something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6196" target="_blank">01:43:16.060</a></span> | <span class="t">that's more often more tricky than this right we have slopes of things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6205" target="_blank">01:43:25.660</a></span> | <span class="t">that look more like this and we say what's this slope oops and terrible chapter drawing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6217" target="_blank">01:43:37.660</a></span> | <span class="t">let's maybe put it over here because i'm left-handed what's this slope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6222" target="_blank">01:43:42.860</a></span> | <span class="t">now what does it mean to have like the idea of a velocity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6233" target="_blank">01:43:53.580</a></span> | <span class="t">at an exact moment in time it doesn't mean anything you know at an exact moment in time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6242" target="_blank">01:44:02.540</a></span> | <span class="t">you're just like it's frozen right what's happening exactly now but what you can do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6248" target="_blank">01:44:08.300</a></span> | <span class="t">is you can say well what's the change in time between a bit before our point and a bit after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6254" target="_blank">01:44:14.140</a></span> | <span class="t">our point and what's the change in distance between a bit before our point and a bit after our point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6259" target="_blank">01:44:19.820</a></span> | <span class="t">and so you can do the same kind of rise over run thing right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6263" target="_blank">01:44:23.740</a></span> | <span class="t">but you can make that distance between t2 and t1 smaller and smaller and smaller so let's rewrite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6275" target="_blank">01:44:35.740</a></span> | <span class="t">this in a slightly different way let's call the denominator the distance between t1 plus a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6290" target="_blank">01:44:50.140</a></span> | <span class="t">bit we'll call it d it's that minus t1 so this is t2 right it's t1 plus a little bit so we say oh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6303" target="_blank">01:45:03.900</a></span> | <span class="t">here's t1 let's add a little bit and notice that when we write it this well let's actually let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6310" target="_blank">01:45:10.060</a></span> | <span class="t">do the rest of it so now f of t2 becomes f of t1 plus a little bit and this is the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6319" target="_blank">01:45:19.580</a></span> | <span class="t">and now notice here that t1 plus d minus t1 we can delete all that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6330" target="_blank">01:45:30.940</a></span> | <span class="t">because it just comes out to d so this is another way of calculating the slope of our function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6338" target="_blank">01:45:38.940</a></span> | <span class="t">and as d gets smaller and smaller and smaller we're kind of getting a triangle that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6346" target="_blank">01:45:46.540</a></span> | <span class="t">tinier and tinier and tinier and it still makes sense it's still that some time has passed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6352" target="_blank">01:45:52.540</a></span> | <span class="t">and the car is moved right but it's just smaller and smaller amounts of time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6360" target="_blank">01:46:00.140</a></span> | <span class="t">now if you did calculus at college or at school you might have done all this stuff messing around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6367" target="_blank">01:46:07.980</a></span> | <span class="t">with limits and epsilon delta and blah blah blah i've got really good news it turns out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6377" target="_blank">01:46:17.820</a></span> | <span class="t">you can actually just think of this d as a really small number where d is the difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6389" target="_blank">01:46:29.180</a></span> | <span class="t">difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6394" target="_blank">01:46:34.220</a></span> | <span class="t">and so when we calculate the slope</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6402" target="_blank">01:46:42.700</a></span> | <span class="t">we can write it in a slightly different way as the change in y divided by the change in x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6417" target="_blank">01:46:57.180</a></span> | <span class="t">this here is the change in y and this here is the change in x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6421" target="_blank">01:47:01.260</a></span> | <span class="t">and so in other words this here is a very small number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6426" target="_blank">01:47:06.780</a></span> | <span class="t">a very small number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6430" target="_blank">01:47:10.860</a></span> | <span class="t">and this here is the result in the function of changing by that very small number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6444" target="_blank">01:47:24.860</a></span> | <span class="t">and this way of thinking about calculus is known as the calculus of infinitesimals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6452" target="_blank">01:47:32.460</a></span> | <span class="t">and it's how Leibniz originally developed it and it's been turned into a whole theory nowadays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6464" target="_blank">01:47:44.860</a></span> | <span class="t">and the reason i talk about it here is because when we do calculus you'll see me doing stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6472" target="_blank">01:47:52.060</a></span> | <span class="t">all the time where i act like dx is a really small number and when i was at school i was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6479" target="_blank">01:47:59.500</a></span> | <span class="t">told i wasn't allowed to do that i've since learned that it's totally fine to do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6484" target="_blank">01:48:04.060</a></span> | <span class="t">so for example next lesson we're going to be looking at the chain rule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6488" target="_blank">01:48:08.300</a></span> | <span class="t">which looks like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6492" target="_blank">01:48:12.140</a></span> | <span class="t">dy dx equals dy du times du dx</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6501" target="_blank">01:48:21.180</a></span> | <span class="t">and i'm just going to say oh these two small numbers can cancel out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6505" target="_blank">01:48:25.020</a></span> | <span class="t">and that's why obviously they're the same thing and that's all going to work out nicely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6511" target="_blank">01:48:31.100</a></span> | <span class="t">so anywho what would be very helpful would be if before the next lesson if you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6519" target="_blank">01:48:39.980</a></span> | <span class="t">not totally up to date with your you know remembering all the stuff you did in high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6525" target="_blank">01:48:45.020</a></span> | <span class="t">school about calculus is watch the three blue one brown course we are not going to be looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6532" target="_blank">01:48:52.380</a></span> | <span class="t">i don't think at all at integration so you don't have to worry about that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6538" target="_blank">01:48:58.060</a></span> | <span class="t">also we are not going to on the whole be doing any derivatives by hand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6549" target="_blank">01:49:09.660</a></span> | <span class="t">so for example there are rules such as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6556" target="_blank">01:49:16.060</a></span> | <span class="t">dy dx if y equals x squared is 2x these kind of rules you're not really going to have to learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6566" target="_blank">01:49:26.860</a></span> | <span class="t">because pytorch is going to do them all for you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6571" target="_blank">01:49:31.100</a></span> | <span class="t">the one that we care about is going to be the chain rule but we're going to learn about that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6576" target="_blank">01:49:36.220</a></span> | <span class="t">next time okay i hope i don't get beaten to a bloody pulp the next time i walk into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6583" target="_blank">01:49:43.100</a></span> | <span class="t">mathematicians conference i suspect i might um but hopefully i get away with with this uh i i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6593" target="_blank">01:49:53.020</a></span> | <span class="t">it's safe we'll see how we go um so um thanks everybody very much for joining me um and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6605" target="_blank">01:50:05.900</a></span> | <span class="t">really look forward to seeing you next time where we're going to do back propagation from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6610" target="_blank">01:50:10.620</a></span> | <span class="t">we've already learned to multiply matrices so once we've got back propagation as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=_xIzPbCgutY&t=6615" target="_blank">01:50:15.900</a></span> | <span class="t">we'll be ready to train a neural network all right thanks all bye</span></div></div></body></html>