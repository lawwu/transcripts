<html><head><title>Spotify's Podcast Search Explained</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Spotify's Podcast Search Explained</h2><a href="https://www.youtube.com/watch?v=ok0SDdXdat8"><img src="https://i.ytimg.com/vi/ok0SDdXdat8/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=256">4:16</a> NLP in Semantic Search<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=515">8:35</a> Why Now?<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=569">9:29</a> Transformer Models<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=712">11:52</a> Sentence Transformers<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=792">13:12</a> Vector Search<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=956">15:56</a> How Spotify Built Podcast Search<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1055">17:35</a> Data Source, Fine-tuning, and Eval<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1378">22:58</a> Code Implementation, Dataset<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1484">24:44</a> Data Preparation<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1599">26:39</a> Query Generation<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1794">29:54</a> Fine-tuning a Podcast Model<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2500">41:40</a> Evaluation<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2885">48:5</a> Does it Scale?<br><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2940">49:0</a> Sharing Your Work<br><br><div style="text-align: left;"><a href="./ok0SDdXdat8.html">Whisper Transcript</a> | <a href="./transcript_ok0SDdXdat8.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">in the past few years podcasts have become increasingly popular and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=5" target="_blank">00:00:05.120</a></span> | <span class="t">leading the charge in podcasts is Spotify now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=9" target="_blank">00:00:09.200</a></span> | <span class="t">Spotify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=11" target="_blank">00:00:11.260</a></span> | <span class="t">Only very recently entered the market for podcasts in 2018</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=16" target="_blank">00:00:16.440</a></span> | <span class="t">Despite that in a few short years</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=19" target="_blank">00:00:19.880</a></span> | <span class="t">So by 2021 they had already usurped Apple as the leader in terms of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=26" target="_blank">00:00:26.000</a></span> | <span class="t">monthly active listeners</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=29" target="_blank">00:00:29.000</a></span> | <span class="t">Now Apple has been doing this for a very long time since I think it's 2008 or maybe even earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=34" target="_blank">00:00:34.940</a></span> | <span class="t">But despite that Spotify and now ahead of everyone and of course to back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=41" target="_blank">00:00:41.920</a></span> | <span class="t">Their sort of investments in podcasts. They've also invested heavily in the technology that powers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=49" target="_blank">00:00:49.320</a></span> | <span class="t">different components of the podcast experience</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=52" target="_blank">00:00:52.800</a></span> | <span class="t">Whether that's anchor which is an all-in-one app that allows people to record</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=59" target="_blank">00:00:59.320</a></span> | <span class="t">Publish podcasts or what? We're going to focus on a natural language search for podcasts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=66" target="_blank">00:01:06.120</a></span> | <span class="t">now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=68" target="_blank">00:01:08.080</a></span> | <span class="t">Spotify's natural language search or semantic search for podcasts is I think a really interesting use case because it enables a more intuitive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=75" target="_blank">00:01:15.640</a></span> | <span class="t">user experience</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=77" target="_blank">00:01:17.840</a></span> | <span class="t">By allowing us to search through their podcast catalog, which is huge using more natural language queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=86" target="_blank">00:01:26.400</a></span> | <span class="t">Rather than the typical keyword or term matching that you would do in most places</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=91" target="_blank">00:01:31.440</a></span> | <span class="t">so beforehand where we were searching we'd have to kind of know the words that we're looking for or the terms that we're looking for and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=100" target="_blank">00:01:40.120</a></span> | <span class="t">I think we as humans. We don't really know what exactly we're looking for in terms of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=107" target="_blank">00:01:47.200</a></span> | <span class="t">words or keywords that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=109" target="_blank">00:01:49.760</a></span> | <span class="t">In whatever it is. We're looking for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=111" target="_blank">00:01:51.880</a></span> | <span class="t">Instead we tend to think more in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=116" target="_blank">00:01:56.280</a></span> | <span class="t">Concepts and ideas. Our language is meaningful. It's not specifically about term matching or keyword matching</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=122" target="_blank">00:02:02.760</a></span> | <span class="t">so it makes sense that we might want to create a search experience that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=129" target="_blank">00:02:09.560</a></span> | <span class="t">Replicates the meaning in language rather than just terms and words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=134" target="_blank">00:02:14.000</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=136" target="_blank">00:02:16.480</a></span> | <span class="t">Imagine we wanted to find a podcast that talks about eating healthily over the winter holidays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=143" target="_blank">00:02:23.280</a></span> | <span class="t">Okay, we might search something like this. We eat better during Xmas holidays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=149" target="_blank">00:02:29.960</a></span> | <span class="t">Now in the days that we're going to be using there is a podcast description that talks about exactly this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=155" target="_blank">00:02:35.960</a></span> | <span class="t">It's description is Alex Draney tracks to dr</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=159" target="_blank">00:02:39.320</a></span> | <span class="t">Priya Alexander about how to stay healthy over Christmas and about her letter to patients now if you compare those two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=166" target="_blank">00:02:46.920</a></span> | <span class="t">They don't share any of the same words despite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=170" target="_blank">00:02:50.840</a></span> | <span class="t">Pretty much being about the same thing. So if you try and use this in a term matching query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=178" target="_blank">00:02:58.880</a></span> | <span class="t">It's not going to work. But if we were to spot that for an actual language query or a semantic search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=186" target="_blank">00:03:06.120</a></span> | <span class="t">it does because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=189" target="_blank">00:03:09.120</a></span> | <span class="t">What we are searching for here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=191" target="_blank">00:03:11.680</a></span> | <span class="t">the meaning overlaps the genuine like human meaning behind those two phrases is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=200" target="_blank">00:03:20.440</a></span> | <span class="t">very similar and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=202" target="_blank">00:03:22.440</a></span> | <span class="t">When a semantic search is done properly it is able to identify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=207" target="_blank">00:03:27.480</a></span> | <span class="t">Okay, we're looking for the meaning behind these and the meaning of these two does overlap</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=214" target="_blank">00:03:34.000</a></span> | <span class="t">We're talking about some Christmas holidays being healthy eating better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=218" target="_blank">00:03:38.320</a></span> | <span class="t">they're very similar concepts, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=221" target="_blank">00:03:41.600</a></span> | <span class="t">Enabling meaningful search in this way is is not easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=226" target="_blank">00:03:46.320</a></span> | <span class="t">so what I want to do is actually have a look at how Spotify have done this and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=231" target="_blank">00:03:51.280</a></span> | <span class="t">Actually replicate it and see what we can do as well. So the technology powering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=238" target="_blank">00:03:58.280</a></span> | <span class="t">Spotify semantic search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=240" target="_blank">00:04:00.880</a></span> | <span class="t">consists of two different components</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=242" target="_blank">00:04:02.880</a></span> | <span class="t">We have the NLP or natural language processing side of it and we also have the vector search component now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=250" target="_blank">00:04:10.680</a></span> | <span class="t">These technologies can be seen as two steps in the search process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=255" target="_blank">00:04:15.920</a></span> | <span class="t">given a natural language query a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=258" target="_blank">00:04:18.120</a></span> | <span class="t">Language model. So this is the NLP side. We'll take that query and convert it into something. We called a dense vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=266" target="_blank">00:04:26.320</a></span> | <span class="t">Which is essentially a meaning encoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=270" target="_blank">00:04:30.760</a></span> | <span class="t">numeric representation of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=273" target="_blank">00:04:33.640</a></span> | <span class="t">Whatever that query is. Okay sounds confusing, but we'll see that it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=280" target="_blank">00:04:40.160</a></span> | <span class="t">Really too complex quite soon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=283" target="_blank">00:04:43.400</a></span> | <span class="t">These dense vectors can then be compared as you would compare normal vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=289" target="_blank">00:04:49.360</a></span> | <span class="t">So imagine you have two points in a particular space and you want to calculate the distance between them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=295" target="_blank">00:04:55.160</a></span> | <span class="t">We can literally do that but with the meaning behind these queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=300" target="_blank">00:05:00.880</a></span> | <span class="t">so let's have a look at an example of that so here we just have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=305" target="_blank">00:05:05.480</a></span> | <span class="t">3d chart and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=308" target="_blank">00:05:08.080</a></span> | <span class="t">Typically when you have these dense vectors, they have many dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=312" target="_blank">00:05:12.040</a></span> | <span class="t">Okay, so you're you're looking at 700 plus dimensions in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=315" target="_blank">00:05:15.640</a></span> | <span class="t">these vector representations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=318" target="_blank">00:05:18.640</a></span> | <span class="t">In this one we've used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=321" target="_blank">00:05:21.480</a></span> | <span class="t">PCA to reduce the dimensionality of those very high dimensional vectors into a 3d space just so we can visualize it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=329" target="_blank">00:05:29.040</a></span> | <span class="t">But still maintain this or relationships between those vectors. So if we have a look here we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=336" target="_blank">00:05:36.240</a></span> | <span class="t">There's one main</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=340" target="_blank">00:05:40.360</a></span> | <span class="t">Grouping of vectors. Okay, so these three over here now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=345" target="_blank">00:05:45.160</a></span> | <span class="t">Let's just zoom in a little bit and have a look what they are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=350" target="_blank">00:05:50.120</a></span> | <span class="t">so we have text podcasts about cooking and writing a chat with chef who wrote books and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=356" target="_blank">00:05:56.760</a></span> | <span class="t">interview with cookbook author so we can see that they're all about cooking and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=362" target="_blank">00:06:02.640</a></span> | <span class="t">Writing and they've all been grouped together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=365" target="_blank">00:06:05.800</a></span> | <span class="t">now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=367" target="_blank">00:06:07.560</a></span> | <span class="t">that's because our language model has taken these queries and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=371" target="_blank">00:06:11.840</a></span> | <span class="t">Encoded them in such a way that the vector representations for these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=377" target="_blank">00:06:17.240</a></span> | <span class="t">represent the meaning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=380" target="_blank">00:06:20.400</a></span> | <span class="t">Okay, and the meaning of all these although it's not the same is very similar talking about cooking writing books and so on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=388" target="_blank">00:06:28.480</a></span> | <span class="t">And we can see that represented in the proximity of these vectors now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=394" target="_blank">00:06:34.560</a></span> | <span class="t">Let's have a look at something else. That's kind of close but not within that same cluster</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=399" target="_blank">00:06:39.140</a></span> | <span class="t">So over here we have how do I cook great food? Okay, so we're talking about cooking again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=404" target="_blank">00:06:44.980</a></span> | <span class="t">Okay, and then we have this one further over here eat better during Christmas holidays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=411" target="_blank">00:06:51.400</a></span> | <span class="t">So we can kind of see that this one is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=414" target="_blank">00:06:54.120</a></span> | <span class="t">How do I cook great food it's sort of in between like these about cooking and writing and a cookbook and then over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=424" target="_blank">00:07:04.320</a></span> | <span class="t">We have eat better during Christmas holidays. I was talking specifically about food</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=428" target="_blank">00:07:08.760</a></span> | <span class="t">Okay, so this one is cooking and food and it's in the middle of them both and then we have a few more over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=435" target="_blank">00:07:15.280</a></span> | <span class="t">And we have the writing show over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=438" target="_blank">00:07:18.200</a></span> | <span class="t">So it's like a writing podcast or something and then over here one of the more similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=442" target="_blank">00:07:22.960</a></span> | <span class="t">Vectors is how to tell more engaging stories and then also how to keep readers interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=448" target="_blank">00:07:28.640</a></span> | <span class="t">So again talking about writing and then we go up here. We see this by itself superhero film and arts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=454" target="_blank">00:07:34.880</a></span> | <span class="t">It's obviously very different to everything else. We've looked at so this is kind of what I mean by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=461" target="_blank">00:07:41.120</a></span> | <span class="t">representing the meaning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=464" target="_blank">00:07:44.280</a></span> | <span class="t">numerically in a vector space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=466" target="_blank">00:07:46.400</a></span> | <span class="t">Similar things get grouped together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=469" target="_blank">00:07:49.000</a></span> | <span class="t">Dissimilar things are separated now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=472" target="_blank">00:07:52.240</a></span> | <span class="t">All of those vectors have been encoded by a special kind of NLP model called a sentence transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=478" target="_blank">00:07:58.800</a></span> | <span class="t">Now that sentence transformer specially trained to do what we just saw which is group similar things together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=484" target="_blank">00:08:04.800</a></span> | <span class="t">Separate dissimilar things. Once we have those vectors from our sentence transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=490" target="_blank">00:08:10.200</a></span> | <span class="t">We need a way to compare them and that's where the vector search component comes in. So imagine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=496" target="_blank">00:08:16.800</a></span> | <span class="t">Within all those queries that we just saw</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=500" target="_blank">00:08:20.160</a></span> | <span class="t">Imagine we came up with a new query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=503" target="_blank">00:08:23.220</a></span> | <span class="t">convert that query into a vector place it within that vector space and then we would search for the most similar of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=510" target="_blank">00:08:30.220</a></span> | <span class="t">Vectors and we would return those as being the ones that are most similar to your particular query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=514" target="_blank">00:08:34.920</a></span> | <span class="t">now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=516" target="_blank">00:08:36.880</a></span> | <span class="t">NLP and vector search have been around for a long time, but both fields have had very recent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=523" target="_blank">00:08:43.780</a></span> | <span class="t">developments that have really acted as catalysts for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=529" target="_blank">00:08:49.520</a></span> | <span class="t">Performance increases and subsequent adoption of semantic search in NLP</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=535" target="_blank">00:08:55.040</a></span> | <span class="t">we've had the introduction of transformer models and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=538" target="_blank">00:08:58.480</a></span> | <span class="t">in vector search the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=541" target="_blank">00:09:01.720</a></span> | <span class="t">introduction of ever better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=544" target="_blank">00:09:04.320</a></span> | <span class="t">approximate nearest neighbor search algorithms now transformers and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=549" target="_blank">00:09:09.400</a></span> | <span class="t">approximate nearest neighbors have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=552" target="_blank">00:09:12.760</a></span> | <span class="t">Powered the growth of semantic search, but it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=556" target="_blank">00:09:16.160</a></span> | <span class="t">Inherently clear what both of those are. I'm assuming most of you probably have no idea what either of those are if you do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=562" target="_blank">00:09:22.520</a></span> | <span class="t">Then that's great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=563" target="_blank">00:09:23.800</a></span> | <span class="t">But otherwise no problem because we're going to actually go through both of those concepts as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=568" target="_blank">00:09:28.880</a></span> | <span class="t">so starting with transform models transform models are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=572" target="_blank">00:09:32.160</a></span> | <span class="t">Essentially the standard in NLP now they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=577" target="_blank">00:09:37.680</a></span> | <span class="t">Typically consist of two components, which is quite important for us to know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=582" target="_blank">00:09:42.520</a></span> | <span class="t">There's the core of the transformer and then you usually have a head which adapts the transformer for a particular task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=589" target="_blank">00:09:49.880</a></span> | <span class="t">Now there's just one problem. The core of these transform models is huge like they're massive models and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=597" target="_blank">00:09:57.840</a></span> | <span class="t">For most organizations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=601" target="_blank">00:10:01.440</a></span> | <span class="t">It is far too expensive to actually train the core of the model for example with BERT, which is one most popular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=610" target="_blank">00:10:10.840</a></span> | <span class="t">Language models. It's not even a particularly large language model that costs were reported</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=616" target="_blank">00:10:16.480</a></span> | <span class="t">I think two and a half thousand to fifty thousand dollars to train a small one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=620" target="_blank">00:10:20.600</a></span> | <span class="t">And then when you look at larger BERT model that shifts up to eighty thousand to one point six million dollars</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=628" target="_blank">00:10:28.200</a></span> | <span class="t">Which is obviously huge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=630" target="_blank">00:10:30.680</a></span> | <span class="t">now most organizations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=633" target="_blank">00:10:33.320</a></span> | <span class="t">Don't have that kind of money lying around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=635" target="_blank">00:10:35.960</a></span> | <span class="t">So, how do we you know, how a transform is useful for us if we can't afford to train them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=640" target="_blank">00:10:40.800</a></span> | <span class="t">well the way that we typically go about using transform models is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=646" target="_blank">00:10:46.120</a></span> | <span class="t">one the core of a transform model is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=650" target="_blank">00:10:50.320</a></span> | <span class="t">Trained by the likes of Microsoft or Google it cost them a lot of money to train it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=656" target="_blank">00:10:56.060</a></span> | <span class="t">But they have the money to do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=660" target="_blank">00:11:00.600</a></span> | <span class="t">To the model is made publicly available by Microsoft or Google</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=666" target="_blank">00:11:06.440</a></span> | <span class="t">three other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=668" target="_blank">00:11:08.560</a></span> | <span class="t">Organizations take this core this transformer core and they add different heads to it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=675" target="_blank">00:11:15.140</a></span> | <span class="t">So these heads are like a final few layers at the end model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=679" target="_blank">00:11:19.720</a></span> | <span class="t">That adapt it for a particular task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=682" target="_blank">00:11:22.560</a></span> | <span class="t">Now using that so extended model with the head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=688" target="_blank">00:11:28.980</a></span> | <span class="t">the model can be fine-tuned using a lot less computing power, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=694" target="_blank">00:11:34.700</a></span> | <span class="t">brings it within the range of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=697" target="_blank">00:11:37.440</a></span> | <span class="t">feasibility for other more normal organizations and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=701" target="_blank">00:11:41.880</a></span> | <span class="t">for once you've fine-tuned your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=704" target="_blank">00:11:44.960</a></span> | <span class="t">Extended transform model you are able to go ahead and actually apply that to your specific task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=711" target="_blank">00:11:51.840</a></span> | <span class="t">So in the case of our example podcast search, we might want to take a BERT model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=717" target="_blank">00:11:57.240</a></span> | <span class="t">So like BERT based on case, which has been pre-trained by Google</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=721" target="_blank">00:12:01.300</a></span> | <span class="t">We would take that and then we would add a what's called a pooling head onto the end of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=727" target="_blank">00:12:07.320</a></span> | <span class="t">That converts it into what we call sentence transformers, which will take an input like a normal transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=733" target="_blank">00:12:13.700</a></span> | <span class="t">so some sort of text input the normal transformer will output a set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=739" target="_blank">00:12:19.100</a></span> | <span class="t">token level embeddings now, we can't use token level embeddings when we're comparing sentences because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=746" target="_blank">00:12:26.540</a></span> | <span class="t">One token or one sentence for BERT can contain up to 512 tokens. So we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=752" target="_blank">00:12:32.860</a></span> | <span class="t">Really need a way to actually compress that down into one single vector to represent the full set of inputs that were given to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=760" target="_blank">00:12:40.560</a></span> | <span class="t">Transform model. So that's where we have that pooling layer that pooling layer takes all of those token level embeddings and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=767" target="_blank">00:12:47.740</a></span> | <span class="t">Converts them into a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=770" target="_blank">00:12:50.260</a></span> | <span class="t">embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=771" target="_blank">00:12:51.460</a></span> | <span class="t">Which is our sentence vector or sentence embedding?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=775" target="_blank">00:12:55.420</a></span> | <span class="t">Now there are different types of pooling layers and we'll talk about one later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=780" target="_blank">00:13:00.180</a></span> | <span class="t">but they all consume the same input and they will output that single embedding and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=786" target="_blank">00:13:06.300</a></span> | <span class="t">It is that sort of model that we refer to as a sentence transformer that sentence embedding at the end is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=794" target="_blank">00:13:14.400</a></span> | <span class="t">What we referred to earlier as a dense vector. Okay, the numerical representation of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=801" target="_blank">00:13:21.780</a></span> | <span class="t">Whatever we fed into that transform model. So given that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=805" target="_blank">00:13:25.820</a></span> | <span class="t">Dense vector we move on to the next step, which is a vector search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=811" target="_blank">00:13:31.760</a></span> | <span class="t">now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=814" target="_blank">00:13:34.380</a></span> | <span class="t">approximate nearest neighbors search allows us to search more efficiently through a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=820" target="_blank">00:13:40.140</a></span> | <span class="t">Vectors because in many use cases for example with Spotify how many episodes do they have on?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=828" target="_blank">00:13:48.900</a></span> | <span class="t">That I imagine there are there are many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=831" target="_blank">00:13:51.460</a></span> | <span class="t">okay, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=834" target="_blank">00:13:54.060</a></span> | <span class="t">It's very hard if you or it takes a very long time if you compare your query to all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=841" target="_blank">00:14:01.480</a></span> | <span class="t">existing vector embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=844" target="_blank">00:14:04.100</a></span> | <span class="t">It's very hard to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=846" target="_blank">00:14:06.740</a></span> | <span class="t">To do that quickly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=848" target="_blank">00:14:08.740</a></span> | <span class="t">Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=849" target="_blank">00:14:09.240</a></span> | <span class="t">In fact, it's impossible if you're using a typical K nearest neighbor search or otherwise known as exhaustive search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=855" target="_blank">00:14:15.500</a></span> | <span class="t">because you need to compare everything and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=858" target="_blank">00:14:18.620</a></span> | <span class="t">if you have millions of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=860" target="_blank">00:14:20.620</a></span> | <span class="t">items to compare there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=863" target="_blank">00:14:23.100</a></span> | <span class="t">No matter what hardware you run. It's gonna take a long time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=866" target="_blank">00:14:26.500</a></span> | <span class="t">So approximate search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=870" target="_blank">00:14:30.760</a></span> | <span class="t">Allows us to speed that up by literally approximating the answer now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=877" target="_blank">00:14:37.380</a></span> | <span class="t">approximate nearest neighbor algorithms are very good because they allow you to approximate the answer with a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=886" target="_blank">00:14:46.460</a></span> | <span class="t">super high degree of accuracy, it's like 99% accuracy and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=890" target="_blank">00:14:50.860</a></span> | <span class="t">Make your search incredibly fast. You're talking sort of sub-second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=896" target="_blank">00:14:56.540</a></span> | <span class="t">Sub half a second you're you're in the 10 millisecond range in a lot of cases</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=901" target="_blank">00:15:01.840</a></span> | <span class="t">So that's really useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=906" target="_blank">00:15:06.020</a></span> | <span class="t">But it's also worth noting that there is between these different algorithms. There's usually a trade-off between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=912" target="_blank">00:15:12.860</a></span> | <span class="t">Speed like your search times and the accuracy so you can have an even faster search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=920" target="_blank">00:15:20.040</a></span> | <span class="t">But then your accuracy will tend to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=922" target="_blank">00:15:22.940</a></span> | <span class="t">Not quite as good. So you'll be returning maybe 70% accuracy rather than 99% accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=929" target="_blank">00:15:29.000</a></span> | <span class="t">but there's always sort of a trade-off between the two, but generally the algorithms now very good and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=936" target="_blank">00:15:36.220</a></span> | <span class="t">You can get incredible accuracy and incredible speed as well. So you we've merged those two together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=942" target="_blank">00:15:42.220</a></span> | <span class="t">We have our sentence transformers. We have our approximate search and we now have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=947" target="_blank">00:15:47.700</a></span> | <span class="t">tool set that is capable of performing semantic search at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=953" target="_blank">00:15:53.020</a></span> | <span class="t">Incredibly large scales. So what I want to do now is look specifically at how Spotify did it to build this kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=962" target="_blank">00:16:02.020</a></span> | <span class="t">semantic search tool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=964" target="_blank">00:16:04.220</a></span> | <span class="t">Spotify first needed a model that can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=968" target="_blank">00:16:08.420</a></span> | <span class="t">encode queries and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=972" target="_blank">00:16:12.100</a></span> | <span class="t">Episode metadata or descriptions into the same sort of vector space now there are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=979" target="_blank">00:16:19.420</a></span> | <span class="t">existing transform models or sentence transform models that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=984" target="_blank">00:16:24.660</a></span> | <span class="t">Can do a lot of things for example expert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=988" target="_blank">00:16:28.220</a></span> | <span class="t">But Spotify found a few issues with those specifically for expert. They needed a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=995" target="_blank">00:16:35.860</a></span> | <span class="t">that was capable of supporting multi-lingual queries because obviously Spotify has a lot of content from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1003" target="_blank">00:16:43.740</a></span> | <span class="t">every place in the world</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1006" target="_blank">00:16:46.780</a></span> | <span class="t">so they couldn't use expert because expert has been trained on English only data and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1011" target="_blank">00:16:51.820</a></span> | <span class="t">to experts performance on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1015" target="_blank">00:16:55.500</a></span> | <span class="t">new domains, so for example podcast is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1019" target="_blank">00:16:59.300</a></span> | <span class="t">Not great without further fine-tuning. So the out-of-the-box</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1025" target="_blank">00:17:05.340</a></span> | <span class="t">Pre-trained fine-tuned sentence Bert model could not be used. It wasn't didn't satisfy. What's but if I need it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1032" target="_blank">00:17:12.860</a></span> | <span class="t">With that in mind they decided to start with the pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1037" target="_blank">00:17:17.660</a></span> | <span class="t">universal sentence encoder model this allowed them to cover the multi-lingual issue and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1044" target="_blank">00:17:24.580</a></span> | <span class="t">Yes, USC the USC model still needs to be fine-tuned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1050" target="_blank">00:17:30.060</a></span> | <span class="t">But they were going to need to do that. Anyway, so it's not really an issue</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1055" target="_blank">00:17:35.340</a></span> | <span class="t">So, let's have a look at what sort of data they use to actually fine-tune in their model so to fine-tune their model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1061" target="_blank">00:17:41.900</a></span> | <span class="t">Spotify needs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1064" target="_blank">00:17:44.100</a></span> | <span class="t">query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1066" target="_blank">00:17:46.300</a></span> | <span class="t">Episode pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1069" target="_blank">00:17:49.220</a></span> | <span class="t">Now, of course Spotify has a ton of search logs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1077" target="_blank">00:17:57.540</a></span> | <span class="t">Over here, so they took these search logs and they use them to create two different data sources</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1083" target="_blank">00:18:03.740</a></span> | <span class="t">The first was simply okay if there is a successful search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1087" target="_blank">00:18:07.900</a></span> | <span class="t">What was a query from that search and what was the episode? Okay, and that created this little data source that you see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1095" target="_blank">00:18:15.980</a></span> | <span class="t">the other one's a bit more interesting, so whenever they found that there was a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1102" target="_blank">00:18:22.300</a></span> | <span class="t">Successful search that was straightaway followed by a successful search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1106" target="_blank">00:18:26.580</a></span> | <span class="t">They looked at what the query for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1109" target="_blank">00:18:29.040</a></span> | <span class="t">Unsuccessful search was because the logic behind that being if you're typing something you're searching and it doesn't work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1116" target="_blank">00:18:36.360</a></span> | <span class="t">You probably use a more sort of natural language or a more natural feeling query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1122" target="_blank">00:18:42.420</a></span> | <span class="t">But then it doesn't work so then you change it to be a bit more robotic and trying to fit what you would expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1131" target="_blank">00:18:51.820</a></span> | <span class="t">Spotify's search to come up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1133" target="_blank">00:18:53.820</a></span> | <span class="t">for the correct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1136" target="_blank">00:18:56.340</a></span> | <span class="t">episode or podcast episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1138" target="_blank">00:18:58.060</a></span> | <span class="t">so what they did is they took that unsuccessful search query and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1142" target="_blank">00:19:02.700</a></span> | <span class="t">Episode that they the user found after their successful search and put them together to create this little data source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1150" target="_blank">00:19:10.900</a></span> | <span class="t">So we have two data sources now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1153" target="_blank">00:19:13.860</a></span> | <span class="t">Use dotted lines here because we can't replicate that. We don't have Spotify's past search logs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1160" target="_blank">00:19:20.260</a></span> | <span class="t">So we will just ignore that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1163" target="_blank">00:19:23.420</a></span> | <span class="t">But we'll be aware that the way that they would be used would be exactly the same as this third</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1170" target="_blank">00:19:30.740</a></span> | <span class="t">Data source over here, which we are going to replicate now that third data source is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1176" target="_blank">00:19:36.040</a></span> | <span class="t">Taking podcast episodes. So it's a little diamond over here. We're transforming them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1181" target="_blank">00:19:41.700</a></span> | <span class="t">so what I mean by transforming is taking it like the podcast show title and description and also the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1189" target="_blank">00:19:49.820</a></span> | <span class="t">specific episode title and description and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1191" target="_blank">00:19:51.820</a></span> | <span class="t">Concatenating all that together to create a sort of episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1196" target="_blank">00:19:56.340</a></span> | <span class="t">Description from these multiple things and then we use those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1202" target="_blank">00:20:02.140</a></span> | <span class="t">episodes that episode data with a query generation set now query generation super interesting and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1209" target="_blank">00:20:09.740</a></span> | <span class="t">what we're going to do there is actually use a query generation model to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1214" target="_blank">00:20:14.860</a></span> | <span class="t">Create synthetic queries for our episodes and that will create this third data source over here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1222" target="_blank">00:20:22.360</a></span> | <span class="t">okay, which is synthetic queries to episode pairs and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1226" target="_blank">00:20:26.820</a></span> | <span class="t">We'll be using that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1228" target="_blank">00:20:28.740</a></span> | <span class="t">so we'll split that into sort of a training set and we'll use that to fine-tune a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1234" target="_blank">00:20:34.500</a></span> | <span class="t">model in the same way that we would have used those other the other two data sources and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1240" target="_blank">00:20:40.020</a></span> | <span class="t">We'll be fine-tuning a pre-trained universal sentence encoder model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1244" target="_blank">00:20:44.660</a></span> | <span class="t">So we use all that and in the end what we'll have is this podcast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1250" target="_blank">00:20:50.060</a></span> | <span class="t">Universal sentence encoder model which we can then use to encode both our queries and our episodes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1257" target="_blank">00:20:57.740</a></span> | <span class="t">So there's one other so we have our podcast episodes over here place them into this transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1264" target="_blank">00:21:04.140</a></span> | <span class="t">We've created those podcast episode descriptions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1267" target="_blank">00:21:07.260</a></span> | <span class="t">This other data source that you see over here is a manually created data source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1272" target="_blank">00:21:12.340</a></span> | <span class="t">Spotify did this and they use it purely for evaluating the model didn't use this in training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1277" target="_blank">00:21:17.600</a></span> | <span class="t">So they just manually curated a set of queries for particular podcast episodes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1282" target="_blank">00:21:22.700</a></span> | <span class="t">We will do the same. We just do I think it's like seven queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1287" target="_blank">00:21:27.000</a></span> | <span class="t">And see how that works and use that to actually evaluate our models now once we've done all of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1292" target="_blank">00:21:32.900</a></span> | <span class="t">We come to the evaluation and also the actual, you know, how you use this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1297" target="_blank">00:21:37.860</a></span> | <span class="t">you would take your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1300" target="_blank">00:21:40.140</a></span> | <span class="t">Podcast model you bring it over here into the middle here. And then you're gonna take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1307" target="_blank">00:21:47.000</a></span> | <span class="t">evaluation data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1309" target="_blank">00:21:49.260</a></span> | <span class="t">From your query generated data bring it into here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1312" target="_blank">00:21:52.420</a></span> | <span class="t">You're going to encode everything and place it into a vector search engine in this case. We're using pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1320" target="_blank">00:22:00.140</a></span> | <span class="t">this will allow us to store all of our episodes as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1323" target="_blank">00:22:03.600</a></span> | <span class="t">Embeddings and then we'll be able to query and see if we are returning the correct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1328" target="_blank">00:22:08.880</a></span> | <span class="t">Episode based on our synthetic queries to episode pairs and we'll also do the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1334" target="_blank">00:22:14.200</a></span> | <span class="t">Using these manually curated query episode pairs and then this is exactly what you would do in production as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1342" target="_blank">00:22:22.340</a></span> | <span class="t">So after you've evaluated you take all of your episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1345" target="_blank">00:22:25.340</a></span> | <span class="t">embeddings put them in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1348" target="_blank">00:22:28.860</a></span> | <span class="t">Vector database of the pinecone at the bottom there and then you would let your users query your query would go into your podcast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1356" target="_blank">00:22:36.740</a></span> | <span class="t">Sentence transform model and then it would be passed into your vector database, which would identify the most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1364" target="_blank">00:22:44.700</a></span> | <span class="t">semantically similar or most relevant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1367" target="_blank">00:22:47.380</a></span> | <span class="t">episode vectors for you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1370" target="_blank">00:22:50.020</a></span> | <span class="t">Okay, so that's a very high level. That's how it all works if it's confusing no problem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1375" target="_blank">00:22:55.980</a></span> | <span class="t">So we're going to work through all of this. So now we'll move on to the actual implementation of all of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1380" target="_blank">00:23:00.900</a></span> | <span class="t">Now what we first one is a data set that is going to as closely as possible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1386" target="_blank">00:23:06.200</a></span> | <span class="t">Replicate the episode data that Spotify are using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1391" target="_blank">00:23:11.340</a></span> | <span class="t">So we'll need Kaggle for this so you can download or install the Kaggle API using pip install Kaggle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1398" target="_blank">00:23:18.580</a></span> | <span class="t">And then you'll need an account. So you need to sign up on kaggle.com and you can get an API key</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1404" target="_blank">00:23:24.220</a></span> | <span class="t">So you just come over here you click on on top, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1407" target="_blank">00:23:27.440</a></span> | <span class="t">You'll see your profile you go to I think account and you can come down and you have API here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1414" target="_blank">00:23:34.780</a></span> | <span class="t">So you'll be able to get like create a new API token and it will download</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1419" target="_blank">00:23:39.340</a></span> | <span class="t">at kaggle.json file for you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1422" target="_blank">00:23:42.360</a></span> | <span class="t">And then what you do with that is if you try to import kaggle, so you run this import kaggle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1429" target="_blank">00:23:49.060</a></span> | <span class="t">It would say okay, you are not authenticated because you don't have kaggle.json in this directory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1435" target="_blank">00:23:55.020</a></span> | <span class="t">So all you do is put your kaggle.json in the directory that is specified</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1439" target="_blank">00:23:59.380</a></span> | <span class="t">Once you've done that you should be able to import kaggle without any errors and we'll move on to the data download</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1446" target="_blank">00:24:06.700</a></span> | <span class="t">So we just authenticate our API. I'm not going to go too</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1450" target="_blank">00:24:10.020</a></span> | <span class="t">Into depth here. There will be a link to this notebook so you can read through everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1457" target="_blank">00:24:17.260</a></span> | <span class="t">As you want and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1459" target="_blank">00:24:19.260</a></span> | <span class="t">All we're going to do is download these two data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1462" target="_blank">00:24:22.360</a></span> | <span class="t">Okay, so if I let me copy this and I'll show you on kaggle this data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1469" target="_blank">00:24:29.160</a></span> | <span class="t">Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1469" target="_blank">00:24:29.760</a></span> | <span class="t">So this is all podcast episodes published in December 2017 from this company called listen notes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1475" target="_blank">00:24:35.220</a></span> | <span class="t">Which is a podcast search engine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1477" target="_blank">00:24:37.660</a></span> | <span class="t">so we download these podcasts and episodes data and we extract them because they'll be in zip files and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1484" target="_blank">00:24:44.340</a></span> | <span class="t">we can see okay, this podcast is actually the details of podcast show itself and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1489" target="_blank">00:24:49.660</a></span> | <span class="t">episodes is the details of this, you know individual episodes and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1493" target="_blank">00:24:53.780</a></span> | <span class="t">What Spotify did was concatenate the title and description from both of those and use that to create a sort of a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1503" target="_blank">00:25:03.140</a></span> | <span class="t">episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1504" target="_blank">00:25:04.820</a></span> | <span class="t">Description that we then encode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1506" target="_blank">00:25:06.920</a></span> | <span class="t">So we do the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1509" target="_blank">00:25:09.500</a></span> | <span class="t">We first need to merge those two data frames</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1512" target="_blank">00:25:12.300</a></span> | <span class="t">So we're doing that based on the unique podcast ID and we you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1517" target="_blank">00:25:17.540</a></span> | <span class="t">Get this sort of data frame with everything we need inside it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1521" target="_blank">00:25:21.460</a></span> | <span class="t">I'm just doing a little bit data cleaning here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1526" target="_blank">00:25:26.460</a></span> | <span class="t">So stripping any white space from the features that we care about so the title EP description EP title</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1533" target="_blank">00:25:33.580</a></span> | <span class="t">podcast and description podcast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1535" target="_blank">00:25:35.940</a></span> | <span class="t">EP here is just episode and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1539" target="_blank">00:25:39.380</a></span> | <span class="t">Then I'm also just removing you know where we have any new values in any of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1544" target="_blank">00:25:44.900</a></span> | <span class="t">Columns or features just removing them because we have a lot here. Anyway, we don't even use all of these so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1551" target="_blank">00:25:51.740</a></span> | <span class="t">It's not a problem. And then I'm concatenating everything. I'm just putting a full stop in between each one of them and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1558" target="_blank">00:25:58.820</a></span> | <span class="t">Yeah, and then converting that into a list. So we just have like a list of these episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1568" target="_blank">00:26:08.140</a></span> | <span class="t">Texts now. Okay, you see they do vary a lot. It's not the cleanest data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1572" target="_blank">00:26:12.660</a></span> | <span class="t">But it's usable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1575" target="_blank">00:26:15.660</a></span> | <span class="t">We also shuffle here as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1578" target="_blank">00:26:18.920</a></span> | <span class="t">When you're shuffling just bear in mind your shuffle is going to randomize the order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1584" target="_blank">00:26:24.540</a></span> | <span class="t">So later on when we have these curated queries, they won't necessarily be in the test set for you as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1593" target="_blank">00:26:33.580</a></span> | <span class="t">So you may need to just make up some some new some new queries and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1598" target="_blank">00:26:38.260</a></span> | <span class="t">At that point we have our episodes data and we need to move on to query generation because we need you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1605" target="_blank">00:26:45.880</a></span> | <span class="t">Query episode pairs. So spot if I use a fine or they fine-tuned a bar model on ms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1612" target="_blank">00:26:52.580</a></span> | <span class="t">Marco now, I'm I'm not going to find you in a model because there are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1617" target="_blank">00:26:57.480</a></span> | <span class="t">Honestly, so many query generation models that have been fine-tuned on ms. Marco already including bar models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1625" target="_blank">00:27:05.180</a></span> | <span class="t">so I don't think there's really any point in us fine-tuning it because we're just replicating what we can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1631" target="_blank">00:27:11.160</a></span> | <span class="t">pull from hugging face</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1633" target="_blank">00:27:13.760</a></span> | <span class="t">Hope I tested a few different bar and t5 query generation models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1638" target="_blank">00:27:18.960</a></span> | <span class="t">And I found this one to be the best for this particular use case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1642" target="_blank">00:27:22.460</a></span> | <span class="t">the queries were just more consistently like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1647" target="_blank">00:27:27.620</a></span> | <span class="t">Sensical like they actually made sense and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1649" target="_blank">00:27:29.940</a></span> | <span class="t">It also supports multi or it has some multi lingual support</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1655" target="_blank">00:27:35.420</a></span> | <span class="t">I'm not sure how much but it does manage to actually produce queries that make sense in different languages. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1662" target="_blank">00:27:42.640</a></span> | <span class="t">Definitely pretty useful and aligns pretty nicely with what Spotify wanted as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1668" target="_blank">00:27:48.740</a></span> | <span class="t">And then what I'm doing is so I'm using the transformers lyrics is hugging face transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1674" target="_blank">00:27:54.980</a></span> | <span class="t">You can pip install transformers if you need to I'm just initializing the tokenizer in the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1681" target="_blank">00:28:01.340</a></span> | <span class="t">Okay, so this is going to handle our query generation on the end here. You see I put CUDA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1688" target="_blank">00:28:08.340</a></span> | <span class="t">That's because I have a CUDA enabled GPU which will make things a lot faster when we're doing this because this can take a long time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1694" target="_blank">00:28:14.820</a></span> | <span class="t">And that's why I'm just taking the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1698" target="_blank">00:28:18.020</a></span> | <span class="t">100,000 episodes here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1701" target="_blank">00:28:21.580</a></span> | <span class="t">So we move on to the query generation loop. It's fairly long. Sorry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1707" target="_blank">00:28:27.420</a></span> | <span class="t">This isn't like the quickest way you can do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1709" target="_blank">00:28:29.740</a></span> | <span class="t">so larger batch size means faster processing, but this is limited by the size of your GPU and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1717" target="_blank">00:28:37.860</a></span> | <span class="t">Then number of queries. I'm generating for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1720" target="_blank">00:28:40.860</a></span> | <span class="t">each episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1723" target="_blank">00:28:43.820</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1726" target="_blank">00:28:46.460</a></span> | <span class="t">Spotify didn't specify what they use for number of queries here, but I'm using three because that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1732" target="_blank">00:28:52.860</a></span> | <span class="t">Inline with the approach shape taken by these other query generation techniques Gen Q and GPL</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1739" target="_blank">00:28:59.900</a></span> | <span class="t">So I'm gonna stick with that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1743" target="_blank">00:29:03.100</a></span> | <span class="t">Then we're just going through I'm encoding everything in batches. So we're just tokenizing everything and then we're generating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1748" target="_blank">00:29:08.900</a></span> | <span class="t">three queries per episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1751" target="_blank">00:29:11.660</a></span> | <span class="t">decoding those queries back to human readable text because this just outputs a load of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1757" target="_blank">00:29:17.100</a></span> | <span class="t">token IDs numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1759" target="_blank">00:29:19.100</a></span> | <span class="t">Decoding about text and looping through and putting those or all those together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1765" target="_blank">00:29:25.420</a></span> | <span class="t">So the the query and episode pairs and placing those together synthetic queries and episode pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1770" target="_blank">00:29:30.980</a></span> | <span class="t">Okay, and then we we put all those in this pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1775" target="_blank">00:29:35.020</a></span> | <span class="t">list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1777" target="_blank">00:29:37.620</a></span> | <span class="t">Okay, and we can see a few here. So we have like a query and then we have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1783" target="_blank">00:29:43.540</a></span> | <span class="t">episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1784" target="_blank">00:29:44.780</a></span> | <span class="t">No query episode and so on. You can also see so here we have the multilingual support as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1790" target="_blank">00:29:50.860</a></span> | <span class="t">She's very cool. And also again, yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1794" target="_blank">00:29:54.220</a></span> | <span class="t">So we now have a data source so we can use of fine-tuning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1798" target="_blank">00:29:58.860</a></span> | <span class="t">the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1800" target="_blank">00:30:00.580</a></span> | <span class="t">model the spot if I talk about this in in their article, which is is here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1805" target="_blank">00:30:05.620</a></span> | <span class="t">They mention that they tried okay here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1810" target="_blank">00:30:10.620</a></span> | <span class="t">So they tried Bert's but as I said, they they decided they didn't really like it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1818" target="_blank">00:30:18.220</a></span> | <span class="t">So, you know, yeah, we're not using it for these multiple reasons. I mentioned before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1823" target="_blank">00:30:23.780</a></span> | <span class="t">So what they did is use this universal sentence encoder model and we're going to do something similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1831" target="_blank">00:30:31.300</a></span> | <span class="t">but what I will note here is that they use TensorFlow hub and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1836" target="_blank">00:30:36.700</a></span> | <span class="t">We can use TensorFlow hub, but it means we can be stuck with TensorFlow and it makes our lives harder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1843" target="_blank">00:30:43.420</a></span> | <span class="t">rather than using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1845" target="_blank">00:30:45.900</a></span> | <span class="t">hugging face and Pytorch and the sentence transformers library, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1850" target="_blank">00:30:50.460</a></span> | <span class="t">rather than using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1853" target="_blank">00:30:53.380</a></span> | <span class="t">Universal sentence encoder model which we can't get from the sentence transformers library as a pre-trained model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1860" target="_blank">00:31:00.340</a></span> | <span class="t">We are going to use a distilled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1862" target="_blank">00:31:02.940</a></span> | <span class="t">universal sentence encoder model which is literally like a smaller version of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1867" target="_blank">00:31:07.100</a></span> | <span class="t">USC so we'll come down here and we're using this one here. So there's still USC based multilingual case, okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1875" target="_blank">00:31:15.300</a></span> | <span class="t">So it's good. It's multilingual and it's still pretty much the same model as what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1881" target="_blank">00:31:21.340</a></span> | <span class="t">Spotify used so we just have the model details here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1885" target="_blank">00:31:25.300</a></span> | <span class="t">so the maximum number of tokens that will accept 128 and it will output a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1891" target="_blank">00:31:31.820</a></span> | <span class="t">168 dimensional dense vector. So that's a you know, the meaningful vector that we spoke about earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1898" target="_blank">00:31:38.620</a></span> | <span class="t">Now when we're fine-tuning with the sentence transformers library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1904" target="_blank">00:31:44.180</a></span> | <span class="t">And you know, by the way, if you do need to install that you can just go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1907" target="_blank">00:31:47.880</a></span> | <span class="t">pistol</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1910" target="_blank">00:31:50.620</a></span> | <span class="t">Sentence transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1912" target="_blank">00:31:52.900</a></span> | <span class="t">Like this, okay, obviously in your in your terminal or using the estimation market to start there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1920" target="_blank">00:32:00.540</a></span> | <span class="t">So when we're using a sentence transformers library and we're fine-tuning a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1924" target="_blank">00:32:04.860</a></span> | <span class="t">We need to reformat our data our input data. So our pairs into a list of input example objects</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1932" target="_blank">00:32:12.660</a></span> | <span class="t">now these in this input example object the format for that varies depending on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1940" target="_blank">00:32:20.260</a></span> | <span class="t">What task you're actually fine-tuning with now?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1943" target="_blank">00:32:23.880</a></span> | <span class="t">we're using a ranking task for fine-tuning or optimizing our model and that means that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1950" target="_blank">00:32:30.380</a></span> | <span class="t">Only need the the query in the episode. Okay, so all we do in that case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1957" target="_blank">00:32:37.580</a></span> | <span class="t">I'm here as well. I'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1959" target="_blank">00:32:39.580</a></span> | <span class="t">Splitting so we have an evaluation set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1963" target="_blank">00:32:43.140</a></span> | <span class="t">Down here and a test set as well for later on when we're evaluating things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1968" target="_blank">00:32:48.180</a></span> | <span class="t">So all we need in our input example, which we have imported from sentence transformers is the query an episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1976" target="_blank">00:32:56.860</a></span> | <span class="t">Literally it so it's just a list of these input examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1979" target="_blank">00:32:59.980</a></span> | <span class="t">With query an episode in there and you see the sample size that we have there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1985" target="_blank">00:33:05.820</a></span> | <span class="t">so let's continue and yeah, so as I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1989" target="_blank">00:33:09.860</a></span> | <span class="t">As I mentioned we're going to be using a ranking optimization function now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1994" target="_blank">00:33:14.640</a></span> | <span class="t">What does that look like given a specific query light on we use earlier?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=1999" target="_blank">00:33:19.180</a></span> | <span class="t">So eat better during Christmas holidays or Xmas holidays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2002" target="_blank">00:33:22.140</a></span> | <span class="t">our model is going to be given a set of episodes and it's going to need to rank the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2009" target="_blank">00:33:29.100</a></span> | <span class="t">the true episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2011" target="_blank">00:33:31.700</a></span> | <span class="t">for that particular query as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2014" target="_blank">00:33:34.020</a></span> | <span class="t">Number one in terms of scores. Okay, so the true sort of pair for this query is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2020" target="_blank">00:33:40.660</a></span> | <span class="t">This one here and it will have to be able to identify that all these other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2025" target="_blank">00:33:45.500</a></span> | <span class="t">Episodes are not real pairs or an less semantically similar to this particular query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2032" target="_blank">00:33:52.100</a></span> | <span class="t">so the model learns to give higher scores to more semantically similar episodes for a particular query and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2037" target="_blank">00:33:57.660</a></span> | <span class="t">Lowest scores to the more dissimilar episodes for a particular query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2042" target="_blank">00:34:02.340</a></span> | <span class="t">And that's why we don't need like a label in this case. We don't actually need a particular similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2050" target="_blank">00:34:10.140</a></span> | <span class="t">Label or anything when training our model, which is a really nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2054" target="_blank">00:34:14.540</a></span> | <span class="t">Sort of benefit of using ranking functions. You literally just need pairs of data and you can train with that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2061" target="_blank">00:34:21.340</a></span> | <span class="t">Which is is pretty cool now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2063" target="_blank">00:34:23.340</a></span> | <span class="t">the way the model actually needs to like compare the queries and episodes is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2069" target="_blank">00:34:29.900</a></span> | <span class="t">by taking query converting into a query vector taking the episode converting that into a episode vector and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2078" target="_blank">00:34:38.660</a></span> | <span class="t">placing them in a in a vector space and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2083" target="_blank">00:34:43.380</a></span> | <span class="t">pairing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2085" target="_blank">00:34:45.020</a></span> | <span class="t">Similarity between them now the way that we are going to be calculating similarity in this case is using cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2092" target="_blank">00:34:52.340</a></span> | <span class="t">So we're essentially calculating the similarity or the angle between vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2097" target="_blank">00:34:57.980</a></span> | <span class="t">So this is this in the middle here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2100" target="_blank">00:35:00.580</a></span> | <span class="t">That is our query vector and this little cone is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2104" target="_blank">00:35:04.740</a></span> | <span class="t">Representing the angle in a 3d space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2108" target="_blank">00:35:08.220</a></span> | <span class="t">around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2110" target="_blank">00:35:10.300</a></span> | <span class="t">that a query vector these two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2113" target="_blank">00:35:13.540</a></span> | <span class="t">These two episode vectors here or episode embeddings are the two most similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2119" target="_blank">00:35:19.420</a></span> | <span class="t">So we've got top K equals 2 over here. That's because we're trying to return the two most similar and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2125" target="_blank">00:35:25.460</a></span> | <span class="t">These other vectors like this one for example in terms of actual distance. This one might actually be closer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2132" target="_blank">00:35:32.580</a></span> | <span class="t">Than this one, but in terms of angular distance, it's further away</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2137" target="_blank">00:35:37.940</a></span> | <span class="t">So that's why we have these two embeddings being selected rather than you know, any of these other ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2144" target="_blank">00:35:44.660</a></span> | <span class="t">So the model needs to create these vectors and it needs to learn how to put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2150" target="_blank">00:35:50.140</a></span> | <span class="t">similar meaning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2152" target="_blank">00:35:52.460</a></span> | <span class="t">querying episodes in a similar vector space and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2155" target="_blank">00:35:55.020</a></span> | <span class="t">dissimilar querying episodes in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2157" target="_blank">00:35:57.620</a></span> | <span class="t">As far apart as possible now another thing that we need to consider here is because we're using a ranking function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2165" target="_blank">00:36:05.460</a></span> | <span class="t">Which is going to work by taking query and then a batch of episodes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2169" target="_blank">00:36:09.180</a></span> | <span class="t">We need to make sure that within that batch of episodes. We don't have any duplicates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2173" target="_blank">00:36:13.100</a></span> | <span class="t">because imagine so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2175" target="_blank">00:36:15.540</a></span> | <span class="t">We're going to optimize optimizing this model. We've got a query in episode pair and we're saying okay for this query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2180" target="_blank">00:36:20.740</a></span> | <span class="t">This episode is the most similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2183" target="_blank">00:36:23.660</a></span> | <span class="t">We're going to optimizing the model based on that if we have the exact same episode further down in that list and we're telling the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2192" target="_blank">00:36:32.220</a></span> | <span class="t">Actually, okay. These two episodes are exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2195" target="_blank">00:36:35.100</a></span> | <span class="t">But one is right and one is not our models just going to be confused it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2199" target="_blank">00:36:39.360</a></span> | <span class="t">That doesn't make sense. It can't do that. So we have to make sure that we don't have duplicates in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2205" target="_blank">00:36:45.340</a></span> | <span class="t">The in any of the training batches now, it's probably not a problem if you have the odd one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2210" target="_blank">00:36:50.740</a></span> | <span class="t">But we don't want any we just want to be you know certain there's nothing in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2214" target="_blank">00:36:54.620</a></span> | <span class="t">So we can actually do that using the sentence transformers. No duplicates data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2220" target="_blank">00:37:00.220</a></span> | <span class="t">Which will handle removing any duplicates from from batches for us as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2226" target="_blank">00:37:06.220</a></span> | <span class="t">We use a batch size 64. So if we consider the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2231" target="_blank">00:37:11.400</a></span> | <span class="t">Optimization function here wait taking query and then we're taking a batch of episodes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2236" target="_blank">00:37:16.300</a></span> | <span class="t">Imagine we have a batch size of three right or even two. We have a batch size of two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2242" target="_blank">00:37:22.580</a></span> | <span class="t">We're just comparing our one query against two episodes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2246" target="_blank">00:37:26.100</a></span> | <span class="t">Our model can get get even if it's just randomly guessing it can get the right answer around 50% of the time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2253" target="_blank">00:37:33.340</a></span> | <span class="t">With such a small batch size. We increase that to a hundred then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2258" target="_blank">00:37:38.220</a></span> | <span class="t">The model is going to perform a lot more poorly randomly guessing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2262" target="_blank">00:37:42.540</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2264" target="_blank">00:37:44.300</a></span> | <span class="t">the consequence of of that is that using a larger batch size for this particular training method is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2273" target="_blank">00:37:53.900</a></span> | <span class="t">going to typically result in you having a better performing model because it makes the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2280" target="_blank">00:38:00.060</a></span> | <span class="t">The task of ranking harder for the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2283" target="_blank">00:38:03.540</a></span> | <span class="t">So your model must get better in order to actually accurately rank everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2288" target="_blank">00:38:08.300</a></span> | <span class="t">So we increased about size as much as our hardware will allow us to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2293" target="_blank">00:38:13.980</a></span> | <span class="t">Now after that we can initialize the loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2298" target="_blank">00:38:18.480</a></span> | <span class="t">This is where the ranking optimization comes in. So in sentence transformers, the ranking function is this multiple natives ranking loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2306" target="_blank">00:38:26.520</a></span> | <span class="t">Okay, so we initialize that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2308" target="_blank">00:38:28.640</a></span> | <span class="t">There is just one more step before we actually move on to fine-tuning. So if we have a look over here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2315" target="_blank">00:38:35.580</a></span> | <span class="t">We go down to offline offline evaluation in order to evaluate a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2321" target="_blank">00:38:41.720</a></span> | <span class="t">They use two different types of metrics in batch metrics and for retrieval</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2325" target="_blank">00:38:45.760</a></span> | <span class="t">We're gonna do both so for the in batch metrics, so just calculating recall and MMR at the batch level</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2332" target="_blank">00:38:52.200</a></span> | <span class="t">okay, so what we can do to replicate that is use this re-ranking evaluator from sentence transformers and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2339" target="_blank">00:38:59.040</a></span> | <span class="t">we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2340" target="_blank">00:39:00.920</a></span> | <span class="t">Will use that to perform ranking and calculate the MMR metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2346" target="_blank">00:39:06.080</a></span> | <span class="t">using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2347" target="_blank">00:39:07.920</a></span> | <span class="t">using our evaluation set so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2350" target="_blank">00:39:10.840</a></span> | <span class="t">Just one thing as we have already done here is we've removed duplicates from batches. We need to do the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2357" target="_blank">00:39:17.580</a></span> | <span class="t">Before we actually feed data into our re-ranking evaluator and then there are a lot because we create three queries per episode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2364" target="_blank">00:39:24.080</a></span> | <span class="t">So we definitely do need to remove those so remove any duplicates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2368" target="_blank">00:39:28.760</a></span> | <span class="t">Using this and we in the end we have a thousand unique pairs for our evaluation set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2376" target="_blank">00:39:36.080</a></span> | <span class="t">so then we feed them into the re-ranking evaluator, which requires a particular format of query a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2383" target="_blank">00:39:43.160</a></span> | <span class="t">Any positives we have so we just have one positive pair query here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2387" target="_blank">00:39:47.080</a></span> | <span class="t">There's just a single a single list and then negative and then in here. We just need to pass in all of the other episodes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2394" target="_blank">00:39:54.460</a></span> | <span class="t">That are not the positive episode for that particular query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2398" target="_blank">00:39:58.940</a></span> | <span class="t">So we do that in in here and then we initialize a re-ranking evaluator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2404" target="_blank">00:40:04.840</a></span> | <span class="t">And I set MMR at K to consider the top five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2410" target="_blank">00:40:10.000</a></span> | <span class="t">items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2411" target="_blank">00:40:11.840</a></span> | <span class="t">When it's calculating its score, I'm not going to go into into the metrics because it takes a little bit more time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2418" target="_blank">00:40:18.440</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2420" target="_blank">00:40:20.800</a></span> | <span class="t">Calculating the performance. So this is the MMR</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2423" target="_blank">00:40:23.660</a></span> | <span class="t">5 for the model without any fine-tuning so we get 0.68. Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2431" target="_blank">00:40:31.880</a></span> | <span class="t">so at this point, we're actually ready to go ahead and fine-tune our model and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2435" target="_blank">00:40:35.920</a></span> | <span class="t">This is basically the easiest step. So we set a number of epochs to one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2442" target="_blank">00:40:42.200</a></span> | <span class="t">I did try other so like more epochs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2445" target="_blank">00:40:45.220</a></span> | <span class="t">Typically with sentence transformers you actually and we really need to train for one epoch depending on a model and the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2451" target="_blank">00:40:51.200</a></span> | <span class="t">Anything more it actually degraded the performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2454" target="_blank">00:40:54.560</a></span> | <span class="t">So when one epoch here and we always or typically use a number of warm-up set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2460" target="_blank">00:41:00.480</a></span> | <span class="t">so here for the first 10% of training steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2463" target="_blank">00:41:03.200</a></span> | <span class="t">The learning rate is going to be slowly increasing up to the default learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2468" target="_blank">00:41:08.440</a></span> | <span class="t">Which I think is like 1 e to the minus 5 or something along those lines</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2473" target="_blank">00:41:13.080</a></span> | <span class="t">And then we're just saving the the model that we train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2476" target="_blank">00:41:16.840</a></span> | <span class="t">Into this directory here. So this this WSC podcasts and Q. Thank you. Here's natural query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2484" target="_blank">00:41:24.160</a></span> | <span class="t">And then yeah, so that trains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2489" target="_blank">00:41:29.680</a></span> | <span class="t">It shouldn't take too long. I think maybe this took an hour maybe two hours to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2496" target="_blank">00:41:36.560</a></span> | <span class="t">so it's pretty quick and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2499" target="_blank">00:41:39.160</a></span> | <span class="t">With that we can actually look at the evaluation so, you know, how did this model perform on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2507" target="_blank">00:41:47.760</a></span> | <span class="t">Evaluator that we initialize at the start and we can actually see that. So I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2514" target="_blank">00:41:54.160</a></span> | <span class="t">Mean another environment here. We're actually training the model we go to this the distal USC podcasts and Q</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2520" target="_blank">00:42:00.820</a></span> | <span class="t">Folder and then he will see this eval</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2523" target="_blank">00:42:03.200</a></span> | <span class="t">Directory go in here open this and we can see we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2528" target="_blank">00:42:08.760</a></span> | <span class="t">Over on the right here the MMR at five value and it's zero point eight eight eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2535" target="_blank">00:42:15.960</a></span> | <span class="t">So that is a big improvement from what we had appear which is zero point six eight. So it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2542" target="_blank">00:42:22.960</a></span> | <span class="t">20 point increase which is is really good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2545" target="_blank">00:42:25.800</a></span> | <span class="t">That's on it on small batches. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2548" target="_blank">00:42:28.920</a></span> | <span class="t">That doesn't really replicate the real-world use of this model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2553" target="_blank">00:42:33.200</a></span> | <span class="t">So what we want to do in the final evaluation step is is replicate that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2557" target="_blank">00:42:37.520</a></span> | <span class="t">So what we're going to do is take the test data we had which has many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2563" target="_blank">00:42:43.040</a></span> | <span class="t">thousands of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2565" target="_blank">00:42:45.520</a></span> | <span class="t">episodes in there we're going to encode all of those and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2568" target="_blank">00:42:48.360</a></span> | <span class="t">Then we're going to perform a semantic search as we would expect this to be using in real life. So what we'll do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2575" target="_blank">00:42:55.520</a></span> | <span class="t">set up the vector database with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2578" target="_blank">00:42:58.920</a></span> | <span class="t">thousands of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2581" target="_blank">00:43:01.080</a></span> | <span class="t">Episode vectors in there from our test data set and then we're going to calculate the recall value this time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2587" target="_blank">00:43:07.440</a></span> | <span class="t">for our fine-tune model and also our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2593" target="_blank">00:43:13.400</a></span> | <span class="t">Not fine-tune model so we initialize pinecone create a evaluation index here. Make sure we use the cosine metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2601" target="_blank">00:43:21.440</a></span> | <span class="t">We connect to that. Oh if you if you need an API key, you need to go to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2606" target="_blank">00:43:26.120</a></span> | <span class="t">pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2609" target="_blank">00:43:29.240</a></span> | <span class="t">I/o, it's free. So, you know, this is all free. There's nothing you don't need to worry about anything there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2615" target="_blank">00:43:35.760</a></span> | <span class="t">We create our index we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2619" target="_blank">00:43:39.960</a></span> | <span class="t">Connect to it here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2623" target="_blank">00:43:43.440</a></span> | <span class="t">and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2624" target="_blank">00:43:44.840</a></span> | <span class="t">Then what we can do is so before we index our test a we remove duplicates like we did with the evaluation set earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2631" target="_blank">00:43:51.120</a></span> | <span class="t">Same thing. I'm not going to go through it again and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2633" target="_blank">00:43:53.160</a></span> | <span class="t">Then here. So what I'm doing is going through again. Just make sure there's definitely no duplicates in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2641" target="_blank">00:44:01.240</a></span> | <span class="t">there shouldn't be anyway, but just in case going through and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2644" target="_blank">00:44:04.680</a></span> | <span class="t">Creating batches of episodes to actually encode here using our new model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2650" target="_blank">00:44:10.520</a></span> | <span class="t">This is using the distal USC</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2652" target="_blank">00:44:12.880</a></span> | <span class="t">Podcasts and Q model and then we upset them so insert them into our pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2658" target="_blank">00:44:18.520</a></span> | <span class="t">Vector database and then just refreshing the batch and doing it again all in batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2663" target="_blank">00:44:23.740</a></span> | <span class="t">And then at the end the undersigned look at the index that so you can see how many vectors we actually have in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2668" target="_blank">00:44:28.800</a></span> | <span class="t">Which is 18 and a half thousand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2671" target="_blank">00:44:31.700</a></span> | <span class="t">Then what I'm doing here is I'm going to calculate the recall at K</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2677" target="_blank">00:44:37.720</a></span> | <span class="t">So I'm going to loop through all the queries we have so all the queries from our test set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2683" target="_blank">00:44:43.200</a></span> | <span class="t">so these are synthetic queries first and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2685" target="_blank">00:44:45.720</a></span> | <span class="t">Just looking at okay, what is the recall using those synthetic queries now?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2692" target="_blank">00:44:52.880</a></span> | <span class="t">It's 0.88. I wish it is like incredibly good, but we're using synthetic queries here. So it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2701" target="_blank">00:45:01.200</a></span> | <span class="t">It's not really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2704" target="_blank">00:45:04.000</a></span> | <span class="t">representative of real like human queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2707" target="_blank">00:45:07.480</a></span> | <span class="t">So this is where the curated queries come in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2711" target="_blank">00:45:11.320</a></span> | <span class="t">So I went through I found different episode descriptions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2715" target="_blank">00:45:15.120</a></span> | <span class="t">which were in the indexes 1 8 14 and so on and I just created like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2720" target="_blank">00:45:20.840</a></span> | <span class="t">Query for each one of those episodes that that makes sense to me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2725" target="_blank">00:45:25.200</a></span> | <span class="t">Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2725" target="_blank">00:45:25.720</a></span> | <span class="t">Now this isn't perfectly accurate that we could you know, we could use this and we could return another episode. That's actually more relevant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2734" target="_blank">00:45:34.560</a></span> | <span class="t">But using what I've done here, it would show up as not a match and and bring down the score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2740" target="_blank">00:45:40.840</a></span> | <span class="t">So just bear that in mind as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2743" target="_blank">00:45:43.200</a></span> | <span class="t">So once we use those curated like true query episode pairs or more sort of human</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2751" target="_blank">00:45:51.240</a></span> | <span class="t">queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2752" target="_blank">00:45:52.440</a></span> | <span class="t">we get a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2753" target="_blank">00:45:53.960</a></span> | <span class="t">Recall at K of 57 now, you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2757" target="_blank">00:45:57.800</a></span> | <span class="t">It doesn't like it's definitely not as impressive as the AT we had before is okay, but it's nothing special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2763" target="_blank">00:46:03.160</a></span> | <span class="t">But what I want to do here is just compare this to what we had before so the the pre-trained model value fine-tuning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2769" target="_blank">00:46:09.800</a></span> | <span class="t">Okay, so to do that, I'm just creating a new index if you're using the the free version pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2776" target="_blank">00:46:16.760</a></span> | <span class="t">You can only have one index at a time. So you will have to you can you can delete an index, you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2782" target="_blank">00:46:22.520</a></span> | <span class="t">So you can then refresh it and do this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2785" target="_blank">00:46:25.320</a></span> | <span class="t">So what we do is I'm going to create the I'm going to initialize the pre-trained model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2791" target="_blank">00:46:31.480</a></span> | <span class="t">that hasn't been fine-tuned on our particular data set and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2794" target="_blank">00:46:34.760</a></span> | <span class="t">Here I am</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2798" target="_blank">00:46:38.640</a></span> | <span class="t">creating a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2800" target="_blank">00:46:40.800</a></span> | <span class="t">Index evil zero connecting to that index and I'm going through doing the exact same thing as I did before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2806" target="_blank">00:46:46.480</a></span> | <span class="t">Okay, so just pushing all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2809" target="_blank">00:46:49.520</a></span> | <span class="t">vectors or episode embeddings that have been encoded using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2816" target="_blank">00:46:56.000</a></span> | <span class="t">Older model that hasn't been fine-tuned and then calculating the recall. Okay again using that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2821" target="_blank">00:47:01.440</a></span> | <span class="t">Using the curated data set and we get a terrible score of zero point two eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2828" target="_blank">00:47:08.040</a></span> | <span class="t">So we can see there's actually a massive improvement from you know, 28 to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2834" target="_blank">00:47:14.920</a></span> | <span class="t">57 that's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2838" target="_blank">00:47:18.120</a></span> | <span class="t">29 point improvement which is huge especially to say that our training data was synthetic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2844" target="_blank">00:47:24.840</a></span> | <span class="t">Right, so it's a synthetic data set is never going to perform as well as a genuine data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2850" target="_blank">00:47:30.020</a></span> | <span class="t">so if we had those other two data sources that Spotify use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2853" target="_blank">00:47:33.080</a></span> | <span class="t">we could probably create something that is like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2856" target="_blank">00:47:36.560</a></span> | <span class="t">Very impressive compared to what we've done here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2860" target="_blank">00:47:40.880</a></span> | <span class="t">But to say we just use episode data without any queries and synthetically create queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2866" target="_blank">00:47:46.320</a></span> | <span class="t">I think this is really impressive and it shows that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2870" target="_blank">00:47:50.800</a></span> | <span class="t">Spotify's methodology at least in terms of you know, adding these synthetic queries and definitely does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2876" target="_blank">00:47:56.440</a></span> | <span class="t">Contribute to their overall model and it shows us a really cool way to without any real training data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2883" target="_blank">00:48:03.680</a></span> | <span class="t">Do this now?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2886" target="_blank">00:48:06.400</a></span> | <span class="t">Another thing that we should really I think about here is how well does the scale?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2891" target="_blank">00:48:11.240</a></span> | <span class="t">So we're only using 18 and a half thousand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2894" target="_blank">00:48:14.680</a></span> | <span class="t">Vectors in in this like evaluation case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2899" target="_blank">00:48:19.440</a></span> | <span class="t">Using pine cone. We're quite easy easily able to go up to you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2904" target="_blank">00:48:24.880</a></span> | <span class="t">Hundreds of millions of episodes or all vectors in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2908" target="_blank">00:48:28.680</a></span> | <span class="t">And even even billions. So in terms of scalability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2913" target="_blank">00:48:33.320</a></span> | <span class="t">that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2916" target="_blank">00:48:36.320</a></span> | <span class="t">Well, unless you're going into this sort of trillion scale</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2920" target="_blank">00:48:40.160</a></span> | <span class="t">this is very possible with pretty much every data set that you're going to be using and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2926" target="_blank">00:48:46.040</a></span> | <span class="t">It will still be incredibly fast, which is is I think really cool. I think you know, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2931" target="_blank">00:48:51.800</a></span> | <span class="t">really awesome the fact that we can do this no data make it incredibly scalable and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2937" target="_blank">00:48:57.040</a></span> | <span class="t">You know build something really really awesome. So that's it for this sort of walkthrough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2944" target="_blank">00:49:04.280</a></span> | <span class="t">I will say just if you if you are going to build something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2948" target="_blank">00:49:08.480</a></span> | <span class="t">Like this with pine cone and you know doing all this sort of cool vector search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2954" target="_blank">00:49:14.920</a></span> | <span class="t">Stuff let me know because over at pine cone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2957" target="_blank">00:49:17.760</a></span> | <span class="t">We are looking for people that would like to showcase the work that they're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2961" target="_blank">00:49:21.840</a></span> | <span class="t">And it would be really cool to see what you're building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2965" target="_blank">00:49:25.400</a></span> | <span class="t">And if you sort of like to share that and get other people seeing what you're building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2971" target="_blank">00:49:31.360</a></span> | <span class="t">I think that's a really good way to do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2973" target="_blank">00:49:33.760</a></span> | <span class="t">so if you're interested in that just go over to the community page at pine cone and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2981" target="_blank">00:49:41.480</a></span> | <span class="t">You'll be able to find how to submit any projects that you're working on there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2986" target="_blank">00:49:46.920</a></span> | <span class="t">So I hope all this has been useful and interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ok0SDdXdat8&t=2990" target="_blank">00:49:50.680</a></span> | <span class="t">Thank you very much for watching and I will see you again in the next one. Bye</span></div></div></body></html>