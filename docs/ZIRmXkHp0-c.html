<html><head><title>How to Build Custom Q&A Transformer Models in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>How to Build Custom Q&A Transformer Models in Python</h2><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c"><img src="https://i.ytimg.com/vi/ZIRmXkHp0-c/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=64">1:4</a> Download Our Data<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=69">1:9</a> Squad Data Set<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=400">6:40</a> Data Prep<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1733">28:53</a> Initialize Our Tokenizer<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2470">41:10</a> Create a Pi Torch Dataset Object<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2876">47:56</a> Initialize the Optimizer<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2913">48:33</a> Initializing the Model<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3003">50:3</a> Initialize Our Data Loader<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3082">51:22</a> Training Loop<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3504">58:24</a> While Loop<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3663">61:3</a> Create a Data Loader<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3915">65:15</a> Check for an Exact Match<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3991">66:31</a> Calculate the Accuracy<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4067">67:47</a> Accuracy<br><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4111">68:31</a> Exact Match Accuracy<br><br><div style="text-align: left;"><a href="./ZIRmXkHp0-c.html">Whisper Transcript</a> | <a href="./transcript_ZIRmXkHp0-c.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi and welcome to the video. Today we're going to go through how we can fine-tune a QnA transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=6" target="_blank">00:00:06.960</a></span> | <span class="t">model. So for those of you that don't know QnA just means question and answering and it's one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=14" target="_blank">00:00:14.320</a></span> | <span class="t">of the biggest topics in NLP at the moment. There's a lot of models out there where you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=20" target="_blank">00:00:20.720</a></span> | <span class="t">ask a question and it will give you an answer. And one of the biggest things that you need to know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=30" target="_blank">00:00:30.400</a></span> | <span class="t">how to do when you are working with transformers, whether that's QnA or any of the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=35" target="_blank">00:00:35.280</a></span> | <span class="t">transformer-based solutions, is how to actually fine-tune those. So that's what we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=43" target="_blank">00:00:43.440</a></span> | <span class="t">doing in this video. We're going to go through how we can fine-tune a QnA transformer model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=49" target="_blank">00:00:49.360</a></span> | <span class="t">in Python. So I think it's really interesting and I think you will enjoy it a lot. So let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=58" target="_blank">00:00:58.320</a></span> | <span class="t">just go ahead and we can get started. Okay so first thing we need to do is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=64" target="_blank">00:01:04.640</a></span> | <span class="t">download our data. So we're going to be using the squad data set which is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=71" target="_blank">00:01:11.360</a></span> | <span class="t">Sanford question answering data set which is essentially one of the better known QnA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=77" target="_blank">00:01:17.760</a></span> | <span class="t">data sets out there that we can use to fine-tune our model. So let's first create a folder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=86" target="_blank">00:01:26.560</a></span> | <span class="t">I'm just going to use os</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=89" target="_blank">00:01:29.920</a></span> | <span class="t">and os make data. We'll just call it squad. Obviously call this and organize it as you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=101" target="_blank">00:01:41.840</a></span> | <span class="t">This is what I will be doing. Now the URL that we are going to be downloading this from is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=112" target="_blank">00:01:52.000</a></span> | <span class="t">Okay and there are actually two files here that we're going to be downloading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=115" target="_blank">00:01:55.600</a></span> | <span class="t">but both will be coming from the same URL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=118" target="_blank">00:01:58.640</a></span> | <span class="t">So because we're making a request to a URL we're going to import requests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=124" target="_blank">00:02:04.480</a></span> | <span class="t">We can also use the wget library as well or if you're on Linux you can just use wget</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=132" target="_blank">00:02:12.240</a></span> | <span class="t">directly in the terminal. It's up to you what we're going to be using requests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=137" target="_blank">00:02:17.840</a></span> | <span class="t">Okay and to request our data we're going to be doing this. So it's just a get request.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=150" target="_blank">00:02:30.160</a></span> | <span class="t">Use a f string and we have the URL that we've already defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=158" target="_blank">00:02:38.880</a></span> | <span class="t">And then the training data that we'll be using is this file here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=164" target="_blank">00:02:44.080</a></span> | <span class="t">Okay requests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=172" target="_blank">00:02:52.800</a></span> | <span class="t">Okay and we can see that we've successfully pulled that data in there. Okay so like I said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=183" target="_blank">00:03:03.120</a></span> | <span class="t">before there's actually two of these files that we want to extract. So what I'm going to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=190" target="_blank">00:03:10.240</a></span> | <span class="t">just put this into a for loop which will go through both of them. Just copy and paste this across.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=199" target="_blank">00:03:19.280</a></span> | <span class="t">Rename this file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=210" target="_blank">00:03:30.400</a></span> | <span class="t">And the other file is the same but instead of train we have dev.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=214" target="_blank">00:03:34.560</a></span> | <span class="t">Okay so here we're making our request.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=217" target="_blank">00:03:37.200</a></span> | <span class="t">And then the next thing we want to do after making our request is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=224" target="_blank">00:03:44.480</a></span> | <span class="t">saving this file to our drive. Okay and we want to put that inside this squad folder here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=233" target="_blank">00:03:53.120</a></span> | <span class="t">So to do that we use open. And again we're going to use a f string here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=240" target="_blank">00:04:00.320</a></span> | <span class="t">And we want to put inside the squad folder here. And then here we are just going to put our file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=251" target="_blank">00:04:11.040</a></span> | <span class="t">name which is file. Now we're writing this in binary because it's JSON so we put wb for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=259" target="_blank">00:04:19.360</a></span> | <span class="t">flags here. And then within this namespace we are going to run through the file and download it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=268" target="_blank">00:04:28.480</a></span> | <span class="t">chunks. So we do for chunk and then we iterate through the response like this. Let's use a chunk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=282" target="_blank">00:04:42.160</a></span> | <span class="t">size of four. And then we just want to write to the file like that. So that will download both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=294" target="_blank">00:04:54.640</a></span> | <span class="t">files. Just add the colon there. So that will download both files. We should be able to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=302" target="_blank">00:05:02.080</a></span> | <span class="t">them here now. So in here we have data, we have essentially a lot of different topics. So the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=308" target="_blank">00:05:08.560</a></span> | <span class="t">first one is Beyonce. And then in here we will see, if we just come to here, we get a context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=316" target="_blank">00:05:16.240</a></span> | <span class="t">But alongside this context we also have QAS which is question and answers. And each one of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=325" target="_blank">00:05:25.040</a></span> | <span class="t">contains a question and answer pair. So we have this question, when did Beyonce start becoming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=333" target="_blank">00:05:33.200</a></span> | <span class="t">popular? So this answer is actually within this context. And what we want our model to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=339" target="_blank">00:05:39.040</a></span> | <span class="t">extract the answer from that context by telling us the start and end token of the answer within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=346" target="_blank">00:05:46.240</a></span> | <span class="t">that context. So we go zero and it is in the late 1990s. And we have answer start 269. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=356" target="_blank">00:05:56.080</a></span> | <span class="t">that means that at character 269, we get I. So if we go through here, we can find it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=365" target="_blank">00:06:05.440</a></span> | <span class="t">Okay, so this is the extract. And that's what we will be aiming for our model to actually extract.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=372" target="_blank">00:06:12.400</a></span> | <span class="t">But there will be a start point and also the end point as well, which is not included in here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=378" target="_blank">00:06:18.080</a></span> | <span class="t">but we will add that manually quite soon. So that's our data. And then we'll also be testing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=385" target="_blank">00:06:25.600</a></span> | <span class="t">on the dev data as well, which is exactly the same. Okay, so we move on to the data prep.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=402" target="_blank">00:06:42.080</a></span> | <span class="t">So now we have our files here, we're going to want to read them in. So we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=409" target="_blank">00:06:49.280</a></span> | <span class="t">the JSON library for that. And like we saw before, there's quite a complex structure in these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=417" target="_blank">00:06:57.440</a></span> | <span class="t">JSONs, there's a lot of different layers. So we need to use a few for loops to fill through each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=423" target="_blank">00:07:03.360</a></span> | <span class="t">of these and extract what we want, which is the context, questions and answers, all corresponding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=431" target="_blank">00:07:11.280</a></span> | <span class="t">to each other. So in the end, we're going to have lists of strings, which is going to be all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=435" target="_blank">00:07:15.680</a></span> | <span class="t">these. And in the case of the answers, we will also have the starting position. So it will be a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=440" target="_blank">00:07:20.080</a></span> | <span class="t">list of dictionaries, where one value is a text and one value is the starting position. So to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=449" target="_blank">00:07:29.600</a></span> | <span class="t">that, we're going to define a function called read squad. We'll define our path here as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=461" target="_blank">00:07:41.600</a></span> | <span class="t">And the first thing we need to do is actually open the JSON file. So we do with open path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=469" target="_blank">00:07:49.040</a></span> | <span class="t">And again, we are using a binary file. So we're going to have B</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=474" target="_blank">00:07:54.320</a></span> | <span class="t">as a flag. But we're instead of writing, we are reading so use our here. So our B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=490" target="_blank">00:08:10.400</a></span> | <span class="t">And just do JSON load F here. So now we have our dictionary within this squad dict here. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=499" target="_blank">00:08:19.120</a></span> | <span class="t">maybe whilst we're just building this function up, it's probably more useful to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=503" target="_blank">00:08:23.680</a></span> | <span class="t">do it here. So you can see what we're actually doing. So let's copy that across.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=513" target="_blank">00:08:33.360</a></span> | <span class="t">And then we'll fill this out afterwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=514" target="_blank">00:08:34.880</a></span> | <span class="t">Of course, we do actually need to include the path. So let's take this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=536" target="_blank">00:08:56.240</a></span> | <span class="t">And then we can see what's inside here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=537" target="_blank">00:08:57.760</a></span> | <span class="t">Maybe we can load just a few rather than all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=549" target="_blank">00:09:09.280</a></span> | <span class="t">Or we can investigate it like this. Okay, so we have the version and data, which we can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=561" target="_blank">00:09:21.760</a></span> | <span class="t">see over here, version and data. So we want to access the data. Now within data is we have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=568" target="_blank">00:09:28.880</a></span> | <span class="t">list of all these different items, which is what I was trying to do before. So we go into data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=575" target="_blank">00:09:35.120</a></span> | <span class="t">And just take a few of those. Okay, and then we get our different sections.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=587" target="_blank">00:09:47.600</a></span> | <span class="t">For the first one, let's just take zero, which is Beyonce. And then we have all of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=595" target="_blank">00:09:55.120</a></span> | <span class="t">So we're going to want to loop through each one of these, because we have this one next,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=603" target="_blank">00:10:03.440</a></span> | <span class="t">and we're going to keep needing to just run through all of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=610" target="_blank">00:10:10.560</a></span> | <span class="t">So to do that, we want to do for group</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=615" target="_blank">00:10:15.920</a></span> | <span class="t">in squad dict. And remember, we need to include the data here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=624" target="_blank">00:10:24.240</a></span> | <span class="t">Let's just see our say group title. So we can see a few of those. Okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=634" target="_blank">00:10:34.320</a></span> | <span class="t">then go through each one of those. So the second part of that are these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=640" target="_blank">00:10:40.800</a></span> | <span class="t">these paragraphs. And when the paragraphs we have each one of our questions. So let's first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=652" target="_blank">00:10:52.240</a></span> | <span class="t">go with paragraphs. And we'll do the chop in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=656" target="_blank">00:10:56.800</a></span> | <span class="t">Sorry, it's a list. There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=665" target="_blank">00:11:05.840</a></span> | <span class="t">And the first thing we need to extract is the easiest one, which is our context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=677" target="_blank">00:11:17.680</a></span> | <span class="t">However, that is also within a list. So now if we access the context, we get this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=686" target="_blank">00:11:26.640</a></span> | <span class="t">So we're essentially going to need to jump through or loop through each one of these here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=695" target="_blank">00:11:35.280</a></span> | <span class="t">Now we're gonna need to access the paragraphs and loop through each one of those. And then here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=700" target="_blank">00:11:40.880</a></span> | <span class="t">we're going to access the context. So let's write that. So we already have one group here. So let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=709" target="_blank">00:11:49.600</a></span> | <span class="t">just stick with that. And we're going to run through the passage in the paragraphs. So already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=721" target="_blank">00:12:01.440</a></span> | <span class="t">here, we're going through the for loop on this index. And now we're going to go through a loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=727" target="_blank">00:12:07.360</a></span> | <span class="t">on this index. Let's keep that. So that means that we will be able to print the passage</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=743" target="_blank">00:12:23.120</a></span> | <span class="t">context. And there we go. So here we have all of our context. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=752" target="_blank">00:12:32.320</a></span> | <span class="t">one of our three items that we need to extract. Okay, so that's great. Let's put that all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=759" target="_blank">00:12:39.600</a></span> | <span class="t">So we're going to take this, put it here. And then we have our context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=768" target="_blank">00:12:48.560</a></span> | <span class="t">Okay, that's great. Obviously, for each context, we have a few different questions and answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=778" target="_blank">00:12:58.800</a></span> | <span class="t">So we need to get those as well. Now, that requires us to go through another for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=786" target="_blank">00:13:06.000</a></span> | <span class="t">So let's go this passage, we need to go into the QAS key and loop through this list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=794" target="_blank">00:13:14.320</a></span> | <span class="t">question and answers. So we have this, and then we have our list. So another layer in our for loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=805" target="_blank">00:13:25.680</a></span> | <span class="t">will be for question answer in that passage QAS. And then let's take a look at what we have there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=817" target="_blank">00:13:37.120</a></span> | <span class="t">Okay, great. So we have plausible answers, question and answers. So what we want in here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=827" target="_blank">00:13:47.280</a></span> | <span class="t">is the question and answers. So question is our first one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=832" target="_blank">00:13:52.080</a></span> | <span class="t">Perfect. So we have the questions now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=855" target="_blank">00:14:15.760</a></span> | <span class="t">And then after we have extracted the question, we can move on to our answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=860" target="_blank">00:14:20.480</a></span> | <span class="t">As we see here, the answers comes as another list. Now each one of these lists all just have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=868" target="_blank">00:14:28.080</a></span> | <span class="t">one actual answer in there, which is completely fine. So we can access that in two ways. We can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=873" target="_blank">00:14:33.680</a></span> | <span class="t">either loop through or we can access the zero value of that array. Either way, it doesn't matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=884" target="_blank">00:14:44.560</a></span> | <span class="t">So all we need to do here is loop through those answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=889" target="_blank">00:14:49.120</a></span> | <span class="t">Or if we want, just go with QA answers zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=896" target="_blank">00:14:56.880</a></span> | <span class="t">So in most cases, this should be completely fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=905" target="_blank">00:15:05.440</a></span> | <span class="t">As we can see here, most of these question and then they have the answers dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=914" target="_blank">00:15:14.080</a></span> | <span class="t">Which is fine. However, some of these are slightly different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=920" target="_blank">00:15:20.160</a></span> | <span class="t">So if we scroll right down to the end here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=925" target="_blank">00:15:25.440</a></span> | <span class="t">say, okay, we have this, which is talking about physics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=932" target="_blank">00:15:32.320</a></span> | <span class="t">And then rather than having our answers array, we have these plausible answers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=941" target="_blank">00:15:41.520</a></span> | <span class="t">which is obviously slightly different. And this is the case for a couple of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=947" target="_blank">00:15:47.360</a></span> | <span class="t">So from what I've seen, the states that the best way to deal with this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=952" target="_blank">00:15:52.480</a></span> | <span class="t">is simply to have a check. If there is a plausible answers key within the dictionary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=960" target="_blank">00:16:00.160</a></span> | <span class="t">we will include that as the answer rather than the actual answers dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=966" target="_blank">00:16:06.800</a></span> | <span class="t">So to do that, all we need to do is check if QA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=973" target="_blank">00:16:13.520</a></span> | <span class="t">keys contains plausible answers. If it does, we use that. Otherwise, we use answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=990" target="_blank">00:16:30.960</a></span> | <span class="t">Okay. Then we use this one. Otherwise,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1002" target="_blank">00:16:42.000</a></span> | <span class="t">we will use answers. So let's just add all of that into our for loop here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1017" target="_blank">00:16:57.760</a></span> | <span class="t">So we have our context, and then we want to loop through the question answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1022" target="_blank">00:17:02.320</a></span> | <span class="t">And this is where we get our question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1033" target="_blank">00:17:13.120</a></span> | <span class="t">Then once we're here, we need to do something slightly different, which is this plausible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1047" target="_blank">00:17:27.360</a></span> | <span class="t">answers. Okay. And then we use this access variable in order to define what we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1056" target="_blank">00:17:36.960</a></span> | <span class="t">to loop through next. So here we go for answers, answer, sorry, in QA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1066" target="_blank">00:17:46.960</a></span> | <span class="t">access, because this will switch to implausible answers or answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1074" target="_blank">00:17:54.160</a></span> | <span class="t">And then within this for loop, this is where we can begin adding this context, question,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1081" target="_blank">00:18:01.600</a></span> | <span class="t">and answer to a list of questions, context, and answers that we still need to define up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1089" target="_blank">00:18:09.520</a></span> | <span class="t">So each one of these is just going to be an empty list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1102" target="_blank">00:18:22.160</a></span> | <span class="t">And then all we do, copy this across,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1104" target="_blank">00:18:24.320</a></span> | <span class="t">and we just append everything that we've extracted in this loop and the context,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1115" target="_blank">00:18:35.840</a></span> | <span class="t">question, and answer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1130" target="_blank">00:18:50.640</a></span> | <span class="t">And that should work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1131" target="_blank">00:18:51.600</a></span> | <span class="t">So now let's take a look at a few about context. Okay. We can see we have this, and because we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1145" target="_blank">00:19:05.680</a></span> | <span class="t">have multiple question answers for each context, the context does repeat over and over again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1150" target="_blank">00:19:10.800</a></span> | <span class="t">But then we should see something slightly different when we go with answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1160" target="_blank">00:19:20.080</a></span> | <span class="t">And questions. Okay. So that's great. We have our data in a reasonable format now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1168" target="_blank">00:19:28.400</a></span> | <span class="t">but we want to do this for both the training set and the validation set. So what we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1176" target="_blank">00:19:36.560</a></span> | <span class="t">is just going to put this into a function like we were going to do before, which is this read squad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1187" target="_blank">00:19:47.120</a></span> | <span class="t">So here, we're going to read in our data, and then we run through it and transform it into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1199" target="_blank">00:19:59.520</a></span> | <span class="t">our three lists. And all we need to do now is actually return those three lists and answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1213" target="_blank">00:20:13.600</a></span> | <span class="t">So now what we can do is execute this function for both our training and validation sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1220" target="_blank">00:20:20.400</a></span> | <span class="t">So we're going to train context, questions, and answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1239" target="_blank">00:20:39.120</a></span> | <span class="t">Okay. So that is one of them, and we can just copy that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1253" target="_blank">00:20:53.840</a></span> | <span class="t">And we just want this to be our validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1261" target="_blank">00:21:01.280</a></span> | <span class="t">Like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1264" target="_blank">00:21:04.640</a></span> | <span class="t">Okay. So that's great. We now have the training context and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1274" target="_blank">00:21:14.400</a></span> | <span class="t">validation context, which we can see right here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1283" target="_blank">00:21:23.840</a></span> | <span class="t">So here, let's hope that there is a slight difference in what we see between both.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1289" target="_blank">00:21:29.360</a></span> | <span class="t">Okay. Great. That's what we would expect. Okay. So now we have our data almost in the right format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1306" target="_blank">00:21:46.320</a></span> | <span class="t">We just need to add the ending position. So we already have the start position. If we take a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1314" target="_blank">00:21:54.320</a></span> | <span class="t">in our train answers. Okay. We have the answer start, but we also need the answer end, and that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1323" target="_blank">00:22:03.840</a></span> | <span class="t">not included within the data. So what we need to do here is actually put that into a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1330" target="_blank">00:22:10.560</a></span> | <span class="t">and that's not included within the data. So what we need to do here is actually define a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1337" target="_blank">00:22:17.760</a></span> | <span class="t">that will go through each one of our answers and context and figure out where that ending</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1345" target="_blank">00:22:25.040</a></span> | <span class="t">character actually is. And of course we could just say, okay, it's the length of the text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1352" target="_blank">00:22:32.080</a></span> | <span class="t">We add that onto the answer start and we have our answer end. However, that unfortunately won't work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1360" target="_blank">00:22:40.080</a></span> | <span class="t">because some of the answer starts are actually incorrect and they're usually off by one or two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1367" target="_blank">00:22:47.040</a></span> | <span class="t">characters. So we actually need to go through and one, fix that and two, add our end indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1375" target="_blank">00:22:55.040</a></span> | <span class="t">So to do that, we're just going to define a new function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1382" target="_blank">00:23:02.720</a></span> | <span class="t">which is going to be add end index. And here we will have our answers and the context,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1393" target="_blank">00:23:13.440</a></span> | <span class="t">and then we're going to just feed these in. So first thing we do is loop through each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1399" target="_blank">00:23:19.360</a></span> | <span class="t">answer and context pair. And then we extract something which is called the gold text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1419" target="_blank">00:23:39.200</a></span> | <span class="t">which is essentially the answer that we are looking for. It's called the golden text or gold text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1427" target="_blank">00:23:47.760</a></span> | <span class="t">So simply our answer and within that, the text. So we are pulling this out here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1438" target="_blank">00:23:58.160</a></span> | <span class="t">So we should already know the starting index. So what we do here is simply pull that out as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1454" target="_blank">00:24:14.800</a></span> | <span class="t">And then the end index ideally will be the start plus the length of the gold text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1466" target="_blank">00:24:26.640</a></span> | <span class="t">However, that's not always the case because like I said before, they can be off by one or two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1474" target="_blank">00:24:34.560</a></span> | <span class="t">characters. So we need to add in some logic just to deal with that. So in our first case, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1483" target="_blank">00:24:43.040</a></span> | <span class="t">assume that the characters are not off. So if context start to end equals the gold text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1503" target="_blank">00:25:03.680</a></span> | <span class="t">this means everything is good and we don't need to worry about it. So we can modify the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1512" target="_blank">00:25:12.000</a></span> | <span class="t">original dictionary and we can add answer end into there. And we made that equal to our end index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1522" target="_blank">00:25:22.720</a></span> | <span class="t">However, if that's not the case, that means we have a problem. It's one of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1529" target="_blank">00:25:29.200</a></span> | <span class="t">dodgy question answer pairs. And so this time what we can do is we'll add a out statement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1540" target="_blank">00:25:40.000</a></span> | <span class="t">So we're just going to go through when the position is off by one or two characters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1544" target="_blank">00:25:44.720</a></span> | <span class="t">because it is not off by any more than that in the squad dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1548" target="_blank">00:25:48.400</a></span> | <span class="t">Loop through each of those and we'll say, okay, if the context,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1554" target="_blank">00:25:54.320</a></span> | <span class="t">and then in here we need to add the start index and this again. So let's just copy and paste</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1562" target="_blank">00:26:02.640</a></span> | <span class="t">side cross be easier. But this time we're checking to see if it is off by one or two characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1570" target="_blank">00:26:10.000</a></span> | <span class="t">So just do minus N and it's always minus N. It isn't shifted. It's always shifted to the left</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1577" target="_blank">00:26:17.040</a></span> | <span class="t">rather than shifted to the right. So this is fine. So in this case, the answer is off by N tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1588" target="_blank">00:26:28.640</a></span> | <span class="t">And so we need to update our answer, start value, and also add our answer end value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1605" target="_blank">00:26:45.840</a></span> | <span class="t">So start index minus N and we also have the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1619" target="_blank">00:26:59.040</a></span> | <span class="t">So that's great. We can take that and we can apply it to our train and validation sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1630" target="_blank">00:27:10.240</a></span> | <span class="t">So all we do here is call the function and we just see train answers and train context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1642" target="_blank">00:27:22.000</a></span> | <span class="t">And of course we can just copy this and do the same for our validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1658" target="_blank">00:27:38.960</a></span> | <span class="t">Okay. Perfect. So now if we have a quick look, we should be able to see that we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1665" target="_blank">00:27:45.280</a></span> | <span class="t">a few of these ending points as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1671" target="_blank">00:27:51.440</a></span> | <span class="t">Okay. So I think that looks pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1677" target="_blank">00:27:57.680</a></span> | <span class="t">And that means we can move on to actually encoding our text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1682" target="_blank">00:28:02.640</a></span> | <span class="t">To tokenize or encode our text, this is where we bring in a tokenizer. So we need to import</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1698" target="_blank">00:28:18.960</a></span> | <span class="t">the transformers library for this. And from transformers, we are going to import the distilbert.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1706" target="_blank">00:28:26.640</a></span> | <span class="t">So distilbert is a smaller version of BERT, which is just going to run a bit quicker,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1712" target="_blank">00:28:32.960</a></span> | <span class="t">but it will take a very long time. And we're going to import the fast version of this tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1720" target="_blank">00:28:40.560</a></span> | <span class="t">because this allows us to more easily adjust our character and then start locations to token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1729" target="_blank">00:28:49.040</a></span> | <span class="t">end and start locations later on. So first we need to actually initialize our tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1735" target="_blank">00:28:55.520</a></span> | <span class="t">Which is super easy. All we're doing is loading it from a pre-trained model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1756" target="_blank">00:29:16.400</a></span> | <span class="t">Okay. And then all we do to create our encodings is to call the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1772" target="_blank">00:29:32.160</a></span> | <span class="t">So we'll do the training set first,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1774" target="_blank">00:29:34.640</a></span> | <span class="t">which is called tokenizer. And in here, we include our training context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1783" target="_blank">00:29:43.600</a></span> | <span class="t">And the training questions. So what this will do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1792" target="_blank">00:29:52.080</a></span> | <span class="t">is actually merge these two strings together. So what we will have is our context,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1803" target="_blank">00:30:03.200</a></span> | <span class="t">and then there will be a separator token followed by the question. And this will be fed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1808" target="_blank">00:30:08.240</a></span> | <span class="t">into distilbert during training. I just want to add padding there as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1816" target="_blank">00:30:16.720</a></span> | <span class="t">And then we'll copy this and do the same for our validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1837" target="_blank">00:30:37.120</a></span> | <span class="t">Okay. And this will convert our data into encoding objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1841" target="_blank">00:30:41.520</a></span> | <span class="t">So what we can do here is print out different parts that we have within our encodings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1852" target="_blank">00:30:52.720</a></span> | <span class="t">So in here, so you have the input IDs. So let's access that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1862" target="_blank">00:31:02.800</a></span> | <span class="t">And you'll find in here, we have a big list of all of our samples. So check that we have 130K.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1871" target="_blank">00:31:11.680</a></span> | <span class="t">And let's open one of those. Okay. And we have these token IDs, and this is what Bert will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1880" target="_blank">00:31:20.720</a></span> | <span class="t">reading. Now, if we want to have a look at what this actually is in sort of human readable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1887" target="_blank">00:31:27.920</a></span> | <span class="t">language, we can use the tokenizer to just decode it for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1892" target="_blank">00:31:32.640</a></span> | <span class="t">Okay. And this is what we're feeding in. So we have a couple of these special tokens. This just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1905" target="_blank">00:31:45.040</a></span> | <span class="t">means it's the start of a sequence. And in here, we have a process form of our original context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1915" target="_blank">00:31:55.120</a></span> | <span class="t">Now, you'll find that the context actually ends here. And like I said before, we have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1920" target="_blank">00:32:00.400</a></span> | <span class="t">separator token. And then after that, we have our actual question. And this is what is being fed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1928" target="_blank">00:32:08.720</a></span> | <span class="t">into Bert, but obviously the token ID version. So it's just good to be aware of what is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1935" target="_blank">00:32:15.920</a></span> | <span class="t">being fed in and what we're actually using here. But this is a format that Bert is expecting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1942" target="_blank">00:32:22.400</a></span> | <span class="t">And then after that, we have another separator token followed by all of our padding tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1946" target="_blank">00:32:26.560</a></span> | <span class="t">because Bert is going to be expecting 512 tokens to be fed in for every one sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1954" target="_blank">00:32:34.800</a></span> | <span class="t">So we just need to fill that space essentially. So that's all that is doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1959" target="_blank">00:32:39.200</a></span> | <span class="t">So let's remove those and we can continue. So the next thing we need to add to our encodings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1970" target="_blank">00:32:50.640</a></span> | <span class="t">is the start and end positions, because at the moment, we just don't have them in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1977" target="_blank">00:32:57.200</a></span> | <span class="t">So to do that, we need to add an additional bit of logic. We use this character to token method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1986" target="_blank">00:33:06.960</a></span> | <span class="t">So if we just take out one of these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1995" target="_blank">00:33:15.360</a></span> | <span class="t">let's take the first one. OK, we have this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=1999" target="_blank">00:33:19.360</a></span> | <span class="t">And what we can do is actually modify this to use the character to token method,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2009" target="_blank">00:33:29.440</a></span> | <span class="t">remove the input IDs, because we just need to pass it the index of whichever encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2016" target="_blank">00:33:36.640</a></span> | <span class="t">we are wanting to modify or get the start and end position of. And in here, all we're doing is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2025" target="_blank">00:33:45.040</a></span> | <span class="t">converting from the character that we have found a position for to the token that we want to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2031" target="_blank">00:33:51.280</a></span> | <span class="t">a position for. And what we need to add is train answers. We have our position again, because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2041" target="_blank">00:34:01.360</a></span> | <span class="t">answers and encodings, the context in question needs to match up to the answer, of course,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2047" target="_blank">00:34:07.120</a></span> | <span class="t">that we're asking about. And we do answers start. So here, we're just feeding in the position of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2056" target="_blank">00:34:16.640</a></span> | <span class="t">character. And this is answer. OK. So feeding in position of the character,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2063" target="_blank">00:34:23.920</a></span> | <span class="t">and we're expecting to return the position of the token, which is position 64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2071" target="_blank">00:34:31.760</a></span> | <span class="t">So all we need to do now is do this for both of those. So for the start position and end position.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2078" target="_blank">00:34:38.880</a></span> | <span class="t">So here we should get a different value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2086" target="_blank">00:34:46.640</a></span> | <span class="t">OK, but this is one of the limitations of this. Sometimes this is going to return nothing. As</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2097" target="_blank">00:34:57.680</a></span> | <span class="t">you can see, it's not returning anything here. And that is because sometimes it is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2103" target="_blank">00:35:03.760</a></span> | <span class="t">returning the space. And when it looks at the space and the tokenizer see that, and they say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2110" target="_blank">00:35:10.880</a></span> | <span class="t">OK, that's nothing. We're not concerned about spaces. And it returns this non-value that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2115" target="_blank">00:35:15.520</a></span> | <span class="t">can see here. So this is something that we need to consider and build in some added logic for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2125" target="_blank">00:35:25.200</a></span> | <span class="t">So to do that, again, we're going to use a function to contain all of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2130" target="_blank">00:35:30.880</a></span> | <span class="t">And call it addTokenPositions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2136" target="_blank">00:35:36.880</a></span> | <span class="t">Yeah, we'll have our encodings and our answers. And then we just modify this code. So we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2147" target="_blank">00:35:47.200</a></span> | <span class="t">encodings. We have the answers. And because we're collecting all of the token positions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2156" target="_blank">00:35:56.800</a></span> | <span class="t">we also need to initialize a list to contain those. So we do startPositions, emptyList, and endPositions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2172" target="_blank">00:36:12.320</a></span> | <span class="t">And now we just want to loop through every single answer and encoding that we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2177" target="_blank">00:36:17.600</a></span> | <span class="t">Like so. And here we have our startPositions. So we need to append that to our startPositionsList.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2198" target="_blank">00:36:38.800</a></span> | <span class="t">Then we just do the same for our endPositions, which is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2203" target="_blank">00:36:43.040</a></span> | <span class="t">Now, here we can deal with this problem that we had. So if we find that the endPositions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2218" target="_blank">00:36:58.400</a></span> | <span class="t">the most recent one, so the negative one index, is none, that means it wasn't found. And it means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2227" target="_blank">00:37:07.040</a></span> | <span class="t">there is a space. So what we do is we change it to instead use the -1 version. And all this needs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2236" target="_blank">00:37:16.000</a></span> | <span class="t">to do is update the endPositions here. OK, that's great. But in some cases, this also happens with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2246" target="_blank">00:37:26.080</a></span> | <span class="t">the startPosition. But that is for a different reason. The reason it will occasionally happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2251" target="_blank">00:37:31.680</a></span> | <span class="t">with startPosition is when the passage of data that we're adding in here, so you saw before we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2259" target="_blank">00:37:39.040</a></span> | <span class="t">had the context, a separated token, and then the question, sometimes the context passage is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2266" target="_blank">00:37:46.160</a></span> | <span class="t">truncated in order to fit in the question. So some of it will be cut off. And in that case,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2274" target="_blank">00:37:54.400</a></span> | <span class="t">we do have a bit of a problem. But we still need to just allow our code to run without any problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2281" target="_blank">00:38:01.520</a></span> | <span class="t">So what we do is we just modify the startPositions again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2288" target="_blank">00:38:08.160</a></span> | <span class="t">just like we did with the endPositions. Obviously, only if it's none. And we just set it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2296" target="_blank">00:38:16.320</a></span> | <span class="t">to be equal to the maximum length that has been defined by the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2306" target="_blank">00:38:26.240</a></span> | <span class="t">And it's as simple as that. Now, the only final thing we need to do, which is because we're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2313" target="_blank">00:38:33.760</a></span> | <span class="t">the encodings, is actually update those encodings to include this data. Because as of yet, we haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2321" target="_blank">00:38:41.280</a></span> | <span class="t">added that back in. So to do that, we can use this quite handy update method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2330" target="_blank">00:38:50.640</a></span> | <span class="t">And just add in our data as a dictionary. So we have the startPositions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2336" target="_blank">00:38:56.240</a></span> | <span class="t">startPositions. And then we also have our endPositions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2346" target="_blank">00:39:06.240</a></span> | <span class="t">And then, again, we just need to apply this to our training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2358" target="_blank">00:39:18.400</a></span> | <span class="t">We just need to apply this to our training and validation sets. And let's just modify that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2366" target="_blank">00:39:26.080</a></span> | <span class="t">Let's add the train encodings here and the train answers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2387" target="_blank">00:39:47.520</a></span> | <span class="t">And do that again, the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2394" target="_blank">00:39:54.480</a></span> | <span class="t">So now let's take a look at our encodings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2401" target="_blank">00:40:01.680</a></span> | <span class="t">And here we can see, great, now we have those startPositions and endPositions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2409" target="_blank">00:40:09.600</a></span> | <span class="t">We can even have a quick look at what they look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2416" target="_blank">00:40:16.000</a></span> | <span class="t">And what we've done is actually not included the index here. So we're just taking it for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2423" target="_blank">00:40:23.440</a></span> | <span class="t">the very first item every single time. So let's just update that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2428" target="_blank">00:40:28.160</a></span> | <span class="t">So obviously, that won't get us very far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2436" target="_blank">00:40:36.320</a></span> | <span class="t">And just update that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2439" target="_blank">00:40:39.280</a></span> | <span class="t">And now this should look a little bit better. So it's lucky we checked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2447" target="_blank">00:40:47.280</a></span> | <span class="t">Okay, so our data, our training, and our validation sets are now up to date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2462" target="_blank">00:41:02.560</a></span> | <span class="t">Okay, so our data at the moment is in the right format. We just need to use it to create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2472" target="_blank">00:41:12.320</a></span> | <span class="t">PyTorch dataset object. So to do that, obviously, we need to import PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2482" target="_blank">00:41:22.960</a></span> | <span class="t">And we define that dataset using a class. And just pass in the TorchUtilsDataDataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2495" target="_blank">00:41:35.520</a></span> | <span class="t">We need to initialize that like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2507" target="_blank">00:41:47.840</a></span> | <span class="t">And this is coming from the Houdinface Transformers documentation. Don't take credit for this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2535" target="_blank">00:42:15.280</a></span> | <span class="t">And we essentially need to do this so that we can load in our data using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2539" target="_blank">00:42:19.680</a></span> | <span class="t">PyTorch data loader later on, which makes things incredibly easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2564" target="_blank">00:42:44.160</a></span> | <span class="t">And then we just have one more function here, one method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2584" target="_blank">00:43:04.560</a></span> | <span class="t">Okay, and we just need to return and also this as well. That should be okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2592" target="_blank">00:43:12.640</a></span> | <span class="t">So we apply this to our datasets to create dataset objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2608" target="_blank">00:43:28.400</a></span> | <span class="t">We have our encodings and then the same again for the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2613" target="_blank">00:43:33.280</a></span> | <span class="t">Okay, so that is our data almost fully prepared. All we do now is load it into a data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2627" target="_blank">00:43:47.760</a></span> | <span class="t">object. But this is everything on the data side done, which is great because I know it does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2635" target="_blank">00:43:55.520</a></span> | <span class="t">take some time and I know it's not the most interesting part of it, but it's just something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2640" target="_blank">00:44:00.160</a></span> | <span class="t">that we need to do and need to understand what we're doing as well. So now we get to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2649" target="_blank">00:44:09.760</a></span> | <span class="t">the more interesting bit. So we'll just add the imports in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2662" target="_blank">00:44:22.560</a></span> | <span class="t">So we need our data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2666" target="_blank">00:44:26.800</a></span> | <span class="t">We're going to import the atom optimizer with weighted decay, which is pretty commonly used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2681" target="_blank">00:44:41.680</a></span> | <span class="t">for transformer models when you are fine tuning. Because transformer models are generally very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2688" target="_blank">00:44:48.880</a></span> | <span class="t">large models and they can overfit very easily. So this atom optimizer with weighted decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2696" target="_blank">00:44:56.960</a></span> | <span class="t">essentially just reduces the chances of that happening,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2701" target="_blank">00:45:01.520</a></span> | <span class="t">which is supposed to be very useful and quite important. So obviously we're going to use that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2714" target="_blank">00:45:14.160</a></span> | <span class="t">And then final bit is TQDM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2718" target="_blank">00:45:18.160</a></span> | <span class="t">So TQDM is a progress bar that we are going to be using so that we can actually see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2730" target="_blank">00:45:30.400</a></span> | <span class="t">the progress of our training. Otherwise, we're just going to be sat there for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2735" target="_blank">00:45:35.440</a></span> | <span class="t">probably quite a long time, not knowing what is actually happening. And trust me,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2740" target="_blank">00:45:40.800</a></span> | <span class="t">it won't take long before you start questioning whether anything is happening, because it takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2745" target="_blank">00:45:45.200</a></span> | <span class="t">a long time to train these models. So they are our imports and I'm being stupid again here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2754" target="_blank">00:45:54.400</a></span> | <span class="t">That's from, did that twice. Okay, so that's all good. So now we just need to do a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2761" target="_blank">00:46:01.520</a></span> | <span class="t">little bits for the setup. So we need to tell PyTorch whether we're using CPU or GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2770" target="_blank">00:46:10.400</a></span> | <span class="t">In my case, it will be a GPU. If you're using CPU, this is going to take you a very long time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2776" target="_blank">00:46:16.720</a></span> | <span class="t">to train. And it's still going to take you a long time on GPU. So just be aware of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2782" target="_blank">00:46:22.640</a></span> | <span class="t">But what we're going to do here is say device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2792" target="_blank">00:46:32.960</a></span> | <span class="t">It's CUDA, if CUDA is available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2795" target="_blank">00:46:35.680</a></span> | <span class="t">Otherwise, we are going to use the CPU. And good luck if that is what you're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2812" target="_blank">00:46:52.080</a></span> | <span class="t">So once we've defined the device, we want to move our model over to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2822" target="_blank">00:47:02.720</a></span> | <span class="t">So we just model.toDevice. So this .to method is essentially a way of transferring data between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2831" target="_blank">00:47:11.200</a></span> | <span class="t">different hardware components, so your CPU or GPU. It's quite useful. And then we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2837" target="_blank">00:47:17.840</a></span> | <span class="t">activate our model for training. So there's two things we have here. So we have .train and eval.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2847" target="_blank">00:47:27.440</a></span> | <span class="t">So when we're in train mode, there's a lot of different layers and different parts of your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2852" target="_blank">00:47:32.880</a></span> | <span class="t">model that will behave differently depending on whether you are using the model for training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2858" target="_blank">00:47:38.320</a></span> | <span class="t">or you're using it for inference, which is predictions. So we just need to make sure our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2864" target="_blank">00:47:44.000</a></span> | <span class="t">model is in the right mode for whatever we're doing. And later on, we'll switch it to eval</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2870" target="_blank">00:47:50.160</a></span> | <span class="t">to make some predictions. So that's almost everything. So we just need to initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2877" target="_blank">00:47:57.520</a></span> | <span class="t">the optimizer. And here, we're using the weighted decay atom optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2883" target="_blank">00:48:03.360</a></span> | <span class="t">We need to pass in our model parameters and also give it a learning rate. And we're just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2895" target="_blank">00:48:15.840</a></span> | <span class="t">use this value here. All of these are the recommended parameters for what we are doing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2903" target="_blank">00:48:23.840</a></span> | <span class="t">So the one thing that I have somehow missed is defining the, actually initializing the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2915" target="_blank">00:48:35.280</a></span> | <span class="t">So let's just add that in. And all we're doing here is loading, again, a pre-trained one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2922" target="_blank">00:48:42.560</a></span> | <span class="t">So like we did before when we were loading the Transformers tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2927" target="_blank">00:48:47.280</a></span> | <span class="t">This time, it's for question answering. So this distilbert of question answering is a distilbert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2943" target="_blank">00:49:03.360</a></span> | <span class="t">model with a question and answering head added onto the end of it. So essentially with Transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2950" target="_blank">00:49:10.720</a></span> | <span class="t">you have all these different heads that you add on. And they will do different things depending on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2956" target="_blank">00:49:16.000</a></span> | <span class="t">what head it has on there. So let's initialize that from pre-trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2966" target="_blank">00:49:26.720</a></span> | <span class="t">And we're using the same one we use up here, which is distilbert base uncased.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2977" target="_blank">00:49:37.680</a></span> | <span class="t">And sometimes you will need to download that. Fortunately, I don't need to as I've already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2983" target="_blank">00:49:43.600</a></span> | <span class="t">done that. But this can also take a little bit of time, not too long though. And you get a nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2988" target="_blank">00:49:48.160</a></span> | <span class="t">progress bar, hopefully, as well. Okay, so now that is all settled, we can initialize our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=2997" target="_blank">00:49:57.120</a></span> | <span class="t">loader. So all we're doing here is using the PyTorch data loader object. And we just pass in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3015" target="_blank">00:50:15.520</a></span> | <span class="t">our training data set, the batch size. So how many we want to train on at once in parallel before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3023" target="_blank">00:50:23.120</a></span> | <span class="t">updating the model weights, which will be 16. And we also would like to shuffle the data because we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3031" target="_blank">00:50:31.200</a></span> | <span class="t">don't want to train the model on a single batch and it just learned about Beyonce. And then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3035" target="_blank">00:50:35.680</a></span> | <span class="t">next one is learning about Chopin. And it will keep switching from batch to batch. So let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3042" target="_blank">00:50:42.160</a></span> | <span class="t">move on. It's learning about Chopin. And it will keep switching between those. But never</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3048" target="_blank">00:50:48.000</a></span> | <span class="t">within a single batch, having a good mix of different things to learn about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3052" target="_blank">00:50:52.640</a></span> | <span class="t">So it is data sets. Seems a bit of a weird name to me, so I'm just going to change it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3063" target="_blank">00:51:03.760</a></span> | <span class="t">And I also can't spell. There we go. And that is everything we can actually begin</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3082" target="_blank">00:51:22.000</a></span> | <span class="t">our training loop. So we're going to go for three pups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3093" target="_blank">00:51:33.200</a></span> | <span class="t">And what we want to start with here is a loop object. So we do this mainly because we're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3102" target="_blank">00:51:42.560</a></span> | <span class="t">TQDM as a progress bar. Otherwise, we wouldn't need to do this. There'd be no point in doing it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3109" target="_blank">00:51:49.680</a></span> | <span class="t">And all this is doing is kind of like pre-initializing our loop that we are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3116" target="_blank">00:51:56.960</a></span> | <span class="t">to go through. So we're going to obviously loop through every batch within the train loader. So we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3122" target="_blank">00:52:02.880</a></span> | <span class="t">just add that in here. And then there's this other parameter, which I don't know if we...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3130" target="_blank">00:52:10.160</a></span> | <span class="t">So let's leave it. But essentially, you can add leave equals true in order to leave your progress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3137" target="_blank">00:52:17.520</a></span> | <span class="t">bar in the same place with every epoch. Whereas at the moment, with every epoch, what it will do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3143" target="_blank">00:52:23.600</a></span> | <span class="t">create a new progress bar. We are going to create a new progress bar. But if you don't want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3148" target="_blank">00:52:28.880</a></span> | <span class="t">that and you want it to just stay in the same place, you add leave equals true into this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3156" target="_blank">00:52:36.000</a></span> | <span class="t">here. So after that, we need to go through each batch within our loop. And the first thing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3166" target="_blank">00:52:46.320</a></span> | <span class="t">we need to do is set all of our calculated gradients to zero. So with every iteration</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3176" target="_blank">00:52:56.320</a></span> | <span class="t">that we go through here or every batch, at the end of it, we are going to calculate gradients,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3180" target="_blank">00:53:00.720</a></span> | <span class="t">which tells the model in which direction to change the weights within the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3187" target="_blank">00:53:07.200</a></span> | <span class="t">And obviously, when we go into the next iteration, we don't want those gradients to still be there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3194" target="_blank">00:53:14.320</a></span> | <span class="t">So all we're doing here is re-initializing those gradients at the start of every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3199" target="_blank">00:53:19.920</a></span> | <span class="t">loop. So we have a fresh set of gradients to work with every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3205" target="_blank">00:53:25.200</a></span> | <span class="t">And here, we just want to pull in our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3208" target="_blank">00:53:28.320</a></span> | <span class="t">So this is everything that is relevant that we're going to be feeding into the training process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3214" target="_blank">00:53:34.880</a></span> | <span class="t">So we have everything within our batch. And then in here, we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3222" target="_blank">00:53:42.400</a></span> | <span class="t">all of our different items. So we can actually see-- go here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3230" target="_blank">00:53:50.960</a></span> | <span class="t">We want to add in all of these. And we also want to move them across to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3244" target="_blank">00:54:04.000</a></span> | <span class="t">GPU, in my case, or whatever device you are working on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3252" target="_blank">00:54:12.080</a></span> | <span class="t">And we'll do that for the attention mask start positions and end positions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3277" target="_blank">00:54:37.120</a></span> | <span class="t">So these start and end positions are essentially the labels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3281" target="_blank">00:54:41.200</a></span> | <span class="t">they're the targets that we want our model to optimize for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3284" target="_blank">00:54:44.400</a></span> | <span class="t">And the input IDs and attention masks are the inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3306" target="_blank">00:55:06.880</a></span> | <span class="t">So now we have those defined. We just need to feed them into our model for training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3311" target="_blank">00:55:11.600</a></span> | <span class="t">And we will output the results of that training batch to the outputs variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3319" target="_blank">00:55:19.280</a></span> | <span class="t">So our model, input IDs, need the attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3336" target="_blank">00:55:36.560</a></span> | <span class="t">And we also want our start positions and end positions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3342" target="_blank">00:55:42.880</a></span> | <span class="t">Now, from our training batch, we want to extract the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3362" target="_blank">00:56:02.480</a></span> | <span class="t">And then we want to calculate loss for every parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3366" target="_blank">00:56:06.160</a></span> | <span class="t">And this is for our gradient update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3373" target="_blank">00:56:13.120</a></span> | <span class="t">And then we use the step method here to actually update those gradient updates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3386" target="_blank">00:56:26.080</a></span> | <span class="t">And then we use the step method here to actually update those gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3390" target="_blank">00:56:30.400</a></span> | <span class="t">And then this final little bit here is purely for us to see, this is our progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3398" target="_blank">00:56:38.640</a></span> | <span class="t">So we call it a loop. We set the description, which is going to be our epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3404" target="_blank">00:56:44.480</a></span> | <span class="t">And then it would probably be quite useful to also see the loss in there as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3408" target="_blank">00:56:48.720</a></span> | <span class="t">We will set that as a postfix. So it will appear after the progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3426" target="_blank">00:57:06.960</a></span> | <span class="t">Okay, and that should be everything. Okay, so that looks pretty good. We have our model training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3434" target="_blank">00:57:14.160</a></span> | <span class="t">And as I said, this will take a little bit of time. So I will let that run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3441" target="_blank">00:57:21.280</a></span> | <span class="t">And then we will go back to the model and we will run the training batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3451" target="_blank">00:57:31.760</a></span> | <span class="t">So I will let that run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3453" target="_blank">00:57:33.920</a></span> | <span class="t">Okay, so we have this non-type error here. And this is because within our mPositions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3468" target="_blank">00:57:48.240</a></span> | <span class="t">we will normally expect integers, but we're also getting some non-values because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3472" target="_blank">00:57:52.880</a></span> | <span class="t">code that we used earlier, where we're checking if mPosition is non, essentially wasn't good enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3479" target="_blank">00:57:59.760</a></span> | <span class="t">So as a fix for that, we'll just go back and we'll add like a while loop, which will keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3486" target="_blank">00:58:06.240</a></span> | <span class="t">checking if it's non. And every time it is non, reduce the value that we are seeing by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3492" target="_blank">00:58:12.480</a></span> | <span class="t">So go back up here, and this is where the problem is coming from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3501" target="_blank">00:58:21.040</a></span> | <span class="t">So we're just going to change this to be a while loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3509" target="_blank">00:58:29.520</a></span> | <span class="t">And just initialize essentially a counter here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3512" target="_blank">00:58:32.800</a></span> | <span class="t">And we'll use this as our go back value. And every time the mPosition is still non,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3525" target="_blank">00:58:45.600</a></span> | <span class="t">we'll just add one to go back. And this should work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3531" target="_blank">00:58:51.680</a></span> | <span class="t">So we need to remember to rerun anything we need to rerun. Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3558" target="_blank">00:59:18.720</a></span> | <span class="t">Okay. And that looks like it solved the issue. So great. We can just leave that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3565" target="_blank">00:59:25.920</a></span> | <span class="t">training for a little while and I will see you when it's done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3569" target="_blank">00:59:29.920</a></span> | <span class="t">Okay. So the model's finished and we'll go ahead and just save it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3578" target="_blank">00:59:38.240</a></span> | <span class="t">So obviously we'll need to do that whenever actually doing this on any other projects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3587" target="_blank">00:59:47.120</a></span> | <span class="t">So I'm just going to call it the Silbert custom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3589" target="_blank">00:59:49.120</a></span> | <span class="t">And it's super easy to save. We just do save pre-trained and the model path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3600" target="_blank">01:00:00.160</a></span> | <span class="t">Now, as well as this, we might also want to save the tokenizer so we have everything in one place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3610" target="_blank">01:00:10.080</a></span> | <span class="t">So to do that, we also just use tokenizer and save pre-trained again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3616" target="_blank">01:00:16.160</a></span> | <span class="t">Okay. So if we go back into our folder here, see models, and we have this Silbert custom. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3629" target="_blank">01:00:29.680</a></span> | <span class="t">in here we have all of the files we need to build our PyTorch model. It's a little bit different if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3637" target="_blank">01:00:37.760</a></span> | <span class="t">we're using TensorFlow, but the actual saving process is practically the same. So now we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3645" target="_blank">01:00:45.680</a></span> | <span class="t">finished training. We want to switch it out of the training mode. So we use a model eval.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3651" target="_blank">01:00:51.840</a></span> | <span class="t">And we just get all this information about our model as well. We don't actually need any of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3660" target="_blank">01:01:00.480</a></span> | <span class="t">And just like before, we want to create a data loader. So for that, I'm just going to call it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3668" target="_blank">01:01:08.240</a></span> | <span class="t">ValLoader. And it's exactly the same code as before. In fact, it's probably better if we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3673" target="_blank">01:01:13.760</a></span> | <span class="t">copy and paste some of this. At least the loop. So what we're going to do here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3684" target="_blank">01:01:24.960</a></span> | <span class="t">take the same loop and apply it as a validation run with our validation data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3691" target="_blank">01:01:31.920</a></span> | <span class="t">Just paste up there. We'll initialize this data loader. This time, of course, with the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3697" target="_blank">01:01:37.600</a></span> | <span class="t">set. We'll start with the same batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3707" target="_blank">01:01:47.440</a></span> | <span class="t">Now, this time, we do want to keep a log of accuracy. So we will keep that there. And we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3715" target="_blank">01:01:55.680</a></span> | <span class="t">also don't need to run multiple epochs because we're not training this time. We're just running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3720" target="_blank">01:02:00.640</a></span> | <span class="t">through all of the batches within our loop of validation data. So this is now a validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3727" target="_blank">01:02:07.760</a></span> | <span class="t">loader. And we just loop through each of those batches. So we don't need to do anything with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3733" target="_blank">01:02:13.920</a></span> | <span class="t">the gradients here. And because we're not doing anything with the gradients, we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3741" target="_blank">01:02:21.360</a></span> | <span class="t">have this in to stop PyTorch from calculating any gradients. Because this will obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3749" target="_blank">01:02:29.440</a></span> | <span class="t">save us a bit of time when we're processing all of this. And we put those in there. The</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3757" target="_blank">01:02:37.760</a></span> | <span class="t">outputs, we do still want this. But of course, we don't need to be putting in the start and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3764" target="_blank">01:02:44.560</a></span> | <span class="t">end positions. So we can remove those. And this time, we want to pull out the start prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3773" target="_blank">01:02:53.360</a></span> | <span class="t">and end prediction. So if we have a look at what our outputs look like before, you see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3782" target="_blank">01:03:02.000</a></span> | <span class="t">we have this model output. And within here, we have a few different tensors which each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3789" target="_blank">01:03:09.680</a></span> | <span class="t">have an accessible name. So the ones that we care about are start logits. And that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3801" target="_blank">01:03:21.520</a></span> | <span class="t">give us the logits for our start position, which is essentially like a set of predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3810" target="_blank">01:03:30.880</a></span> | <span class="t">where the highest value within that vector represents the token ID. So we can do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3819" target="_blank">01:03:39.200</a></span> | <span class="t">for both. And you'll see we get these tensors. Now, we only want the largest value in each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3830" target="_blank">01:03:50.640</a></span> | <span class="t">one of these vectors here, because that will give us the input ID. So to get that, we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3837" target="_blank">01:03:57.800</a></span> | <span class="t">the argmax function. And if we just use it by itself, that will give us the maximum index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3849" target="_blank">01:04:09.480</a></span> | <span class="t">within the whole thing. But we don't want that. We want one for every single vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3855" target="_blank">01:04:15.000</a></span> | <span class="t">or every row. And to do that, we just set dim equal to 1. And there you go. We get a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3863" target="_blank">01:04:23.480</a></span> | <span class="t">full batch of outputs. So these are our starting positions. And then we also want to do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3870" target="_blank">01:04:30.760</a></span> | <span class="t">same for our ending positions. So we just change start to end. So it's pretty easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3883" target="_blank">01:04:43.500</a></span> | <span class="t">Now obviously, we want to be doing this within our loop, because this is only doing one batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3890" target="_blank">01:04:50.860</a></span> | <span class="t">And we need to do this for every single batch. So we're just going to assign them to a variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3909" target="_blank">01:05:09.260</a></span> | <span class="t">And there we have our predictions. And all we need to do now is check for an exact match.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3917" target="_blank">01:05:17.680</a></span> | <span class="t">So what I mean by exact match is we want to see whether the start positions here, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3924" target="_blank">01:05:24.320</a></span> | <span class="t">we can rename to the true values, whether these are equal to the predicted values down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3933" target="_blank">01:05:33.260</a></span> | <span class="t">here. And to calculate that, so let me just run this so we have one batch. That shouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3946" target="_blank">01:05:46.060</a></span> | <span class="t">take too long to process, and we can just write the code out. So to check this, we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3951" target="_blank">01:05:51.700</a></span> | <span class="t">use the double equal syntax here. And this will just check for matches between two arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3963" target="_blank">01:06:03.460</a></span> | <span class="t">So we have the startPredictions and the startTrueValues. So we'll check for those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3982" target="_blank">01:06:22.340</a></span> | <span class="t">So if we just have a look at what we have here, we get this array of true or false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3988" target="_blank">01:06:28.540</a></span> | <span class="t">So these ones don't look particularly good. But that's fine. We just want to calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=3993" target="_blank">01:06:33.020</a></span> | <span class="t">the accuracy here. So let's take the sum, and we also want to divide that by the length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4012" target="_blank">01:06:52.340</a></span> | <span class="t">Okay so that will give us our accuracy within the tensor. And we just take it out using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4017" target="_blank">01:06:57.660</a></span> | <span class="t">the item method. But we also just need to include brackets around this, because at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4023" target="_blank">01:07:03.540</a></span> | <span class="t">moment we're trying to take item of the length value. Okay and then that gives us our very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4030" target="_blank">01:07:10.660</a></span> | <span class="t">poor accuracy on this final batch. So we can take that, and within here we want to append</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4038" target="_blank">01:07:18.060</a></span> | <span class="t">that to our accuracy list. And then we also want to do that for the endPrediction as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4065" target="_blank">01:07:45.700</a></span> | <span class="t">And we'll just let that run through, and then we can calculate our accuracy from the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4070" target="_blank">01:07:50.580</a></span> | <span class="t">of that. And then we can have a quick look at our accuracy here. And we can see fortunately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4079" target="_blank">01:07:59.020</a></span> | <span class="t">it's not as bad as it first seemed. So we're getting a lot of 93, 100%, 81%. That's generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4089" target="_blank">01:08:09.300</a></span> | <span class="t">pretty good. So of course if we want to get the overall accuracy, all we do is sum that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4102" target="_blank">01:08:22.420</a></span> | <span class="t">and divide by the length. And we get 63.6% for an exact match accuracy. So what I mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4115" target="_blank">01:08:35.180</a></span> | <span class="t">by exact match is, say if we take a look at a few of these that do not match. So we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4123" target="_blank">01:08:43.900</a></span> | <span class="t">a 75% match on the fourth batch. Although that won't be particularly useful, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4132" target="_blank">01:08:52.940</a></span> | <span class="t">we can't see that batch right now. So let's just take the last batch, because we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4136" target="_blank">01:08:56.820</a></span> | <span class="t">these values here. Now if we look at what startTrue is, we get these values. Then if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4146" target="_blank">01:09:06.600</a></span> | <span class="t">we look at startPred, we get this. So none of these match, but a couple of them do get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4158" target="_blank">01:09:18.140</a></span> | <span class="t">pretty close. So these final four, all of these count as 0% on the exact match. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4166" target="_blank">01:09:26.560</a></span> | <span class="t">in reality, if you look at what we predicted, for every single one of them, it's predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4172" target="_blank">01:09:32.220</a></span> | <span class="t">just one token before. So it's getting quite close, but it's not an exact match. So it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4176" target="_blank">01:09:36.380</a></span> | <span class="t">scores 0. So when you consider that with our 63.6% accuracy here, that means that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4185" target="_blank">01:09:45.940</a></span> | <span class="t">model is actually probably doing pretty well. It's not perfect, of course, but it's doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4190" target="_blank">01:09:50.860</a></span> | <span class="t">pretty well. So overall, that's everything for this video. We've gone all the way through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4198" target="_blank">01:09:58.540</a></span> | <span class="t">this. If you do want the code for this, I'm going to make sure I keep a link to it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4203" target="_blank">01:10:03.580</a></span> | <span class="t">the description. So check that out if you just want to copy this across. But for now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ZIRmXkHp0-c&t=4210" target="_blank">01:10:10.180</a></span> | <span class="t">that's everything. So thank you very much for watching, and I will see you again soon.</span></div></div></body></html>