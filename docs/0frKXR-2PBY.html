<html><head><title>Lesson 9: Deep Learning Part 2 2018 - Multi-object detection</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 9: Deep Learning Part 2 2018 - Multi-object detection</h2><a href="https://www.youtube.com/watch?v=0frKXR-2PBY"><img src="https://i.ytimg.com/vi_webp/0frKXR-2PBY/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=55">0:55</a> Practice<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=94">1:34</a> Part 1 reminder<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=178">2:58</a> Data augmentations<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=348">5:48</a> Data augmentation example<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=432">7:12</a> Transform typein<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=574">9:34</a> DotSummary<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=641">10:41</a> Train a Neural Network<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1373">22:53</a> Multiobject Detection<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1528">25:28</a> Multilabel classification<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2240">37:20</a> Receptive field<br><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2930">48:50</a> Matching problem<br><br><div style="text-align: left;"><a href="./0frKXR-2PBY.html">Whisper Transcript</a> | <a href="./transcript_0frKXR-2PBY.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">So today we're going to continue working on object detection, which means that for every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6" target="_blank">00:00:06.880</a></span> | <span class="t">object in a photo in one of 20 classes, we're going to try and figure out what the object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=11" target="_blank">00:00:11.760</a></span> | <span class="t">is and what its bounding box is, such that we can apply that model to a new dataset of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=17" target="_blank">00:00:17.400</a></span> | <span class="t">unlabeled data and add those labels to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=21" target="_blank">00:00:21.800</a></span> | <span class="t">The general approach we're going to use is to start simple and gradually make it more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=27" target="_blank">00:00:27.120</a></span> | <span class="t">complicated so we started last week with a simple classifier, the three lines of closed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=32" target="_blank">00:00:32.800</a></span> | <span class="t">classifier, we then made it slightly more complex to turn it into a bounding box without</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=37" target="_blank">00:00:37.800</a></span> | <span class="t">a classifier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=38" target="_blank">00:00:38.800</a></span> | <span class="t">Today we're going to put those two pieces together to make a classifier plus a bounding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=43" target="_blank">00:00:43.000</a></span> | <span class="t">box, all of these are just for a single object, the largest object, and then from there we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=48" target="_blank">00:00:48.000</a></span> | <span class="t">going up to something closer to our final goal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=56" target="_blank">00:00:56.960</a></span> | <span class="t">You should go back and make sure that you understand all of these concepts from last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=61" target="_blank">00:01:01.240</a></span> | <span class="t">week before you move on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=63" target="_blank">00:01:03.000</a></span> | <span class="t">If you don't, go back and re-go through the notebooks carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=67" target="_blank">00:01:07.200</a></span> | <span class="t">I won't read them all to you because you can see them in the video easily enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=71" target="_blank">00:01:11.560</a></span> | <span class="t">Perhaps this is the most important, knowing how to jump around source code in whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=76" target="_blank">00:01:16.960</a></span> | <span class="t">editor you prefer to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=79" target="_blank">00:01:19.800</a></span> | <span class="t">At plotlet, lambda function is also particularly important, they come up everywhere, and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=88" target="_blank">00:01:28.960</a></span> | <span class="t">idea of a custom head is also going to come up in pretty much every lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=95" target="_blank">00:01:35.960</a></span> | <span class="t">I've also added here a reminder of what you should know from part one of the course because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=101" target="_blank">00:01:41.040</a></span> | <span class="t">quite often I see questions on the forum asking, basically, why isn't my model working?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=107" target="_blank">00:01:47.880</a></span> | <span class="t">Why doesn't it start training or, having trained, why doesn't it seem to be in use?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=114" target="_blank">00:01:54.480</a></span> | <span class="t">And nearly always, the answer to the question is, did you print out the inputs to it from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=121" target="_blank">00:02:01.160</a></span> | <span class="t">a data loader?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=122" target="_blank">00:02:02.920</a></span> | <span class="t">Did you print out the outputs from it after evaluating it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=128" target="_blank">00:02:08.840</a></span> | <span class="t">And normally the answer is no, when they try printing it and it turns out all the inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=131" target="_blank">00:02:11.960</a></span> | <span class="t">are zero or all of the outputs are negative or it's really obvious.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=136" target="_blank">00:02:16.200</a></span> | <span class="t">So that's just something I wanted to remind you about, you need to know how to do these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=141" target="_blank">00:02:21.240</a></span> | <span class="t">two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=142" target="_blank">00:02:22.240</a></span> | <span class="t">If you can't do that, then it's going to be very hard to debug models, and if you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=150" target="_blank">00:02:30.120</a></span> | <span class="t">do that, but you're not doing it, then it's going to be very hard for you to debug models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=154" target="_blank">00:02:34.960</a></span> | <span class="t">You don't debug models by staring at the source code hoping your error pops out, you debug</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=160" target="_blank">00:02:40.360</a></span> | <span class="t">models by checking all of the intermediate steps, looking at the data, printing it out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=167" target="_blank">00:02:47.400</a></span> | <span class="t">plotting its histogram, making sure it makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=177" target="_blank">00:02:57.440</a></span> | <span class="t">We were working through Pascal Notebook and we just quickly zipped through the bounding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=187" target="_blank">00:03:07.360</a></span> | <span class="t">box of the largest object without a classified part, and there was one bit that I skipped</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=193" target="_blank">00:03:13.000</a></span> | <span class="t">over and said I'd come back to, so let's do that now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=199" target="_blank">00:03:19.120</a></span> | <span class="t">Which is to talk about data augmentations of the y of the dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=209" target="_blank">00:03:29.520</a></span> | <span class="t">Before I do, I'll just mention something pretty awkward in all this, which is I've got here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=217" target="_blank">00:03:37.160</a></span> | <span class="t">image classifier data continuous equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=221" target="_blank">00:03:41.520</a></span> | <span class="t">This makes no sense whatsoever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=223" target="_blank">00:03:43.480</a></span> | <span class="t">A classifier is anything where the dependent variable is categorical or binomial, as opposed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=230" target="_blank">00:03:50.640</a></span> | <span class="t">to regression, which is anything where the dependent variable is continuous.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=236" target="_blank">00:03:56.160</a></span> | <span class="t">And yet this parameter here, continuous equals true, says that the dependent variable is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=240" target="_blank">00:04:00.760</a></span> | <span class="t">continuous.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=241" target="_blank">00:04:01.760</a></span> | <span class="t">So this claims to be creating data for a classifier where the dependent is continuous.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=247" target="_blank">00:04:07.840</a></span> | <span class="t">This is the kind of awkward rough edge that you see when we're kind of at the edge of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=255" target="_blank">00:04:15.740</a></span> | <span class="t">the fast AI code that's not quite solidified yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=259" target="_blank">00:04:19.920</a></span> | <span class="t">So probably by the time you watch this in the MOOC, this will be sorted out, and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=263" target="_blank">00:04:23.200</a></span> | <span class="t">will be called image regressor data or something like that, but I just wanted to kind of point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=269" target="_blank">00:04:29.960</a></span> | <span class="t">out this issue, and also because sometimes people are getting confused between regression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=274" target="_blank">00:04:34.600</a></span> | <span class="t">vs. classification, and this is not going to help one bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=281" target="_blank">00:04:41.240</a></span> | <span class="t">So let's create some data augmentations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=284" target="_blank">00:04:44.120</a></span> | <span class="t">Normally when we create data augmentations, we tend to type in transform_side_on or transform_top_dem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=292" target="_blank">00:04:52.880</a></span> | <span class="t">But if you look inside the fast_ai.transforms module, you'll see that they are simply defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=298" target="_blank">00:04:58.520</a></span> | <span class="t">as a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=299" target="_blank">00:04:59.520</a></span> | <span class="t">So transform_basic is 10 degree rotations plus 0.05 brightness and contrast, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=306" target="_blank">00:05:06.640</a></span> | <span class="t">side_on adds to that random horizontal flips, or else top_down adds to that random dihedral</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=314" target="_blank">00:05:14.360</a></span> | <span class="t">group of asymmetry flips, which basically means every possible 90 degree rotation optionally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=319" target="_blank">00:05:19.800</a></span> | <span class="t">with a flip, so eight possibilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=324" target="_blank">00:05:24.000</a></span> | <span class="t">So these are just little shortcuts that I added because they seem to be useful a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=329" target="_blank">00:05:29.320</a></span> | <span class="t">of the time, but you can always create your own list of augmentations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=335" target="_blank">00:05:35.080</a></span> | <span class="t">And if you're not sure what augmentations are there, you can obviously check the fast_ai</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=339" target="_blank">00:05:39.800</a></span> | <span class="t">source, or if you just start typing random, they all start with random, so you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=345" target="_blank">00:05:45.360</a></span> | <span class="t">them easily enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=349" target="_blank">00:05:49.120</a></span> | <span class="t">So let's take a look at what happens if we create some data augmentations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=354" target="_blank">00:05:54.840</a></span> | <span class="t">Let's create a model data object, and let's just go through and rerun the iterator a bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=365" target="_blank">00:06:05.280</a></span> | <span class="t">of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=366" target="_blank">00:06:06.780</a></span> | <span class="t">And we'll do two things, we'll print out the bounding boxes, and we'll also draw the pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=377" target="_blank">00:06:17.320</a></span> | <span class="t">So you'll see this lady is, as we would expect, flipping around and spinning around and getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=383" target="_blank">00:06:23.360</a></span> | <span class="t">darker and lighter, but the bounding box, A, is not moving, and B is in the wrong spot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=391" target="_blank">00:06:31.340</a></span> | <span class="t">So this is the problem with data augmentation when your dependent variable is pixel values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=400" target="_blank">00:06:40.800</a></span> | <span class="t">or is in some way connected to your independent variable, the two need to be augmented together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=406" target="_blank">00:06:46.440</a></span> | <span class="t">And in fact, you can see that from the printout these numbers are bigger than 224, but these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=411" target="_blank">00:06:51.760</a></span> | <span class="t">images are of size 224, that's what we requested in these transforms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=417" target="_blank">00:06:57.240</a></span> | <span class="t">And so it's not even being scaled or cropped or anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=421" target="_blank">00:07:01.800</a></span> | <span class="t">So you can see that our dependent variable needs to go through all of the same geometric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=427" target="_blank">00:07:07.360</a></span> | <span class="t">transformations as our independent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=430" target="_blank">00:07:10.520</a></span> | <span class="t">So to do that, every transformation has an optional transform Y parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=440" target="_blank">00:07:20.400</a></span> | <span class="t">It takes a transform type enum, the transform type enum has a few options, all of which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=447" target="_blank">00:07:27.680</a></span> | <span class="t">we'll cover in this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=450" target="_blank">00:07:30.160</a></span> | <span class="t">The co-ord option says that the Y values represent coordinates, in this case bounding box coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=459" target="_blank">00:07:39.160</a></span> | <span class="t">And so therefore if you flip, you need to change the coordinate to represent that flip, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=464" target="_blank">00:07:44.000</a></span> | <span class="t">if you rotate, you have to change the coordinate to represent that rotation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=467" target="_blank">00:07:47.200</a></span> | <span class="t">So I can add transform type or co-ord to all of my augmentations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=472" target="_blank">00:07:52.160</a></span> | <span class="t">I also have to add the exact same thing to my transforms from model function, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=477" target="_blank">00:07:57.080</a></span> | <span class="t">that's the thing that does the cropping and zooming and padding and resizing, and all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=484" target="_blank">00:08:04.400</a></span> | <span class="t">of those things need to happen to the dependent variable as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=487" target="_blank">00:08:07.860</a></span> | <span class="t">So if we add all of those together and rerun this, you'll see the bounding box changes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=492" target="_blank">00:08:12.640</a></span> | <span class="t">each time, and you'll see it's in the right spot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=497" target="_blank">00:08:17.720</a></span> | <span class="t">Now you'll see sometimes it looks a little odd, like here, why is that bounding box there?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=504" target="_blank">00:08:24.360</a></span> | <span class="t">And the problem is, this is just a constraint of the information we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=509" target="_blank">00:08:29.440</a></span> | <span class="t">The bounding box does not tell us that actually her head isn't way over here in the top left</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=514" target="_blank">00:08:34.320</a></span> | <span class="t">corner, but actually if you do a 30 degree rotation and her head was over here in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=518" target="_blank">00:08:38.640</a></span> | <span class="t">top left corner, then the new bounding box would go really high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=523" target="_blank">00:08:43.820</a></span> | <span class="t">So this is actually the correct bounding box based on the information it has available,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=529" target="_blank">00:08:49.820</a></span> | <span class="t">which is to say this is how high she might have been.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=533" target="_blank">00:08:53.920</a></span> | <span class="t">So basically you've got to be careful of not doing too high rotations with bounding boxes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=539" target="_blank">00:08:59.300</a></span> | <span class="t">because there's not enough information for them to stay totally accurate, just the fundamental</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=544" target="_blank">00:09:04.320</a></span> | <span class="t">limitation of the information we're given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=546" target="_blank">00:09:06.840</a></span> | <span class="t">If we were doing polygons, or segmentations, or whatever, we wouldn't have this problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=555" target="_blank">00:09:15.080</a></span> | <span class="t">So I'm going to do a maximum of 3 degree rotations to avoid that problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=562" target="_blank">00:09:22.920</a></span> | <span class="t">I'm also going to only rotate half the time, I'm going to have my random flip and my brightness</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=569" target="_blank">00:09:29.360</a></span> | <span class="t">and contrast changing, so there's my set of transformations that I can use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=575" target="_blank">00:09:35.680</a></span> | <span class="t">So we briefly looked at this custom head idea, but basically if you look at dot summary, dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=582" target="_blank">00:09:42.920</a></span> | <span class="t">summary does something pretty cool which basically runs a small batch of data through a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=588" target="_blank">00:09:48.240</a></span> | <span class="t">and prints out how big it is at every layer, and we can see that at the end of the convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=596" target="_blank">00:09:56.780</a></span> | <span class="t">section before we hit the flatten, it's 512 x 7 x 7, and so 512 x 7 x 7, a tensor, a rank</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=606" target="_blank">00:10:06.960</a></span> | <span class="t">3 tensor of that size, if we flatten it out into a single rank 1 tensor into a vector,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=613" target="_blank">00:10:13.440</a></span> | <span class="t">it's going to be 25,098 long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=617" target="_blank">00:10:17.800</a></span> | <span class="t">So then that's why we had this linear layer, 2.5.0 to 4, because there's 4 bounding boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=625" target="_blank">00:10:25.780</a></span> | <span class="t">So stick that on top of a pre-trained ResNet and train it for a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=635" target="_blank">00:10:35.400</a></span> | <span class="t">So that's where we got to last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=638" target="_blank">00:10:38.820</a></span> | <span class="t">So let's now put those two pieces together so that we can get something that classifies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=645" target="_blank">00:10:45.920</a></span> | <span class="t">and does bounding boxes, and there are three things that we need to do basically to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=657" target="_blank">00:10:57.600</a></span> | <span class="t">a neural network ever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=660" target="_blank">00:11:00.400</a></span> | <span class="t">We need to provide data, we need to pick some kind of architecture, and we need a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=674" target="_blank">00:11:14.460</a></span> | <span class="t">So the loss function says anything that gives a lower number here is a better network using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=682" target="_blank">00:11:22.400</a></span> | <span class="t">this data and this architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=685" target="_blank">00:11:25.200</a></span> | <span class="t">So we're going to need to create those three things for our classification plus bounding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=689" target="_blank">00:11:29.900</a></span> | <span class="t">box regression.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=693" target="_blank">00:11:33.960</a></span> | <span class="t">So that means we need a model data object which has the independence, the images, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=702" target="_blank">00:11:42.640</a></span> | <span class="t">the dependence, so when I have a tuple, the first element of the tuple should be the bounding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=707" target="_blank">00:11:47.520</a></span> | <span class="t">box coordinates, and the second element of the tuple should be the class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=715" target="_blank">00:11:55.240</a></span> | <span class="t">There's lots of different ways you could do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=717" target="_blank">00:11:57.160</a></span> | <span class="t">The particularly lazy and convenient way I came up with was to create two model data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=724" target="_blank">00:12:04.200</a></span> | <span class="t">objects representing the two different dependent variables I want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=729" target="_blank">00:12:09.560</a></span> | <span class="t">So one with the bounding box coordinates, one with the classes, just using the CSB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=736" target="_blank">00:12:16.840</a></span> | <span class="t">And now I'm going to merge them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=739" target="_blank">00:12:19.840</a></span> | <span class="t">So I create a new data set class, and a data set class is anything which has a length and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=747" target="_blank">00:12:27.480</a></span> | <span class="t">an indexer, so something that lets you use it in square brackets like a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=751" target="_blank">00:12:31.840</a></span> | <span class="t">And so in this case I can have a constructor which takes an existing data set, so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=758" target="_blank">00:12:38.520</a></span> | <span class="t">going to have both an independent and a dependent, and the second dependent that I want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=768" target="_blank">00:12:48.480</a></span> | <span class="t">The length then is just obviously the length of the data set, the first data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=773" target="_blank">00:12:53.880</a></span> | <span class="t">And then getItem is grab the x and the y from the data set that I passed in, and return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=781" target="_blank">00:13:01.400</a></span> | <span class="t">that x and that y and the i-th value of the second dependent variable that I passed in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=789" target="_blank">00:13:09.400</a></span> | <span class="t">So there's a data set that basically adds in a second dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=793" target="_blank">00:13:13.760</a></span> | <span class="t">As I said, there's lots of ways you could do this, but it's kind of convenient because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=797" target="_blank">00:13:17.800</a></span> | <span class="t">now what I could do is create a training data set and a validation data set based on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=805" target="_blank">00:13:25.000</a></span> | <span class="t">So here's an example, it's got a tuple of the bounding box coordinates in the class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=812" target="_blank">00:13:32.320</a></span> | <span class="t">We can then take the existing training and validation data loaders and actually replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=815" target="_blank">00:13:35.920</a></span> | <span class="t">their data sets with these, and I'm done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=820" target="_blank">00:13:40.200</a></span> | <span class="t">So we can now test it by grabbing a mini-batch of data and checking that we have something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=826" target="_blank">00:13:46.280</a></span> | <span class="t">that makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=828" target="_blank">00:13:48.200</a></span> | <span class="t">So there's one way to customize a data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=835" target="_blank">00:13:55.600</a></span> | <span class="t">So what we're going to do this time now is we've got the data, so now we need an architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=842" target="_blank">00:14:02.040</a></span> | <span class="t">So the architecture is going to be the same as the architectures that we used for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=847" target="_blank">00:14:07.200</a></span> | <span class="t">classifier and for the bounding box regression, but we're just going to combine them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=851" target="_blank">00:14:11.680</a></span> | <span class="t">So in other words, if there are c classes, then the number of activations we need in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=859" target="_blank">00:14:19.680</a></span> | <span class="t">the final layer is 4 plus c.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=862" target="_blank">00:14:22.960</a></span> | <span class="t">We've got the 4 bounding box coordinates and the c probabilities 1/3 class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=869" target="_blank">00:14:29.460</a></span> | <span class="t">So this is the final layer, a linear layer that has 4 plus len of categories activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=878" target="_blank">00:14:38.320</a></span> | <span class="t">The first layer is before is a flatten.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=882" target="_blank">00:14:42.100</a></span> | <span class="t">We could just join those up together, but in general I want my custom head to hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=891" target="_blank">00:14:51.680</a></span> | <span class="t">be capable of solving the problem that I give it on its own if the pre-trained backbone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=899" target="_blank">00:14:59.360</a></span> | <span class="t">it's connected to is appropriate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=903" target="_blank">00:15:03.680</a></span> | <span class="t">And so in this case I'm thinking I'm trying to do quite a bit here, two different things,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=908" target="_blank">00:15:08.400</a></span> | <span class="t">the classifier and bounding box regression.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=910" target="_blank">00:15:10.760</a></span> | <span class="t">So just a single linear layer doesn't sound like enough, so I put in a second linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=916" target="_blank">00:15:16.880</a></span> | <span class="t">And so you can see we basically go relu, dropout, lenia, relu, batchnorm, dropout, lenia.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=924" target="_blank">00:15:24.040</a></span> | <span class="t">If you're wondering why there's no batchnorm back here, I checked the resnet backbone,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=928" target="_blank">00:15:28.560</a></span> | <span class="t">it already has a batchnorm as its final layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=933" target="_blank">00:15:33.460</a></span> | <span class="t">So this is basically nearly the same custom head as before, it's just got two linear layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=940" target="_blank">00:15:40.140</a></span> | <span class="t">rather than one and the appropriate nonlinearities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=945" target="_blank">00:15:45.840</a></span> | <span class="t">So that's piece 2, we've got theta, we've got architecture, now we need a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=952" target="_blank">00:15:52.980</a></span> | <span class="t">So the loss function needs to look at these 4 plus c activations and decide are they good?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=962" target="_blank">00:16:02.040</a></span> | <span class="t">Are these numbers accurately reflecting the position and class of the largest object in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=970" target="_blank">00:16:10.520</a></span> | <span class="t">this image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=974" target="_blank">00:16:14.240</a></span> | <span class="t">We know how to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=978" target="_blank">00:16:18.480</a></span> | <span class="t">For the first 4 we use L1 loss, just like we did in the bounding box regression before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=985" target="_blank">00:16:25.560</a></span> | <span class="t">Remember L1 loss is like mean squared error, the sum of squareds is the sum of those values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=993" target="_blank">00:16:33.360</a></span> | <span class="t">And then for the rest of the activations we can use cross-entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=998" target="_blank">00:16:38.900</a></span> | <span class="t">So let's go ahead and do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1000" target="_blank">00:16:40.200</a></span> | <span class="t">So we're going to create something called detection_loss, and loss functions always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1004" target="_blank">00:16:44.440</a></span> | <span class="t">take an input and a target, that's what PyTorch always calls them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1009" target="_blank">00:16:49.120</a></span> | <span class="t">So this is the activations, this is the ground truth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1013" target="_blank">00:16:53.600</a></span> | <span class="t">So remember that our custom dataset returns a tuple containing the bounding box coordinates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1023" target="_blank">00:17:03.480</a></span> | <span class="t">and the classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1024" target="_blank">00:17:04.720</a></span> | <span class="t">So we can destructure that, use destructuring assignment to grab the bounding boxes and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1030" target="_blank">00:17:10.020</a></span> | <span class="t">the classes of the target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1033" target="_blank">00:17:13.920</a></span> | <span class="t">And then the bounding boxes and the classes of the input are simply the first 4 elements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1041" target="_blank">00:17:21.680</a></span> | <span class="t">of the input and the 4 onwards elements of the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1046" target="_blank">00:17:26.540</a></span> | <span class="t">And remember we've also got a batch dimension that we need to grab the whole thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1052" target="_blank">00:17:32.200</a></span> | <span class="t">So that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1053" target="_blank">00:17:33.200</a></span> | <span class="t">We've now got the bounding box target, bounding box input, class target, class input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1058" target="_blank">00:17:38.480</a></span> | <span class="t">For the bounding boxes we know that they're going to be between 0 and 224, the coordinates,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1064" target="_blank">00:17:44.000</a></span> | <span class="t">because that's how big our image is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1066" target="_blank">00:17:46.720</a></span> | <span class="t">So let's grab a sigmoid to force it between 0 and 1, multiply it by 224, and that's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1074" target="_blank">00:17:54.260</a></span> | <span class="t">helping our neural net get close to what we -- be in the range we know it has to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1082" target="_blank">00:18:02.600</a></span> | <span class="t">As a general rule, is it better to put batch norm before or after a relu?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1090" target="_blank">00:18:10.600</a></span> | <span class="t">I would suggest that you should put it after a relu, because batch norm is meant to move</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1099" target="_blank">00:18:19.560</a></span> | <span class="t">towards a 0 and 1 random variable, and if you put relu after it, then you're truncating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1106" target="_blank">00:18:26.560</a></span> | <span class="t">it at 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1110" target="_blank">00:18:30.520</a></span> | <span class="t">So there's no way to create negative numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1112" target="_blank">00:18:32.640</a></span> | <span class="t">But if you put relu and then batch norm, it does have that ability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1121" target="_blank">00:18:41.480</a></span> | <span class="t">Having said that -- and I think that way of doing it gives slightly better results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1129" target="_blank">00:18:49.440</a></span> | <span class="t">Having said that, it's not too big a deal either way, and you'll see during this part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1135" target="_blank">00:18:55.320</a></span> | <span class="t">of the course, most of the time I go relu and then batch norm, but sometimes I go batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1142" target="_blank">00:19:02.120</a></span> | <span class="t">norm and then relu if I'm trying to be consistent with a paper or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1146" target="_blank">00:19:06.680</a></span> | <span class="t">I think originally the batch norm was put after the activation, so there's still people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1152" target="_blank">00:19:12.240</a></span> | <span class="t">who do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1154" target="_blank">00:19:14.000</a></span> | <span class="t">So this is kind of to help our data or force our data into the right range, which if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1160" target="_blank">00:19:20.580</a></span> | <span class="t">can do stuff like that, it makes it easier to train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1163" target="_blank">00:19:23.000</a></span> | <span class="t">Yes, Rachel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1164" target="_blank">00:19:24.000</a></span> | <span class="t">One more question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1165" target="_blank">00:19:25.000</a></span> | <span class="t">What's the intuition behind using dropout with p=0.5 after a batch norm?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1170" target="_blank">00:19:30.680</a></span> | <span class="t">Doesn't batch norm already do a good job of regularizing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1176" target="_blank">00:19:36.160</a></span> | <span class="t">Batch norm does an okay job of regularizing, but if you think back to part 1, we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1180" target="_blank">00:19:40.160</a></span> | <span class="t">to have that list of things we do to avoid overfitting, and adding batch norm is one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1185" target="_blank">00:19:45.700</a></span> | <span class="t">of them, that's data augmentation, but it's perfectly possible that you'll still be overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1193" target="_blank">00:19:53.360</a></span> | <span class="t">So one nice thing about dropout is that it has a parameter to say how much to drop out,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1199" target="_blank">00:19:59.000</a></span> | <span class="t">so parameters are great, or specifically parameters that decide how much to regularize are great,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1205" target="_blank">00:20:05.520</a></span> | <span class="t">because it lets you build a nice, big over-parameterized model and then decide how much to regularize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1211" target="_blank">00:20:11.920</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1212" target="_blank">00:20:12.920</a></span> | <span class="t">So I tend to always include dropout, and then if it turns out I'll start with p=0, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1221" target="_blank">00:20:21.720</a></span> | <span class="t">as I add new to add regularization, I can just change my dropout parameter without worrying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1227" target="_blank">00:20:27.880</a></span> | <span class="t">about if I saved a model, I want to be able to load it back, but if I had dropout layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1234" target="_blank">00:20:34.160</a></span> | <span class="t">in one and not in another, it would load me more, so this way it stays consistent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1239" target="_blank">00:20:39.960</a></span> | <span class="t">So now that I've got my inputs and targets, I can just go calculate the L1 loss and add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1245" target="_blank">00:20:45.840</a></span> | <span class="t">to it the cross entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1248" target="_blank">00:20:48.480</a></span> | <span class="t">So that's our loss function, surprisingly easy perhaps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1253" target="_blank">00:20:53.880</a></span> | <span class="t">Now of course the cross entropy and the L1 loss may be of wildly different scales, in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1259" target="_blank">00:20:59.720</a></span> | <span class="t">which case in the loss function the larger one is going to dominate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1263" target="_blank">00:21:03.840</a></span> | <span class="t">And so I just ran this in a debugger, checked how big each of the two things were, and found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1273" target="_blank">00:21:13.280</a></span> | <span class="t">if they multiply by 20, that makes them about the same scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1281" target="_blank">00:21:21.800</a></span> | <span class="t">That's your training, it's nice to print out information as you go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1286" target="_blank">00:21:26.840</a></span> | <span class="t">So I also grabbed the L1 part of this and put it in a function, and I also created a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1293" target="_blank">00:21:33.440</a></span> | <span class="t">function for accuracy, so that I could then make the metrics and print it out as it goes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1300" target="_blank">00:21:40.360</a></span> | <span class="t">So we've now got something which is printing out our object detection loss, detection accuracy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1306" target="_blank">00:21:46.120</a></span> | <span class="t">and detection L1, and so we've trained it for a while, and it's looking good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1314" target="_blank">00:21:54.200</a></span> | <span class="t">Add detection accuracy is in the low 80s, which is the same as what it was before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1319" target="_blank">00:21:59.600</a></span> | <span class="t">That doesn't surprise me because ResNet was designed to do classification, so I wouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1326" target="_blank">00:22:06.880</a></span> | <span class="t">expect us to be able to improve things in such a simple way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1332" target="_blank">00:22:12.760</a></span> | <span class="t">But it certainly wasn't designed to do bounding box regression, it was explicitly actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1336" target="_blank">00:22:16.480</a></span> | <span class="t">designed in such a way as to kind of not care about geometry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1342" target="_blank">00:22:22.160</a></span> | <span class="t">It takes that last 7x7 grid of activations and averages them all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1347" target="_blank">00:22:27.000</a></span> | <span class="t">It throws away all of the information about where things came from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1351" target="_blank">00:22:31.920</a></span> | <span class="t">So you can see that when we only trained the last layer, the detection L1 is pretty bad,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1359" target="_blank">00:22:39.960</a></span> | <span class="t">it's 24, and it really improves a lot, whereas the accuracy doesn't improve, it stays exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1366" target="_blank">00:22:46.560</a></span> | <span class="t">the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1367" target="_blank">00:22:47.560</a></span> | <span class="t">Interestingly, the L1, when we do accuracy and bounding box at the same time, adding .5,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1375" target="_blank">00:22:55.080</a></span> | <span class="t">seems like it's a little bit better than when we just do bounding box regression.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1380" target="_blank">00:23:00.920</a></span> | <span class="t">And if that's counterintuitive to you, then that would be one of the main things to think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1385" target="_blank">00:23:05.160</a></span> | <span class="t">about after this lesson, so it's a really important idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1388" target="_blank">00:23:08.240</a></span> | <span class="t">And the idea is this, figuring out what the main object in an image is, is kind of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1405" target="_blank">00:23:25.360</a></span> | <span class="t">hard part, and then figuring out exactly where the bounding box is and what class it is is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1411" target="_blank">00:23:31.400</a></span> | <span class="t">kind of the easy part in a way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1414" target="_blank">00:23:34.680</a></span> | <span class="t">And so when you've got a single network that's both saying what is the object and where is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1420" target="_blank">00:23:40.760</a></span> | <span class="t">the object, it's going to share all of the computation about finding the object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1427" target="_blank">00:23:47.720</a></span> | <span class="t">And so all that shared computation is very efficient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1433" target="_blank">00:23:53.360</a></span> | <span class="t">And so when we backpropagate the errors in the class and in the place, that's all information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1441" target="_blank">00:24:01.440</a></span> | <span class="t">that's going to help the computation around finding the biggest object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1445" target="_blank">00:24:05.800</a></span> | <span class="t">So anytime you've got multiple tasks which kind of share some concept of what those tasks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1453" target="_blank">00:24:13.680</a></span> | <span class="t">would need to do to complete their work, it's very likely they should share at least some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1459" target="_blank">00:24:19.200</a></span> | <span class="t">layers of the network together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1463" target="_blank">00:24:23.800</a></span> | <span class="t">And we'll look later today at a place where most of the layers are shared but the last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1472" target="_blank">00:24:32.280</a></span> | <span class="t">one isn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1475" target="_blank">00:24:35.600</a></span> | <span class="t">So you can see this is doing a good job as before of any time there's just a single major</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1482" target="_blank">00:24:42.120</a></span> | <span class="t">object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1484" target="_blank">00:24:44.800</a></span> | <span class="t">Sometimes it's getting a little confused, it thinks the main object here is the dog and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1488" target="_blank">00:24:48.360</a></span> | <span class="t">it's going to circle the dog, although it's kind of recognized that actually the main</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1491" target="_blank">00:24:51.560</a></span> | <span class="t">object is a sofa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1492" target="_blank">00:24:52.560</a></span> | <span class="t">So the classifier is doing the right thing with the bounding boxes labeling the wrong</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1496" target="_blank">00:24:56.360</a></span> | <span class="t">thing, which is kind of curious.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1500" target="_blank">00:25:00.160</a></span> | <span class="t">When there are two birds it can only pick one so it's just kind of hedging in the middle,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1504" target="_blank">00:25:04.560</a></span> | <span class="t">ditto and there's lots of cows and so forth, doing a good job with this kind of thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1510" target="_blank">00:25:10.040</a></span> | <span class="t">So that's that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1516" target="_blank">00:25:16.400</a></span> | <span class="t">There's not much new there, although in that last bit we did learn about some simple custom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1521" target="_blank">00:25:21.720</a></span> | <span class="t">data sets and simple custom lots functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1524" target="_blank">00:25:24.200</a></span> | <span class="t">Hopefully you can see now how easy that is to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1530" target="_blank">00:25:30.320</a></span> | <span class="t">So the next stage for me would be to do multi-label classifications.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1535" target="_blank">00:25:35.520</a></span> | <span class="t">This is this idea that I just want to keep building models that are slightly more complex</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1540" target="_blank">00:25:40.000</a></span> | <span class="t">than the last model but hopefully don't require too much extra concepts so I can keep seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1546" target="_blank">00:25:46.920</a></span> | <span class="t">things working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1547" target="_blank">00:25:47.920</a></span> | <span class="t">And if something stops working I know exactly where it worked, I'm not going to try and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1551" target="_blank">00:25:51.760</a></span> | <span class="t">build everything at the same time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1553" target="_blank">00:25:53.760</a></span> | <span class="t">So multi-label classification is so easy, there's not much to mention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1558" target="_blank">00:25:58.400</a></span> | <span class="t">So we've moved to Pascal Multi now, this is where we're going to do the multi-object stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1563" target="_blank">00:26:03.680</a></span> | <span class="t">So for the multi-object stuff, I've just copied and pasted the functions from the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1568" target="_blank">00:26:08.360</a></span> | <span class="t">notebook that we used, so they're all at the top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1572" target="_blank">00:26:12.580</a></span> | <span class="t">So we can create now a multi-class CSV file using the same basic approach that we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1583" target="_blank">00:26:23.000</a></span> | <span class="t">last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1584" target="_blank">00:26:24.640</a></span> | <span class="t">And I'll mention by the way, one of our students who's visiting from India, Fani, pointed out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1592" target="_blank">00:26:32.520</a></span> | <span class="t">to me that all this stuff we're doing with default dicks and stuff like that, he actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1599" target="_blank">00:26:39.980</a></span> | <span class="t">showed a way of doing it which was much simpler using pandas and he shared that on the forum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1605" target="_blank">00:26:45.040</a></span> | <span class="t">So I totally bow to his much better approach, a simpler, more concise approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1610" target="_blank">00:26:50.840</a></span> | <span class="t">It's definitely true, like the more you get to know pandas, the more often you realize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1616" target="_blank">00:26:56.160</a></span> | <span class="t">it's a good way to solve lots of different problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1620" target="_blank">00:27:00.520</a></span> | <span class="t">So definitely check that out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1631" target="_blank">00:27:11.280</a></span> | <span class="t">When you're building out the smaller models and you're iterating, do you reuse those models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1636" target="_blank">00:27:16.160</a></span> | <span class="t">as pre-trained weights for this larger one or do you just toss it all away and then retrain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1643" target="_blank">00:27:23.000</a></span> | <span class="t">from scratch?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1644" target="_blank">00:27:24.000</a></span> | <span class="t">When I'm figuring stuff out as I go like this, I would generally lean towards tossing away</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1650" target="_blank">00:27:30.360</a></span> | <span class="t">because the reusing pre-trained weights introduces complexities that I'm not really thinking about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1658" target="_blank">00:27:38.400</a></span> | <span class="t">However if I'm trying to get to a point where I can run something on really big images,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1663" target="_blank">00:27:43.120</a></span> | <span class="t">I'll generally start on much smaller ones and often I will reuse those weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1680" target="_blank">00:28:00.320</a></span> | <span class="t">So in this case what we're doing is joining up all of the classes with a space which gives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1686" target="_blank">00:28:06.080</a></span> | <span class="t">us a CSV in a normal format and once we've got the CSV in a normal format it's the usual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1690" target="_blank">00:28:10.120</a></span> | <span class="t">three lines of code and we train it and we print out the results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1696" target="_blank">00:28:16.840</a></span> | <span class="t">So there's literally nothing to show you there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1698" target="_blank">00:28:18.880</a></span> | <span class="t">And as you can see it's done a great job.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1700" target="_blank">00:28:20.800</a></span> | <span class="t">The only mistake I think it made was it called this dog where it should have been dog and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1705" target="_blank">00:28:25.680</a></span> | <span class="t">sofa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1706" target="_blank">00:28:26.680</a></span> | <span class="t">I think everything else is correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1709" target="_blank">00:28:29.580</a></span> | <span class="t">So multi-class classification is pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1715" target="_blank">00:28:35.640</a></span> | <span class="t">A minor tweak here is to note that I used a set here because I don't want to list all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1722" target="_blank">00:28:42.160</a></span> | <span class="t">of the objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1723" target="_blank">00:28:43.160</a></span> | <span class="t">I only want each object type to appear once and so the set plus is a way of depuplicating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1730" target="_blank">00:28:50.200</a></span> | <span class="t">a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1731" target="_blank">00:28:51.200</a></span> | <span class="t">So that's why I don't have person, person, person, person, person, just appears once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1736" target="_blank">00:28:56.260</a></span> | <span class="t">So these object classification pre-trained networks we have are really pretty good at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1742" target="_blank">00:29:02.960</a></span> | <span class="t">recognizing multiple objects as long as you only have to mention each one once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1747" target="_blank">00:29:07.300</a></span> | <span class="t">So that works pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1751" target="_blank">00:29:11.720</a></span> | <span class="t">So we've got this idea that we've got an input image that goes through a ConvNet which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1776" target="_blank">00:29:36.760</a></span> | <span class="t">a tensor vector of size 4+c where c is the number of classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1791" target="_blank">00:29:51.200</a></span> | <span class="t">So that's what we've got.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1793" target="_blank">00:29:53.240</a></span> | <span class="t">And that gives us an object detector for a single object, the largest object in our case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1802" target="_blank">00:30:02.040</a></span> | <span class="t">So let's now create one which doesn't find a single object but that finds 16 objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1812" target="_blank">00:30:12.240</a></span> | <span class="t">So an obvious way to do that would be to take this last, this is just an n.linear, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1821" target="_blank">00:30:21.160</a></span> | <span class="t">has got however many inputs and 4+c outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1829" target="_blank">00:30:29.200</a></span> | <span class="t">And we could take that linear layer and rather than having 4+c outputs, we could have 16</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1837" target="_blank">00:30:37.440</a></span> | <span class="t">times 4+c outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1842" target="_blank">00:30:42.720</a></span> | <span class="t">So it's now spitting out enough things to give us 16 sets of class probabilities and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1848" target="_blank">00:30:48.360</a></span> | <span class="t">16 sets of bounding box coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1851" target="_blank">00:30:51.880</a></span> | <span class="t">And then we would just need a loss function that would check whether those 16 sets of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1858" target="_blank">00:30:58.860</a></span> | <span class="t">bounding boxes correctly represented the up to 16 objects that were represented in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1866" target="_blank">00:31:06.000</a></span> | <span class="t">image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1867" target="_blank">00:31:07.000</a></span> | <span class="t">Now there's a lot of hand waving about the loss function, we'll go into it later as to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1869" target="_blank">00:31:09.960</a></span> | <span class="t">what that is, but let's pretend we have one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1874" target="_blank">00:31:14.640</a></span> | <span class="t">Assuming we had a reasonable loss function, that's totally going to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1878" target="_blank">00:31:18.920</a></span> | <span class="t">That is an architecture which has the necessary output activations, but with the correct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1885" target="_blank">00:31:25.680</a></span> | <span class="t">loss function we should be able to train it to do what we want it to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1893" target="_blank">00:31:33.160</a></span> | <span class="t">But that's just one way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1895" target="_blank">00:31:35.480</a></span> | <span class="t">There's a second way we could do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1897" target="_blank">00:31:37.920</a></span> | <span class="t">Rather than having an n.linear, what if instead we took from our resnet convolutional backbone,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1912" target="_blank">00:31:52.680</a></span> | <span class="t">not an n.linear, but instead we added an n.com2d with stride 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1927" target="_blank">00:32:07.560</a></span> | <span class="t">So the final layer of resnet gives you a 7x7x512 result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1938" target="_blank">00:32:18.300</a></span> | <span class="t">So this would give us a 4 by 4 by whatever, the number of filters, let's say we pick 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1953" target="_blank">00:32:33.680</a></span> | <span class="t">So 4 by 4 by 256 has, well actually, no, let's change that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1973" target="_blank">00:32:53.060</a></span> | <span class="t">Let's not make it 4 by 4 by 256, that is still, let's do it all in one step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1977" target="_blank">00:32:57.280</a></span> | <span class="t">Let's make it 4 by 4 by 4 plus C because now we've got a tensor where the number of elements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1991" target="_blank">00:33:11.040</a></span> | <span class="t">is exactly equal to the number of elements we wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=1995" target="_blank">00:33:15.000</a></span> | <span class="t">So in other words, we could now, this would work too, if we created a loss function that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2008" target="_blank">00:33:28.600</a></span> | <span class="t">took a 4 by 4 by 4 plus C tensor and mapped it to 16 objects in the image and checked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2011" target="_blank">00:33:31.040</a></span> | <span class="t">whether each one was correctly represented by those 4 plus C activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2017" target="_blank">00:33:37.160</a></span> | <span class="t">That would work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2018" target="_blank">00:33:38.160</a></span> | <span class="t">These are two exactly equivalent sets of activations because they've got the same number of elements,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2023" target="_blank">00:33:43.960</a></span> | <span class="t">they just reshaped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2028" target="_blank">00:33:48.360</a></span> | <span class="t">So it turns out that both of these approaches are actually used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2035" target="_blank">00:33:55.000</a></span> | <span class="t">The approach where you basically just spit out one big long vector from a fully-confected</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2040" target="_blank">00:34:00.680</a></span> | <span class="t">linear layer is used by a class of models known as YOLO.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2048" target="_blank">00:34:08.920</a></span> | <span class="t">Whereas the approach of the convolutional activations is used by models which started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2058" target="_blank">00:34:18.940</a></span> | <span class="t">with something called SSD or single shot detector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2065" target="_blank">00:34:25.960</a></span> | <span class="t">What I will say is that since these things came out at very similar times in late 2015,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2077" target="_blank">00:34:37.000</a></span> | <span class="t">things have very much moved towards here, to the point where this morning YOLO version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2083" target="_blank">00:34:43.760</a></span> | <span class="t">3 came out and is now doing it the SSD way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2090" target="_blank">00:34:50.340</a></span> | <span class="t">So that's what we're going to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2091" target="_blank">00:34:51.640</a></span> | <span class="t">We're going to do this, and we're going to learn about why this makes more sense as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2104" target="_blank">00:35:04.640</a></span> | <span class="t">And so the basic idea is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2107" target="_blank">00:35:07.760</a></span> | <span class="t">Let's imagine that underneath this we had another conv2D, strive2, and we'd have something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2127" target="_blank">00:35:27.920</a></span> | <span class="t">which was 2x2, again let's say it's 4+c, that's nice and simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2137" target="_blank">00:35:37.720</a></span> | <span class="t">And so basically it's creating a grid that looks something like this, 1, 2, 3, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2147" target="_blank">00:35:47.320</a></span> | <span class="t">So that would be how the activations are, the geometry of the activations of that second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2154" target="_blank">00:35:54.760</a></span> | <span class="t">extra convolutional strive2 layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2157" target="_blank">00:35:57.600</a></span> | <span class="t">But strive2 convolution does the same thing to the geometry of the activations as a strive1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2164" target="_blank">00:36:04.560</a></span> | <span class="t">convolution followed by a mass-pulling, assuming patterns are key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2169" target="_blank">00:36:09.880</a></span> | <span class="t">So let's talk about what we might do here, because the basic idea is we want to kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2175" target="_blank">00:36:15.360</a></span> | <span class="t">of say this top left grid cell is responsible for identifying any object that's in the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2184" target="_blank">00:36:24.040</a></span> | <span class="t">left, and this one in the top right is responsible for identifying something in the top right,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2188" target="_blank">00:36:28.920</a></span> | <span class="t">this one in the bottom left, and this one in the bottom right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2192" target="_blank">00:36:32.920</a></span> | <span class="t">So in this case you can actually see it's done and it's said, okay, this one is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2196" target="_blank">00:36:36.560</a></span> | <span class="t">to try and find the chair, this one, it's actually made a mistake, it should have said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2200" target="_blank">00:36:40.560</a></span> | <span class="t">table, but there are actually 1, 2, 3 chairs here as well, so it makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2205" target="_blank">00:36:45.640</a></span> | <span class="t">So basically each of these grid cells, if it's going to be told in the loss function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2211" target="_blank">00:36:51.680</a></span> | <span class="t">your job is to find the object, the big object that's in that part of the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2219" target="_blank">00:36:59.240</a></span> | <span class="t">So what --</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2220" target="_blank">00:37:00.240</a></span> | <span class="t">>> So for multi-label classification, I saw you had a threshold on there, which I guess</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2229" target="_blank">00:37:09.080</a></span> | <span class="t">is a hyperparameter, is there a way to --</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2231" target="_blank">00:37:11.240</a></span> | <span class="t">>> We're getting your well ahead, let's work through this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2241" target="_blank">00:37:21.360</a></span> | <span class="t">So why do we care about the idea that we would like this convolutional grid cell to be responsible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2247" target="_blank">00:37:27.560</a></span> | <span class="t">for finding things that were in this part of the image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2251" target="_blank">00:37:31.440</a></span> | <span class="t">And the reason is because of something called the receptive field of that convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2256" target="_blank">00:37:36.080</a></span> | <span class="t">grid cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2257" target="_blank">00:37:37.160</a></span> | <span class="t">And the basic idea is that throughout your convolutional layers, every piece of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2264" target="_blank">00:37:44.600</a></span> | <span class="t">tenses has a receptive field which means which part of the input image was responsible for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2273" target="_blank">00:37:53.200</a></span> | <span class="t">calculating that cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2276" target="_blank">00:37:56.600</a></span> | <span class="t">And like all things in life, the easiest way to see this is with Microsoft Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2282" target="_blank">00:38:02.080</a></span> | <span class="t">So do you remember our convolutional neural net?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2288" target="_blank">00:38:08.560</a></span> | <span class="t">And this was MNIST, we had the number 7.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2291" target="_blank">00:38:11.600</a></span> | <span class="t">And it went through a two-channel filter, channel 1, channel 2, which therefore created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2301" target="_blank">00:38:21.960</a></span> | <span class="t">a two-channel output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2307" target="_blank">00:38:27.080</a></span> | <span class="t">And then the next layer was another convolution, so this tensor is now a 3D tensor, which then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2315" target="_blank">00:38:35.400</a></span> | <span class="t">creates a two-channel output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2318" target="_blank">00:38:38.880</a></span> | <span class="t">And then after that, we had our max-pooling layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2324" target="_blank">00:38:44.520</a></span> | <span class="t">So let's look at this part of this output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2328" target="_blank">00:38:48.960</a></span> | <span class="t">And the fact that this is conv, followed by max-pool, let's just pretend it's a stride-two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2332" target="_blank">00:38:52.920</a></span> | <span class="t">conv.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2333" target="_blank">00:38:53.920</a></span> | <span class="t">It's basically the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2336" target="_blank">00:38:56.700</a></span> | <span class="t">So let's see where this number 27 came from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2341" target="_blank">00:39:01.860</a></span> | <span class="t">So if you've got Excel, you can go formulas, trace precedence, and so you can see this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2348" target="_blank">00:39:08.300</a></span> | <span class="t">came from these four.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2352" target="_blank">00:39:12.560</a></span> | <span class="t">Now where did those four come from?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2357" target="_blank">00:39:17.680</a></span> | <span class="t">This four came from obviously the convolutional filter kernels, and from these four parts of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2369" target="_blank">00:39:29.800</a></span> | <span class="t">column 1, because we've got four things here, each one of which has a 3x3 filter, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2377" target="_blank">00:39:37.920</a></span> | <span class="t">we have 3, 3, 3, 3, and all together, it makes up 4x4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2384" target="_blank">00:39:44.560</a></span> | <span class="t">Where did those four come from?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2389" target="_blank">00:39:49.440</a></span> | <span class="t">Those four came from obviously our filter, and this entire part of the input image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2404" target="_blank">00:40:04.400</a></span> | <span class="t">And what's more, you can see that these bits in the middle have lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2414" target="_blank">00:40:14.320</a></span> | <span class="t">of weights coming out, whereas these bits on the outside only have one weight coming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2419" target="_blank">00:40:19.260</a></span> | <span class="t">out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2420" target="_blank">00:40:20.260</a></span> | <span class="t">So we call this here the receptive field of this activation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2428" target="_blank">00:40:28.400</a></span> | <span class="t">But note that the receptive field is not just saying it's this here box, but also that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2434" target="_blank">00:40:34.920</a></span> | <span class="t">center of the box has more dependencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2441" target="_blank">00:40:41.840</a></span> | <span class="t">So this is a critically important concept when it comes to understanding architectures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2446" target="_blank">00:40:46.680</a></span> | <span class="t">and understanding why convnets work the way they do, the idea of the receptive field.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2452" target="_blank">00:40:52.200</a></span> | <span class="t">And there are some great articles, if you just google for convolution receptive field,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2456" target="_blank">00:40:56.040</a></span> | <span class="t">you can find lots of terrific articles.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2459" target="_blank">00:40:59.080</a></span> | <span class="t">I'm sure some of you will write much better ones during the week as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2463" target="_blank">00:41:03.960</a></span> | <span class="t">So that's the basic idea there, right, is that the receptive field of this convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2469" target="_blank">00:41:09.420</a></span> | <span class="t">activation is generally centered around this part of the input image, so it should be responsible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2476" target="_blank">00:41:16.000</a></span> | <span class="t">for finding objects that are here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2479" target="_blank">00:41:19.260</a></span> | <span class="t">So that's the architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2483" target="_blank">00:41:23.100</a></span> | <span class="t">The architecture is that we're going to have a ResNet backbone followed by one or more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2488" target="_blank">00:41:28.800</a></span> | <span class="t">2D convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2489" target="_blank">00:41:29.800</a></span> | <span class="t">And for now we're just going to do one, which is going to give us a 4x4 grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2494" target="_blank">00:41:34.880</a></span> | <span class="t">So let's take a look at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2506" target="_blank">00:41:46.120</a></span> | <span class="t">So here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2507" target="_blank">00:41:47.920</a></span> | <span class="t">We start with our Releu and Dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2511" target="_blank">00:41:51.480</a></span> | <span class="t">We then do, let's start at the output, actually let's go through and see what we've got here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2523" target="_blank">00:42:03.800</a></span> | <span class="t">We start with a Stride 1 convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2527" target="_blank">00:42:07.960</a></span> | <span class="t">And the reason we start with a Stride 1 convolution is because that doesn't change the geometry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2531" target="_blank">00:42:11.600</a></span> | <span class="t">at all, it just lets us add an extra layer of calculations, it lets us create not just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2539" target="_blank">00:42:19.320</a></span> | <span class="t">a linear layer, but now we have a little mini neural network in our custom here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2545" target="_blank">00:42:25.000</a></span> | <span class="t">So we start with a Stride 1 convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2547" target="_blank">00:42:27.520</a></span> | <span class="t">And standard conv is just something I defined up here, which does convolution, Releu, Vaginam,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2554" target="_blank">00:42:34.360</a></span> | <span class="t">Dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2556" target="_blank">00:42:36.480</a></span> | <span class="t">Like most research code you see won't define a class like this, instead they'll write the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2564" target="_blank">00:42:44.800</a></span> | <span class="t">entire thing again and again and again, convolution, Vaginam, Dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2570" target="_blank">00:42:50.520</a></span> | <span class="t">Don't be like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2571" target="_blank">00:42:51.920</a></span> | <span class="t">That kind of duplicate code leads to errors and leads to poor understanding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2578" target="_blank">00:42:58.440</a></span> | <span class="t">I mention that also because this week I released the first draft of the FastAI style guide.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2586" target="_blank">00:43:06.800</a></span> | <span class="t">And the FastAI style guide is very heavily oriented towards the idea of expository programming,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2593" target="_blank">00:43:13.520</a></span> | <span class="t">which is the idea that programming code should be something you can use to explain an idea,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2602" target="_blank">00:43:22.520</a></span> | <span class="t">ideally as readily as mathematical notation to somebody that understands your coding method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2610" target="_blank">00:43:30.320</a></span> | <span class="t">And so the idea actually goes back a very long way, but it was best described in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2617" target="_blank">00:43:37.280</a></span> | <span class="t">Turing Award lecture, this is like the Nobel of Computer Science, the Turing Award lecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2622" target="_blank">00:43:42.000</a></span> | <span class="t">of 1979 by probably my greatest computer science hero, Ken Iverson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2627" target="_blank">00:43:47.880</a></span> | <span class="t">He had been working on it well before in 1964, but 1964 was the first example of this approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2636" target="_blank">00:43:56.320</a></span> | <span class="t">to programming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2637" target="_blank">00:43:57.320</a></span> | <span class="t">He released something called APL, and then 25 years later he won the Turing Award.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2644" target="_blank">00:44:04.120</a></span> | <span class="t">He then passed on the baton to his son, Eric Iverson, and there's been basically 50 or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2650" target="_blank">00:44:10.920</a></span> | <span class="t">60 years now of continuous development of this idea of what does programming look like when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2655" target="_blank">00:44:15.960</a></span> | <span class="t">it's designed to be a notation as a tool for thought for expository programming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2663" target="_blank">00:44:23.160</a></span> | <span class="t">And so I've made a very shoddy attempt at taking some of these ideas and thinking about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2670" target="_blank">00:44:30.480</a></span> | <span class="t">how can they be applied to Python programming with all the limitations by comparison that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2676" target="_blank">00:44:36.200</a></span> | <span class="t">Python has.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2678" target="_blank">00:44:38.800</a></span> | <span class="t">So here's a very simple example, if you write all of these things again and again and again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2686" target="_blank">00:44:46.280</a></span> | <span class="t">then it really hides the fact that you've got two convolutional layers, one of stride</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2692" target="_blank">00:44:52.880</a></span> | <span class="t">1, one of stride 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2696" target="_blank">00:44:56.960</a></span> | <span class="t">So my default for standard conv is stride 2, this is stride 1, this is stride 2, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2702" target="_blank">00:45:02.960</a></span> | <span class="t">then at the end, the output of this is going to be 4x4, I've got an outcon, and an outcon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2714" target="_blank">00:45:14.960</a></span> | <span class="t">is interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2716" target="_blank">00:45:16.400</a></span> | <span class="t">You can see it's got two separate convolutional layers, each of which is stride 1, so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2722" target="_blank">00:45:22.640</a></span> | <span class="t">not changing the geometry of the input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2727" target="_blank">00:45:27.240</a></span> | <span class="t">One of them is of length of the number of classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2732" target="_blank">00:45:32.240</a></span> | <span class="t">Just ignore k for now, k is equal to 1 at this point of the code, so one is equal to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2738" target="_blank">00:45:38.000</a></span> | <span class="t">the length of the number of classes, one is equal to 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2741" target="_blank">00:45:41.760</a></span> | <span class="t">And so this is this idea of rather than having a single conv layer that outputs 4 + c, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2748" target="_blank">00:45:48.640</a></span> | <span class="t">have two conv layers, one of which outputs 4, one of which outputs c.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2754" target="_blank">00:45:54.240</a></span> | <span class="t">And then I will just return them as a list of two items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2759" target="_blank">00:45:59.640</a></span> | <span class="t">That's nearly the same thing as having a single conv layer that outputs 4 + c, but it lets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2767" target="_blank">00:46:07.360</a></span> | <span class="t">these layers specialize just a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2771" target="_blank">00:46:11.240</a></span> | <span class="t">So like we talked about this idea that when you've got multiple tasks, they can share</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2777" target="_blank">00:46:17.760</a></span> | <span class="t">layers, but they don't have to share all the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2780" target="_blank">00:46:20.920</a></span> | <span class="t">So in this case, our two tasks, which is create a classifier and create bound box regression,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2788" target="_blank">00:46:28.960</a></span> | <span class="t">share every single layer except the very last one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2793" target="_blank">00:46:33.240</a></span> | <span class="t">And so this is going to spit out two separate tenses of activations, one of the classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2801" target="_blank">00:46:41.440</a></span> | <span class="t">and one of the bounding box coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2805" target="_blank">00:46:45.960</a></span> | <span class="t">Why am I adding 1?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2807" target="_blank">00:46:47.960</a></span> | <span class="t">That's because I'm going to have one more class for background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2811" target="_blank">00:46:51.160</a></span> | <span class="t">So if there aren't actually 16 objects to detect, or if there isn't an object in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2817" target="_blank">00:46:57.120</a></span> | <span class="t">corner represented by this convolutional grid cell, then I want it to predict background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2825" target="_blank">00:47:05.780</a></span> | <span class="t">So that's the entirety of our architecture, it's incredibly simple, but the point is now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2835" target="_blank">00:47:15.880</a></span> | <span class="t">that we have this convolutional layer at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2840" target="_blank">00:47:20.460</a></span> | <span class="t">One thing I do do is that at the very end I flatten out the convolution, basically because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2850" target="_blank">00:47:30.280</a></span> | <span class="t">I wrote the loss function to expect a flattened-out tensor, but we could totally rewrite it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2857" target="_blank">00:47:37.160</a></span> | <span class="t">not do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2858" target="_blank">00:47:38.160</a></span> | <span class="t">I might even try doing that during the week and see which one looks easier to understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2863" target="_blank">00:47:43.880</a></span> | <span class="t">So we've got our data, we've got our architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2870" target="_blank">00:47:50.100</a></span> | <span class="t">So now all we need is a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2874" target="_blank">00:47:54.160</a></span> | <span class="t">So the loss function needs to look at each of these 16 sets of activations, each of which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2882" target="_blank">00:48:02.160</a></span> | <span class="t">are going to have 4 bounding box coordinates and c+1 class probabilities, and decide are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2892" target="_blank">00:48:12.840</a></span> | <span class="t">those activations close or far away from the object closest to this grid cell in the image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2908" target="_blank">00:48:28.720</a></span> | <span class="t">And if nothing's there, then are you predicting background correctly?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2916" target="_blank">00:48:36.200</a></span> | <span class="t">So that turns out to be very hard to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2923" target="_blank">00:48:43.680</a></span> | <span class="t">Let's go back to the 2x2 example to keep it simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2930" target="_blank">00:48:50.680</a></span> | <span class="t">The loss function actually needs to take each of the objects in the image and match them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2938" target="_blank">00:48:58.280</a></span> | <span class="t">to one of these convolutional grid cells, to say this grid cell is responsible for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2943" target="_blank">00:49:03.280</a></span> | <span class="t">particular object, this grid cell is responsible for this particular object, so then it can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2947" target="_blank">00:49:07.480</a></span> | <span class="t">go ahead and say how close are the 4 coordinates and how close are the class probabilities?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2953" target="_blank">00:49:13.640</a></span> | <span class="t">So this is called the matching problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2958" target="_blank">00:49:18.200</a></span> | <span class="t">In order to explain it, I'm going to show it to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2963" target="_blank">00:49:23.840</a></span> | <span class="t">But what I'm going to do first is I'm going to take a break and we're going to come back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2967" target="_blank">00:49:27.080</a></span> | <span class="t">and understand the matching problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2969" target="_blank">00:49:29.600</a></span> | <span class="t">So during the break, have a think about how would you design a loss function here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2974" target="_blank">00:49:34.480</a></span> | <span class="t">How would you design a function which has a lower value if these 16x4+k activations somehow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2984" target="_blank">00:49:44.360</a></span> | <span class="t">better reflect the up to 16 objects which are actually in the ground truth image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2990" target="_blank">00:49:50.320</a></span> | <span class="t">And we'll come back at 7.40.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=2996" target="_blank">00:49:56.900</a></span> | <span class="t">So here's our goal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3000" target="_blank">00:50:00.520</a></span> | <span class="t">Our dependent variable basically looks like that, and it's just an extract from our CSV</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3013" target="_blank">00:50:13.120</a></span> | <span class="t">file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3015" target="_blank">00:50:15.120</a></span> | <span class="t">And our final convolutional layer is going to be a bunch of numbers which initially is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3024" target="_blank">00:50:24.080</a></span> | <span class="t">a 4 by 4 by, in this case I think c is equal to 20 plus we've got 1 in the background, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3036" target="_blank">00:50:36.640</a></span> | <span class="t">4 plus 21 equals 26, 4 by 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3045" target="_blank">00:50:45.040</a></span> | <span class="t">And then we flatten that out into a vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3051" target="_blank">00:50:51.300</a></span> | <span class="t">We flatten that out into a vector, and so basically our goal then is to say to some particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3059" target="_blank">00:50:59.640</a></span> | <span class="t">set of activations that ended up coming out of this model, let's pick some particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3067" target="_blank">00:51:07.320</a></span> | <span class="t">dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3069" target="_blank">00:51:09.080</a></span> | <span class="t">We need some function that takes in that and that, and where it feeds back a higher number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3080" target="_blank">00:51:20.520</a></span> | <span class="t">if these activations aren't a good reflection of the ground truth bounding boxes, or a lower</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3085" target="_blank">00:51:25.360</a></span> | <span class="t">number if it is a good reflection of the ground truth bounding boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3089" target="_blank">00:51:29.260</a></span> | <span class="t">That's our goal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3090" target="_blank">00:51:30.360</a></span> | <span class="t">We need to create that function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3094" target="_blank">00:51:34.720</a></span> | <span class="t">And so the general approach to creating that function will be to first of all, to simplify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3102" target="_blank">00:51:42.640</a></span> | <span class="t">it down with a 2 by 2 version, will be to first of all, well actually, I'll show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3119" target="_blank">00:51:59.080</a></span> | <span class="t">Here's a model I trained earlier, and let's run through, I've taken the loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3125" target="_blank">00:52:05.080</a></span> | <span class="t">and I've split it line by line so that you can see every line that goes into making it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3131" target="_blank">00:52:11.040</a></span> | <span class="t">So let's grab our validation set data loader, grab a batch from it, turn them into variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3139" target="_blank">00:52:19.640</a></span> | <span class="t">so we can stick them into a model, put the model in evaluation mode, stick that data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3149" target="_blank">00:52:29.200</a></span> | <span class="t">into our model to grab a batch of activations, and remember that the final output convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3157" target="_blank">00:52:37.580</a></span> | <span class="t">returned two items, the classes and the bounding boxes, so we can do destructuring assignment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3165" target="_blank">00:52:45.560</a></span> | <span class="t">to grab the two pieces, the batch of classes and outputs, and the batch of bounding box</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3172" target="_blank">00:52:52.560</a></span> | <span class="t">outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3175" target="_blank">00:52:55.840</a></span> | <span class="t">And so as expected, the batch of class outputs is batch size 64 by 16 grid cells by 21 classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3188" target="_blank">00:53:08.420</a></span> | <span class="t">and then 64 by 16 by 4 for the bounding box coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3193" target="_blank">00:53:13.200</a></span> | <span class="t">Hopefully that all makes sense and after class go back and just make sure if it's not obvious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3199" target="_blank">00:53:19.240</a></span> | <span class="t">why these are the shapes, make sure you get to the point where you understand where they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3204" target="_blank">00:53:24.200</a></span> | <span class="t">are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3205" target="_blank">00:53:25.200</a></span> | <span class="t">So let's now go back and look at the ground truth, so the ground truth is in this Y variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3216" target="_blank">00:53:36.040</a></span> | <span class="t">So let's grab the bounding box part and the class part and put them into these two Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3226" target="_blank">00:53:46.160</a></span> | <span class="t">variables and print them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3228" target="_blank">00:53:48.120</a></span> | <span class="t">And so there's our ground truth bounding boxes and there's our ground truth classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3234" target="_blank">00:53:54.160</a></span> | <span class="t">So this image apparently has three objects in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3237" target="_blank">00:53:57.440</a></span> | <span class="t">So let's draw a picture of the three objects, and there they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3243" target="_blank">00:54:03.200</a></span> | <span class="t">We already have a show ground truth function, the torch ground truth function simply converts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3250" target="_blank">00:54:10.420</a></span> | <span class="t">the tensors into numpy and passes them along so that we can print them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3255" target="_blank">00:54:15.040</a></span> | <span class="t">So here we've got the bounding box coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3261" target="_blank">00:54:21.720</a></span> | <span class="t">So notice that they've all been scaled between 0 and 1, so basically we're treating the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3268" target="_blank">00:54:28.440</a></span> | <span class="t">as being 1 by 1, so these are all relative to the size of the image, there's our three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3274" target="_blank">00:54:34.000</a></span> | <span class="t">classes, and so here they are, chair is 0, dining table is 1, and 2 is sofa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3279" target="_blank">00:54:39.680</a></span> | <span class="t">This is not a model, this is the ground truth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3285" target="_blank">00:54:45.960</a></span> | <span class="t">Here is our 4 by 4 grid cells from our final convolutional layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3294" target="_blank">00:54:54.640</a></span> | <span class="t">So each of these square boxes, different papers call them different things, the three terms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3301" target="_blank">00:55:01.200</a></span> | <span class="t">you'll hear are anchor boxes, prior boxes, or default boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3308" target="_blank">00:55:08.440</a></span> | <span class="t">And through this explanation you'll get a sense of what they are, but for now think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3312" target="_blank">00:55:12.200</a></span> | <span class="t">of them as just these 16 squares, I'm going to stick with the term anchor boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3318" target="_blank">00:55:18.240</a></span> | <span class="t">These 16 squares are our anchor boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3322" target="_blank">00:55:22.240</a></span> | <span class="t">So what we're going to do for this loss function is we're going to go through a matching problem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3327" target="_blank">00:55:27.640</a></span> | <span class="t">where we're going to take every one of these 16 boxes and we're going to see which one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3333" target="_blank">00:55:33.440</a></span> | <span class="t">of these three ground truth objects has the highest amount of overlap with this square.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3342" target="_blank">00:55:42.600</a></span> | <span class="t">So to do that, we're going to have to have some way of measuring an amount of overlap,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3350" target="_blank">00:55:50.720</a></span> | <span class="t">and there's a standard function for this which is called the Jacquard index, and the Jacquard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3357" target="_blank">00:55:57.560</a></span> | <span class="t">index is very simple, I'll do it through example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3361" target="_blank">00:56:01.000</a></span> | <span class="t">Let's take this sofa, so if we take this sofa and let's take the Jacquard index of this sofa</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3370" target="_blank">00:56:10.480</a></span> | <span class="t">with this grid cell here, what we do is we find the area of their intersection, so here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3383" target="_blank">00:56:23.520</a></span> | <span class="t">is the area of their intersection, and then we find the area of their union, so here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3393" target="_blank">00:56:33.640</a></span> | <span class="t">the area of their union, and then we say take the intersection divided by the union.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3409" target="_blank">00:56:49.440</a></span> | <span class="t">And so that's the Jacquard index, also known as IOU intersection over union.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3418" target="_blank">00:56:58.400</a></span> | <span class="t">So if two things overlap by more compared to their total sizes together, they have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3424" target="_blank">00:57:04.320</a></span> | <span class="t">higher Jacquard index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3432" target="_blank">00:57:12.360</a></span> | <span class="t">So we're going to go through and find the Jacquard overlap for each one of these three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3436" target="_blank">00:57:16.740</a></span> | <span class="t">objects versus each of these 16 anchor boxes, and so that's going to give us a 3x16 matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3443" target="_blank">00:57:23.560</a></span> | <span class="t">For every ground truth object, for every anchor box, how much overlap is there?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3450" target="_blank">00:57:30.600</a></span> | <span class="t">So here are the coordinates of all of our anchor boxes, in this case they're printed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3457" target="_blank">00:57:37.880</a></span> | <span class="t">as center and height and width.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3465" target="_blank">00:57:45.720</a></span> | <span class="t">And so here is the amount of overlap between, and as you can see it's 3x16, so for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3471" target="_blank">00:57:51.920</a></span> | <span class="t">of the three ground truth objects, for each of the 16 anchor boxes, how much do they overlap?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3479" target="_blank">00:57:59.500</a></span> | <span class="t">So you can see here, 0, 1, 2, 3, 4, 5, 6, 7, 8, the 8th, anchor box overlaps a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3488" target="_blank">00:58:08.440</a></span> | <span class="t">bit with the second ground truth object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3494" target="_blank">00:58:14.400</a></span> | <span class="t">So what we could do now is we could take the max of dimension 1, so the max of each row,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3500" target="_blank">00:58:20.960</a></span> | <span class="t">and that will tell us for each ground truth object what's the maximum amount that it overlaps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3506" target="_blank">00:58:26.400</a></span> | <span class="t">with some grid cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3509" target="_blank">00:58:29.760</a></span> | <span class="t">And it also tells us, remember PyTorch when you say max returns two things, it says what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3514" target="_blank">00:58:34.400</a></span> | <span class="t">is the max and what is the index of the max.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3518" target="_blank">00:58:38.380</a></span> | <span class="t">So for each of these things, the 14th grid cell is the largest overlap for the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3528" target="_blank">00:58:48.400</a></span> | <span class="t">ground truth, 13 for the second, and 11 for the third.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3536" target="_blank">00:58:56.360</a></span> | <span class="t">So that tells us a pretty good way of assigning each of these ground truth objects to a grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3543" target="_blank">00:59:03.480</a></span> | <span class="t">cell, what the max is, which one is the highest overlap.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3548" target="_blank">00:59:08.360</a></span> | <span class="t">But we're going to do a second thing, we're also going to look at max over dimension 0,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3554" target="_blank">00:59:14.000</a></span> | <span class="t">and max over dimension 0 is going to tell us what's the maximum amount of overlap for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3560" target="_blank">00:59:20.440</a></span> | <span class="t">each grid cell across all of the ground truth objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3566" target="_blank">00:59:26.880</a></span> | <span class="t">And so particularly interesting here tells us for every grid cell of 16, what's the index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3573" target="_blank">00:59:33.880</a></span> | <span class="t">of the ground truth object which overlaps with it the most.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3579" target="_blank">00:59:39.280</a></span> | <span class="t">Zero is a bit overloaded here, zero could either mean the amount of overlap was zero,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3585" target="_blank">00:59:45.440</a></span> | <span class="t">or it could mean its largest overlap is with object index 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3591" target="_blank">00:59:51.560</a></span> | <span class="t">It's going to turn out not to matter, I just wanted to explain why this would be zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3597" target="_blank">00:59:57.420</a></span> | <span class="t">So there's a function called map to ground truth, which I'm not going to worry about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3602" target="_blank">01:00:02.400</a></span> | <span class="t">for now, it's super simple code but it's slightly awkward to think about, but basically what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3611" target="_blank">01:00:11.040</a></span> | <span class="t">it does is it combines these two sets of overlaps in a way described in the SSD paper to assign</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3618" target="_blank">01:00:18.360</a></span> | <span class="t">every anchor box to a ground truth object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3624" target="_blank">01:00:24.800</a></span> | <span class="t">Basically the way it assigns it is each of these ones, each of these three, gets assigned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3631" target="_blank">01:00:31.020</a></span> | <span class="t">in this way, so this object is assigned to anchor box 14, this one to 13, and this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3638" target="_blank">01:00:38.560</a></span> | <span class="t">to 11, and then of the rest of the anchor boxes they get assigned to anything which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3644" target="_blank">01:00:44.600</a></span> | <span class="t">they have an overlap of at least 0.5 with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3648" target="_blank">01:00:48.960</a></span> | <span class="t">If anything which isn't in either of those criteria, i.e. which either isn't a maximum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3655" target="_blank">01:00:55.400</a></span> | <span class="t">or doesn't have a greater than 0.5 overlap, is considered to be a cell which contains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3660" target="_blank">01:01:00.960</a></span> | <span class="t">background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3661" target="_blank">01:01:01.960</a></span> | <span class="t">So that's all the map to ground truth function does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3665" target="_blank">01:01:05.240</a></span> | <span class="t">And so after we go through it, you can see now a list of all of the assignments, and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3671" target="_blank">01:01:11.400</a></span> | <span class="t">can also see anywhere that there's a 0 here, it means it was assigned to background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3676" target="_blank">01:01:16.040</a></span> | <span class="t">In fact anywhere it's less than 0.5 here, it was assigned to background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3679" target="_blank">01:01:19.840</a></span> | <span class="t">So you can see those three which are kind of forced assignments that puts a high number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3685" target="_blank">01:01:25.440</a></span> | <span class="t">in just to make sure that they're assigned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3688" target="_blank">01:01:28.360</a></span> | <span class="t">So we can now go ahead and convert those to classes, and then we can make sure we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3696" target="_blank">01:01:36.240</a></span> | <span class="t">grab those which are at least 0.5 in size, and so finally that allows us to spit out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3703" target="_blank">01:01:43.160</a></span> | <span class="t">the three classes that are being predicted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3708" target="_blank">01:01:48.680</a></span> | <span class="t">We can then put that back into the bounding boxes, and so here are what each of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3717" target="_blank">01:01:57.760</a></span> | <span class="t">anchor boxes is meant to be predicting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3721" target="_blank">01:02:01.840</a></span> | <span class="t">So you can see sofa, dining room table, chair, this is meant to be predicting sofa, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3733" target="_blank">01:02:13.920</a></span> | <span class="t">is meant to be predicting dining room table, this is meant to be predicting chair, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3738" target="_blank">01:02:18.400</a></span> | <span class="t">everything else is meant to be predicting background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3742" target="_blank">01:02:22.100</a></span> | <span class="t">So that's the matching stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3750" target="_blank">01:02:30.380</a></span> | <span class="t">So once we've done the matching stage, we're basically done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3755" target="_blank">01:02:35.000</a></span> | <span class="t">We can take the activations, just grab those which matched, that's what these positive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3764" target="_blank">01:02:44.160</a></span> | <span class="t">indexes are, subtract from those the ground truth bounding boxes, take the absolute value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3774" target="_blank">01:02:54.600</a></span> | <span class="t">of the difference, take the mean of that, and that's bell1_was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3780" target="_blank">01:03:00.160</a></span> | <span class="t">And then for the classifications, we can just do cross-entropy, and then as before we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3789" target="_blank">01:03:09.000</a></span> | <span class="t">add them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3791" target="_blank">01:03:11.040</a></span> | <span class="t">So that's the basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3795" target="_blank">01:03:15.600</a></span> | <span class="t">There's a few, and so this is what's going to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3800" target="_blank">01:03:20.720</a></span> | <span class="t">We're going to end up with 16 recommended predicted bounding boxes coming out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3810" target="_blank">01:03:30.780</a></span> | <span class="t">Most of them will be background, see all these ones that say bg, but from time to time they'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3815" target="_blank">01:03:35.120</a></span> | <span class="t">say this is a cow, this is potted plant, this is a cow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3820" target="_blank">01:03:40.960</a></span> | <span class="t">If you're wondering what does it predict in terms of the bounding box of background, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3826" target="_blank">01:03:46.760</a></span> | <span class="t">answer is it totally ignores it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3828" target="_blank">01:03:48.960</a></span> | <span class="t">That's why we had this only positive index thing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3834" target="_blank">01:03:54.000</a></span> | <span class="t">So if it's background, there's no sense of where's the correct bounding box of background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3841" target="_blank">01:04:01.300</a></span> | <span class="t">So the only ones where the bounding box makes sense out of all of these are the ones that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3845" target="_blank">01:04:05.120</a></span> | <span class="t">aren't background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3849" target="_blank">01:04:09.160</a></span> | <span class="t">There are some important little tweaks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3852" target="_blank">01:04:12.280</a></span> | <span class="t">One is that how do we interpret the activations?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3859" target="_blank">01:04:19.320</a></span> | <span class="t">And so the way we interpret the activations is defined here in activation to bounding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3868" target="_blank">01:04:28.320</a></span> | <span class="t">box.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3869" target="_blank">01:04:29.740</a></span> | <span class="t">And so basically we grab the activations, we stick them through than, and so remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3876" target="_blank">01:04:36.040</a></span> | <span class="t">than is the same as sigmoid except it's scaled to be between -1 and 1, not between 0 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3884" target="_blank">01:04:44.000</a></span> | <span class="t">1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3885" target="_blank">01:04:45.000</a></span> | <span class="t">So it's basically a sigmoid function that goes between -1 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3888" target="_blank">01:04:48.200</a></span> | <span class="t">And so that forces it to be within that range.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3891" target="_blank">01:04:51.360</a></span> | <span class="t">And we then say let's grab the actual position of the anchor boxes and we will move them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3899" target="_blank">01:04:59.800</a></span> | <span class="t">around according to the value of the activations divided by 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3903" target="_blank">01:05:03.800</a></span> | <span class="t">So in other words, each predicted bounding box can be moved by up to 50% of a grid size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3913" target="_blank">01:05:13.720</a></span> | <span class="t">from where its default position is, and ditto for its height and width can be up to twice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3920" target="_blank">01:05:20.200</a></span> | <span class="t">as big or half as big as its default size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3928" target="_blank">01:05:28.120</a></span> | <span class="t">So that's one thing is we have to convert the activations into some kind of way of scaling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3932" target="_blank">01:05:32.920</a></span> | <span class="t">those default anchor box positions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3936" target="_blank">01:05:36.800</a></span> | <span class="t">Another thing is we don't actually use cross-entropy, we actually use binary cross-entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3947" target="_blank">01:05:47.160</a></span> | <span class="t">So remember binary cross-entropy loss is what we normally use for multi-label classification,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3953" target="_blank">01:05:53.300</a></span> | <span class="t">like in the planet Amazon satellite competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3958" target="_blank">01:05:58.680</a></span> | <span class="t">Each satellite image could have multiple things in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3961" target="_blank">01:06:01.920</a></span> | <span class="t">So if it's got multiple things in it, you can't use softmax, because softmax kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3966" target="_blank">01:06:06.360</a></span> | <span class="t">really encourages just one thing to have the high number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3971" target="_blank">01:06:11.880</a></span> | <span class="t">In our case, each anchor box can only have one object associated with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3978" target="_blank">01:06:18.800</a></span> | <span class="t">So it's not for that reason that we're avoiding softmax, it's something else, which is it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3985" target="_blank">01:06:25.760</a></span> | <span class="t">possible for an anchor box to have nothing associated with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3991" target="_blank">01:06:31.480</a></span> | <span class="t">So there'd be two ways to handle that, this idea of background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=3995" target="_blank">01:06:35.080</a></span> | <span class="t">One would be to say, you know what, background's just a class, so let's use softmax and just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4002" target="_blank">01:06:42.480</a></span> | <span class="t">treat background as one of the classes that the softmax could predict.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4008" target="_blank">01:06:48.800</a></span> | <span class="t">A lot of people have done it this way, I don't like that though, because that's a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4013" target="_blank">01:06:53.920</a></span> | <span class="t">hard thing to ask a neural network to do, is basically to say, can you tell whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4019" target="_blank">01:06:59.920</a></span> | <span class="t">this grid cell doesn't have any of the 20 objects that I'm interested in with a jacquard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4026" target="_blank">01:07:06.680</a></span> | <span class="t">overlap of more than 0.5?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4029" target="_blank">01:07:09.320</a></span> | <span class="t">That's a really hard thing to put into a single computation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4035" target="_blank">01:07:15.320</a></span> | <span class="t">On the other hand, what if we just had for each class, is it a motorbike, is it a bus,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4043" target="_blank">01:07:23.160</a></span> | <span class="t">is it a person, is it a bird, is it a dining room table?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4047" target="_blank">01:07:27.120</a></span> | <span class="t">And then it can check each of those and be no, no, no, no, no, and if it's no to all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4050" target="_blank">01:07:30.440</a></span> | <span class="t">them, it's like, oh, then it's background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4053" target="_blank">01:07:33.700</a></span> | <span class="t">So that's the way I'm doing it, it's not that we could have multiple true labels, but we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4060" target="_blank">01:07:40.680</a></span> | <span class="t">can have zero true labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4064" target="_blank">01:07:44.080</a></span> | <span class="t">And so that's what's going on here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4065" target="_blank">01:07:45.840</a></span> | <span class="t">We take our target and we do a one-hot embedding with number of classes plus one, so at this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4073" target="_blank">01:07:53.400</a></span> | <span class="t">stage we do have the idea of background for the one-hot embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4077" target="_blank">01:07:57.080</a></span> | <span class="t">But then we remove the last column, so the background column's now gone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4083" target="_blank">01:08:03.720</a></span> | <span class="t">And so now this vector's either of all zeros, basically, meaning there's nothing here, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4092" target="_blank">01:08:12.920</a></span> | <span class="t">it has at most one one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4096" target="_blank">01:08:16.580</a></span> | <span class="t">And so then we can use binary cross-entropy to convey our predictions with that target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4106" target="_blank">01:08:26.140</a></span> | <span class="t">That is a minor tweak, but it's the kind of minor tweak that I want you to think about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4114" target="_blank">01:08:34.520</a></span> | <span class="t">and understand, because it's a really big difference in practice to your training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4122" target="_blank">01:08:42.880</a></span> | <span class="t">And it's the kind of thing that you'll see a lot of papers talk about, like often when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4126" target="_blank">01:08:46.240</a></span> | <span class="t">there's some increment over some previous paper, it'll be something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4130" target="_blank">01:08:50.520</a></span> | <span class="t">It'll be somebody who realizes like, oh, trying to predict a background category using a softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4137" target="_blank">01:08:57.340</a></span> | <span class="t">is a really hard thing to do, what if we use the binary cross-entropy instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4142" target="_blank">01:09:02.120</a></span> | <span class="t">And so it's kind of like, if you understand what this is doing, and more importantly why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4148" target="_blank">01:09:08.320</a></span> | <span class="t">we're doing it, that's a really good test of your understanding of the material.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4153" target="_blank">01:09:13.840</a></span> | <span class="t">And if you don't, that's fine, it just shows you this is something that you need to maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4159" target="_blank">01:09:19.080</a></span> | <span class="t">go back and rewatch this part of the video and talk to some of your classmates and if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4164" target="_blank">01:09:24.120</a></span> | <span class="t">necessary ask for the forum until you understand what are we doing and why are we doing it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4172" target="_blank">01:09:32.720</a></span> | <span class="t">So that's what this binary cross-entropy loss function is doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4179" target="_blank">01:09:39.080</a></span> | <span class="t">So basically in this part of the code we've got this custom loss function, we've got the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4183" target="_blank">01:09:43.400</a></span> | <span class="t">thing that calculates the Descartes index, we've got the thing that converts activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4188" target="_blank">01:09:48.600</a></span> | <span class="t">to bounding blocks, we've got the thing that does map-to-ground truth that we look at,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4194" target="_blank">01:09:54.520</a></span> | <span class="t">and that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4195" target="_blank">01:09:55.520</a></span> | <span class="t">All that's left is the SSD loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4200" target="_blank">01:10:00.260</a></span> | <span class="t">So the SSD loss function, this is actually what we set as our criterion is SSD loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4210" target="_blank">01:10:10.480</a></span> | <span class="t">So what SSD loss does is it loops through each image in the minivac and it calls SSD1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4218" target="_blank">01:10:18.440</a></span> | <span class="t">loss, so SSD loss for one image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4223" target="_blank">01:10:23.020</a></span> | <span class="t">So this function is really where it's all happening, this is calculating the SSD loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4226" target="_blank">01:10:26.720</a></span> | <span class="t">for one image, so we destructure our bounding box in class and basically, what this is doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4239" target="_blank">01:10:39.380</a></span> | <span class="t">here, this is worth mentioning, a lot of code you find out there on the internet doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4247" target="_blank">01:10:47.400</a></span> | <span class="t">work with minibatches, it only does like one thing at a time, which we really don't want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4253" target="_blank">01:10:53.600</a></span> | <span class="t">So in this case, all of this stuff is working, it's not exactly on a minibatch at a time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4259" target="_blank">01:10:59.040</a></span> | <span class="t">it's on a whole bunch of ground truth objects at a time, and the data loader is being fed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4264" target="_blank">01:11:04.480</a></span> | <span class="t">a minibatch at a time to do the convolutional layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4269" target="_blank">01:11:09.720</a></span> | <span class="t">Because we could have different numbers of ground truth objects in each image, but a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4276" target="_blank">01:11:16.480</a></span> | <span class="t">tensor has to be a strict rectangular shape, fastai automatically pads it with zeros, anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4283" target="_blank">01:11:23.400</a></span> | <span class="t">that's not the same length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4285" target="_blank">01:11:25.400</a></span> | <span class="t">I think I fairly recently added it, but it's super handy, almost no other libraries do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4291" target="_blank">01:11:31.700</a></span> | <span class="t">But that does mean that you then have to make sure that you get rid of those zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4296" target="_blank">01:11:36.960</a></span> | <span class="t">So you can see here I'm checking to find all of the non-zeros, and I'm only keeping those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4305" target="_blank">01:11:45.680</a></span> | <span class="t">This is just getting rid of any of the bounding boxes that are actually just padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4313" target="_blank">01:11:53.600</a></span> | <span class="t">So get rid of the padding, turn the activations, bounding boxes, do the jaccard, do the ground</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4318" target="_blank">01:11:58.240</a></span> | <span class="t">truth, this is all the stuff we just went through, it's all line by line underneath.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4323" target="_blank">01:12:03.560</a></span> | <span class="t">Check that there's an overlap greater than something around 0.4 or 0.5, different papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4328" target="_blank">01:12:08.480</a></span> | <span class="t">use different values for this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4333" target="_blank">01:12:13.280</a></span> | <span class="t">Find the things that match, put the background class for those, and then finally get the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4343" target="_blank">01:12:23.520</a></span> | <span class="t">L1 loss for the localization part, get the binary cross-entropy loss for the classification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4348" target="_blank">01:12:28.480</a></span> | <span class="t">part, return those two pieces, and then finally add them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4356" target="_blank">01:12:36.040</a></span> | <span class="t">So that's a lot going on, and it might take a few watches of the video to put in a code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4364" target="_blank">01:12:44.360</a></span> | <span class="t">to fully understand it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4367" target="_blank">01:12:47.840</a></span> | <span class="t">But the basic idea now is that we now have the things we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4371" target="_blank">01:12:51.560</a></span> | <span class="t">We have the data, we have the architecture, and we have the loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4375" target="_blank">01:12:55.760</a></span> | <span class="t">So now we've got those three things we can train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4378" target="_blank">01:12:58.280</a></span> | <span class="t">So do my normal learning rate finder and train for a bit, and we get down to 25, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4390" target="_blank">01:13:10.080</a></span> | <span class="t">at the end we can see how we went.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4396" target="_blank">01:13:16.120</a></span> | <span class="t">So obviously this isn't quite what we want, I mean in practice we kind of remove the background</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4400" target="_blank">01:13:20.900</a></span> | <span class="t">ones or some threshold, but it's on the right track, there's a dog in the middle, 0.34, there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4406" target="_blank">01:13:26.960</a></span> | <span class="t">a bird here in the middle, 0.94, something's working okay, I've got a few concerns, I don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4415" target="_blank">01:13:35.400</a></span> | <span class="t">see anything saying motorcycle here, it says bicycle, which isn't great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4420" target="_blank">01:13:40.600</a></span> | <span class="t">There's nothing for the plot of plant that's big enough, but that's not surprising because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4424" target="_blank">01:13:44.920</a></span> | <span class="t">all of our anchor boxes were small, they were 4x4 grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4431" target="_blank">01:13:51.080</a></span> | <span class="t">So to go from here to something that's going to be more accurate, all we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4437" target="_blank">01:13:57.800</a></span> | <span class="t">is create way more anchor boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4443" target="_blank">01:14:03.480</a></span> | <span class="t">So there's a couple of ways we can create --</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4445" target="_blank">01:14:05.560</a></span> | <span class="t">>> Quick question, I'm just getting lost in the fact that the anchor boxes and the bounding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4454" target="_blank">01:14:14.280</a></span> | <span class="t">boxes are, how are they not the same?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4456" target="_blank">01:14:16.520</a></span> | <span class="t">Isn't that how we wrote the loss?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4458" target="_blank">01:14:18.720</a></span> | <span class="t">I must be missing something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4462" target="_blank">01:14:22.320</a></span> | <span class="t">>> Anchor boxes are the square, the fixed square grid cells, these are the anchor boxes, they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4471" target="_blank">01:14:31.840</a></span> | <span class="t">in an exact, specific, unmoving location.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4476" target="_blank">01:14:36.000</a></span> | <span class="t">The bounding boxes are, these are three things, the bounding boxes, these 16 things are anchor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4487" target="_blank">01:14:47.120</a></span> | <span class="t">boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4488" target="_blank">01:14:48.120</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4489" target="_blank">01:14:49.120</a></span> | <span class="t">So we're going to create lots more anchor boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4492" target="_blank">01:14:52.560</a></span> | <span class="t">So there's three ways to do that, and I've kind of drawn some of them here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4500" target="_blank">01:15:00.080</a></span> | <span class="t">One is to create anchor boxes of different sizes and aspect ratios.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4507" target="_blank">01:15:07.120</a></span> | <span class="t">So here you can see, you know, there's an upright rectangle, there's a line down rectangle,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4518" target="_blank">01:15:18.160</a></span> | <span class="t">and there's a square.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4520" target="_blank">01:15:20.120</a></span> | <span class="t">>> Just a question, for the multi-label classification, why aren't we multiplying the categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4527" target="_blank">01:15:27.880</a></span> | <span class="t">loss by a constant like we did before?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4531" target="_blank">01:15:31.000</a></span> | <span class="t">>> That's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4534" target="_blank">01:15:34.000</a></span> | <span class="t">Because later on it'll turn out we don't need to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4541" target="_blank">01:15:41.760</a></span> | <span class="t">So yeah, so you can see here, like there's a square.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4545" target="_blank">01:15:45.040</a></span> | <span class="t">And so I don't know if you can see this, but if you look, you've basically got one, two,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4549" target="_blank">01:15:49.600</a></span> | <span class="t">three squares of different sizes, and for each of those three squares you've also got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4553" target="_blank">01:15:53.720</a></span> | <span class="t">a line down rectangle and an upright rectangle to go with them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4558" target="_blank">01:15:58.560</a></span> | <span class="t">So we've got three aspect ratios at three zoom levels, so that's one way we can do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4565" target="_blank">01:16:05.580</a></span> | <span class="t">And this is for the one-by-one grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4568" target="_blank">01:16:08.760</a></span> | <span class="t">So in other words, if we added two more stride two convolutional layers, you'll eventually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4572" target="_blank">01:16:12.800</a></span> | <span class="t">get to the one-by-one grid, and this is for the one-by-one grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4577" target="_blank">01:16:17.680</a></span> | <span class="t">Another thing we could do is to use more convolutional layers as sources of anchor boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4587" target="_blank">01:16:27.200</a></span> | <span class="t">So as well as our, and I've randomly jitted these a little bit so it's easier to see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4593" target="_blank">01:16:33.020</a></span> | <span class="t">So as well as our 16-by-16 grid cells, we've also got two-by-two grid cells, and we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4604" target="_blank">01:16:44.160</a></span> | <span class="t">also got the one-by-one grid cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4607" target="_blank">01:16:47.500</a></span> | <span class="t">So in other words, if we add three stride two convolutions to the end, we'll have four-by-four,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4615" target="_blank">01:16:55.140</a></span> | <span class="t">two-by-two, and one-by-one grid cells, all of which have anchor boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4621" target="_blank">01:17:01.480</a></span> | <span class="t">And then for every one of those, we can have all of these different shapes and sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4627" target="_blank">01:17:07.520</a></span> | <span class="t">So obviously those two are combined with each other to create lots of anchor boxes, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4633" target="_blank">01:17:13.040</a></span> | <span class="t">if I try to print that on the screen, it's just one big blur of color, so I'm not going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4638" target="_blank">01:17:18.840</a></span> | <span class="t">to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4640" target="_blank">01:17:20.720</a></span> | <span class="t">So that's all this code is, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4641" target="_blank">01:17:21.920</a></span> | <span class="t">It says, "All right, what are all the grid cell sizes I have for the anchor boxes?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4647" target="_blank">01:17:27.040</a></span> | <span class="t">What are all the zoom levels I have for the anchor boxes?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4649" target="_blank">01:17:29.680</a></span> | <span class="t">And what are all the aspect ratios I have for the anchor boxes?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4653" target="_blank">01:17:33.320</a></span> | <span class="t">And the rest of this code then just goes away and creates the top left and bottom right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4660" target="_blank">01:17:40.720</a></span> | <span class="t">corners inside an anchor corner, and the middle and height and width in anchors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4669" target="_blank">01:17:49.600</a></span> | <span class="t">So that's all this does, and you can go through it and print out the anchors and anchor corners.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4679" target="_blank">01:17:59.600</a></span> | <span class="t">So the key is to remember this basic idea that we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4691" target="_blank">01:18:11.640</a></span> | <span class="t">a vector of ground truth stuff, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4697" target="_blank">01:18:17.520</a></span> | <span class="t">Where that stuff is like sets of four bounding boxes, but this is what we were given in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4705" target="_blank">01:18:25.880</a></span> | <span class="t">JSON files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4706" target="_blank">01:18:26.880</a></span> | <span class="t">It's the ground truth, it's a dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4710" target="_blank">01:18:30.320</a></span> | <span class="t">Sets of four bounding boxes, and for each one, also a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4717" target="_blank">01:18:37.120</a></span> | <span class="t">So this is a person in this location, this is a dog in this location, and that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4724" target="_blank">01:18:44.520</a></span> | <span class="t">ground truth that we're given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4726" target="_blank">01:18:46.120</a></span> | <span class="t">"Just to clarify, each set of four is one box, top left, bottom right, top left, xy, bottom right, xy."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4735" target="_blank">01:18:55.760</a></span> | <span class="t">So that's what we printed here, we printed out, this is what we call the ground truth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4740" target="_blank">01:19:00.360</a></span> | <span class="t">There's no model, this is what we're told is what the answer is meant to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4746" target="_blank">01:19:06.120</a></span> | <span class="t">And so remember, any time we train a neural net, we have a dependent variable, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4752" target="_blank">01:19:12.640</a></span> | <span class="t">we have a neural net, some black box neural net, that takes some input and spits out some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4761" target="_blank">01:19:21.240</a></span> | <span class="t">output activations, and we take those activations and we compare them to the ground truth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4772" target="_blank">01:19:32.240</a></span> | <span class="t">We calculate a loss, we find the derivative of that, and adjust the weights according</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4779" target="_blank">01:19:39.240</a></span> | <span class="t">to the derivative times the learning rate, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4783" target="_blank">01:19:43.240</a></span> | <span class="t">So the loss is calculated using a loss question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4789" target="_blank">01:19:49.240</a></span> | <span class="t">Something I wanted to say is just I think one of the challenges with this problem is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4795" target="_blank">01:19:55.380</a></span> | <span class="t">part of what's going on here is we're having to come up with an architecture that's letting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4799" target="_blank">01:19:59.320</a></span> | <span class="t">us predict this ground truth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4801" target="_blank">01:20:01.680</a></span> | <span class="t">Like it's not, because you can have, you know, any number of objects in your picture, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4807" target="_blank">01:20:07.520</a></span> | <span class="t">not immediately obvious what's the correct architecture that's going to let us predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4813" target="_blank">01:20:13.240</a></span> | <span class="t">that sort of ground truth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4814" target="_blank">01:20:14.240</a></span> | <span class="t">I guess so, but I'm going to kind of make this plain, as we saw when we looked at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4820" target="_blank">01:20:20.320</a></span> | <span class="t">YOLO versus SSD, that there are only two possible architectures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4826" target="_blank">01:20:26.120</a></span> | <span class="t">The last layer is fully connected, or the last layer is convolutional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4830" target="_blank">01:20:30.840</a></span> | <span class="t">And both of them work perfectly well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4833" target="_blank">01:20:33.160</a></span> | <span class="t">I'm sorry, I meant in terms of by creating this idea of anchor boxes and anchor boxes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4839" target="_blank">01:20:39.080</a></span> | <span class="t">with different locations and sizes, that's giving you a format that kind of lets you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4844" target="_blank">01:20:44.800</a></span> | <span class="t">get to the activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4845" target="_blank">01:20:45.800</a></span> | <span class="t">You're right, like high level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4847" target="_blank">01:20:47.800</a></span> | <span class="t">You see, okay, so that's really entirely in the loss function, not in the architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4855" target="_blank">01:20:55.520</a></span> | <span class="t">Like if we used the YOLO architecture where we had a fully connected layer, like literally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4862" target="_blank">01:21:02.840</a></span> | <span class="t">there would be no concept of geometry in it at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4866" target="_blank">01:21:06.960</a></span> | <span class="t">So I would suggest kind of forgetting the architecture and just treat it as just a given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4874" target="_blank">01:21:14.680</a></span> | <span class="t">It's a thing that is spitting out 16x4+c activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4881" target="_blank">01:21:21.680</a></span> | <span class="t">And then I would say our job is to figure out how to take those 16x4+c activations and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4890" target="_blank">01:21:30.840</a></span> | <span class="t">compare them to our ground truth, which is like 4+1, but if it was one hot encoded it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4902" target="_blank">01:21:42.720</a></span> | <span class="t">would be c, and I think that's easier to think about, so call it 4+c times however many ground</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4909" target="_blank">01:21:49.800</a></span> | <span class="t">truth objects there are for that particular image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4913" target="_blank">01:21:53.680</a></span> | <span class="t">So let's call that m.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4917" target="_blank">01:21:57.600</a></span> | <span class="t">So we need a loss function that can take these two things and spit out a number that says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4926" target="_blank">01:22:06.600</a></span> | <span class="t">how good are these activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4931" target="_blank">01:22:11.520</a></span> | <span class="t">That's what we're trying to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4934" target="_blank">01:22:14.720</a></span> | <span class="t">So to do it, we need to take each one of these m ground truth objects and decide which set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4947" target="_blank">01:22:27.840</a></span> | <span class="t">of 4+c activations is responsible for that object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4954" target="_blank">01:22:34.200</a></span> | <span class="t">Which one should we be comparing and saying it's the right class or not, and yeah it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4960" target="_blank">01:22:40.600</a></span> | <span class="t">close or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4965" target="_blank">01:22:45.560</a></span> | <span class="t">The way we do that is basically to say let's decide the first 4+c activations are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4976" target="_blank">01:22:56.360</a></span> | <span class="t">to be responsible for predicting the bounding box of the thing that's closest to the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4981" target="_blank">01:23:01.880</a></span> | <span class="t">left, and the last 4+c you'll be predicting the furthest to the bottom right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4989" target="_blank">01:23:09.640</a></span> | <span class="t">And then of course we're not using the YOLO approach where we have a single vector, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=4998" target="_blank">01:23:18.800</a></span> | <span class="t">using the SSD approach where we spit out a convolutional output, which means that it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5007" target="_blank">01:23:27.320</a></span> | <span class="t">not arbitrary as to which we match up, but actually we want to match up the set of activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5014" target="_blank">01:23:34.360</a></span> | <span class="t">whose receptive field has the maximum density from where this real object is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5025" target="_blank">01:23:45.840</a></span> | <span class="t">But that's a minor tweak.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5029" target="_blank">01:23:49.080</a></span> | <span class="t">I guess the easy way to have taught this would be to start with the YOLO approach where it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5035" target="_blank">01:23:55.640</a></span> | <span class="t">just like an arbitrary vector and we can decide which activations correspond to which bound</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5041" target="_blank">01:24:01.000</a></span> | <span class="t">truth object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5042" target="_blank">01:24:02.000</a></span> | <span class="t">As long as it's consistent, it's got to be a consistent rule, because if in the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5047" target="_blank">01:24:07.800</a></span> | <span class="t">image the top left object corresponds with the first 4+c activations, and then the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5054" target="_blank">01:24:14.640</a></span> | <span class="t">image we threw things around and suddenly it's now going with the last 4+c activations,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5062" target="_blank">01:24:22.200</a></span> | <span class="t">the neural net doesn't know what to learn, but the loss function needs to be some consistent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5069" target="_blank">01:24:29.400</a></span> | <span class="t">task, which in this case the consistent task is try to make these activations reflect the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5077" target="_blank">01:24:37.200</a></span> | <span class="t">bounding box in this general area.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5081" target="_blank">01:24:41.240</a></span> | <span class="t">That's basically what this loss function is trying to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5088" target="_blank">01:24:48.160</a></span> | <span class="t">Is it purely coincident that the 4x4 in the conv2D is the same thing as year 16?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5094" target="_blank">01:24:54.680</a></span> | <span class="t">No, not at all coincidence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5101" target="_blank">01:25:01.040</a></span> | <span class="t">That 4x4 conv is going to give us activations whose receptive field corresponds to those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5108" target="_blank">01:25:08.480</a></span> | <span class="t">locations in the input image, so it's carefully designed to make that as effective as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5116" target="_blank">01:25:16.560</a></span> | <span class="t">Now remember I told you before part 2 that the stuff we learn in part 2 is going to assume</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5124" target="_blank">01:25:24.680</a></span> | <span class="t">that you are extremely comfortable with everything you learn in part 1?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5129" target="_blank">01:25:29.440</a></span> | <span class="t">And for a lot of you, you might be realizing now maybe I wasn't quite as familiar with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5135" target="_blank">01:25:35.080</a></span> | <span class="t">the stuff in part 1 as I first thought, and that's fine, but just realize you might just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5139" target="_blank">01:25:39.800</a></span> | <span class="t">have to go back and really think deeply and experiment more with understanding what are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5147" target="_blank">01:25:47.200</a></span> | <span class="t">the inputs and outputs to each layer in a convolutional network, how big are they, what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5151" target="_blank">01:25:51.440</a></span> | <span class="t">are their rank, exactly how are they calculated, so that you really fully understand the idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5156" target="_blank">01:25:56.000</a></span> | <span class="t">of a receptive field.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5157" target="_blank">01:25:57.760</a></span> | <span class="t">What's the loss function really, how does backpropagation work exactly?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5162" target="_blank">01:26:02.920</a></span> | <span class="t">These things all need to be deeply felt intuitions, which you only get through to practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5171" target="_blank">01:26:11.720</a></span> | <span class="t">And once they're all deeply felt intuitions, then you can rewatch this video and you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5177" target="_blank">01:26:17.800</a></span> | <span class="t">be like, oh, I see, okay, I see that these activations just need some way of understanding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5188" target="_blank">01:26:28.720</a></span> | <span class="t">what task they're being given, and that is being done by the loss function and the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5193" target="_blank">01:26:33.000</a></span> | <span class="t">function is encoding a task.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5196" target="_blank">01:26:36.660</a></span> | <span class="t">And so the task of the SSD loss function is basically two parts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5202" target="_blank">01:26:42.640</a></span> | <span class="t">Part 1 is figure out which ground truth object is closest to which grid cell or which anchor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5211" target="_blank">01:26:51.120</a></span> | <span class="t">box.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5212" target="_blank">01:26:52.720</a></span> | <span class="t">When we started doing this, the grid cells of the convolution and the anchor boxes were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5217" target="_blank">01:26:57.440</a></span> | <span class="t">the same, but now we're starting to introduce the idea that we can have multiple anchor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5227" target="_blank">01:27:07.100</a></span> | <span class="t">boxes per grid cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5229" target="_blank">01:27:09.600</a></span> | <span class="t">So this is why it starts to get a little bit more complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5234" target="_blank">01:27:14.840</a></span> | <span class="t">So every ground truth object we have to figure out which anchor boxes are closest to, for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5240" target="_blank">01:27:20.520</a></span> | <span class="t">every anchor box we have to decide which ground truth object is responsible for, if any.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5247" target="_blank">01:27:27.200</a></span> | <span class="t">And once we've done that matching, it's trivial.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5251" target="_blank">01:27:31.540</a></span> | <span class="t">Now we just basically go through and do, going back to the single object detection, now it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5267" target="_blank">01:27:47.800</a></span> | <span class="t">just this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5270" target="_blank">01:27:50.840</a></span> | <span class="t">Once we've got every ground truth object matched to an anchor box, to a set of activations,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5276" target="_blank">01:27:56.560</a></span> | <span class="t">we can basically then say, OK, what's the cross-entropy loss of the categorical part?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5281" target="_blank">01:28:01.640</a></span> | <span class="t">What's the L1 loss of the coordinate part?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5286" target="_blank">01:28:06.680</a></span> | <span class="t">So really it's the matching part, which is kind of the slightly surprising bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5295" target="_blank">01:28:15.920</a></span> | <span class="t">And then this idea of picking those in a way that the convolutional network gives it the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5302" target="_blank">01:28:22.440</a></span> | <span class="t">best opportunity to calculate that part of the space, is then the final cherry on top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5312" target="_blank">01:28:32.800</a></span> | <span class="t">And this, I'll tell you something else, this class is by far going to be the most conceptually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5322" target="_blank">01:28:42.400</a></span> | <span class="t">challenging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5323" target="_blank">01:28:43.400</a></span> | <span class="t">And part of the reason for that is that after this, we're going to go and do some different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5329" target="_blank">01:28:49.000</a></span> | <span class="t">stuff, and we're going to come back to it in lesson 14 and do it again with some tweaks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5336" target="_blank">01:28:56.760</a></span> | <span class="t">And we're going to add in some of the new stuff we learned afterwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5340" target="_blank">01:29:00.600</a></span> | <span class="t">So you're going to get a whole second run through of this material, effectively, once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5346" target="_blank">01:29:06.440</a></span> | <span class="t">we add some extra stuff at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5348" target="_blank">01:29:08.840</a></span> | <span class="t">So we're going to revise it, as we normally do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5352" target="_blank">01:29:12.400</a></span> | <span class="t">So in part one, we kind of went through computer vision, NLP, structured data, back to NLP,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5359" target="_blank">01:29:19.560</a></span> | <span class="t">back to computer vision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5361" target="_blank">01:29:21.160</a></span> | <span class="t">So we revised everything from the start to the end, and it'll be kind of similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5368" target="_blank">01:29:28.400</a></span> | <span class="t">So don't worry if it's a bit challenging at first, you'll get there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5380" target="_blank">01:29:40.640</a></span> | <span class="t">So for every grid cell that can be different sizes, we can have different orientations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5387" target="_blank">01:29:47.320</a></span> | <span class="t">and zooms representing different anchor boxes, which are just like conceptual ideas that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5395" target="_blank">01:29:55.840</a></span> | <span class="t">basically every one of these is associated with one set of 4+C activations in our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5406" target="_blank">01:30:06.360</a></span> | <span class="t">So however many of these ground truth boxes we have, we need to have that times 4+C activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5415" target="_blank">01:30:15.440</a></span> | <span class="t">in the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5417" target="_blank">01:30:17.040</a></span> | <span class="t">Now that does not mean that each convolutional layer needs that many filters, because remember,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5425" target="_blank">01:30:25.360</a></span> | <span class="t">the 4x4 convolutional layer already has 16 sets of filters, the 2x2 convolutional layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5432" target="_blank">01:30:32.360</a></span> | <span class="t">already has four sets of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5438" target="_blank">01:30:38.080</a></span> | <span class="t">And then finally the 1x1 has one set of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5441" target="_blank">01:30:41.400</a></span> | <span class="t">So we basically get 1+4+16 for free, just because that's how a convolution works, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5449" target="_blank">01:30:49.440</a></span> | <span class="t">calculates things at different locations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5453" target="_blank">01:30:53.760</a></span> | <span class="t">So we actually only need to know k, where k is the number of zooms by the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5464" target="_blank">01:31:04.080</a></span> | <span class="t">aspect ratios, whereas the grids we're going to get for free through our architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5470" target="_blank">01:31:10.600</a></span> | <span class="t">So let's check out that architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5472" target="_blank">01:31:12.840</a></span> | <span class="t">So the model is nearly identical to what we had before, but we're going to have a number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5481" target="_blank">01:31:21.080</a></span> | <span class="t">of stride 2 convolutions, which is going to take us through to 4x4, 2x2, 1x1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5494" target="_blank">01:31:34.160</a></span> | <span class="t">Each stride 2 convolution halves our grid size in both directions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5501" target="_blank">01:31:41.400</a></span> | <span class="t">And then after we do our first convolution to get to 4x4, we're going to grab a set of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5508" target="_blank">01:31:48.760</a></span> | <span class="t">outputs from that, because we want to save away the 4x4 grid's anchors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5515" target="_blank">01:31:55.960</a></span> | <span class="t">And then once we get to 2x2, we grab another set of our 2x2 anchors, and then finally we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5523" target="_blank">01:32:03.800</a></span> | <span class="t">get to 1x1, so we get another set of outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5527" target="_blank">01:32:07.080</a></span> | <span class="t">So you can see we've got a whole bunch of these outcomes, this first one we're not using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5539" target="_blank">01:32:19.840</a></span> | <span class="t">So at the end of that we can then concatenate them all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5546" target="_blank">01:32:26.360</a></span> | <span class="t">So we've got the 4x4 activations, the 2x2 activations, the 1x1 activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5554" target="_blank">01:32:34.900</a></span> | <span class="t">So that's going to give us the correct number of activations to give us one activation for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5562" target="_blank">01:32:42.720</a></span> | <span class="t">every bounding, for every anchor box that we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5571" target="_blank">01:32:51.200</a></span> | <span class="t">So then we just set our criteria as before to SSD loss, and we go ahead and train, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5579" target="_blank">01:32:59.960</a></span> | <span class="t">away we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5584" target="_blank">01:33:04.960</a></span> | <span class="t">So in this case I'm just printing out those things, which are at least the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5590" target="_blank">01:33:10.280</a></span> | <span class="t">of 0.1, and you can see we've got -- some things look okay, some things don't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5596" target="_blank">01:33:16.560</a></span> | <span class="t">Our big objects like bird, we've got a box here with a 0.93 probability, it's looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5601" target="_blank">01:33:21.760</a></span> | <span class="t">to be in about the right spot, our person's looking pretty hopeful, but our motorbike</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5608" target="_blank">01:33:28.200</a></span> | <span class="t">has nothing at all with a probability of 0.1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5613" target="_blank">01:33:33.200</a></span> | <span class="t">Our pod of plants looking pretty horrible, our bus is all the wrong size, what's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5622" target="_blank">01:33:42.360</a></span> | <span class="t">on?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5623" target="_blank">01:33:43.880</a></span> | <span class="t">So what's going on here will tell us a lot about the history of object detection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5634" target="_blank">01:33:54.000</a></span> | <span class="t">And so these five papers are the key steps in the recent modern history of object detection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5645" target="_blank">01:34:05.480</a></span> | <span class="t">And so they go back to about, I think this is maybe 2013, this paper called Scalable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5650" target="_blank">01:34:10.040</a></span> | <span class="t">Object Detection Using Deep Neural Networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5652" target="_blank">01:34:12.580</a></span> | <span class="t">This is what basically set everything up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5654" target="_blank">01:34:14.600</a></span> | <span class="t">And when people refer to the multi-box method, they're talking about this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5660" target="_blank">01:34:20.160</a></span> | <span class="t">And this is the basic one that came up with this idea that you can have a loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5664" target="_blank">01:34:24.400</a></span> | <span class="t">that has this matching process, and then you can kind of use that to do object detection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5670" target="_blank">01:34:30.680</a></span> | <span class="t">So everything since that time has been trying to figure out basically how to make this better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5679" target="_blank">01:34:39.080</a></span> | <span class="t">So in parallel, there's a guy called Russ Gershik who was going down a totally different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5684" target="_blank">01:34:44.760</a></span> | <span class="t">direction, which was he had these two stage processes where the first stage used classical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5692" target="_blank">01:34:52.840</a></span> | <span class="t">computer vision approaches to find edges and changes of gradients and stuff to kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5699" target="_blank">01:34:59.400</a></span> | <span class="t">guess which parts of the image may represent distinct objects, and then fit each of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5706" target="_blank">01:35:06.600</a></span> | <span class="t">into a convolutional neural network, which was basically designed to figure out, is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5712" target="_blank">01:35:12.840</a></span> | <span class="t">actually the kind of object I'm interested in?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5715" target="_blank">01:35:15.960</a></span> | <span class="t">And so this was called the R-CNN, and then fast R-CNN, this kind of hybrid of traditional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5723" target="_blank">01:35:23.520</a></span> | <span class="t">computer vision and deep learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5727" target="_blank">01:35:27.000</a></span> | <span class="t">So what Russ and his team then did was they basically took this multi-box idea and replaced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5734" target="_blank">01:35:34.520</a></span> | <span class="t">the traditional non-deep learning computer vision part of their two stage process with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5740" target="_blank">01:35:40.960</a></span> | <span class="t">a ConvNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5741" target="_blank">01:35:41.960</a></span> | <span class="t">So they now had two ConvNets, one ConvNet that basically spat out something like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5747" target="_blank">01:35:47.760</a></span> | <span class="t">which he called these region proposals, all of the things that might be objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5753" target="_blank">01:35:53.400</a></span> | <span class="t">And then the second part was the same as his earlier work, it was basically something to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5757" target="_blank">01:35:57.520</a></span> | <span class="t">talk each of those, fit it into a separate ConvNet, which was designed to classify whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5763" target="_blank">01:36:03.200</a></span> | <span class="t">or not that particular thing really is an interesting object or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5769" target="_blank">01:36:09.840</a></span> | <span class="t">At a similar time, these two papers came out, YOLO and SSD, and both of these did something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5778" target="_blank">01:36:18.400</a></span> | <span class="t">pretty cool, which is they got the same kind of performance as fast R-CNN, but with one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5785" target="_blank">01:36:25.560</a></span> | <span class="t">stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5787" target="_blank">01:36:27.840</a></span> | <span class="t">And so they basically took the multi-box idea and they tried to figure out how to deal with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5793" target="_blank">01:36:33.520</a></span> | <span class="t">this mess that was done, and the basic ideas were to use, for example, a clinical hard-negative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5800" target="_blank">01:36:40.480</a></span> | <span class="t">mining where they would go through and find all of the matches that didn't look that good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5808" target="_blank">01:36:48.400</a></span> | <span class="t">and turn them away, some very tricky and complex data augmentation methods, all kinds of hackery,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5818" target="_blank">01:36:58.160</a></span> | <span class="t">basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5819" target="_blank">01:36:59.160</a></span> | <span class="t">But they got it to work pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5825" target="_blank">01:37:05.240</a></span> | <span class="t">But then something really cool happened late last year, which is this thing called focal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5829" target="_blank">01:37:09.280</a></span> | <span class="t">loss for dense object detection, where they actually realized why this messy crap wasn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5841" target="_blank">01:37:21.240</a></span> | <span class="t">working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5842" target="_blank">01:37:22.240</a></span> | <span class="t">And I'll describe why this messy crap wasn't working, by trying to describe why it is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5846" target="_blank">01:37:26.440</a></span> | <span class="t">we can't find a motorbike.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5849" target="_blank">01:37:29.300</a></span> | <span class="t">So here's the thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5854" target="_blank">01:37:34.960</a></span> | <span class="t">When we look at this, we have three different granularities of convolutional groups, 4x4,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5864" target="_blank">01:37:44.960</a></span> | <span class="t">2x2, 1x1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5868" target="_blank">01:37:48.440</a></span> | <span class="t">The 1x1 is quite likely to have a reasonable overlap with some object, because most people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5876" target="_blank">01:37:56.400</a></span> | <span class="t">photos have some kind of main subject.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5880" target="_blank">01:38:00.700</a></span> | <span class="t">On the other hand, in the 4x4, those 16 grid cells are unlikely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5887" target="_blank">01:38:07.220</a></span> | <span class="t">Most of them are not going to have much of an overlap with anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5889" target="_blank">01:38:09.820</a></span> | <span class="t">Like in this motorbike case, it's going to be sky, sky, sky, sky, sky, sky, sky, ground,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5896" target="_blank">01:38:16.340</a></span> | <span class="t">ground, ground, ground, ground, ground, and finally motorbike.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5899" target="_blank">01:38:19.100</a></span> | <span class="t">So if somebody was to say to you like, "20 buck bet, what do you reckon this little clip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5911" target="_blank">01:38:31.600</a></span> | <span class="t">is?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5912" target="_blank">01:38:32.600</a></span> | <span class="t">And you're not sure, you're going to say, "background."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5915" target="_blank">01:38:35.900</a></span> | <span class="t">Because most of the time it is background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5921" target="_blank">01:38:41.340</a></span> | <span class="t">And so here's the thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5928" target="_blank">01:38:48.660</a></span> | <span class="t">I understand why we have a 4x4 grid of receptive fields with one anchor box each to coarsely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5934" target="_blank">01:38:54.340</a></span> | <span class="t">localize objects in the image, but I think I'm missing is why we need multiple receptive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5939" target="_blank">01:38:59.180</a></span> | <span class="t">fields at different sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5941" target="_blank">01:39:01.300</a></span> | <span class="t">The first version already included 16 receptive fields each with a single anchor box associated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5946" target="_blank">01:39:06.860</a></span> | <span class="t">with the addition there are now many more anchor boxes to consider.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5952" target="_blank">01:39:12.140</a></span> | <span class="t">Is this because you constrained how much a receptive field could move or scale from its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5955" target="_blank">01:39:15.900</a></span> | <span class="t">original size or is there another reason?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5959" target="_blank">01:39:19.500</a></span> | <span class="t">It's kind of backwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5960" target="_blank">01:39:20.500</a></span> | <span class="t">The reason I did the constraining is because I knew I was going to be adding more anchor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5963" target="_blank">01:39:23.660</a></span> | <span class="t">boxes later, but really the reason is that the Jacquard overlap between one of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5971" target="_blank">01:39:31.860</a></span> | <span class="t">4x4 grid cells and a single object that takes up most of the image is never going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5981" target="_blank">01:39:41.220</a></span> | <span class="t">0.5 because the intersection is much smaller than the union because one object is too big.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5988" target="_blank">01:39:48.100</a></span> | <span class="t">So for this general idea of work where we're saying you're responsible for something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=5993" target="_blank">01:39:53.940</a></span> | <span class="t">you've got a better than 50% overlap with, we need anchor boxes which will on a regular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6003" target="_blank">01:40:03.500</a></span> | <span class="t">basis have a 50% or higher overlap, which means we need to have a variety of sizes and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6009" target="_blank">01:40:09.220</a></span> | <span class="t">shapes and scales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6014" target="_blank">01:40:14.880</a></span> | <span class="t">So this all happens in the last function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6020" target="_blank">01:40:20.540</a></span> | <span class="t">Basically the vast majority of the interesting stuff in all of the object detection stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6024" target="_blank">01:40:24.740</a></span> | <span class="t">is the last function because there is only three things, last function, architecture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6035" target="_blank">01:40:35.300</a></span> | <span class="t">data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6037" target="_blank">01:40:37.680</a></span> | <span class="t">So this is the focal loss paper, focal loss for dense object detection from August 2017.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6047" target="_blank">01:40:47.660</a></span> | <span class="t">Here's Ross Gershik still doing this stuff, climbing her.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6050" target="_blank">01:40:50.420</a></span> | <span class="t">You might recognize as being the ResNet guy, a bit of an all-star cast here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6057" target="_blank">01:40:57.380</a></span> | <span class="t">And the key thing is this very first picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6060" target="_blank">01:41:00.580</a></span> | <span class="t">The blue line is a picture of binary cross-entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6069" target="_blank">01:41:09.380</a></span> | <span class="t">The x-axis is what is the probability or what is the activation, what is the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6077" target="_blank">01:41:17.500</a></span> | <span class="t">of the ground truth class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6080" target="_blank">01:41:20.380</a></span> | <span class="t">So it's actually a motorbike, I said with 0.6 chance it's a motorbike, or it's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6087" target="_blank">01:41:27.720</a></span> | <span class="t">not a motorbike, and I said with 0.6 chance it's not a motorbike.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6092" target="_blank">01:41:32.580</a></span> | <span class="t">So this blue line represents the level of the value of cross-entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6097" target="_blank">01:41:37.940</a></span> | <span class="t">You can draw this in Excel or Python or whatever, this is just a simple plot of cross-entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6104" target="_blank">01:41:44.900</a></span> | <span class="t">loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6106" target="_blank">01:41:46.560</a></span> | <span class="t">So the point is, if the answer is, because remember we're doing binary cross-entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6112" target="_blank">01:41:52.700</a></span> | <span class="t">loss, if the answer is not a motorbike, and I said yeah I think it's not a motorbike,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6118" target="_blank">01:41:58.340</a></span> | <span class="t">I'm 0.6 sure it's not a motorbike.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6122" target="_blank">01:42:02.620</a></span> | <span class="t">This blue line is still at a loss of about 0.5, it's still pretty bad, so I actually have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6133" target="_blank">01:42:13.380</a></span> | <span class="t">to keep getting more and more confident that it's not a motorbike.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6137" target="_blank">01:42:17.500</a></span> | <span class="t">So if I want to get my loss down, then for all of these things which are actually background,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6144" target="_blank">01:42:24.020</a></span> | <span class="t">I have to be saying like, I am sure that's background, or I'm sure it's not a motorbike</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6148" target="_blank">01:42:28.980</a></span> | <span class="t">or a bus or a person or a dining room table.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6152" target="_blank">01:42:32.980</a></span> | <span class="t">Because if I don't say I'm sure it's not any of these things, then I still get loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6160" target="_blank">01:42:40.240</a></span> | <span class="t">So that's why this doesn't work, because even when it gets to here, and it wants to say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6171" target="_blank">01:42:51.740</a></span> | <span class="t">I think it's a motorbike, there's no payoff for it to say so, because if it's wrong, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6179" target="_blank">01:42:59.780</a></span> | <span class="t">gets killed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6180" target="_blank">01:43:00.780</a></span> | <span class="t">And the vast majority of the time, it's not anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6184" target="_blank">01:43:04.940</a></span> | <span class="t">The vast majority of the time it's background.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6186" target="_blank">01:43:06.820</a></span> | <span class="t">And even if it's not background, it's not enough just to say it's not background, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6190" target="_blank">01:43:10.100</a></span> | <span class="t">could say, which of the 20 things it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6193" target="_blank">01:43:13.060</a></span> | <span class="t">So for the really big things, it's fine, because that's the one by one grid, so it generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6199" target="_blank">01:43:19.920</a></span> | <span class="t">is a thing, and you just have to figure out which thing it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6203" target="_blank">01:43:23.540</a></span> | <span class="t">Or else for these small ones, generally it's not anything, so generally small ones would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6209" target="_blank">01:43:29.140</a></span> | <span class="t">just prefer to be like, I've got nothing to say, no comment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6216" target="_blank">01:43:36.580</a></span> | <span class="t">So that's why this is empty, and that's why even when we do have a bus, it's using a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6226" target="_blank">01:43:46.460</a></span> | <span class="t">big grid cell to say it's a bus, because these are the only ones where it's confident enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6233" target="_blank">01:43:53.020</a></span> | <span class="t">to make a call that it's something, because the small grid cells very rarely are something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6240" target="_blank">01:44:00.260</a></span> | <span class="t">So the trick is to try and find a different loss function instead of binary cross-entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6245" target="_blank">01:44:05.180</a></span> | <span class="t">loss that doesn't look like the blue line, but looks more like the green or purple line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6250" target="_blank">01:44:10.700</a></span> | <span class="t">And they actually end up suggesting the purple line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6253" target="_blank">01:44:13.860</a></span> | <span class="t">And so it turns out this is cross-entropy loss, negative log p_t, focal loss is simply 1 - p_t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6263" target="_blank">01:44:23.200</a></span> | <span class="t">to the gamma, where gamma is some parameter, and they recommend using 2, times the cross-entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6273" target="_blank">01:44:33.100</a></span> | <span class="t">loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6274" target="_blank">01:44:34.100</a></span> | <span class="t">So it's literally just a scaling of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6278" target="_blank">01:44:38.740</a></span> | <span class="t">And so that takes you to, if you use gamma equals 2, that takes you to this purple line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6282" target="_blank">01:44:42.980</a></span> | <span class="t">So now if we say, I'm 0.6 sure that it's not a motorbike, then the loss function is like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6290" target="_blank">01:44:50.940</a></span> | <span class="t">good for you, no worries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6294" target="_blank">01:44:54.900</a></span> | <span class="t">So that's what we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6296" target="_blank">01:44:56.100</a></span> | <span class="t">We want to replace cross-entropy loss with focal loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6300" target="_blank">01:45:00.340</a></span> | <span class="t">And I mentioned a couple of things about this fantastic paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6303" target="_blank">01:45:03.780</a></span> | <span class="t">The first is, the actual contribution of this paper is to add 1 - p_t to the gamma to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6312" target="_blank">01:45:12.280</a></span> | <span class="t">start of this equation, which sounds like nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6316" target="_blank">01:45:16.300</a></span> | <span class="t">But actually people have been trying to figure out this damn problem for years, and I'm not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6320" target="_blank">01:45:20.860</a></span> | <span class="t">even sure they'd realize it's a problem, there's just this assumption that object detection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6326" target="_blank">01:45:26.860</a></span> | <span class="t">is really hard, and you have to do all of these complex data augmentations, and hard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6333" target="_blank">01:45:33.300</a></span> | <span class="t">negative mining and blah, blah, blah to get the damn thing to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6337" target="_blank">01:45:37.300</a></span> | <span class="t">So A, it's like this recognition of, why are we doing all of those things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6342" target="_blank">01:45:42.540</a></span> | <span class="t">And then this realization of, oh, if I do that it goes away, it's fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6349" target="_blank">01:45:49.500</a></span> | <span class="t">So when you come across a paper like this, which is like game-changing, you shouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6355" target="_blank">01:45:55.580</a></span> | <span class="t">assume that you're going to have to write 100,000 lines of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6360" target="_blank">01:46:00.140</a></span> | <span class="t">Very often it's one line of code, or the change of a single constant, or adding log to a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6367" target="_blank">01:46:07.220</a></span> | <span class="t">place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6368" target="_blank">01:46:08.220</a></span> | <span class="t">So let's go down to the bit where it all happens, where they describe focal loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6375" target="_blank">01:46:15.140</a></span> | <span class="t">And I just wanted to point out a couple of terrific things about this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6378" target="_blank">01:46:18.860</a></span> | <span class="t">The first is, here is their definition of cross-entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6383" target="_blank">01:46:23.100</a></span> | <span class="t">And if you're not able to write cross-entropy on a piece of paper right now, then you need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6387" target="_blank">01:46:27.940</a></span> | <span class="t">to go back and study it, because we've got to be assuming what it is, what it means,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6394" target="_blank">01:46:34.260</a></span> | <span class="t">why it's that, what the shape of it looks like, cross-entropy appears everywhere, binary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6398" target="_blank">01:46:38.420</a></span> | <span class="t">cross-entropy, and categorical cross-entropy, and the softmax that appears there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6406" target="_blank">01:46:46.940</a></span> | <span class="t">Most of the time we'll see cross-entropy written as an indicator on Y times log P plus an indicator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6417" target="_blank">01:46:57.660</a></span> | <span class="t">on Y of 1 minus Y times log 1 minus P. This is like a kind of awkward notation, often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6425" target="_blank">01:47:05.880</a></span> | <span class="t">people will use like a Dirac delta function, stupid stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6430" target="_blank">01:47:10.060</a></span> | <span class="t">Or else this paper just says, you know what, it's just a conditional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6434" target="_blank">01:47:14.100</a></span> | <span class="t">Cross-entropy simply is negative log P if Y is 1, negative log 1 minus P, otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6441" target="_blank">01:47:21.140</a></span> | <span class="t">So Y is 1 if it's a motorbike, 0 if not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6446" target="_blank">01:47:26.460</a></span> | <span class="t">In this paper they say 1 if it's a motorbike, or negative 1 if not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6453" target="_blank">01:47:33.820</a></span> | <span class="t">And then they do something which mathematicians never do, they refactor, check this out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6459" target="_blank">01:47:39.980</a></span> | <span class="t">Hey, what if we replace, what if we define a new term called PT which is equal to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6466" target="_blank">01:47:46.140</a></span> | <span class="t">probability if Y is 1 or 1 minus P otherwise, if we did that we could now redefine CE as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6473" target="_blank">01:47:53.740</a></span> | <span class="t">that, which is super cool, like it's such an obvious thing to do, but as soon as you do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6482" target="_blank">01:48:02.380</a></span> | <span class="t">it all of the other equations get simpler as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6485" target="_blank">01:48:05.540</a></span> | <span class="t">Because later on, in the very next paragraph, they say, hey, one way to deal with class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6491" target="_blank">01:48:11.860</a></span> | <span class="t">imbalance, i.e. lots of stuff is background, would just be to have a different weighting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6496" target="_blank">01:48:16.820</a></span> | <span class="t">factor for background versus not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6499" target="_blank">01:48:19.860</a></span> | <span class="t">So for class 1 we'll have some number alpha, and for class 0 we'll have 1 minus alpha.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6510" target="_blank">01:48:30.860</a></span> | <span class="t">But then they're like, hey, let's define alpha_t the same way, and so now our cross-entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6516" target="_blank">01:48:36.260</a></span> | <span class="t">with a weighting factor can be written like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6520" target="_blank">01:48:40.020</a></span> | <span class="t">And so then they can write their focal loss with the same concept, and then eventually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6525" target="_blank">01:48:45.900</a></span> | <span class="t">they say, hey, let's take focal loss and combine it with class weighting, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6532" target="_blank">01:48:52.940</a></span> | <span class="t">So often when you see in a paper huge big equations, it's just because mathematicians</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6538" target="_blank">01:48:58.020</a></span> | <span class="t">don't know how to read back that, and you'll see the same pieces are repeated all over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6542" target="_blank">01:49:02.100</a></span> | <span class="t">the place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6543" target="_blank">01:49:03.100</a></span> | <span class="t">Very, very, very often.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6545" target="_blank">01:49:05.140</a></span> | <span class="t">And by the time you've turned it into numpy code, suddenly it's super simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6550" target="_blank">01:49:10.940</a></span> | <span class="t">So this is a million times better than nearly any other paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6557" target="_blank">01:49:17.060</a></span> | <span class="t">So it's a great paper to read to understand how papers should be, a terrible paper to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6562" target="_blank">01:49:22.140</a></span> | <span class="t">read to understand what most papers look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6567" target="_blank">01:49:27.740</a></span> | <span class="t">So let's try this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6568" target="_blank">01:49:28.740</a></span> | <span class="t">We're going to use this here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6571" target="_blank">01:49:31.740</a></span> | <span class="t">Now remember negative log p is the cross-entropy loss, so therefore this is just equal to some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6579" target="_blank">01:49:39.140</a></span> | <span class="t">number times the cross-entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6583" target="_blank">01:49:43.460</a></span> | <span class="t">And when I defined the binomial cross-entropy loss, I don't know if you remember or if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6593" target="_blank">01:49:53.580</a></span> | <span class="t">noticed, but I had a weight which by default was none.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6604" target="_blank">01:50:04.820</a></span> | <span class="t">And when you call binary cross-entropy with logits, the PyTorch thing, you can optionally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6609" target="_blank">01:50:09.780</a></span> | <span class="t">pass that away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6610" target="_blank">01:50:10.780</a></span> | <span class="t">That is something that's modified by everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6613" target="_blank">01:50:13.260</a></span> | <span class="t">And if it's none, then there's no way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6615" target="_blank">01:50:15.300</a></span> | <span class="t">So since we're just going to multiply cross-entropy by something, we can just define get_weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6624" target="_blank">01:50:24.640</a></span> | <span class="t">So here's the entirety of paper loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6629" target="_blank">01:50:29.820</a></span> | <span class="t">This is the thing that suddenly made object detection make sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6636" target="_blank">01:50:36.420</a></span> | <span class="t">So this was late last year, suddenly it got rid of all of the complex messy hackery.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6644" target="_blank">01:50:44.820</a></span> | <span class="t">And so we do our sigmoid, here's our p(t), here's our w, and here you can see 1 minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6654" target="_blank">01:50:54.460</a></span> | <span class="t">p(t)^gamma, and so we're going to set gamma of 2, alpha of 0.25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6661" target="_blank">01:51:01.260</a></span> | <span class="t">If you're wondering why, here's another excellent thing about this paper, because they tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6666" target="_blank">01:51:06.980</a></span> | <span class="t">lots of different values of gamma and alpha, and they found that 2 and 0.25 work well consistently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6676" target="_blank">01:51:16.980</a></span> | <span class="t">So there's our new_loss function, it derives from our bce_loss, adding a weight to it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6684" target="_blank">01:51:24.900</a></span> | <span class="t">focal_loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6685" target="_blank">01:51:25.900</a></span> | <span class="t">Other than that, there's nothing else to do, we can just train our model again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6692" target="_blank">01:51:32.940</a></span> | <span class="t">And so this time, things are looking quite a bit better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6698" target="_blank">01:51:38.140</a></span> | <span class="t">We now have motorbike, bicycle, person, motorbike...it's actually having a go at finding something here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6708" target="_blank">01:51:48.780</a></span> | <span class="t">It's still doing a good job with big ones, in fact it's looking quite a lot better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6713" target="_blank">01:51:53.220</a></span> | <span class="t">It's finding quite a few people, it's finding a couple of different birds, it's looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6718" target="_blank">01:51:58.380</a></span> | <span class="t">pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6720" target="_blank">01:52:00.100</a></span> | <span class="t">So our last step is to basically figure out how to pull out just the interesting stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6729" target="_blank">01:52:09.220</a></span> | <span class="t">out of...let's take this dog and this sofa, how do we pick out our dog and our sofa?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6735" target="_blank">01:52:15.180</a></span> | <span class="t">And the answer is incredibly simple, all we're going to do is we're going to go through every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6741" target="_blank">01:52:21.660</a></span> | <span class="t">pair of these bounding boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6745" target="_blank">01:52:25.700</a></span> | <span class="t">And if they overlap by more than some amount, say 0.5 using jaccard, and they both are predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6754" target="_blank">01:52:34.220</a></span> | <span class="t">the same class, we're going to assume they're the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6756" target="_blank">01:52:36.900</a></span> | <span class="t">And we're just going to pick the one with the higher p-value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6761" target="_blank">01:52:41.140</a></span> | <span class="t">And we just keep doing that repeatedly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6764" target="_blank">01:52:44.500</a></span> | <span class="t">That's really boring code, I actually didn't write it myself, I copied it off somebody else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6768" target="_blank">01:52:48.380</a></span> | <span class="t">Somebody else's code, non-maximum suppression, NMS, no reason particularly to go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6774" target="_blank">01:52:54.940</a></span> | <span class="t">it, but that's all it does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6777" target="_blank">01:52:57.780</a></span> | <span class="t">So we can now show the results of the non-maximum suppression, and here's the sofa, here's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6786" target="_blank">01:53:06.020</a></span> | <span class="t">dog, here's the bird, here's the person.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6794" target="_blank">01:53:14.220</a></span> | <span class="t">This person's cigarette looks like it's like a firework or something, I don't know what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6800" target="_blank">01:53:20.140</a></span> | <span class="t">going on there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6801" target="_blank">01:53:21.140</a></span> | <span class="t">But it's fine, it's okay but not great, it's found a person in his bicycle, and a person</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6806" target="_blank">01:53:26.820</a></span> | <span class="t">in his bicycle with his bicycle is in the wrong place, and this person is in the wrong</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6812" target="_blank">01:53:32.740</a></span> | <span class="t">place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6813" target="_blank">01:53:33.740</a></span> | <span class="t">You can also see that some of these smaller things have lower p-values than the tote,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6818" target="_blank">01:53:38.140</a></span> | <span class="t">like the motorbike is just 0.16, this is same time, or bus, so there's some things still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6825" target="_blank">01:53:45.180</a></span> | <span class="t">there, and the trick will be to use something called feature theorems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6831" target="_blank">01:53:51.180</a></span> | <span class="t">And that's what we're going to do in lesson 14, or thereabouts, and that'll fix this up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6844" target="_blank">01:54:04.340</a></span> | <span class="t">What I wanted to do in the last few minutes of class was to talk a little bit more about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6854" target="_blank">01:54:14.420</a></span> | <span class="t">the papers, and specifically to go back to the SSD paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6861" target="_blank">01:54:21.180</a></span> | <span class="t">So this is single shot multi-box detector, and when this came out I was very excited</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6867" target="_blank">01:54:27.380</a></span> | <span class="t">because it was kind of, you know, it and YOLO were like the first kind of single pass, good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6878" target="_blank">01:54:38.660</a></span> | <span class="t">quality object detection methods that had come along.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6883" target="_blank">01:54:43.420</a></span> | <span class="t">And so I kind of ignored object detection until this time, all this two-pass stuff with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6888" target="_blank">01:54:48.700</a></span> | <span class="t">RCNN, and fast RCNN, and faster RCNN, because there's been this kind of continuous repetition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6897" target="_blank">01:54:57.580</a></span> | <span class="t">of history in the deep learning world, which is things that involve multiple passes of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6904" target="_blank">01:55:04.620</a></span> | <span class="t">multiple different pieces over time, you know, particularly where they involve some long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6910" target="_blank">01:55:10.020</a></span> | <span class="t">deep learning pieces, like RCNN and fast RCNN did, over time they basically always get turned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6918" target="_blank">01:55:18.060</a></span> | <span class="t">into a single end-to-end deep learning model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6921" target="_blank">01:55:21.460</a></span> | <span class="t">So I tend to kind of ignore them until that happens, because that's the point where it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6926" target="_blank">01:55:26.420</a></span> | <span class="t">like okay, now people have figured out how to show this as a deep learning problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6930" target="_blank">01:55:30.900</a></span> | <span class="t">As soon as people do that, they generally end up with something that's much faster and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6935" target="_blank">01:55:35.380</a></span> | <span class="t">much more accurate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6937" target="_blank">01:55:37.380</a></span> | <span class="t">And so SSD and YOLO are really important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6940" target="_blank">01:55:40.500</a></span> | <span class="t">So here's the SSD paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6945" target="_blank">01:55:45.100</a></span> | <span class="t">Let's go down to the key piece, which is where they describe the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6950" target="_blank">01:55:50.180</a></span> | <span class="t">And let's try and understand it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6957" target="_blank">01:55:57.260</a></span> | <span class="t">So the model is basically 1, 2, 3, 4 paragraphs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6971" target="_blank">01:56:11.060</a></span> | <span class="t">So papers are really concise, which means you kind of need to read them pretty carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6979" target="_blank">01:56:19.420</a></span> | <span class="t">Partly, though, you need to know which bits to read carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6983" target="_blank">01:56:23.180</a></span> | <span class="t">So the bits where they say here we're going to prove the error bounds on this model, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6989" target="_blank">01:56:29.380</a></span> | <span class="t">can ignore that, because you don't care about proving the error bounds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6992" target="_blank">01:56:32.660</a></span> | <span class="t">But the bit which says here is what the model is, is the bit you need to read really carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=6998" target="_blank">01:56:38.580</a></span> | <span class="t">So here's the bit called model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7001" target="_blank">01:56:41.340</a></span> | <span class="t">And so hopefully you'll find we can now read this together and understand it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7005" target="_blank">01:56:45.620</a></span> | <span class="t">So SSD is a feed-forward conflict and it creates a fixed-size collection of bounding boxes and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7012" target="_blank">01:56:52.540</a></span> | <span class="t">scores for the presence of object class instances in those boxes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7016" target="_blank">01:56:56.940</a></span> | <span class="t">So fixed-size, i.e. the convolutional grid times k, the different aspect ratios and stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7027" target="_blank">01:57:07.020</a></span> | <span class="t">and each one of those has 4+c activations, followed by a non-maximum suppression step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7036" target="_blank">01:57:16.620</a></span> | <span class="t">to take that massive dump and turn it into just a couple of non-overlapping different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7043" target="_blank">01:57:23.340</a></span> | <span class="t">objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7044" target="_blank">01:57:24.340</a></span> | <span class="t">The early layers are based on a standard architecture, so we just use ResNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7050" target="_blank">01:57:30.100</a></span> | <span class="t">This is pretty standard, as you can kind of see this consistent theme, particularly in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7055" target="_blank">01:57:35.620</a></span> | <span class="t">how the fast-ai library tries to do things, which is grab a pre-trained network that already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7060" target="_blank">01:57:40.700</a></span> | <span class="t">does something, pull off the end bits, stick on a new end bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7064" target="_blank">01:57:44.660</a></span> | <span class="t">So early network layers, if we use a standard classifier, truncate the classification layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7071" target="_blank">01:57:51.500</a></span> | <span class="t">as we always do, that happens automatically when we use Concloner, and we call this the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7076" target="_blank">01:57:56.480</a></span> | <span class="t">base network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7077" target="_blank">01:57:57.900</a></span> | <span class="t">Some papers call that the backbone, and we then add an auxiliary structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7085" target="_blank">01:58:05.740</a></span> | <span class="t">So the auxiliary structure, which we call the custom head, has multiscale feature mass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7091" target="_blank">01:58:11.660</a></span> | <span class="t">So we add convolutional layers to the end of this base network, and they decrease in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7097" target="_blank">01:58:17.300</a></span> | <span class="t">size progressively, so a bunch of strive-to conflays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7102" target="_blank">01:58:22.900</a></span> | <span class="t">So that allows predictions of detections at multiple scales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7106" target="_blank">01:58:26.580</a></span> | <span class="t">The grid cells are a different size at each of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7111" target="_blank">01:58:31.100</a></span> | <span class="t">The model is different for each feature layer compared to YOLO that operate on a single feature</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7119" target="_blank">01:58:39.420</a></span> | <span class="t">map, so YOLO is one vector, whereas we have different convales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7127" target="_blank">01:58:47.540</a></span> | <span class="t">Each added feature layer gives you a fixed set of predictions using a bunch of filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7135" target="_blank">01:58:55.460</a></span> | <span class="t">For a filter layer where the grid size is N by N, 4 by 4, with P channels, let's take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7142" target="_blank">01:59:02.980</a></span> | <span class="t">the previous one, 7 by 7 with 5 channels of channels, the basic element is going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7149" target="_blank">01:59:09.060</a></span> | <span class="t">3 by 3 by P kernel, which in our case is a 3 by 3 by 4 for the shape offset bit, or 3</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7162" target="_blank">01:59:22.180</a></span> | <span class="t">by 3 by C for the score for a category.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7166" target="_blank">01:59:26.580</a></span> | <span class="t">So those are those two pieces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7170" target="_blank">01:59:30.140</a></span> | <span class="t">At each of those grid cell locations, it's going to produce an output value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7176" target="_blank">01:59:36.580</a></span> | <span class="t">And the bounding box offsets are measured relative to a default box position, which we've been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7184" target="_blank">01:59:44.380</a></span> | <span class="t">calling an anchor box position, relative to the feature map location, what we've been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7191" target="_blank">01:59:51.080</a></span> | <span class="t">calling the grid cell, as opposed to YOLO, which has a poly-connected layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7201" target="_blank">02:00:01.540</a></span> | <span class="t">And then they go on to describe the default boxes, what they are for each feature map</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7207" target="_blank">02:00:07.420</a></span> | <span class="t">cell, or what we would say grid cell, they tile the feature map in a convolutional manner,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7213" target="_blank">02:00:13.540</a></span> | <span class="t">so the position of each box relative to its grid cell is fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7218" target="_blank">02:00:18.260</a></span> | <span class="t">So hopefully you can see we end up with C+4*K filters if there are K boxes at each location.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7232" target="_blank">02:00:32.420</a></span> | <span class="t">So these are similar to the anchor boxes described in the past class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7236" target="_blank">02:00:36.960</a></span> | <span class="t">So if you jump straight in and read a paper like this without knowing what problem they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7243" target="_blank">02:00:43.900</a></span> | <span class="t">solving and why are they solving it and what's the kind of non-actature and so forth, those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7249" target="_blank">02:00:49.020</a></span> | <span class="t">four paragraphs would probably make almost no sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7251" target="_blank">02:00:51.820</a></span> | <span class="t">But now that we've gone through it, you read those four paragraphs and hopefully you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7255" target="_blank">02:00:55.860</a></span> | <span class="t">thinking, "Oh, that's just what Jeremy said, only they said it better than Jeremy in less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7263" target="_blank">02:01:03.620</a></span> | <span class="t">words."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7264" target="_blank">02:01:04.620</a></span> | <span class="t">So I have the same problem, when I started reading the SSD paper and I read those four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7273" target="_blank">02:01:13.900</a></span> | <span class="t">paragraphs and I didn't have before this time much of a background in object detection because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7277" target="_blank">02:01:17.200</a></span> | <span class="t">I had decided to wait until these two passed anymore, so I read this and I was like, "What</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7283" target="_blank">02:01:23.260</a></span> | <span class="t">the hell?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7284" target="_blank">02:01:24.260</a></span> | <span class="t">And so the trick is to then start reading back over the citations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7289" target="_blank">02:01:29.740</a></span> | <span class="t">So for example, and you should go back and read this paper now, look, here's the matching</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7295" target="_blank">02:01:35.060</a></span> | <span class="t">strategy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7296" target="_blank">02:01:36.060</a></span> | <span class="t">And that whole matching strategy that I somehow spent an hour talking about, that's just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7302" target="_blank">02:01:42.100</a></span> | <span class="t">paragraph.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7303" target="_blank">02:01:43.100</a></span> | <span class="t">But it really is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7304" target="_blank">02:01:44.380</a></span> | <span class="t">For each ground truth, we select from default boxes based on location, aspect ratio, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7311" target="_blank">02:01:51.660</a></span> | <span class="t">scale.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7312" target="_blank">02:01:52.660</a></span> | <span class="t">We match each ground truth to the default box with the best jaccade overlap.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7317" target="_blank">02:01:57.380</a></span> | <span class="t">And then we match default boxes to anything with the jaccade overlap higher than 25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7322" target="_blank">02:02:02.380</a></span> | <span class="t">That's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7323" target="_blank">02:02:03.380</a></span> | <span class="t">That's the one-sentence version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7326" target="_blank">02:02:06.820</a></span> | <span class="t">And then we've got the loss function, which is basically to say, take the average of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7334" target="_blank">02:02:14.900</a></span> | <span class="t">loss based on the classes plus the loss based on localization with some weighting factor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7346" target="_blank">02:02:26.380</a></span> | <span class="t">Now with focal loss, I found I didn't really need the weighting factor anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7349" target="_blank">02:02:29.420</a></span> | <span class="t">They both had about the same scale, just a coincidence perhaps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7355" target="_blank">02:02:35.580</a></span> | <span class="t">But in this case, as I started reading this, I didn't really understand exactly what L</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7360" target="_blank">02:02:40.420</a></span> | <span class="t">and G and all this stuff was, but it says, well, this is derived from the multibox objective.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7365" target="_blank">02:02:45.820</a></span> | <span class="t">So then I went back to the paper that defined multibox, and I found in their proposed approach,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7374" target="_blank">02:02:54.060</a></span> | <span class="t">they've also got a section called training objective, also known as loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7383" target="_blank">02:03:03.140</a></span> | <span class="t">And here I can see it's the same notation, L, G, blah, blah, blah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7388" target="_blank">02:03:08.460</a></span> | <span class="t">And so this is where I can go back and see the detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7392" target="_blank">02:03:12.700</a></span> | <span class="t">And after you read a bunch of papers, you'll start to see things very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7397" target="_blank">02:03:17.180</a></span> | <span class="t">For example, when you see these double bars, 2, 2, you'll realize every time there's mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7402" target="_blank">02:03:22.220</a></span> | <span class="t">squared error, that's how you write mean squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7405" target="_blank">02:03:25.700</a></span> | <span class="t">This is actually called the 2-norm, the 2-norm is just the sum of squared differences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7411" target="_blank">02:03:31.620</a></span> | <span class="t">And then this 2 up here means normally they take the square root, so we just undo the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7417" target="_blank">02:03:37.060</a></span> | <span class="t">square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7418" target="_blank">02:03:38.060</a></span> | <span class="t">So this is just MSE.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7420" target="_blank">02:03:40.140</a></span> | <span class="t">Any time you see here's a log C and here's a log of y minus C, you know that's basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7424" target="_blank">02:03:44.860</a></span> | <span class="t">a binary cross-entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7426" target="_blank">02:03:46.900</a></span> | <span class="t">So it's like, you're not actually going to have to read every bit of every equation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7434" target="_blank">02:03:54.140</a></span> | <span class="t">You are kind of a bit at first, but after a while your brain just like immediately knows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7442" target="_blank">02:04:02.380</a></span> | <span class="t">basically what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7443" target="_blank">02:04:03.780</a></span> | <span class="t">And then I say, oh, I've got a log C up and a log 1 minus C, and as expected I should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7448" target="_blank">02:04:08.140</a></span> | <span class="t">have my x, and here's my 1 minus x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7450" target="_blank">02:04:10.060</a></span> | <span class="t">Okay, there's all the pieces there that I would expect to see in a binary cross-entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7457" target="_blank">02:04:17.620</a></span> | <span class="t">So then having done that, that then kind of allowed me, and then they get combined with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7462" target="_blank">02:04:22.900</a></span> | <span class="t">the two pieces, and oh, there's the multiplier that I expected, and so now I can kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7468" target="_blank">02:04:28.340</a></span> | <span class="t">come back here and understand what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7473" target="_blank">02:04:33.020</a></span> | <span class="t">So we're going to be looking at a lot more papers, but maybe this week, go through the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7480" target="_blank">02:04:40.740</a></span> | <span class="t">code and go through the paper and be like, what's going on?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7487" target="_blank">02:04:47.580</a></span> | <span class="t">And remember, what I did to make it easier for you was I took that loss function, I copied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7494" target="_blank">02:04:54.980</a></span> | <span class="t">it into a cell, and then I split it up so that each bit was in a separate cell, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7501" target="_blank">02:05:01.980</a></span> | <span class="t">then after every cell, I either printed or plotted that value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7508" target="_blank">02:05:08.860</a></span> | <span class="t">So if I hadn't done that for you, you should do it yourself, because there's no way you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7513" target="_blank">02:05:13.820</a></span> | <span class="t">can understand these functions without putting things in and seeing what comes down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7520" target="_blank">02:05:20.380</a></span> | <span class="t">So hopefully this is kind of a good starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=0frKXR-2PBY&t=7527" target="_blank">02:05:27.940</a></span> | <span class="t">Thanks everybody, have a great week, and see you next Monday.</span></div></div></body></html>