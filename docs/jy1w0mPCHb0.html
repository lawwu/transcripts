<html><head><title>Lesson 12: Cutting Edge Deep Learning for Coders</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 12: Cutting Edge Deep Learning for Coders</h2><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0"><img src="https://i.ytimg.com/vi_webp/jy1w0mPCHb0/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=411">6:51</a> find initial centroids<br><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=768">12:48</a> use standard python loops<br><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1862">31:2</a> partition the data into some number of partitions<br><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2110">35:10</a> using the five dimensional clustering<br><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2887">48:7</a> look at a couple of examples of list comprehensions<br><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3220">53:40</a> start out by creating two arrays of zeros<br><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3638">60:38</a> combine the matrices<br><br><div style="text-align: left;"><a href="./jy1w0mPCHb0.html">Whisper Transcript</a> | <a href="./transcript_jy1w0mPCHb0.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">I'm just going to start by going back to clustering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=7" target="_blank">00:00:07.740</a></span> | <span class="t">We're going to talk about clustering again in the next lesson or two in terms of an application</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=12" target="_blank">00:00:12.320</a></span> | <span class="t">of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=15" target="_blank">00:00:15.800</a></span> | <span class="t">But specifically what I wanted to do was show you k-means clustering in TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=29" target="_blank">00:00:29.720</a></span> | <span class="t">There are some things which are easier to do in TensorFlow than PyTorch, mainly because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=33" target="_blank">00:00:33.600</a></span> | <span class="t">TensorFlow has a more complete API so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=40" target="_blank">00:00:40.040</a></span> | <span class="t">So there are some things that are just like, oh, there's already a method that does that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=45" target="_blank">00:00:45.040</a></span> | <span class="t">but there isn't one in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=47" target="_blank">00:00:47.360</a></span> | <span class="t">And some things are just a bit neater in TensorFlow than in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=53" target="_blank">00:00:53.020</a></span> | <span class="t">And I actually found k-means quite easy to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=55" target="_blank">00:00:55.720</a></span> | <span class="t">But what I want to do is I'm going to try and show you a way to write custom TensorFlow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=60" target="_blank">00:01:00.560</a></span> | <span class="t">code in a kind of a really PyTorch-y way, in a kind of an interactive-y way, and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=66" target="_blank">00:01:06.840</a></span> | <span class="t">going to try and avoid all of the fancy, session-y, graph-y, scope-y business as much as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=78" target="_blank">00:01:18.040</a></span> | <span class="t">So to remind you, the way we initially came at clustering was to say, Hey, what if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=84" target="_blank">00:01:24.760</a></span> | <span class="t">were doing lung cancer detection in CT scans, and these were like 512x512x200 volumetric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=95" target="_blank">00:01:35.760</a></span> | <span class="t">things which is too big to really run a whole CNN over conveniently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=102" target="_blank">00:01:42.560</a></span> | <span class="t">So one of the thoughts to fix that was to run some kind of heuristic that found all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=108" target="_blank">00:01:48.120</a></span> | <span class="t">of the things that looked like they could vaguely be nodules, and then create a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=113" target="_blank">00:01:53.280</a></span> | <span class="t">data set where you basically zoomed into each of those maybe nodules and created a small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=117" target="_blank">00:01:57.720</a></span> | <span class="t">little 20x20x20 cube or something, and you could then use a 3D CNN on that, or try Planar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=126" target="_blank">00:02:06.360</a></span> | <span class="t">CNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=127" target="_blank">00:02:07.520</a></span> | <span class="t">And this general concept I wanted to remind you about because I feel like it's something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=133" target="_blank">00:02:13.840</a></span> | <span class="t">which maybe I haven't stressed enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=137" target="_blank">00:02:17.360</a></span> | <span class="t">I've kind of kept on showing you ways of doing this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=139" target="_blank">00:02:19.360</a></span> | <span class="t">Going back to lesson 7 with the fish, I showed you the bounding boxes, and I showed you the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=143" target="_blank">00:02:23.760</a></span> | <span class="t">heat maps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=144" target="_blank">00:02:24.760</a></span> | <span class="t">The reason for all of that was basically to show you how to zoom into things and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=148" target="_blank">00:02:28.640</a></span> | <span class="t">create new models based on those zoomed in things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=153" target="_blank">00:02:33.000</a></span> | <span class="t">So in the fisheries case, we could really just use a lower-res CNN to find the fish</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=161" target="_blank">00:02:41.440</a></span> | <span class="t">and then zoom into those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=164" target="_blank">00:02:44.600</a></span> | <span class="t">In the CT scan case, maybe we can't even do that, so maybe we need to use this kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=169" target="_blank">00:02:49.680</a></span> | <span class="t">mean shift clustering approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=171" target="_blank">00:02:51.080</a></span> | <span class="t">I'm not saying we necessarily do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=173" target="_blank">00:02:53.480</a></span> | <span class="t">It would be interesting to see what the winners use, but certainly particularly if you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=177" target="_blank">00:02:57.880</a></span> | <span class="t">have lots of time or you have a lot of data, heuristics become more and more interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=184" target="_blank">00:03:04.520</a></span> | <span class="t">The reason a heuristic is interesting is you can do something quickly, an approximate that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=191" target="_blank">00:03:11.200</a></span> | <span class="t">could have lots and lots and lots of false positives, and that doesn't really matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=196" target="_blank">00:03:16.800</a></span> | <span class="t">Those false positives means just extra data that you're feeding to your real model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=204" target="_blank">00:03:24.200</a></span> | <span class="t">So you can always tune it as to how much time have I got to train my real model, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=209" target="_blank">00:03:29.280</a></span> | <span class="t">I can decide how many false positives I can handle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=213" target="_blank">00:03:33.040</a></span> | <span class="t">So as long as your preprocessing model is better than nothing, you can use it to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=219" target="_blank">00:03:39.900</a></span> | <span class="t">rid of some of the stuff that is clearly not a nodule, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=224" target="_blank">00:03:44.900</a></span> | <span class="t">For example, anything that is in the middle of the lung wall is not a nodule, anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=230" target="_blank">00:03:50.120</a></span> | <span class="t">that is all white space is not a nodule, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=237" target="_blank">00:03:57.600</a></span> | <span class="t">So we talked about mean shift clustering and how the big benefit of it is that it allows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=246" target="_blank">00:04:06.360</a></span> | <span class="t">us to build clusters without knowing how many clusters there are at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=253" target="_blank">00:04:13.680</a></span> | <span class="t">Also without any special extra work, it allows us to find clusters which aren't kind of Gaussian</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=261" target="_blank">00:04:21.160</a></span> | <span class="t">or spherical if you like in shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=264" target="_blank">00:04:24.560</a></span> | <span class="t">That's really important for something like a CT scan, where a cluster will often be like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=267" target="_blank">00:04:27.600</a></span> | <span class="t">a vessel, which is this really skinny long thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=273" target="_blank">00:04:33.240</a></span> | <span class="t">So k-means on the other hand is faster, I think it's n^2 rather than n^3 time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=282" target="_blank">00:04:42.340</a></span> | <span class="t">We have talked particularly on the forum about dramatically speeding up mean shift clustering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=286" target="_blank">00:04:46.840</a></span> | <span class="t">using approximate nearest neighbors, which is something which we started making some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=290" target="_blank">00:04:50.600</a></span> | <span class="t">progress on today, so hopefully we'll have results from that maybe by next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=295" target="_blank">00:04:55.800</a></span> | <span class="t">But the basic naive algorithm certainly should be a lot faster for k-means, so there's one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=302" target="_blank">00:05:02.140</a></span> | <span class="t">good reason to use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=303" target="_blank">00:05:03.720</a></span> | <span class="t">So as per usual, we can start with some data, and we're going to try and figure out where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=312" target="_blank">00:05:12.200</a></span> | <span class="t">the cluster centers are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=315" target="_blank">00:05:15.680</a></span> | <span class="t">So one quick way to avoid hassles in TensorFlow is to create an interactive session.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=324" target="_blank">00:05:24.280</a></span> | <span class="t">So an interactive session basically means that you can call .run() on a computation graph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=332" target="_blank">00:05:32.340</a></span> | <span class="t">which doesn't return something, or .eval() on a computation graph that does return something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=339" target="_blank">00:05:39.000</a></span> | <span class="t">and you don't have to worry about creating a graph or a session or having a session with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=344" target="_blank">00:05:44.600</a></span> | <span class="t">clause or anything like that, it just works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=349" target="_blank">00:05:49.140</a></span> | <span class="t">So that's basically what happens when you call tf.interactive_session.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=356" target="_blank">00:05:56.220</a></span> | <span class="t">So by creating an interactive session, we can then do things one step at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=368" target="_blank">00:06:08.200</a></span> | <span class="t">So in this case, the first step in k-means is to pick some initial centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=375" target="_blank">00:06:15.780</a></span> | <span class="t">So you basically start out and say, okay, if we're going to create however many clusters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=379" target="_blank">00:06:19.960</a></span> | <span class="t">-- in this case, n clusters is 6 -- then start out by saying, okay, where might those 6 clusters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=389" target="_blank">00:06:29.440</a></span> | <span class="t">be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=390" target="_blank">00:06:30.440</a></span> | <span class="t">And for a long time with k-means, people picked them randomly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=395" target="_blank">00:06:35.960</a></span> | <span class="t">But most practitioners realized that was a dumb idea soon enough, and a lot of people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=400" target="_blank">00:06:40.480</a></span> | <span class="t">had various heuristics for picking them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=402" target="_blank">00:06:42.560</a></span> | <span class="t">In 2007, finally, a paper was published actually suggesting a heuristic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=406" target="_blank">00:06:46.480</a></span> | <span class="t">I tend to use a very simple heuristic, which is what I use here in find_initial_centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=413" target="_blank">00:06:53.720</a></span> | <span class="t">So to describe this heuristic, I will show you the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=420" target="_blank">00:07:00.640</a></span> | <span class="t">So find_initial_centroids looks like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=424" target="_blank">00:07:04.960</a></span> | <span class="t">Basically -- and I'm going to run through it quickly, and then I'll run through it slowly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=428" target="_blank">00:07:08.560</a></span> | <span class="t">Basically the idea is we first of all pick a single data point index, and then we select</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=437" target="_blank">00:07:17.280</a></span> | <span class="t">that single data point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=439" target="_blank">00:07:19.280</a></span> | <span class="t">So we have one randomly selected data point, and then we find what is the distance from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=445" target="_blank">00:07:25.560</a></span> | <span class="t">that randomly selected data point to every other data point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=450" target="_blank">00:07:30.720</a></span> | <span class="t">And then we say, okay, what is the data point that is the furthest away from that randomly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=458" target="_blank">00:07:38.520</a></span> | <span class="t">selected data point, the index of it and the point itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=463" target="_blank">00:07:43.320</a></span> | <span class="t">And then we say, okay, we're going to append that to the initial centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=467" target="_blank">00:07:47.960</a></span> | <span class="t">So say I picked at random this point as my random initial point, the furthest point away</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=474" target="_blank">00:07:54.480</a></span> | <span class="t">from that is probably somewhere around here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=478" target="_blank">00:07:58.080</a></span> | <span class="t">So that would be the first centroid we picked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=483" target="_blank">00:08:03.000</a></span> | <span class="t">Okay we're now inside a loop, and we now go back and we repeat the process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=487" target="_blank">00:08:07.600</a></span> | <span class="t">So we now replace our random point with the actual first centroid, and we go through the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=495" target="_blank">00:08:15.000</a></span> | <span class="t">loop once more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=496" target="_blank">00:08:16.800</a></span> | <span class="t">So if we had our first centroid here, our second one now might be somewhere over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=504" target="_blank">00:08:24.000</a></span> | <span class="t">Okay so we now have two centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=507" target="_blank">00:08:27.200</a></span> | <span class="t">The next time through the loop, therefore, this is slightly more interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=510" target="_blank">00:08:30.480</a></span> | <span class="t">All distances, we're now going to have the distance between every one of our initial centroids</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=518" target="_blank">00:08:38.520</a></span> | <span class="t">and every other data point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=521" target="_blank">00:08:41.160</a></span> | <span class="t">So we've got a matrix, in this case it's going to be 2 by the number of data points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=527" target="_blank">00:08:47.120</a></span> | <span class="t">So then we say, okay, for every data point, find the closest cluster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=535" target="_blank">00:08:55.120</a></span> | <span class="t">So what's its distance to the closest initial centroid?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=540" target="_blank">00:09:00.360</a></span> | <span class="t">And then tell me which data point is the furthest away from its closest initial centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=547" target="_blank">00:09:07.240</a></span> | <span class="t">So in other words, which data point is the furthest away from any centroid?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=553" target="_blank">00:09:13.680</a></span> | <span class="t">So that's the basic algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=558" target="_blank">00:09:18.560</a></span> | <span class="t">So let's look and see how we actually do that in TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=563" target="_blank">00:09:23.200</a></span> | <span class="t">So it looks a lot like NumPy, except in places you would expect to see np, we see tf, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=571" target="_blank">00:09:31.200</a></span> | <span class="t">then we see the API is a little different, but not too different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=577" target="_blank">00:09:37.160</a></span> | <span class="t">So to get a random number, we can just use random uniform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=583" target="_blank">00:09:43.680</a></span> | <span class="t">We can tell it what type of random number we want, so we want a random int because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=586" target="_blank">00:09:46.960</a></span> | <span class="t">trying to get a random index, which is a random data point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=591" target="_blank">00:09:51.240</a></span> | <span class="t">That's going to be between 0 and the amount of data points we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=596" target="_blank">00:09:56.640</a></span> | <span class="t">So that gives us some random index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=601" target="_blank">00:10:01.880</a></span> | <span class="t">We can now go ahead and index into our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=606" target="_blank">00:10:06.200</a></span> | <span class="t">Now you'll notice I've created something called vdata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=608" target="_blank">00:10:08.120</a></span> | <span class="t">So what is vdata?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=610" target="_blank">00:10:10.960</a></span> | <span class="t">When we set up this k-means in the first place, the data was sent in as a NumPy array, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=617" target="_blank">00:10:17.040</a></span> | <span class="t">then I called tf.variable on it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=619" target="_blank">00:10:19.840</a></span> | <span class="t">Now this is the critical thing that lets us make TensorFlow feel more like PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=626" target="_blank">00:10:26.920</a></span> | <span class="t">Once I do this, data is now basically copied to the GPU, and so when I'm calling something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=634" target="_blank">00:10:34.360</a></span> | <span class="t">using vdata, I'm calling this GPU object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=641" target="_blank">00:10:41.280</a></span> | <span class="t">Now there's one thing problematic to be aware of, which is that the copying does not actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=646" target="_blank">00:10:46.720</a></span> | <span class="t">occur when you write this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=650" target="_blank">00:10:50.000</a></span> | <span class="t">The copying occurs when you write this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=656" target="_blank">00:10:56.440</a></span> | <span class="t">So any time you call tf.variable, if you then try to run something using that variable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=664" target="_blank">00:11:04.800</a></span> | <span class="t">you'll get back an uninitialized variable error unless you call this in the meantime.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=669" target="_blank">00:11:09.800</a></span> | <span class="t">This is kind of like performance stuff in TensorFlow where they try to say you can set up lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=677" target="_blank">00:11:17.840</a></span> | <span class="t">of variables at once and then call this initializer and we'll do it all at once for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=685" target="_blank">00:11:25.440</a></span> | <span class="t">So earlier on we created this k-means object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=693" target="_blank">00:11:33.900</a></span> | <span class="t">We know that in Python when you create an object, it calls _init__ (that's just how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=699" target="_blank">00:11:39.200</a></span> | <span class="t">Python works), inside that we copied the data to the GPU by using tf.variable, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=705" target="_blank">00:11:45.980</a></span> | <span class="t">inside find_initial_centroids, we can now access that in order to basically do calculations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=712" target="_blank">00:11:52.160</a></span> | <span class="t">involving data on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=718" target="_blank">00:11:58.200</a></span> | <span class="t">In TensorFlow, pretty much everything takes and returns a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=722" target="_blank">00:12:02.480</a></span> | <span class="t">So when you call random_uniform, it's giving us a tensor, an array of random numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=728" target="_blank">00:12:08.160</a></span> | <span class="t">In this case, we just wanted one of them, so we have to use tf.squeeze to take that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=733" target="_blank">00:12:13.200</a></span> | <span class="t">tensor and turn it into a scalar, because then we're just indexing it into here to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=737" target="_blank">00:12:17.960</a></span> | <span class="t">a single item back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=742" target="_blank">00:12:22.080</a></span> | <span class="t">So now that we've got that single item back, we then expand it back again into a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=749" target="_blank">00:12:29.160</a></span> | <span class="t">because inside our loop, remember, this is going to be a list of initial centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=754" target="_blank">00:12:34.360</a></span> | <span class="t">It's just that this list happens to be of length 1 at the moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=760" target="_blank">00:12:40.980</a></span> | <span class="t">So one of these tricks in making TensorFlow feel more like PyTorch is to use standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=769" target="_blank">00:12:49.880</a></span> | <span class="t">Python loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=771" target="_blank">00:12:51.920</a></span> | <span class="t">So in a lot of TensorFlow code where it's more serious performance intensive stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=777" target="_blank">00:12:57.440</a></span> | <span class="t">you'll see people use TensorFlow-specific loops like tf.while or tf.scan or map or so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=785" target="_blank">00:13:05.200</a></span> | <span class="t">The challenge with using those kind of loops is it's basically creating a computation graph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=789" target="_blank">00:13:09.480</a></span> | <span class="t">of that loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=790" target="_blank">00:13:10.480</a></span> | <span class="t">You can't step through it, you can't use it in the normal Pythonic kind of ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=796" target="_blank">00:13:16.760</a></span> | <span class="t">So we can just use normal Python loops if we're careful about how we do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=801" target="_blank">00:13:21.960</a></span> | <span class="t">So inside our normal Python loop, we can use normal Python functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=807" target="_blank">00:13:27.720</a></span> | <span class="t">So here's a function I created which calculates the distance between everything in this tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=813" target="_blank">00:13:33.480</a></span> | <span class="t">compared to everything in this tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=815" target="_blank">00:13:35.760</a></span> | <span class="t">So all distances, it looks very familiar because it looks a lot like the PyTorch code we had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=825" target="_blank">00:13:45.160</a></span> | <span class="t">So for the first array, for the first tensor, we add an additional axis to axis 0, and for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=834" target="_blank">00:13:54.560</a></span> | <span class="t">the second we add an additional axis to axis 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=838" target="_blank">00:13:58.720</a></span> | <span class="t">So the reason this works is because of broadcasting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=843" target="_blank">00:14:03.320</a></span> | <span class="t">So A, when it starts out, is a vector, and B is a vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=855" target="_blank">00:14:15.280</a></span> | <span class="t">Now is A a column or is A a row?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=859" target="_blank">00:14:19.400</a></span> | <span class="t">What's the orientation of it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=861" target="_blank">00:14:21.800</a></span> | <span class="t">Well the answer is it's both and it's neither.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=864" target="_blank">00:14:24.360</a></span> | <span class="t">It's one-dimensional, so it has no concept of what direction it's looking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=870" target="_blank">00:14:30.040</a></span> | <span class="t">So then what we do is we set expandims on axis 0, so that's rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=877" target="_blank">00:14:37.400</a></span> | <span class="t">So that basically says to A, you are now definitely a row vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=882" target="_blank">00:14:42.960</a></span> | <span class="t">You now have one row and however many columns, same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=888" target="_blank">00:14:48.960</a></span> | <span class="t">And then where else with B, we add an axis at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=894" target="_blank">00:14:54.360</a></span> | <span class="t">So B is now definitely a column vector, it now has one column and however many rows we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=901" target="_blank">00:15:01.640</a></span> | <span class="t">had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=903" target="_blank">00:15:03.960</a></span> | <span class="t">So with broadcasting, what happens is that this one gets broadcast to this length, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=912" target="_blank">00:15:12.880</a></span> | <span class="t">this one gets broadcast to this length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=917" target="_blank">00:15:17.520</a></span> | <span class="t">So we end up with a matrix containing the difference between every one of these items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=924" target="_blank">00:15:24.320</a></span> | <span class="t">and every one of these items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=927" target="_blank">00:15:27.320</a></span> | <span class="t">So that's like this simple but powerful concept of how we can do very fast GPU-accelerated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=936" target="_blank">00:15:36.040</a></span> | <span class="t">loops and less code than it would have taken to actually write the loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=940" target="_blank">00:15:40.800</a></span> | <span class="t">And we don't have to worry about out-of-bounds conditions or anything like that, it's all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=944" target="_blank">00:15:44.680</a></span> | <span class="t">done for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=947" target="_blank">00:15:47.280</a></span> | <span class="t">So that's the trick here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=948" target="_blank">00:15:48.760</a></span> | <span class="t">And once we've got that matrix, because in TensorFlow everything is a tensor, we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=954" target="_blank">00:15:54.440</a></span> | <span class="t">call square difference rather than just regular difference, and it gives us the squares of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=959" target="_blank">00:15:59.920</a></span> | <span class="t">those differences, and then we can sum over the last axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=964" target="_blank">00:16:04.140</a></span> | <span class="t">So the last axis is the dimensions, so we're just creating a Euclidean distance here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=972" target="_blank">00:16:12.360</a></span> | <span class="t">And so that's all this code does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=975" target="_blank">00:16:15.680</a></span> | <span class="t">So this gives us every distance between every element of A and every element of B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=983" target="_blank">00:16:23.240</a></span> | <span class="t">So that's how we get to this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=988" target="_blank">00:16:28.420</a></span> | <span class="t">So then let's say we've gone through a couple of loops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=992" target="_blank">00:16:32.760</a></span> | <span class="t">So after a couple of loops, R is going to contain a few initial centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=998" target="_blank">00:16:38.680</a></span> | <span class="t">So we now want to basically find out for every point how far away is it from its nearest initial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1008" target="_blank">00:16:48.440</a></span> | <span class="t">centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1010" target="_blank">00:16:50.360</a></span> | <span class="t">So when we go reduce min with axis=0, then we know that that's going over the axis here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1020" target="_blank">00:17:00.680</a></span> | <span class="t">because that's what we put into our all-distances function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1023" target="_blank">00:17:03.960</a></span> | <span class="t">So it's going to go through, well actually it's reducing across into that axis, so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1030" target="_blank">00:17:10.320</a></span> | <span class="t">actually reducing across our centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1033" target="_blank">00:17:13.160</a></span> | <span class="t">So at the end of this, it says, alright, this is for every piece of our data how far it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1040" target="_blank">00:17:20.200</a></span> | <span class="t">is away from its nearest centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1046" target="_blank">00:17:26.200</a></span> | <span class="t">And that returns the actual distance, because we said do the actual min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1051" target="_blank">00:17:31.440</a></span> | <span class="t">So there's a difference between min and arg, the arg version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1055" target="_blank">00:17:35.880</a></span> | <span class="t">So argmax then says, okay, now go through all of the points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1061" target="_blank">00:17:41.680</a></span> | <span class="t">We now know how far away they are from their closest centroid, and tell me the index of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1068" target="_blank">00:17:48.080</a></span> | <span class="t">the one which is furthest away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1071" target="_blank">00:17:51.240</a></span> | <span class="t">So argmax is a super handy function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1073" target="_blank">00:17:53.700</a></span> | <span class="t">We used it quite a bit in part 1 of the course, but it's well worth making sure we understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1079" target="_blank">00:17:59.400</a></span> | <span class="t">how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1081" target="_blank">00:18:01.040</a></span> | <span class="t">I think IntensorFlow, I think they're getting rid of these reduce_ prefixes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1087" target="_blank">00:18:07.600</a></span> | <span class="t">I'm not sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1088" target="_blank">00:18:08.600</a></span> | <span class="t">I think I read that somewhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1090" target="_blank">00:18:10.700</a></span> | <span class="t">So in some version you may find this is called min rather than reduce_min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1096" target="_blank">00:18:16.000</a></span> | <span class="t">I certainly hope they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1098" target="_blank">00:18:18.520</a></span> | <span class="t">For those of you who don't have such a computer science background, a reduction basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1102" target="_blank">00:18:22.880</a></span> | <span class="t">means taking something in a higher dimension and squishing it down into something that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1106" target="_blank">00:18:26.400</a></span> | <span class="t">a lower dimension, for example, summing a vector and turning it into a scalar is called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1112" target="_blank">00:18:32.000</a></span> | <span class="t">a reduction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1113" target="_blank">00:18:33.000</a></span> | <span class="t">So this is a very TensorFlow API assuming that everybody is a computer scientist and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1117" target="_blank">00:18:37.640</a></span> | <span class="t">that you wouldn't look for min, you would look for reduce_min.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1123" target="_blank">00:18:43.800</a></span> | <span class="t">So that's how we got that index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1126" target="_blank">00:18:46.880</a></span> | <span class="t">So generally speaking, you have to be a bit careful of data types.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1134" target="_blank">00:18:54.600</a></span> | <span class="t">I generally don't really notice about data type problems until I get the error, but if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1138" target="_blank">00:18:58.240</a></span> | <span class="t">you get an error that says you passed an int64 into something that expected an int32, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1144" target="_blank">00:19:04.360</a></span> | <span class="t">can always just cast things like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1147" target="_blank">00:19:07.000</a></span> | <span class="t">So we need to index something with an int32, so we just have to cast it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1151" target="_blank">00:19:11.120</a></span> | <span class="t">And so this returns the actual point, append, and then this is very similar to NumPy stacking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1158" target="_blank">00:19:18.460</a></span> | <span class="t">together the initial centroids to create a tensor of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1165" target="_blank">00:19:25.680</a></span> | <span class="t">So the code doesn't look at all weird or different, but it's important to remember that when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1174" target="_blank">00:19:34.000</a></span> | <span class="t">run this code, nothing happens, other than that it creates a computation graph.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1180" target="_blank">00:19:40.580</a></span> | <span class="t">So when we call k.find_initial_centroids, nothing happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1189" target="_blank">00:19:49.120</a></span> | <span class="t">But because we're in an interactive session, we can now call .eval, and that actually runs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1195" target="_blank">00:19:55.200</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1196" target="_blank">00:19:56.360</a></span> | <span class="t">And it runs it, and it actually takes the data that's returned from that and copies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1201" target="_blank">00:20:01.520</a></span> | <span class="t">it off the GPU and puts it back in the CPU as a NumPy array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1208" target="_blank">00:20:08.120</a></span> | <span class="t">So it's important to remember that if you call eval, we now have an actual genuine regular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1213" target="_blank">00:20:13.920</a></span> | <span class="t">NumPy array here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1216" target="_blank">00:20:16.180</a></span> | <span class="t">And this is the thing that makes us be able to write code that looks a lot like PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1223" target="_blank">00:20:23.200</a></span> | <span class="t">code, because we now know that we can take something that's a NumPy array and turn it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1226" target="_blank">00:20:26.960</a></span> | <span class="t">into a GPU tensor like that, and we can take something that's a GPU tensor and turn it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1234" target="_blank">00:20:34.060</a></span> | <span class="t">into a NumPy array like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1239" target="_blank">00:20:39.000</a></span> | <span class="t">I suspect this might make TensorFlow developers shake at how horrible this is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1250" target="_blank">00:20:50.120</a></span> | <span class="t">It's not really quite the way you're meant to do things I think, but it's super easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1256" target="_blank">00:20:56.200</a></span> | <span class="t">and it seems to work pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1260" target="_blank">00:21:00.080</a></span> | <span class="t">This approach where we're calling .eval, you do need to be a bit careful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1266" target="_blank">00:21:06.000</a></span> | <span class="t">If this was inside a loop that we were calling eval and we were copying back a really big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1271" target="_blank">00:21:11.240</a></span> | <span class="t">chunk of data to the GPU and the CPU again and again and again, that would be a performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1276" target="_blank">00:21:16.560</a></span> | <span class="t">nightmare.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1277" target="_blank">00:21:17.560</a></span> | <span class="t">So you do need to think about what's going on as you do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1282" target="_blank">00:21:22.040</a></span> | <span class="t">So we'll look inside the inner loop in a moment and just check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1285" target="_blank">00:21:25.840</a></span> | <span class="t">Anyway, the result's pretty fantastic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1289" target="_blank">00:21:29.720</a></span> | <span class="t">As you can see, this little hackyheuristic does a great job.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1297" target="_blank">00:21:37.000</a></span> | <span class="t">It's a hackyheuristic I've been using for decades now, and it's a kind of thing which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1302" target="_blank">00:21:42.660</a></span> | <span class="t">often doesn't appear in papers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1304" target="_blank">00:21:44.480</a></span> | <span class="t">In this case, a similar hackyheuristic did actually appear in a paper in 2007 and an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1308" target="_blank">00:21:48.280</a></span> | <span class="t">even better one appeared just last year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1312" target="_blank">00:21:52.760</a></span> | <span class="t">But it's always worth thinking about how can I pre-process my data to get it close to where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1319" target="_blank">00:21:59.700</a></span> | <span class="t">I might want it to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1320" target="_blank">00:22:00.920</a></span> | <span class="t">And often these kind of approaches are useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1325" target="_blank">00:22:05.740</a></span> | <span class="t">There's actually -- I don't know if we'll have time to maybe talk about it someday -- but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1328" target="_blank">00:22:08.440</a></span> | <span class="t">there's an approach to doing PCA, Principle Components Analysis, which has a similar flavor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1333" target="_blank">00:22:13.840</a></span> | <span class="t">basically finding random numbers and finding the furthest numbers away from them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1339" target="_blank">00:22:19.200</a></span> | <span class="t">So it's a good general technique actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1342" target="_blank">00:22:22.800</a></span> | <span class="t">So we've got our initial centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1345" target="_blank">00:22:25.560</a></span> | <span class="t">What do we do next?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1346" target="_blank">00:22:26.560</a></span> | <span class="t">Well, what we do next is we're going to be doing more computation in TensorFlow with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1349" target="_blank">00:22:29.760</a></span> | <span class="t">them, so we want to copy them back to the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1354" target="_blank">00:22:34.800</a></span> | <span class="t">And so because we copied them to the GPU, before we do an eval or anything later on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1361" target="_blank">00:22:41.240</a></span> | <span class="t">we're going to have to make sure we go global variable initializers dot run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1365" target="_blank">00:22:45.080</a></span> | <span class="t">Question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1366" target="_blank">00:22:46.080</a></span> | <span class="t">Can you explain what happens if you don't create interactive session?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1372" target="_blank">00:22:52.760</a></span> | <span class="t">So what the TensorFlow authors decided to do in their wisdom was to generate their own</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1378" target="_blank">00:22:58.560</a></span> | <span class="t">whole concept of namespaces and variables and whatever else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1384" target="_blank">00:23:04.200</a></span> | <span class="t">So rather than using Python's, there's TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1390" target="_blank">00:23:10.040</a></span> | <span class="t">And so a session is basically kind of like a namespace that holds the computation graphs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1397" target="_blank">00:23:17.400</a></span> | <span class="t">and the variables and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1401" target="_blank">00:23:21.360</a></span> | <span class="t">You can, and then there's this concept of a context manager, which is basically where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1406" target="_blank">00:23:26.680</a></span> | <span class="t">you have a with clause in Python and you say with this session, now you're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1411" target="_blank">00:23:31.600</a></span> | <span class="t">this bunch of stuff in this namespace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1414" target="_blank">00:23:34.760</a></span> | <span class="t">And then there's a concept of a graph.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1416" target="_blank">00:23:36.120</a></span> | <span class="t">You can have multiple computation graphs, so you can say with this graph, create these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1419" target="_blank">00:23:39.600</a></span> | <span class="t">various computations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1422" target="_blank">00:23:42.920</a></span> | <span class="t">Where it comes in very handy is if you want to say run this graph on this GPU, or stick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1430" target="_blank">00:23:50.560</a></span> | <span class="t">this variable on that GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1436" target="_blank">00:23:56.160</a></span> | <span class="t">So without an interactive session, you basically have to create that session, you have to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1441" target="_blank">00:24:01.640</a></span> | <span class="t">which session to use using a with clause, and then there's many layers of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1446" target="_blank">00:24:06.480</a></span> | <span class="t">So within that you can then create namescopes and variablescopes and blah blah blah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1451" target="_blank">00:24:11.200</a></span> | <span class="t">So the annoying thing is the vast majority of tutorial code out there uses all of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1457" target="_blank">00:24:17.360</a></span> | <span class="t">concepts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1458" target="_blank">00:24:18.360</a></span> | <span class="t">It's as if all of Python's OO and variables and modules doesn't exist, and you use TensorFlow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1466" target="_blank">00:24:26.040</a></span> | <span class="t">for everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1467" target="_blank">00:24:27.040</a></span> | <span class="t">So I wanted to show you that you don't have to use any of these concepts, pretty much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1471" target="_blank">00:24:31.560</a></span> | <span class="t">Thank you for the question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1474" target="_blank">00:24:34.520</a></span> | <span class="t">I haven't quite finished thinking through this, but have you tried?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1491" target="_blank">00:24:51.200</a></span> | <span class="t">If you had initially said I have seven clusters, or eight clusters, what you would find after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1496" target="_blank">00:24:56.600</a></span> | <span class="t">you hit your six is you'd all of a sudden start getting centroids that were very close</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1501" target="_blank">00:25:01.640</a></span> | <span class="t">to various existing centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1504" target="_blank">00:25:04.000</a></span> | <span class="t">So it seems like you could somehow intelligently define a width of a cluster, or kind of look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1512" target="_blank">00:25:12.960</a></span> | <span class="t">for a jump in things dropping down and how far apart they are from some other cluster,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1517" target="_blank">00:25:17.940</a></span> | <span class="t">and programmatically come up with a way to decide the number of clusters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1522" target="_blank">00:25:22.520</a></span> | <span class="t">Yeah, I think you could.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1526" target="_blank">00:25:26.680</a></span> | <span class="t">Maybe then you're using TK means, I don't know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1531" target="_blank">00:25:31.080</a></span> | <span class="t">I think it's a fascinating question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1533" target="_blank">00:25:33.840</a></span> | <span class="t">I haven't seen that done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1536" target="_blank">00:25:36.760</a></span> | <span class="t">There are certainly papers about figuring out the number of clusters in K-means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1544" target="_blank">00:25:44.720</a></span> | <span class="t">So maybe during the week you'd check one out, put it to TensorFlow, that would be really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1550" target="_blank">00:25:50.520</a></span> | <span class="t">interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1551" target="_blank">00:25:51.520</a></span> | <span class="t">And I just wanted to follow up what you said about sessions to emphasize that with a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1557" target="_blank">00:25:57.400</a></span> | <span class="t">of tutorials, you could make the code simpler by using an interactive session in a Jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1562" target="_blank">00:26:02.520</a></span> | <span class="t">notebook instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1564" target="_blank">00:26:04.200</a></span> | <span class="t">I remember when Rachel was going through a TensorFlow course a while ago and she kept</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1568" target="_blank">00:26:08.440</a></span> | <span class="t">on banging her head against a desk with sessions and variable scopes and whatever else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1574" target="_blank">00:26:14.400</a></span> | <span class="t">That was part of what led us to think, "Okay, let's simplify all that."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1579" target="_blank">00:26:19.680</a></span> | <span class="t">So step one was to take our initial centroids and copy them onto the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1583" target="_blank">00:26:23.840</a></span> | <span class="t">So we now have a symbol representing those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1587" target="_blank">00:26:27.960</a></span> | <span class="t">So the next step in the K-means algorithm is to take every point and assign them to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1594" target="_blank">00:26:34.280</a></span> | <span class="t">a cluster, which is basically to say for every point which of the centroids is the closest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1605" target="_blank">00:26:45.120</a></span> | <span class="t">So that's what assigned to nearest does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1607" target="_blank">00:26:47.840</a></span> | <span class="t">We'll get to that in a moment, but let's pretend we've done it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1610" target="_blank">00:26:50.460</a></span> | <span class="t">This will now be a list of which centroid is the closest for every data point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1618" target="_blank">00:26:58.620</a></span> | <span class="t">So then we need one more piece of TensorFlow concepts, which is we want to update an existing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1633" target="_blank">00:27:13.000</a></span> | <span class="t">variable with some new data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1635" target="_blank">00:27:15.760</a></span> | <span class="t">And so we can actually call updateCentroids to basically do that updating, and I'll show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1642" target="_blank">00:27:22.240</a></span> | <span class="t">you how that works as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1644" target="_blank">00:27:24.760</a></span> | <span class="t">So basically the idea is we're going to loop through doing this again and again and again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1653" target="_blank">00:27:33.480</a></span> | <span class="t">But when we just do it once, you can actually see it's nearly perfect already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1659" target="_blank">00:27:39.520</a></span> | <span class="t">So it's a pretty powerful idea as long as your initial cluster centers are good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1667" target="_blank">00:27:47.120</a></span> | <span class="t">So let's see how this works, assigned to nearest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1672" target="_blank">00:27:52.960</a></span> | <span class="t">There's a single line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1679" target="_blank">00:27:59.960</a></span> | <span class="t">The reason there's a single line of code is we already have the code to find the distance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1684" target="_blank">00:28:04.740</a></span> | <span class="t">between every piece of data and its centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1690" target="_blank">00:28:10.880</a></span> | <span class="t">Now rather than calling tf.reduceMin, which returned the distance to its nearest centroid,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1696" target="_blank">00:28:16.880</a></span> | <span class="t">we call tf.argmin to get the index of its nearest centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1703" target="_blank">00:28:23.280</a></span> | <span class="t">So generally speaking, the hard bit of doing this kind of highly vectorized code is figuring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1708" target="_blank">00:28:28.840</a></span> | <span class="t">out this number, which is what axis we're working with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1713" target="_blank">00:28:33.600</a></span> | <span class="t">And so it's a good idea to actually write down on a piece of paper for each of your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1719" target="_blank">00:28:39.220</a></span> | <span class="t">tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1720" target="_blank">00:28:40.220</a></span> | <span class="t">It's like it's time by batch, by row, by column, or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1723" target="_blank">00:28:43.800</a></span> | <span class="t">Make sure you know what every axis represents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1728" target="_blank">00:28:48.880</a></span> | <span class="t">When I'm creating these algorithms, I'm constantly printing out the shape of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1737" target="_blank">00:28:57.480</a></span> | <span class="t">Another really simple trick, but a lot of people don't do this, is make sure that your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1741" target="_blank">00:29:01.720</a></span> | <span class="t">different dimensions actually have different sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1745" target="_blank">00:29:05.540</a></span> | <span class="t">So when you're playing around with testing things, don't have a batch size of 10 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1748" target="_blank">00:29:08.600</a></span> | <span class="t">an n of 10 and a number of dimensions of 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1753" target="_blank">00:29:13.320</a></span> | <span class="t">I find it much easier to think of real numbers, so have a batch size of 8 and an n of 10 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1758" target="_blank">00:29:18.560</a></span> | <span class="t">a dimensionality of 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1759" target="_blank">00:29:19.560</a></span> | <span class="t">Because every time you print out the shape, you'll find out exactly what everything is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1764" target="_blank">00:29:24.960</a></span> | <span class="t">So this is going to return the nearest indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1772" target="_blank">00:29:32.040</a></span> | <span class="t">So then we can go ahead and update the centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1775" target="_blank">00:29:35.280</a></span> | <span class="t">So here is update-centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1777" target="_blank">00:29:37.080</a></span> | <span class="t">And suddenly we have some crazy function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1781" target="_blank">00:29:41.680</a></span> | <span class="t">And this is where TensorFlow is super handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1786" target="_blank">00:29:46.120</a></span> | <span class="t">It's full of crazy functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1788" target="_blank">00:29:48.320</a></span> | <span class="t">And if you know the computer science term for the thing you're trying to do, it's generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1796" target="_blank">00:29:56.960</a></span> | <span class="t">called that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1800" target="_blank">00:30:00.640</a></span> | <span class="t">The only other way to find it is just to do lots and lots of searching through the documentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1804" target="_blank">00:30:04.840</a></span> | <span class="t">So in general, taking a set of data and sticking it into multiple chunks of data according</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1815" target="_blank">00:30:15.780</a></span> | <span class="t">to some kind of criteria is called partitioning in computer science.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1820" target="_blank">00:30:20.920</a></span> | <span class="t">So I got a bit lucky when I first looked for this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1822" target="_blank">00:30:22.800</a></span> | <span class="t">I googled for TensorFlow partition and bang, this thing popped up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1827" target="_blank">00:30:27.660</a></span> | <span class="t">So let's take a look at it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1835" target="_blank">00:30:35.100</a></span> | <span class="t">And this is where reading about GPU programming in general is very helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1841" target="_blank">00:30:41.520</a></span> | <span class="t">Because in GPU programming there's this kind of smallish subset of things which everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1846" target="_blank">00:30:46.760</a></span> | <span class="t">else is built on, and one of them is partitioning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1856" target="_blank">00:30:56.640</a></span> | <span class="t">So here we have tf.dynamic_partition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1864" target="_blank">00:31:04.800</a></span> | <span class="t">Partition is the data into some number of partitions using some indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1870" target="_blank">00:31:10.600</a></span> | <span class="t">And generally speaking, it's easiest to just look at some code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1874" target="_blank">00:31:14.380</a></span> | <span class="t">So here's our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1876" target="_blank">00:31:16.480</a></span> | <span class="t">We're going to create two partitions, we're calling them clusters, and it's going to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1882" target="_blank">00:31:22.720</a></span> | <span class="t">like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1883" target="_blank">00:31:23.720</a></span> | <span class="t">0th partition, 0th, 1st, 1st, 0th.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1888" target="_blank">00:31:28.000</a></span> | <span class="t">So 10 will go to the 0th partition, 20 will go to the 0th partition, 30 will go to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1894" target="_blank">00:31:34.400</a></span> | <span class="t">1st partition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1895" target="_blank">00:31:35.400</a></span> | <span class="t">Okay, this is exactly what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1898" target="_blank">00:31:38.280</a></span> | <span class="t">So this is the nice thing is that there's a lot of these, you can see all this stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1902" target="_blank">00:31:42.720</a></span> | <span class="t">There's so many functions available, often there's the exact function you need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1907" target="_blank">00:31:47.980</a></span> | <span class="t">And here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1908" target="_blank">00:31:48.980</a></span> | <span class="t">So we just take our list of indices, convert it to a list of int32s, pass it out data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1915" target="_blank">00:31:55.360</a></span> | <span class="t">the indices and the number of clusters, and we're done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1920" target="_blank">00:32:00.040</a></span> | <span class="t">This is now a separate array, basically a separate tensor for each of our clusters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1930" target="_blank">00:32:10.600</a></span> | <span class="t">So now that we've done that, we can then figure out what is the mean of each of those clusters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1939" target="_blank">00:32:19.440</a></span> | <span class="t">So the mean of each of those clusters is our new centroid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1942" target="_blank">00:32:22.760</a></span> | <span class="t">So what we're doing is we're saying which points are the closest to this one, and these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1951" target="_blank">00:32:31.200</a></span> | <span class="t">points are the closest to this one, okay, what's the average of those points?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1956" target="_blank">00:32:36.280</a></span> | <span class="t">That's all that happened from here to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1960" target="_blank">00:32:40.160</a></span> | <span class="t">So that's taking the mean of those points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1964" target="_blank">00:32:44.280</a></span> | <span class="t">And then we can basically say, okay, that's our new clusters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1972" target="_blank">00:32:52.000</a></span> | <span class="t">So then just join them all together, concatenate them together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1984" target="_blank">00:33:04.380</a></span> | <span class="t">Except for that dynamic partitions, well in fact including that dynamic partitions, that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1988" target="_blank">00:33:08.960</a></span> | <span class="t">was incredibly simple, but it was incredibly simple because we had a function that did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1991" target="_blank">00:33:11.880</a></span> | <span class="t">exactly what we wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=1993" target="_blank">00:33:13.720</a></span> | <span class="t">So because we assigned a variable up here, we have to call initializer.run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2000" target="_blank">00:33:20.120</a></span> | <span class="t">And then of course before we can do anything with this tensor, we have to call .eval to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2006" target="_blank">00:33:26.520</a></span> | <span class="t">actually call the computation graph and copy it back to our CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2013" target="_blank">00:33:33.060</a></span> | <span class="t">So that's all those steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2018" target="_blank">00:33:38.000</a></span> | <span class="t">So then we want to replace the contents of current centroids with the contents of updated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2024" target="_blank">00:33:44.920</a></span> | <span class="t">centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2027" target="_blank">00:33:47.680</a></span> | <span class="t">And so to do that, we can't just say equals, everything is different in TensorFlow, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2034" target="_blank">00:33:54.560</a></span> | <span class="t">have to call .assign.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2037" target="_blank">00:33:57.080</a></span> | <span class="t">So this is the same as basically saying current centroids equals updated centroids, but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2041" target="_blank">00:34:01.840</a></span> | <span class="t">creating a computation graph that basically does that assignment on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2047" target="_blank">00:34:07.880</a></span> | <span class="t">How can we extrapolate this to other non-numeric data types such as words, images?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2057" target="_blank">00:34:17.800</a></span> | <span class="t">Well they're all numeric data types really, so an image is absolutely a numeric data type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2066" target="_blank">00:34:26.600</a></span> | <span class="t">So it's just a bunch of pixels, you just have to decide what distance measure you want,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2074" target="_blank">00:34:34.240</a></span> | <span class="t">which generally just means deciding you're probably using Euclidean distance, but are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2077" target="_blank">00:34:37.680</a></span> | <span class="t">you doing it in pixel space, or are you picking one of the activation layers in a neural net?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2084" target="_blank">00:34:44.000</a></span> | <span class="t">For words, you would create a word vector for your words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2092" target="_blank">00:34:52.800</a></span> | <span class="t">There's nothing specifically two-dimensional about this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2096" target="_blank">00:34:56.160</a></span> | <span class="t">This works in as many dimensions as we like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2100" target="_blank">00:35:00.240</a></span> | <span class="t">That's really the whole point, and I'm hoping that maybe during the week, some people will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2103" target="_blank">00:35:03.360</a></span> | <span class="t">start to play around with some higher dimensional data sets to get a feel for how this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2108" target="_blank">00:35:08.560</a></span> | <span class="t">Particularly if you can get it working on CT scans, that would be fascinating using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2112" target="_blank">00:35:12.280</a></span> | <span class="t">the five-dimensional clustering we talked about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2117" target="_blank">00:35:17.600</a></span> | <span class="t">So here's what it looks like in total if we weren't using an interactive session.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2123" target="_blank">00:35:23.960</a></span> | <span class="t">You basically say with tf.session, that creates a session, but as default, that sets it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2130" target="_blank">00:35:30.960</a></span> | <span class="t">the current session, and then within the with block, we can now run things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2136" target="_blank">00:35:36.520</a></span> | <span class="t">And then k.run does all the stuff we just saw, so if we go to k.run, here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2145" target="_blank">00:35:45.640</a></span> | <span class="t">So k.run does all of those steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2148" target="_blank">00:35:48.600</a></span> | <span class="t">So this is how you can create a complete computation graph in TensorFlow using a notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2154" target="_blank">00:35:54.820</a></span> | <span class="t">You do each one, one step at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2156" target="_blank">00:35:56.800</a></span> | <span class="t">Once you've got it working, you put it all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2159" target="_blank">00:35:59.280</a></span> | <span class="t">So you can see find_initial_centroids.eval, put it back into a variable again, assigned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2168" target="_blank">00:36:08.480</a></span> | <span class="t">to nearest, update_centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2173" target="_blank">00:36:13.140</a></span> | <span class="t">Because we created a variable in the process there, we then have to rerun global_variable_initializer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2181" target="_blank">00:36:21.120</a></span> | <span class="t">We could have avoided this I guess by not calling eval and just treating this as a variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2188" target="_blank">00:36:28.560</a></span> | <span class="t">the whole time, but it doesn't matter, this works fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2194" target="_blank">00:36:34.420</a></span> | <span class="t">And then we just loop through a bunch of times, calling centroids.assign_updated_centroids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2210" target="_blank">00:36:50.440</a></span> | <span class="t">What we should be doing after that is then calling update_centroids each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2221" target="_blank">00:37:01.360</a></span> | <span class="t">Then the nice thing is, because I've used a normal Python for loop here and I'm calling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2228" target="_blank">00:37:08.520</a></span> | <span class="t">dot eval each time, it means I can check, "Oh, have any of the cluster centroids moved?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2240" target="_blank">00:37:20.080</a></span> | <span class="t">And if they haven't, then I will stop working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2244" target="_blank">00:37:24.040</a></span> | <span class="t">So it makes it very easy to create dynamic for loops, which could be quite tricky sometimes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2249" target="_blank">00:37:29.600</a></span> | <span class="t">with TensorFlow otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2255" target="_blank">00:37:35.960</a></span> | <span class="t">So that is the TensorFlow algorithm from end to end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2268" target="_blank">00:37:48.000</a></span> | <span class="t">Rachel, do you want to pick out an AMA question?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2273" target="_blank">00:37:53.820</a></span> | <span class="t">So actually I kind of am helping start a company, I don't know if you've seen my talk on ted.com,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2284" target="_blank">00:38:04.280</a></span> | <span class="t">but I kind of show this demo of this interactive labelling tool, a friend of mine said that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2292" target="_blank">00:38:12.360</a></span> | <span class="t">he wanted to start a company to actually make that and commercialize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2295" target="_blank">00:38:15.240</a></span> | <span class="t">So I guess my short answer is I'm helping somebody do that because I think that's pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2299" target="_blank">00:38:19.480</a></span> | <span class="t">cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2300" target="_blank">00:38:20.480</a></span> | <span class="t">More generally, I've mentioned before I think that the best thing to do is always to scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2306" target="_blank">00:38:26.680</a></span> | <span class="t">an itch, so pick whatever you've been passionate about or something that's just driven you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2312" target="_blank">00:38:32.280</a></span> | <span class="t">crazy and fix it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2316" target="_blank">00:38:36.840</a></span> | <span class="t">If you have the benefit of being able to take enough time to do absolutely anything you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2320" target="_blank">00:38:40.580</a></span> | <span class="t">want, I felt like the three most important areas for applying deep learning when I last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2328" target="_blank">00:38:48.880</a></span> | <span class="t">looked, which was two or three years ago, were medicine, robotics, and satellite imagery.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2335" target="_blank">00:38:55.440</a></span> | <span class="t">Because at that time, computer vision was the only area that was remotely mature for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2342" target="_blank">00:39:02.280</a></span> | <span class="t">machine learning, deep learning, and those three areas all were areas that very heavily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2349" target="_blank">00:39:09.160</a></span> | <span class="t">used computer vision or could heavily use computer vision and were potentially very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2354" target="_blank">00:39:14.480</a></span> | <span class="t">large markets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2357" target="_blank">00:39:17.040</a></span> | <span class="t">Medicine is probably the largest industry in the world, I think it's $3 trillion in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2360" target="_blank">00:39:20.480</a></span> | <span class="t">America alone, robotics isn't currently that large, but at some point it probably will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2366" target="_blank">00:39:26.760</a></span> | <span class="t">become the largest industry in the world if everything we do manually is replaced with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2372" target="_blank">00:39:32.720</a></span> | <span class="t">automated approaches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2374" target="_blank">00:39:34.720</a></span> | <span class="t">And satellite imagery is massively used by military intelligence, so we have some of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2379" target="_blank">00:39:39.880</a></span> | <span class="t">the biggest budgets in the world, so I guess those three areas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2384" target="_blank">00:39:44.840</a></span> | <span class="t">I'm going to take a break soon, before I do, I might just introduce what we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2402" target="_blank">00:40:02.920</a></span> | <span class="t">be looking at next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2405" target="_blank">00:40:05.440</a></span> | <span class="t">So we're going to start on our NLP, and specifically translation deep dive, and we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2414" target="_blank">00:40:14.680</a></span> | <span class="t">be really following on from the end-to-end memory networks from last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2423" target="_blank">00:40:23.600</a></span> | <span class="t">One of the things that I find kind of most interesting and most challenging in setting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2428" target="_blank">00:40:28.080</a></span> | <span class="t">up this course is coming up with good problem sets which are hard enough to be interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2435" target="_blank">00:40:35.420</a></span> | <span class="t">and easy enough to be possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2440" target="_blank">00:40:40.440</a></span> | <span class="t">And often other people have already done that, so I was lucky enough that somebody else had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2444" target="_blank">00:40:44.360</a></span> | <span class="t">already shown an example of using sequence-to-sequence learning for what they called Spelling Bee.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2453" target="_blank">00:40:53.120</a></span> | <span class="t">Basically we start with this thing called the CMU Pronouncing Dictionary, which has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2458" target="_blank">00:40:58.000</a></span> | <span class="t">things that look like this, Zwicky, followed by a phonetic description of how to read Zweki.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2470" target="_blank">00:41:10.440</a></span> | <span class="t">So the way these work, this is actually specifically an American pronunciation dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2476" target="_blank">00:41:16.680</a></span> | <span class="t">The consonants are pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2481" target="_blank">00:41:21.600</a></span> | <span class="t">The vowel sounds have a number at the end showing how much stress is on each one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2486" target="_blank">00:41:26.600</a></span> | <span class="t">So 0, 1, or 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2488" target="_blank">00:41:28.440</a></span> | <span class="t">So in this case you can see that the middle one is where most of the stress is, so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2492" target="_blank">00:41:32.080</a></span> | <span class="t">Zwicky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2495" target="_blank">00:41:35.340</a></span> | <span class="t">So here is the letter A, and it is pronounced A.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2502" target="_blank">00:41:42.200</a></span> | <span class="t">So the goal that we're going to be looking at after the break is to do the other direction,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2508" target="_blank">00:41:48.680</a></span> | <span class="t">which is to start with how do you say it and turn it into how do you spell it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2516" target="_blank">00:41:56.000</a></span> | <span class="t">This is quite a difficult question because English is really weird to spell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2521" target="_blank">00:42:01.960</a></span> | <span class="t">And the number of phonemes doesn't necessarily match the number of letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2530" target="_blank">00:42:10.640</a></span> | <span class="t">So this is going to be where we're going to start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2532" target="_blank">00:42:12.720</a></span> | <span class="t">And then we're going to try and solve this puzzle, and then we'll use a solution from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2535" target="_blank">00:42:15.840</a></span> | <span class="t">this puzzle to try and learn to translate French into English using the same basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2542" target="_blank">00:42:22.800</a></span> | <span class="t">So let's have a 10 minute break and we'll come back at 7.40.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2549" target="_blank">00:42:29.040</a></span> | <span class="t">So just to clarify, I just want to make sure everybody understands the problem we're solving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2553" target="_blank">00:42:33.320</a></span> | <span class="t">here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2554" target="_blank">00:42:34.320</a></span> | <span class="t">So the problem we're solving is we're going to be told here is how to pronounce something,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2559" target="_blank">00:42:39.280</a></span> | <span class="t">and then we have to say here is how to spell it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2562" target="_blank">00:42:42.000</a></span> | <span class="t">So this is going to be our input, and this is going to be our target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2566" target="_blank">00:42:46.160</a></span> | <span class="t">So this is like a translation problem, but it's a bit simpler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2572" target="_blank">00:42:52.140</a></span> | <span class="t">So we don't have pre-trained phoneme vectors or pre-trained letter vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2578" target="_blank">00:42:58.960</a></span> | <span class="t">So we're going to have to do this by building a model, and we're going to have to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2581" target="_blank">00:43:01.920</a></span> | <span class="t">some embeddings of our own.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2585" target="_blank">00:43:05.200</a></span> | <span class="t">So in general, the first steps necessary to create an NLP model tends to look very, very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2593" target="_blank">00:43:13.600</a></span> | <span class="t">similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2594" target="_blank">00:43:14.600</a></span> | <span class="t">I feel like I've done them in a thousand different ways now, and at some point I really need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2599" target="_blank">00:43:19.560</a></span> | <span class="t">to abstract this all out into a simple set of functions that we use again and again and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2605" target="_blank">00:43:25.560</a></span> | <span class="t">again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2606" target="_blank">00:43:26.560</a></span> | <span class="t">But let's go through it, and if you've got any questions about any of the code or steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2612" target="_blank">00:43:32.560</a></span> | <span class="t">or anything, let me know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2616" target="_blank">00:43:36.200</a></span> | <span class="t">So the basic pronunciation dictionary is just a text file, and I'm going to just grab the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2625" target="_blank">00:43:45.360</a></span> | <span class="t">lines which are actual words so they have to start with a letter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2632" target="_blank">00:43:52.360</a></span> | <span class="t">Now something which I have, so we're going to go through every line in the text file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2646" target="_blank">00:44:06.200</a></span> | <span class="t">Here's a handy thing that a lot of people don't realize you can do in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2649" target="_blank">00:44:09.960</a></span> | <span class="t">When you call open, that returns a generator which lists all of the lines.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2654" target="_blank">00:44:14.860</a></span> | <span class="t">So if you just go for l in openblah, that's now looping through every line in that file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2663" target="_blank">00:44:23.120</a></span> | <span class="t">So I can then say filter those which start with a lowercase letter, and then strip off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2678" target="_blank">00:44:38.120</a></span> | <span class="t">any white space and split it on white space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2684" target="_blank">00:44:44.120</a></span> | <span class="t">So that's basically the steps necessary to separate out the word from the pronunciation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2692" target="_blank">00:44:52.200</a></span> | <span class="t">And then the pronunciation is just white space delimited, so we can then split that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2699" target="_blank">00:44:59.040</a></span> | <span class="t">And that's the steps necessary to get the word and the pronunciation as a set of phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2705" target="_blank">00:45:05.480</a></span> | <span class="t">So as we tend to pretty much always do with these language models, we next need to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2709" target="_blank">00:45:09.980</a></span> | <span class="t">a list of what are all of the vocabulary items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2713" target="_blank">00:45:13.200</a></span> | <span class="t">So in this case, the vocabulary items are all the possible phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2717" target="_blank">00:45:17.360</a></span> | <span class="t">So we can create a set of every possible phoneme, and then we can sort it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2727" target="_blank">00:45:27.160</a></span> | <span class="t">And what we always like to do is get an extra character or an extra object in position 0,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2737" target="_blank">00:45:37.160</a></span> | <span class="t">because remember we use 0 for padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2740" target="_blank">00:45:40.120</a></span> | <span class="t">So that's why I'm going to use underscore as our special padding letter here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2744" target="_blank">00:45:44.880</a></span> | <span class="t">So I'll stick an underscore at the front.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2746" target="_blank">00:45:46.840</a></span> | <span class="t">So here are the first 5 phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2750" target="_blank">00:45:50.560</a></span> | <span class="t">This is our special padding one, which is going to be index 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2754" target="_blank">00:45:54.080</a></span> | <span class="t">And then there's r, r and r with 3 different levels of stress, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2760" target="_blank">00:46:00.520</a></span> | <span class="t">Now the next thing that we tend to do anytime we've got a list of vocabulary items is to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2766" target="_blank">00:46:06.200</a></span> | <span class="t">create a list in the opposite direction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2768" target="_blank">00:46:08.560</a></span> | <span class="t">So we go from phoneme to index, which is just a dictionary where we enumerate through all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2775" target="_blank">00:46:15.680</a></span> | <span class="t">of our phonemes and put it in the opposite order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2779" target="_blank">00:46:19.480</a></span> | <span class="t">So from phoneme to index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2781" target="_blank">00:46:21.840</a></span> | <span class="t">I know we've used this approach a thousand times before, but I just want to make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2787" target="_blank">00:46:27.000</a></span> | <span class="t">everybody understands it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2789" target="_blank">00:46:29.400</a></span> | <span class="t">When you use enumerate in Python, it doesn't just return each phoneme, but it returns a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2794" target="_blank">00:46:34.400</a></span> | <span class="t">tuple that contains the index of the phoneme and then the phoneme itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2799" target="_blank">00:46:39.200</a></span> | <span class="t">So that's the key and the value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2801" target="_blank">00:46:41.700</a></span> | <span class="t">So then if we go value,key, that's now the phoneme followed by the index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2807" target="_blank">00:46:47.120</a></span> | <span class="t">So if we turn that into a dictionary, we now have a dictionary which you can give it a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2810" target="_blank">00:46:50.640</a></span> | <span class="t">phoneme and return it an index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2815" target="_blank">00:46:55.000</a></span> | <span class="t">Here's all the letters of English.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2816" target="_blank">00:46:56.720</a></span> | <span class="t">Again with our special underscore at the front.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2820" target="_blank">00:47:00.760</a></span> | <span class="t">We've got one extra thing we'll talk about later, which is an asterisk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2824" target="_blank">00:47:04.160</a></span> | <span class="t">So that's a list of letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2827" target="_blank">00:47:07.120</a></span> | <span class="t">And so again, to go from letter to letter index, we just create a dictionary which reverses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2832" target="_blank">00:47:12.760</a></span> | <span class="t">it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2837" target="_blank">00:47:17.280</a></span> | <span class="t">So now that we've got our phoneme to index and letter to index, we can use that to convert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2845" target="_blank">00:47:25.280</a></span> | <span class="t">this data into numeric data, which is what we always do with these language models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2851" target="_blank">00:47:31.080</a></span> | <span class="t">We end up with just a list of indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2855" target="_blank">00:47:35.120</a></span> | <span class="t">We can pick some maximum length word, so I'm just going to say 15.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2861" target="_blank">00:47:41.240</a></span> | <span class="t">So we're going to create a dictionary which maps from each word to a list of phonemes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2869" target="_blank">00:47:49.000</a></span> | <span class="t">and we're going to get the indexes for them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2871" target="_blank">00:47:51.360</a></span> | <span class="t">Yes Rachel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2874" target="_blank">00:47:54.880</a></span> | <span class="t">So this dictionary comprehension is a little bit awkward, so I thought this would be a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2880" target="_blank">00:48:00.520</a></span> | <span class="t">opportunity to talk about dictionary comprehensions and list comprehensions for a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2886" target="_blank">00:48:06.160</a></span> | <span class="t">So we're going to pause this in a moment, but first of all, let's look at a couple of examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2890" target="_blank">00:48:10.440</a></span> | <span class="t">of list comprehensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2892" target="_blank">00:48:12.880</a></span> | <span class="t">So the first thing to note is when you go something like this, a string x, y, z or this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2897" target="_blank">00:48:17.520</a></span> | <span class="t">string here, Python is perfectly happy to consider that a list of letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2902" target="_blank">00:48:22.600</a></span> | <span class="t">So Python considers this the same as being a list of x, y, z.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2906" target="_blank">00:48:26.920</a></span> | <span class="t">So you can think of this as two lists, a list of x, y, z and a list of a, b, c.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2912" target="_blank">00:48:32.040</a></span> | <span class="t">So here is the simplest possible list comprehension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2917" target="_blank">00:48:37.640</a></span> | <span class="t">So go through every element of a and put that into a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2922" target="_blank">00:48:42.600</a></span> | <span class="t">So if I call that, that returns exactly what I started with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2926" target="_blank">00:48:46.760</a></span> | <span class="t">So that's not very interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2930" target="_blank">00:48:50.080</a></span> | <span class="t">What if now we replaced 'o' with another list comprehension?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2939" target="_blank">00:48:59.680</a></span> | <span class="t">So what that's going to do is it's now going to return a list for each list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2948" target="_blank">00:49:08.240</a></span> | <span class="t">So this is one way of pulling things out of sub-lists, is to basically take the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2952" target="_blank">00:49:12.760</a></span> | <span class="t">that was here and replace it with a new list comprehension, and that's going to give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2957" target="_blank">00:49:17.040</a></span> | <span class="t">a list of lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2960" target="_blank">00:49:20.520</a></span> | <span class="t">Now the reason I wanted to talk about this is because it's quite confusing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2963" target="_blank">00:49:23.920</a></span> | <span class="t">In Python you can also write this, which is different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2968" target="_blank">00:49:28.680</a></span> | <span class="t">So in this case, I'm going for each object in our a list, and then for each object in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2977" target="_blank">00:49:37.000</a></span> | <span class="t">that sub-list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2978" target="_blank">00:49:38.000</a></span> | <span class="t">And do you see what's different here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2979" target="_blank">00:49:39.760</a></span> | <span class="t">I don't have square brackets, it's just all laid out next to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2984" target="_blank">00:49:44.340</a></span> | <span class="t">So I find this really confusing, but the idea is you're meant to think of this as just being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2989" target="_blank">00:49:49.240</a></span> | <span class="t">like a normal for loop inside a for loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2992" target="_blank">00:49:52.800</a></span> | <span class="t">And so what this does is it goes through x, y, z and then a, b, c, and then in x, y, z</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=2998" target="_blank">00:49:58.720</a></span> | <span class="t">it goes through each of x and y and z, but because there's no embedded set of square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3002" target="_blank">00:50:02.840</a></span> | <span class="t">brackets, that actually ends up flattening the list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3008" target="_blank">00:50:08.020</a></span> | <span class="t">So we're about to see an example of the square bracket version, and pretty soon we'll be seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3023" target="_blank">00:50:23.000</a></span> | <span class="t">an example of this version as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3025" target="_blank">00:50:25.120</a></span> | <span class="t">These are both useful, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3026" target="_blank">00:50:26.280</a></span> | <span class="t">It's very useful to be able to flatten a list, it's very useful to be able to do things with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3031" target="_blank">00:50:31.160</a></span> | <span class="t">sub-lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3032" target="_blank">00:50:32.160</a></span> | <span class="t">And then just to be aware that any time you have any kind of expression like this, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3038" target="_blank">00:50:38.080</a></span> | <span class="t">can replace the thing here with any expression you like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3045" target="_blank">00:50:45.000</a></span> | <span class="t">So we could say, for example, we could say o.upper, so you can basically map different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3065" target="_blank">00:51:05.160</a></span> | <span class="t">computations to each element of a list, and then the second thing you can do is put an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3070" target="_blank">00:51:10.680</a></span> | <span class="t">if here to filter it, if o0=x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3095" target="_blank">00:51:35.760</a></span> | <span class="t">So that's basically the idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3098" target="_blank">00:51:38.720</a></span> | <span class="t">You can create any list comprehension you like by putting computations here, filters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3103" target="_blank">00:51:43.040</a></span> | <span class="t">here and optionally multiple lists of lists here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3108" target="_blank">00:51:48.920</a></span> | <span class="t">The other thing you can do is replace the square brackets with curly brackets, in which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3113" target="_blank">00:51:53.720</a></span> | <span class="t">case you need to put something before a colon and something after a colon, the thing before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3118" target="_blank">00:51:58.440</a></span> | <span class="t">is your key and the thing after is your value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3121" target="_blank">00:52:01.520</a></span> | <span class="t">So here we're going for, oh, and then there's another thing you can do, which is if the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3125" target="_blank">00:52:05.920</a></span> | <span class="t">thing you're looping through is a bunch of lists or tuples or anything like that, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3130" target="_blank">00:52:10.800</a></span> | <span class="t">can pull them out into two pieces, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3134" target="_blank">00:52:14.880</a></span> | <span class="t">So this is the word, and this is the list of phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3138" target="_blank">00:52:18.840</a></span> | <span class="t">So we're going to have the lower case word will be our keys in our dictionary, and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3146" target="_blank">00:52:26.200</a></span> | <span class="t">values will be lists, so we're doing it just like we did down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3152" target="_blank">00:52:32.280</a></span> | <span class="t">And the list will be, let's go through each phoneme and go phoneme to index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3160" target="_blank">00:52:40.280</a></span> | <span class="t">So now we have something that maps from every word to its list of phoneme indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3173" target="_blank">00:52:53.360</a></span> | <span class="t">We can find out what the maximum length of anything is in terms of how many phonemes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3179" target="_blank">00:52:59.360</a></span> | <span class="t">there are, and we can do that by again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3182" target="_blank">00:53:02.000</a></span> | <span class="t">We can just go through every one of those dictionary items, calling length on each one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3188" target="_blank">00:53:08.120</a></span> | <span class="t">and then doing a max on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3190" target="_blank">00:53:10.640</a></span> | <span class="t">So there is the maximum length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3192" target="_blank">00:53:12.800</a></span> | <span class="t">So you can see combining list comprehensions with other functions is also powerful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3202" target="_blank">00:53:22.400</a></span> | <span class="t">So finally we're going to create our nice square arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3211" target="_blank">00:53:31.280</a></span> | <span class="t">Normally we do this with Keras.pad sequences, just for a change, we're going to do this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3216" target="_blank">00:53:36.920</a></span> | <span class="t">manually this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3220" target="_blank">00:53:40.440</a></span> | <span class="t">So the key is that we start out by creating two arrays of zeros, because all the padding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3227" target="_blank">00:53:47.560</a></span> | <span class="t">is going to be zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3228" target="_blank">00:53:48.560</a></span> | <span class="t">So if we start off with all zeros, then we can just fill in the non-zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3232" target="_blank">00:53:52.680</a></span> | <span class="t">So this is going to be all of our phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3236" target="_blank">00:53:56.360</a></span> | <span class="t">This is going to be our actual spelling, that's our target labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3240" target="_blank">00:54:00.220</a></span> | <span class="t">So then we go through all of our, and we've permitted them randomly, so randomly ordered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3244" target="_blank">00:54:04.880</a></span> | <span class="t">things in the pronunciation dictionary, and we put inside input all of the items from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3255" target="_blank">00:54:15.480</a></span> | <span class="t">that pronunciation dictionary, and into labels we go letter to index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3262" target="_blank">00:54:22.800</a></span> | <span class="t">So we now have one thing called input, one thing called labels that contains nice rectangular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3268" target="_blank">00:54:28.360</a></span> | <span class="t">arrays padded with zeros containing exactly what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3276" target="_blank">00:54:36.480</a></span> | <span class="t">I'm not going to worry about this line yet because we're not going to use it for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3279" target="_blank">00:54:39.240</a></span> | <span class="t">starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3282" target="_blank">00:54:42.560</a></span> | <span class="t">So anywhere you see DEC something, just ignore that for now, we'll get back to that later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3289" target="_blank">00:54:49.080</a></span> | <span class="t">Train test split is a very handy function from sklearn that takes all of these lists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3295" target="_blank">00:54:55.800</a></span> | <span class="t">and splits them all in the same way with this proportion in the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3301" target="_blank">00:55:01.680</a></span> | <span class="t">And so input becomes input_train and input_test, labels becomes labels_train and labels_test.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3308" target="_blank">00:55:08.760</a></span> | <span class="t">So that's pretty handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3311" target="_blank">00:55:11.120</a></span> | <span class="t">We've often written that manually, but this is a nice quick way to do it when you've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3315" target="_blank">00:55:15.640</a></span> | <span class="t">lots of lists to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3320" target="_blank">00:55:20.280</a></span> | <span class="t">So just to have a look at how many phonemes we have in our vocabulary, there are 70, how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3325" target="_blank">00:55:25.720</a></span> | <span class="t">many letters in our vocabulary, there's 28, that's because we've got that underscore and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3329" target="_blank">00:55:29.080</a></span> | <span class="t">the star as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3333" target="_blank">00:55:33.200</a></span> | <span class="t">So let's go ahead and create the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3342" target="_blank">00:55:42.080</a></span> | <span class="t">Here's the basic idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3347" target="_blank">00:55:47.640</a></span> | <span class="t">The model has three parts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3352" target="_blank">00:55:52.320</a></span> | <span class="t">The first is an embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3355" target="_blank">00:55:55.620</a></span> | <span class="t">So the embedding is going to take every one of our phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3360" target="_blank">00:56:00.240</a></span> | <span class="t">Max_len_p is the maximum number of phonemes we have in any pronunciation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3367" target="_blank">00:56:07.200</a></span> | <span class="t">And each one of those phonemes is going to go into an embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3373" target="_blank">00:56:13.400</a></span> | <span class="t">And the lookup for that embedding is the vocab size for phonemes, which I think was 70.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3381" target="_blank">00:56:21.880</a></span> | <span class="t">And then the output is whatever we decide, what dimensionality we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3386" target="_blank">00:56:26.600</a></span> | <span class="t">And in experimentation, I found 120 seems to work pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3390" target="_blank">00:56:30.840</a></span> | <span class="t">I was surprised by how high that number is, but there you go, it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3397" target="_blank">00:56:37.600</a></span> | <span class="t">We started out with a list of phonemes, and then after we go through this embedding, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3410" target="_blank">00:56:50.280</a></span> | <span class="t">now have a list of embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3412" target="_blank">00:56:52.840</a></span> | <span class="t">So this is like 70, and this is like 120.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3422" target="_blank">00:57:02.640</a></span> | <span class="t">So the basic idea is to take this big thing, which is all of our phonemes embedded, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3431" target="_blank">00:57:11.320</a></span> | <span class="t">we want to turn it into a single distributed representation which contains all of the richness</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3439" target="_blank">00:57:19.600</a></span> | <span class="t">of what this pronunciation says.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3442" target="_blank">00:57:22.440</a></span> | <span class="t">Later on we're going to be doing the same thing with an English sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3447" target="_blank">00:57:27.000</a></span> | <span class="t">And so we know that when you have a sequence and you want to turn it into a representation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3454" target="_blank">00:57:34.040</a></span> | <span class="t">one great way of doing that is with an RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3459" target="_blank">00:57:39.360</a></span> | <span class="t">Now why an RNN?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3461" target="_blank">00:57:41.920</a></span> | <span class="t">Because an RNN we know is good at dealing with things like state and memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3467" target="_blank">00:57:47.320</a></span> | <span class="t">So when we're looking at translation, we really want something which can remember where are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3474" target="_blank">00:57:54.280</a></span> | <span class="t">we.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3475" target="_blank">00:57:55.280</a></span> | <span class="t">So let's say we were doing this simple phonetic translation, the idea of have we just had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3483" target="_blank">00:58:03.000</a></span> | <span class="t">a C?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3484" target="_blank">00:58:04.000</a></span> | <span class="t">Because if we just had a C, then the H is going to make a totally different sound to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3488" target="_blank">00:58:08.080</a></span> | <span class="t">if we haven't just had a C.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3493" target="_blank">00:58:13.360</a></span> | <span class="t">So an RNN we think is a good way to do this kind of thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3497" target="_blank">00:58:17.640</a></span> | <span class="t">And in general, this whole class of models remember is called Seek-to-Seek, sequence-to-sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3505" target="_blank">00:58:25.360</a></span> | <span class="t">models, which is where we start with some arbitrary length sequence and we produce some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3510" target="_blank">00:58:30.680</a></span> | <span class="t">arbitrary length sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3512" target="_blank">00:58:32.600</a></span> | <span class="t">And so the general idea here is taking that arbitrary length sequence and turning it into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3517" target="_blank">00:58:37.280</a></span> | <span class="t">a fixed size representation using an RNN is probably a good first step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3533" target="_blank">00:58:53.560</a></span> | <span class="t">So looking ahead, I'm actually going to be using quite a few layers of RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3543" target="_blank">00:59:03.040</a></span> | <span class="t">So to make that easier, we've created a getRNN function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3555" target="_blank">00:59:15.280</a></span> | <span class="t">You can put anything you like here, GRU or LSTM or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3559" target="_blank">00:59:19.640</a></span> | <span class="t">And yes indeed, I am using dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3564" target="_blank">00:59:24.880</a></span> | <span class="t">The kind of dropout that you use in an RNN is slightly different to normal dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3569" target="_blank">00:59:29.760</a></span> | <span class="t">It turns out that if the particular things you dropout, it's best to have them the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3576" target="_blank">00:59:36.760</a></span> | <span class="t">things at every time step in an RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3581" target="_blank">00:59:41.240</a></span> | <span class="t">There's a really good paper that explains why this is the case and shows that this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3585" target="_blank">00:59:45.520</a></span> | <span class="t">the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3586" target="_blank">00:59:46.560</a></span> | <span class="t">So this is why there's a special dropout parameter inside the RNN in Keras because it does this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3592" target="_blank">00:59:52.920</a></span> | <span class="t">proper RNN-style dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3596" target="_blank">00:59:56.960</a></span> | <span class="t">So I put in a tiny bit of dropout here, and if it turns out that we overfit, we can always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3605" target="_blank">01:00:05.320</a></span> | <span class="t">increase it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3607" target="_blank">01:00:07.400</a></span> | <span class="t">If we don't, we can always turn it to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3612" target="_blank">01:00:12.920</a></span> | <span class="t">So what we're going to do is -- yes, Rachel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3616" target="_blank">01:00:16.840</a></span> | <span class="t">I don't know if you remember, but when we looked at doing RNNs from scratch last year,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3636" target="_blank">01:00:36.840</a></span> | <span class="t">we learned that you could actually combine the matrices together and do a single matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3641" target="_blank">01:00:41.960</a></span> | <span class="t">computation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3642" target="_blank">01:00:42.960</a></span> | <span class="t">If you do that, it's going to use up more memory, but it allows the GPU to be more highly parallel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3649" target="_blank">01:00:49.600</a></span> | <span class="t">So if you look at the Keras documentation, it will tell you the different things you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3653" target="_blank">01:00:53.560</a></span> | <span class="t">can use, but since we're using a GPU, you probably always want to say consume less equals GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3663" target="_blank">01:01:03.200</a></span> | <span class="t">The other thing that we learned about last year is bidirectional RNNs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3669" target="_blank">01:01:09.760</a></span> | <span class="t">And maybe the best way to come at this is actually to go all the way back and remind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3674" target="_blank">01:01:14.160</a></span> | <span class="t">you how RNNs work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3679" target="_blank">01:01:19.320</a></span> | <span class="t">We haven't done much revision, but it's been a while since we've looked at RNNs in much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3683" target="_blank">01:01:23.680</a></span> | <span class="t">detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3684" target="_blank">01:01:24.680</a></span> | <span class="t">So just to remind you, this is kind of our drawing of a totally basic neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3691" target="_blank">01:01:31.520</a></span> | <span class="t">Square is input, circle is intermediate activations, hidden, and triangle is output, and arrows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3700" target="_blank">01:01:40.000</a></span> | <span class="t">represent affine transformations with non-linearities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3707" target="_blank">01:01:47.880</a></span> | <span class="t">We can then have multiple copies of those to create deeper convolutions, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3717" target="_blank">01:01:57.160</a></span> | <span class="t">And so the other thing we can do is actually have inputs going in at different places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3723" target="_blank">01:02:03.740</a></span> | <span class="t">So in this case, if we were trying to predict the third character from first two characters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3728" target="_blank">01:02:08.040</a></span> | <span class="t">we can use a totally standard neural network and actually have input coming in at two different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3732" target="_blank">01:02:12.720</a></span> | <span class="t">places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3737" target="_blank">01:02:17.920</a></span> | <span class="t">And then we realized that we could kind of make this arbitrarily large, but what we should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3742" target="_blank">01:02:22.560</a></span> | <span class="t">probably do then is make everything where an input is going to a hidden state be the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3747" target="_blank">01:02:27.240</a></span> | <span class="t">same matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3748" target="_blank">01:02:28.240</a></span> | <span class="t">So this color coding, remember, represents the same weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3753" target="_blank">01:02:33.040</a></span> | <span class="t">So hidden to hidden would be the same weight matrix and hidden to output, and it's a separate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3757" target="_blank">01:02:37.440</a></span> | <span class="t">weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3760" target="_blank">01:02:40.760</a></span> | <span class="t">So then to remind you, we realized that we could draw that more simply like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3766" target="_blank">01:02:46.160</a></span> | <span class="t">So RNNs, when they're unrolled, just look like a normal neural network in which some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3773" target="_blank">01:02:53.440</a></span> | <span class="t">of the weight matrices are tied together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3775" target="_blank">01:02:55.940</a></span> | <span class="t">And if this is not ringing a bell, go back to lesson 5 where we actually build these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3783" target="_blank">01:03:03.160</a></span> | <span class="t">weight matrices from scratch and tie them together manually so that will hopefully remind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3790" target="_blank">01:03:10.640</a></span> | <span class="t">you of what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3792" target="_blank">01:03:12.840</a></span> | <span class="t">Now importantly, we can then take one of those RNNs and have the output go to the input of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3802" target="_blank">01:03:22.720</a></span> | <span class="t">another RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3804" target="_blank">01:03:24.860</a></span> | <span class="t">And these are stacked RNNs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3806" target="_blank">01:03:26.360</a></span> | <span class="t">And stacked RNNs basically give us richer computations in our recurrent neural nets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3815" target="_blank">01:03:35.280</a></span> | <span class="t">And this is what it looks like when we unroll it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3819" target="_blank">01:03:39.160</a></span> | <span class="t">So you can see here that we've got multiple inputs coming in, going through multiple layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3824" target="_blank">01:03:44.720</a></span> | <span class="t">and creating multiple outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3827" target="_blank">01:03:47.020</a></span> | <span class="t">But of course we don't have to create multiple outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3831" target="_blank">01:03:51.680</a></span> | <span class="t">You could also get rid of these two triangles here and have just one output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3841" target="_blank">01:04:01.440</a></span> | <span class="t">And remember in Keras, the difference is whether or not we say return_sequences=true or return_sequences=false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3848" target="_blank">01:04:08.760</a></span> | <span class="t">This one you're seeing here is return_sequences=true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3855" target="_blank">01:04:15.320</a></span> | <span class="t">This one here is return_sequences=false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3859" target="_blank">01:04:19.680</a></span> | <span class="t">So what we've got is input_train has 97,000 words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3874" target="_blank">01:04:34.000</a></span> | <span class="t">Each one is of length 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3876" target="_blank">01:04:36.600</a></span> | <span class="t">It's 15 characters long plus the padding, and then labels is 15 because we chose earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3900" target="_blank">01:05:00.520</a></span> | <span class="t">on that our max length would be a 15 long spelling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3904" target="_blank">01:05:04.700</a></span> | <span class="t">So phonemes don't match to letters exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3910" target="_blank">01:05:10.200</a></span> | <span class="t">So after the embedding, so if we take one of those tens of thousands of words, remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3919" target="_blank">01:05:19.640</a></span> | <span class="t">it was of length for phonemes, length 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3933" target="_blank">01:05:33.720</a></span> | <span class="t">And then we're putting it into an embedding matrix which is 70 by 120.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3945" target="_blank">01:05:45.720</a></span> | <span class="t">And the reason it's 70 is that each of these phonemes contains a number between 0 to 69.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3957" target="_blank">01:05:57.360</a></span> | <span class="t">So basically we go through and we get each one of these indexes and we look up to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3961" target="_blank">01:06:01.720</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3962" target="_blank">01:06:02.720</a></span> | <span class="t">So this is 5 here, then we find number 5 here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3967" target="_blank">01:06:07.280</a></span> | <span class="t">And so we end up with 16 by 120.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3975" target="_blank">01:06:15.720</a></span> | <span class="t">"Are we then taking a sequence of these phonemes represented as 120 dimensional floating point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3986" target="_blank">01:06:26.080</a></span> | <span class="t">vectors and using an RNN to create a sequence of word2vec embeddings which we will then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3992" target="_blank">01:06:32.080</a></span> | <span class="t">reverse to actual words?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3993" target="_blank">01:06:33.960</a></span> | <span class="t">So we're not going to use word2vec here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3996" target="_blank">01:06:36.320</a></span> | <span class="t">Word2vec is a particular set of pre-trained embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=3999" target="_blank">01:06:39.760</a></span> | <span class="t">We're not using pre-trained embeddings, we have to create our own embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4005" target="_blank">01:06:45.640</a></span> | <span class="t">We're creating phoneme embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4007" target="_blank">01:06:47.960</a></span> | <span class="t">So if somebody else later on wanted to do something else with phonemes, and we saved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4013" target="_blank">01:06:53.360</a></span> | <span class="t">the result of this, we could provide phoneme2vec.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4016" target="_blank">01:06:56.960</a></span> | <span class="t">And you could download them and use the fast.ai pre-trained phoneme2vec embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4023" target="_blank">01:07:03.000</a></span> | <span class="t">This is how embeddings basically get created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4025" target="_blank">01:07:05.760</a></span> | <span class="t">It's people build models starting with random embeddings and then save those embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4031" target="_blank">01:07:11.560</a></span> | <span class="t">and make them available for other people to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4033" target="_blank">01:07:13.720</a></span> | <span class="t">"I may be misinterpreting it, but I thought the question was getting at the second set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4040" target="_blank">01:07:20.800</a></span> | <span class="t">of embeddings when you want to get back to your words."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4045" target="_blank">01:07:25.600</a></span> | <span class="t">So let's wait until we get there, because we're going to create letters, not words,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4051" target="_blank">01:07:31.720</a></span> | <span class="t">and then we'll just join the letters together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4053" target="_blank">01:07:33.840</a></span> | <span class="t">So there won't be any word2vec here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4055" target="_blank">01:07:35.560</a></span> | <span class="t">So we've got, as far as creating our embeddings, we've then got an RNN which is going to take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4064" target="_blank">01:07:44.860</a></span> | <span class="t">our embeddings and attempt to turn it into a single vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4072" target="_blank">01:07:52.760</a></span> | <span class="t">That's kind of what an RNN does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4075" target="_blank">01:07:55.040</a></span> | <span class="t">So we've got here return sequences by default is true, so this first RNN returns something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4086" target="_blank">01:08:06.020</a></span> | <span class="t">which is just as long as we started with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4088" target="_blank">01:08:08.800</a></span> | <span class="t">And so if you want to stack RNNs on top of each other, every one of them is return sequences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4092" target="_blank">01:08:12.880</a></span> | <span class="t">equals true until the last one isn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4095" target="_blank">01:08:15.720</a></span> | <span class="t">So that's why we have false here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4098" target="_blank">01:08:18.440</a></span> | <span class="t">So at the end of this one, this gives us a single vector which is the final state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4105" target="_blank">01:08:25.800</a></span> | <span class="t">The other important piece is bidirectional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4108" target="_blank">01:08:28.980</a></span> | <span class="t">And bidirectional, you can totally do this manually yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4112" target="_blank">01:08:32.440</a></span> | <span class="t">You take your input and feed it into an RNN, and then you reverse your input and feed it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4119" target="_blank">01:08:39.760</a></span> | <span class="t">into a different RNN, and then just concatenate the two together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4124" target="_blank">01:08:44.480</a></span> | <span class="t">So Keras has something which does that for you, which is called bidirectional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4130" target="_blank">01:08:50.420</a></span> | <span class="t">Bidirectional actually requires you to pass it an RNN, so it takes an RNN and returns two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4138" target="_blank">01:08:58.000</a></span> | <span class="t">copies of that RNN stacked on top of each other, one of which reverses its input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4143" target="_blank">01:09:03.000</a></span> | <span class="t">And so why is that interesting?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4145" target="_blank">01:09:05.480</a></span> | <span class="t">That's interesting because often in language, what happens later influences what comes before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4152" target="_blank">01:09:12.660</a></span> | <span class="t">For example, in French, the gender of your definite article depends on the noun that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4161" target="_blank">01:09:21.320</a></span> | <span class="t">refers to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4162" target="_blank">01:09:22.320</a></span> | <span class="t">So you need to be able to look backwards or forwards in both directions to figure out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4167" target="_blank">01:09:27.060</a></span> | <span class="t">how to match those two together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4168" target="_blank">01:09:28.880</a></span> | <span class="t">Or in any language with tense, what verb do you use depends on the tense and often also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4177" target="_blank">01:09:37.080</a></span> | <span class="t">depends on the details about the subject and the object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4180" target="_blank">01:09:40.280</a></span> | <span class="t">So we want to be able to both look forwards and look backwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4184" target="_blank">01:09:44.440</a></span> | <span class="t">So that's why we want two copies of the RNN, one which goes from left to right and one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4189" target="_blank">01:09:49.560</a></span> | <span class="t">which goes from right to left.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4191" target="_blank">01:09:51.680</a></span> | <span class="t">And indeed, we could assume that when you spell things, I'm not exactly sure how this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4195" target="_blank">01:09:55.720</a></span> | <span class="t">would work, but when you spell things depending on what the latest dresses might be or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4200" target="_blank">01:10:00.440</a></span> | <span class="t">later details of the phonetics might be might change how you pronounce things earlier on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4207" target="_blank">01:10:07.120</a></span> | <span class="t">Does the bidirectional RNN can cat two RNNs or does it stack them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4224" target="_blank">01:10:24.760</a></span> | <span class="t">You end up with the same number of dimensions that you had before, but it basically doubles</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4232" target="_blank">01:10:32.240</a></span> | <span class="t">the number of features that you have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4234" target="_blank">01:10:34.840</a></span> | <span class="t">So in this case, we have 240, so it just doubles those, and I think we had one question here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4247" target="_blank">01:10:47.720</a></span> | <span class="t">Okay, so let's simplify this down a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4277" target="_blank">01:11:17.040</a></span> | <span class="t">Basically, we started out with a set of embeddings, and we've gone through two layers, we've gone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4290" target="_blank">01:11:30.240</a></span> | <span class="t">through a bidirectional RNN, and then we feed that to a second RNN to create a representation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4299" target="_blank">01:11:39.320</a></span> | <span class="t">of this ordered list of phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4303" target="_blank">01:11:43.200</a></span> | <span class="t">And specifically, this is a vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4306" target="_blank">01:11:46.820</a></span> | <span class="t">So x at this point is a vector, because return sequence is equals false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4313" target="_blank">01:11:53.400</a></span> | <span class="t">That vector, once we've trained this thing, the idea is it represents everything important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4320" target="_blank">01:12:00.800</a></span> | <span class="t">there is to know about this ordered list of phonemes, everything that we could possibly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4324" target="_blank">01:12:04.480</a></span> | <span class="t">need to know in order to spell it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4328" target="_blank">01:12:08.520</a></span> | <span class="t">So the idea is we could now take that vector and feed it into a new RNN, or even a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4336" target="_blank">01:12:16.800</a></span> | <span class="t">layers of RNN, and that RNN could basically go through and with return sequence equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4344" target="_blank">01:12:24.560</a></span> | <span class="t">true this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4347" target="_blank">01:12:27.360</a></span> | <span class="t">It could spit out at every time step what it thinks the next letter in this spelling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4352" target="_blank">01:12:32.240</a></span> | <span class="t">is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4354" target="_blank">01:12:34.000</a></span> | <span class="t">And so this is how a sequence-to-sequence works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4356" target="_blank">01:12:36.200</a></span> | <span class="t">One part, which is called the encoder, takes our initial sequence and turns it into a distributed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4368" target="_blank">01:12:48.160</a></span> | <span class="t">representation into a vector using, generally speaking, some stacked RNNs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4376" target="_blank">01:12:56.080</a></span> | <span class="t">Then the second piece, called the decoder, takes the output of the encoder and passes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4384" target="_blank">01:13:04.720</a></span> | <span class="t">that into a separate stack of RNNs with return sequence equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4390" target="_blank">01:13:10.400</a></span> | <span class="t">And those RNNs are taught to then generate the labels, in this case the spellings, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4397" target="_blank">01:13:17.240</a></span> | <span class="t">in our later case the English sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4402" target="_blank">01:13:22.080</a></span> | <span class="t">Now in Keras, it's not convenient to create an RNN by handing it some initial state, some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4414" target="_blank">01:13:34.040</a></span> | <span class="t">initial hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4415" target="_blank">01:13:35.720</a></span> | <span class="t">That's not really how Keras likes to do things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4418" target="_blank">01:13:38.680</a></span> | <span class="t">Keras expects to be handed a list of inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4425" target="_blank">01:13:45.960</a></span> | <span class="t">Problem number one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4427" target="_blank">01:13:47.320</a></span> | <span class="t">Problem number two, if you do hand it to an RNN just at the start, it's quite hard for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4433" target="_blank">01:13:53.120</a></span> | <span class="t">the RNN to remember the whole time what is this word I'm meant to be translating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4438" target="_blank">01:13:58.520</a></span> | <span class="t">It has to keep two things in its head.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4440" target="_blank">01:14:00.400</a></span> | <span class="t">One is what's the word I'm meant to be spelling, and the second is what's the letter I'm trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4446" target="_blank">01:14:06.040</a></span> | <span class="t">to spell right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4447" target="_blank">01:14:07.780</a></span> | <span class="t">So what we do with Keras is we actually take this whole state and we copy it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4458" target="_blank">01:14:18.840</a></span> | <span class="t">So in this case we're trying to create a word that could be up to 15 letters long, so in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4468" target="_blank">01:14:28.440</a></span> | <span class="t">other words 15 time steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4473" target="_blank">01:14:33.400</a></span> | <span class="t">So we take this and we actually make 15 copies of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4486" target="_blank">01:14:46.040</a></span> | <span class="t">And those 15 copies of our final encoder state becomes the input to our decoder RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4494" target="_blank">01:14:54.760</a></span> | <span class="t">So it seems kind of clunky, but it's actually not difficult to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4498" target="_blank">01:14:58.000</a></span> | <span class="t">In Keras we just go like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4501" target="_blank">01:15:01.480</a></span> | <span class="t">We take the output from our encoder and we repeat it 15 times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4511" target="_blank">01:15:11.840</a></span> | <span class="t">So we literally have 15 identical copies of the same vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4516" target="_blank">01:15:16.320</a></span> | <span class="t">And so that's how Keras expects to see things, and it also turns out that you get better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4522" target="_blank">01:15:22.080</a></span> | <span class="t">results when you pass into the RNN the state that it needs again and again at every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4527" target="_blank">01:15:27.000</a></span> | <span class="t">step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4528" target="_blank">01:15:28.000</a></span> | <span class="t">So we're basically passing in something saying we're trying to spell this word, we're trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4532" target="_blank">01:15:32.280</a></span> | <span class="t">to spell this word, we're trying to spell this word, we're trying to spell this word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4535" target="_blank">01:15:35.740</a></span> | <span class="t">And then as the RNN goes along, it's generating its own internal state, figuring out what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4542" target="_blank">01:15:42.760</a></span> | <span class="t">have we spelt so far and what are we going to have to spell next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4545" target="_blank">01:15:45.440</a></span> | <span class="t">Why can't we have return_sequences=true for the second bidirectional LSTM?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4555" target="_blank">01:15:55.400</a></span> | <span class="t">Not bidirectional for the second LSTM, we only have one bidirectional LSTM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4562" target="_blank">01:16:02.000</a></span> | <span class="t">We don't want return_sequences=true here because we're trying to create a representation of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4568" target="_blank">01:16:08.200</a></span> | <span class="t">the whole word we're trying to spell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4571" target="_blank">01:16:11.880</a></span> | <span class="t">So there's no point having something saying here's a representation of the first phoneme,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4579" target="_blank">01:16:19.080</a></span> | <span class="t">of the first 2, of the first 3, of the first 4, of the first 5, because we don't really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4584" target="_blank">01:16:24.200</a></span> | <span class="t">know exactly which letter of the output is going to correspond to which phoneme of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4589" target="_blank">01:16:29.360</a></span> | <span class="t">input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4590" target="_blank">01:16:30.360</a></span> | <span class="t">And particularly when we get to translation, it can get much harder, like some languages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4593" target="_blank">01:16:33.440</a></span> | <span class="t">totally reverse the subject and object order or put the verb somewhere else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4597" target="_blank">01:16:37.640</a></span> | <span class="t">So that's why we try to package up the whole thing into a single piece of state which has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4603" target="_blank">01:16:43.760</a></span> | <span class="t">all of the information necessary to build our target sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4609" target="_blank">01:16:49.160</a></span> | <span class="t">So remember, these sequence-to-sequence models are also used for things like image captioning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4617" target="_blank">01:16:57.760</a></span> | <span class="t">So with image captioning, you wouldn't want to have something that created a representation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4624" target="_blank">01:17:04.600</a></span> | <span class="t">separately for every pixel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4628" target="_blank">01:17:08.240</a></span> | <span class="t">You want a single representation, which is like this is something that somehow contains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4634" target="_blank">01:17:14.440</a></span> | <span class="t">all of the information about what this is a picture of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4638" target="_blank">01:17:18.000</a></span> | <span class="t">Or if you're doing neural language translation, here's my English sentence, I've turned it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4644" target="_blank">01:17:24.560</a></span> | <span class="t">into a representation of everything that it means so that I can generate my French sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4649" target="_blank">01:17:29.140</a></span> | <span class="t">We're going to be seeing later how we can use return sequences equals true when we look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4655" target="_blank">01:17:35.080</a></span> | <span class="t">at attention models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4657" target="_blank">01:17:37.040</a></span> | <span class="t">But for now, we're just going to keep things simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4660" target="_blank">01:17:40.280</a></span> | <span class="t">Well, it does, it absolutely does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4685" target="_blank">01:18:05.520</a></span> | <span class="t">And indeed we can use convolutional models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4688" target="_blank">01:18:08.720</a></span> | <span class="t">But if you remember back to Lesson 5, we talked about some of the challenges with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4698" target="_blank">01:18:18.600</a></span> | <span class="t">So if you're trying to create something which can parse some kind of markup block like this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4707" target="_blank">01:18:27.280</a></span> | <span class="t">it has to both remember that you've just opened up a piece of markup, you're in the middle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4711" target="_blank">01:18:31.960</a></span> | <span class="t">of it, and then in here you have to remember that you're actually inside a comment block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4715" target="_blank">01:18:35.360</a></span> | <span class="t">so that at the end you're able to close it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4718" target="_blank">01:18:38.860</a></span> | <span class="t">This kind of long-term dependency and memory and stateful representation becomes increasingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4724" target="_blank">01:18:44.760</a></span> | <span class="t">difficult to do with CNNs as they get longer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4729" target="_blank">01:18:49.320</a></span> | <span class="t">It's not impossible by any means, but RNNs are one good way of doing this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4737" target="_blank">01:18:57.800</a></span> | <span class="t">But it is critical that we start with an embedding, because where else in image we're already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4743" target="_blank">01:19:03.680</a></span> | <span class="t">given float-valued numbers that really represent the image, that's not true with text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4750" target="_blank">01:19:10.660</a></span> | <span class="t">So with text we have to use embeddings to turn it into these nice numeric representations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4757" target="_blank">01:19:17.680</a></span> | <span class="t">RNN is a kind of generic term here, so a specific network we use is LSTM, but there are other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4777" target="_blank">01:19:37.540</a></span> | <span class="t">types we can use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4778" target="_blank">01:19:38.540</a></span> | <span class="t">>> GRU, remember?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4779" target="_blank">01:19:39.540</a></span> | <span class="t">>> Yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4780" target="_blank">01:19:40.540</a></span> | <span class="t">>> Simple RNN?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4781" target="_blank">01:19:41.540</a></span> | <span class="t">>> So Keras supports a couple of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4782" target="_blank">01:19:42.540</a></span> | <span class="t">>> Yeah, with all the ones we did in the last part of the course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4783" target="_blank">01:19:43.540</a></span> | <span class="t">So we looked in Simple RNN, GRU, and LSTM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4784" target="_blank">01:19:44.540</a></span> | <span class="t">>> So is that like the LSTM would be the best for that task?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4786" target="_blank">01:19:46.280</a></span> | <span class="t">>> No, not at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4790" target="_blank">01:19:50.920</a></span> | <span class="t">The GRUs and LSTMs are pretty similar, so it's not worth thinking about too much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4798" target="_blank">01:19:58.480</a></span> | <span class="t">So at this point here, we now have 15 copies of x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4821" target="_blank">01:20:21.300</a></span> | <span class="t">And so we now pass that into two more layers of RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4827" target="_blank">01:20:27.040</a></span> | <span class="t">So this here is our encoder, and this here is our decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4833" target="_blank">01:20:33.300</a></span> | <span class="t">There's nothing we did particularly in Keras to say this is an encoder, this is a decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4837" target="_blank">01:20:37.760</a></span> | <span class="t">The important thing is the return sequence equals false here, and the repeat vector here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4844" target="_blank">01:20:44.820</a></span> | <span class="t">So what does it have to do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4846" target="_blank">01:20:46.320</a></span> | <span class="t">Well somehow it has to take this single summary and create some layers of RNNs until then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4854" target="_blank">01:20:54.880</a></span> | <span class="t">at the end we say, okay, here's a dense layer, and it's time distributed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4861" target="_blank">01:21:01.480</a></span> | <span class="t">So remember that means that we actually have 15 dense layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4868" target="_blank">01:21:08.320</a></span> | <span class="t">And so each of these dense layers now has a softmax activation, which means that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4876" target="_blank">01:21:16.160</a></span> | <span class="t">basically can then do an argmax on that to create our final list of letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4882" target="_blank">01:21:22.080</a></span> | <span class="t">So this is kind of our reverse embedding, if you like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4889" target="_blank">01:21:29.400</a></span> | <span class="t">So the model is very little code, and once we've built it, and again, if things like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4898" target="_blank">01:21:38.080</a></span> | <span class="t">this are mysterious to you, go back and re-look at lessons 4, 5 and 6, remind you how these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4907" target="_blank">01:21:47.560</a></span> | <span class="t">embeddings work and how these kind of time distributed dense works to give us effectively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4912" target="_blank">01:21:52.640</a></span> | <span class="t">a kind of reverse embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4916" target="_blank">01:21:56.460</a></span> | <span class="t">So that's our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4918" target="_blank">01:21:58.480</a></span> | <span class="t">It starts with our phoneme input, ends with our time distributed dense output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4924" target="_blank">01:22:04.560</a></span> | <span class="t">We can then compile that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4927" target="_blank">01:22:07.560</a></span> | <span class="t">Our targets are just indexes, remember we turn them into indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4931" target="_blank">01:22:11.480</a></span> | <span class="t">So we use this handy sparse categorical cross entropy, just the same as our normal categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4938" target="_blank">01:22:18.160</a></span> | <span class="t">cross entropy, but rather than one hot encoding, we just skip the whole one hot encoding and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4942" target="_blank">01:22:22.620</a></span> | <span class="t">just leave it as an index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4946" target="_blank">01:22:26.360</a></span> | <span class="t">We can go ahead and fit passing in our training data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4950" target="_blank">01:22:30.800</a></span> | <span class="t">So that was our rectangular data of the phoneme indexes, our labels, and then we can use some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4960" target="_blank">01:22:40.760</a></span> | <span class="t">valid test set data that we set aside as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4965" target="_blank">01:22:45.360</a></span> | <span class="t">So we've hit that for a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4968" target="_blank">01:22:48.040</a></span> | <span class="t">I found that the first three epochs, the loss went down like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4972" target="_blank">01:22:52.280</a></span> | <span class="t">The second three epochs it went down like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4974" target="_blank">01:22:54.880</a></span> | <span class="t">It seemed to be flattening out, so that's as far as I stopped it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4979" target="_blank">01:22:59.600</a></span> | <span class="t">So we can now see how well that worked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4985" target="_blank">01:23:05.680</a></span> | <span class="t">Now what I wanted to do was not just say what percentage of letters are correct, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4991" target="_blank">01:23:11.560</a></span> | <span class="t">that doesn't really give you the right sense at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4994" target="_blank">01:23:14.480</a></span> | <span class="t">What I really want to know is what percentage of words are correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=4998" target="_blank">01:23:18.640</a></span> | <span class="t">So that's what this little eval_keras function does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5002" target="_blank">01:23:22.860</a></span> | <span class="t">It takes the thing that I'm trying to evaluate, calls.predict on it, it then does the argmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5011" target="_blank">01:23:31.960</a></span> | <span class="t">as per usual to take that softmax and turn it into a specific number, which character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5017" target="_blank">01:23:37.360</a></span> | <span class="t">is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5019" target="_blank">01:23:39.440</a></span> | <span class="t">And then I want to check whether it's true for all of the characters that the real character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5026" target="_blank">01:23:46.120</a></span> | <span class="t">equals the predicted character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5029" target="_blank">01:23:49.380</a></span> | <span class="t">So this is going to return true only if every single item in the word is correct.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5036" target="_blank">01:23:56.600</a></span> | <span class="t">And so then taking the mean of that is going to tell us what percentage of the words did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5040" target="_blank">01:24:00.520</a></span> | <span class="t">it get totally right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5043" target="_blank">01:24:03.520</a></span> | <span class="t">And unfortunately the answer is not very many, 26%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5048" target="_blank">01:24:08.840</a></span> | <span class="t">So let's look at some examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5051" target="_blank">01:24:11.800</a></span> | <span class="t">So we can go through 20 words at random, and we can print out all of the phonemes with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5059" target="_blank">01:24:19.160</a></span> | <span class="t">dashes between.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5060" target="_blank">01:24:20.160</a></span> | <span class="t">So here's an example of some phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5063" target="_blank">01:24:23.260</a></span> | <span class="t">We can print out the actual word, and we can print out our prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5070" target="_blank">01:24:30.920</a></span> | <span class="t">So here is a whole bunch of words that I don't really recognize, perturbations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5078" target="_blank">01:24:38.040</a></span> | <span class="t">It should be spelled like that, slightly wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5086" target="_blank">01:24:46.960</a></span> | <span class="t">So you can see some of the time the mistakes it makes are pretty clear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5091" target="_blank">01:24:51.220</a></span> | <span class="t">So "larrow" could be spelled like that, but this seems perfectly reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5098" target="_blank">01:24:58.680</a></span> | <span class="t">Sometimes on the other hand it's "way off."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5102" target="_blank">01:25:02.840</a></span> | <span class="t">And interestingly, what you find is that most of the time when it's way off, I found it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5110" target="_blank">01:25:10.080</a></span> | <span class="t">tends to be with the longer words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5115" target="_blank">01:25:15.040</a></span> | <span class="t">And the reason for that is that the longer the word, this one where it's terrible, is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5123" target="_blank">01:25:23.520</a></span> | <span class="t">by far the most phonemes, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11 phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5131" target="_blank">01:25:31.080</a></span> | <span class="t">So we had to somehow create a single representation that contained all of the information of all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5140" target="_blank">01:25:40.080</a></span> | <span class="t">of those 11 phonemes in a single vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5143" target="_blank">01:25:43.280</a></span> | <span class="t">And that's hard to do, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5145" target="_blank">01:25:45.380</a></span> | <span class="t">And then that single vector got passed to the decoder, and that was everything it had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5154" target="_blank">01:25:54.200</a></span> | <span class="t">to try to create this output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5158" target="_blank">01:25:58.400</a></span> | <span class="t">So that's the problem with this basic encoder-decoder method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5166" target="_blank">01:26:06.280</a></span> | <span class="t">And indeed, here is a graph from the paper which originally introduced attentional models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5183" target="_blank">01:26:23.040</a></span> | <span class="t">And this is for neural translation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5184" target="_blank">01:26:24.960</a></span> | <span class="t">What it showed is that as the sentence length got bigger, the standard approach which we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5196" target="_blank">01:26:36.080</a></span> | <span class="t">talking about, the standard encoder or decoder approach, the accuracy absolutely died.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5203" target="_blank">01:26:43.880</a></span> | <span class="t">So what these researchers did was that they built a new kind of RNN model, called an attentional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5210" target="_blank">01:26:50.600</a></span> | <span class="t">model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5211" target="_blank">01:26:51.960</a></span> | <span class="t">And with the attentional model, the accuracy actually stayed pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5219" target="_blank">01:26:59.080</a></span> | <span class="t">So goal number 1 for the next couple of lessons is for me not to have a cold anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5228" target="_blank">01:27:08.720</a></span> | <span class="t">So basically we're going to finish our deep dive into neural translation, and then we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5235" target="_blank">01:27:15.440</a></span> | <span class="t">going to look at time series.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5236" target="_blank">01:27:16.440</a></span> | <span class="t">Although we're not specifically looking at time series, it turns out that the best way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5240" target="_blank">01:27:20.080</a></span> | <span class="t">that I found for time series is not specific to time series at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5250" target="_blank">01:27:30.440</a></span> | <span class="t">Reinforcement learning was something I was planning to cover, but I just haven't found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5258" target="_blank">01:27:38.040</a></span> | <span class="t">almost any good examples of it actually being used in practice to solve important real problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5264" target="_blank">01:27:44.720</a></span> | <span class="t">And indeed, when you look at the -- have you guys seen the paper in the last week or two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5270" target="_blank">01:27:50.720</a></span> | <span class="t">about using evolutionary strategies for reinforcement learning?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5274" target="_blank">01:27:54.600</a></span> | <span class="t">Basically it turns out that using random search is better than reinforcement learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5283" target="_blank">01:28:03.120</a></span> | <span class="t">This paper, by the way, is ridiculously overhyped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5285" target="_blank">01:28:05.960</a></span> | <span class="t">These evolutionary strategies is something that I was working on over 20 years ago, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5292" target="_blank">01:28:12.760</a></span> | <span class="t">in those days, these are genetic algorithms, as we called them, used much more sophisticated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5298" target="_blank">01:28:18.600</a></span> | <span class="t">methods than DeepMind's brand new evolutionary strategies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5302" target="_blank">01:28:22.680</a></span> | <span class="t">So people are like rediscovering these randomized metaheuristics, which is great, but they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5308" target="_blank">01:28:28.800</a></span> | <span class="t">still far behind where they were 20 years ago, but far ahead of reinforcement learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5316" target="_blank">01:28:36.280</a></span> | <span class="t">approaches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5317" target="_blank">01:28:37.280</a></span> | <span class="t">So given I try to teach things which I think are actually going to stand the test of time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5322" target="_blank">01:28:42.680</a></span> | <span class="t">I'm not at all convinced that any current technique for reinforcement learning is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5325" target="_blank">01:28:45.840</a></span> | <span class="t">to stand the test of time, so I don't think we're going to touch that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5330" target="_blank">01:28:50.880</a></span> | <span class="t">Part 3, yeah, I think before that we might have a part 0 where we do practical machine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5341" target="_blank">01:29:01.880</a></span> | <span class="t">learning for coders, talk about decision tree ensembles and training test splits and stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5347" target="_blank">01:29:07.560</a></span> | <span class="t">like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5351" target="_blank">01:29:11.920</a></span> | <span class="t">And then we'll see where we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5354" target="_blank">01:29:14.000</a></span> | <span class="t">I'm sure Rachel and I are not going to stop doing this in a hurry, it's really fun and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5360" target="_blank">01:29:20.160</a></span> | <span class="t">interesting and we're really interested in your ideas about how to keep this going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5367" target="_blank">01:29:27.360</a></span> | <span class="t">By the end of part 2, you guys have put in hundreds of hours, on average maybe 140 hours,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5378" target="_blank">01:29:38.320</a></span> | <span class="t">put together your own box, written blog posts, done hackathons, you're seriously in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5385" target="_blank">01:29:45.200</a></span> | <span class="t">now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5386" target="_blank">01:29:46.200</a></span> | <span class="t">And in fact, I've got to say, this week's kind of been special for me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5391" target="_blank">01:29:51.920</a></span> | <span class="t">This week's been the week where again and again I've spoken to various folks of you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5396" target="_blank">01:29:56.240</a></span> | <span class="t">guys and heard about how many of you have implemented projects at your workplace that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5404" target="_blank">01:30:04.480</a></span> | <span class="t">have worked and are now running and making your business money, or that you've achieved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5410" target="_blank">01:30:10.000</a></span> | <span class="t">the career thing that you've been aiming for, or that you've won yet another GPU at a hackathon,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5417" target="_blank">01:30:17.600</a></span> | <span class="t">or of course the social impact thing where it's like all these transformative and inspirational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5423" target="_blank">01:30:23.080</a></span> | <span class="t">things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5427" target="_blank">01:30:27.120</a></span> | <span class="t">When Rachel and I started this, we had no idea if it was possible to teach people with no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5436" target="_blank">01:30:36.120</a></span> | <span class="t">specific required math background other than high school math, deep learning to the point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5441" target="_blank">01:30:41.040</a></span> | <span class="t">that you could use it to build cool things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5444" target="_blank">01:30:44.260</a></span> | <span class="t">We thought we probably could because I don't have that background and I've been able to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5450" target="_blank">01:30:50.960</a></span> | <span class="t">But I've been kind of playing around with similar things for a couple of decades.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5455" target="_blank">01:30:55.240</a></span> | <span class="t">So it was a bit of an experiment, and this week's been the week that for me it's been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5460" target="_blank">01:31:00.900</a></span> | <span class="t">clear that the experiments worked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5462" target="_blank">01:31:02.560</a></span> | <span class="t">So I don't know what part 3 is going to look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5466" target="_blank">01:31:06.280</a></span> | <span class="t">I think it will be a bit different because it'll be more of a meeting of minds amongst</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5471" target="_blank">01:31:11.840</a></span> | <span class="t">a group of people who are kind of at the same level and thinking about the same kinds of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5475" target="_blank">01:31:15.920</a></span> | <span class="t">things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5476" target="_blank">01:31:16.920</a></span> | <span class="t">So maybe it's more of an ongoing keypad knowledge up-to-date kind of thing, it might be more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5486" target="_blank">01:31:26.440</a></span> | <span class="t">of us teaching each other, I'm not sure, I'm certainly interested to hear your ideas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5496" target="_blank">01:31:36.960</a></span> | <span class="t">We don't normally have two breaks, but I think I need one today and we're covering a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5500" target="_blank">01:31:40.040</a></span> | <span class="t">of territories.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5501" target="_blank">01:31:41.040</a></span> | <span class="t">Why don't we have a short break, let's have a short break and we'll go for the last 20</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5510" target="_blank">01:31:50.740</a></span> | <span class="t">minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5511" target="_blank">01:31:51.740</a></span> | <span class="t">Let's come back at 8.40.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5516" target="_blank">01:31:56.760</a></span> | <span class="t">Okay, thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5523" target="_blank">01:32:03.880</a></span> | <span class="t">So attention models, attention models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5533" target="_blank">01:32:13.440</a></span> | <span class="t">So I actually really like these, I think they're great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5540" target="_blank">01:32:20.520</a></span> | <span class="t">And really the paper that introduced these, it was quite an extraordinary paper that introduced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5548" target="_blank">01:32:28.080</a></span> | <span class="t">both GIUs and attention models at the same time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5551" target="_blank">01:32:31.320</a></span> | <span class="t">I think it might even be before the guy had his PhD if I remember correctly, it was just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5556" target="_blank">01:32:36.480</a></span> | <span class="t">a wonderful paper, very successful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5563" target="_blank">01:32:43.700</a></span> | <span class="t">And the basic idea of an attention model is actually pretty simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5572" target="_blank">01:32:52.120</a></span> | <span class="t">You'll see here, here is our decoder, and here's our embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5593" target="_blank">01:33:13.480</a></span> | <span class="t">And notice here, remember that my getRNN_return_sequences = true is the default, so the decoder now is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5604" target="_blank">01:33:24.280</a></span> | <span class="t">actually spitting out a sequence of states.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5610" target="_blank">01:33:30.200</a></span> | <span class="t">Now the length of that sequence is equal to the number of phonemes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5618" target="_blank">01:33:38.160</a></span> | <span class="t">And we know that there isn't a mapping 1 to 1 of phonemes to letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5623" target="_blank">01:33:43.160</a></span> | <span class="t">So this is kind of interesting to think about how we're going to deal with this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5627" target="_blank">01:33:47.000</a></span> | <span class="t">How are we going to deal with 16 states?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5633" target="_blank">01:33:53.600</a></span> | <span class="t">And the states, because they started with bidirectional, state 1 both represents a combination of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5640" target="_blank">01:34:00.880</a></span> | <span class="t">everything that's come before the first phoneme and everything that's come after.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5644" target="_blank">01:34:04.400</a></span> | <span class="t">State 2 is everything that's come before the second phoneme and everything that's come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5647" target="_blank">01:34:07.680</a></span> | <span class="t">after and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5649" target="_blank">01:34:09.840</a></span> | <span class="t">So the states in a sense are all representing something very similar, but they've got a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5655" target="_blank">01:34:15.440</a></span> | <span class="t">different focus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5657" target="_blank">01:34:17.080</a></span> | <span class="t">Each one of these states represents everything that comes before and everything that comes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5666" target="_blank">01:34:26.700</a></span> | <span class="t">after that point, but with a focus on that phoneme.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5673" target="_blank">01:34:33.160</a></span> | <span class="t">So what we want to do now is create an RNN where the number of inputs to the RNN needs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5687" target="_blank">01:34:47.360</a></span> | <span class="t">to be 15, not 16, because remember the length of the word we're creating is 15.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5694" target="_blank">01:34:54.600</a></span> | <span class="t">So we're going to have 15 output time steps, and at each point we wanted to have the opportunity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5707" target="_blank">01:35:07.800</a></span> | <span class="t">to look at all of these 16 output states, but we're going to go in with the assumption</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5715" target="_blank">01:35:15.760</a></span> | <span class="t">that only some of those 16 are going to be relevant, but we don't know which.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5724" target="_blank">01:35:24.560</a></span> | <span class="t">So what we want to do is basically take each of these 16 states and do a weighted sum,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5735" target="_blank">01:35:35.600</a></span> | <span class="t">sum of weights times encoded states, where these weights somehow represent how important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5751" target="_blank">01:35:51.300</a></span> | <span class="t">is each one of those 16 inputs for calculating this output, and how important are each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5758" target="_blank">01:35:58.000</a></span> | <span class="t">those 16 inputs for calculating this output, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5763" target="_blank">01:36:03.180</a></span> | <span class="t">If we could somehow come up with a set of weights for every single one of those time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5769" target="_blank">01:36:09.080</a></span> | <span class="t">steps, then we can replace the length 16 thing with a single thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5777" target="_blank">01:36:17.000</a></span> | <span class="t">If it turns out that output number 1 only really depends on input number 1 and nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5784" target="_blank">01:36:24.360</a></span> | <span class="t">else, then basically that input, those weights are going to be 1, 0, 0, 0, 0, 0, 0, 0, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5791" target="_blank">01:36:31.700</a></span> | <span class="t">It can learn to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5793" target="_blank">01:36:33.840</a></span> | <span class="t">But if it turns out that output number 1 actually depends on phonemes 1 and 2 equally, then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5805" target="_blank">01:36:45.400</a></span> | <span class="t">it can learn the weights 0.5, 0.5, 0.000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5812" target="_blank">01:36:52.360</a></span> | <span class="t">So in other words, we want some function, wi equals some function that returns the right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5823" target="_blank">01:37:03.000</a></span> | <span class="t">set of weights to tell us which bit of the decoded input to look at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5831" target="_blank">01:37:11.520</a></span> | <span class="t">So it so happens we actually know a good way of learning functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5837" target="_blank">01:37:17.420</a></span> | <span class="t">What if we made the function a neural net?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5841" target="_blank">01:37:21.480</a></span> | <span class="t">And what if we learned it using SGD?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5847" target="_blank">01:37:27.160</a></span> | <span class="t">Why not?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5848" target="_blank">01:37:28.600</a></span> | <span class="t">So here's the paper, "Neural Machine Translation by Jointly Learning to Align and Translate."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5862" target="_blank">01:37:42.720</a></span> | <span class="t">And it's a great paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5866" target="_blank">01:37:46.560</a></span> | <span class="t">It's not the clearest in my opinion in terms of understandability, but let me describe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5872" target="_blank">01:37:52.120</a></span> | <span class="t">some of the main pieces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5876" target="_blank">01:37:56.840</a></span> | <span class="t">So here's the starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5889" target="_blank">01:38:09.280</a></span> | <span class="t">Okay, let's describe how to read this equation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5896" target="_blank">01:38:16.260</a></span> | <span class="t">When you see a probability like this, you can very often think of it as a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5902" target="_blank">01:38:22.840</a></span> | <span class="t">The idea of SGD, basically most of the time when we're using it, is to come up with a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5909" target="_blank">01:38:29.720</a></span> | <span class="t">model where the probabilities that the model creates are as high as possible for the true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5916" target="_blank">01:38:36.080</a></span> | <span class="t">data and as low as possible for the other data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5919" target="_blank">01:38:39.360</a></span> | <span class="t">That's just another way of talking about a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5923" target="_blank">01:38:43.440</a></span> | <span class="t">So very often when you read the papers where we would write a loss function, a paper will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5928" target="_blank">01:38:48.520</a></span> | <span class="t">say a probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5930" target="_blank">01:38:50.720</a></span> | <span class="t">What this here says, earlier on they say that y is basically our outputs, very common for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5936" target="_blank">01:38:56.880</a></span> | <span class="t">y to be an output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5937" target="_blank">01:38:57.880</a></span> | <span class="t">And what this is saying is that the probability of the output at time step i, so at some particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5944" target="_blank">01:39:04.560</a></span> | <span class="t">time step, depends on, so this bar here means depends on all of the previous outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5952" target="_blank">01:39:12.960</a></span> | <span class="t">In other words, in our spelling thing, when we're looking at the fourth letter that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5960" target="_blank">01:39:20.920</a></span> | <span class="t">spelling, it depends on the three letters that we've spelled so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5965" target="_blank">01:39:25.680</a></span> | <span class="t">You can't have it depend on the later letters, that's cheating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5970" target="_blank">01:39:30.600</a></span> | <span class="t">So this is basically a description of the problem, is that we're building something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5974" target="_blank">01:39:34.280</a></span> | <span class="t">which is time-dependent and where the i-th thing that we're creating can only be allowed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5980" target="_blank">01:39:40.360</a></span> | <span class="t">to depend on the previous i-1 things, comma, that basically means and, and it's also allowed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5990" target="_blank">01:39:50.000</a></span> | <span class="t">to depend on, anything in bold is a vector, a vector of inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=5996" target="_blank">01:39:56.880</a></span> | <span class="t">And so this here is our list of phonemes, and this here is our list of all of the letters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6005" target="_blank">01:40:05.160</a></span> | <span class="t">we've spelled so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6008" target="_blank">01:40:08.360</a></span> | <span class="t">So that whole thing, that whole probability, we're going to calculate using some function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6021" target="_blank">01:40:21.680</a></span> | <span class="t">And because this is a neural net paper, you can be pretty sure that it's going to turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6024" target="_blank">01:40:24.400</a></span> | <span class="t">out to be a neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6027" target="_blank">01:40:27.000</a></span> | <span class="t">And what are the things that we're allowed to calculate with?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6030" target="_blank">01:40:30.440</a></span> | <span class="t">Well we're allowed to calculate with the previous letter that we just translated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6038" target="_blank">01:40:38.600</a></span> | <span class="t">What's this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6041" target="_blank">01:40:41.200</a></span> | <span class="t">The RNN hidden state that we've built up so far, and what's this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6049" target="_blank">01:40:49.320</a></span> | <span class="t">A context vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6052" target="_blank">01:40:52.080</a></span> | <span class="t">What is a context vector?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6054" target="_blank">01:40:54.080</a></span> | <span class="t">The context vector is a weighted sum of annotations h.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6063" target="_blank">01:41:03.920</a></span> | <span class="t">So these are the hidden states that come out of our encoder, and these are some weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6072" target="_blank">01:41:12.680</a></span> | <span class="t">So I'm trying to give you enough information to try and parse this paper over the week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6078" target="_blank">01:41:18.120</a></span> | <span class="t">So that's everything I've described so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6082" target="_blank">01:41:22.920</a></span> | <span class="t">The nice thing is that hopefully you guys have now read enough papers that you can look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6089" target="_blank">01:41:29.960</a></span> | <span class="t">at something like this and skip over it, and go, oh, that's just softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6096" target="_blank">01:41:36.840</a></span> | <span class="t">Over time, your pattern recognition starts getting good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6102" target="_blank">01:41:42.160</a></span> | <span class="t">You start seeing something like this, and you go, oh, that's a weighted sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6105" target="_blank">01:41:45.000</a></span> | <span class="t">And you say something like this, and you go, oh, that's softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6108" target="_blank">01:41:48.600</a></span> | <span class="t">People who read papers don't actually read every symbol.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6112" target="_blank">01:41:52.840</a></span> | <span class="t">Their eye looks at it and goes, softmax, weighted sum, logistic function, got it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6119" target="_blank">01:41:59.560</a></span> | <span class="t">As if it was like pieces of code, only this is really annoying code that you can't look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6124" target="_blank">01:42:04.480</a></span> | <span class="t">up in a dictionary and you can't run and you can't check it and you can't debug it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6127" target="_blank">01:42:07.600</a></span> | <span class="t">But apart from that, it's just like code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6132" target="_blank">01:42:12.120</a></span> | <span class="t">So the alphas are things that came out of a softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6135" target="_blank">01:42:15.920</a></span> | <span class="t">What goes into the softmax?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6138" target="_blank">01:42:18.860</a></span> | <span class="t">Something called E. The other annoying thing about math notation is often you introduce</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6143" target="_blank">01:42:23.280</a></span> | <span class="t">something and define it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6146" target="_blank">01:42:26.080</a></span> | <span class="t">So here we are, later we define E. What's E equal to?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6150" target="_blank">01:42:30.800</a></span> | <span class="t">E is equal to some function of what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6155" target="_blank">01:42:35.720</a></span> | <span class="t">Some function of the previous hidden state and the encoder state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6168" target="_blank">01:42:48.580</a></span> | <span class="t">And what's that function?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6170" target="_blank">01:42:50.520</a></span> | <span class="t">That function is again a neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6177" target="_blank">01:42:57.420</a></span> | <span class="t">Now the important piece here is jointly trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6182" target="_blank">01:43:02.440</a></span> | <span class="t">Jointly trained means it's not like a GAN where we train a bit of discriminator and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6187" target="_blank">01:43:07.080</a></span> | <span class="t">a bit of generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6188" target="_blank">01:43:08.560</a></span> | <span class="t">It's not like one of these manual attentional models where we first of all figure out the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6194" target="_blank">01:43:14.040</a></span> | <span class="t">nodules are here and then we zoom into them and find them there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6198" target="_blank">01:43:18.120</a></span> | <span class="t">Jointly trained means we create a single model, a single computation graph if you like, where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6202" target="_blank">01:43:22.920</a></span> | <span class="t">the gradients are going to flow through everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6206" target="_blank">01:43:26.220</a></span> | <span class="t">So we have to try and come up with a way basically where we're going to build a standard regular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6211" target="_blank">01:43:31.520</a></span> | <span class="t">RNN, but the RNN is going to use as the input at each time step this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6223" target="_blank">01:43:43.800</a></span> | <span class="t">So we're going to have to come up with a way of actually making this mini-neuronet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6232" target="_blank">01:43:52.040</a></span> | <span class="t">This is just a single one-hidden layer standard neural net that's going to be inside every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6238" target="_blank">01:43:58.540</a></span> | <span class="t">time step in our RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6247" target="_blank">01:44:07.640</a></span> | <span class="t">This whole thing is summarized in another paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6256" target="_blank">01:44:16.200</a></span> | <span class="t">This is actually a really cool paper, Grammar as a Foreign Language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6262" target="_blank">01:44:22.960</a></span> | <span class="t">Lots of names you probably recognize here, Jeffrey Hinton, who's kind of a father of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6269" target="_blank">01:44:29.440</a></span> | <span class="t">deep learning, Julia, who's now I think chief scientist or something at OpenAI, this paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6280" target="_blank">01:44:40.760</a></span> | <span class="t">is kind of neat and fun anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6283" target="_blank">01:44:43.080</a></span> | <span class="t">It basically says what if you didn't know anything about grammar and you attempted to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6289" target="_blank">01:44:49.760</a></span> | <span class="t">build a neural net which assigned grammar to sentences, it turns out you actually end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6297" target="_blank">01:44:57.400</a></span> | <span class="t">up with something more accurate than any rule-based grammar system that's been built.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6304" target="_blank">01:45:04.040</a></span> | <span class="t">One of the nice things they do is to summarize all the bits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6308" target="_blank">01:45:08.920</a></span> | <span class="t">And again, this is where like if you were reading a paper the first time and didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6313" target="_blank">01:45:13.440</a></span> | <span class="t">know what an LSTM was and went oh, an LSTM is all these things, that's not going to mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6318" target="_blank">01:45:18.760</a></span> | <span class="t">anything to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6319" target="_blank">01:45:19.760</a></span> | <span class="t">You have to recognize that people write stuff in papers, there's no point writing LSTM equations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6327" target="_blank">01:45:27.320</a></span> | <span class="t">in papers, but basically you're going to have to go and find the LSTM paper or find a tutorial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6332" target="_blank">01:45:32.640</a></span> | <span class="t">like learn about LSTMs when you're finished, come back, and the same way they summarize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6339" target="_blank">01:45:39.520</a></span> | <span class="t">attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6341" target="_blank">01:45:41.080</a></span> | <span class="t">So they say we've adapted the attention model from 2, if you go and have a look at 2, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6347" target="_blank">01:45:47.560</a></span> | <span class="t">the paper we just looked at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6351" target="_blank">01:45:51.000</a></span> | <span class="t">But the nice thing is that because this came a little later, they've done a pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6355" target="_blank">01:45:55.360</a></span> | <span class="t">job of trying to summarize it into a single page.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6359" target="_blank">01:45:59.080</a></span> | <span class="t">So during the week if you want to try and get the hang of attention, you might find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6363" target="_blank">01:46:03.160</a></span> | <span class="t">it good to have a look at this paper and look at their summary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6368" target="_blank">01:46:08.000</a></span> | <span class="t">And you'll see that basically the idea is that it's a standard sequence to sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6374" target="_blank">01:46:14.880</a></span> | <span class="t">model, so a standard sequence to sequence model means encoder, hidden states, the final</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6380" target="_blank">01:46:20.240</a></span> | <span class="t">hidden state decoder, plus adding attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6387" target="_blank">01:46:27.240</a></span> | <span class="t">And so we have two separate LSTMs, an encoder and a decoder, and now be careful of the notation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6396" target="_blank">01:46:36.520</a></span> | <span class="t">the encoder states are going to be called H. The decoder states H1 through HTA, the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6405" target="_blank">01:46:45.920</a></span> | <span class="t">states D, which we're also going to call HTA+1 to TA+TB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6414" target="_blank">01:46:54.280</a></span> | <span class="t">So the inputs are 1 through TA, and here you can see is defining a single layer neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6423" target="_blank">01:47:03.120</a></span> | <span class="t">net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6426" target="_blank">01:47:06.640</a></span> | <span class="t">So we've got our decoder states, we've got our current encoder state, put it through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6439" target="_blank">01:47:19.120</a></span> | <span class="t">a nonlinearity, put it through another affine transformation, stick it through a softmax,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6446" target="_blank">01:47:26.960</a></span> | <span class="t">and use that to create a weighted sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6449" target="_blank">01:47:29.660</a></span> | <span class="t">So there's like all of it in one little snapshot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6454" target="_blank">01:47:34.400</a></span> | <span class="t">So don't expect this to make perfect sense the first time you see it necessarily, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6460" target="_blank">01:47:40.840</a></span> | <span class="t">hopefully you can kind of see that these bits are all stuff you've seen lots of times before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6467" target="_blank">01:47:47.360</a></span> | <span class="t">So next week we're going to come back and work through creating this code and seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6475" target="_blank">01:47:55.320</a></span> | <span class="t">how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6476" target="_blank">01:47:56.320</a></span> | <span class="t">Did you have something Rachel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6477" target="_blank">01:47:57.320</a></span> | <span class="t">We have two questions, one is, won't the weightings be heavily impacted by the padding done to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6484" target="_blank">01:48:04.000</a></span> | <span class="t">the input set?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6485" target="_blank">01:48:05.760</a></span> | <span class="t">Sure, absolutely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6487" target="_blank">01:48:07.920</a></span> | <span class="t">And specifically those weights will say the padding is always weighted zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6492" target="_blank">01:48:12.800</a></span> | <span class="t">It's not going to take very long to learn to create that pattern.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6497" target="_blank">01:48:17.360</a></span> | <span class="t">And is A shared among all ij pairs, or do we train a separate alignment for each pair?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6503" target="_blank">01:48:23.240</a></span> | <span class="t">No, A is not trained, A is the output of a softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6511" target="_blank">01:48:31.160</a></span> | <span class="t">What's trained is w1 and w2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6514" target="_blank">01:48:34.560</a></span> | <span class="t">And note that capital letters are matrices, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6517" target="_blank">01:48:37.320</a></span> | <span class="t">So we just have to learn a single w1 and a single w2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6521" target="_blank">01:48:41.960</a></span> | <span class="t">But note that they're being applied to all of the encoded states and the current state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6536" target="_blank">01:48:56.400</a></span> | <span class="t">of the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6538" target="_blank">01:48:58.760</a></span> | <span class="t">And in fact, easier is to just abstract out this all the way back to say it is some function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6551" target="_blank">01:49:11.800</a></span> | <span class="t">This is the best way to think of it, it's some function of what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6555" target="_blank">01:49:15.240</a></span> | <span class="t">Some function of the current hidden state and all of the decoder states.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6566" target="_blank">01:49:26.960</a></span> | <span class="t">So that's the inputs to the function, and we just have to learn a set of weights that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6572" target="_blank">01:49:32.440</a></span> | <span class="t">will spit out the inputs to our softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6575" target="_blank">01:49:35.800</a></span> | <span class="t">Did you say you had another question?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6583" target="_blank">01:49:43.560</a></span> | <span class="t">Okay great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6584" target="_blank">01:49:44.560</a></span> | <span class="t">So I don't feel like I want to introduce something new so let's take one final AMA before we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6588" target="_blank">01:49:48.680</a></span> | <span class="t">go home.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6591" target="_blank">01:49:51.720</a></span> | <span class="t">There's not really that much clever you can do about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6610" target="_blank">01:50:10.160</a></span> | <span class="t">Basically if you've got, well a great example would be one of the impact talks talked about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6619" target="_blank">01:50:19.040</a></span> | <span class="t">breast cancer detection from mammography scans and this thing called the Dream Challenge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6626" target="_blank">01:50:26.880</a></span> | <span class="t">had less than 0.3% of the scans actually had cancer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6638" target="_blank">01:50:38.540</a></span> | <span class="t">So that's very unbalanced.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6640" target="_blank">01:50:40.200</a></span> | <span class="t">I think the first thing you try to do with such an unbalanced dataset is ignore it and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6645" target="_blank">01:50:45.000</a></span> | <span class="t">try it and see how it goes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6647" target="_blank">01:50:47.800</a></span> | <span class="t">The reason that often it doesn't go well is that the initial gradients will tend to point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6653" target="_blank">01:50:53.760</a></span> | <span class="t">to say they never have cancer, because that's going to give you a very accurate model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6660" target="_blank">01:51:00.200</a></span> | <span class="t">So one thing you can try and do is to come up with some kind of initial model which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6666" target="_blank">01:51:06.760</a></span> | <span class="t">like maybe some kind of heuristic which is not terrible and gets it to the point where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6671" target="_blank">01:51:11.400</a></span> | <span class="t">the gradients don't always point to saying they never have cancer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6679" target="_blank">01:51:19.020</a></span> | <span class="t">But the really obvious thing to do is to adjust your thing which is creating the mini batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6684" target="_blank">01:51:24.960</a></span> | <span class="t">so that on every mini batch you grab like half of it as being people with cancer and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6691" target="_blank">01:51:31.120</a></span> | <span class="t">half of it being without cancer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6694" target="_blank">01:51:34.560</a></span> | <span class="t">So that way you can still go through lots and lots of epochs, the challenge is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6702" target="_blank">01:51:42.600</a></span> | <span class="t">the people that do have cancer, you're going to see lots and lots and lots of times so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6706" target="_blank">01:51:46.720</a></span> | <span class="t">you have to be very careful of overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6712" target="_blank">01:51:52.440</a></span> | <span class="t">And then basically there's kind of things between those two extremes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6717" target="_blank">01:51:57.240</a></span> | <span class="t">So I think what you really need to do is figure out what's the smallest number of people with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6723" target="_blank">01:52:03.620</a></span> | <span class="t">cancer that you can get away with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6725" target="_blank">01:52:05.560</a></span> | <span class="t">What's the smallest number where the gradients don't point to zero?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6730" target="_blank">01:52:10.440</a></span> | <span class="t">And then create a model where every batch, mini batch, you create 10% of it with people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6737" target="_blank">01:52:17.640</a></span> | <span class="t">with cancer and 90% people without.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6740" target="_blank">01:52:20.520</a></span> | <span class="t">Train that for a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6742" target="_blank">01:52:22.680</a></span> | <span class="t">The good news is once it's working pretty well, you can then decrease the size that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6751" target="_blank">01:52:31.080</a></span> | <span class="t">has cancer size because you're already at a point where your model is not pointing off</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6755" target="_blank">01:52:35.680</a></span> | <span class="t">to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6756" target="_blank">01:52:36.680</a></span> | <span class="t">So you can gradually start to change the sample to have less and less.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6762" target="_blank">01:52:42.520</a></span> | <span class="t">I think that's the basic technique.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6765" target="_blank">01:52:45.080</a></span> | <span class="t">So in this example where you're repeating the positive results over and over again, you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6785" target="_blank">01:53:05.800</a></span> | <span class="t">essentially just weighting them more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6786" target="_blank">01:53:06.800</a></span> | <span class="t">Could you get the same results by just throwing away a bunch of the false data set?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6787" target="_blank">01:53:07.800</a></span> | <span class="t">You could do that, and that's the really quick way to do it, but that way you're not using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6793" target="_blank">01:53:13.320</a></span> | <span class="t">all the information about the false stuff still has information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6797" target="_blank">01:53:17.000</a></span> | <span class="t">So yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6798" target="_blank">01:53:18.000</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6799" target="_blank">01:53:19.000</a></span> | <span class="t">Thanks everybody.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6800" target="_blank">01:53:20.000</a></span> | <span class="t">Have a good week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6801" target="_blank">01:53:21.000</a></span> | <span class="t">[Applause]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=jy1w0mPCHb0&t=6801" target="_blank">01:53:21.000</a></span> | <span class="t">(audience applauds)</span></div></div></body></html>