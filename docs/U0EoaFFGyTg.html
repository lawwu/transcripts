<html><head><title>Streamlit for ML #2 - ML Models and APIs</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Streamlit for ML #2 - ML Models and APIs</h2><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg"><img src="https://i.ytimg.com/vi/U0EoaFFGyTg/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=47">0:47</a> Creating the Vector DB<br><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=536">8:56</a> Implementing Retrieval<br><br><div style="text-align: left;"><a href="./U0EoaFFGyTg.html">Whisper Transcript</a> | <a href="./transcript_U0EoaFFGyTg.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Okay in the last video we had a look at how to build what you can see on the screen right now a very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=6" target="_blank">00:00:06.720</a></span> | <span class="t">simple sort of interface using streamlet now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=10" target="_blank">00:00:10.680</a></span> | <span class="t">What we want to do in this video is go through how we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=15" target="_blank">00:00:15.520</a></span> | <span class="t">build the smart part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=18" target="_blank">00:00:18.640</a></span> | <span class="t">behind the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=21" target="_blank">00:00:21.400</a></span> | <span class="t">Open domain Q&A system that we're going to put together here. So I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=27" target="_blank">00:00:27.800</a></span> | <span class="t">Said before there are a few components to open the main Q&A. We're going to stick the first two for now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=33" target="_blank">00:00:33.120</a></span> | <span class="t">so the vector database, which we're going to use pinecone for and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=36" target="_blank">00:00:36.960</a></span> | <span class="t">The retriever model which we are going to download</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=40" target="_blank">00:00:40.640</a></span> | <span class="t">From hugging face model hub and we're going to use the sentence transformers library to actually implement that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=46" target="_blank">00:00:46.920</a></span> | <span class="t">now the first thing we are going to want to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=51" target="_blank">00:00:51.000</a></span> | <span class="t">Create our vector database or our index now to do that. There are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=57" target="_blank">00:00:57.640</a></span> | <span class="t">three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=59" target="_blank">00:00:59.120</a></span> | <span class="t">Parts or three steps we need to take first. We need to download our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=63" target="_blank">00:01:03.160</a></span> | <span class="t">We're going to be using the squad data set from hugging face data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=67" target="_blank">00:01:07.720</a></span> | <span class="t">Then we want to encode those vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=70" target="_blank">00:01:10.840</a></span> | <span class="t">encode those paragraphs or what we call context into context vectors and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=76" target="_blank">00:01:16.420</a></span> | <span class="t">We use sentence transformers and a retriever model for that. And then the next part is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=83" target="_blank">00:01:23.080</a></span> | <span class="t">uploading or pushing all of those vectors into our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=87" target="_blank">00:01:27.720</a></span> | <span class="t">pinecone vector database</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=89" target="_blank">00:01:29.720</a></span> | <span class="t">so to do all of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=92" target="_blank">00:01:32.440</a></span> | <span class="t">We're just going to very quickly go through that code because it is a lot and I don't want to focus on it too much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=99" target="_blank">00:01:39.680</a></span> | <span class="t">So here we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=107" target="_blank">00:01:47.240</a></span> | <span class="t">Script I'm going to maybe zoom out a little bit so you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=111" target="_blank">00:01:51.960</a></span> | <span class="t">So the first thing we do is import everything you don't need tqdm here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=117" target="_blank">00:01:57.260</a></span> | <span class="t">But you can pip install tqdm if you do want to use that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=119" target="_blank">00:01:59.960</a></span> | <span class="t">So we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=123" target="_blank">00:02:03.520</a></span> | <span class="t">From data sets. So this is hugging face data sets. You will need to install this. So that is just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=129" target="_blank">00:02:09.840</a></span> | <span class="t">pip install</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=132" target="_blank">00:02:12.520</a></span> | <span class="t">data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=135" target="_blank">00:02:15.280</a></span> | <span class="t">We're going to first initialize our retriever model, so we're using the pinecone MP net retrievers or to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=142" target="_blank">00:02:22.280</a></span> | <span class="t">Retrieve model. So this is a retriever model that is based on the MP net model from Microsoft</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=150" target="_blank">00:02:30.040</a></span> | <span class="t">and it's been trained on the spot to data set and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=153" target="_blank">00:02:33.080</a></span> | <span class="t">First we need to do is initialize our connection to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=158" target="_blank">00:02:38.500</a></span> | <span class="t">Pinecone. So this is where we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=161" target="_blank">00:02:41.840</a></span> | <span class="t">Store all of our vectors now to do that. You do need an API key</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=166" target="_blank">00:02:46.320</a></span> | <span class="t">So I wouldn't I wouldn't write it in your code, but I'm going to just do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=171" target="_blank">00:02:51.900</a></span> | <span class="t">For the sake of simplicity here. So I'm going to go to this app dot pinecone dio and this is free</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=178" target="_blank">00:02:58.400</a></span> | <span class="t">By the way, you don't have to pay anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=180" target="_blank">00:03:00.400</a></span> | <span class="t">so we just go to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=182" target="_blank">00:03:02.760</a></span> | <span class="t">app dot pinecone dio</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=185" target="_blank">00:03:05.840</a></span> | <span class="t">And then you will have to sign up. So you create an account</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=189" target="_blank">00:03:09.040</a></span> | <span class="t">I already have one so I don't need to worry about that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=192" target="_blank">00:03:12.800</a></span> | <span class="t">I have this default API key over here. Like I could use that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=199" target="_blank">00:03:19.000</a></span> | <span class="t">Yeah, I'm just going to use that so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=201" target="_blank">00:03:21.880</a></span> | <span class="t">We can see the key if we want. I want to zoom in a little bit. I'll Chris it's a little bit bigger and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=208" target="_blank">00:03:28.360</a></span> | <span class="t">So we can see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=211" target="_blank">00:03:31.720</a></span> | <span class="t">and we can see the value though, we just copy or we just press over here and copy that across and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=218" target="_blank">00:03:38.640</a></span> | <span class="t">Then I'm just going to paste in here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=220" target="_blank">00:03:40.800</a></span> | <span class="t">Okay. Now this script by the way, I will leave a link to this in the description</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=227" target="_blank">00:03:47.560</a></span> | <span class="t">So you can just download it instead of writing it all out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=229" target="_blank">00:03:49.800</a></span> | <span class="t">Because this isn't essential to our app. It's just how we build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=234" target="_blank">00:03:54.280</a></span> | <span class="t">we encode all of our context and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=237" target="_blank">00:03:57.720</a></span> | <span class="t">actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=240" target="_blank">00:04:00.520</a></span> | <span class="t">Saw them in our in our vector database</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=243" target="_blank">00:04:03.080</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=246" target="_blank">00:04:06.400</a></span> | <span class="t">We have that we have the cloud environment that we're using there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=249" target="_blank">00:04:09.840</a></span> | <span class="t">Switch this back to the app</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=253" target="_blank">00:04:13.080</a></span> | <span class="t">We want to check if the index already exists, so I'm going to create a secure index now actually you can see in mind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=260" target="_blank">00:04:20.600</a></span> | <span class="t">I already have it because I've run this code already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=263" target="_blank">00:04:23.480</a></span> | <span class="t">so QA index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=266" target="_blank">00:04:26.120</a></span> | <span class="t">Already exists, so it's not going to create a new index and instead it's just going to connect that index here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=273" target="_blank">00:04:33.520</a></span> | <span class="t">right, so we've just connected with or we created our index our vector database index and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=280" target="_blank">00:04:40.200</a></span> | <span class="t">Now what I want to do is I'm going to switch back to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=284" target="_blank">00:04:44.960</a></span> | <span class="t">Data, and I'm going to run through that. So I'm going to load the data search and the squad data set from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=293" target="_blank">00:04:53.440</a></span> | <span class="t">Hugging face</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=296" target="_blank">00:04:56.440</a></span> | <span class="t">Now the I'm going to use a validation split because the model has been trained on the training data, but squad</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=303" target="_blank">00:05:03.400</a></span> | <span class="t">I want to make it at least a little bit hard, so we're going to use a validation split that it hasn't seen before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=309" target="_blank">00:05:09.160</a></span> | <span class="t">I'm removing any unique</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=312" target="_blank">00:05:12.080</a></span> | <span class="t">or duplicate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=314" target="_blank">00:05:14.760</a></span> | <span class="t">contexts in there, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=316" target="_blank">00:05:16.760</a></span> | <span class="t">Zoom out a little bit here and squad death. We're using this filter, so this is all hugging face data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=324" target="_blank">00:05:24.160</a></span> | <span class="t">syntax here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=327" target="_blank">00:05:27.040</a></span> | <span class="t">And then we're encoding it so this model don't encode so this is our sentence transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=332" target="_blank">00:05:32.080</a></span> | <span class="t">We're encoding it to create a load of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=334" target="_blank">00:05:34.080</a></span> | <span class="t">Sentence vectors for our context and we're converting these to list because we are going to be pushing these through an API request</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=342" target="_blank">00:05:42.560</a></span> | <span class="t">To pinecone game. We need a list not a numpy array of what you can get going to get an error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=348" target="_blank">00:05:48.360</a></span> | <span class="t">Okay, then back to the pinecone side of things. We want to create a list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=358" target="_blank">00:05:58.280</a></span> | <span class="t">It's basically a list of tuples and those tuples include the ID of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=363" target="_blank">00:06:03.160</a></span> | <span class="t">Each context so there's a unique ID for each context. We want the vector or the encoding the context vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=371" target="_blank">00:06:11.560</a></span> | <span class="t">And then we also have this dictionary here now. This is metadata so metadata and pinecone is like any other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=378" target="_blank">00:06:18.800</a></span> | <span class="t">Information about your vectors that you want to include and this is really good if you want to use metadata filtering which is super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=386" target="_blank">00:06:26.520</a></span> | <span class="t">powerful in pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=388" target="_blank">00:06:28.520</a></span> | <span class="t">Sand I definitely want to you know leave the option open later on. I'm not sure if we'll use it or not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=395" target="_blank">00:06:35.060</a></span> | <span class="t">We'll probably put something in there. Just so we can play around with it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=399" target="_blank">00:06:39.040</a></span> | <span class="t">now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=401" target="_blank">00:06:41.560</a></span> | <span class="t">That creates the format that we need to upset everything which means just like push or upload everything to pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=407" target="_blank">00:06:47.840</a></span> | <span class="t">So then I do that in chunks of 50 at a time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=412" target="_blank">00:06:52.280</a></span> | <span class="t">It just makes things a little bit easier on the on the API request rather than sending everything at once. Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=419" target="_blank">00:06:59.480</a></span> | <span class="t">So that's like how we create the index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=422" target="_blank">00:07:02.880</a></span> | <span class="t">so now what we're going to do is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=425" target="_blank">00:07:05.800</a></span> | <span class="t">Integrate that a little bit in in our app</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=431" target="_blank">00:07:11.480</a></span> | <span class="t">So let's switch back to our app here. Let's view it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=437" target="_blank">00:07:17.560</a></span> | <span class="t">So first, let's just remove this. We don't need that. Okay, it's a will automatically reload</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=443" target="_blank">00:07:23.680</a></span> | <span class="t">So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=446" target="_blank">00:07:26.720</a></span> | <span class="t">First we want to do here is let's initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=449" target="_blank">00:07:29.720</a></span> | <span class="t">the pinecone connection, so I'm going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=453" target="_blank">00:07:33.560</a></span> | <span class="t">just take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=456" target="_blank">00:07:36.680</a></span> | <span class="t">Let's just take this part of the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=459" target="_blank">00:07:39.400</a></span> | <span class="t">Just copy it and then we'll remove what we don't need in a minute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=464" target="_blank">00:07:44.000</a></span> | <span class="t">So we don't need we do need sentence transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=467" target="_blank">00:07:47.800</a></span> | <span class="t">In a minute, we don't need datasets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=471" target="_blank">00:07:51.080</a></span> | <span class="t">We do need pinecone. So actually here. We're initializing our our retriever model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=478" target="_blank">00:07:58.240</a></span> | <span class="t">It's the same as what we did before. So we do want to keep that in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=481" target="_blank">00:08:01.480</a></span> | <span class="t">and a bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=484" target="_blank">00:08:04.120</a></span> | <span class="t">API key again just saw this somewhere else or if you are using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=489" target="_blank">00:08:09.840</a></span> | <span class="t">Streamlit cloud they have like a secrets management</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=493" target="_blank">00:08:13.760</a></span> | <span class="t">System and it's something we'll look at in the future for sure. But for now, I'm just putting in here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=499" target="_blank">00:08:19.440</a></span> | <span class="t">So we have our API key environment and we're just doing the same thing we did before but actually we don't want to create an index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=508" target="_blank">00:08:28.240</a></span> | <span class="t">We're assuming we've already created an index if web in our app, so we're just going to connect to it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=512" target="_blank">00:08:32.600</a></span> | <span class="t">okay, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=515" target="_blank">00:08:35.120</a></span> | <span class="t">with that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=517" target="_blank">00:08:37.120</a></span> | <span class="t">kind of set up the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=519" target="_blank">00:08:39.200</a></span> | <span class="t">Like the back end part of our app. I've smart part that's going to handle the open the main Q&A</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=524" target="_blank">00:08:44.960</a></span> | <span class="t">But it's going to be a little bit slow and we we will have a look at how to solve that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=530" target="_blank">00:08:50.720</a></span> | <span class="t">pretty soon, but for now, what we're going to do is actually just implement this and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=536" target="_blank">00:08:56.480</a></span> | <span class="t">We're going to actually query and see what we we return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=541" target="_blank">00:09:01.600</a></span> | <span class="t">So I'm gonna save this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=544" target="_blank">00:09:04.360</a></span> | <span class="t">we won't see anything change in our app now other than the fact that it takes longer to load because it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=549" target="_blank">00:09:09.400</a></span> | <span class="t">downloading the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=552" target="_blank">00:09:12.120</a></span> | <span class="t">the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=553" target="_blank">00:09:13.480</a></span> | <span class="t">retriever model that's the main part of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=555" target="_blank">00:09:15.880</a></span> | <span class="t">The slowness here and then obviously connecting to pinecone also take takes a second as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=561" target="_blank">00:09:21.280</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=564" target="_blank">00:09:24.080</a></span> | <span class="t">Now we're going to deal with how slow it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=566" target="_blank">00:09:26.120</a></span> | <span class="t">But we will we will fix that pretty soon and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=571" target="_blank">00:09:31.440</a></span> | <span class="t">Now I actually want to do is I want to say okay if the query is not empty because by default it is empty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=578" target="_blank">00:09:38.680</a></span> | <span class="t">That's why we add that in there. So I'm going to actually remove this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=581" target="_blank">00:09:41.840</a></span> | <span class="t">Enter if it is not empty. So if query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=586" target="_blank">00:09:46.600</a></span> | <span class="t">Is not equal to nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=589" target="_blank">00:09:49.520</a></span> | <span class="t">we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=592" target="_blank">00:09:52.400</a></span> | <span class="t">query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=594" target="_blank">00:09:54.200</a></span> | <span class="t">Pinecone for whatever is in that query. So the first thing we need to do is create our context vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=599" target="_blank">00:09:59.480</a></span> | <span class="t">So I'm gonna write XQ</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=601" target="_blank">00:10:01.480</a></span> | <span class="t">Just shorthand for context vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=603" target="_blank">00:10:03.640</a></span> | <span class="t">It's pretty standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=606" target="_blank">00:10:06.880</a></span> | <span class="t">Especially if you use vice before they tend to use this and I say I said context vector. I mean query vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=613" target="_blank">00:10:13.440</a></span> | <span class="t">So we're going to do model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=616" target="_blank">00:10:16.800</a></span> | <span class="t">encode and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=618" target="_blank">00:10:18.520</a></span> | <span class="t">We need to put this in square brackets and we have query. Okay, and then we're going to convert that to a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=624" target="_blank">00:10:24.280</a></span> | <span class="t">Okay, so this is going to create our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=628" target="_blank">00:10:28.280</a></span> | <span class="t">Query vector. Let's write it down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=630" target="_blank">00:10:30.320</a></span> | <span class="t">create query vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=633" target="_blank">00:10:33.320</a></span> | <span class="t">And then the next thing we want to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=637" target="_blank">00:10:37.040</a></span> | <span class="t">Query pinecone with this query vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=640" target="_blank">00:10:40.360</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=642" target="_blank">00:10:42.320</a></span> | <span class="t">To do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=644" target="_blank">00:10:44.160</a></span> | <span class="t">We want to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=646" target="_blank">00:10:46.160</a></span> | <span class="t">First let's get relevant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=648" target="_blank">00:10:48.760</a></span> | <span class="t">Context and we're going to solve these in XC. So like query like context vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=658" target="_blank">00:10:58.280</a></span> | <span class="t">similar thing to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=660" target="_blank">00:11:00.280</a></span> | <span class="t">Query vector that we use for with XQ</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=663" target="_blank">00:11:03.600</a></span> | <span class="t">But this time we're gonna write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=667" target="_blank">00:11:07.160</a></span> | <span class="t">index dot query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=669" target="_blank">00:11:09.760</a></span> | <span class="t">And we're going to pass XQ. So our query vector and we're gonna say how many results we want to return now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=678" target="_blank">00:11:18.120</a></span> | <span class="t">Later on we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=680" target="_blank">00:11:20.360</a></span> | <span class="t">Streamlet a little like a slider bar to decide how many we would like to return but for now we will hard code it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=687" target="_blank">00:11:27.320</a></span> | <span class="t">and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=688" target="_blank">00:11:28.920</a></span> | <span class="t">another thing that we want to include here is we want to tell pinecone to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=694" target="_blank">00:11:34.200</a></span> | <span class="t">Return the metadata because by default it will not return metadata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=698" target="_blank">00:11:38.640</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=700" target="_blank">00:11:40.480</a></span> | <span class="t">Return metadata equals true. So these are like the extra little bits. I mentioned before so included our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=706" target="_blank">00:11:46.800</a></span> | <span class="t">title so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=709" target="_blank">00:11:49.600</a></span> | <span class="t">Like the topic Wikipedia topic that the context is coming from and also the text itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=716" target="_blank">00:11:56.960</a></span> | <span class="t">okay, so we're going to return the relevant context and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=720" target="_blank">00:12:00.320</a></span> | <span class="t">Then we're gonna loop through each of those now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=724" target="_blank">00:12:04.080</a></span> | <span class="t">When we do this, there's a particular format that we need to follow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=731" target="_blank">00:12:11.600</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=733" target="_blank">00:12:13.960</a></span> | <span class="t">our context are actually going to be sword so for context in XC results and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=744" target="_blank">00:12:24.040</a></span> | <span class="t">Results is going to return a list and we just want the the first item in that list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=749" target="_blank">00:12:29.360</a></span> | <span class="t">The reason it returns a list is because if you are a querying pinecone with multiple queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=754" target="_blank">00:12:34.960</a></span> | <span class="t">It will turn a list of you know, your answers for each query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=760" target="_blank">00:12:40.080</a></span> | <span class="t">But in this case, we are only ever going to query with one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=764" target="_blank">00:12:44.160</a></span> | <span class="t">query vector so we always enter a position zero here and then in there we will have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=772" target="_blank">00:12:52.880</a></span> | <span class="t">all of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=774" target="_blank">00:12:54.800</a></span> | <span class="t">returned matches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=776" target="_blank">00:12:56.640</a></span> | <span class="t">inside this matches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=778" target="_blank">00:12:58.640</a></span> | <span class="t">Key value value so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=782" target="_blank">00:13:02.640</a></span> | <span class="t">For context in there. All we're going to do is write st dot right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=789" target="_blank">00:13:09.160</a></span> | <span class="t">Context and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=792" target="_blank">00:13:12.600</a></span> | <span class="t">then we want to go into the metadata that we were returning and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=795" target="_blank">00:13:15.840</a></span> | <span class="t">We have title and text here. We don't want title we want text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=801" target="_blank">00:13:21.240</a></span> | <span class="t">Okay, so let's say that and check that actually works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=805" target="_blank">00:13:25.200</a></span> | <span class="t">so again, this is going to take a lot while to load because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=808" target="_blank">00:13:28.880</a></span> | <span class="t">Initializing like the full pipeline of our vector database and the true model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=814" target="_blank">00:13:34.800</a></span> | <span class="t">So every time we run this it's downloading the full tree model, which takes quite a bit of time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=819" target="_blank">00:13:39.600</a></span> | <span class="t">Okay, so this is just rerun our app and now I can say who are the Normans?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=826" target="_blank">00:13:46.640</a></span> | <span class="t">Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=830" target="_blank">00:13:50.080</a></span> | <span class="t">Again trying to reload everything so it's gonna take a while. We're going to fix this in the next video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=834" target="_blank">00:13:54.960</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=837" target="_blank">00:13:57.080</a></span> | <span class="t">We should be returning five context and if we scroll down we can see we have these five paragraphs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=842" target="_blank">00:14:02.960</a></span> | <span class="t">Now each one is paragraphs. It's a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=844" target="_blank">00:14:04.960</a></span> | <span class="t">Context so we could maybe we can inspect the element</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=850" target="_blank">00:14:10.880</a></span> | <span class="t">Okay, so we can see down here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=859" target="_blank">00:14:19.040</a></span> | <span class="t">It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=861" target="_blank">00:14:21.040</a></span> | <span class="t">Pretty horrific to look at so if I zoom up we can see each one of these is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=869" target="_blank">00:14:29.160</a></span> | <span class="t">A single a single one of our context, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=874" target="_blank">00:14:34.880</a></span> | <span class="t">These here cool so I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=880" target="_blank">00:14:40.600</a></span> | <span class="t">Think that is that's it for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=885" target="_blank">00:14:45.080</a></span> | <span class="t">Video, so we're now we have these back end working and the next one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=890" target="_blank">00:14:50.960</a></span> | <span class="t">What we'll do is fix this issue with it taking forever to load reload everything every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=896" target="_blank">00:14:56.120</a></span> | <span class="t">Which is actually super easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=898" target="_blank">00:14:58.800</a></span> | <span class="t">But we'll make a big difference to our app</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=903" target="_blank">00:15:03.160</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=U0EoaFFGyTg&t=905" target="_blank">00:15:05.000</a></span> | <span class="t">Thank you very much for watching and I will see you in the next one. Bye</span></div></div></body></html>