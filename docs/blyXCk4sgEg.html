<html><head><title>Intro to Machine Learning: Lesson 2</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Intro to Machine Learning: Lesson 2</h2><a href="https://www.youtube.com/watch?v=blyXCk4sgEg"><img src="https://i.ytimg.com/vi_webp/blyXCk4sgEg/sddefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=45">0:45</a> Fast AI<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=330">5:30</a> Evaluation Metric<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=600">10:0</a> Formulas<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1422">23:42</a> Training vs Validation<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1627">27:7</a> Root Mean Square Error<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1757">29:17</a> Run Time<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1912">31:52</a> Simple Model<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1977">32:57</a> Decision Tree<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2057">34:17</a> Data<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2342">39:2</a> Test all possible splits<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2635">43:55</a> Clarification<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2742">45:42</a> Summary<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2819">46:59</a> Random Forest<br><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3022">50:22</a> Random Forest Regression<br><br><div style="text-align: left;"><a href="./blyXCk4sgEg.html">Whisper Transcript</a> | <a href="./transcript_blyXCk4sgEg.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">So, from here, the next 2 or 3 lessons, we're going to be really diving deep into random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=6" target="_blank">00:00:06.840</a></span> | <span class="t">forests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=7" target="_blank">00:00:07.840</a></span> | <span class="t">So far, all we've learned is there's a thing called random forests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=13" target="_blank">00:00:13.360</a></span> | <span class="t">For some particular datasets, they seem to work really really well without too much trouble.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=19" target="_blank">00:00:19.200</a></span> | <span class="t">But we don't really know yet how do they actually work, what do we do if they don't work properly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=25" target="_blank">00:00:25.520</a></span> | <span class="t">what are their pros and cons, what can we tune, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=29" target="_blank">00:00:29.080</a></span> | <span class="t">So we're going to look at all that, and then after that we're going to look at how do we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=33" target="_blank">00:00:33.160</a></span> | <span class="t">interpret the results of random forests to get not just predictions, but to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=38" target="_blank">00:00:38.040</a></span> | <span class="t">deeply understand our data in a model-driven way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=41" target="_blank">00:00:41.600</a></span> | <span class="t">So that's where we're going to go from here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=45" target="_blank">00:00:45.160</a></span> | <span class="t">So let's just review where we're up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=48" target="_blank">00:00:48.880</a></span> | <span class="t">So we learned that there's this library called FastAI, and the FastAI library is a highly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=57" target="_blank">00:00:57.600</a></span> | <span class="t">opinionated library, which is to say we spend a lot of time researching what are the best</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=64" target="_blank">00:01:04.160</a></span> | <span class="t">techniques to get state-of-the-art results, and then we take those techniques and package</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=69" target="_blank">00:01:09.320</a></span> | <span class="t">them into pieces of code so that you can use the state-of-the-art results yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=75" target="_blank">00:01:15.280</a></span> | <span class="t">And so where possible, we wrap or provide things on top of existing code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=84" target="_blank">00:01:24.960</a></span> | <span class="t">And so in particular for the kind of structured data analysis we're doing, scikit-learn has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=90" target="_blank">00:01:30.160</a></span> | <span class="t">a lot of really great code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=92" target="_blank">00:01:32.020</a></span> | <span class="t">So most of the stuff that we're showing you from FastAI is stuff to help us get stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=96" target="_blank">00:01:36.720</a></span> | <span class="t">into scikit-learn and then interpret stuff out from scikit-learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=103" target="_blank">00:01:43.760</a></span> | <span class="t">The FastAI library, the way it works in our environment here is that our notebooks are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=119" target="_blank">00:01:59.440</a></span> | <span class="t">inside fastai-repo/courses and then /ml1 and dl1, and then inside there, there's a symlink</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=130" target="_blank">00:02:10.020</a></span> | <span class="t">to the parent of the parent FastAI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=134" target="_blank">00:02:14.360</a></span> | <span class="t">So this is a symlink to a directory containing a bunch of modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=142" target="_blank">00:02:22.480</a></span> | <span class="t">So if you want to use the FastAI library in your own code, there's a number of things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=149" target="_blank">00:02:29.040</a></span> | <span class="t">you can do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=150" target="_blank">00:02:30.200</a></span> | <span class="t">One is to put your notebooks or scripts in the same directory as ml1 or dl1, where there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=155" target="_blank">00:02:35.720</a></span> | <span class="t">already the symlink, and just import it just like I do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=159" target="_blank">00:02:39.800</a></span> | <span class="t">You could copy this directory into somewhere else and use it, or you could symlink it just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=170" target="_blank">00:02:50.460</a></span> | <span class="t">like I have from here to wherever you want to use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=174" target="_blank">00:02:54.740</a></span> | <span class="t">So notice it's mildly confusing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=177" target="_blank">00:02:57.240</a></span> | <span class="t">There's a github-repo called fastai, and inside the github-repo called fastai, which looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=183" target="_blank">00:03:03.980</a></span> | <span class="t">like this, there is a folder called fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=188" target="_blank">00:03:08.960</a></span> | <span class="t">So the fastai folder in the fastai-repo contains the fastai library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=195" target="_blank">00:03:15.200</a></span> | <span class="t">And it's that library when we go from fastai.imports import* then that's looking inside the fastai</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=202" target="_blank">00:03:22.800</a></span> | <span class="t">folder for a file called imports.py and importing everything from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=213" target="_blank">00:03:33.800</a></span> | <span class="t">And just as a clarifying question, for the symlink it's just the ln thing that you talked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=231" target="_blank">00:03:51.320</a></span> | <span class="t">about last class?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=232" target="_blank">00:03:52.320</a></span> | <span class="t">Yeah, so a symlink is something you can create by typing ln-s, and then the path to the source,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=240" target="_blank">00:04:00.280</a></span> | <span class="t">which in this case would be dot dot dot dot fastai, could be relative or it could be absolute,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=245" target="_blank">00:04:05.760</a></span> | <span class="t">and then the name of the destination.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=247" target="_blank">00:04:07.480</a></span> | <span class="t">If you just put the current directory at the destination, it'll use the same name as it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=251" target="_blank">00:04:11.640</a></span> | <span class="t">comes from, like an alias on the Mac or a shortcut on Windows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=259" target="_blank">00:04:19.520</a></span> | <span class="t">I don't think I've created the symlink anywhere in the workbooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=288" target="_blank">00:04:48.960</a></span> | <span class="t">The symlink actually lives inside the GitHub repo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=293" target="_blank">00:04:53.800</a></span> | <span class="t">I created some symlinks in the deep learning notebook to some data, that was different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=302" target="_blank">00:05:02.800</a></span> | <span class="t">At the top of Tim Lee's workbook from the last class, there was import sys then append</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=309" target="_blank">00:05:09.440</a></span> | <span class="t">the fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=310" target="_blank">00:05:10.440</a></span> | <span class="t">Oh yeah, don't do that probably.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=313" target="_blank">00:05:13.480</a></span> | <span class="t">You can, but I think this is better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=317" target="_blank">00:05:17.540</a></span> | <span class="t">This way you can go from fastai imports, and regardless of how you got it there, it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=324" target="_blank">00:05:24.120</a></span> | <span class="t">to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=329" target="_blank">00:05:29.480</a></span> | <span class="t">So then we had all of our data for bluebooks to bulldozers competition in data/bulldozers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=336" target="_blank">00:05:36.000</a></span> | <span class="t">and here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=340" target="_blank">00:05:40.360</a></span> | <span class="t">We were able to read that CSV file, the only thing we really had to do was say which columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=346" target="_blank">00:05:46.540</a></span> | <span class="t">were dates, and having done that, we were able to take a look at a few of the examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=352" target="_blank">00:05:52.880</a></span> | <span class="t">of the rows of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=359" target="_blank">00:05:59.280</a></span> | <span class="t">And so we also noted that it's very important to deeply understand the evaluation metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=369" target="_blank">00:06:09.360</a></span> | <span class="t">for this project.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=371" target="_blank">00:06:11.400</a></span> | <span class="t">And so for Kaggle, they tell you what the evaluation metric is, and in this case it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=376" target="_blank">00:06:16.120</a></span> | <span class="t">the root mean squared log error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=381" target="_blank">00:06:21.040</a></span> | <span class="t">So that is the sum of the actuals minus the predictions, but it's the log of the actuals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=401" target="_blank">00:06:41.880</a></span> | <span class="t">minus the log of the predictions squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=410" target="_blank">00:06:50.640</a></span> | <span class="t">So if we replace actuals with log actuals and replace log predictions, then it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=418" target="_blank">00:06:58.800</a></span> | <span class="t">the same as root mean squared error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=423" target="_blank">00:07:03.380</a></span> | <span class="t">So that's what we did, we replaced sale price with log of sale price, and so now if we optimize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=431" target="_blank">00:07:11.120</a></span> | <span class="t">for root mean squared error, we're actually optimizing for the root mean squared error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=436" target="_blank">00:07:16.560</a></span> | <span class="t">of the logs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=440" target="_blank">00:07:20.340</a></span> | <span class="t">So then we learned that we need all of our columns to be numbers, and so the first way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=446" target="_blank">00:07:26.880</a></span> | <span class="t">we did that was to take the date column and remove it, and instead replace it with a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=453" target="_blank">00:07:33.800</a></span> | <span class="t">bunch of different columns, such as is that date the start of a quarter, is it the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=465" target="_blank">00:07:45.880</a></span> | <span class="t">of a year, how many days are elapsed since January 1st, 1970, what's the year, what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=472" target="_blank">00:07:52.200</a></span> | <span class="t">the month, what's the day of week, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=475" target="_blank">00:07:55.320</a></span> | <span class="t">So they're all numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=479" target="_blank">00:07:59.180</a></span> | <span class="t">Then we learned that we can use train_cats to replace all of the strings with categories.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=487" target="_blank">00:08:07.800</a></span> | <span class="t">Now when you do that, it doesn't look like you've done anything different, they still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=492" target="_blank">00:08:12.480</a></span> | <span class="t">look like strings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=495" target="_blank">00:08:15.620</a></span> | <span class="t">But if you actually take a deeper look, you'll see that the data type is not string but category.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=507" target="_blank">00:08:27.180</a></span> | <span class="t">And category is a pandas class where you can then go dot cat dot and find a whole bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=516" target="_blank">00:08:36.000</a></span> | <span class="t">of different attributes, such as cat dot categories to find a list of all of the possible categories,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=522" target="_blank">00:08:42.680</a></span> | <span class="t">and this says high is going to become 0, low will become 1, medium will become 2, so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=527" target="_blank">00:08:47.520</a></span> | <span class="t">can then get codes to actually get the numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=532" target="_blank">00:08:52.640</a></span> | <span class="t">So then what we need to do to actually use this data set to turn it into numbers is take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=538" target="_blank">00:08:58.020</a></span> | <span class="t">every categorical column and replace it with cat dot codes, and so we did that using proc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=548" target="_blank">00:09:08.540</a></span> | <span class="t">df.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=552" target="_blank">00:09:12.200</a></span> | <span class="t">So how do I get the source code for proc df?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=564" target="_blank">00:09:24.100</a></span> | <span class="t">If I scroll down, I go through each column and I numericalize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=573" target="_blank">00:09:33.980</a></span> | <span class="t">That's actually the one I want, so I'm going to now have to look up numericalize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=581" target="_blank">00:09:41.320</a></span> | <span class="t">So tab to complete it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=585" target="_blank">00:09:45.040</a></span> | <span class="t">If it's not numeric, then replace the data frames field with that columns dot cat dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=591" target="_blank">00:09:51.740</a></span> | <span class="t">codes plus 1, because otherwise unknown is -1, we want unknown to be 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=598" target="_blank">00:09:58.200</a></span> | <span class="t">So that's how we turn the strings into numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=604" target="_blank">00:10:04.360</a></span> | <span class="t">They get replaced with a unique basically arbitrary index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=609" target="_blank">00:10:09.000</a></span> | <span class="t">It's actually based on the alphabetical order of the feature names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=614" target="_blank">00:10:14.120</a></span> | <span class="t">The other thing proc df did remember was continuous columns that had missing values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=621" target="_blank">00:10:21.500</a></span> | <span class="t">The missing got replaced with the median, and we added an additional column called column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=626" target="_blank">00:10:26.120</a></span> | <span class="t">name_na, which is a Boolean column, told you if that particular item was missing or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=634" target="_blank">00:10:34.960</a></span> | <span class="t">So once we did that, we were able to call random forest regressor dot fit and get the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=643" target="_blank">00:10:43.620</a></span> | <span class="t">dot score, and it turns out we have an R^2 of 0.98.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=650" target="_blank">00:10:50.920</a></span> | <span class="t">Can anybody tell me what an R^2 is?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=657" target="_blank">00:10:57.240</a></span> | <span class="t">So R^2 essentially shows how much variance is explained by the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=680" target="_blank">00:11:20.080</a></span> | <span class="t">This is the relation of SSR, which is like trying to remember the exact formula.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=695" target="_blank">00:11:35.360</a></span> | <span class="t">I mean roughly intuitively?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=697" target="_blank">00:11:37.800</a></span> | <span class="t">Intuitively, it's how much the model explains how much it accounts for the variance in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=704" target="_blank">00:11:44.800</a></span> | <span class="t">data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=705" target="_blank">00:11:45.800</a></span> | <span class="t">Okay, good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=706" target="_blank">00:11:46.800</a></span> | <span class="t">So let's talk about the formula.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=710" target="_blank">00:11:50.720</a></span> | <span class="t">With formulas, the idea is not to learn the formula and remember it, but to learn what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=715" target="_blank">00:11:55.400</a></span> | <span class="t">the formula does and understand it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=719" target="_blank">00:11:59.780</a></span> | <span class="t">So here's the formula.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=723" target="_blank">00:12:03.360</a></span> | <span class="t">It's 1 minus something divided by something else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=728" target="_blank">00:12:08.340</a></span> | <span class="t">So what's the something else on the bottom?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=731" target="_blank">00:12:11.080</a></span> | <span class="t">SS_tot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=733" target="_blank">00:12:13.400</a></span> | <span class="t">So what this is saying is we've got some actual data, some y_i's, we've got some actual data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=743" target="_blank">00:12:23.080</a></span> | <span class="t">- 3, 2, 4, 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=748" target="_blank">00:12:28.440</a></span> | <span class="t">And then we've got some average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=754" target="_blank">00:12:34.940</a></span> | <span class="t">So our top bit, this SS_tot, is the sum of h of these minus that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=768" target="_blank">00:12:48.020</a></span> | <span class="t">So in other words, it's telling us how much does this data vary, but perhaps more interestingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=774" target="_blank">00:12:54.200</a></span> | <span class="t">is remember when we talked about last week, what's the simplest non-stupid model you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=781" target="_blank">00:13:01.140</a></span> | <span class="t">come up with?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=782" target="_blank">00:13:02.140</a></span> | <span class="t">I think the simplest non-stupid model we came up with was create a column of the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=787" target="_blank">00:13:07.360</a></span> | <span class="t">Just copy the mean a bunch of times and submit that to Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=791" target="_blank">00:13:11.640</a></span> | <span class="t">If you did that, then your root mean squared error would be this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=798" target="_blank">00:13:18.920</a></span> | <span class="t">So this is the root mean squared error of the most naive non-stupid model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=806" target="_blank">00:13:26.640</a></span> | <span class="t">The model is just predict the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=810" target="_blank">00:13:30.620</a></span> | <span class="t">On the top, we have SS_res, which is here, which is that we're now going to add a column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=818" target="_blank">00:13:38.280</a></span> | <span class="t">of predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=830" target="_blank">00:13:50.200</a></span> | <span class="t">And so now what we do is rather than taking the y_i minus y_mean, we're going to take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=836" target="_blank">00:13:56.300</a></span> | <span class="t">y_i minus f_i.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=841" target="_blank">00:14:01.680</a></span> | <span class="t">And so now instead of saying what's the root mean squared error of our naive model, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=846" target="_blank">00:14:06.660</a></span> | <span class="t">saying what's the root mean squared error of the actual model that we're interested</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=849" target="_blank">00:14:09.640</a></span> | <span class="t">in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=851" target="_blank">00:14:11.240</a></span> | <span class="t">And then we take the ratio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=855" target="_blank">00:14:15.660</a></span> | <span class="t">So in other words, if we actually were exactly as effective as just predicting the mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=865" target="_blank">00:14:25.840</a></span> | <span class="t">then this top and bottom would be the same, that would be 1, 1 minus 1 would be 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=873" target="_blank">00:14:33.360</a></span> | <span class="t">If we were perfect, so f_i minus y_i was always 0, then that's 0 divided by something, 1 minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=880" target="_blank">00:14:40.400</a></span> | <span class="t">that is 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=884" target="_blank">00:14:44.080</a></span> | <span class="t">So what is the possible range of values of R^2?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=890" target="_blank">00:14:50.640</a></span> | <span class="t">Okay, I heard a lot of 0 to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=895" target="_blank">00:14:55.200</a></span> | <span class="t">Does anybody want to give me an alternative?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=906" target="_blank">00:15:06.360</a></span> | <span class="t">Anything less than 1, there's the right answer, let's find out why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=924" target="_blank">00:15:24.160</a></span> | <span class="t">So why is any number less than 1?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=926" target="_blank">00:15:26.200</a></span> | <span class="t">Because you can make a model as crap as you want, and you're just subtracting from 1 in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=939" target="_blank">00:15:39.040</a></span> | <span class="t">the formula.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=940" target="_blank">00:15:40.040</a></span> | <span class="t">So interestingly, I was talking to our computer science professor, Terrence, who was talking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=942" target="_blank">00:15:42.220</a></span> | <span class="t">to a statistics professor, who told him that the possible range of values of R^2 was 0 to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=947" target="_blank">00:15:47.840</a></span> | <span class="t">1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=948" target="_blank">00:15:48.840</a></span> | <span class="t">That is totally not true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=950" target="_blank">00:15:50.520</a></span> | <span class="t">If you predict every row, then you're going to have infinity for every residual, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=958" target="_blank">00:15:58.520</a></span> | <span class="t">you're going to have 1 minus infinity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=961" target="_blank">00:16:01.160</a></span> | <span class="t">So the possible range of values is less than 1, that's all we know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=966" target="_blank">00:16:06.360</a></span> | <span class="t">And this will happen, you will get negative values sometimes in your R^2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=970" target="_blank">00:16:10.640</a></span> | <span class="t">And when that happens, it's not a mistake, it's not like a bug, it means your model is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=976" target="_blank">00:16:16.440</a></span> | <span class="t">worse than predicting the mean, which suggests it's not great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=983" target="_blank">00:16:23.000</a></span> | <span class="t">So that's R^2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=989" target="_blank">00:16:29.780</a></span> | <span class="t">It's not necessarily what you're actually trying to optimize, but the nice thing about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=997" target="_blank">00:16:37.520</a></span> | <span class="t">it is that it's a number that you can use for every model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1003" target="_blank">00:16:43.040</a></span> | <span class="t">And so you can kind of start to get a feel of what does 0.8 look like, what does 0.9</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1007" target="_blank">00:16:47.560</a></span> | <span class="t">look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1008" target="_blank">00:16:48.560</a></span> | <span class="t">So something I find interesting is to create some different synthetic data sets, just two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1014" target="_blank">00:16:54.880</a></span> | <span class="t">dimensions, with different amounts of random noise, and see what they look like on a scatter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1020" target="_blank">00:17:00.240</a></span> | <span class="t">plot and see what their R^2 are, just to get a feel for what does an R^2 look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1025" target="_blank">00:17:05.480</a></span> | <span class="t">So is an R^2 0.9 close or not?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1033" target="_blank">00:17:13.960</a></span> | <span class="t">So I think R^2 is a useful number to have a familiarity with, and you don't need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1039" target="_blank">00:17:19.800</a></span> | <span class="t">remember the formula if you remember the meaning, which is what's the ratio between how good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1045" target="_blank">00:17:25.760</a></span> | <span class="t">your model is, where it means good error, versus how good is the naive mean model for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1050" target="_blank">00:17:30.640</a></span> | <span class="t">its good error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1051" target="_blank">00:17:31.640</a></span> | <span class="t">In our case, 0.98, it's saying it's a very good model, however it might be a very good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1059" target="_blank">00:17:39.600</a></span> | <span class="t">model because it looks like this, and this would be called overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1065" target="_blank">00:17:45.360</a></span> | <span class="t">So we may well have created a model which is very good at running through the points</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1069" target="_blank">00:17:49.320</a></span> | <span class="t">that we gave it, but it's not going to be very good at running through points that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1073" target="_blank">00:17:53.560</a></span> | <span class="t">didn't give it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1075" target="_blank">00:17:55.200</a></span> | <span class="t">So that's why we always want to have a validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1081" target="_blank">00:18:01.720</a></span> | <span class="t">Creating your validation set is the most important thing that I think you need to do when you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1089" target="_blank">00:18:09.080</a></span> | <span class="t">doing a machine learning project, at least in the actual modeling part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1098" target="_blank">00:18:18.740</a></span> | <span class="t">Because what you need to do is come up with a dataset where the score of your model on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1104" target="_blank">00:18:24.800</a></span> | <span class="t">that dataset is going to be representative of how well your model is going to do in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1110" target="_blank">00:18:30.680</a></span> | <span class="t">real world, like in Kaggle on the leaderboard or off Kaggle when you actually use it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1115" target="_blank">00:18:35.800</a></span> | <span class="t">production.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1118" target="_blank">00:18:38.300</a></span> | <span class="t">I very very very often hear people in industry say, "I don't trust machine learning, I tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1127" target="_blank">00:18:47.240</a></span> | <span class="t">modeling once, it looked great, we put it in production, it didn't work."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1132" target="_blank">00:18:52.860</a></span> | <span class="t">Whose fault is that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1134" target="_blank">00:18:54.880</a></span> | <span class="t">That means their validation set was not representative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1139" target="_blank">00:18:59.440</a></span> | <span class="t">So here's a very simple thing which generally speaking Kaggle is pretty good about doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1144" target="_blank">00:19:04.520</a></span> | <span class="t">If your data has a time piece in it, as happens in Bluebook for bulldozers, in Bluebook for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1151" target="_blank">00:19:11.680</a></span> | <span class="t">bulldozers we're talking about the sale price of a piece of industrial equipment on a particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1158" target="_blank">00:19:18.360</a></span> | <span class="t">date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1160" target="_blank">00:19:20.040</a></span> | <span class="t">So the startup doing this competition wanted to create a model that wouldn't predict last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1165" target="_blank">00:19:25.480</a></span> | <span class="t">February's prices, but would predict next month's prices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1169" target="_blank">00:19:29.640</a></span> | <span class="t">So what they did was they gave us data representing a particular date range in the training set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1175" target="_blank">00:19:35.320</a></span> | <span class="t">and then the test set represented a future set of dates that wasn't represented in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1180" target="_blank">00:19:40.520</a></span> | <span class="t">training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1182" target="_blank">00:19:42.360</a></span> | <span class="t">So that's pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1183" target="_blank">00:19:43.760</a></span> | <span class="t">That means that if we're doing well on this model, we've built something which can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1188" target="_blank">00:19:48.400</a></span> | <span class="t">predict the future, or at least it could predict the future then, assuming things haven't changed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1194" target="_blank">00:19:54.000</a></span> | <span class="t">dramatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1196" target="_blank">00:19:56.220</a></span> | <span class="t">So that's the test set we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1198" target="_blank">00:19:58.160</a></span> | <span class="t">So we need to create a validation set that has the same properties.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1202" target="_blank">00:20:02.260</a></span> | <span class="t">So the test set had 12,000 rows in, so let's create a validation set that has 12,000 rows,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1209" target="_blank">00:20:09.200</a></span> | <span class="t">and then let's split the data set into the first n-12,000 rows for the training set and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1219" target="_blank">00:20:19.920</a></span> | <span class="t">the last 12,000 rows for the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1223" target="_blank">00:20:23.040</a></span> | <span class="t">And so we've now got something which hopefully looks like Kaggle's test set, close enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1230" target="_blank">00:20:30.000</a></span> | <span class="t">that when we actually try and use this validation set, we're going to get some reasonably accurate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1236" target="_blank">00:20:36.160</a></span> | <span class="t">scores.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1237" target="_blank">00:20:37.160</a></span> | <span class="t">The reason we want this is because on Kaggle, you can only submit so many times, and if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1242" target="_blank">00:20:42.680</a></span> | <span class="t">you submit too often, you'll end up opening to the leaderboard anyway, and in real life,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1247" target="_blank">00:20:47.080</a></span> | <span class="t">you actually want to build a model that's going to work in real life.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1250" target="_blank">00:20:50.080</a></span> | <span class="t">Did you have a question?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1251" target="_blank">00:20:51.080</a></span> | <span class="t">Can we help the green box?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1254" target="_blank">00:20:54.400</a></span> | <span class="t">Can you explain the difference between a validation set and a test set?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1264" target="_blank">00:21:04.080</a></span> | <span class="t">Absolutely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1265" target="_blank">00:21:05.080</a></span> | <span class="t">What we're going to learn today is how to set hyperparameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1269" target="_blank">00:21:09.960</a></span> | <span class="t">Hyperparameters are like tuning parameters that are going to change how your model behaves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1274" target="_blank">00:21:14.400</a></span> | <span class="t">Now if you just have one holdout set, so one set of data that you're not using to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1279" target="_blank">00:21:19.720</a></span> | <span class="t">with, and we use that to decide which set of hyperparameters to use, if we try a thousand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1285" target="_blank">00:21:25.160</a></span> | <span class="t">different sets of hyperparameters, we may end up overfitting to that holdout set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1290" target="_blank">00:21:30.400</a></span> | <span class="t">That is to say we'll find something which only accidentally worked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1294" target="_blank">00:21:34.480</a></span> | <span class="t">So what we actually want to do is we really want to have a second holdout set where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1299" target="_blank">00:21:39.280</a></span> | <span class="t">can say, okay, I'm finished, I've done the best I can, and now just once right at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1306" target="_blank">00:21:46.600</a></span> | <span class="t">end I'm going to see whether it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1311" target="_blank">00:21:51.920</a></span> | <span class="t">This is something which almost nobody in industry does correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1318" target="_blank">00:21:58.800</a></span> | <span class="t">You really actually need to remove that holdout set, and that's called the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1323" target="_blank">00:22:03.320</a></span> | <span class="t">Remove it from the data, give it to somebody else, and tell them do not let me look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1328" target="_blank">00:22:08.280</a></span> | <span class="t">this data until I promise you I'm finished.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1330" target="_blank">00:22:10.960</a></span> | <span class="t">It's so hard otherwise not to look at it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1333" target="_blank">00:22:13.560</a></span> | <span class="t">For example, in the world of psychology and sociology you might have heard about this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1336" target="_blank">00:22:16.960</a></span> | <span class="t">replication crisis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1338" target="_blank">00:22:18.960</a></span> | <span class="t">This is basically because people in these fields have accidentally or intentionally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1344" target="_blank">00:22:24.040</a></span> | <span class="t">maybe been p-hacking, which means they've been basically trying lots of different variations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1349" target="_blank">00:22:29.840</a></span> | <span class="t">until they find something that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1352" target="_blank">00:22:32.000</a></span> | <span class="t">And then it turns out when they try to replicate it, in other words it's like somebody creates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1355" target="_blank">00:22:35.800</a></span> | <span class="t">a test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1356" target="_blank">00:22:36.800</a></span> | <span class="t">Somebody says okay, this study which shows the impact of whether you eat marshmallows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1361" target="_blank">00:22:41.440</a></span> | <span class="t">on your tenacity later in life, I'm going to rerun it, and over half the time they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1367" target="_blank">00:22:47.760</a></span> | <span class="t">finding the effect turns out not to exist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1370" target="_blank">00:22:50.300</a></span> | <span class="t">So that's why we want to have a test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1374" target="_blank">00:22:54.680</a></span> | <span class="t">I've seen a lot of models where we convert categorical data into different columns using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1388" target="_blank">00:23:08.760</a></span> | <span class="t">one-hot encoding, so which approach to use in which model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1393" target="_blank">00:23:13.160</a></span> | <span class="t">Yeah we're going to tackle that today, it's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1399" target="_blank">00:23:19.240</a></span> | <span class="t">So I'm splitting my data into validation and training sets, and so you can see now that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1407" target="_blank">00:23:27.480</a></span> | <span class="t">my validation set is 12,000 by 66, whereas my training set is 389,000 by 66.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1416" target="_blank">00:23:36.760</a></span> | <span class="t">So we're going to use this set of data to train a model and this set of data to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1420" target="_blank">00:23:40.800</a></span> | <span class="t">how well it's working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1423" target="_blank">00:23:43.440</a></span> | <span class="t">So when we then tried that last week, we found out that our model, which had 0.982r^2 on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1431" target="_blank">00:23:51.880</a></span> | <span class="t">the training set, only had 0.887 on the validation set, which makes us think that we're overfitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1439" target="_blank">00:23:59.000</a></span> | <span class="t">quite badly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1440" target="_blank">00:24:00.000</a></span> | <span class="t">But it turned out it wasn't too badly because the root mean squared error on the logs of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1445" target="_blank">00:24:05.400</a></span> | <span class="t">the prices actually would have put us in the top 25% of the competition anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1450" target="_blank">00:24:10.240</a></span> | <span class="t">So even though we're overfitting, it wasn't the end of the world.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1453" target="_blank">00:24:13.640</a></span> | <span class="t">Could you pass the microphone to Marcia please?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1459" target="_blank">00:24:19.600</a></span> | <span class="t">In terms of dividing the set into training and validation, it seems like you simply take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1466" target="_blank">00:24:26.740</a></span> | <span class="t">the first and train observations of the dataset and set them aside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1472" target="_blank">00:24:32.120</a></span> | <span class="t">Why don't you randomly pick up the observations?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1477" target="_blank">00:24:37.600</a></span> | <span class="t">Because if I did that, I wouldn't be replicating the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1481" target="_blank">00:24:41.400</a></span> | <span class="t">So Kaggle has a test set that when you actually look at the dates in the test set, they are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1486" target="_blank">00:24:46.480</a></span> | <span class="t">a set of dates that are more recent than any date in the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1492" target="_blank">00:24:52.620</a></span> | <span class="t">So if we used a validation set that was a random sample, that is much easier because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1497" target="_blank">00:24:57.660</a></span> | <span class="t">we're predicting options like what's the value of this piece of industrial equipment on this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1502" target="_blank">00:25:02.340</a></span> | <span class="t">day when we actually already have some observations from that day.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1506" target="_blank">00:25:06.900</a></span> | <span class="t">So in general, any time you're building a model that has a time element, you want your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1513" target="_blank">00:25:13.680</a></span> | <span class="t">test set to be a separate time period, and therefore you really need your validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1519" target="_blank">00:25:19.000</a></span> | <span class="t">set to be a separate time period as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1520" target="_blank">00:25:20.840</a></span> | <span class="t">In this case, the data was already sorted, so that's why this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1524" target="_blank">00:25:24.040</a></span> | <span class="t">So let's say we have the training set where we train the data and then we have the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1536" target="_blank">00:25:36.480</a></span> | <span class="t">set against which we are trying to find the R-square.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1541" target="_blank">00:25:41.020</a></span> | <span class="t">In case our R-square turns out to be really bad, we would want to tune our parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1546" target="_blank">00:25:46.560</a></span> | <span class="t">and run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1547" target="_blank">00:25:47.980</a></span> | <span class="t">So wouldn't that be eventually overfitting on the overall training set?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1552" target="_blank">00:25:52.700</a></span> | <span class="t">Yeah, so actually that's the issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1555" target="_blank">00:25:55.020</a></span> | <span class="t">So that would eventually have the possibility of overfitting on the validation set, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1559" target="_blank">00:25:59.320</a></span> | <span class="t">then when we try it on the test set or we submit it to Kaggle, it turns out not to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1563" target="_blank">00:26:03.440</a></span> | <span class="t">very good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1564" target="_blank">00:26:04.440</a></span> | <span class="t">And this happens in Kaggle competitions all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1567" target="_blank">00:26:07.160</a></span> | <span class="t">Kaggle actually has a fourth dataset which is called the Private Leaderboard set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1573" target="_blank">00:26:13.480</a></span> | <span class="t">And every time you submit to Kaggle, you actually only get feedback on how well it does on something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1578" target="_blank">00:26:18.680</a></span> | <span class="t">called the Public Leaderboard set, and you don't know which rows they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1582" target="_blank">00:26:22.760</a></span> | <span class="t">And at the end of the competition, you actually get judged on a different dataset entirely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1586" target="_blank">00:26:26.820</a></span> | <span class="t">called the Private Leaderboard set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1588" target="_blank">00:26:28.960</a></span> | <span class="t">So the only way to avoid this is to actually be a good machine learning practitioner and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1595" target="_blank">00:26:35.520</a></span> | <span class="t">know how to set these parameters as effectively as possible, which we're going to be doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1600" target="_blank">00:26:40.680</a></span> | <span class="t">partly today and over the next few weeks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1606" target="_blank">00:26:46.040</a></span> | <span class="t">Can you get the -- actually, why don't you throw it to me?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1613" target="_blank">00:26:53.800</a></span> | <span class="t">Is it too early or late to ask what's the difference between a hyperparameter and a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1619" target="_blank">00:26:59.000</a></span> | <span class="t">parameter?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1620" target="_blank">00:27:00.000</a></span> | <span class="t">Sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1621" target="_blank">00:27:01.000</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1622" target="_blank">00:27:02.000</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1623" target="_blank">00:27:03.000</a></span> | <span class="t">So let's start tracking things on root name spread error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1634" target="_blank">00:27:14.600</a></span> | <span class="t">So here is root mean squared error in a line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1639" target="_blank">00:27:19.080</a></span> | <span class="t">And you can see here, this is one of these examples where I'm not writing this the way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1644" target="_blank">00:27:24.760</a></span> | <span class="t">a proper software engineer would write this, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1646" target="_blank">00:27:26.960</a></span> | <span class="t">So a proper software engineer would be a number of things differently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1649" target="_blank">00:27:29.560</a></span> | <span class="t">They would have it on a different line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1651" target="_blank">00:27:31.920</a></span> | <span class="t">They would use longer variable names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1660" target="_blank">00:27:40.520</a></span> | <span class="t">They would have documentation, blah, blah, blah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1665" target="_blank">00:27:45.520</a></span> | <span class="t">But I really think, for me, I really think that being able to look at something in one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1678" target="_blank">00:27:58.080</a></span> | <span class="t">go with your eyes and over time learn to immediately see what's going on has a lot of value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1686" target="_blank">00:28:06.120</a></span> | <span class="t">And also to consistently use particular letters that mean particular things or abbreviations,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1693" target="_blank">00:28:13.960</a></span> | <span class="t">I think works really well in data science.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1698" target="_blank">00:28:18.880</a></span> | <span class="t">If you're doing a take-home interview test or something, you should write your code according</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1707" target="_blank">00:28:27.140</a></span> | <span class="t">to PEP8 standards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1709" target="_blank">00:28:29.760</a></span> | <span class="t">So PEP8 is the style guide for Python code and you should know it and use it because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1716" target="_blank">00:28:36.200</a></span> | <span class="t">a lot of software engineers are super anal about this kind of thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1721" target="_blank">00:28:41.120</a></span> | <span class="t">But for your own work, I think this works well for me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1728" target="_blank">00:28:48.440</a></span> | <span class="t">So I just wanted to make you aware, a) that you shouldn't necessarily use this as a role</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1732" target="_blank">00:28:52.460</a></span> | <span class="t">model for dealing with software engineers, but b) that I actually think this is a reasonable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1739" target="_blank">00:28:59.360</a></span> | <span class="t">approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1740" target="_blank">00:29:00.360</a></span> | <span class="t">So there's our root-mean-squared error, and then from time to time we're just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1743" target="_blank">00:29:03.840</a></span> | <span class="t">print out the score which will give us the RMSE of the predictions on the training versus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1748" target="_blank">00:29:08.920</a></span> | <span class="t">the actual, the predictions on the valid versus the actual RMSE, the R-squared for the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1754" target="_blank">00:29:14.560</a></span> | <span class="t">and the R-squared for the valid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1755" target="_blank">00:29:15.920</a></span> | <span class="t">And we'll come back to OOV in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1758" target="_blank">00:29:18.200</a></span> | <span class="t">So when we ran that, we found that this RMSE was in the top 25% and it's like, okay, there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1764" target="_blank">00:29:24.060</a></span> | <span class="t">a good start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1765" target="_blank">00:29:25.340</a></span> | <span class="t">Now this took 8 seconds of wall time, so 8 actual seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1773" target="_blank">00:29:33.520</a></span> | <span class="t">If you put %time, it'll tell you how long things took.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1777" target="_blank">00:29:37.960</a></span> | <span class="t">And luckily I've got quite a few cores, quite a few CPUs in this computer because it actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1782" target="_blank">00:29:42.140</a></span> | <span class="t">took over a minute of compute time, so it parallelized that across cores.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1787" target="_blank">00:29:47.880</a></span> | <span class="t">If your dataset was bigger or you had less cores, you could well find that this took</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1795" target="_blank">00:29:55.260</a></span> | <span class="t">a few minutes to run or even a few hours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1798" target="_blank">00:29:58.040</a></span> | <span class="t">My rule of thumb is that if something takes more than 10 seconds to run, it's too long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1805" target="_blank">00:30:05.240</a></span> | <span class="t">for me to do interactive analysis with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1809" target="_blank">00:30:09.520</a></span> | <span class="t">I want to be able to run something, wait a moment, and then continue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1815" target="_blank">00:30:15.540</a></span> | <span class="t">So what we do is we try to make sure that things can run in a reasonable time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1822" target="_blank">00:30:22.000</a></span> | <span class="t">And then when we're finished at the end of the day, we can then say, okay, this feature</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1827" target="_blank">00:30:27.100</a></span> | <span class="t">engineering, these hyperparameters, whatever, these are all working well, and I'll now rerun</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1831" target="_blank">00:30:31.360</a></span> | <span class="t">it the big, slow, precise way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1836" target="_blank">00:30:36.320</a></span> | <span class="t">So one way to speed things up is to pass in the subset parameter to proc df, and that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1842" target="_blank">00:30:42.400</a></span> | <span class="t">will randomly sample my data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1846" target="_blank">00:30:46.600</a></span> | <span class="t">And so here I'm going to randomly sample 30,000 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1849" target="_blank">00:30:49.640</a></span> | <span class="t">Now when I do that, I still need to be careful to make sure that my validation set doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1857" target="_blank">00:30:57.360</a></span> | <span class="t">change and that my training set doesn't overlap with the dates, otherwise I'm cheating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1863" target="_blank">00:31:03.320</a></span> | <span class="t">So I call split_valves again to do this split_by_dates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1869" target="_blank">00:31:09.840</a></span> | <span class="t">And you'll also see I'm using, rather than putting it into a validation set, I'm putting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1873" target="_blank">00:31:13.960</a></span> | <span class="t">it into a variable called _. This is kind of a standard approach in Python is to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1878" target="_blank">00:31:18.680</a></span> | <span class="t">a variable called _ if you want to throw something away, because I don't want to change my validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1883" target="_blank">00:31:23.320</a></span> | <span class="t">set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1884" target="_blank">00:31:24.320</a></span> | <span class="t">Like no matter what different models I build, I want to be able to compare them all to each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1887" target="_blank">00:31:27.840</a></span> | <span class="t">other, so I want to keep my validation set the same all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1891" target="_blank">00:31:31.840</a></span> | <span class="t">So all I'm doing here is I'm resampling my training set into the first 20,000 out of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1898" target="_blank">00:31:38.080</a></span> | <span class="t">a 30,000 subset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1901" target="_blank">00:31:41.160</a></span> | <span class="t">So I now can run that, and it runs in 621 milliseconds, so I can really zip through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1907" target="_blank">00:31:47.400</a></span> | <span class="t">things now, try things out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1911" target="_blank">00:31:51.600</a></span> | <span class="t">So with that, let's use this subset to build a model that is so simple that we can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1919" target="_blank">00:31:59.640</a></span> | <span class="t">take a look at it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1921" target="_blank">00:32:01.080</a></span> | <span class="t">And so we're going to build a forest that's made of trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1926" target="_blank">00:32:06.220</a></span> | <span class="t">And so before we look at the forest, we'll look at the trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1930" target="_blank">00:32:10.000</a></span> | <span class="t">In scikit-learn, they don't call them trees, they call them estimators.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1934" target="_blank">00:32:14.200</a></span> | <span class="t">So we're going to pass in the parameter number of estimators equals 1 to create a forest with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1939" target="_blank">00:32:19.760</a></span> | <span class="t">just one tree in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1942" target="_blank">00:32:22.160</a></span> | <span class="t">And then we're going to make a small tree, so we pass in maximum depth equals 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1947" target="_blank">00:32:27.400</a></span> | <span class="t">And a random forest, as we're going to learn, randomizes a whole bunch of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1951" target="_blank">00:32:31.960</a></span> | <span class="t">We want to turn that off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1953" target="_blank">00:32:33.360</a></span> | <span class="t">So to turn that off, you say bootstrap equals false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1956" target="_blank">00:32:36.180</a></span> | <span class="t">So if I pass in these parameters, it creates a small deterministic tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1963" target="_blank">00:32:43.160</a></span> | <span class="t">So if I fit it and say printScore, my R^2 has gone down from 0.85 to 0.4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1970" target="_blank">00:32:50.760</a></span> | <span class="t">So this is not a good model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1972" target="_blank">00:32:52.680</a></span> | <span class="t">It's better than the mean model, this is better than 0, it's not a good model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1977" target="_blank">00:32:57.400</a></span> | <span class="t">But it's a model that we can draw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1981" target="_blank">00:33:01.840</a></span> | <span class="t">So let's learn about what it's built.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1985" target="_blank">00:33:05.160</a></span> | <span class="t">So a tree consists of a sequence of binary decisions, of binary splits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=1994" target="_blank">00:33:14.800</a></span> | <span class="t">So it first of all decided to split on coupler system greater than or less than 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2000" target="_blank">00:33:20.800</a></span> | <span class="t">That's a Boolean variable, so it's actually true or false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2004" target="_blank">00:33:24.080</a></span> | <span class="t">And then within the group where a coupler system was true, it decided to split into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2008" target="_blank">00:33:28.200</a></span> | <span class="t">yearmade greater than or less than 0.987.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2011" target="_blank">00:33:31.640</a></span> | <span class="t">And then where a coupler system was true and yearmade was less than or equal to 0.986,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2016" target="_blank">00:33:36.960</a></span> | <span class="t">it used fi_product_class_desk is less than or equal to 0.75, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2023" target="_blank">00:33:43.840</a></span> | <span class="t">So right at the top, we have 20,000 samples, 20,000 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2030" target="_blank">00:33:50.440</a></span> | <span class="t">And the reason for that is because that's what we asked for here when we split our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2035" target="_blank">00:33:55.980</a></span> | <span class="t">in the sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2042" target="_blank">00:34:02.760</a></span> | <span class="t">I just want to double check that for your decision tree that you have there, that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2047" target="_blank">00:34:07.240</a></span> | <span class="t">coloration was whether it's true or false, so it gets darker, it's true for the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2053" target="_blank">00:34:13.480</a></span> | <span class="t">one, not the...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2055" target="_blank">00:34:15.280</a></span> | <span class="t">Darker is a higher value, we'll get to that in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2059" target="_blank">00:34:19.000</a></span> | <span class="t">So let's look at these numbers here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2061" target="_blank">00:34:21.240</a></span> | <span class="t">So in the whole data set, our sample that we're using, there are 20,000 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2068" target="_blank">00:34:28.520</a></span> | <span class="t">The average of the log of price is 10.1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2073" target="_blank">00:34:33.080</a></span> | <span class="t">And if we built a model where we just used that average all the time, then the mean squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2078" target="_blank">00:34:38.360</a></span> | <span class="t">error would be 0.477.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2083" target="_blank">00:34:43.160</a></span> | <span class="t">So this is, in other words, the denominator of an R^2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2089" target="_blank">00:34:49.320</a></span> | <span class="t">This is like the most basic model is a tree with zero splits, which is just predict the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2094" target="_blank">00:34:54.400</a></span> | <span class="t">average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2096" target="_blank">00:34:56.000</a></span> | <span class="t">So the best single binary split we can make turns out to be splitting by whether the coupler</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2103" target="_blank">00:35:03.680</a></span> | <span class="t">system is less than or equal to or greater than 0.5, in other words whether it's true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2108" target="_blank">00:35:08.760</a></span> | <span class="t">or false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2109" target="_blank">00:35:09.760</a></span> | <span class="t">And it turns out if we do that, the mean squared error of coupler system is less than 0.5,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2116" target="_blank">00:35:16.000</a></span> | <span class="t">so it's false, goes down from 0.477 to 0.11.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2122" target="_blank">00:35:22.280</a></span> | <span class="t">So it's really improved the error a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2125" target="_blank">00:35:25.400</a></span> | <span class="t">In the other group, it's only improved it a bit, it's gone from 0.47 to 0.41.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2131" target="_blank">00:35:31.160</a></span> | <span class="t">And so we can see that the coupler system equals false group has a pretty small percentage,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2137" target="_blank">00:35:37.360</a></span> | <span class="t">it's only got 2200 of the 20,000, whereas this other group has a much larger percentage,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2145" target="_blank">00:35:45.240</a></span> | <span class="t">but it hasn't improved it as much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2148" target="_blank">00:35:48.400</a></span> | <span class="t">So let's say you wanted to create a tree with just one split.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2154" target="_blank">00:35:54.840</a></span> | <span class="t">So you're just trying to find what is the very best single binary decision you can make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2162" target="_blank">00:36:02.440</a></span> | <span class="t">for your data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2165" target="_blank">00:36:05.320</a></span> | <span class="t">How much you'd be able to do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2166" target="_blank">00:36:06.720</a></span> | <span class="t">How could you do it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2168" target="_blank">00:36:08.040</a></span> | <span class="t">I'm going to give it to Ford.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2176" target="_blank">00:36:16.520</a></span> | <span class="t">But you're writing, you don't have a random forest, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2180" target="_blank">00:36:20.760</a></span> | <span class="t">How are you going to write, what's an algorithm, a simple algorithm which you could use?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2186" target="_blank">00:36:26.680</a></span> | <span class="t">Sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2188" target="_blank">00:36:28.520</a></span> | <span class="t">So we want to start building a random forest from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2192" target="_blank">00:36:32.080</a></span> | <span class="t">So the first step is to create a tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2194" target="_blank">00:36:34.840</a></span> | <span class="t">The first step to create a tree is to create the first binary decision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2199" target="_blank">00:36:39.840</a></span> | <span class="t">How are you going to do it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2200" target="_blank">00:36:40.840</a></span> | <span class="t">I'm going to give it to Chris, maybe in two steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2209" target="_blank">00:36:49.760</a></span> | <span class="t">So isn't this simply trying to find the best predictor based on maybe linear regression?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2216" target="_blank">00:36:56.680</a></span> | <span class="t">You could use a linear regression, but could you do something much simpler and more complete?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2223" target="_blank">00:37:03.560</a></span> | <span class="t">We're trying not to use any statistical assumptions here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2226" target="_blank">00:37:06.880</a></span> | <span class="t">Can we just take just one variable, if it is true, give it the true thing, and if it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2241" target="_blank">00:37:21.480</a></span> | <span class="t">is false?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2243" target="_blank">00:37:23.680</a></span> | <span class="t">So which variable are we going to choose?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2245" target="_blank">00:37:25.400</a></span> | <span class="t">So at each binary point we have to choose a variable and something to split on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2251" target="_blank">00:37:31.840</a></span> | <span class="t">How are we going to do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2252" target="_blank">00:37:32.840</a></span> | <span class="t">We're going to pass it over there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2253" target="_blank">00:37:33.840</a></span> | <span class="t">How do I pronounce your name?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2258" target="_blank">00:37:38.520</a></span> | <span class="t">Shikhar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2259" target="_blank">00:37:39.520</a></span> | <span class="t">So the variable to choose could be like which divides the population into two groups, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2266" target="_blank">00:37:46.600</a></span> | <span class="t">are kind of heterogeneous to each other and homogeneous within themselves, like having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2272" target="_blank">00:37:52.040</a></span> | <span class="t">the same quality within themselves, and they're very different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2276" target="_blank">00:37:56.080</a></span> | <span class="t">Could you be more specific?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2277" target="_blank">00:37:57.680</a></span> | <span class="t">In terms of the target variable maybe, let's say we have two groups after split, so one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2284" target="_blank">00:38:04.720</a></span> | <span class="t">has a different price altogether from the second group, but internally they have similar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2289" target="_blank">00:38:09.880</a></span> | <span class="t">prices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2290" target="_blank">00:38:10.880</a></span> | <span class="t">Okay, that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2291" target="_blank">00:38:11.880</a></span> | <span class="t">So to simplify things a little bit, we're saying find a variable that we could split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2297" target="_blank">00:38:17.320</a></span> | <span class="t">into such that the two groups are as different to each other as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2305" target="_blank">00:38:25.040</a></span> | <span class="t">And how would you pick which variable and which split point?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2309" target="_blank">00:38:29.240</a></span> | <span class="t">That's the question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2318" target="_blank">00:38:38.400</a></span> | <span class="t">What's your first cut?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2319" target="_blank">00:38:39.400</a></span> | <span class="t">Which variable and which split point?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2327" target="_blank">00:38:47.760</a></span> | <span class="t">We're making a tree from scratch, we want to create our own tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2331" target="_blank">00:38:51.160</a></span> | <span class="t">Does that make sense?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2332" target="_blank">00:38:52.760</a></span> | <span class="t">We've got somebody over here, Maisley?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2343" target="_blank">00:39:03.960</a></span> | <span class="t">Can we test all of the possible splits and see which one has the smallest RMSE?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2349" target="_blank">00:39:09.480</a></span> | <span class="t">That sounds good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2350" target="_blank">00:39:10.480</a></span> | <span class="t">Okay, so let's dig into this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2352" target="_blank">00:39:12.080</a></span> | <span class="t">So when you say test all of the possible splits, what does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2356" target="_blank">00:39:16.920</a></span> | <span class="t">How do we enumerate all of the possible splits?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2369" target="_blank">00:39:29.960</a></span> | <span class="t">For each variable, you could put one aside and then put a second aside and compare the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2377" target="_blank">00:39:37.520</a></span> | <span class="t">two and if it was better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2379" target="_blank">00:39:39.280</a></span> | <span class="t">Okay, so for each variable, for each possible value of that variable, see whether it's better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2388" target="_blank">00:39:48.080</a></span> | <span class="t">Now give it back to Maisley because I want to dig into the better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2390" target="_blank">00:39:50.760</a></span> | <span class="t">When you said see if the RMSE is better, what does that mean though?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2394" target="_blank">00:39:54.800</a></span> | <span class="t">Because after a split, you've got two RMSEs, you've got two groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2400" target="_blank">00:40:00.900</a></span> | <span class="t">So you're just going to fit with that one variable comparing to the other's not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2405" target="_blank">00:40:05.960</a></span> | <span class="t">So what I mean here is that before we decided to split on coupler system, we had a remove</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2411" target="_blank">00:40:11.680</a></span> | <span class="t">the mean squared of 0.477, and after we've got two groups, one with a mean squared error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2416" target="_blank">00:40:16.680</a></span> | <span class="t">of 0.1, another with a mean squared error of 0.4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2421" target="_blank">00:40:21.200</a></span> | <span class="t">So you treat each individual model separately.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2425" target="_blank">00:40:25.080</a></span> | <span class="t">So for the first split, you're just going to compare between each variable themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2429" target="_blank">00:40:29.640</a></span> | <span class="t">And then you move on to the next node with the remaining variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2432" target="_blank">00:40:32.280</a></span> | <span class="t">But even the first node, so the model with zero splits has a single root mean squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2439" target="_blank">00:40:39.400</a></span> | <span class="t">error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2440" target="_blank">00:40:40.560</a></span> | <span class="t">The model with one split, so the very first thing we tried, we've now got two groups with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2446" target="_blank">00:40:46.360</a></span> | <span class="t">two mean squared errors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2447" target="_blank">00:40:47.360</a></span> | <span class="t">Do you want to give it to Daniel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2452" target="_blank">00:40:52.080</a></span> | <span class="t">Do you pick the one that gets them as different as they can be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2455" target="_blank">00:40:55.440</a></span> | <span class="t">Well, okay, that would be one idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2458" target="_blank">00:40:58.240</a></span> | <span class="t">Get the two mean squared errors as different as possible, but why might that not work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2464" target="_blank">00:41:04.620</a></span> | <span class="t">What might be a problem with that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2467" target="_blank">00:41:07.460</a></span> | <span class="t">Sample size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2468" target="_blank">00:41:08.460</a></span> | <span class="t">Go on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2469" target="_blank">00:41:09.460</a></span> | <span class="t">Because you could just literally leave one point out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2471" target="_blank">00:41:11.840</a></span> | <span class="t">Yeah, so we could have like year made is less than 1950, and it might have a single sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2478" target="_blank">00:41:18.280</a></span> | <span class="t">with a low price, and that's not a great split, is it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2482" target="_blank">00:41:22.800</a></span> | <span class="t">Because the other group is actually not going to be very interesting at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2487" target="_blank">00:41:27.700</a></span> | <span class="t">Can you improve it a bit?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2489" target="_blank">00:41:29.400</a></span> | <span class="t">Can Jason improve it a bit?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2493" target="_blank">00:41:33.400</a></span> | <span class="t">Could you take a weighted average?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2496" target="_blank">00:41:36.000</a></span> | <span class="t">Yeah, a weighted average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2498" target="_blank">00:41:38.280</a></span> | <span class="t">So we could take 0.41 times 17,000 plus 0.1 times 2,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2503" target="_blank">00:41:43.960</a></span> | <span class="t">That's good, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2505" target="_blank">00:41:45.400</a></span> | <span class="t">And that would be the same as actually saying I've got a model, the model is a single binary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2511" target="_blank">00:41:51.760</a></span> | <span class="t">decision, and I'm going to say for everybody with year made less than 986.5, I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2516" target="_blank">00:41:56.960</a></span> | <span class="t">to fill in 10.2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2520" target="_blank">00:42:00.040</a></span> | <span class="t">For everybody else, I'm going to fill in 9.2, and then I'm going to calculate the root mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2524" target="_blank">00:42:04.400</a></span> | <span class="t">squared error of this crappy model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2528" target="_blank">00:42:08.400</a></span> | <span class="t">And that will give exactly the same as the weighted average that you're suggesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2534" target="_blank">00:42:14.120</a></span> | <span class="t">So we now have a single number that represents how good a split is, which is the weighted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2540" target="_blank">00:42:20.920</a></span> | <span class="t">average of the mean squared errors of the two groups it creates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2545" target="_blank">00:42:25.200</a></span> | <span class="t">And thanks to Jake, we have a way to find the best split, which is to try every variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2552" target="_blank">00:42:32.400</a></span> | <span class="t">and to try every possible value of that variable and see which variable and which value gives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2557" target="_blank">00:42:37.280</a></span> | <span class="t">us the split with the best score.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2561" target="_blank">00:42:41.000</a></span> | <span class="t">That make sense?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2562" target="_blank">00:42:42.000</a></span> | <span class="t">What's your name?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2563" target="_blank">00:42:43.000</a></span> | <span class="t">Sorry?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2564" target="_blank">00:42:44.000</a></span> | <span class="t">Can somebody give Natalie the box?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2579" target="_blank">00:42:59.400</a></span> | <span class="t">When you say every possible number for every possible variable, are you saying here we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2585" target="_blank">00:43:05.600</a></span> | <span class="t">have 0.5 as our criteria to split the tree, are you saying we're trying out every single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2595" target="_blank">00:43:15.440</a></span> | <span class="t">number for?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2597" target="_blank">00:43:17.640</a></span> | <span class="t">Every possible value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2599" target="_blank">00:43:19.400</a></span> | <span class="t">So a couple of system only has two values, true and false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2603" target="_blank">00:43:23.640</a></span> | <span class="t">So there's only one way of splitting, which is trues and falses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2607" target="_blank">00:43:27.440</a></span> | <span class="t">Year made is an integer which varies between 1960 and 2010, so we can just say what are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2613" target="_blank">00:43:33.200</a></span> | <span class="t">all the possible unique values of year made, and try them all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2617" target="_blank">00:43:37.440</a></span> | <span class="t">So we're trying all the possible split points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2620" target="_blank">00:43:40.120</a></span> | <span class="t">Can you pass that back to Daniel, or pass it to me and I'll pass it to Daniel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2636" target="_blank">00:43:56.440</a></span> | <span class="t">So I just want to clarify again for the first split.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2641" target="_blank">00:44:01.120</a></span> | <span class="t">Why did we split on coupler system, true or false to start with?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2645" target="_blank">00:44:05.720</a></span> | <span class="t">Because what we did was we used Jake's technique.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2648" target="_blank">00:44:08.520</a></span> | <span class="t">We tried every variable, for every variable we tried every possible split.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2654" target="_blank">00:44:14.600</a></span> | <span class="t">For each one, we noted down, I think it was Jason's idea, which was the weighted average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2660" target="_blank">00:44:20.320</a></span> | <span class="t">mean squared error of the two groups we created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2663" target="_blank">00:44:23.520</a></span> | <span class="t">We found which one had the best mean squared error and we picked it, and it turned out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2669" target="_blank">00:44:29.000</a></span> | <span class="t">it was coupler system, true or false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2671" target="_blank">00:44:31.880</a></span> | <span class="t">Does that make sense?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2674" target="_blank">00:44:34.720</a></span> | <span class="t">I guess my question is more like, so coupler system is one of the best indicators, I guess?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2683" target="_blank">00:44:43.520</a></span> | <span class="t">It's the best.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2684" target="_blank">00:44:44.880</a></span> | <span class="t">We tried every variable and every possible level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2688" target="_blank">00:44:48.280</a></span> | <span class="t">So each level after that, it gets less and less?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2691" target="_blank">00:44:51.320</a></span> | <span class="t">Everything else it tried wasn't as good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2693" target="_blank">00:44:53.440</a></span> | <span class="t">And then you do that each time you split?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2695" target="_blank">00:44:55.200</a></span> | <span class="t">Right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2696" target="_blank">00:44:56.200</a></span> | <span class="t">So on that, we now take this group here, everybody who's got coupler system equals true, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2702" target="_blank">00:45:02.160</a></span> | <span class="t">we do it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2703" target="_blank">00:45:03.240</a></span> | <span class="t">For every possible variable, for every possible level, for people where coupler system equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2708" target="_blank">00:45:08.320</a></span> | <span class="t">true, what's the best possible split?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2711" target="_blank">00:45:11.600</a></span> | <span class="t">And then are there circumstances when it's not just like binary?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2716" target="_blank">00:45:16.600</a></span> | <span class="t">You split it into three groups, for example, year made?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2720" target="_blank">00:45:20.280</a></span> | <span class="t">So I'm going to make a claim, and then I'm going to see if you can justify it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2723" target="_blank">00:45:23.760</a></span> | <span class="t">I'm going to claim that it's never necessary to do more than one split at a level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2730" target="_blank">00:45:30.320</a></span> | <span class="t">Because you can just split it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2731" target="_blank">00:45:31.880</a></span> | <span class="t">Because you can just split it again, exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2734" target="_blank">00:45:34.260</a></span> | <span class="t">So you can get exactly the same result by splitting twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2740" target="_blank">00:45:40.880</a></span> | <span class="t">So that is the entirety of creating a decision tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2747" target="_blank">00:45:47.160</a></span> | <span class="t">You stop either when you hit some limit that was requested, so we had a limit where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2753" target="_blank">00:45:53.680</a></span> | <span class="t">said max depth equals 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2755" target="_blank">00:45:55.920</a></span> | <span class="t">So that's one way to stop, would be you ask to stop at some point, and so we stop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2760" target="_blank">00:46:00.840</a></span> | <span class="t">Otherwise you stop when your leaf nodes, these things at the end are called leaf nodes, when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2766" target="_blank">00:46:06.680</a></span> | <span class="t">your leaf nodes only have one thing in them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2769" target="_blank">00:46:09.120</a></span> | <span class="t">That's a decision tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2772" target="_blank">00:46:12.400</a></span> | <span class="t">That is how we grow a decision tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2775" target="_blank">00:46:15.160</a></span> | <span class="t">And this decision tree is not very good because it's got a validation R squared of 0.4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2780" target="_blank">00:46:20.720</a></span> | <span class="t">So we could try to make it better by removing max depth equals 3 and creating a deeper tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2787" target="_blank">00:46:27.520</a></span> | <span class="t">So it's going to go all the way down, it's going to keep splitting these things further</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2791" target="_blank">00:46:31.040</a></span> | <span class="t">until every leaf node only has one thing in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2795" target="_blank">00:46:35.040</a></span> | <span class="t">And if we do that, the training R squared is, of course, 1, because we can exactly predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2803" target="_blank">00:46:43.200</a></span> | <span class="t">every training element because it's in a leaf node all on its own.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2808" target="_blank">00:46:48.360</a></span> | <span class="t">But the validation R squared is not one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2811" target="_blank">00:46:51.800</a></span> | <span class="t">It's actually better than a really shallow tree, but it's not as good as we'd like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2819" target="_blank">00:46:59.560</a></span> | <span class="t">So we want to find some other way of making these trees better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2826" target="_blank">00:47:06.360</a></span> | <span class="t">And the way we're going to do it is to create a forest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2831" target="_blank">00:47:11.000</a></span> | <span class="t">So what's a forest?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2832" target="_blank">00:47:12.820</a></span> | <span class="t">To create a forest, we're going to use a statistical technique called bagging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2838" target="_blank">00:47:18.400</a></span> | <span class="t">And you can bag any kind of model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2842" target="_blank">00:47:22.100</a></span> | <span class="t">In fact, Michael Jordan, who is one of the speakers at the recent Data Institute conference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2846" target="_blank">00:47:26.340</a></span> | <span class="t">here at the University of San Francisco, developed a technique called the Bag of Little Bootstraps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2854" target="_blank">00:47:34.720</a></span> | <span class="t">in which he shows how to use bagging for absolutely any kind of model to make it more robust and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2861" target="_blank">00:47:41.160</a></span> | <span class="t">also to give you confidence intervals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2864" target="_blank">00:47:44.360</a></span> | <span class="t">The random forest is simply a way of bagging trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2868" target="_blank">00:47:48.960</a></span> | <span class="t">So what is bagging?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2872" target="_blank">00:47:52.160</a></span> | <span class="t">Bagging is a really interesting idea, which is what if we created five different models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2879" target="_blank">00:47:59.680</a></span> | <span class="t">each of which was only somewhat predictive, but the models weren't at all correlated with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2884" target="_blank">00:48:04.920</a></span> | <span class="t">each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2885" target="_blank">00:48:05.920</a></span> | <span class="t">They gave predictions that weren't correlated with each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2888" target="_blank">00:48:08.680</a></span> | <span class="t">That would mean that the five models would have to have found different insights into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2894" target="_blank">00:48:14.360</a></span> | <span class="t">the relationships in the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2896" target="_blank">00:48:16.840</a></span> | <span class="t">And so if you took the average of those five models, then you're effectively bringing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2902" target="_blank">00:48:22.240</a></span> | <span class="t">the insights from each of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2905" target="_blank">00:48:25.260</a></span> | <span class="t">And so this idea of averaging models is a technique for ensembling, which is really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2913" target="_blank">00:48:33.160</a></span> | <span class="t">important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2915" target="_blank">00:48:35.760</a></span> | <span class="t">Now let's come up with a more specific idea of how to do this ensembling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2920" target="_blank">00:48:40.240</a></span> | <span class="t">What if we created a whole lot of these trees, big, deep, massively overfit trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2930" target="_blank">00:48:50.240</a></span> | <span class="t">But each one, let's say we only pick a random one-tenth of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2936" target="_blank">00:48:56.500</a></span> | <span class="t">So we pick one out of every ten rows at random, build a deep tree, which is perfect on that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2944" target="_blank">00:49:04.640</a></span> | <span class="t">subset and kind of crappy on the rest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2948" target="_blank">00:49:08.880</a></span> | <span class="t">Let's say we do that 100 times, a different random sample every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2953" target="_blank">00:49:13.760</a></span> | <span class="t">So all of the trees are going to be better than nothing because they do actually have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2957" target="_blank">00:49:17.360</a></span> | <span class="t">a real random subset of the data and so they found some insight, but they're also overfitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2961" target="_blank">00:49:21.720</a></span> | <span class="t">terribly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2962" target="_blank">00:49:22.720</a></span> | <span class="t">But they're all using different random samples, so they all overfit in different ways on different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2967" target="_blank">00:49:27.240</a></span> | <span class="t">things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2968" target="_blank">00:49:28.240</a></span> | <span class="t">So in other words, they all have errors, but the errors are random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2974" target="_blank">00:49:34.920</a></span> | <span class="t">What is the average of a bunch of random errors?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2979" target="_blank">00:49:39.320</a></span> | <span class="t">Zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2980" target="_blank">00:49:40.960</a></span> | <span class="t">So in other words, if we take the average of these trees, each of which have been trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2985" target="_blank">00:49:45.720</a></span> | <span class="t">on a different random subset, the errors will average out to zero, and what's left is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2991" target="_blank">00:49:51.000</a></span> | <span class="t">true relationship.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2993" target="_blank">00:49:53.400</a></span> | <span class="t">And that's the random forest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2995" target="_blank">00:49:55.520</a></span> | <span class="t">So there's the technique.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=2998" target="_blank">00:49:58.080</a></span> | <span class="t">We've got a whole bunch of rows of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3001" target="_blank">00:50:01.520</a></span> | <span class="t">We grab a few at random, put them into a smaller data set, and build a tree based on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3012" target="_blank">00:50:12.200</a></span> | <span class="t">And then we put that tree aside and do it again with a different random subset, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3017" target="_blank">00:50:17.800</a></span> | <span class="t">do it again with a different random subset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3020" target="_blank">00:50:20.440</a></span> | <span class="t">Do it a whole bunch of times, and then for each one we can then make predictions by running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3026" target="_blank">00:50:26.480</a></span> | <span class="t">our test data through the tree to get to the leaf node, take the average in that leaf node</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3032" target="_blank">00:50:32.360</a></span> | <span class="t">for all the trees, and average them all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3037" target="_blank">00:50:37.360</a></span> | <span class="t">So to do that, we simply call random forest regressor, and by default it creates 10 what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3044" target="_blank">00:50:44.880</a></span> | <span class="t">scikit-learn calls estimators.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3047" target="_blank">00:50:47.000</a></span> | <span class="t">An estimator is a tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3049" target="_blank">00:50:49.840</a></span> | <span class="t">So this is going to create 10 trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3054" target="_blank">00:50:54.800</a></span> | <span class="t">And so we go ahead and train it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3071" target="_blank">00:51:11.240</a></span> | <span class="t">So create our 10 trees, and we're just doing this on our little random subset of 20,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3077" target="_blank">00:51:17.880</a></span> | <span class="t">And so let's take a look at one example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3082" target="_blank">00:51:22.000</a></span> | <span class="t">When you pass the box to Devin.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3085" target="_blank">00:51:25.920</a></span> | <span class="t">Just to make sure I'm understanding this, you're saying we take 10 kind of crappy models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3091" target="_blank">00:51:31.160</a></span> | <span class="t">We average 10 crappy models, and we get a good model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3094" target="_blank">00:51:34.240</a></span> | <span class="t">Exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3095" target="_blank">00:51:35.240</a></span> | <span class="t">Because the crappy models are based on different random subsets, and so their errors are not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3100" target="_blank">00:51:40.480</a></span> | <span class="t">correlated with each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3102" target="_blank">00:51:42.340</a></span> | <span class="t">If the errors work correlated with each other, this isn't going to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3106" target="_blank">00:51:46.320</a></span> | <span class="t">So the key insight here is to construct multiple models which are better than nothing, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3112" target="_blank">00:51:52.500</a></span> | <span class="t">where the errors are as much as possible, not correlated with each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3118" target="_blank">00:51:58.060</a></span> | <span class="t">So is there like a certain number of trees that we need that in order to be valid?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3122" target="_blank">00:52:02.240</a></span> | <span class="t">There's always this thing that's valid or invalid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3125" target="_blank">00:52:05.760</a></span> | <span class="t">There's like, has a good validation set, RMSE, or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3131" target="_blank">00:52:11.880</a></span> | <span class="t">And so that's what we're going to look at, is how to make that metric higher.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3135" target="_blank">00:52:15.760</a></span> | <span class="t">And so this is the first of our hyperparameters, and we're going to learn about how to tune</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3141" target="_blank">00:52:21.240</a></span> | <span class="t">hyperparameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3142" target="_blank">00:52:22.240</a></span> | <span class="t">And the first one is going to be the number of trees, and we're about to look at that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3145" target="_blank">00:52:25.200</a></span> | <span class="t">now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3146" target="_blank">00:52:26.200</a></span> | <span class="t">Yes, Maisly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3147" target="_blank">00:52:27.200</a></span> | <span class="t">The subset that you're selecting, are they exclusive?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3153" target="_blank">00:52:33.560</a></span> | <span class="t">Can you have overlapping over them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3155" target="_blank">00:52:35.040</a></span> | <span class="t">Yes, so I mentioned one approach would be to pick out a 10th at random, but actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3161" target="_blank">00:52:41.240</a></span> | <span class="t">what Scikit-learn does by default is for n rows, it picks out n rows with replacement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3169" target="_blank">00:52:49.680</a></span> | <span class="t">And that's called bootstrapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3171" target="_blank">00:52:51.480</a></span> | <span class="t">And if memory serves me correctly, that gets you an average 63.2% of the rows will be represented,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3178" target="_blank">00:52:58.760</a></span> | <span class="t">and a bunch of them will be represented multiple times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3185" target="_blank">00:53:05.880</a></span> | <span class="t">So rather than just picking out like a 10th of the rows at random, instead we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3190" target="_blank">00:53:10.800</a></span> | <span class="t">to pick out of an n row data set, we're going to pick out n rows with replacement, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3197" target="_blank">00:53:17.160</a></span> | <span class="t">on average gets about 63, I think 63.2% of the rows will be represented, many of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3204" target="_blank">00:53:24.120</a></span> | <span class="t">rows will appear multiple times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3206" target="_blank">00:53:26.440</a></span> | <span class="t">I think there's a question behind you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3213" target="_blank">00:53:33.000</a></span> | <span class="t">In essence, what this model is doing is, if I understand correctly, is just picking out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3217" target="_blank">00:53:37.200</a></span> | <span class="t">the data points that look most similar to the one you're looking at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3221" target="_blank">00:53:41.360</a></span> | <span class="t">Yeah, that's a great insight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3223" target="_blank">00:53:43.320</a></span> | <span class="t">So what a tree is kind of doing, there would be other ways of assessing similarity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3231" target="_blank">00:53:51.640</a></span> | <span class="t">There are other ways of assessing similarity, but what's interesting about this way is it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3235" target="_blank">00:53:55.880</a></span> | <span class="t">doing it in tree space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3239" target="_blank">00:53:59.720</a></span> | <span class="t">So we're basically saying, in this case, for this little tree, what are the 593 samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3245" target="_blank">00:54:05.200</a></span> | <span class="t">closest to this one, and what's their average closest in tree space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3249" target="_blank">00:54:09.360</a></span> | <span class="t">So other ways of doing that would be like, and we'll learn later on in this course about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3253" target="_blank">00:54:13.200</a></span> | <span class="t">k nearest neighbors, you could use Euclidean distance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3259" target="_blank">00:54:19.440</a></span> | <span class="t">But here's the thing, the whole point of machine learning is to identify which variables actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3267" target="_blank">00:54:27.080</a></span> | <span class="t">matter the most, and how do they relate to each other and your dependent variable together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3273" target="_blank">00:54:33.840</a></span> | <span class="t">So imagine a synthetic dataset where you create 5 variables that add together to create your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3280" target="_blank">00:54:40.960</a></span> | <span class="t">dependent variable, and 95 variables which are entirely random and don't impact your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3286" target="_blank">00:54:46.040</a></span> | <span class="t">dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3287" target="_blank">00:54:47.280</a></span> | <span class="t">And then if you do like a k nearest neighbors in Euclidean space, you're going to get meaningless</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3292" target="_blank">00:54:52.040</a></span> | <span class="t">nearest neighbors because most of your columns are actually meaningless.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3296" target="_blank">00:54:56.080</a></span> | <span class="t">Or imagine your actual relationship is that your dependent variable equals x_1 times x_2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3302" target="_blank">00:55:02.840</a></span> | <span class="t">And you'll actually need to find this interaction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3306" target="_blank">00:55:06.400</a></span> | <span class="t">So you don't actually care about how close it is to x_1 and how close to x_2, but how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3310" target="_blank">00:55:10.240</a></span> | <span class="t">close to the product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3311" target="_blank">00:55:11.800</a></span> | <span class="t">So the entire purpose of modeling in machine learning is to find a model which tells you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3318" target="_blank">00:55:18.020</a></span> | <span class="t">which variables are important and how do they interact together to drive your dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3321" target="_blank">00:55:21.720</a></span> | <span class="t">variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3323" target="_blank">00:55:23.600</a></span> | <span class="t">And so you'll find in practice the difference between using tree space, or random forest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3330" target="_blank">00:55:30.520</a></span> | <span class="t">space to find your nearest neighbors, versus Euclidean space is the difference between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3335" target="_blank">00:55:35.560</a></span> | <span class="t">a model that makes good predictions and a model that makes meaningless predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3342" target="_blank">00:55:42.160</a></span> | <span class="t">In general, a machine learning model which is effective is one which is accurate when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3367" target="_blank">00:56:07.600</a></span> | <span class="t">you look at the training data, it's accurate at actually finding the relationships in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3374" target="_blank">00:56:14.280</a></span> | <span class="t">training data, and then it generalizes well to new data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3379" target="_blank">00:56:19.320</a></span> | <span class="t">And so in bagging, that means that each of your individual estimators, each of your individual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3386" target="_blank">00:56:26.240</a></span> | <span class="t">trees, you want to be as predictive as possible, but the predictions of your individual trees</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3392" target="_blank">00:56:32.920</a></span> | <span class="t">to be as uncorrelated as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3395" target="_blank">00:56:35.400</a></span> | <span class="t">And so the inventor of random forests talks about this at length in his original paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3399" target="_blank">00:56:39.360</a></span> | <span class="t">that introduced this in the late 90s, this idea of trying to come up with predictive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3404" target="_blank">00:56:44.960</a></span> | <span class="t">but poorly correlated trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3408" target="_blank">00:56:48.000</a></span> | <span class="t">The research community in recent years has generally found that the more important thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3416" target="_blank">00:56:56.240</a></span> | <span class="t">seems to be creating uncorrelated trees rather than more accurate trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3422" target="_blank">00:57:02.040</a></span> | <span class="t">So more recent advances tend to create trees which are less predictive on their own, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3427" target="_blank">00:57:07.960</a></span> | <span class="t">also less correlated with each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3430" target="_blank">00:57:10.000</a></span> | <span class="t">So for example, in scikit-learn there's another class you can use called extra-trees-aggressor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3437" target="_blank">00:57:17.000</a></span> | <span class="t">or extra-trees-classifier with exactly the same API, you can try it tonight, just replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3441" target="_blank">00:57:21.360</a></span> | <span class="t">my random forest-aggressor with that, that's called an extremely randomized trees model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3448" target="_blank">00:57:28.120</a></span> | <span class="t">And what that does is exactly the same as what we just discussed, but rather than trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3452" target="_blank">00:57:32.160</a></span> | <span class="t">every split of every variable, it randomly tries a few splits of a few variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3459" target="_blank">00:57:39.080</a></span> | <span class="t">So it's much faster to train, it has more randomness, but then with that time you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3465" target="_blank">00:57:45.640</a></span> | <span class="t">build more trees and therefore get better generalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3470" target="_blank">00:57:50.880</a></span> | <span class="t">So in practice, if you've got crappy individual models you just need more trees to get a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3476" target="_blank">00:57:56.560</a></span> | <span class="t">end-up model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3477" target="_blank">00:57:57.560</a></span> | <span class="t">Okay, so could you pass that over to Devin?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3480" target="_blank">00:58:00.760</a></span> | <span class="t">Could you talk a little bit more about what you mean by uncorrelated trees?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3490" target="_blank">00:58:10.860</a></span> | <span class="t">If I build a thousand trees, each one on just 10 data points, then it's quite likely that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3499" target="_blank">00:58:19.960</a></span> | <span class="t">the 10 data points for every tree are going to be totally different, and so it's quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3503" target="_blank">00:58:23.720</a></span> | <span class="t">likely that those 1000 trees are going to give totally different answers to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3510" target="_blank">00:58:30.200</a></span> | <span class="t">So the correlation between the predictions of tree 1 and tree 2 is going to be very small,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3515" target="_blank">00:58:35.400</a></span> | <span class="t">between tree 1 and tree 3 very small, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3518" target="_blank">00:58:38.400</a></span> | <span class="t">On the other hand, if I create a thousand trees where each time I use the entire data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3523" target="_blank">00:58:43.600</a></span> | <span class="t">set with just one element removed, all those trees are going to be nearly identical, i.e.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3529" target="_blank">00:58:49.760</a></span> | <span class="t">their predictions will be highly correlated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3532" target="_blank">00:58:52.480</a></span> | <span class="t">And so in the latter case, it's probably not going to generalize very well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3536" target="_blank">00:58:56.680</a></span> | <span class="t">Whereas in the former case, the individual trees are not going to be very predictive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3541" target="_blank">00:59:01.120</a></span> | <span class="t">So I need to find some nice in-between.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3548" target="_blank">00:59:08.920</a></span> | <span class="t">I'm just trying to understand how this random forest actually makes sense for continuous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3577" target="_blank">00:59:37.720</a></span> | <span class="t">variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3578" target="_blank">00:59:38.720</a></span> | <span class="t">I mean, I'm assuming that you build a tree structure, and the last final nodes you'd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3582" target="_blank">00:59:42.720</a></span> | <span class="t">be saying like maybe this node represents maybe a category A or a category B, but how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3588" target="_blank">00:59:48.160</a></span> | <span class="t">does it make sense for a continuous target?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3590" target="_blank">00:59:50.320</a></span> | <span class="t">So this is actually what we have here, and so the value here is the average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3596" target="_blank">00:59:56.480</a></span> | <span class="t">So this is the average log of price for this subgroup, and that's all we do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3602" target="_blank">01:00:02.640</a></span> | <span class="t">The prediction is the average of the value of the dependent variable in that leaf node.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3617" target="_blank">01:00:17.600</a></span> | <span class="t">So a couple of things to remember, the first is that by default, we're actually going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3620" target="_blank">01:00:20.800</a></span> | <span class="t">train the tree all the way down until the leaf nodes are size 1, which means for a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3627" target="_blank">01:00:27.280</a></span> | <span class="t">set with n rows, we're going to have n leaf nodes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3630" target="_blank">01:00:30.920</a></span> | <span class="t">And then we're going to have multiple trees, which we averaged together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3635" target="_blank">01:00:35.120</a></span> | <span class="t">So in practice, we're going to have lots of different possible values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3640" target="_blank">01:00:40.720</a></span> | <span class="t">There's a question behind you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3645" target="_blank">01:00:45.360</a></span> | <span class="t">So for the continuous variable, how do we decide which value to split out because there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3649" target="_blank">01:00:49.400</a></span> | <span class="t">can be many values?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3650" target="_blank">01:00:50.520</a></span> | <span class="t">We try every possible value of that in the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3655" target="_blank">01:00:55.480</a></span> | <span class="t">Won't it be computationally?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3658" target="_blank">01:00:58.440</a></span> | <span class="t">Computationally expensive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3659" target="_blank">01:00:59.440</a></span> | <span class="t">This is where it's very good to remember that your CPU's performance is measured in gigahertz,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3665" target="_blank">01:01:05.600</a></span> | <span class="t">which is billions of clock cycles per second, and it has multiple cores.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3670" target="_blank">01:01:10.480</a></span> | <span class="t">And each core has something called SIMD, single instruction multiple data, where it can direct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3675" target="_blank">01:01:15.840</a></span> | <span class="t">up to 8 computations per core at once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3679" target="_blank">01:01:19.460</a></span> | <span class="t">And then if you do it on the GPU, the performance is measured in teraflops, so trillions of floating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3686" target="_blank">01:01:26.920</a></span> | <span class="t">point operations per second.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3688" target="_blank">01:01:28.560</a></span> | <span class="t">And so this is where when it comes to designing algorithms, it's very difficult for us mere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3695" target="_blank">01:01:35.000</a></span> | <span class="t">humans to realize how stupid algorithms should be, given how fast today's computers are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3702" target="_blank">01:01:42.520</a></span> | <span class="t">So yeah, it's quite a few operations, but at trillions per second, you hardly notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3708" target="_blank">01:01:48.520</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3709" target="_blank">01:01:49.520</a></span> | <span class="t">Marcia?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3710" target="_blank">01:01:50.520</a></span> | <span class="t">I have a question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3713" target="_blank">01:01:53.680</a></span> | <span class="t">So essentially, at each mode, we make a decision like which category, which variable to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3721" target="_blank">01:02:01.920</a></span> | <span class="t">And which checkpoint?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3722" target="_blank">01:02:02.920</a></span> | <span class="t">Yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3723" target="_blank">01:02:03.920</a></span> | <span class="t">Yeah, but one thing I can't understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3726" target="_blank">01:02:06.800</a></span> | <span class="t">So we have MSE calculated for each node, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3731" target="_blank">01:02:11.800</a></span> | <span class="t">So this is kind of one of the decision criteria.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3734" target="_blank">01:02:14.720</a></span> | <span class="t">But this MSE, it is calculated for which model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3738" target="_blank">01:02:18.200</a></span> | <span class="t">Like which model underlies the field?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3741" target="_blank">01:02:21.960</a></span> | <span class="t">The model is, for the initial root mode, is what if we just predicted the average, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3750" target="_blank">01:02:30.720</a></span> | <span class="t">Which here is 10.098, and just the average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3755" target="_blank">01:02:35.200</a></span> | <span class="t">And then the next model is what if we predicted the average of those people with Kepler system</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3760" target="_blank">01:02:40.640</a></span> | <span class="t">equals false, and for those people with Kepler system equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3765" target="_blank">01:02:45.760</a></span> | <span class="t">And then the next is, what if we predicted the average of Kepler system equals true,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3769" target="_blank">01:02:49.840</a></span> | <span class="t">EMA less than 1986?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3772" target="_blank">01:02:52.200</a></span> | <span class="t">Is it always average, or we can use median, or we can even run linear regression?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3778" target="_blank">01:02:58.040</a></span> | <span class="t">There's all kinds of things we could do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3779" target="_blank">01:02:59.640</a></span> | <span class="t">In practice, the average works really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3785" target="_blank">01:03:05.000</a></span> | <span class="t">There are types of, they're not called random forests, but there are kinds of trees where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3788" target="_blank">01:03:08.960</a></span> | <span class="t">the leaf nodes are independent linear regressions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3792" target="_blank">01:03:12.240</a></span> | <span class="t">They're not terribly widely used, but there are certainly researchers who have worked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3796" target="_blank">01:03:16.320</a></span> | <span class="t">on them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3797" target="_blank">01:03:17.320</a></span> | <span class="t">Pass it back over there to Ford, and then to Jacob.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3805" target="_blank">01:03:25.520</a></span> | <span class="t">So this tree has a depth of 3, and then on one of the next commands we get rid of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3812" target="_blank">01:03:32.160</a></span> | <span class="t">max depth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3813" target="_blank">01:03:33.360</a></span> | <span class="t">The tree without the max depth, does that contain the tree with the depth of 3?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3820" target="_blank">01:03:40.320</a></span> | <span class="t">Yeah, except in this case we've added randomness, but if you turn bootstrapping off, the deeper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3828" target="_blank">01:03:48.280</a></span> | <span class="t">tree will, the less deep tree would be how it would start, and then it just keeps spinning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3840" target="_blank">01:04:00.320</a></span> | <span class="t">So you have many trees, you're going to have different leaf nodes across trees, hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3845" target="_blank">01:04:05.840</a></span> | <span class="t">that's what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3847" target="_blank">01:04:07.280</a></span> | <span class="t">So how do you average leaf nodes across different trees?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3851" target="_blank">01:04:11.980</a></span> | <span class="t">So we just take the first row in the validation set, we run it through the first tree, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3858" target="_blank">01:04:18.240</a></span> | <span class="t">find its average, 9.28.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3861" target="_blank">01:04:21.000</a></span> | <span class="t">Then do it through the next tree, find its average in the second tree, 9.95, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3866" target="_blank">01:04:26.280</a></span> | <span class="t">And we're about to do that, so you'll see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3869" target="_blank">01:04:29.200</a></span> | <span class="t">So let's try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3871" target="_blank">01:04:31.360</a></span> | <span class="t">So after you've built a random forest, each tree is stored in this attribute called estimators_.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3880" target="_blank">01:04:40.880</a></span> | <span class="t">So one of the things that you guys need to be very comfortable with is using list comprehensions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3887" target="_blank">01:04:47.760</a></span> | <span class="t">so I hope you've all been practicing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3889" target="_blank">01:04:49.720</a></span> | <span class="t">So here I'm using a list comprehension to go through each tree in my model, I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3894" target="_blank">01:04:54.280</a></span> | <span class="t">to call predict on it with my validation set, and so that's going to give me a list of arrays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3902" target="_blank">01:05:02.360</a></span> | <span class="t">of predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3904" target="_blank">01:05:04.880</a></span> | <span class="t">So each array will be all of the predictions for that tree, and I have 10 trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3911" target="_blank">01:05:11.200</a></span> | <span class="t">np.stack concatenates them together on a new axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3916" target="_blank">01:05:16.120</a></span> | <span class="t">So after I run this and call .shape, you can see I now have the first axis 10, which means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3925" target="_blank">01:05:25.600</a></span> | <span class="t">I have my 10 different sets of predictions, and for each one my validation set is a size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3930" target="_blank">01:05:30.760</a></span> | <span class="t">of 12,000, so here are my 12,000 predictions for each of the 10 trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3937" target="_blank">01:05:37.400</a></span> | <span class="t">So let's take the first row of that and print it out, and so here are 10 predictions, one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3947" target="_blank">01:05:47.880</a></span> | <span class="t">from each tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3950" target="_blank">01:05:50.160</a></span> | <span class="t">And so then if we say take the mean of that, here is the mean of those 10 predictions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3957" target="_blank">01:05:57.180</a></span> | <span class="t">and then what was the actual?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3959" target="_blank">01:05:59.120</a></span> | <span class="t">The actual was 9.1, our prediction was 9.07.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3963" target="_blank">01:06:03.020</a></span> | <span class="t">So you see how none of our individual trees had very good predictions, but the mean of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3968" target="_blank">01:06:08.320</a></span> | <span class="t">them was actually pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3970" target="_blank">01:06:10.920</a></span> | <span class="t">And so when I talk about experimenting, like Jupyter Notebook is great for experimenting,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3976" target="_blank">01:06:16.720</a></span> | <span class="t">this is the kind of stuff I mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3978" target="_blank">01:06:18.320</a></span> | <span class="t">Dig inside these objects and look at them, plot them, take your own averages, cross-check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3983" target="_blank">01:06:23.720</a></span> | <span class="t">to make sure that they work the way you thought they did, write your own implementation of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3987" target="_blank">01:06:27.720</a></span> | <span class="t">R^2, make sure it's the same as a scikit-learn version, plot it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3992" target="_blank">01:06:32.240</a></span> | <span class="t">Here's an interesting plot I did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=3994" target="_blank">01:06:34.320</a></span> | <span class="t">Let's go through each of the 10 trees and then take the mean of all of the predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4001" target="_blank">01:06:41.800</a></span> | <span class="t">up to the i-th tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4004" target="_blank">01:06:44.840</a></span> | <span class="t">So let's start by predicting just based on the first tree, then the first 2 trees, then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4009" target="_blank">01:06:49.920</a></span> | <span class="t">the first 3 trees, and let's then plot the R^2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4015" target="_blank">01:06:55.080</a></span> | <span class="t">So here's the R^2 of just the first tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4017" target="_blank">01:06:57.800</a></span> | <span class="t">It's the R^2 of the first 2 trees, 3 trees, 4 trees, up to 10 trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4023" target="_blank">01:07:03.400</a></span> | <span class="t">And so not surprisingly R^2 keeps improving because the more estimators we have, the more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4030" target="_blank">01:07:10.760</a></span> | <span class="t">bagging that we're doing, the more it's going to generalize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4035" target="_blank">01:07:15.920</a></span> | <span class="t">And you should find that that number there, a bit under 0.86, should match this number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4042" target="_blank">01:07:22.920</a></span> | <span class="t">here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4043" target="_blank">01:07:23.920</a></span> | <span class="t">So again, these are all the cross checks you can do, the things you can visualize to deepen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4054" target="_blank">01:07:34.660</a></span> | <span class="t">your understanding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4056" target="_blank">01:07:36.480</a></span> | <span class="t">So as we add more trees, our R^2 improves, it seems to flatten out after a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4062" target="_blank">01:07:42.460</a></span> | <span class="t">So we might guess that if we increase the number of estimators to 20, it's maybe not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4067" target="_blank">01:07:47.360</a></span> | <span class="t">going to be that much better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4073" target="_blank">01:07:53.720</a></span> | <span class="t">So let's see, we've got 0.862 versus 0.860, so doubling the number of trees didn't help</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4081" target="_blank">01:08:01.880</a></span> | <span class="t">very much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4082" target="_blank">01:08:02.960</a></span> | <span class="t">But double it again, 0.867, double it again, 0.869.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4089" target="_blank">01:08:09.080</a></span> | <span class="t">So you can see there's some point at which you're going to not want to add more trees,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4095" target="_blank">01:08:15.200</a></span> | <span class="t">not because it's never going to get worse, because every tree is giving you more semi-random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4103" target="_blank">01:08:23.120</a></span> | <span class="t">models to bag together, but it's going to stop improving things much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4108" target="_blank">01:08:28.880</a></span> | <span class="t">So this is like the first hyperparameter you'd learn to set is number of estimators, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4113" target="_blank">01:08:33.880</a></span> | <span class="t">the method for setting is as many as you have time to fit and that actually seem to be helping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4124" target="_blank">01:08:44.960</a></span> | <span class="t">Now in practice, we're going to learn to set a few more hyperparameters, adding more trees</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4130" target="_blank">01:08:50.780</a></span> | <span class="t">slows it down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4133" target="_blank">01:08:53.040</a></span> | <span class="t">But with less trees, you can still get the same insights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4136" target="_blank">01:08:56.920</a></span> | <span class="t">So I build most of my models in practice with like 20 to 30 trees, and it's only like then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4143" target="_blank">01:09:03.660</a></span> | <span class="t">at the end of the project, or maybe at the end of the day's work, I'll then try doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4147" target="_blank">01:09:07.640</a></span> | <span class="t">like a thousand trees and run it overnight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4151" target="_blank">01:09:11.040</a></span> | <span class="t">Was there a question?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4152" target="_blank">01:09:12.040</a></span> | <span class="t">Yes, can we pass that to Prince?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4158" target="_blank">01:09:18.680</a></span> | <span class="t">So each tree might have different estimators, different combinations of estimators.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4162" target="_blank">01:09:22.820</a></span> | <span class="t">Each tree is an estimator, so this is a synonym.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4164" target="_blank">01:09:24.960</a></span> | <span class="t">So in scikit-learn, when they say estimator, they mean tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4168" target="_blank">01:09:28.800</a></span> | <span class="t">So I mean features, each tree might have different breakpoints on different columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4174" target="_blank">01:09:34.720</a></span> | <span class="t">But if at the end we want to look at the important features?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4179" target="_blank">01:09:39.000</a></span> | <span class="t">We'll get to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4181" target="_blank">01:09:41.340</a></span> | <span class="t">So after we finish with setting hyperparameters, the next stage of the course will be learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4189" target="_blank">01:09:49.040</a></span> | <span class="t">about what it tells us about the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4192" target="_blank">01:09:52.320</a></span> | <span class="t">If you need to know it now, for your projects, feel free to look ahead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4197" target="_blank">01:09:57.240</a></span> | <span class="t">There's a lesson to RF interpretation is where we can see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4205" target="_blank">01:10:05.440</a></span> | <span class="t">So that's our first hyperparameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4208" target="_blank">01:10:08.600</a></span> | <span class="t">I want to talk next about out-of-bag score.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4212" target="_blank">01:10:12.120</a></span> | <span class="t">Sometimes your data set will be kind of small, and you want to pull out a validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4218" target="_blank">01:10:18.880</a></span> | <span class="t">Because doing so means you now don't have enough data to build a good model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4222" target="_blank">01:10:22.680</a></span> | <span class="t">What do you do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4224" target="_blank">01:10:24.560</a></span> | <span class="t">There's a cool trick which is pretty much unique to random forests, and it's this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4230" target="_blank">01:10:30.280</a></span> | <span class="t">What we could do is recognize that some of our rows didn't get used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4243" target="_blank">01:10:43.480</a></span> | <span class="t">So what we could do would be to pass those rows through the first tree and treat it as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4250" target="_blank">01:10:50.920</a></span> | <span class="t">a validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4253" target="_blank">01:10:53.640</a></span> | <span class="t">And then for the second tree, we could pass through the rows that weren't used for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4257" target="_blank">01:10:57.640</a></span> | <span class="t">second tree through it to create a validation set for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4261" target="_blank">01:11:01.480</a></span> | <span class="t">And so effectively, we would have a different validation set for each tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4266" target="_blank">01:11:06.560</a></span> | <span class="t">And so now to calculate our prediction, we would average all of the trees where that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4274" target="_blank">01:11:14.160</a></span> | <span class="t">row was not used for training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4277" target="_blank">01:11:17.640</a></span> | <span class="t">So for tree number 1, we would have the ones I've marked in blue here, and then maybe for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4283" target="_blank">01:11:23.520</a></span> | <span class="t">tree number 2, it turned out it was like this one, this one, this one, and this one, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4290" target="_blank">01:11:30.320</a></span> | <span class="t">so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4291" target="_blank">01:11:31.480</a></span> | <span class="t">So as long as you've got enough trees, every row is going to appear in the out-of-bag sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4297" target="_blank">01:11:37.520</a></span> | <span class="t">for one of them, at least.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4299" target="_blank">01:11:39.040</a></span> | <span class="t">So you'll be averaging hopefully a few trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4302" target="_blank">01:11:42.760</a></span> | <span class="t">So if you've got 100 trees, it's very likely that all of the rows are going to appear many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4310" target="_blank">01:11:50.820</a></span> | <span class="t">times in these out-of-bag samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4313" target="_blank">01:11:53.280</a></span> | <span class="t">So what you can do is you can create an out-of-bag prediction by averaging all of the trees you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4318" target="_blank">01:11:58.000</a></span> | <span class="t">didn't use to train each individual row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4321" target="_blank">01:12:01.160</a></span> | <span class="t">And then you can calculate your root mean squared error, R squared, etc. on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4326" target="_blank">01:12:06.920</a></span> | <span class="t">If you pass oobscore = true to scikit-learn, it will do that for you, and it will create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4334" target="_blank">01:12:14.680</a></span> | <span class="t">an attribute called oobscore_ and so my little printScore function here, if that attribute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4345" target="_blank">01:12:25.500</a></span> | <span class="t">exists it adds it to the print.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4349" target="_blank">01:12:29.340</a></span> | <span class="t">So if you take a look here, oobscore = true, we've now got one extra number, and it's R</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4358" target="_blank">01:12:38.480</a></span> | <span class="t">squared, that is the R squared for the oob sample, it's R squared is very similar, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4364" target="_blank">01:12:44.280</a></span> | <span class="t">R squared and the validation set, which is what we hoped for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4372" target="_blank">01:12:52.100</a></span> | <span class="t">Is it the case that the prediction for the oobscore must be mathematically lower than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4379" target="_blank">01:12:59.320</a></span> | <span class="t">the one for our entire forest?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4380" target="_blank">01:13:00.840</a></span> | <span class="t">Certainly it's not true that the prediction is lower, it's possible that the accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4386" target="_blank">01:13:06.080</a></span> | <span class="t">is lower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4389" target="_blank">01:13:09.360</a></span> | <span class="t">It's not mathematically necessary that it's true, but it's going to be true on average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4393" target="_blank">01:13:13.680</a></span> | <span class="t">because each row appears in less trees in the oob samples than it does in the full set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4400" target="_blank">01:13:20.560</a></span> | <span class="t">of trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4401" target="_blank">01:13:21.560</a></span> | <span class="t">So as you see here, it's a little less good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4405" target="_blank">01:13:25.760</a></span> | <span class="t">So in general, the OOB R squared will slightly underestimate how generalizable the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4414" target="_blank">01:13:34.640</a></span> | <span class="t">is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4415" target="_blank">01:13:35.640</a></span> | <span class="t">The more trees you add, the less serious that underestimation is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4420" target="_blank">01:13:40.080</a></span> | <span class="t">And for me in practice, I find it's totally good enough in practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4428" target="_blank">01:13:48.560</a></span> | <span class="t">So this OOB score is super handy, and one of the things it's super handy for is you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4438" target="_blank">01:13:58.760</a></span> | <span class="t">going to see there's quite a few hyperparameters that we're going to set, and we would like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4443" target="_blank">01:14:03.740</a></span> | <span class="t">to find some automated way to set them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4447" target="_blank">01:14:07.920</a></span> | <span class="t">And one way to do that is to do what's called a grid search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4450" target="_blank">01:14:10.280</a></span> | <span class="t">A grid search is where there's a scikit-learn function called grid search, and you pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4456" target="_blank">01:14:16.020</a></span> | <span class="t">in the list of all of the hyperparameters that you want to tune, you pass in for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4460" target="_blank">01:14:20.840</a></span> | <span class="t">one a list of all of the values of that hyperparameter you want to try, and it runs your model on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4467" target="_blank">01:14:27.160</a></span> | <span class="t">every possible combination of all of those hyperparameters and tells you which one is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4472" target="_blank">01:14:32.000</a></span> | <span class="t">the best.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4473" target="_blank">01:14:33.320</a></span> | <span class="t">And OOB score is a great choice for getting it to tell you which one is best in terms</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4480" target="_blank">01:14:40.640</a></span> | <span class="t">of OOB score.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4482" target="_blank">01:14:42.200</a></span> | <span class="t">That's an example of something you can do with OOB which works well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4492" target="_blank">01:14:52.560</a></span> | <span class="t">If you think about it, I kind of did something pretty dumb earlier, which is I took a subset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4500" target="_blank">01:15:00.080</a></span> | <span class="t">of 30,000 rows of the data and it built all my models of that, which means every tree</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4506" target="_blank">01:15:06.480</a></span> | <span class="t">in my random forest is a different subset of that subset of 30,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4513" target="_blank">01:15:13.560</a></span> | <span class="t">Why do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4514" target="_blank">01:15:14.840</a></span> | <span class="t">Why not pick a totally different subset of 30,000 each time?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4522" target="_blank">01:15:22.080</a></span> | <span class="t">So in other words, let's leave the entire 300,000 records as is, and if I want to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4527" target="_blank">01:15:27.320</a></span> | <span class="t">things faster, pick a different subset of 30,000 each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4531" target="_blank">01:15:31.880</a></span> | <span class="t">So rather than bootstrapping the entire set of rows, let's just randomly sample a subset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4537" target="_blank">01:15:37.880</a></span> | <span class="t">of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4539" target="_blank">01:15:39.480</a></span> | <span class="t">And so we can do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4541" target="_blank">01:15:41.880</a></span> | <span class="t">So let's go back and recall property F without the subset parameter to get all of our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4546" target="_blank">01:15:46.920</a></span> | <span class="t">again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4547" target="_blank">01:15:47.920</a></span> | <span class="t">So to remind you, that is 400,000 in the whole data frame of which we have 389,000 in our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4561" target="_blank">01:16:01.640</a></span> | <span class="t">training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4563" target="_blank">01:16:03.760</a></span> | <span class="t">And instead we're going to go set RF_samples 20,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4569" target="_blank">01:16:09.000</a></span> | <span class="t">Remember that was the site of the 30,000, we used 20,000 of them in our training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4573" target="_blank">01:16:13.680</a></span> | <span class="t">If I do this, then now when I run a random forest, it's not going to bootstrap an entire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4580" target="_blank">01:16:20.360</a></span> | <span class="t">set of 391,000 rows, it's going to just grab a subset of 20,000 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4588" target="_blank">01:16:28.480</a></span> | <span class="t">And so now if I run this, it will still run just as quickly as if I had originally done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4595" target="_blank">01:16:35.520</a></span> | <span class="t">a random sample of 20,000, but now every tree can have access to the whole data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4602" target="_blank">01:16:42.560</a></span> | <span class="t">So if I do enough estimators, enough trees, eventually it's going to see everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4609" target="_blank">01:16:49.600</a></span> | <span class="t">So in this case, with 10 trees, which is the default, I get an R^2 of 0.86, which is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4617" target="_blank">01:16:57.880</a></span> | <span class="t">about the same as my R^2 with the 20,000 subset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4623" target="_blank">01:17:03.640</a></span> | <span class="t">And that's because I haven't used many estimators yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4626" target="_blank">01:17:06.400</a></span> | <span class="t">But if I increase the number of estimators, it's going to make more of a difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4631" target="_blank">01:17:11.200</a></span> | <span class="t">So if I increase the number of estimators to 40, it's going to take a little bit longer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4639" target="_blank">01:17:19.920</a></span> | <span class="t">to run, but it's going to be able to see a larger subset of the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4646" target="_blank">01:17:26.200</a></span> | <span class="t">And so as you can see, the R^2 has gone up from 0.86 to 0.876.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4651" target="_blank">01:17:31.960</a></span> | <span class="t">So this is actually a great approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4653" target="_blank">01:17:33.960</a></span> | <span class="t">And for those of you who are doing the groceries competition, that's got something like 120</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4658" target="_blank">01:17:38.480</a></span> | <span class="t">million rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4659" target="_blank">01:17:39.480</a></span> | <span class="t">There's no way you would want to create a random forest using 128 million rows in every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4665" target="_blank">01:17:45.960</a></span> | <span class="t">tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4666" target="_blank">01:17:46.960</a></span> | <span class="t">It's going to take forever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4669" target="_blank">01:17:49.080</a></span> | <span class="t">So what you could do is use this set of samples to do 100,000 or a million.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4673" target="_blank">01:17:53.840</a></span> | <span class="t">We'll play around with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4675" target="_blank">01:17:55.860</a></span> | <span class="t">So the trick here is that with a random forest using this technique, no data set is too big.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4681" target="_blank">01:18:01.360</a></span> | <span class="t">I don't care if it's got 100 billion rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4685" target="_blank">01:18:05.080</a></span> | <span class="t">You can create a bunch of trees, each one of the different random subsets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4689" target="_blank">01:18:09.280</a></span> | <span class="t">Can somebody pass the-- actually, I can pass it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4700" target="_blank">01:18:20.720</a></span> | <span class="t">So my question was, for the OLB scores and these ones, does it take only for the ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4715" target="_blank">01:18:35.960</a></span> | <span class="t">from the sample, or does it take from all the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4718" target="_blank">01:18:38.560</a></span> | <span class="t">That's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4721" target="_blank">01:18:41.120</a></span> | <span class="t">So unfortunately, scikit-learn does not support this functionality out of the box, so I had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4727" target="_blank">01:18:47.280</a></span> | <span class="t">to write this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4729" target="_blank">01:18:49.920</a></span> | <span class="t">And it's kind of a horrible hack, because we'd much rather be passing in like a sample-sized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4735" target="_blank">01:18:55.640</a></span> | <span class="t">parameter rather than doing this kind of setting up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4738" target="_blank">01:18:58.580</a></span> | <span class="t">So what I actually do is, if you look at the source code, is I'm actually-- this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4745" target="_blank">01:19:05.680</a></span> | <span class="t">internal function I looked at the source code that they call, and I've replaced it with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4750" target="_blank">01:19:10.160</a></span> | <span class="t">a lambda function that has the behavior we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4753" target="_blank">01:19:13.600</a></span> | <span class="t">Unfortunately, the current version is not changing how OOB is calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4760" target="_blank">01:19:20.040</a></span> | <span class="t">So currently, OOB scores and setRF samples are not compatible with each other, so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4769" target="_blank">01:19:29.080</a></span> | <span class="t">need to turn OOB equals false if you use this approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4775" target="_blank">01:19:35.440</a></span> | <span class="t">Which I hope to fix, but at this stage it's not fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4780" target="_blank">01:19:40.000</a></span> | <span class="t">So if you want to turn it off, you just call resetRFSamples, and that returns it back to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4786" target="_blank">01:19:46.440</a></span> | <span class="t">what it was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4793" target="_blank">01:19:53.220</a></span> | <span class="t">So in practice, when I'm doing interactive machine learning using random forests in order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4803" target="_blank">01:20:03.380</a></span> | <span class="t">to explore my model, explore hyperparameters, the stuff we're going to learn in the future</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4807" target="_blank">01:20:07.880</a></span> | <span class="t">lesson where we actually analyze feature importance and partial dependence and so forth, I generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4813" target="_blank">01:20:13.440</a></span> | <span class="t">use subsets and reasonably small forests because all the insights that I'm going to get are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4822" target="_blank">01:20:22.120</a></span> | <span class="t">exactly the same as the big ones, but I can run it in like 3 or 4 seconds rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4827" target="_blank">01:20:27.800</a></span> | <span class="t">hours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4830" target="_blank">01:20:30.040</a></span> | <span class="t">So this is one of the biggest tips I can give you, and very few people in industry or academia</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4836" target="_blank">01:20:36.920</a></span> | <span class="t">actually do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4838" target="_blank">01:20:38.560</a></span> | <span class="t">Most people run all of their models on all of the data all of the time using their best</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4843" target="_blank">01:20:43.400</a></span> | <span class="t">possible parameters, which is just pointless.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4846" target="_blank">01:20:46.540</a></span> | <span class="t">If you're trying to find out which features are important and how are they related to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4849" target="_blank">01:20:49.440</a></span> | <span class="t">each other and so forth, having that fourth decimal place of accuracy isn't going to change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4854" target="_blank">01:20:54.860</a></span> | <span class="t">any of your insights at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4856" target="_blank">01:20:56.800</a></span> | <span class="t">So I would say do most of your models on a large enough sample size that your accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4863" target="_blank">01:21:03.360</a></span> | <span class="t">is reasonable, when I say reasonable it's like within a reasonable distance of the best</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4870" target="_blank">01:21:10.000</a></span> | <span class="t">accuracy you can get, and it's taking a small number of seconds to train so that you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4876" target="_blank">01:21:16.680</a></span> | <span class="t">interactively do your analysis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4879" target="_blank">01:21:19.760</a></span> | <span class="t">So there's a couple more parameters I wanted to talk about, so I'm going to call reset_rf_samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4883" target="_blank">01:21:23.720</a></span> | <span class="t">to get back to our full data set, because in this case, at least on this computer, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4888" target="_blank">01:21:28.040</a></span> | <span class="t">actually running in less than 10 seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4892" target="_blank">01:21:32.480</a></span> | <span class="t">So here's our baseline, we're going to do a baseline with 40 estimators, and so each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4900" target="_blank">01:21:40.520</a></span> | <span class="t">of those 40 estimators is going to train all the way down until the leaf nodes just have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4905" target="_blank">01:21:45.960</a></span> | <span class="t">one sample in them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4911" target="_blank">01:21:51.800</a></span> | <span class="t">So that's going to take a few seconds to run, here we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4915" target="_blank">01:21:55.320</a></span> | <span class="t">So that gets us a 0.898r^2 on the validation set, or 0.908 on the OOB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4925" target="_blank">01:22:05.000</a></span> | <span class="t">In this case, the OOB is better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4926" target="_blank">01:22:06.840</a></span> | <span class="t">Why is it better?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4927" target="_blank">01:22:07.840</a></span> | <span class="t">Well that's because remember our validation set is not a random sample, our validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4931" target="_blank">01:22:11.800</a></span> | <span class="t">set is a different time period, so it's actually much harder to predict a different time period</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4939" target="_blank">01:22:19.360</a></span> | <span class="t">than this one, which is just predicting random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4942" target="_blank">01:22:22.180</a></span> | <span class="t">So that's why this is not the way around we expected.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4947" target="_blank">01:22:27.360</a></span> | <span class="t">The first parameter we can try fiddling with is min_samples_leaf, and so min_samples_leaf</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4952" target="_blank">01:22:32.400</a></span> | <span class="t">says stop training the tree further when your leaf node has three or less samples in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4963" target="_blank">01:22:43.720</a></span> | <span class="t">So rather than going all the way down until there's one, we're going to go down until there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4969" target="_blank">01:22:49.200</a></span> | <span class="t">three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4970" target="_blank">01:22:50.200</a></span> | <span class="t">So in practice, this means there's going to be like one or two less levels of decision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4974" target="_blank">01:22:54.160</a></span> | <span class="t">being made, which means we've got like half the number of actual decision criteria we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4979" target="_blank">01:22:59.760</a></span> | <span class="t">have to do, so it's going to train more quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4982" target="_blank">01:23:02.480</a></span> | <span class="t">It means that when we look at an individual tree, rather than just taking one point, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4987" target="_blank">01:23:07.120</a></span> | <span class="t">taking the average of at least three points, that's where we'd expect the trees to generalize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4991" target="_blank">01:23:11.820</a></span> | <span class="t">each one a little bit better, but each tree is probably going to be slightly less powerful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4997" target="_blank">01:23:17.560</a></span> | <span class="t">on its own.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=4999" target="_blank">01:23:19.720</a></span> | <span class="t">So let's try training that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5002" target="_blank">01:23:22.980</a></span> | <span class="t">Possible values of min_samples_leaf, I find ones which work well are 1, 3, 5, 10, 25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5012" target="_blank">01:23:32.840</a></span> | <span class="t">I find that kind of range seems to work well, but sometimes if you've got a really big data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5019" target="_blank">01:23:39.000</a></span> | <span class="t">set and you're not using the small samples, you might need a min_samples_leaf of hundreds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5026" target="_blank">01:23:46.240</a></span> | <span class="t">or thousands.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5027" target="_blank">01:23:47.400</a></span> | <span class="t">So you've kind of got to think about how big are your subsamples going through and try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5032" target="_blank">01:23:52.440</a></span> | <span class="t">things out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5033" target="_blank">01:23:53.440</a></span> | <span class="t">In this case, going from the default of 1 to 3 has increased our validations at R squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5040" target="_blank">01:24:00.240</a></span> | <span class="t">from 898 to 902, so it's a slight improvement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5043" target="_blank">01:24:03.360</a></span> | <span class="t">And it's going to train a little faster as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5047" target="_blank">01:24:07.560</a></span> | <span class="t">Something else you can try, and since this worked, I'm going to leave that in, I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5051" target="_blank">01:24:11.840</a></span> | <span class="t">to add in max_features = 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5054" target="_blank">01:24:14.940</a></span> | <span class="t">What does max_features do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5057" target="_blank">01:24:17.560</a></span> | <span class="t">The idea is that the less correlated your trees are with each other, the better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5064" target="_blank">01:24:24.800</a></span> | <span class="t">Now imagine you had one column that was so much better than all of the other columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5071" target="_blank">01:24:31.680</a></span> | <span class="t">of being predictive that every single tree you built, regardless of which subset of rows,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5077" target="_blank">01:24:37.000</a></span> | <span class="t">always started with that column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5079" target="_blank">01:24:39.200</a></span> | <span class="t">So the trees are all going to be pretty similar, but you can imagine there might be some interaction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5085" target="_blank">01:24:45.240</a></span> | <span class="t">of variables where that interaction is more important than that individual column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5091" target="_blank">01:24:51.720</a></span> | <span class="t">So if every tree always fits on the first thing, the same thing the first time, you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5097" target="_blank">01:24:57.800</a></span> | <span class="t">not going to get much variation in those trees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5100" target="_blank">01:25:00.400</a></span> | <span class="t">So what we do is, in addition to just taking a subset of rows, we then at every single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5109" target="_blank">01:25:09.040</a></span> | <span class="t">split point take a different subset of columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5113" target="_blank">01:25:13.960</a></span> | <span class="t">So it's slightly different to the row sampling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5116" target="_blank">01:25:16.940</a></span> | <span class="t">For the row sampling, each new tree is based on a random set of rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5122" target="_blank">01:25:22.720</a></span> | <span class="t">For column sampling, every individual binary split we choose from a different subset of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5129" target="_blank">01:25:29.000</a></span> | <span class="t">columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5130" target="_blank">01:25:30.320</a></span> | <span class="t">So in other words, rather than looking at every possible level of every possible column,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5137" target="_blank">01:25:37.600</a></span> | <span class="t">we look at every possible level of a random subset of columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5143" target="_blank">01:25:43.180</a></span> | <span class="t">And each time, each decision point, each binary split, we use a different random subset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5150" target="_blank">01:25:50.200</a></span> | <span class="t">How many?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5151" target="_blank">01:25:51.200</a></span> | <span class="t">Well, you get to pick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5152" target="_blank">01:25:52.800</a></span> | <span class="t">Point 5 means randomly choose half of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5157" target="_blank">01:25:57.320</a></span> | <span class="t">The default is to use all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5160" target="_blank">01:26:00.960</a></span> | <span class="t">There's also a couple of special values you can use here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5167" target="_blank">01:26:07.240</a></span> | <span class="t">As you can see in max_features, you can also pass in square root to get square root of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5171" target="_blank">01:26:11.520</a></span> | <span class="t">features, or log_2 to get log_2 of features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5175" target="_blank">01:26:15.140</a></span> | <span class="t">So in practice, good values I found are range from 1, 0.5, log_2, or square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5184" target="_blank">01:26:24.600</a></span> | <span class="t">That's going to give you a nice bit of variation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5187" target="_blank">01:26:27.880</a></span> | <span class="t">Can somebody pass it to Daniel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5192" target="_blank">01:26:32.320</a></span> | <span class="t">So just to clarify, does that just break it up smaller each time it goes through the tree,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5197" target="_blank">01:26:37.840</a></span> | <span class="t">or is it just taking half of what's left over and hasn't been touched each time?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5202" target="_blank">01:26:42.240</a></span> | <span class="t">There's no such thing as what's left over.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5204" target="_blank">01:26:44.720</a></span> | <span class="t">After you've split on year made less than or greater than 1984, year made is still there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5211" target="_blank">01:26:51.280</a></span> | <span class="t">So later on you might then split on year made less than or greater than 1989.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5216" target="_blank">01:26:56.800</a></span> | <span class="t">So it's just each time, rather than checking every variable to see where it's best split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5220" target="_blank">01:27:00.920</a></span> | <span class="t">is, you just check half of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5223" target="_blank">01:27:03.440</a></span> | <span class="t">And so the next time you check a different half.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5227" target="_blank">01:27:07.160</a></span> | <span class="t">But I mean like in terms as you get further to the leafs, you're going to have less options,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5235" target="_blank">01:27:15.280</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5236" target="_blank">01:27:16.280</a></span> | <span class="t">No, you're not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5237" target="_blank">01:27:17.280</a></span> | <span class="t">You never remove the variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5238" target="_blank">01:27:18.560</a></span> | <span class="t">You can use them again and again and again because you've got lots of different split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5241" target="_blank">01:27:21.720</a></span> | <span class="t">points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5244" target="_blank">01:27:24.440</a></span> | <span class="t">So imagine for example that the relationship was just entirely linear between year made</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5249" target="_blank">01:27:29.560</a></span> | <span class="t">and price.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5250" target="_blank">01:27:30.560</a></span> | <span class="t">Then in practice to actually model that, your real relationship is year made versus price.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5260" target="_blank">01:27:40.580</a></span> | <span class="t">But the best we could do would be to first of all split here, and then to split here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5266" target="_blank">01:27:46.560</a></span> | <span class="t">and here, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5268" target="_blank">01:27:48.440</a></span> | <span class="t">And like split and split and split.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5269" target="_blank">01:27:49.840</a></span> | <span class="t">So even if they're binary, most random forest libraries don't do anything special about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5278" target="_blank">01:27:58.120</a></span> | <span class="t">that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5279" target="_blank">01:27:59.120</a></span> | <span class="t">They just kind of go try this variable, oh it turns out there's only one level left.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5283" target="_blank">01:28:03.560</a></span> | <span class="t">So yeah, definitely they don't do any clever bookkeeping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5292" target="_blank">01:28:12.400</a></span> | <span class="t">So if we add max_features=0.5, it goes up from 9.01 to 9.06.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5298" target="_blank">01:28:18.880</a></span> | <span class="t">So that's better still.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5300" target="_blank">01:28:20.440</a></span> | <span class="t">And so as we've been doing this, you've also hopefully noticed that our root mean squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5303" target="_blank">01:28:23.600</a></span> | <span class="t">error of log_price has been dropping on our validation set as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5308" target="_blank">01:28:28.560</a></span> | <span class="t">And so it's now down to 0.2286.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5313" target="_blank">01:28:33.560</a></span> | <span class="t">So how good is that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5315" target="_blank">01:28:35.320</a></span> | <span class="t">So like our totally untuned random forest got us in about the top 25%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5320" target="_blank">01:28:40.480</a></span> | <span class="t">Now remember, our validation set isn't identical to the Kaggle test set, and this competition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5327" target="_blank">01:28:47.200</a></span> | <span class="t">unfortunately is old enough that you can't even put in a kind of after-the-time entry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5334" target="_blank">01:28:54.120</a></span> | <span class="t">to find out how you would have gone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5335" target="_blank">01:28:55.480</a></span> | <span class="t">So we can only approximate how we could have gone, but generally speaking it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5339" target="_blank">01:28:59.680</a></span> | <span class="t">be a pretty good approximation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5341" target="_blank">01:29:01.460</a></span> | <span class="t">So 2286, here is the competition, here's the public leaderboard, 2286, 14th or 15th place.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5356" target="_blank">01:29:16.960</a></span> | <span class="t">So roughly speaking, it looks like we would be about in the top 20 of this competition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5363" target="_blank">01:29:23.160</a></span> | <span class="t">with basically a totally brainless random forest with some totally brainless minor hyperparameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5368" target="_blank">01:29:28.880</a></span> | <span class="t">tuning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5373" target="_blank">01:29:33.760</a></span> | <span class="t">This is kind of why the random forest is such an important, not just first step, but often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5379" target="_blank">01:29:39.040</a></span> | <span class="t">only step in machine learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5380" target="_blank">01:29:40.960</a></span> | <span class="t">Because it's kind of hard to screw it up, even when we didn't tune the hyperparameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5385" target="_blank">01:29:45.840</a></span> | <span class="t">we still got a good result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5387" target="_blank">01:29:47.840</a></span> | <span class="t">And then a small amount of hyperparameter tuning got us a much better result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5391" target="_blank">01:29:51.120</a></span> | <span class="t">And so any kind of model, and I'm particularly thinking of linear type models, which have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5398" target="_blank">01:29:58.480</a></span> | <span class="t">a whole bunch of statistical assumptions and you have to get a whole bunch of things right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5402" target="_blank">01:30:02.240</a></span> | <span class="t">before they start to work at all, can really throw you off track because they give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5408" target="_blank">01:30:08.000</a></span> | <span class="t">totally wrong answers about how accurate the predictions can be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5411" target="_blank">01:30:11.520</a></span> | <span class="t">But also the random forest, generally speaking, they tend to work on most data sets most of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5418" target="_blank">01:30:18.720</a></span> | <span class="t">the time with most sets of hyperparameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5421" target="_blank">01:30:21.240</a></span> | <span class="t">So for example, we did this thing with our categorical variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5432" target="_blank">01:30:32.000</a></span> | <span class="t">In fact let's take a look at our tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5438" target="_blank">01:30:38.480</a></span> | <span class="t">Look at this, f_i_product_class_desk < 7.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5446" target="_blank">01:30:46.760</a></span> | <span class="t">What does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5448" target="_blank">01:30:48.280</a></span> | <span class="t">So f_i_product_class_desk, here are some examples of that column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5462" target="_blank">01:31:02.480</a></span> | <span class="t">So what does it mean to be less than or equal to 7?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5465" target="_blank">01:31:05.640</a></span> | <span class="t">Well we'd have to look at .cat.categories to find out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5472" target="_blank">01:31:12.400</a></span> | <span class="t">And so it's 0, 1, 2, 3, 4, 5, 6, 7.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5477" target="_blank">01:31:17.040</a></span> | <span class="t">So what it's done is it's created a split where all of the backhoe loaders and these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5482" target="_blank">01:31:22.320</a></span> | <span class="t">three types of hydraulic excavator enter in one group and everything else is in the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5486" target="_blank">01:31:26.840</a></span> | <span class="t">group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5488" target="_blank">01:31:28.400</a></span> | <span class="t">So that's weird, like these aren't even in order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5494" target="_blank">01:31:34.720</a></span> | <span class="t">We could have made them in order if we had bothered to say the categories have this order,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5499" target="_blank">01:31:39.800</a></span> | <span class="t">but we hadn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5501" target="_blank">01:31:41.400</a></span> | <span class="t">So how come this even works?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5505" target="_blank">01:31:45.160</a></span> | <span class="t">Because when we turn it into codes, this is actually what the random forest sees.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5521" target="_blank">01:32:01.240</a></span> | <span class="t">And so imagine, to think about this, the only thing that mattered was whether it was a hydraulic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5527" target="_blank">01:32:07.880</a></span> | <span class="t">excavator of 0-2 metric tons and nothing else mattered, so it has to pick out this single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5534" target="_blank">01:32:14.120</a></span> | <span class="t">level.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5535" target="_blank">01:32:15.600</a></span> | <span class="t">Well it can do that because first of all it could say, okay let's pick out everything less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5540" target="_blank">01:32:20.640</a></span> | <span class="t">than 7 versus greater than 7 to create this as one group and this as another group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5548" target="_blank">01:32:28.520</a></span> | <span class="t">And then within this group, it could then pick out everything less than 6 versus greater</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5553" target="_blank">01:32:33.040</a></span> | <span class="t">than 6, which is going to pick out this one item.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5556" target="_blank">01:32:36.400</a></span> | <span class="t">So with two split points, we can pull out a single category.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5561" target="_blank">01:32:41.560</a></span> | <span class="t">So this is why it works, because the tree is infinitely flexible, even with a categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5568" target="_blank">01:32:48.280</a></span> | <span class="t">variable, if there's particular categories which have different levels of price, it can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5574" target="_blank">01:32:54.840</a></span> | <span class="t">gradually zoom in on those groups by using multiple splits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5579" target="_blank">01:32:59.640</a></span> | <span class="t">Now you can help it by telling it the order of your categorical variable, but even if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5584" target="_blank">01:33:04.400</a></span> | <span class="t">you don't, it's okay, it's just going to take a few more decisions to get there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5589" target="_blank">01:33:09.840</a></span> | <span class="t">And so you can see here it's actually using this product class desk quite a few times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5597" target="_blank">01:33:17.120</a></span> | <span class="t">And as you go deeper down the tree, you'll see it used more and more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5602" target="_blank">01:33:22.760</a></span> | <span class="t">Whereas in a linear model, or almost any kind of other model, certainly any non-tree model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5609" target="_blank">01:33:29.000</a></span> | <span class="t">pretty much, encoding a categorical variable like this won't work at all because there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5614" target="_blank">01:33:34.360</a></span> | <span class="t">no linear relationship between totally arbitrary identifiers and anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5621" target="_blank">01:33:41.660</a></span> | <span class="t">So these are the kinds of things that make random forests very easy to use and very resilient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5627" target="_blank">01:33:47.640</a></span> | <span class="t">And so by using that, we've gotten ourselves a model which is clearly world-class at this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5637" target="_blank">01:33:57.000</a></span> | <span class="t">point already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5638" target="_blank">01:33:58.000</a></span> | <span class="t">It's probably well in the top 20 of this Kaggle competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5641" target="_blank">01:34:01.620</a></span> | <span class="t">And then in our next lesson, we're going to learn about how to analyze that model to learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5649" target="_blank">01:34:09.680</a></span> | <span class="t">more about the data to make it even better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5653" target="_blank">01:34:13.800</a></span> | <span class="t">So this week, try and really experiment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5658" target="_blank">01:34:18.440</a></span> | <span class="t">Have a look inside, try and draw the trees, try and plot the different errors, try maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5664" target="_blank">01:34:24.400</a></span> | <span class="t">using different data sets to see how they work, really experiment to try and get a sense</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5669" target="_blank">01:34:29.800</a></span> | <span class="t">and maybe try to replicate things like write your own R^2, write your own versions of some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5676" target="_blank">01:34:36.240</a></span> | <span class="t">of these functions, see how much you can really learn about your data set about the random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5681" target="_blank">01:34:41.360</a></span> | <span class="t">forest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5682" target="_blank">01:34:42.360</a></span> | <span class="t">Great, see you on Thursday.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=blyXCk4sgEg&t=5683" target="_blank">01:34:43.840</a></span> | <span class="t">Bye.</span></div></div></body></html>