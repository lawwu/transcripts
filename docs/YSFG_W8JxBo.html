<html><head><title>Intro to Machine Learning: Lesson 3</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Intro to Machine Learning: Lesson 3</h2><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo"><img src="https://i.ytimg.com/vi_webp/YSFG_W8JxBo/sddefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=70">1:10</a> Data Interpretation<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=915">15:15</a> Limit Memory<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1093">18:13</a> Performance<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1355">22:35</a> Dates<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1560">26:0</a> Data<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1660">27:40</a> Testing<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1727">28:47</a> Sending F samples<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1810">30:10</a> Adding floats<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1983">33:3</a> Adding min samples<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2022">33:42</a> Results<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2073">34:33</a> Insights<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2135">35:35</a> Limitations<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2236">37:16</a> Your Job<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2334">38:54</a> Coding<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2445">40:45</a> Scatter Plot<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2555">42:35</a> Tweaking Data<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2689">44:49</a> Validation Set<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3021">50:21</a> Break<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3280">54:40</a> Standard Deviation<br><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3416">56:56</a> Random Forest Interpretation<br><br><div style="text-align: left;"><a href="./YSFG_W8JxBo.html">Whisper Transcript</a> | <a href="./transcript_YSFG_W8JxBo.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Last lesson, we looked at what random forests are, and we looked at some of the tweaks that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=10" target="_blank">00:00:10.540</a></span> | <span class="t">we could use to make them work better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=17" target="_blank">00:00:17.520</a></span> | <span class="t">So in order to actually practice this, we needed to have a Jupyter notebook environment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=23" target="_blank">00:00:23.420</a></span> | <span class="t">running, so we can either install Anaconda on our own computers, we can use AWS, or we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=31" target="_blank">00:00:31.920</a></span> | <span class="t">can use cressel.com that has everything up and running straight away, or else paperspace.com</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=37" target="_blank">00:00:37.920</a></span> | <span class="t">also works really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=40" target="_blank">00:00:40.320</a></span> | <span class="t">So assuming that you've got all that going, hopefully you've had a chance to practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=44" target="_blank">00:00:44.800</a></span> | <span class="t">running some random forests this week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=47" target="_blank">00:00:47.080</a></span> | <span class="t">I think one of the things to point out though is that before we did any tweaks of any hyperparameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=53" target="_blank">00:00:53.840</a></span> | <span class="t">or any tuning at all, the raw defaults already gave us a very good answer for an actual dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=61" target="_blank">00:01:01.240</a></span> | <span class="t">that we've got on Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=62" target="_blank">00:01:02.440</a></span> | <span class="t">So the tweaks aren't always the main piece, they're just tweaks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=68" target="_blank">00:01:08.900</a></span> | <span class="t">Sometimes they're totally necessary, but quite often you can go a long way without doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=75" target="_blank">00:01:15.360</a></span> | <span class="t">any treats at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=78" target="_blank">00:01:18.280</a></span> | <span class="t">So today we're going to look at something I think maybe even more important than building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=85" target="_blank">00:01:25.320</a></span> | <span class="t">a predictive model that's good at predicting, which is to learn how to interpret that model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=90" target="_blank">00:01:30.640</a></span> | <span class="t">to find out what it says about your data, to actually understand your data better by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=97" target="_blank">00:01:37.200</a></span> | <span class="t">using machine learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=107" target="_blank">00:01:47.200</a></span> | <span class="t">Things like random forests are black boxes that hide meaning from us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=112" target="_blank">00:01:52.080</a></span> | <span class="t">You'll see today that the truth is quite the opposite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=115" target="_blank">00:01:55.040</a></span> | <span class="t">The truth is that random forests allow us to understand our data deeper and more quickly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=122" target="_blank">00:02:02.080</a></span> | <span class="t">than traditional approaches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=124" target="_blank">00:02:04.840</a></span> | <span class="t">The other thing we're going to learn today is how to look at larger datasets than those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=131" target="_blank">00:02:11.640</a></span> | <span class="t">which you can import with just the defaults.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=135" target="_blank">00:02:15.840</a></span> | <span class="t">And specifically we're going to look at a dataset with over 100 million rows, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=139" target="_blank">00:02:19.760</a></span> | <span class="t">is the current Kaggle competition for groceries for past year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=145" target="_blank">00:02:25.080</a></span> | <span class="t">Did anybody have any questions outside of those two areas since we're covering that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=149" target="_blank">00:02:29.400</a></span> | <span class="t">today or comments that they want to talk about?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=162" target="_blank">00:02:42.440</a></span> | <span class="t">Can you just talk a little bit about in general, I understand the details more now of random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=167" target="_blank">00:02:47.320</a></span> | <span class="t">forests, but when do you know this is an applicable model to use?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=171" target="_blank">00:02:51.680</a></span> | <span class="t">In general, I should try random forests here because that's the part that I'm still like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=176" target="_blank">00:02:56.120</a></span> | <span class="t">if I'm told to I can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=178" target="_blank">00:02:58.120</a></span> | <span class="t">So the short answer is, I can't really think of anything offhand that it's definitely not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=187" target="_blank">00:03:07.440</a></span> | <span class="t">going to be at least somewhat useful for, so it's always worth trying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=193" target="_blank">00:03:13.480</a></span> | <span class="t">I think really the question is, in what situations should I try other things as well?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=200" target="_blank">00:03:20.800</a></span> | <span class="t">And the short answer to that question is for unstructured data, what I call unstructured</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=204" target="_blank">00:03:24.800</a></span> | <span class="t">data. So where all the different data points represent the same kind of thing, like a waveform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=210" target="_blank">00:03:30.640</a></span> | <span class="t">in a sound or speech, or the words in a piece of text, or the pixels in an image, you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=216" target="_blank">00:03:36.360</a></span> | <span class="t">almost certainly going to want to try deep learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=222" target="_blank">00:03:42.720</a></span> | <span class="t">And then outside of those two, there's a particular type of model we're going to look at today</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=230" target="_blank">00:03:50.080</a></span> | <span class="t">called a collaborative filtering model, which so happens that the groceries competition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=236" target="_blank">00:03:56.280</a></span> | <span class="t">is of that kind, where neither of those approaches are quite what you want without some tweaks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=242" target="_blank">00:04:02.120</a></span> | <span class="t">to them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=243" target="_blank">00:04:03.120</a></span> | <span class="t">So that would be the other main one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=245" target="_blank">00:04:05.240</a></span> | <span class="t">If anybody thinks of other places where maybe neither of those techniques is the right thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=260" target="_blank">00:04:20.960</a></span> | <span class="t">to use, mention it on the forums, even if you're not sure, so we can talk about it because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=266" target="_blank">00:04:26.600</a></span> | <span class="t">I think this is one of the more interesting questions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=272" target="_blank">00:04:32.040</a></span> | <span class="t">And to some extent it is a case of practice and experience, but I do think there are two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=279" target="_blank">00:04:39.000</a></span> | <span class="t">main classes to know about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=287" target="_blank">00:04:47.120</a></span> | <span class="t">Last week, at the point where we had done some of the key steps, like the CSV reading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=299" target="_blank">00:04:59.720</a></span> | <span class="t">in particular, which took a minute or two, at the end of that we saved it to a feather</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=304" target="_blank">00:05:04.560</a></span> | <span class="t">format file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=305" target="_blank">00:05:05.560</a></span> | <span class="t">And just to remind you, that's because this is basically almost the same format that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=310" target="_blank">00:05:10.800</a></span> | <span class="t">lives in in RAM, so it's ridiculously fast to read and write stuff from feather format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=316" target="_blank">00:05:16.840</a></span> | <span class="t">So what we're going to do today is we're going to look at lesson 2, RF interpretation, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=323" target="_blank">00:05:23.440</a></span> | <span class="t">the first thing we're going to do is read that feather format file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=329" target="_blank">00:05:29.200</a></span> | <span class="t">Now one thing to mention is a couple of you pointed out during the week, a really interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=336" target="_blank">00:05:36.840</a></span> | <span class="t">little bug or little issue, which is in the proc df function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=345" target="_blank">00:05:45.280</a></span> | <span class="t">The proc df function, remember, finds the numeric columns which have missing values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=352" target="_blank">00:05:52.160</a></span> | <span class="t">and creates an additional boolean column, as well as replacing the missing with medians,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=360" target="_blank">00:06:00.080</a></span> | <span class="t">and also turns the categorical objects into the integer codes, the main things it does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=369" target="_blank">00:06:09.840</a></span> | <span class="t">And a couple of you pointed out some key points about the missing value handling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=374" target="_blank">00:06:14.960</a></span> | <span class="t">The first one is that your test set may have missing values in some columns that weren't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=383" target="_blank">00:06:23.240</a></span> | <span class="t">in your training set or vice-versa.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=386" target="_blank">00:06:26.800</a></span> | <span class="t">And if that happens, you're going to get an error when you try to do the random forest,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=390" target="_blank">00:06:30.160</a></span> | <span class="t">because it's going to say if that is missing field appeared in your training set but not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=395" target="_blank">00:06:35.960</a></span> | <span class="t">in your test set that ended up in the model, it's going to say you can't use that data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=402" target="_blank">00:06:42.400</a></span> | <span class="t">set with this model because you're missing one of the columns it requires.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=407" target="_blank">00:06:47.280</a></span> | <span class="t">That's problem number 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=409" target="_blank">00:06:49.140</a></span> | <span class="t">Problem number 2 is that the median of the numeric values in the test set may be different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=417" target="_blank">00:06:57.760</a></span> | <span class="t">for the training set, so it may actually process it into something which has different semantics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=426" target="_blank">00:07:06.720</a></span> | <span class="t">So I thought that was a really interesting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=429" target="_blank">00:07:09.160</a></span> | <span class="t">So what I did was I changed prop df, so it returns a third thing, nas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=437" target="_blank">00:07:17.640</a></span> | <span class="t">And the nas thing it returns, it doesn't matter in detail what it is, but I'll tell you just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=443" target="_blank">00:07:23.160</a></span> | <span class="t">so you know, that's a dictionary where the keys are the names of the columns that have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=449" target="_blank">00:07:29.400</a></span> | <span class="t">missing values, and the values of the dictionary are the medians.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=454" target="_blank">00:07:34.600</a></span> | <span class="t">And so then optionally you can pass nas as an additional argument to prop df, and it'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=463" target="_blank">00:07:43.640</a></span> | <span class="t">make sure that it adds those specific columns and it uses those specific medians.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=470" target="_blank">00:07:50.040</a></span> | <span class="t">So it's giving you the ability to say process this test set in exactly the same way as we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=477" target="_blank">00:07:57.120</a></span> | <span class="t">process this training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=487" target="_blank">00:08:07.160</a></span> | <span class="t">So I just did that like yesterday or the day before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=490" target="_blank">00:08:10.760</a></span> | <span class="t">In fact that's a good point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=492" target="_blank">00:08:12.320</a></span> | <span class="t">Before you start doing work any day, I would start doing a git pull, and if something's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=499" target="_blank">00:08:19.520</a></span> | <span class="t">not working today that was working yesterday, check the forum where there will be an explanation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=504" target="_blank">00:08:24.000</a></span> | <span class="t">of why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=507" target="_blank">00:08:27.840</a></span> | <span class="t">This library in particular is moving fast, but pretty much all the libraries that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=511" target="_blank">00:08:31.640</a></span> | <span class="t">use, including PyTorch in particular, move fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=514" target="_blank">00:08:34.780</a></span> | <span class="t">And so one of the things to do if you're watching this through the MOOC is to make sure that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=520" target="_blank">00:08:40.320</a></span> | <span class="t">you've got a course.fast.ai and check the links there because there will be links saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=525" target="_blank">00:08:45.560</a></span> | <span class="t">oh these are the differences from the course, and so they're kept up to date so that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=530" target="_blank">00:08:50.520</a></span> | <span class="t">never going to -- because I can't edit what I'm saying, I can only edit that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=536" target="_blank">00:08:56.000</a></span> | <span class="t">But do a git pull before you start each day.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=543" target="_blank">00:09:03.280</a></span> | <span class="t">So I haven't actually updated all of the notebooks to add the extra return value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=550" target="_blank">00:09:10.360</a></span> | <span class="t">I will over the next couple of days, but if you're using them you'll just need to put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=553" target="_blank">00:09:13.520</a></span> | <span class="t">an extra comma, otherwise you'll get an error that it's returned 3 things and you only have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=559" target="_blank">00:09:19.200</a></span> | <span class="t">room for 2 things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=566" target="_blank">00:09:26.200</a></span> | <span class="t">What I want to do before I talk about interpretation is to show you what the exact same process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=573" target="_blank">00:09:33.640</a></span> | <span class="t">looks like when you're working with a really large dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=578" target="_blank">00:09:38.920</a></span> | <span class="t">And you'll see it's kind of almost the same thing, but there's going to be a few cases</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=586" target="_blank">00:09:46.440</a></span> | <span class="t">where we can't use the defaults, because the defaults just run a little bit too slowly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=593" target="_blank">00:09:53.780</a></span> | <span class="t">So specifically I'm going to look at the Cabo Groceries competition, specifically -- what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=606" target="_blank">00:10:06.560</a></span> | <span class="t">it called?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=607" target="_blank">00:10:07.560</a></span> | <span class="t">Here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=608" target="_blank">00:10:08.560</a></span> | <span class="t">Compress your favorite grocery sales forecasting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=612" target="_blank">00:10:12.280</a></span> | <span class="t">So this competition -- who is entering this competition?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=620" target="_blank">00:10:20.000</a></span> | <span class="t">Okay, a lot of people.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=622" target="_blank">00:10:22.740</a></span> | <span class="t">Who would like to have a go at explaining what this competition involves, what the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=629" target="_blank">00:10:29.360</a></span> | <span class="t">is and what you're trying to predict?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=634" target="_blank">00:10:34.760</a></span> | <span class="t">>> Okay, trying to predict the items on the shelf depending on lots of factors, like oil</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=640" target="_blank">00:10:40.960</a></span> | <span class="t">prices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=641" target="_blank">00:10:41.960</a></span> | <span class="t">So when you're predicting the items on the shelf, what are you actually predicting?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=646" target="_blank">00:10:46.760</a></span> | <span class="t">>> How much do you need to have in stock to maximize their --</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=650" target="_blank">00:10:50.520</a></span> | <span class="t">>> It's not quite what we're predicting, but we'll try and fix that at the moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=654" target="_blank">00:10:54.620</a></span> | <span class="t">>> And then there's a bunch of different datasets that you can use to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=657" target="_blank">00:10:57.360</a></span> | <span class="t">There's oil prices, there's stores, there's locations, and each of those can be used to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=663" target="_blank">00:11:03.080</a></span> | <span class="t">try to predict it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=664" target="_blank">00:11:04.080</a></span> | <span class="t">Does anybody want to have a go at expanding on that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=672" target="_blank">00:11:12.680</a></span> | <span class="t">>> All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=674" target="_blank">00:11:14.680</a></span> | <span class="t">So we have a bunch of information on different products.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=679" target="_blank">00:11:19.160</a></span> | <span class="t">So we have --</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=680" target="_blank">00:11:20.160</a></span> | <span class="t">>> Let's just fill up a little bit higher.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=683" target="_blank">00:11:23.080</a></span> | <span class="t">>> All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=684" target="_blank">00:11:24.080</a></span> | <span class="t">So for every store, for every item, for every day, we have a lot of related information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=690" target="_blank">00:11:30.760</a></span> | <span class="t">available, like the location where the store was located, the class of the product, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=699" target="_blank">00:11:39.920</a></span> | <span class="t">the units sold.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=701" target="_blank">00:11:41.760</a></span> | <span class="t">And then based on this, we are supposed to forecast in a much shorter time frame compared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=706" target="_blank">00:11:46.720</a></span> | <span class="t">to the training data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=708" target="_blank">00:11:48.200</a></span> | <span class="t">For every item number, how much we think it's going to sell, so only the units and nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=713" target="_blank">00:11:53.040</a></span> | <span class="t">else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=714" target="_blank">00:11:54.040</a></span> | <span class="t">>> Okay, good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=715" target="_blank">00:11:55.040</a></span> | <span class="t">Somebody can help get that back here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=722" target="_blank">00:12:02.920</a></span> | <span class="t">So your ability to explain the problem you're working on is really, really important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=730" target="_blank">00:12:10.580</a></span> | <span class="t">So if you don't currently feel confident of your ability to do that, practice with someone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=736" target="_blank">00:12:16.640</a></span> | <span class="t">who is not in this competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=738" target="_blank">00:12:18.960</a></span> | <span class="t">Tell them all about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=741" target="_blank">00:12:21.400</a></span> | <span class="t">So in this case, or in any case really, the key things to understand a machine learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=748" target="_blank">00:12:28.160</a></span> | <span class="t">problem would be to say what are the independent variables and what is the dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=752" target="_blank">00:12:32.360</a></span> | <span class="t">So the dependent variable is the thing that you're trying to predict.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=755" target="_blank">00:12:35.800</a></span> | <span class="t">The thing you're trying to predict is how many units of each kind of product were sold</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=763" target="_blank">00:12:43.040</a></span> | <span class="t">in each store on each day during a two-week period.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=768" target="_blank">00:12:48.080</a></span> | <span class="t">So that's the thing that you're trying to predict.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=770" target="_blank">00:12:50.520</a></span> | <span class="t">The information you have to predict is how many units of each product at each store on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=777" target="_blank">00:12:57.920</a></span> | <span class="t">each day were sold in the last few years, and for each store some metadata about it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=786" target="_blank">00:13:06.400</a></span> | <span class="t">like where is it located and what class of store is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=789" target="_blank">00:13:09.840</a></span> | <span class="t">For each type of product, you have some metadata about it, such as what category of product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=795" target="_blank">00:13:15.640</a></span> | <span class="t">is it and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=797" target="_blank">00:13:17.600</a></span> | <span class="t">For each date, we have some metadata about it, such as what was the oil price on that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=803" target="_blank">00:13:23.240</a></span> | <span class="t">date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=804" target="_blank">00:13:24.520</a></span> | <span class="t">So this is what we would call a relational dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=807" target="_blank">00:13:27.000</a></span> | <span class="t">A relational dataset is one where we have a number of different pieces of information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=812" target="_blank">00:13:32.360</a></span> | <span class="t">that we can join together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=815" target="_blank">00:13:35.800</a></span> | <span class="t">Specifically this kind of relational dataset is what we would refer to as a star schema.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=821" target="_blank">00:13:41.920</a></span> | <span class="t">A star schema is a kind of data warehousing schema where we say there's some central transactions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=828" target="_blank">00:13:48.960</a></span> | <span class="t">table.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=829" target="_blank">00:13:49.960</a></span> | <span class="t">In this case, the central transactions table is train.csv, and it contains the number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=841" target="_blank">00:14:01.680</a></span> | <span class="t">units that were sold by date, by store ID, by item ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=849" target="_blank">00:14:09.720</a></span> | <span class="t">So that's the central transactions table, very small, very simple, and then from that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=853" target="_blank">00:14:13.440</a></span> | <span class="t">we can join various bits of metadata.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=856" target="_blank">00:14:16.080</a></span> | <span class="t">It's called a star schema because you can imagine the transactions table in the middle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=861" target="_blank">00:14:21.720</a></span> | <span class="t">and then all these different metadata tables join onto it, giving you more information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=867" target="_blank">00:14:27.640</a></span> | <span class="t">about the date, the item ID and the store ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=874" target="_blank">00:14:34.360</a></span> | <span class="t">Sometimes you'll also see a snowflake schema, which means there might then be additional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=878" target="_blank">00:14:38.920</a></span> | <span class="t">information joined onto maybe the items table that tells you about different item categories</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=886" target="_blank">00:14:46.560</a></span> | <span class="t">and joined to the store table, telling you about the state that the store is in and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=890" target="_blank">00:14:50.840</a></span> | <span class="t">forth so you can have a whole snowflake.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=895" target="_blank">00:14:55.840</a></span> | <span class="t">So that's the basic information about this problem, the independent variables, the dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=905" target="_blank">00:15:05.640</a></span> | <span class="t">variable, and you probably also want to tell you about things like the timeframe.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=913" target="_blank">00:15:13.440</a></span> | <span class="t">Now we start in exactly the same way as we did before, loading in exactly the same stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=919" target="_blank">00:15:19.280</a></span> | <span class="t">setting the path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=920" target="_blank">00:15:20.280</a></span> | <span class="t">But when we go read CSV, if you say limit memory equals false, then you're basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=929" target="_blank">00:15:29.400</a></span> | <span class="t">saying use as much memory as you like to figure out what kinds of data is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=934" target="_blank">00:15:34.160</a></span> | <span class="t">It's going to run out of memory pretty much regardless of how much memory you have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=939" target="_blank">00:15:39.840</a></span> | <span class="t">So what we do in order to limit the amount of space that it takes up when we read it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=945" target="_blank">00:15:45.400</a></span> | <span class="t">in is we create a dictionary for each column name to the data type of that column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=952" target="_blank">00:15:52.440</a></span> | <span class="t">And so for you to create this, it's basically up to you to run less or head or whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=958" target="_blank">00:15:58.520</a></span> | <span class="t">on the data set to see what the types are and to figure that out and pass them in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=964" target="_blank">00:16:04.600</a></span> | <span class="t">So then you can just pass in data type equals with that dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=970" target="_blank">00:16:10.080</a></span> | <span class="t">And so check this out, we can read in the whole CSV file in 1 minute and 48 seconds,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=981" target="_blank">00:16:21.720</a></span> | <span class="t">and there are 125.5 million rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=990" target="_blank">00:16:30.280</a></span> | <span class="t">So when people say Python's slow, no Python's not slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=997" target="_blank">00:16:37.240</a></span> | <span class="t">Python can be slow if you don't use it right, but we can actually pass 125 million CSV records</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1004" target="_blank">00:16:44.680</a></span> | <span class="t">in less than 2 minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1009" target="_blank">00:16:49.400</a></span> | <span class="t">I'm going to put my language hat on for just a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1014" target="_blank">00:16:54.200</a></span> | <span class="t">Actually if it's fast, almost certainly it's going to see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1018" target="_blank">00:16:58.760</a></span> | <span class="t">So Python is a wrapper around a bunch of C code usually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1024" target="_blank">00:17:04.200</a></span> | <span class="t">So if Python itself isn't actually very fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1032" target="_blank">00:17:12.240</a></span> | <span class="t">So that was Terrence Parr who writes things for writing programming languages for a living.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1040" target="_blank">00:17:20.920</a></span> | <span class="t">Python itself is not fast, but almost everything we want to do in Python and data science has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1046" target="_blank">00:17:26.720</a></span> | <span class="t">been written for us in C, or actually more often in Python, which is a Python-like language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1052" target="_blank">00:17:32.360</a></span> | <span class="t">which compiles to C. So most of the stuff we run in Python is actually running not just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1058" target="_blank">00:17:38.600</a></span> | <span class="t">C code, but actually in Pandas a lot of it's written in assembly language, it's heavily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1062" target="_blank">00:17:42.880</a></span> | <span class="t">optimized, behind the scenes a lot of that is going back to actually calling Fortran-based</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1068" target="_blank">00:17:48.880</a></span> | <span class="t">libraries for a linear algebra.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1071" target="_blank">00:17:51.440</a></span> | <span class="t">So there's layers upon layer of speed that actually allow us to spend less than 2 minutes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1077" target="_blank">00:17:57.320</a></span> | <span class="t">reading in that much data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1080" target="_blank">00:18:00.440</a></span> | <span class="t">If we wrote our own CSV reader in pure Python, it would take thousands of times, at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1088" target="_blank">00:18:08.400</a></span> | <span class="t">thousands of times longer than the optimized versions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1093" target="_blank">00:18:13.640</a></span> | <span class="t">So for us, what we care about is the speed we can get in practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1098" target="_blank">00:18:18.160</a></span> | <span class="t">So this is pretty cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1100" target="_blank">00:18:20.160</a></span> | <span class="t">As well as telling it what the different data types were, we also have to tell it as before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1105" target="_blank">00:18:25.600</a></span> | <span class="t">which things you want to parse as dates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1113" target="_blank">00:18:33.280</a></span> | <span class="t">I've noticed that in this dictionary, you specify in 64, 33, and 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1119" target="_blank">00:18:39.280</a></span> | <span class="t">I was wondering in practice, is it faster if you all specify them to be slower, or any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1127" target="_blank">00:18:47.620</a></span> | <span class="t">performance consideration?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1129" target="_blank">00:18:49.280</a></span> | <span class="t">So the key performance consideration here was to use the smallest number of bits that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1134" target="_blank">00:18:54.400</a></span> | <span class="t">I could to fully represent the column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1137" target="_blank">00:18:57.120</a></span> | <span class="t">So if I had used n8 for item number, there are more than 255 item numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1142" target="_blank">00:19:02.360</a></span> | <span class="t">More specifically, the maximum item number is bigger than 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1146" target="_blank">00:19:06.120</a></span> | <span class="t">So on the other hand, if I had used n64 for store number, it's using more bits than necessary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1153" target="_blank">00:19:13.640</a></span> | <span class="t">Given that the whole purpose here was to avoid running out of RAM, we don't want to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1158" target="_blank">00:19:18.160</a></span> | <span class="t">up 8 times more memory than necessary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1161" target="_blank">00:19:21.880</a></span> | <span class="t">So the key thing was really about memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1164" target="_blank">00:19:24.320</a></span> | <span class="t">In fact when you're working with large data sets, very often you'll find the slow piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1169" target="_blank">00:19:29.760</a></span> | <span class="t">is the actually reading and writing to RAM, not the actual CPU operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1175" target="_blank">00:19:35.520</a></span> | <span class="t">So very often that's the key performance consideration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1179" target="_blank">00:19:39.540</a></span> | <span class="t">Also however, as a rule of thumb, smaller data types often will run faster, particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1187" target="_blank">00:19:47.720</a></span> | <span class="t">if you can use 70, so that's single instruction multiple data vectorized code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1192" target="_blank">00:19:52.720</a></span> | <span class="t">It can pack more numbers into a single vector to run at once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1204" target="_blank">00:20:04.840</a></span> | <span class="t">That was all heavily simplified and not exactly right, but right and bound for this purpose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1211" target="_blank">00:20:11.960</a></span> | <span class="t">Once you do this, the shuffle thing beforehand is not needed anymore, you may just send a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1219" target="_blank">00:20:19.120</a></span> | <span class="t">random sub solution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1223" target="_blank">00:20:23.120</a></span> | <span class="t">Although here I've read in the whole thing, when I start, I never start by reading in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1230" target="_blank">00:20:30.720</a></span> | <span class="t">the whole thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1232" target="_blank">00:20:32.760</a></span> | <span class="t">So if you search the forum for 'shuff', you'll find some tips about how to use this UNIX</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1242" target="_blank">00:20:42.860</a></span> | <span class="t">command to get a random sample of data at the command prompt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1248" target="_blank">00:20:48.160</a></span> | <span class="t">And then you can just read that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1249" target="_blank">00:20:49.480</a></span> | <span class="t">The nice thing is that that's a good way to find out what data types to use, to read in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1256" target="_blank">00:20:56.040</a></span> | <span class="t">a random sample and let pandas figure it out for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1266" target="_blank">00:21:06.600</a></span> | <span class="t">In general, I do as much work as possible on a sample until I feel confident that I understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1273" target="_blank">00:21:13.280</a></span> | <span class="t">the sample before I move on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1277" target="_blank">00:21:17.440</a></span> | <span class="t">Having said that, what we're about to learn is some techniques for running models on this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1280" target="_blank">00:21:20.980</a></span> | <span class="t">full dataset that are actually going to work on arbitrarily large datasets, that also I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1285" target="_blank">00:21:25.120</a></span> | <span class="t">specifically wanted to talk about how to read in large datasets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1289" target="_blank">00:21:29.600</a></span> | <span class="t">One thing to mention, onPromotion objects are like saying create a general purpose Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1296" target="_blank">00:21:36.200</a></span> | <span class="t">data type which is slow and memory heavy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1299" target="_blank">00:21:39.560</a></span> | <span class="t">The reason for that is that this is a Boolean which also has missing values, and so we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1304" target="_blank">00:21:44.800</a></span> | <span class="t">to deal with this before we can turn it into a Boolean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1307" target="_blank">00:21:47.720</a></span> | <span class="t">So you can see after that, I then go ahead and let's say fill in the missing values with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1311" target="_blank">00:21:51.600</a></span> | <span class="t">false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1312" target="_blank">00:21:52.600</a></span> | <span class="t">Now you wouldn't just do this without doing some checking ahead of time, but some exploratory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1317" target="_blank">00:21:57.480</a></span> | <span class="t">data analysis shows that this is probably an appropriate thing to do, it seems that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1322" target="_blank">00:22:02.000</a></span> | <span class="t">missing does mean false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1326" target="_blank">00:22:06.680</a></span> | <span class="t">Objects generally read in a string, so replace the strings true and false with actual Booleans,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1331" target="_blank">00:22:11.880</a></span> | <span class="t">and then finally convert it to an actual Boolean type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1335" target="_blank">00:22:15.200</a></span> | <span class="t">So at this point, when I save this, this file now of 123 million records takes up something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1343" target="_blank">00:22:23.440</a></span> | <span class="t">under 2.5 GB of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1346" target="_blank">00:22:26.160</a></span> | <span class="t">So you can look at pretty large datasets even on pretty small computers, which is interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1353" target="_blank">00:22:33.680</a></span> | <span class="t">So at that point, now that it's in a nice fast format, look how fast it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1357" target="_blank">00:22:37.400</a></span> | <span class="t">I can save it to feather format in under 5 seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1361" target="_blank">00:22:41.560</a></span> | <span class="t">So that's nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1363" target="_blank">00:22:43.880</a></span> | <span class="t">And then because pandas is generally pretty fast, you can do stuff like summarize every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1370" target="_blank">00:22:50.240</a></span> | <span class="t">column of all 125 million records in 20 seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1377" target="_blank">00:22:57.760</a></span> | <span class="t">The first thing I looked at here is the dates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1381" target="_blank">00:23:01.200</a></span> | <span class="t">Generally speaking, dates are just going to be really important on a lot of the stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1384" target="_blank">00:23:04.040</a></span> | <span class="t">you do, particularly because any model that you put in in practice, you're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1390" target="_blank">00:23:10.280</a></span> | <span class="t">putting it in at some date that is later than the date that you trained it by definition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1396" target="_blank">00:23:16.120</a></span> | <span class="t">And so if anything in the world changes, you need to know how your predictive accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1400" target="_blank">00:23:20.640</a></span> | <span class="t">changes as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1402" target="_blank">00:23:22.120</a></span> | <span class="t">And so what you'll see on Kaggle and what you should always do in your on projects is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1405" target="_blank">00:23:25.720</a></span> | <span class="t">make sure that your dates don't overlap.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1407" target="_blank">00:23:27.760</a></span> | <span class="t">So in this case, the dates that we have in the training set go from 2013 to mid-August</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1414" target="_blank">00:23:34.840</a></span> | <span class="t">2017, there's our first and last.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1420" target="_blank">00:23:40.360</a></span> | <span class="t">And then in our test set, they go from 1 day later, August 16th until the end of the month.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1428" target="_blank">00:23:48.720</a></span> | <span class="t">So this is a key thing that you can't really do any useful machine learning until you understand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1435" target="_blank">00:23:55.160</a></span> | <span class="t">this basic piece here, which is you've got 4 years of data and you're trying to predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1443" target="_blank">00:24:03.720</a></span> | <span class="t">the next 2 weeks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1446" target="_blank">00:24:06.480</a></span> | <span class="t">So that's just a fundamental thing that you're going to need to understand before you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1450" target="_blank">00:24:10.240</a></span> | <span class="t">really do a good job of this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1451" target="_blank">00:24:11.920</a></span> | <span class="t">And so as soon as I see that, what does that say to you?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1456" target="_blank">00:24:16.480</a></span> | <span class="t">If you wanted to now use a smaller data set, should you use a random sample, or is there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1462" target="_blank">00:24:22.160</a></span> | <span class="t">something better you could do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1464" target="_blank">00:24:24.120</a></span> | <span class="t">Probably from the bottom, more recent?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1474" target="_blank">00:24:34.720</a></span> | <span class="t">So it's like, okay, I'm going to go to a shop next week and I've got a $5 bet with my brother</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1484" target="_blank">00:24:44.640</a></span> | <span class="t">as to whether I can guess how many cans of Coke are going to be on the shelf.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1488" target="_blank">00:24:48.960</a></span> | <span class="t">Alright, well probably the best way to do that would be to go to the shop same day of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1495" target="_blank">00:24:55.640</a></span> | <span class="t">the previous week and see how many cans of Coke are on the shelf and guess it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1499" target="_blank">00:24:59.280</a></span> | <span class="t">to be the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1500" target="_blank">00:25:00.280</a></span> | <span class="t">You wouldn't go and look at how many were there 4 years ago.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1507" target="_blank">00:25:07.100</a></span> | <span class="t">But couldn't 4 years ago that same time frame of the year be important?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1511" target="_blank">00:25:11.800</a></span> | <span class="t">For example, how much Coke they have on the shelf at Christmas time is going to be way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1514" target="_blank">00:25:14.840</a></span> | <span class="t">more than?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1515" target="_blank">00:25:15.840</a></span> | <span class="t">Exactly, so there's no useful information from 4 years ago, so we don't want to entirely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1523" target="_blank">00:25:23.960</a></span> | <span class="t">throw it away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1524" target="_blank">00:25:24.960</a></span> | <span class="t">But as a first step, what's the simplest possible thing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1529" target="_blank">00:25:29.680</a></span> | <span class="t">It's kind of like submitting the means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1531" target="_blank">00:25:31.640</a></span> | <span class="t">I wouldn't submit the mean of 2012 sales, I would probably submit the mean of last month's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1539" target="_blank">00:25:39.160</a></span> | <span class="t">sales, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1542" target="_blank">00:25:42.560</a></span> | <span class="t">So yeah, we're just trying to think about how we might want to create some initial easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1548" target="_blank">00:25:48.240</a></span> | <span class="t">models and later on we might want to wait it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1551" target="_blank">00:25:51.760</a></span> | <span class="t">So for example, we might want to wait more recent dates more highly, they're probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1555" target="_blank">00:25:55.400</a></span> | <span class="t">more relevant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1556" target="_blank">00:25:56.400</a></span> | <span class="t">But we should do a whole bunch of exploratory data analysis to check that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1561" target="_blank">00:26:01.400</a></span> | <span class="t">So here's what the bottom of that data set looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1566" target="_blank">00:26:06.040</a></span> | <span class="t">And you can see literally it's got a date, a store number, an item number, an unit sales,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1572" target="_blank">00:26:12.640</a></span> | <span class="t">and tells you whether or not that particular item was on sale at that particular store</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1578" target="_blank">00:26:18.200</a></span> | <span class="t">on that particular date, and then there's some arbitrary ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1583" target="_blank">00:26:23.000</a></span> | <span class="t">So that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1586" target="_blank">00:26:26.540</a></span> | <span class="t">So now that we have read that in, we can do stuff like, this is interesting, again we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1593" target="_blank">00:26:33.600</a></span> | <span class="t">have to take the log of the sales.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1597" target="_blank">00:26:37.040</a></span> | <span class="t">And it's the same reason as we looked at last week, because we're trying to predict something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1600" target="_blank">00:26:40.920</a></span> | <span class="t">that varies according to ratios.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1603" target="_blank">00:26:43.820</a></span> | <span class="t">They told us in this competition that the root mean squared log error is the thing they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1608" target="_blank">00:26:48.840</a></span> | <span class="t">care about, so we take the log.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1611" target="_blank">00:26:51.680</a></span> | <span class="t">They mentioned also if you check the competition details, which you always should read carefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1616" target="_blank">00:26:56.920</a></span> | <span class="t">the definition of any project you do, they say that there are some negative sales that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1621" target="_blank">00:27:01.720</a></span> | <span class="t">represent returns, and they tell us that we should consider them to be 0 for the purpose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1627" target="_blank">00:27:07.440</a></span> | <span class="t">of this competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1628" target="_blank">00:27:08.680</a></span> | <span class="t">So I clip the sales so that they fall between 0 and no particular maximum, so clip just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1637" target="_blank">00:27:17.960</a></span> | <span class="t">means cut it off at that point, truncate it, and then take the log of that +1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1644" target="_blank">00:27:24.420</a></span> | <span class="t">Why do I do +1?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1645" target="_blank">00:27:25.840</a></span> | <span class="t">Because again, if you check the details of the capital competition, that's what they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1648" target="_blank">00:27:28.840</a></span> | <span class="t">tell you they're going to use is they're not actually just taking the root mean squared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1652" target="_blank">00:27:32.080</a></span> | <span class="t">log error, but the root mean squared log +1 error, because log of 0 doesn't make sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1661" target="_blank">00:27:41.520</a></span> | <span class="t">We can add the date part as usual, and again it's taking a couple of minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1667" target="_blank">00:27:47.160</a></span> | <span class="t">So I would run through all this on a sample first, so everything takes 10 seconds to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1671" target="_blank">00:27:51.640</a></span> | <span class="t">sure it works, just to check everything looks reasonable before I go back because I don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1675" target="_blank">00:27:55.320</a></span> | <span class="t">want to wait 2 minutes or something, I don't know if it's going to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1679" target="_blank">00:27:59.720</a></span> | <span class="t">But as you can see, all these lines of code are identical to what we saw for the bulldozers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1684" target="_blank">00:28:04.240</a></span> | <span class="t">competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1687" target="_blank">00:28:07.080</a></span> | <span class="t">In this case, all I'm reading in is a training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1689" target="_blank">00:28:09.400</a></span> | <span class="t">I didn't need to run train cats because all of my data types are already numeric.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1694" target="_blank">00:28:14.840</a></span> | <span class="t">If they weren't, I would need to call train cats and then I would need to call apply cats</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1701" target="_blank">00:28:21.640</a></span> | <span class="t">to the same categorical codes that I now have in the training set to the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1709" target="_blank">00:28:29.560</a></span> | <span class="t">I call prop df as before to check for missing values and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1717" target="_blank">00:28:37.720</a></span> | <span class="t">So all of those lines of code are identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1720" target="_blank">00:28:40.560</a></span> | <span class="t">These lines of code again are identical because root mean squared error is what we care about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1728" target="_blank">00:28:48.520</a></span> | <span class="t">And then I've got two changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1730" target="_blank">00:28:50.040</a></span> | <span class="t">The first is sent RF samples, which we learned about last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1735" target="_blank">00:28:55.080</a></span> | <span class="t">So we've got 120 something million records.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1739" target="_blank">00:28:59.600</a></span> | <span class="t">We probably don't want to create a tree from 120 million something records.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1744" target="_blank">00:29:04.000</a></span> | <span class="t">I don't even know how long that's going to take, I haven't had the time and patience</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1748" target="_blank">00:29:08.200</a></span> | <span class="t">to wait and see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1750" target="_blank">00:29:10.880</a></span> | <span class="t">So you could start with 10,000 or 100,000, maybe it runs in a few seconds, make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1757" target="_blank">00:29:17.440</a></span> | <span class="t">it works and you can figure out how much you can run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1760" target="_blank">00:29:20.480</a></span> | <span class="t">And so I found getting it to a million, it runs in under a minute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1766" target="_blank">00:29:26.600</a></span> | <span class="t">And so the point here is there's no relationship between the size of the dataset and how long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1771" target="_blank">00:29:31.880</a></span> | <span class="t">it takes to build the random forest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1773" target="_blank">00:29:33.840</a></span> | <span class="t">The relationship is between the number of estimators multiplied by the sample size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1779" target="_blank">00:29:39.720</a></span> | <span class="t">So the number of jobs is the number of cores that it's going to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1793" target="_blank">00:29:53.040</a></span> | <span class="t">And I was running this on a computer that has about 60 cores, and I just found if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1798" target="_blank">00:29:58.200</a></span> | <span class="t">try to use all of them, it spends so much time spinning up jobs so it's a bit slower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1801" target="_blank">00:30:01.840</a></span> | <span class="t">So if you've got lots and lots of cores on your computer, sometimes you want less than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1807" target="_blank">00:30:07.560</a></span> | <span class="t">negative 1 means use every single core.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1810" target="_blank">00:30:10.680</a></span> | <span class="t">There's one more change I made which is that I converted the data frame into an array of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1818" target="_blank">00:30:18.040</a></span> | <span class="t">floats and then I fitted on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1821" target="_blank">00:30:21.640</a></span> | <span class="t">Why did I do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1824" target="_blank">00:30:24.160</a></span> | <span class="t">Because internally inside the random forest code, they do that anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1829" target="_blank">00:30:29.560</a></span> | <span class="t">And so given that I wanted to run a few different random forests with a few different hyperparameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1834" target="_blank">00:30:34.640</a></span> | <span class="t">by doing it once myself, I saved that minute 37 seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1841" target="_blank">00:30:41.040</a></span> | <span class="t">So if you run a line of code and it takes quite a long time, so the first time I ran</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1849" target="_blank">00:30:49.660</a></span> | <span class="t">this random forest progressor, it took 2 or 3 minutes, and I thought I don't really want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1853" target="_blank">00:30:53.600</a></span> | <span class="t">to wait 2 or 3 minutes, you can always add in front of the line of code prun, percent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1861" target="_blank">00:31:01.760</a></span> | <span class="t">prun.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1862" target="_blank">00:31:02.760</a></span> | <span class="t">So what percent prun does is it runs something called a profiler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1867" target="_blank">00:31:07.240</a></span> | <span class="t">And what a profiler does is it will tell you which lines of code behind the scenes took</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1872" target="_blank">00:31:12.200</a></span> | <span class="t">the most time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1873" target="_blank">00:31:13.200</a></span> | <span class="t">And in this case I noticed that there was a line of code inside scikit-learn that was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1878" target="_blank">00:31:18.780</a></span> | <span class="t">this line of code, and it was taking all the time, nearly all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1882" target="_blank">00:31:22.560</a></span> | <span class="t">And so I thought I'll do that first and then I'll pass in the result and it won't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1886" target="_blank">00:31:26.120</a></span> | <span class="t">to do it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1887" target="_blank">00:31:27.600</a></span> | <span class="t">So this thing of looking to see which things is taking up the time is called profiling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1893" target="_blank">00:31:33.560</a></span> | <span class="t">And in software engineering, it's one of the most important tools you have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1897" target="_blank">00:31:37.520</a></span> | <span class="t">Data scientists really underappreciate this tool, but you'll find amongst conversations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1904" target="_blank">00:31:44.160</a></span> | <span class="t">on GitHub issues or on Twitter or whatever amongst the top data scientists, they're sharing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1909" target="_blank">00:31:49.240</a></span> | <span class="t">and talking about profiles all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1911" target="_blank">00:31:51.640</a></span> | <span class="t">And that's how easy it is to get a profile.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1914" target="_blank">00:31:54.760</a></span> | <span class="t">So for fun, try running prun from time to time on stuff that's taking 10-20 seconds and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1922" target="_blank">00:32:02.840</a></span> | <span class="t">see if you can learn to interpret and use profiler outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1927" target="_blank">00:32:07.320</a></span> | <span class="t">Even though in this case I didn't write this scikit-learn, plus I was still able to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1934" target="_blank">00:32:14.040</a></span> | <span class="t">the profiler to figure out how to make it run over twice as fast by avoiding recalculating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1941" target="_blank">00:32:21.080</a></span> | <span class="t">this each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1942" target="_blank">00:32:22.980</a></span> | <span class="t">So in this case, I built my regressor, I decided to use 20 estimators.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1947" target="_blank">00:32:27.800</a></span> | <span class="t">Something else that I noticed in the profiler is that I can't use OOB score when I use set-RF</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1953" target="_blank">00:32:33.320</a></span> | <span class="t">samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1954" target="_blank">00:32:34.320</a></span> | <span class="t">Because if I do, it's going to use the other 124 million rows to calculate the OOB score,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1961" target="_blank">00:32:41.960</a></span> | <span class="t">which is still going to take forever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1965" target="_blank">00:32:45.440</a></span> | <span class="t">So I may as well have a proper validation set anyway, besides which I want a validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1969" target="_blank">00:32:49.640</a></span> | <span class="t">set that's the most recent dates rather than it's random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1973" target="_blank">00:32:53.720</a></span> | <span class="t">So if you use set-RF samples on a large data set, don't put the OOB score parameter in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1981" target="_blank">00:33:01.120</a></span> | <span class="t">because it takes forever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1984" target="_blank">00:33:04.320</a></span> | <span class="t">So that got me a 0.76 validation root mean squared log error, and then I tried fiddling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1992" target="_blank">00:33:12.760</a></span> | <span class="t">around with different min-samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1994" target="_blank">00:33:14.320</a></span> | <span class="t">So if I decrease the min-samples from 100 to 10, it took a little bit more time to run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=1999" target="_blank">00:33:19.620</a></span> | <span class="t">as we would expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2002" target="_blank">00:33:22.360</a></span> | <span class="t">And the error went down from 76 to 71, so that looked pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2008" target="_blank">00:33:28.680</a></span> | <span class="t">So I kept decreasing it down to 3, and that brought this error down to 0.70.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2013" target="_blank">00:33:33.560</a></span> | <span class="t">When I decreased it down to 1, it didn't really help.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2016" target="_blank">00:33:36.800</a></span> | <span class="t">So I kind of had a reasonable random forest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2021" target="_blank">00:33:41.440</a></span> | <span class="t">When I say reasonable, though, it's not reasonable in the sense that it does not give a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2030" target="_blank">00:33:50.600</a></span> | <span class="t">result on the later morning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2033" target="_blank">00:33:53.640</a></span> | <span class="t">And so this is a very interesting question about why is that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2037" target="_blank">00:33:57.600</a></span> | <span class="t">And the reason is really coming back to Savannah's question earlier, where might random forests</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2043" target="_blank">00:34:03.420</a></span> | <span class="t">not work as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2045" target="_blank">00:34:05.320</a></span> | <span class="t">Let's go back and look at the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2048" target="_blank">00:34:08.440</a></span> | <span class="t">Here's the entire dataset, here's all the columns we used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2052" target="_blank">00:34:12.840</a></span> | <span class="t">So the columns that we have to predict with are the date, the store number, the item number,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2060" target="_blank">00:34:20.800</a></span> | <span class="t">and whether it was on promotion or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2063" target="_blank">00:34:23.880</a></span> | <span class="t">And then of course we used add date part, so there's also going to be day of week, day</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2068" target="_blank">00:34:28.080</a></span> | <span class="t">of month, day of year, is quarter, start, etcetera, etcetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2073" target="_blank">00:34:33.440</a></span> | <span class="t">So if you think about it, most of the insight around how much of something do you expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2083" target="_blank">00:34:43.000</a></span> | <span class="t">to sell tomorrow is likely to be very wrapped up in the details about where is that store,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2090" target="_blank">00:34:50.040</a></span> | <span class="t">what kind of things do they tend to sell at that store, for that item, what category of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2094" target="_blank">00:34:54.560</a></span> | <span class="t">item is it, if it's like fresh bread, they might not sell much of it on Sundays because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2102" target="_blank">00:35:02.600</a></span> | <span class="t">on Sundays, fresh bread doesn't get made, where else it's gasoline, maybe they're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2108" target="_blank">00:35:08.400</a></span> | <span class="t">to sell a lot of gasoline because on Sundays people go and fill up their cart with a wick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2113" target="_blank">00:35:13.280</a></span> | <span class="t">ahead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2114" target="_blank">00:35:14.280</a></span> | <span class="t">Now a random forest has no ability to do anything other than create a bunch of binary splits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2120" target="_blank">00:35:20.380</a></span> | <span class="t">on things like day of week, store number, item number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2123" target="_blank">00:35:23.360</a></span> | <span class="t">It doesn't know which one represents gasoline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2127" target="_blank">00:35:27.120</a></span> | <span class="t">It doesn't know which stores are in the center of the city versus which ones are out in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2132" target="_blank">00:35:32.120</a></span> | <span class="t">streets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2133" target="_blank">00:35:33.120</a></span> | <span class="t">It doesn't know any of these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2137" target="_blank">00:35:37.060</a></span> | <span class="t">Its ability to really understand what's going on is somewhat limited.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2142" target="_blank">00:35:42.200</a></span> | <span class="t">So we're probably going to need to use the entire four years of data to even get some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2146" target="_blank">00:35:46.880</a></span> | <span class="t">useful insights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2148" target="_blank">00:35:48.480</a></span> | <span class="t">But then as soon as we start using the whole four years of data, a lot of the data we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2152" target="_blank">00:35:52.160</a></span> | <span class="t">using is really old.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2155" target="_blank">00:35:55.600</a></span> | <span class="t">So interestingly, there's a Kaggle kernel that points out that what you could do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2162" target="_blank">00:36:02.560</a></span> | <span class="t">just take the last two weeks and take the average sales by date, by store number, by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2171" target="_blank">00:36:11.920</a></span> | <span class="t">item number and just submit that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2175" target="_blank">00:36:15.440</a></span> | <span class="t">If you just submit that, you come about 30th.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2181" target="_blank">00:36:21.800</a></span> | <span class="t">So for those of you in the groceries, Terrence has a comment or a question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2191" target="_blank">00:36:31.160</a></span> | <span class="t">I think this may have tripped me up actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2192" target="_blank">00:36:32.760</a></span> | <span class="t">I think you said date, store, item.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2194" target="_blank">00:36:34.840</a></span> | <span class="t">I think it's actually store, item, sales and then you mean across date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2198" target="_blank">00:36:38.200</a></span> | <span class="t">Oh yeah, you're right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2199" target="_blank">00:36:39.200</a></span> | <span class="t">It's store, item and on promotion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2202" target="_blank">00:36:42.240</a></span> | <span class="t">On promotion, yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2206" target="_blank">00:36:46.560</a></span> | <span class="t">If you do it by date as well, you end up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2210" target="_blank">00:36:50.320</a></span> | <span class="t">So each row represents basically a cross tabulation of all of the sales in that store for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2216" target="_blank">00:36:56.920</a></span> | <span class="t">item.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2217" target="_blank">00:36:57.920</a></span> | <span class="t">So if you put date in there as well, there's only going to be one or two items being averaged</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2223" target="_blank">00:37:03.560</a></span> | <span class="t">in each of those cells, which is too much variation, basically, it's too sparse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2228" target="_blank">00:37:08.360</a></span> | <span class="t">It doesn't give you a terrible result, but it's not 30th.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2237" target="_blank">00:37:17.560</a></span> | <span class="t">So your job if you're looking at this competition, and we'll talk about this in the next class,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2243" target="_blank">00:37:23.400</a></span> | <span class="t">is how do you start with that model and make it a little bit better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2251" target="_blank">00:37:31.960</a></span> | <span class="t">Because if you can, then by the time we meet up next, hopefully you'll be above the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2258" target="_blank">00:37:38.600</a></span> | <span class="t">30.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2259" target="_blank">00:37:39.640</a></span> | <span class="t">Because Kaggle being Kaggle, lots of people have now taken this kernel and submitted it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2264" target="_blank">00:37:44.200</a></span> | <span class="t">and they all have about the same score, and the scores are ordered not just by score but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2268" target="_blank">00:37:48.800</a></span> | <span class="t">by date submitted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2270" target="_blank">00:37:50.280</a></span> | <span class="t">So if you now submit this kernel, you're not going to be 30th because you're way down the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2274" target="_blank">00:37:54.600</a></span> | <span class="t">list of when it was submitted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2276" target="_blank">00:37:56.920</a></span> | <span class="t">But if you can do a tiny bit better, you're going to be better than all of those people.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2281" target="_blank">00:38:01.880</a></span> | <span class="t">So how can you make this a tiny bit better?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2290" target="_blank">00:38:10.960</a></span> | <span class="t">Would you try to capture seasonality and trend effects by creating new columns?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2295" target="_blank">00:38:15.320</a></span> | <span class="t">These are the average sales in the month of August, these are the average sales for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2298" target="_blank">00:38:18.560</a></span> | <span class="t">year?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2299" target="_blank">00:38:19.560</a></span> | <span class="t">Yeah, I think that's a great idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2300" target="_blank">00:38:20.800</a></span> | <span class="t">So the thing for you to think about is how to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2306" target="_blank">00:38:26.480</a></span> | <span class="t">And so see if you can make it work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2309" target="_blank">00:38:29.440</a></span> | <span class="t">Because there are details to get right, which I know Terrence has been working on this for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2313" target="_blank">00:38:33.320</a></span> | <span class="t">the last week, and he's almost crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2318" target="_blank">00:38:38.440</a></span> | <span class="t">The details are difficult, they're not intellectually difficult, they're kind of difficult in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2326" target="_blank">00:38:46.920</a></span> | <span class="t">way that makes you want to head back to your desk at 2am.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2330" target="_blank">00:38:50.960</a></span> | <span class="t">And this is something to mention in general.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2335" target="_blank">00:38:55.280</a></span> | <span class="t">The coding you do for machine learning is incredibly frustrating and incredibly difficult.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2345" target="_blank">00:39:05.320</a></span> | <span class="t">If you get a detail wrong, much of the time it's not going to give you an exception, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2354" target="_blank">00:39:14.840</a></span> | <span class="t">will just silently be slightly less good than it otherwise would have been.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2359" target="_blank">00:39:19.140</a></span> | <span class="t">And if you're on Kaggle, at least you know, okay well I'm not doing as well as other people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2363" target="_blank">00:39:23.400</a></span> | <span class="t">on Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2364" target="_blank">00:39:24.400</a></span> | <span class="t">But if you're not on Kaggle, you just don't know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2367" target="_blank">00:39:27.520</a></span> | <span class="t">You don't know if your company's model is like half as good as it could be because you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2371" target="_blank">00:39:31.840</a></span> | <span class="t">made a little mistake.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2373" target="_blank">00:39:33.680</a></span> | <span class="t">So that's one of the reasons why practicing on Kaggle now is great, because you're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2378" target="_blank">00:39:38.960</a></span> | <span class="t">to get practice in finding all of the ways in which you can infuriatingly screw things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2384" target="_blank">00:39:44.800</a></span> | <span class="t">up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2385" target="_blank">00:39:45.800</a></span> | <span class="t">And you'll be amazed, like for me there's an extraordinary array of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2390" target="_blank">00:39:50.000</a></span> | <span class="t">But as you get to know what they are, you'll start to know how to check for them as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2394" target="_blank">00:39:54.880</a></span> | <span class="t">go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2395" target="_blank">00:39:55.880</a></span> | <span class="t">And so the only way, you should assume every button you press, you're going to press the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2401" target="_blank">00:40:01.160</a></span> | <span class="t">wrong button.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2402" target="_blank">00:40:02.560</a></span> | <span class="t">And that's fine as long as you have a way to find out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2407" target="_blank">00:40:07.000</a></span> | <span class="t">We'll talk about that more during the course, but unfortunately there isn't a set of specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2416" target="_blank">00:40:16.600</a></span> | <span class="t">things I can tell you to always do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2418" target="_blank">00:40:18.640</a></span> | <span class="t">You just always have to think like, okay, what do I know about the results of this thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2424" target="_blank">00:40:24.280</a></span> | <span class="t">I'm about to do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2425" target="_blank">00:40:25.280</a></span> | <span class="t">I'll give you a really simple example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2429" target="_blank">00:40:29.400</a></span> | <span class="t">If you've actually created that basic entry where you take the mean by date, by store</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2434" target="_blank">00:40:34.800</a></span> | <span class="t">number, by on promotion, and you've submitted it and you've got a reasonable score, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2440" target="_blank">00:40:40.040</a></span> | <span class="t">then you think you've got something that's a little bit better, and you do predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2444" target="_blank">00:40:44.360</a></span> | <span class="t">for that, how about you now create a scatterplot showing the predictions of your average model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2452" target="_blank">00:40:52.160</a></span> | <span class="t">on one axis versus the predictions of your new model on the other axis?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2456" target="_blank">00:40:56.160</a></span> | <span class="t">You should see that they just about form a line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2460" target="_blank">00:41:00.960</a></span> | <span class="t">And if they don't, then that's a very strong suggestion that you screwed something up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2466" target="_blank">00:41:06.320</a></span> | <span class="t">So that would be an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2468" target="_blank">00:41:08.280</a></span> | <span class="t">Can you pass that one to the end of that row, possible two steps?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2477" target="_blank">00:41:17.440</a></span> | <span class="t">So for a problem like this, unlike the car insurance problem on Taggle where columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2484" target="_blank">00:41:24.960</a></span> | <span class="t">are unnamed, we know what the columns represent and what they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2491" target="_blank">00:41:31.760</a></span> | <span class="t">How often do you pull in data from other sources to supplement that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2499" target="_blank">00:41:39.280</a></span> | <span class="t">Maybe like weather data, for example, or how often is that used?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2504" target="_blank">00:41:44.840</a></span> | <span class="t">Very often.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2505" target="_blank">00:41:45.840</a></span> | <span class="t">And so the whole point of this star schema is that you've got your central table and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2511" target="_blank">00:41:51.920</a></span> | <span class="t">you've got these other tables coming off that provide metadata about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2515" target="_blank">00:41:55.920</a></span> | <span class="t">So for example, weather is metadata about a date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2521" target="_blank">00:42:01.520</a></span> | <span class="t">On Kaggle specifically, most competitions have the rule that you can use external data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2528" target="_blank">00:42:08.720</a></span> | <span class="t">as long as you post on the forum that you're using it and that it's publicly available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2536" target="_blank">00:42:16.400</a></span> | <span class="t">But you have to check on a competition by competition basis, they will tell you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2540" target="_blank">00:42:20.720</a></span> | <span class="t">So with Kaggle, you should always be looking for what external data could I possibly leverage</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2547" target="_blank">00:42:27.280</a></span> | <span class="t">here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2548" target="_blank">00:42:28.280</a></span> | <span class="t">So are we still talking about how to tweak this data set?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2559" target="_blank">00:42:39.760</a></span> | <span class="t">If you wish.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2560" target="_blank">00:42:40.920</a></span> | <span class="t">Well, I'm not familiar with the countries here, so maybe.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2565" target="_blank">00:42:45.400</a></span> | <span class="t">This is Ecuador.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2566" target="_blank">00:42:46.400</a></span> | <span class="t">Ecuador.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2567" target="_blank">00:42:47.400</a></span> | <span class="t">So maybe I would start looking for Ecuador's holidays and shopping holidays, maybe when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2578" target="_blank">00:42:58.160</a></span> | <span class="t">they have a three-day weekend or a week off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2580" target="_blank">00:43:00.480</a></span> | <span class="t">Actually that information is provided in this case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2584" target="_blank">00:43:04.360</a></span> | <span class="t">And so in general, one way of tackling this kind of problem is to create lots and lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2592" target="_blank">00:43:12.360</a></span> | <span class="t">of new columns containing things like average number of sales on holidays, average percent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2599" target="_blank">00:43:19.160</a></span> | <span class="t">change in sale between January and February, and so on and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2603" target="_blank">00:43:23.560</a></span> | <span class="t">And so if you have a look at, there's been a previous competition on Kaggle called Rossman</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2611" target="_blank">00:43:31.280</a></span> | <span class="t">Store Sales that was almost identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2614" target="_blank">00:43:34.280</a></span> | <span class="t">It was in Germany in this case for a major grocery chain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2618" target="_blank">00:43:38.880</a></span> | <span class="t">How many items are sold by day, by item type, by store.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2623" target="_blank">00:43:43.400</a></span> | <span class="t">In this case, the person who won, quite unusually actually, was something of a domain expert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2630" target="_blank">00:43:50.520</a></span> | <span class="t">in this space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2631" target="_blank">00:43:51.520</a></span> | <span class="t">They're actually a specialist in doing logistics predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2636" target="_blank">00:43:56.320</a></span> | <span class="t">And this is basically what they did, he's a professional sales forecast consultant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2644" target="_blank">00:44:04.360</a></span> | <span class="t">He created just lots and lots and lots of columns based on his experience of what kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2649" target="_blank">00:44:09.280</a></span> | <span class="t">of things tend to be useful for making predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2653" target="_blank">00:44:13.360</a></span> | <span class="t">That's an approach that can work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2657" target="_blank">00:44:17.160</a></span> | <span class="t">The third place team did almost no feature engineering, however, and also they had one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2663" target="_blank">00:44:23.160</a></span> | <span class="t">big oversight, which I think they would have won if they hadn't had it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2666" target="_blank">00:44:26.520</a></span> | <span class="t">So you don't necessarily have to use this approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2670" target="_blank">00:44:30.560</a></span> | <span class="t">So anyway, we'll be learning a lot more about how to win this competition, and ones like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2677" target="_blank">00:44:37.360</a></span> | <span class="t">it as we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2680" target="_blank">00:44:40.120</a></span> | <span class="t">They did interview the third place team, so if you google for Kaggle or Rossman, you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2684" target="_blank">00:44:44.600</a></span> | <span class="t">see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2685" target="_blank">00:44:45.600</a></span> | <span class="t">The short answer is they used big money.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2690" target="_blank">00:44:50.120</a></span> | <span class="t">So one of the things, and these are a couple of charts, Terrence is actually my teammate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2694" target="_blank">00:44:54.360</a></span> | <span class="t">on this competition, so Terrence drew a couple of these charts for us, and I want to talk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2699" target="_blank">00:44:59.080</a></span> | <span class="t">about this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2701" target="_blank">00:45:01.400</a></span> | <span class="t">If you don't have a good validation set, it's hard if not impossible to create a good model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2709" target="_blank">00:45:09.120</a></span> | <span class="t">So in other words, if you're trying to predict next month's sales and you try to build a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2718" target="_blank">00:45:18.040</a></span> | <span class="t">model and you have no way of really knowing whether the models you built are good at predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2723" target="_blank">00:45:23.640</a></span> | <span class="t">sales a month ahead of time, then you have no way of knowing when you put your model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2727" target="_blank">00:45:27.840</a></span> | <span class="t">in production whether it's actually going to be any good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2733" target="_blank">00:45:33.000</a></span> | <span class="t">So you need a validation set that you know is reliable at telling you whether or not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2739" target="_blank">00:45:39.360</a></span> | <span class="t">your model is likely to work well when you put it into production or use it on the test</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2745" target="_blank">00:45:45.600</a></span> | <span class="t">set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2747" target="_blank">00:45:47.380</a></span> | <span class="t">So in this case, what Terrence has plotted here is, so normally you should not use your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2754" target="_blank">00:45:54.080</a></span> | <span class="t">test set for anything other than using it right at the end of the competition to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2760" target="_blank">00:46:00.840</a></span> | <span class="t">out how you've got.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2761" target="_blank">00:46:01.840</a></span> | <span class="t">But there's one thing I'm going to let you use the test set for in addition, and that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2766" target="_blank">00:46:06.680</a></span> | <span class="t">is to calibrate your validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2769" target="_blank">00:46:09.320</a></span> | <span class="t">So what Terrence did here was he built four different models, some which he thought would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2774" target="_blank">00:46:14.620</a></span> | <span class="t">be better than others, and he submitted each of the four models to Kaggle to find out its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2781" target="_blank">00:46:21.040</a></span> | <span class="t">score.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2782" target="_blank">00:46:22.040</a></span> | <span class="t">So the x-axis is the score that Kaggle told us on the leaderboard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2788" target="_blank">00:46:28.520</a></span> | <span class="t">And then on the y-axis, he plotted the score on a particular validation set he was trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2794" target="_blank">00:46:34.200</a></span> | <span class="t">out to see whether this validation set looked like it was going to be any good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2800" target="_blank">00:46:40.400</a></span> | <span class="t">So if your validation set is good, then the relationship between the leaderboard score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2806" target="_blank">00:46:46.200</a></span> | <span class="t">and the test set score and your validation set score should lie in a straight line.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2812" target="_blank">00:46:52.600</a></span> | <span class="t">Ideally it will actually lie on the y=x line, but honestly that doesn't matter too much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2818" target="_blank">00:46:58.880</a></span> | <span class="t">As long as, relatively speaking, it tells you which models are better than which other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2822" target="_blank">00:47:02.880</a></span> | <span class="t">models, then you know which model is the best.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2827" target="_blank">00:47:07.280</a></span> | <span class="t">And you know how it's going to perform on the test set because you know the linear relationship</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2831" target="_blank">00:47:11.520</a></span> | <span class="t">between the two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2833" target="_blank">00:47:13.440</a></span> | <span class="t">So in this case, Terrence has managed to come up with a validation set which is looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2838" target="_blank">00:47:18.400</a></span> | <span class="t">like it's going to predict our Kaggle leaderboard score pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2842" target="_blank">00:47:22.120</a></span> | <span class="t">And that's really cool because now he can go away and try 100 different types of models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2846" target="_blank">00:47:26.680</a></span> | <span class="t">feature engineering, weighting, tweaks, hyperparameters, whatever else, see how they go on the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2852" target="_blank">00:47:32.040</a></span> | <span class="t">set and not have to submit to Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2854" target="_blank">00:47:34.160</a></span> | <span class="t">So we're going to get a lot more iterations, a lot more feedback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2857" target="_blank">00:47:37.920</a></span> | <span class="t">This is not just true of Kaggle, but every machine learning project you do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2864" target="_blank">00:47:44.560</a></span> | <span class="t">So here's a different one he tried, where it wasn't as good, it's like these ones that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2870" target="_blank">00:47:50.000</a></span> | <span class="t">were quite close to each other, it's showing us the opposite direction, that's a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2873" target="_blank">00:47:53.800</a></span> | <span class="t">bad sign.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2874" target="_blank">00:47:54.800</a></span> | <span class="t">It's like this validation set idea didn't seem like a good idea, this validation set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2880" target="_blank">00:48:00.160</a></span> | <span class="t">idea didn't look like a good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2882" target="_blank">00:48:02.080</a></span> | <span class="t">So in general if your validation set is not showing a nice straight line, you need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2886" target="_blank">00:48:06.160</a></span> | <span class="t">think carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2887" target="_blank">00:48:07.760</a></span> | <span class="t">How is the test set constructed?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2890" target="_blank">00:48:10.240</a></span> | <span class="t">How is my validation set different?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2892" target="_blank">00:48:12.000</a></span> | <span class="t">There's some way you're constructing it which is different, you're going to have to draw</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2896" target="_blank">00:48:16.440</a></span> | <span class="t">lots of charts and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2902" target="_blank">00:48:22.720</a></span> | <span class="t">So one question is, and I'm going to try to guess how you did it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2907" target="_blank">00:48:27.720</a></span> | <span class="t">So how do you actually try to construct this validation set as close to the...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2912" target="_blank">00:48:32.280</a></span> | <span class="t">So what I would try to do is to try to sample points from the training set that are very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2917" target="_blank">00:48:37.600</a></span> | <span class="t">closer possible to some of the points in the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2921" target="_blank">00:48:41.920</a></span> | <span class="t">Of course in what sense?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2923" target="_blank">00:48:43.600</a></span> | <span class="t">I don't know, I would have to find the features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2925" target="_blank">00:48:45.320</a></span> | <span class="t">What would you guess?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2926" target="_blank">00:48:46.320</a></span> | <span class="t">In this case?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2927" target="_blank">00:48:47.320</a></span> | <span class="t">For this groceries?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2928" target="_blank">00:48:48.320</a></span> | <span class="t">For this groceries, the last points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2930" target="_blank">00:48:50.320</a></span> | <span class="t">Yeah, close by date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2931" target="_blank">00:48:51.320</a></span> | <span class="t">By date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2932" target="_blank">00:48:52.320</a></span> | <span class="t">So basically all the different things Terrence was trying were different variations of close</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2939" target="_blank">00:48:59.360</a></span> | <span class="t">by date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2940" target="_blank">00:49:00.360</a></span> | <span class="t">So the most recent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2942" target="_blank">00:49:02.960</a></span> | <span class="t">What I noticed was, so first I looked at the date range of the test set and then I looked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2950" target="_blank">00:49:10.800</a></span> | <span class="t">at the kernel that described how he or she...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2955" target="_blank">00:49:15.240</a></span> | <span class="t">So here is the date range of the test set, so the last two weeks of August 26, 2017.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2960" target="_blank">00:49:20.920</a></span> | <span class="t">That's right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2961" target="_blank">00:49:21.920</a></span> | <span class="t">And then the person who submitted the kernel that said how to get the 0.58 leaderboard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2967" target="_blank">00:49:27.040</a></span> | <span class="t">position or whatever score...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2968" target="_blank">00:49:28.240</a></span> | <span class="t">Yeah, the average by group, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2969" target="_blank">00:49:29.600</a></span> | <span class="t">I looked at the date range of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2971" target="_blank">00:49:31.960</a></span> | <span class="t">And that was...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2972" target="_blank">00:49:32.960</a></span> | <span class="t">It was like 9 or 10 days.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2975" target="_blank">00:49:35.200</a></span> | <span class="t">Well, it was actually 14 days and the test set is 16 days, but the interesting thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2980" target="_blank">00:49:40.240</a></span> | <span class="t">is the test set begins on the day after payday and ends on the payday.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2988" target="_blank">00:49:48.920</a></span> | <span class="t">And so these are things I also paid attention to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2991" target="_blank">00:49:51.400</a></span> | <span class="t">But...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2992" target="_blank">00:49:52.400</a></span> | <span class="t">And I think that's one of the bits of metadata that they told us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=2996" target="_blank">00:49:56.920</a></span> | <span class="t">These are the kinds of things you've just got to try, like I said, to plot lots of pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3003" target="_blank">00:50:03.880</a></span> | <span class="t">And even if you didn't know it was payday, you would want to draw the time series chart</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3008" target="_blank">00:50:08.640</a></span> | <span class="t">of sales and you would hopefully see that every two weeks there would be a spike or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3013" target="_blank">00:50:13.040</a></span> | <span class="t">whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3014" target="_blank">00:50:14.040</a></span> | <span class="t">And you'd be like, "Oh, I want to make sure that I have the same number of spikes in my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3018" target="_blank">00:50:18.440</a></span> | <span class="t">validation set that I've had in my test set," for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3022" target="_blank">00:50:22.760</a></span> | <span class="t">Let's take a 5-minute break and let's come back at 2.32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3039" target="_blank">00:50:39.440</a></span> | <span class="t">This is my favorite bit -- interpreting machine learning models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3043" target="_blank">00:50:43.720</a></span> | <span class="t">By the way, if you're looking for my notebook about the groceries competition, you won't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3050" target="_blank">00:50:50.760</a></span> | <span class="t">find it in GitHub because I'm not allowed to share code for running competitions with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3056" target="_blank">00:50:56.160</a></span> | <span class="t">you unless you're on the same team as me, that's the rule.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3060" target="_blank">00:51:00.240</a></span> | <span class="t">After the competition is finished, it will be on GitHub, however, so if you're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3063" target="_blank">00:51:03.640</a></span> | <span class="t">this through the video you should be able to find it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3067" target="_blank">00:51:07.800</a></span> | <span class="t">So let's start by reading in our feather file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3075" target="_blank">00:51:15.680</a></span> | <span class="t">So our feather file is exactly the same as our CSV file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3079" target="_blank">00:51:19.680</a></span> | <span class="t">This is for our blue book for bulldozers competition, so we're trying to predict the sale price</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3084" target="_blank">00:51:24.420</a></span> | <span class="t">of heavy industrial equipment and option.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3088" target="_blank">00:51:28.000</a></span> | <span class="t">And so reading the feather format file means that we've already read in the CSV and processed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3093" target="_blank">00:51:33.680</a></span> | <span class="t">it into categories.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3096" target="_blank">00:51:36.080</a></span> | <span class="t">And so the next thing we do is to run PROC DF in order to turn the categories into integers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3101" target="_blank">00:51:41.480</a></span> | <span class="t">deal with the missing values, and pull out the independent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3106" target="_blank">00:51:46.800</a></span> | <span class="t">This is exactly the same thing as we used last time to create a validation set where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3111" target="_blank">00:51:51.160</a></span> | <span class="t">the validation set represents the last couple of weeks, the last 12,000 records by date.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3119" target="_blank">00:51:59.860</a></span> | <span class="t">And I discovered, thanks to one of your excellent questions on the forum last week, I had a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3126" target="_blank">00:52:06.120</a></span> | <span class="t">bug here which is that PROC DF was shuffling the order, sorry, not PROC DF, and last week</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3141" target="_blank">00:52:21.400</a></span> | <span class="t">we saw a particular version of PROC DF where we passed in a subset, and when I passed in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3150" target="_blank">00:52:30.320</a></span> | <span class="t">the subset it was randomly shuffling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3152" target="_blank">00:52:32.760</a></span> | <span class="t">And so then when I said split_valves, it wasn't getting the last rows by date, but it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3159" target="_blank">00:52:39.080</a></span> | <span class="t">getting a random set of rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3160" target="_blank">00:52:40.600</a></span> | <span class="t">So I've now fixed that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3161" target="_blank">00:52:41.920</a></span> | <span class="t">So if you rerun the lesson 1 RF code, you'll see slightly different results, specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3169" target="_blank">00:52:49.440</a></span> | <span class="t">you'll see in that section that my validation set results look less good, but that's only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3175" target="_blank">00:52:55.380</a></span> | <span class="t">for this tiny little bit where I had subset equals set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3184" target="_blank">00:53:04.480</a></span> | <span class="t">I'm a little bit confused about the notation here, so as is both an input variable and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3190" target="_blank">00:53:10.160</a></span> | <span class="t">it's also the output variable of this function, and why is that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3197" target="_blank">00:53:17.640</a></span> | <span class="t">The PROC DF returns a dictionary telling you which columns were missing and for each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3206" target="_blank">00:53:26.320</a></span> | <span class="t">those columns what the median was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3209" target="_blank">00:53:29.920</a></span> | <span class="t">So when you call it on the larger dataset, the non-subset, you want to take that return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3218" target="_blank">00:53:38.620</a></span> | <span class="t">value and you don't pass in an object to that point, you just want to get back the result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3224" target="_blank">00:53:44.640</a></span> | <span class="t">Later on when you pass it into a subset, you want to have the same missing columns and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3229" target="_blank">00:53:49.040</a></span> | <span class="t">the same medians, and so you pass it in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3232" target="_blank">00:53:52.760</a></span> | <span class="t">And if this different subset, like if it was a whole different dataset, turned out it had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3238" target="_blank">00:53:58.440</a></span> | <span class="t">some different missing columns, it would update that dictionary with additional key values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3245" target="_blank">00:54:05.720</a></span> | <span class="t">as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3248" target="_blank">00:54:08.860</a></span> | <span class="t">You don't have to pass it in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3250" target="_blank">00:54:10.600</a></span> | <span class="t">If you don't pass it in, it just gives you the information about what was missing and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3254" target="_blank">00:54:14.840</a></span> | <span class="t">the medians.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3255" target="_blank">00:54:15.840</a></span> | <span class="t">If you do pass it in, it uses that information for any missing columns that are there, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3263" target="_blank">00:54:23.320</a></span> | <span class="t">if there are some new missing columns, it will update that dictionary with that additional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3266" target="_blank">00:54:26.960</a></span> | <span class="t">information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3267" target="_blank">00:54:27.960</a></span> | <span class="t">So it's like keeping all the datasets, all the column information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3272" target="_blank">00:54:32.000</a></span> | <span class="t">Yeah, it's going to keep track of any missing columns that you came across in anything you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3276" target="_blank">00:54:36.640</a></span> | <span class="t">passed to PropDF.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3282" target="_blank">00:54:42.080</a></span> | <span class="t">So we split it into the training and test set just like we did last week, and so to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3287" target="_blank">00:54:47.760</a></span> | <span class="t">remind you, once we've done PropDF, this is what it looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3292" target="_blank">00:54:52.120</a></span> | <span class="t">This is the log of sale price.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3295" target="_blank">00:54:55.720</a></span> | <span class="t">So the first thing to think about is we already know how to get the predictions, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3302" target="_blank">00:55:02.240</a></span> | <span class="t">we take the average value in each leaf node, in each tree after running a particular row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3311" target="_blank">00:55:11.960</a></span> | <span class="t">through each tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3312" target="_blank">00:55:12.960</a></span> | <span class="t">That's how we get the prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3316" target="_blank">00:55:16.520</a></span> | <span class="t">But normally we don't just want a prediction, we also want to know how confident we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3321" target="_blank">00:55:21.520</a></span> | <span class="t">of that prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3323" target="_blank">00:55:23.000</a></span> | <span class="t">And so we would be less confident of a prediction if we haven't seen many examples of rows like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3331" target="_blank">00:55:31.080</a></span> | <span class="t">this one, and if we haven't seen many examples of rows like this one, then we wouldn't expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3338" target="_blank">00:55:38.040</a></span> | <span class="t">any of the trees to have a path through which is really designed to help us predict that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3346" target="_blank">00:55:46.080</a></span> | <span class="t">row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3347" target="_blank">00:55:47.320</a></span> | <span class="t">And so conceptually, you would expect then that as you pass this unusual row through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3352" target="_blank">00:55:52.480</a></span> | <span class="t">different trees, it's going to end up in very different places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3358" target="_blank">00:55:58.320</a></span> | <span class="t">So in other words, rather than just taking the mean of the predictions of the trees and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3363" target="_blank">00:56:03.120</a></span> | <span class="t">saying that's our prediction, what if we took the standard deviation of the predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3368" target="_blank">00:56:08.920</a></span> | <span class="t">of the trees?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3370" target="_blank">00:56:10.520</a></span> | <span class="t">So the standard deviation of the predictions of the trees, if that's high, that means each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3376" target="_blank">00:56:16.680</a></span> | <span class="t">tree is giving us a very different estimate of this row's prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3384" target="_blank">00:56:24.680</a></span> | <span class="t">So if this was a really common kind of row, then the trees will have learnt to make good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3393" target="_blank">00:56:33.200</a></span> | <span class="t">predictions for it because it's seen lots of opportunities to split based on those kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3397" target="_blank">00:56:37.880</a></span> | <span class="t">of rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3399" target="_blank">00:56:39.760</a></span> | <span class="t">So the standard deviation of the predictions across the trees gives us some kind of relative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3408" target="_blank">00:56:48.440</a></span> | <span class="t">understanding of how confident we are of this prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3415" target="_blank">00:56:55.980</a></span> | <span class="t">So that is not something which exists in scikit-learn or in any library I know of, so we have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3427" target="_blank">00:57:07.040</a></span> | <span class="t">create it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3428" target="_blank">00:57:08.040</a></span> | <span class="t">But we already have almost the exact code we need because remember last lesson we actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3433" target="_blank">00:57:13.440</a></span> | <span class="t">manually calculated the averages across different sets of trees, so we can do exactly the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3438" target="_blank">00:57:18.360</a></span> | <span class="t">thing to calculate the standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3441" target="_blank">00:57:21.760</a></span> | <span class="t">When I'm doing random forest interpretation, I pretty much never use the full data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3448" target="_blank">00:57:28.480</a></span> | <span class="t">I always call set-rs-samples because we don't need a massively accurate random forest, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3456" target="_blank">00:57:36.160</a></span> | <span class="t">just need one which indicates the nature of the relationships involved.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3462" target="_blank">00:57:42.000</a></span> | <span class="t">And so I just make sure this number is high enough that if I call the same interpretation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3468" target="_blank">00:57:48.160</a></span> | <span class="t">commands multiple times, I don't get different results back each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3472" target="_blank">00:57:52.760</a></span> | <span class="t">That's like the rule of thumb about how big does it need to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3476" target="_blank">00:57:56.040</a></span> | <span class="t">But in practice, 50,000 is a high number and most of the time it would be surprising if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3482" target="_blank">00:58:02.080</a></span> | <span class="t">that wasn't enough, and it runs in seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3485" target="_blank">00:58:05.120</a></span> | <span class="t">So I generally start with 50,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3488" target="_blank">00:58:08.000</a></span> | <span class="t">So with my 50,000 samples per tree set, I create 40 estimators.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3493" target="_blank">00:58:13.480</a></span> | <span class="t">I know from last time that min_samples_leaf=3, max_features=0.5 isn't bad, and again we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3499" target="_blank">00:58:19.840</a></span> | <span class="t">not trying to create the world's most predictive tree anyway, so that all sounds fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3505" target="_blank">00:58:25.800</a></span> | <span class="t">We get an R^2 on the validation set of 0.89.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3509" target="_blank">00:58:29.240</a></span> | <span class="t">Again we don't particularly care, but as long as it's good enough, which it certainly is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3515" target="_blank">00:58:35.400</a></span> | <span class="t">And so here's where we can do that exact same list comprehension as last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3519" target="_blank">00:58:39.520</a></span> | <span class="t">Remember, go through each estimator, that's each tree, call .predict on it with our validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3525" target="_blank">00:58:45.840</a></span> | <span class="t">set, make that a list comprehension, and pass that to np.stack, which concatenates everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3531" target="_blank">00:58:51.920</a></span> | <span class="t">in that list across a new axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3536" target="_blank">00:58:56.000</a></span> | <span class="t">So now our rows are the results of each tree and our columns are the result of each row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3541" target="_blank">00:59:01.640</a></span> | <span class="t">in the original dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3543" target="_blank">00:59:03.760</a></span> | <span class="t">And then we remember we can calculate the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3547" target="_blank">00:59:07.200</a></span> | <span class="t">So here's the prediction for our dataset row number 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3552" target="_blank">00:59:12.800</a></span> | <span class="t">And here's our standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3555" target="_blank">00:59:15.560</a></span> | <span class="t">So here's how to do it for just one observation at the end here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3561" target="_blank">00:59:21.040</a></span> | <span class="t">We've calculated for all of them, just printing it for one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3570" target="_blank">00:59:30.280</a></span> | <span class="t">This can take quite a while, and specifically it's not taking advantage of the fact that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3575" target="_blank">00:59:35.720</a></span> | <span class="t">my computer has lots of cores in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3581" target="_blank">00:59:41.220</a></span> | <span class="t">List comprehension itself is Python code, and Python code, unless you're doing special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3591" target="_blank">00:59:51.080</a></span> | <span class="t">stuff, runs in serial, which means it runs on a single CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3595" target="_blank">00:59:55.120</a></span> | <span class="t">It doesn't take advantage of your multi-CPU hardware.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3598" target="_blank">00:59:58.680</a></span> | <span class="t">And so if I wanted to run this on more trees and more data, this one second is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3605" target="_blank">01:00:05.000</a></span> | <span class="t">go up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3606" target="_blank">01:00:06.000</a></span> | <span class="t">And you see here the wall time, the amount of actual time it took, is roughly equal to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3609" target="_blank">01:00:09.920</a></span> | <span class="t">the CPU time, where else if it was running on lots of cores, the CPU time would be higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3615" target="_blank">01:00:15.000</a></span> | <span class="t">than the wall time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3616" target="_blank">01:00:16.840</a></span> | <span class="t">So it turns out that scikit-learn, actually not scikit-learn, fast.ai provides a handy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3626" target="_blank">01:00:26.560</a></span> | <span class="t">function called parallel_trees, which calls some stuff inside scikit-learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3631" target="_blank">01:00:31.840</a></span> | <span class="t">And parallel_trees takes two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3634" target="_blank">01:00:34.320</a></span> | <span class="t">It takes a random forest model that I trained, here it is, n, and some function to call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3642" target="_blank">01:00:42.820</a></span> | <span class="t">And it calls that function on every tree in parallel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3647" target="_blank">01:00:47.560</a></span> | <span class="t">So in other words, rather than calling t.predict_x_valid, let's create a function that calls t.predict_x_valid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3655" target="_blank">01:00:55.320</a></span> | <span class="t">Let's use parallel_trees to call it on our model for every tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3659" target="_blank">01:00:59.960</a></span> | <span class="t">And it will return a list of the result of applying that function to every tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3667" target="_blank">01:01:07.240</a></span> | <span class="t">And so then we can np.stack_that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3669" target="_blank">01:01:09.320</a></span> | <span class="t">So hopefully you can see that that code and that code are basically the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3676" target="_blank">01:01:16.160</a></span> | <span class="t">But this one is doing it in parallel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3678" target="_blank">01:01:18.920</a></span> | <span class="t">And so you can see here, now our wall time has gone down to 500ms, and it's now giving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3689" target="_blank">01:01:29.040</a></span> | <span class="t">us exactly the same answer, so a little bit faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3693" target="_blank">01:01:33.400</a></span> | <span class="t">Time permitting, we'll talk about more general ways of writing code that runs in parallel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3698" target="_blank">01:01:38.480</a></span> | <span class="t">because it turns out to be super useful for data science.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3701" target="_blank">01:01:41.900</a></span> | <span class="t">But here's one that we can use that's very specific to random forests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3708" target="_blank">01:01:48.520</a></span> | <span class="t">So what we can now do is we can always call this to get our predictions for each tree,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3716" target="_blank">01:01:56.240</a></span> | <span class="t">and then we can call standard deviation to then get them for every row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3722" target="_blank">01:02:02.040</a></span> | <span class="t">And so let's try using that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3724" target="_blank">01:02:04.000</a></span> | <span class="t">So what I could do is let's create a copy of our data and let's add an additional column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3729" target="_blank">01:02:09.680</a></span> | <span class="t">to it, which is the standard deviation of the predictions across the first axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3738" target="_blank">01:02:18.100</a></span> | <span class="t">And let's also add in the mean, so they're the predictions themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3745" target="_blank">01:02:25.040</a></span> | <span class="t">So you might remember from last lesson that one of the predictors we have is called enclosure,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3754" target="_blank">01:02:34.660</a></span> | <span class="t">and we'll see later on that this is an important predictor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3757" target="_blank">01:02:37.920</a></span> | <span class="t">And so let's start by just doing a histogram.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3760" target="_blank">01:02:40.080</a></span> | <span class="t">So one of the nice things in pandas is it's got built-in plotting capabilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3764" target="_blank">01:02:44.080</a></span> | <span class="t">It's well worth Googling for pandas plotting to see how to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3769" target="_blank">01:02:49.960</a></span> | <span class="t">Yes, Terrence?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3771" target="_blank">01:02:51.840</a></span> | <span class="t">Can you remind me what enclosure is?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3775" target="_blank">01:02:55.120</a></span> | <span class="t">So we don't know what it means, and it doesn't matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3781" target="_blank">01:03:01.800</a></span> | <span class="t">I guess the whole purpose of this process is that we're going to learn about what things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3788" target="_blank">01:03:08.560</a></span> | <span class="t">are, or at least what things are important, and later on figure out what they are and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3792" target="_blank">01:03:12.080</a></span> | <span class="t">how they're important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3793" target="_blank">01:03:13.080</a></span> | <span class="t">So we're going to start out knowing nothing about this data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3797" target="_blank">01:03:17.720</a></span> | <span class="t">So I'm just going to look at something called enclosure that has something called EROPS</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3801" target="_blank">01:03:21.320</a></span> | <span class="t">and something called OROPS, and I don't even know what this is yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3804" target="_blank">01:03:24.000</a></span> | <span class="t">All I know is that the only three that really appear in any great quantity are OROPS, EROPS,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3810" target="_blank">01:03:30.240</a></span> | <span class="t">WAC, and EROPS.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3812" target="_blank">01:03:32.580</a></span> | <span class="t">And this is really common as a data scientist, you often find yourself looking at data that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3816" target="_blank">01:03:36.840</a></span> | <span class="t">you're not that familiar with, and you've got to figure out at least which bits to study</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3821" target="_blank">01:03:41.180</a></span> | <span class="t">more carefully and which bits to matter and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3824" target="_blank">01:03:44.160</a></span> | <span class="t">So in this case, I at least know that these three groups I really don't care about because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3828" target="_blank">01:03:48.120</a></span> | <span class="t">they basically don't exist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3831" target="_blank">01:03:51.680</a></span> | <span class="t">So given that, we're going to ignore those three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3835" target="_blank">01:03:55.240</a></span> | <span class="t">So we're going to focus on this one here, this one here, and this one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3840" target="_blank">01:04:00.080</a></span> | <span class="t">And so here you can see what I've done is I've taken my data frame and I've grouped</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3848" target="_blank">01:04:08.880</a></span> | <span class="t">by enclosure, and I am taking the average of these three fields.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3857" target="_blank">01:04:17.480</a></span> | <span class="t">So here you can see the average sale price, the average prediction, and the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3862" target="_blank">01:04:22.360</a></span> | <span class="t">of prediction for each of my three groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3865" target="_blank">01:04:25.120</a></span> | <span class="t">So I can already start to learn a bit here, as you would expect, the prediction and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3871" target="_blank">01:04:31.800</a></span> | <span class="t">sale price are close to each other on average, so that's a good sign.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3879" target="_blank">01:04:39.480</a></span> | <span class="t">And then the standard deviation varies a little bit, it's a little hard to see in a table,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3884" target="_blank">01:04:44.320</a></span> | <span class="t">so what we could do is we could try to start printing these things out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3890" target="_blank">01:04:50.880</a></span> | <span class="t">So here we've got the sale price for each level of enclosure, and here we've got the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3899" target="_blank">01:04:59.320</a></span> | <span class="t">prediction for each level of enclosure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3902" target="_blank">01:05:02.080</a></span> | <span class="t">And for the error bars, I'm using the standard deviation of prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3906" target="_blank">01:05:06.060</a></span> | <span class="t">So here you can see the actual, and here's the prediction, and here's my confidence interval.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3917" target="_blank">01:05:17.040</a></span> | <span class="t">Or at least it's the average of the standard deviation of the random virus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3922" target="_blank">01:05:22.080</a></span> | <span class="t">So this will tell us if there's some groups or some rows that we're not very confident</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3927" target="_blank">01:05:27.360</a></span> | <span class="t">of at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3930" target="_blank">01:05:30.140</a></span> | <span class="t">So we could do something similar for product size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3933" target="_blank">01:05:33.320</a></span> | <span class="t">So here's different product sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3936" target="_blank">01:05:36.240</a></span> | <span class="t">We could do exactly the same thing of looking at our predictions of standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3943" target="_blank">01:05:43.000</a></span> | <span class="t">We could sort by, and what we could say is, what's the ratio of the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3949" target="_blank">01:05:49.240</a></span> | <span class="t">of the predictions to the predictions themselves?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3951" target="_blank">01:05:51.280</a></span> | <span class="t">So you'd kind of expect on average that when you're predicting something that's a bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3955" target="_blank">01:05:55.760</a></span> | <span class="t">number that your standard deviation would be higher, so you can sort by that ratio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3962" target="_blank">01:06:02.080</a></span> | <span class="t">And what that tells us is that the product size large and product size compact, our predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3969" target="_blank">01:06:09.680</a></span> | <span class="t">are less accurate, relatively speaking, as a ratio of the total price.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3974" target="_blank">01:06:14.960</a></span> | <span class="t">And so if we go back and have a look, there you go, that's why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3980" target="_blank">01:06:20.520</a></span> | <span class="t">From the histogram, those are the smallest groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3984" target="_blank">01:06:24.120</a></span> | <span class="t">So as you would expect, in small groups we're doing a less good job.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3989" target="_blank">01:06:29.880</a></span> | <span class="t">So this confidence interval you can really use for two main purposes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3994" target="_blank">01:06:34.200</a></span> | <span class="t">One is that you can group it up like this and look at the average confidence interval</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=3999" target="_blank">01:06:39.080</a></span> | <span class="t">by group to find out if there are some groups that you just don't seem to have confidence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4005" target="_blank">01:06:45.040</a></span> | <span class="t">about those groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4006" target="_blank">01:06:46.600</a></span> | <span class="t">But perhaps more importantly, you can look at them for specific rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4010" target="_blank">01:06:50.800</a></span> | <span class="t">So when you put it in production, you might always want to see the confidence interval.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4016" target="_blank">01:06:56.280</a></span> | <span class="t">So if you're doing credit scoring, so deciding whether to get somebody a loan, you probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4021" target="_blank">01:07:01.600</a></span> | <span class="t">want to see not only what's their level of risk, but how confident are we.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4025" target="_blank">01:07:05.760</a></span> | <span class="t">And if they want to borrow lots of money, and we're not at all confident about our ability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4030" target="_blank">01:07:10.480</a></span> | <span class="t">to predict whether they'll pay it back, we might want to give them a smaller loan.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4036" target="_blank">01:07:16.520</a></span> | <span class="t">So those are the two ways in which you would use this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4041" target="_blank">01:07:21.400</a></span> | <span class="t">Let me go to the next one, which is the most important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4044" target="_blank">01:07:24.680</a></span> | <span class="t">The most important is feature importance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4047" target="_blank">01:07:27.840</a></span> | <span class="t">The only reason I didn't do this first is because I think the intuitive understanding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4052" target="_blank">01:07:32.600</a></span> | <span class="t">of how to calculate confidence interval is the easiest one to understand intuitively.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4057" target="_blank">01:07:37.120</a></span> | <span class="t">In fact, it's almost identical to something we've already calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4061" target="_blank">01:07:41.080</a></span> | <span class="t">But in terms of which one do I look at first in practice, I always look at this in practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4067" target="_blank">01:07:47.440</a></span> | <span class="t">So when I'm working on a cattle competition or a real-world project, I build a random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4073" target="_blank">01:07:53.720</a></span> | <span class="t">forest as fast as I can, try and get it to the point that it's significantly better than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4081" target="_blank">01:08:01.640</a></span> | <span class="t">random, but doesn't have to be much better than that, and the next thing I do is to plot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4086" target="_blank">01:08:06.240</a></span> | <span class="t">the feature importance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4087" target="_blank">01:08:07.880</a></span> | <span class="t">The feature importance tells us in this random forest which columns matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4096" target="_blank">01:08:16.520</a></span> | <span class="t">So we had dozens and dozens of columns originally in this dataset, and here I'm just picking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4102" target="_blank">01:08:22.600</a></span> | <span class="t">out the top 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4104" target="_blank">01:08:24.320</a></span> | <span class="t">So you can just call rf_feature_importance, again this is part of the fast.ai library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4109" target="_blank">01:08:29.540</a></span> | <span class="t">it's leveraging stuff that's in scikit-learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4112" target="_blank">01:08:32.080</a></span> | <span class="t">Pass in the model, pass in the data frame, because we need to know the names of columns,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4117" target="_blank">01:08:37.960</a></span> | <span class="t">and it'll tell you, it'll order, give you back a pandas data frame showing you in order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4124" target="_blank">01:08:44.120</a></span> | <span class="t">of importance how important was each column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4127" target="_blank">01:08:47.080</a></span> | <span class="t">And here I'm just going to pick out the top 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4131" target="_blank">01:08:51.320</a></span> | <span class="t">So we can then plot that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4133" target="_blank">01:08:53.240</a></span> | <span class="t">So fi, because it's a data frame, we can use data frame plotting commands.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4141" target="_blank">01:09:01.000</a></span> | <span class="t">So here I've plotted all of the feature importances.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4145" target="_blank">01:09:05.760</a></span> | <span class="t">And so you can see here, and I haven't been able to write all of the names of the columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4150" target="_blank">01:09:10.140</a></span> | <span class="t">at the bottom, which that's not the important thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4152" target="_blank">01:09:12.440</a></span> | <span class="t">The important thing is to see that some columns are really, really important, and most columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4158" target="_blank">01:09:18.640</a></span> | <span class="t">don't really matter at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4160" target="_blank">01:09:20.640</a></span> | <span class="t">In nearly every dataset you use in real life, this is what your feature importance is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4166" target="_blank">01:09:26.760</a></span> | <span class="t">to look like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4167" target="_blank">01:09:27.760</a></span> | <span class="t">It's going to say there's a handful of columns you care about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4170" target="_blank">01:09:30.600</a></span> | <span class="t">And this is why I always start here, because at this point, in terms of looking into learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4177" target="_blank">01:09:37.960</a></span> | <span class="t">about this domain of heavy industrial equipment options, I'm only going to care about learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4184" target="_blank">01:09:44.400</a></span> | <span class="t">about the columns which matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4187" target="_blank">01:09:47.200</a></span> | <span class="t">So are we going to bother learning about enclosure?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4190" target="_blank">01:09:50.680</a></span> | <span class="t">Depends on whether enclosure is important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4195" target="_blank">01:09:55.800</a></span> | <span class="t">There it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4196" target="_blank">01:09:56.800</a></span> | <span class="t">It's in the top 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4197" target="_blank">01:09:57.800</a></span> | <span class="t">So we are going to have to learn about enclosure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4200" target="_blank">01:10:00.800</a></span> | <span class="t">So then we could also plot this as a bar plot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4205" target="_blank">01:10:05.480</a></span> | <span class="t">So here I've just created a tiny little function here that's going to just plot my bars, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4212" target="_blank">01:10:12.480</a></span> | <span class="t">I'm just going to do it for the top 30.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4215" target="_blank">01:10:15.000</a></span> | <span class="t">And so you can see the same basic shape here, and I can see there's my enclosure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4222" target="_blank">01:10:22.180</a></span> | <span class="t">So we're going to learn about how this is calculated in just a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4227" target="_blank">01:10:27.200</a></span> | <span class="t">But before we worry about how it's calculated, much more important is to know what to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4230" target="_blank">01:10:30.200</a></span> | <span class="t">with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4231" target="_blank">01:10:31.400</a></span> | <span class="t">So the most important thing to do with it is to now sit down with your client, or your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4237" target="_blank">01:10:37.680</a></span> | <span class="t">data dictionary, or whatever your source of information is, and say to them, "Tell me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4242" target="_blank">01:10:42.760</a></span> | <span class="t">about EMAID, what does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4245" target="_blank">01:10:45.160</a></span> | <span class="t">Where does it come from?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4247" target="_blank">01:10:47.360</a></span> | <span class="t">Lots of things like histograms of EMAID, scatter plots of EMAID against price, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4251" target="_blank">01:10:51.000</a></span> | <span class="t">learn everything you can because EMAID and coupler system, they're the things that matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4256" target="_blank">01:10:56.760</a></span> | <span class="t">And what will often happen in real-world projects is that you'll sit with the client and you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4261" target="_blank">01:11:01.200</a></span> | <span class="t">say, "Oh, it turns out the coupler system is the second most important thing," and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4265" target="_blank">01:11:05.520</a></span> | <span class="t">they might say, "That makes no sense."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4268" target="_blank">01:11:08.960</a></span> | <span class="t">Now that doesn't mean that there's a problem with your model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4272" target="_blank">01:11:12.000</a></span> | <span class="t">It means there's a problem with their understanding of the data that they gave you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4276" target="_blank">01:11:16.760</a></span> | <span class="t">So let me give you an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4278" target="_blank">01:11:18.720</a></span> | <span class="t">I entered a Kaggle competition where the goal was to predict which applications for grants</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4284" target="_blank">01:11:24.640</a></span> | <span class="t">at a university would be successful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4288" target="_blank">01:11:28.100</a></span> | <span class="t">And I used this exact approach and I discovered a number of columns which were almost entirely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4294" target="_blank">01:11:34.080</a></span> | <span class="t">predictive of the dependent variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4296" target="_blank">01:11:36.480</a></span> | <span class="t">And specifically when I then looked to see in what way they were predictive, it turned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4299" target="_blank">01:11:39.680</a></span> | <span class="t">out whether they were missing or not was basically the only thing that mattered in this dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4307" target="_blank">01:11:47.160</a></span> | <span class="t">And so later on, I ended up winning that competition and I think a lot of it was thanks to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4311" target="_blank">01:11:51.640</a></span> | <span class="t">insight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4313" target="_blank">01:11:53.600</a></span> | <span class="t">And so later on I heard what had happened.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4316" target="_blank">01:11:56.400</a></span> | <span class="t">But it turns out that at that university, there's an administrative burden to filling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4322" target="_blank">01:12:02.000</a></span> | <span class="t">out the database.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4323" target="_blank">01:12:03.480</a></span> | <span class="t">And so for a lot of the grant applications, they don't fill in the database for the folks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4329" target="_blank">01:12:09.080</a></span> | <span class="t">whose applications weren't accepted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4331" target="_blank">01:12:11.880</a></span> | <span class="t">So in other words, these missing values in the dataset were saying, 'Okay, this grant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4337" target="_blank">01:12:17.520</a></span> | <span class="t">wasn't accepted because if it was accepted, then the admin folks are going to go in and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4343" target="_blank">01:12:23.320</a></span> | <span class="t">type in that information.'</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4345" target="_blank">01:12:25.120</a></span> | <span class="t">So this is what we call data leakage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4347" target="_blank">01:12:27.800</a></span> | <span class="t">Data leakage means there's information in the dataset that I was modelling with which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4353" target="_blank">01:12:33.200</a></span> | <span class="t">the university wouldn't have had in real life at the point in time they were making a decision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4359" target="_blank">01:12:39.040</a></span> | <span class="t">So when they're actually deciding which grant applications should I prioritise, they don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4367" target="_blank">01:12:47.720</a></span> | <span class="t">actually know which ones the admin staff are going to add information to because it turns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4372" target="_blank">01:12:52.560</a></span> | <span class="t">out they got accepted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4375" target="_blank">01:12:55.740</a></span> | <span class="t">So one of the key things you'll find here is data leakage problems, and that's a serious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4383" target="_blank">01:13:03.000</a></span> | <span class="t">problem that you need to deal with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4386" target="_blank">01:13:06.440</a></span> | <span class="t">The other thing that will happen is you'll often find its signs of collinearity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4391" target="_blank">01:13:11.920</a></span> | <span class="t">I think that's what's happened here with Coupler system.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4393" target="_blank">01:13:13.800</a></span> | <span class="t">I think Coupler system tells you whether or not a particular kind of heavy industrial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4398" target="_blank">01:13:18.880</a></span> | <span class="t">equipment has a particular feature on it, but if it's not that kind of industrial equipment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4405" target="_blank">01:13:25.400</a></span> | <span class="t">at all, it will be empty, it will be missing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4408" target="_blank">01:13:28.120</a></span> | <span class="t">And so Coupler system is really telling you whether or not it's a certain class of heavy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4413" target="_blank">01:13:33.240</a></span> | <span class="t">industrial equipment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4414" target="_blank">01:13:34.240</a></span> | <span class="t">Now this is not leakage, this is actual information you actually have at the right time, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4418" target="_blank">01:13:38.760</a></span> | <span class="t">just that interpreting it, you have to be careful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4425" target="_blank">01:13:45.680</a></span> | <span class="t">So I would go through at least the top 10 or look for where the natural breakpoints</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4429" target="_blank">01:13:49.600</a></span> | <span class="t">are and really study these things carefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4433" target="_blank">01:13:53.320</a></span> | <span class="t">To make life easier for myself, what I tend to do is I try to throw some data away and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4437" target="_blank">01:13:57.960</a></span> | <span class="t">see if that matters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4439" target="_blank">01:13:59.480</a></span> | <span class="t">So in this case, I had a random forest which, let's go and see how accurate it was, 0.889.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4454" target="_blank">01:14:14.200</a></span> | <span class="t">What I did was I said here, let's go through our feature importance data frame and filter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4459" target="_blank">01:14:19.160</a></span> | <span class="t">out those where the importance is greater than 0.005, so 0.025 is about here, it's kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4469" target="_blank">01:14:29.800</a></span> | <span class="t">of like where they really flatten off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4472" target="_blank">01:14:32.200</a></span> | <span class="t">So let's just keep those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4477" target="_blank">01:14:37.840</a></span> | <span class="t">And so that gives us a list of 25 column names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4481" target="_blank">01:14:41.760</a></span> | <span class="t">And so then I say let's now create a new data frame view which just contains those 25 columns,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4491" target="_blank">01:14:51.600</a></span> | <span class="t">call split_bals on it again, split into test and training set, and create a new random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4496" target="_blank">01:14:56.200</a></span> | <span class="t">forest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4498" target="_blank">01:14:58.440</a></span> | <span class="t">And let's see what happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4500" target="_blank">01:15:00.440</a></span> | <span class="t">And you can see here the R^2 basically didn't change, 8.9.1 versus 8.9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4511" target="_blank">01:15:11.560</a></span> | <span class="t">So it's actually increased a tiny bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4513" target="_blank">01:15:13.920</a></span> | <span class="t">I mean generally speaking, removing redundant columns, obviously it shouldn't make it worse,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4521" target="_blank">01:15:21.400</a></span> | <span class="t">if it makes it worse, they won't be redundant after all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4524" target="_blank">01:15:24.120</a></span> | <span class="t">It might make it a little better because if you think about how we built these trees when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4528" target="_blank">01:15:28.520</a></span> | <span class="t">it's deciding what to split on, it's got less things to have to worry about trying, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4533" target="_blank">01:15:33.520</a></span> | <span class="t">less often going to accidentally find a crappy column, so it's got a slightly better opportunity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4539" target="_blank">01:15:39.360</a></span> | <span class="t">to create a slightly better tree with slightly less data, but it's not going to change it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4543" target="_blank">01:15:43.840</a></span> | <span class="t">by much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4544" target="_blank">01:15:44.840</a></span> | <span class="t">But it's going to make it a bit faster and it's going to let us focus on what matters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4549" target="_blank">01:15:49.360</a></span> | <span class="t">So if I rerun feature importance now, I've now got 25.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4555" target="_blank">01:15:55.920</a></span> | <span class="t">Now the key thing that's happened is that when you remove redundant columns is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4562" target="_blank">01:16:02.120</a></span> | <span class="t">you're also removing sources of collinearity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4565" target="_blank">01:16:05.080</a></span> | <span class="t">In other words, two columns that might be related to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4569" target="_blank">01:16:09.680</a></span> | <span class="t">Now collinearity doesn't make your random forest less predictive, but if you have two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4576" target="_blank">01:16:16.320</a></span> | <span class="t">columns that are related to each other, this column is a little bit related to this column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4582" target="_blank">01:16:22.080</a></span> | <span class="t">and this column is a strong driver of the dependent variable, then what's going to happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4586" target="_blank">01:16:26.080</a></span> | <span class="t">is that the importance is going to end up split between the two collinear columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4592" target="_blank">01:16:32.600</a></span> | <span class="t">It's going to say both of those columns matter, so it's going to split it between the two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4597" target="_blank">01:16:37.080</a></span> | <span class="t">So by removing some of those columns with very little impact, it makes your feature</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4603" target="_blank">01:16:43.120</a></span> | <span class="t">importance clearer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4604" target="_blank">01:16:44.120</a></span> | <span class="t">So you can see here actually, yearmade was pretty close to couple system before, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4612" target="_blank">01:16:52.360</a></span> | <span class="t">there must have been a bunch of things that were collinear with yearmade, which makes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4615" target="_blank">01:16:55.840</a></span> | <span class="t">perfect sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4616" target="_blank">01:16:56.840</a></span> | <span class="t">Like old industrial equipment wouldn't have had a bunch of technical features that new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4622" target="_blank">01:17:02.640</a></span> | <span class="t">ones would, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4624" target="_blank">01:17:04.760</a></span> | <span class="t">So it's actually saying yearmade really, really matters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4629" target="_blank">01:17:09.160</a></span> | <span class="t">So I trust this feature importance better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4633" target="_blank">01:17:13.200</a></span> | <span class="t">The predictive accuracy of the model is a tiny bit better, but this feature importance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4636" target="_blank">01:17:16.680</a></span> | <span class="t">has a lot less collinearity to confuse us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4642" target="_blank">01:17:22.120</a></span> | <span class="t">So let's talk about how this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4644" target="_blank">01:17:24.720</a></span> | <span class="t">It's actually really simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4647" target="_blank">01:17:27.040</a></span> | <span class="t">And not only is it really simple, it's a technique you can use not just for random forests, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4653" target="_blank">01:17:33.760</a></span> | <span class="t">for basically any kind of machine learning model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4659" target="_blank">01:17:39.200</a></span> | <span class="t">And interestingly, almost no one knows that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4663" target="_blank">01:17:43.960</a></span> | <span class="t">Many people will tell you this particular kind of model, there's no way of interpreting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4669" target="_blank">01:17:49.440</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4670" target="_blank">01:17:50.440</a></span> | <span class="t">And the most important interpretation of a model is knowing which things are important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4674" target="_blank">01:17:54.360</a></span> | <span class="t">And that's almost certainly not going to be true, because this technique I'm going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4677" target="_blank">01:17:57.240</a></span> | <span class="t">teach you actually works for any kind of model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4679" target="_blank">01:17:59.280</a></span> | <span class="t">So here's what we're going to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4680" target="_blank">01:18:00.280</a></span> | <span class="t">We're going to take our data set, the bulldozers, and we've got this column which we're trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4685" target="_blank">01:18:05.680</a></span> | <span class="t">to predict, which is price.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4690" target="_blank">01:18:10.200</a></span> | <span class="t">And then we've got all of our independent variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4694" target="_blank">01:18:14.360</a></span> | <span class="t">So here's an independent variable here, yearMade, plus a whole bunch of other variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4702" target="_blank">01:18:22.760</a></span> | <span class="t">And remember, after we did a bit of trimming, we had 25 independent variables.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4712" target="_blank">01:18:32.120</a></span> | <span class="t">How do we figure out how important yearMade is?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4717" target="_blank">01:18:37.560</a></span> | <span class="t">Well we've got our whole random forest, and we can find out our predictive accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4723" target="_blank">01:18:43.120</a></span> | <span class="t">So we're going to put all of these rows through our random forest, and we're going to spit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4730" target="_blank">01:18:50.280</a></span> | <span class="t">out some predictions, and we're going to compare them to the actual price you get in this case,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4736" target="_blank">01:18:56.840</a></span> | <span class="t">for example, our root mean squared error and our R^2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4741" target="_blank">01:19:01.360</a></span> | <span class="t">And we're going to call that our starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4744" target="_blank">01:19:04.400</a></span> | <span class="t">So now let's do exactly the same thing, but let's take the yearMade column and randomly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4752" target="_blank">01:19:12.200</a></span> | <span class="t">shuffle it, randomly permute just that column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4757" target="_blank">01:19:17.060</a></span> | <span class="t">So now yearMade has exactly the same distribution as before, same means and deviation, but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4763" target="_blank">01:19:23.440</a></span> | <span class="t">going to have no relationship to the dependent variable at all, because we totally randomly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4767" target="_blank">01:19:27.240</a></span> | <span class="t">reordered it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4769" target="_blank">01:19:29.020</a></span> | <span class="t">So before we might have found our R^2 with 0.89, and then after we shuffle yearMade, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4778" target="_blank">01:19:38.080</a></span> | <span class="t">check again and now it's like 0.8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4781" target="_blank">01:19:41.480</a></span> | <span class="t">Oh, that score got much worse when we destroyed that variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4787" target="_blank">01:19:47.960</a></span> | <span class="t">It's like, let's try again, let's put yearMade back to how it was, and this time let's take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4795" target="_blank">01:19:55.740</a></span> | <span class="t">enclosure and shuffle that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4799" target="_blank">01:19:59.600</a></span> | <span class="t">And we find this time with enclosure it's 0.84, and we can say the amount of decrease</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4808" target="_blank">01:20:08.760</a></span> | <span class="t">in our score for yearMade was 0.09, and the amount of decrease in our score for enclosure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4817" target="_blank">01:20:17.920</a></span> | <span class="t">was 0.05, and this is going to give us our feature importances for each one of our columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4833" target="_blank">01:20:33.420</a></span> | <span class="t">Wouldn't just excluding each column and running a random forest and checking the decay in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4842" target="_blank">01:20:42.640</a></span> | <span class="t">performance?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4843" target="_blank">01:20:43.640</a></span> | <span class="t">You could remove the column and train a whole new random forest, but that's going to be really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4849" target="_blank">01:20:49.440</a></span> | <span class="t">slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4850" target="_blank">01:20:50.440</a></span> | <span class="t">This way we can keep our random forest and just test the particular accuracy of it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4856" target="_blank">01:20:56.000</a></span> | <span class="t">So this is nice and fast by comparison.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4858" target="_blank">01:20:58.400</a></span> | <span class="t">In this case, we just have to rerun every row forward through the forest for each shuffled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4866" target="_blank">01:21:06.560</a></span> | <span class="t">column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4867" target="_blank">01:21:07.560</a></span> | <span class="t">We're just basically doing predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4874" target="_blank">01:21:14.360</a></span> | <span class="t">So if you want to do multi-collinearity, would you do 2 of them and then 3 of them random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4878" target="_blank">01:21:18.540</a></span> | <span class="t">shuffled?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4879" target="_blank">01:21:19.540</a></span> | <span class="t">Yeah, so I don't think you mean multi-collinearity, I think you mean looking for interaction effects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4884" target="_blank">01:21:24.620</a></span> | <span class="t">So if you want to say which pairs of variables are most important, you could do exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4889" target="_blank">01:21:29.420</a></span> | <span class="t">same thing, each pair in turn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4892" target="_blank">01:21:32.920</a></span> | <span class="t">In practice, there are better ways to do that because that's obviously computationally pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4899" target="_blank">01:21:39.800</a></span> | <span class="t">expensive and so we'll try and find time to do that if we can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4908" target="_blank">01:21:48.440</a></span> | <span class="t">We now have a model which is a little bit more accurate and we've learned a lot more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4913" target="_blank">01:21:53.380</a></span> | <span class="t">about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4918" target="_blank">01:21:58.280</a></span> | <span class="t">So we're out of time, and so what I would suggest you try doing now before next class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4925" target="_blank">01:22:05.360</a></span> | <span class="t">for this bulldozers dataset is go through the top 5 or 10 predictors and try and learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4935" target="_blank">01:22:15.480</a></span> | <span class="t">what you can about how to draw plots in pandas and try to come back with some insights about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4942" target="_blank">01:22:22.200</a></span> | <span class="t">what's the relationship between year made and the dependent variable, what's the histogram</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4945" target="_blank">01:22:25.880</a></span> | <span class="t">of year made.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4949" target="_blank">01:22:29.280</a></span> | <span class="t">Now that you know year made is really important, is there some noise in that column which we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4956" target="_blank">01:22:36.320</a></span> | <span class="t">could fix?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4957" target="_blank">01:22:37.320</a></span> | <span class="t">Are there some weird encodings in that column that we could fix?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4961" target="_blank">01:22:41.480</a></span> | <span class="t">This idea I had that maybe a coupled system is there entirely because it's collinear with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4965" target="_blank">01:22:45.600</a></span> | <span class="t">something else, do you want to try and figure out if that's true, if so, how would you do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4970" target="_blank">01:22:50.560</a></span> | <span class="t">it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4971" target="_blank">01:22:51.560</a></span> | <span class="t">FI product class desk, that brings alarm bells to me, it sounds like it might be a high cardinality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4979" target="_blank">01:22:59.120</a></span> | <span class="t">categorical variable, it might be something with lots and lots of levels because it sounds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4982" target="_blank">01:23:02.760</a></span> | <span class="t">like it's like a model name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4984" target="_blank">01:23:04.320</a></span> | <span class="t">So like go and have a look at that model name, does it have some ordering to it, could you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4988" target="_blank">01:23:08.280</a></span> | <span class="t">make it an ordinal variable to make it better, does it have some kind of hierarchical structure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4992" target="_blank">01:23:12.440</a></span> | <span class="t">in the string that we could split it on hyphen to create more subcolumns, have a think about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=4998" target="_blank">01:23:18.320</a></span> | <span class="t">this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=5001" target="_blank">01:23:21.960</a></span> | <span class="t">By Tuesday when you come back, ideally you've got a better accuracy than what I just showed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=5009" target="_blank">01:23:29.280</a></span> | <span class="t">because we found some new insights, or at least that you can tell the class about some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=5014" target="_blank">01:23:34.440</a></span> | <span class="t">things you've learned about how heavy industrial equipment options work in practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=YSFG_W8JxBo&t=5021" target="_blank">01:23:41.520</a></span> | <span class="t">See you on Tuesday.</span></div></div></body></html>