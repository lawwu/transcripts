<html><head><title>Lesson 16: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 16: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc"><img src="https://i.ytimg.com/vi/9YZaYjRKuEc/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=0">0:0</a> The Learner<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=142">2:22</a> Basic Callback Learner<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=477">7:57</a> Exceptions<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=535">8:55</a> Train with Callbacks<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=735">12:15</a> Metrics class: accuracy and loss<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=894">14:54</a> Device Callback<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1048">17:28</a> Metrics Callback<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1481">24:41</a> Flexible Learner: @contextmanager<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1863">31:3</a> Flexible Learner: Train Callback<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1954">32:34</a> Flexible Learner: Progress Callback (fastprogress)<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2251">37:31</a> TrainingLearner subclass, adding momentum<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2617">43:37</a> Learning Rate Finder Callback<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2952">49:12</a> Learning Rate scheduler<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3236">53:56</a> Notebook 10<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3298">54:58</a> set_seed function<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3336">55:36</a> Fashion-MNIST Baseline<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3457">57:37</a> 1 - Look inside the Model<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3770">62:50</a> PyThorch hooks<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4132">68:52</a> Hooks class / context managers<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4337">72:17</a> Dummy context manager, Dummy list<br><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4485">74:45</a> Colorful Dimension: histogram<br><br><div style="text-align: left;"><a href="./9YZaYjRKuEc.html">Whisper Transcript</a> | <a href="./transcript_9YZaYjRKuEc.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi there and welcome to lesson 16 where we are working on building our first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=7" target="_blank">00:00:07.840</a></span> | <span class="t">flexible training framework the learner and I've got some very good news which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=14" target="_blank">00:00:14.640</a></span> | <span class="t">is that I have thought of a way of doing it a little bit more gradually and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=19" target="_blank">00:00:19.400</a></span> | <span class="t">simply actually than last time so that should that should make things a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=25" target="_blank">00:00:25.680</a></span> | <span class="t">easier so we're going to take it a bit more step by step so we're working in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=30" target="_blank">00:00:30.080</a></span> | <span class="t">the 09 learner notebook today and we've seen already this this basic callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=43" target="_blank">00:00:43.480</a></span> | <span class="t">learner and so the idea is that we've seen so far this learner which wasn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=56" target="_blank">00:00:56.040</a></span> | <span class="t">flexible at all but it had all the basic pieces which is we've got a fit method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=62" target="_blank">00:01:02.160</a></span> | <span class="t">we hard coding that we can only calculate accuracy and average loss we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=68" target="_blank">00:01:08.320</a></span> | <span class="t">hard coding we're putting things on a default device hard coding a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=74" target="_blank">00:01:14.760</a></span> | <span class="t">learning rate but the basic idea is here we go through each epoch and call one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=80" target="_blank">00:01:20.280</a></span> | <span class="t">epoch to train or evaluate depending on this flag and then we loop through each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=87" target="_blank">00:01:27.680</a></span> | <span class="t">batch in the data loader and one batch is going to grab the X and Y parts of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=93" target="_blank">00:01:33.640</a></span> | <span class="t">the batch call the model call the loss function and if we're training do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=99" target="_blank">00:01:39.880</a></span> | <span class="t">backward pass and then print out we'll calculate the statistics for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=107" target="_blank">00:01:47.880</a></span> | <span class="t">accuracy and then at the end of an epoch print that out so it wasn't very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=112" target="_blank">00:01:52.320</a></span> | <span class="t">flexible but it did do something so that's good so what we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=118" target="_blank">00:01:58.760</a></span> | <span class="t">now is we're going to do is an intermediate step we're going to look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=121" target="_blank">00:02:01.400</a></span> | <span class="t">a but I'm calling a basic callbacks learner and it actually has nearly all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=126" target="_blank">00:02:06.040</a></span> | <span class="t">the functionality of the full thing the way we're going to after we look at this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=129" target="_blank">00:02:09.600</a></span> | <span class="t">basic callbacks learner we're then going to after creating some callbacks and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=135" target="_blank">00:02:15.840</a></span> | <span class="t">metrics we're going to look at something called the flexible learner so let's go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=140" target="_blank">00:02:20.000</a></span> | <span class="t">step by step so the basic callbacks learner looks very similar to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=146" target="_blank">00:02:26.680</a></span> | <span class="t">previous learner it it's got a fit function which is going to go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=156" target="_blank">00:02:36.880</a></span> | <span class="t">each epoch calling one epoch with training on and then training off and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=163" target="_blank">00:02:43.520</a></span> | <span class="t">then one epoch will go through each batch and call one batch and one batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=172" target="_blank">00:02:52.480</a></span> | <span class="t">will call the model the loss function and if we're training it will do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=178" target="_blank">00:02:58.680</a></span> | <span class="t">backward step so that's all pretty similar but there's a few more things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=183" target="_blank">00:03:03.160</a></span> | <span class="t">going on here for example if we have a look at fit you'll see that after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=190" target="_blank">00:03:10.040</a></span> | <span class="t">creating the optimizer so we call self dot optfunk so optfunk here defaults to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=198" target="_blank">00:03:18.840</a></span> | <span class="t">SGD so we instantiate an SGD object passing in our models parameters and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=204" target="_blank">00:03:24.440</a></span> | <span class="t">the requested learning rate and then before we start looping through one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=209" target="_blank">00:03:29.560</a></span> | <span class="t">epoch at a time now we've set epochs here we first of all call self dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=216" target="_blank">00:03:36.240</a></span> | <span class="t">callback and passing in before fit now what does that do self dot callback is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=223" target="_blank">00:03:43.040</a></span> | <span class="t">here and it takes a method names in this case it's before fit and it calls a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=229" target="_blank">00:03:49.440</a></span> | <span class="t">function called run callbacks it passes in a list of our callbacks and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=234" target="_blank">00:03:54.240</a></span> | <span class="t">method name in this case before fit so run callbacks is something that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=241" target="_blank">00:04:01.120</a></span> | <span class="t">to go for each callback and it's going to sort them in order of their order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=249" target="_blank">00:04:09.080</a></span> | <span class="t">attribute and so there's a base class through our callbacks which has an order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=253" target="_blank">00:04:13.600</a></span> | <span class="t">of zero so our callbacks all going to have the same order of zero and which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=256" target="_blank">00:04:16.720</a></span> | <span class="t">you will ask otherwise so here's an example of a callback so before we look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=264" target="_blank">00:04:24.160</a></span> | <span class="t">at how callbacks work let's just let's just run a callback so we can create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=269" target="_blank">00:04:29.760</a></span> | <span class="t">ridiculously simple callback called completion callback which before we start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=274" target="_blank">00:04:34.580</a></span> | <span class="t">fitting a new model it will set its count attribute to zero after each batch it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=280" target="_blank">00:04:40.000</a></span> | <span class="t">will increment that and after completing the fitting process it will print out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=284" target="_blank">00:04:44.960</a></span> | <span class="t">how many batches we've done so before we even train a model we could just run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=289" target="_blank">00:04:49.200</a></span> | <span class="t">manually before fit after batch and after fit using this run cbs and you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=300" target="_blank">00:05:00.400</a></span> | <span class="t">see it's ended up saying completed one batches so what did that do so it went</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=306" target="_blank">00:05:06.880</a></span> | <span class="t">through each of the cbs in this list there's only one so it's going to look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=312" target="_blank">00:05:12.560</a></span> | <span class="t">the one cb and it's going to try to use get atra to find an attribute with this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=320" target="_blank">00:05:20.320</a></span> | <span class="t">name which is before fit so if we try that manually so this is the kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=326" target="_blank">00:05:26.360</a></span> | <span class="t">thing I want you to do if you find anything difficult to understand is do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=329" target="_blank">00:05:29.520</a></span> | <span class="t">it all manually so create a callback set it to cbs zero just like you're doing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=334" target="_blank">00:05:34.880</a></span> | <span class="t">a loop right and then find out what happens if we call this and pass in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=347" target="_blank">00:05:47.240</a></span> | <span class="t">and you'll see it's returned a method and then what happens to that method it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=355" target="_blank">00:05:55.680</a></span> | <span class="t">gets called so let's try calling it there yeah so that's what happened when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=363" target="_blank">00:06:03.080</a></span> | <span class="t">we call the before fit which doesn't do anything very interesting but if we then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=366" target="_blank">00:06:06.400</a></span> | <span class="t">call after batch and then we call after fit there it is right so yeah make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=379" target="_blank">00:06:19.480</a></span> | <span class="t">you don't just run code really nearly but understand it by experimenting with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=386" target="_blank">00:06:26.720</a></span> | <span class="t">it and I don't always experiment with it myself in these classes often I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=390" target="_blank">00:06:30.400</a></span> | <span class="t">leaving that to you but sometimes I'm trying to give you a sense of how I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=393" target="_blank">00:06:33.840</a></span> | <span class="t">would experiment with code if I was learning it so then having done that I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=397" target="_blank">00:06:37.520</a></span> | <span class="t">would then go ahead and delete those cells but you can see I'm using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=400" target="_blank">00:06:40.520</a></span> | <span class="t">interactive notebook environment to to explore and learn and understand and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=408" target="_blank">00:06:48.160</a></span> | <span class="t">now we've got and if I haven't created a simple example of something to make it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=413" target="_blank">00:06:53.260</a></span> | <span class="t">really easy to understand you should do that right don't just use what I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=416" target="_blank">00:06:56.440</a></span> | <span class="t">already created or what somebody else has already created so we've now got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=420" target="_blank">00:07:00.160</a></span> | <span class="t">something that works totally independently we can see how it works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=422" target="_blank">00:07:02.720</a></span> | <span class="t">this is what a callback does so a callback is something which will look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=427" target="_blank">00:07:07.320</a></span> | <span class="t">a class a callback is a class where you can define one or more of before after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=434" target="_blank">00:07:14.720</a></span> | <span class="t">fit before after batch and before after epoch so it's going to go through and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=443" target="_blank">00:07:23.040</a></span> | <span class="t">run all the callbacks that have a before fit method before we start fitting then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=450" target="_blank">00:07:30.200</a></span> | <span class="t">it'll go through each epoch and call one epoch with training and one epoch with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=454" target="_blank">00:07:34.780</a></span> | <span class="t">evaluation and then when that's all done it will call after fit callbacks and one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=463" target="_blank">00:07:43.560</a></span> | <span class="t">epoch will before it starts on enumerating through the batches it will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=471" target="_blank">00:07:51.120</a></span> | <span class="t">call before epoch and when it's done it will call after epoch the other thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=477" target="_blank">00:07:57.400</a></span> | <span class="t">you'll notice is that there's a try except immediately before every before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=484" target="_blank">00:08:04.020</a></span> | <span class="t">method and immediately after every after method there's a try and there's an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=489" target="_blank">00:08:09.320</a></span> | <span class="t">accept and each one has a different thing to look for cancel fit exception</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=493" target="_blank">00:08:13.320</a></span> | <span class="t">cancel epoch exception and cancel batch exception so here's the bit which goes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=499" target="_blank">00:08:19.280</a></span> | <span class="t">through each batch calls before batch processes the batch calls after batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=504" target="_blank">00:08:24.480</a></span> | <span class="t">and if there's an exception that's of type cancel batch exception it gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=510" target="_blank">00:08:30.000</a></span> | <span class="t">ignored so what's that for so the reason we have this is that any of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=517" target="_blank">00:08:37.240</a></span> | <span class="t">callbacks could call could raise any one of these three exceptions to say I don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=528" target="_blank">00:08:48.200</a></span> | <span class="t">want to do this batch please so maybe you'll look an example of that in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=533" target="_blank">00:08:53.760</a></span> | <span class="t">moment so we can now train with this so let's call create a little get model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=541" target="_blank">00:09:01.280</a></span> | <span class="t">function that creates a sequential model with just some linear layers and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=547" target="_blank">00:09:07.440</a></span> | <span class="t">we'll call fit and it's not telling us anything interesting because the only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=551" target="_blank">00:09:11.900</a></span> | <span class="t">callback we added was the completion callback that's fine it's it's training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=558" target="_blank">00:09:18.840</a></span> | <span class="t">it's doing something and we now have a trained model just didn't print out any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=562" target="_blank">00:09:22.600</a></span> | <span class="t">metrics or anything because we don't have any callbacks for that that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=565" target="_blank">00:09:25.720</a></span> | <span class="t">basic idea so we could create a maybe we could call it a single batch callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=578" target="_blank">00:09:38.760</a></span> | <span class="t">which after batch after a single batch it raises a cancel cancel fit exception</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=591" target="_blank">00:09:51.720</a></span> | <span class="t">so that's a pretty I mean that could be kind of useful actually if you want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=596" target="_blank">00:09:56.760</a></span> | <span class="t">just run one battery a model to make sure it works so we could try that so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=607" target="_blank">00:10:07.680</a></span> | <span class="t">now we're going to add to our list of callbacks the single batch callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=614" target="_blank">00:10:14.320</a></span> | <span class="t">let's try it and in fact you know we probably want this let's just have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=622" target="_blank">00:10:22.920</a></span> | <span class="t">think here oh that's fine let's run it there we go so it ran and nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=631" target="_blank">00:10:31.720</a></span> | <span class="t">happened and the reason nothing happened is because this canceled before this ran</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=639" target="_blank">00:10:39.280</a></span> | <span class="t">so we could make this run second by setting its order to be higher and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=645" target="_blank">00:10:45.800</a></span> | <span class="t">could say just order equals 1 because the default order is 0 and we sort in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=652" target="_blank">00:10:52.920</a></span> | <span class="t">order of the order attribute actually let's use cancel epoch exception there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=664" target="_blank">00:11:04.680</a></span> | <span class="t">we go that way it'll run the final fit there we are so it did one batch for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=675" target="_blank">00:11:15.240</a></span> | <span class="t">it did one batch for the training and one batch for the evaluation so it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=681" target="_blank">00:11:21.000</a></span> | <span class="t">total of two batches so remember callbacks are not a special magic part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=688" target="_blank">00:11:28.080</a></span> | <span class="t">of like the Python language or anything it's just a name we used refer to these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=693" target="_blank">00:11:33.000</a></span> | <span class="t">functions or classes or callables more accurately that we that we pass into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=699" target="_blank">00:11:39.880</a></span> | <span class="t">something that will then call back to that callable at particular times and I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=705" target="_blank">00:11:45.540</a></span> | <span class="t">think these are kind of interesting kinds of callbacks because these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=708" target="_blank">00:11:48.120</a></span> | <span class="t">callbacks have multiple methods in them so is each method a callback is each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=714" target="_blank">00:11:54.840</a></span> | <span class="t">class with all those methods of callback I don't know I tend to think of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=718" target="_blank">00:11:58.020</a></span> | <span class="t">class with all the methods in as a single callback I'm not sure if we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=722" target="_blank">00:12:02.400</a></span> | <span class="t">great nomenclature for this all right so let's actually try to get this doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=728" target="_blank">00:12:08.680</a></span> | <span class="t">something more interesting by not modifying the learner at all but just by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=731" target="_blank">00:12:11.680</a></span> | <span class="t">adding callbacks because that's the great hope of callbacks right so it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=737" target="_blank">00:12:17.700</a></span> | <span class="t">would be very nice if it told us the accuracy and the loss so to do that it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=744" target="_blank">00:12:24.520</a></span> | <span class="t">would be great to have a class that can keep track of a metric so I've created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=749" target="_blank">00:12:29.440</a></span> | <span class="t">here a metric class and maybe before we look at it we'll see how it works you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=757" target="_blank">00:12:37.600</a></span> | <span class="t">could create for example an accuracy metric by defining the calculation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=762" target="_blank">00:12:42.600</a></span> | <span class="t">necessary to calculate the accuracy metric which is the mean of how often do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=769" target="_blank">00:12:49.200</a></span> | <span class="t">the input sequence targets and the idea is you could then create an accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=773" target="_blank">00:12:53.960</a></span> | <span class="t">metric object you could add a batch of inputs and targets and add another batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=780" target="_blank">00:13:00.000</a></span> | <span class="t">of inputs and targets and get the value and there you would get the point four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=786" target="_blank">00:13:06.960</a></span> | <span class="t">five accuracy or another way you could do it would be just to create a metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=793" target="_blank">00:13:13.080</a></span> | <span class="t">which simply takes gets the weighted average for example of your loss so you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=796" target="_blank">00:13:16.640</a></span> | <span class="t">could add point six as the loss with a batch size of 32 point nine as a loss in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=802" target="_blank">00:13:22.280</a></span> | <span class="t">a batch size of two and then that's going to give us a weighted average loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=808" target="_blank">00:13:28.000</a></span> | <span class="t">of point six two which is equal to this weighted average calculation so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=814" target="_blank">00:13:34.240</a></span> | <span class="t">like one way we could kind of make it easy to calculate metrics so here's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=818" target="_blank">00:13:38.880</a></span> | <span class="t">class basically we're going to keep track of all of the actual values that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=824" target="_blank">00:13:44.940</a></span> | <span class="t">we're averaging and the number in each mini batch and so when you add a mini</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=829" target="_blank">00:13:49.960</a></span> | <span class="t">batch we call calculate which for example for accuracy remember this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=836" target="_blank">00:13:56.800</a></span> | <span class="t">going to override the parent classes calculate so it does the calculation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=841" target="_blank">00:14:01.520</a></span> | <span class="t">here and then we'll add that to our list of values we will add to our list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=848" target="_blank">00:14:08.680</a></span> | <span class="t">batch sizes the current batch size and then when you calculate the value we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=856" target="_blank">00:14:16.480</a></span> | <span class="t">will calculate the weighted sum sorry the weighted mean weighted average now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=864" target="_blank">00:14:24.320</a></span> | <span class="t">notice that here value I didn't have to put parentheses after it and that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=868" target="_blank">00:14:28.640</a></span> | <span class="t">because it's a property I think we've seen this before so just remind you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=872" target="_blank">00:14:32.040</a></span> | <span class="t">property just means you don't have to put parentheses after it to get it's to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=876" target="_blank">00:14:36.760</a></span> | <span class="t">get the calculation to happen all right so just let me know if anybody's got any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=882" target="_blank">00:14:42.440</a></span> | <span class="t">questions up to here of course so we now need some way to use this metric in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=892" target="_blank">00:14:52.300</a></span> | <span class="t">callback to actually print out the first thing I'm going to do those are going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=896" target="_blank">00:14:56.160</a></span> | <span class="t">create one more one useful metric first a very simple one just two lines of code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=901" target="_blank">00:15:01.080</a></span> | <span class="t">called the device callback and that is something which is going to allow us to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=905" target="_blank">00:15:05.600</a></span> | <span class="t">use CUDA or for the Apple GPU or whatever without the complications we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=914" target="_blank">00:15:14.880</a></span> | <span class="t">had before of you know how do we have multiple processes and our data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=919" target="_blank">00:15:19.760</a></span> | <span class="t">and also use our device and not have everything fall over so the way we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=923" target="_blank">00:15:23.960</a></span> | <span class="t">do it is we could say before fit put the model onto the default device and before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=934" target="_blank">00:15:34.600</a></span> | <span class="t">each batch is run put that batch onto the device because look what happened in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=943" target="_blank">00:15:43.000</a></span> | <span class="t">in the this is really really important in the learner absolutely everything is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=948" target="_blank">00:15:48.680</a></span> | <span class="t">put inside self dot which means it's all modifiable so we go for self dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=954" target="_blank">00:15:54.280</a></span> | <span class="t">iteration number comma self dot the batch itself enumerating the data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=959" target="_blank">00:15:59.400</a></span> | <span class="t">and then we call one batch but before it we call the callback so we can modify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=965" target="_blank">00:16:05.800</a></span> | <span class="t">this now how does the callback get access to the learner well what actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=971" target="_blank">00:16:11.520</a></span> | <span class="t">happens is we go through each of our call backs and put set an attribute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=976" target="_blank">00:16:16.920</a></span> | <span class="t">called learn equal to the learner and so that means in the callback itself we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=983" target="_blank">00:16:23.720</a></span> | <span class="t">say self dot learn dot model and actually we could make this a bit better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=989" target="_blank">00:16:29.000</a></span> | <span class="t">I think so make it like maybe you don't want to use a default device so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=992" target="_blank">00:16:32.800</a></span> | <span class="t">where I would be inclined to add a constructor and set device and we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=998" target="_blank">00:16:38.840</a></span> | <span class="t">default it to the default device of course and then we could use that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1007" target="_blank">00:16:47.560</a></span> | <span class="t">instead and that would give us a bit more flexibility so if you wanted to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1011" target="_blank">00:16:51.480</a></span> | <span class="t">trade on some different device then you could I think that might be a slight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1019" target="_blank">00:16:59.560</a></span> | <span class="t">improvement okay so there's a callback we can use to put things included and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1024" target="_blank">00:17:04.640</a></span> | <span class="t">could check that it works by just quickly going back to our old learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1029" target="_blank">00:17:09.120</a></span> | <span class="t">here remove the single batch CB and replace it with device CB yep still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1043" target="_blank">00:17:23.560</a></span> | <span class="t">works so that's a good sign okay so now let's do our metrics now of course we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1053" target="_blank">00:17:33.680</a></span> | <span class="t">couldn't use metrics until we built them by hand the good news is we don't have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1058" target="_blank">00:17:38.920</a></span> | <span class="t">write every single metric now by hand because they already exist in a fairly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1063" target="_blank">00:17:43.480</a></span> | <span class="t">new project called torch eval which is an official PyTorch project and so torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1069" target="_blank">00:17:49.360</a></span> | <span class="t">eval is something that gives us actually I came across it after I had created my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1076" target="_blank">00:17:56.200</a></span> | <span class="t">own metric class but it actually looks pretty similar to the one that I built</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1081" target="_blank">00:18:01.280</a></span> | <span class="t">earlier so you can install it with PEP I'm not sure if it's on Conde yet but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1088" target="_blank">00:18:08.280</a></span> | <span class="t">it probably will be soon by the time you see the video I think it's pure of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1092" target="_blank">00:18:12.080</a></span> | <span class="t">Python anyway so it doesn't matter how you install it and yeah it has a pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1097" target="_blank">00:18:17.680</a></span> | <span class="t">similar pretty similar approach where you call dot update and you call dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1107" target="_blank">00:18:27.720</a></span> | <span class="t">compute so they're slightly different names but they're basically super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1110" target="_blank">00:18:30.320</a></span> | <span class="t">similar to the thing that we just built but there's a nice good list of metrics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1116" target="_blank">00:18:36.280</a></span> | <span class="t">to pick from so because we've already built our own now that means we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1121" target="_blank">00:18:41.280</a></span> | <span class="t">allowed to use theirs so we can import the multi-class accuracy metric and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1127" target="_blank">00:18:47.220</a></span> | <span class="t">main metric and just to show you they look very very similar if we call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1133" target="_blank">00:18:53.200</a></span> | <span class="t">multi-class accuracy and we can pass in a mini batch of inputs and targets and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1138" target="_blank">00:18:58.880</a></span> | <span class="t">compute and that all works nicely now these in fact it's exactly the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1145" target="_blank">00:19:05.000</a></span> | <span class="t">what I wrote we both added this thing called reset which basically well resets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1150" target="_blank">00:19:10.840</a></span> | <span class="t">it and it's obviously we're going to be wanting to do that probably at the start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1155" target="_blank">00:19:15.880</a></span> | <span class="t">of each epoch and so if you reset it and then try to compute you'll get NAN</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1162" target="_blank">00:19:22.800</a></span> | <span class="t">because you can't get accuracy accuracies meaningless when you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1166" target="_blank">00:19:26.560</a></span> | <span class="t">have any data yet okay so let's create a metrics callback so we can print out our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1173" target="_blank">00:19:33.000</a></span> | <span class="t">metrics I've got some ideas to improve this which maybe I do this week but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1177" target="_blank">00:19:37.980</a></span> | <span class="t">here's a basic working version slightly hacky but it's not too bad so generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1185" target="_blank">00:19:45.560</a></span> | <span class="t">speaking one thing I noticed actually is I don't know if this is considered a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1189" target="_blank">00:19:49.540</a></span> | <span class="t">bug but a lot of the metrics didn't seem to work correctly and torch eval when I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1194" target="_blank">00:19:54.600</a></span> | <span class="t">had tensors that were on the GPU and had requires grad so I created a little to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1207" target="_blank">00:20:07.120</a></span> | <span class="t">CPU function which I think is very useful and that's just going to detach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1212" target="_blank">00:20:12.720</a></span> | <span class="t">the so detach takes the tensor and removes all the gradient history the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1217" target="_blank">00:20:17.800</a></span> | <span class="t">computation history used to calculate a gradient and puts it on the CPU that'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1222" target="_blank">00:20:22.760</a></span> | <span class="t">do the same for dictionaries of tensors lists of tensors and tuples of tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1228" target="_blank">00:20:28.600</a></span> | <span class="t">so our metrics callback basically here's how we're going to use it so let's run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1234" target="_blank">00:20:34.480</a></span> | <span class="t">it so here we're creating a metrics callback object and saying we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1240" target="_blank">00:20:40.800</a></span> | <span class="t">create a metric called accuracy that's what's going to print out and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1246" target="_blank">00:20:46.560</a></span> | <span class="t">the metrics object we're going to use to calculate accuracy and so then we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1251" target="_blank">00:20:51.400</a></span> | <span class="t">pass that in as one of our callbacks and so you can see what it's going to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1257" target="_blank">00:20:57.880</a></span> | <span class="t">it's going to print out the epoch number whether it's training or evaluating so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1263" target="_blank">00:21:03.560</a></span> | <span class="t">training set or validation set and it'll print out our metrics and our current</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1270" target="_blank">00:21:10.780</a></span> | <span class="t">status actually we can simplify that we don't need to print those bits because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1278" target="_blank">00:21:18.000</a></span> | <span class="t">it's all in the dictionary now let's do that there we go um so let's take a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1290" target="_blank">00:21:30.640</a></span> | <span class="t">at how this works so we are going to be creating with for the callback we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1297" target="_blank">00:21:37.760</a></span> | <span class="t">going to be passing in the names and object metric objects for the metrics to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1304" target="_blank">00:21:44.360</a></span> | <span class="t">track and print so here it is here star star metrics so he's seen star star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1311" target="_blank">00:21:51.400</a></span> | <span class="t">before and as a little shortcut I decided that it might be nice if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1317" target="_blank">00:21:57.720</a></span> | <span class="t">didn't want to write accuracy equals you could just remove that and run it and if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1324" target="_blank">00:22:04.440</a></span> | <span class="t">you do that then it will give it a name and I'll just use the same name as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1328" target="_blank">00:22:08.000</a></span> | <span class="t">class and so that's why you can either pass in so star ms will be a tuple well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1335" target="_blank">00:22:15.280</a></span> | <span class="t">I mean it's got to be pulled out so it's just passing a list of positional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1338" target="_blank">00:22:18.800</a></span> | <span class="t">arguments which we turn into a tuple or you can pass in named arguments that'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1343" target="_blank">00:22:23.560</a></span> | <span class="t">be turned into a dictionary if you pass in positional arguments then I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1347" target="_blank">00:22:27.560</a></span> | <span class="t">to turn them into named arguments in the dictionary by just grabbing the name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1352" target="_blank">00:22:32.200</a></span> | <span class="t">from their type so that's where this comes from that's all that's going on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1356" target="_blank">00:22:36.800</a></span> | <span class="t">here just a little shortcut bit of convenience so we store that away and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1362" target="_blank">00:22:42.600</a></span> | <span class="t">this is yeah this is a bit I think I can simplify a little bit but I'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1366" target="_blank">00:22:46.440</a></span> | <span class="t">adding manually an additional metric which is I'm going to call the loss and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1371" target="_blank">00:22:51.760</a></span> | <span class="t">that's just going to be the weighted the weighted average of the losses so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1377" target="_blank">00:22:57.480</a></span> | <span class="t">before we start fitting we we're going to actually tell the learner that we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1384" target="_blank">00:23:04.480</a></span> | <span class="t">the metrics callback and so you'll see later where we're going to actually use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1388" target="_blank">00:23:08.320</a></span> | <span class="t">this before each epoch we will reset all of our metrics after each epoch we will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1397" target="_blank">00:23:17.480</a></span> | <span class="t">create a dictionary of the keys and values which are the actual strings that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1402" target="_blank">00:23:22.560</a></span> | <span class="t">we want to print out and we will call log which for now we'll just print them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1408" target="_blank">00:23:28.840</a></span> | <span class="t">and then after each batch this is the key thing we're going to actually grab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1414" target="_blank">00:23:34.880</a></span> | <span class="t">the input and target we're going to put them on the CPU and then we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1423" target="_blank">00:23:43.840</a></span> | <span class="t">go through each of our metrics and call that update so remember the update in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1431" target="_blank">00:23:51.520</a></span> | <span class="t">the metric is the thing that actually says here's a batch of data right so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1438" target="_blank">00:23:58.320</a></span> | <span class="t">we're passing in the batch of data which is the predictions and the targets and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1444" target="_blank">00:24:04.200</a></span> | <span class="t">then we'll do the same thing for our special loss metric passing in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1449" target="_blank">00:24:09.320</a></span> | <span class="t">actual loss and the size of any batch and so that's how we're able to get this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1457" target="_blank">00:24:17.720</a></span> | <span class="t">yeah this actual running on the Nvidia GPU and showing our metrics and obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1466" target="_blank">00:24:26.720</a></span> | <span class="t">there's a lot of room to improve how this is displayed but all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1470" target="_blank">00:24:30.080</a></span> | <span class="t">informations we needed here and it's just a case of changing that function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1475" target="_blank">00:24:35.560</a></span> | <span class="t">okay so that's our kind of like intermediate complexity learner we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1482" target="_blank">00:24:42.040</a></span> | <span class="t">make it more sophisticated but it's still exactly it's still going to fit in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1488" target="_blank">00:24:48.800</a></span> | <span class="t">a single screen of codes this is kind of my goal here was to keep everything in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1491" target="_blank">00:24:51.920</a></span> | <span class="t">single screen of code this first bit is exactly the same as before but you'll see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1499" target="_blank">00:24:59.360</a></span> | <span class="t">that the one epoch and fit and batch has gone from let's see but what it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1508" target="_blank">00:25:08.000</a></span> | <span class="t">before it's gone from quite a lot of code all this to much less code and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1519" target="_blank">00:25:19.680</a></span> | <span class="t">trick to doing that is I decided to use a context manager we're going to learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1523" target="_blank">00:25:23.240</a></span> | <span class="t">more about context managers in the next notebook but basically I originally last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1527" target="_blank">00:25:27.600</a></span> | <span class="t">week I was saying I was going to do this as a decorator but I realized a context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1530" target="_blank">00:25:30.080</a></span> | <span class="t">manager is better basically what we're going to do is we're going to call our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1533" target="_blank">00:25:33.680</a></span> | <span class="t">before and after callbacks in a try accept block and to say that we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1543" target="_blank">00:25:43.960</a></span> | <span class="t">use the callbacks in the try accept block we're going to use a with statement so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1549" target="_blank">00:25:49.760</a></span> | <span class="t">in Python a with statement says everything in that block call our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1556" target="_blank">00:25:56.680</a></span> | <span class="t">context manager before and after it now there's a few ways to do that but one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1562" target="_blank">00:26:02.200</a></span> | <span class="t">really easy one is using this context manager decorator and everything up and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1568" target="_blank">00:26:08.000</a></span> | <span class="t">to the up to the yield statement is called before your code where it says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1573" target="_blank">00:26:13.440</a></span> | <span class="t">yield it then calls your code and then everything after the yield is called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1578" target="_blank">00:26:18.760</a></span> | <span class="t">after your code so in this case it's going to be try self dot callback before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1584" target="_blank">00:26:24.520</a></span> | <span class="t">name where name is fit and then it will call for self dot epoch etc because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1594" target="_blank">00:26:34.280</a></span> | <span class="t">that's where the yield is and then it'll call self dot callback after fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1599" target="_blank">00:26:39.920</a></span> | <span class="t">accept okay and now we need to grab the cancel fit exception so all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1608" target="_blank">00:26:48.320</a></span> | <span class="t">variables that you have in Python all live inside a special dictionary called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1612" target="_blank">00:26:52.880</a></span> | <span class="t">globals so this dictionary contains all of your variables so I can just look up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1617" target="_blank">00:26:57.320</a></span> | <span class="t">in that dictionary the variable called cancel fit with a capital F exception</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1624" target="_blank">00:27:04.480</a></span> | <span class="t">so this is except cancel fit exception so this is exactly the same then as this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1632" target="_blank">00:27:12.160</a></span> | <span class="t">code except the nice thing is now I only have to write it once rather than at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1638" target="_blank">00:27:18.080</a></span> | <span class="t">least three times and I'm probably going to want more of them so you know I tend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1641" target="_blank">00:27:21.880</a></span> | <span class="t">to think it's worth yeah I tend to think it's worth refactoring a code when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1649" target="_blank">00:27:29.320</a></span> | <span class="t">have duplicate code particularly here we had the same code three times so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1654" target="_blank">00:27:34.440</a></span> | <span class="t">going to be more of a maintenance headache we're probably going to want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1656" target="_blank">00:27:36.960</a></span> | <span class="t">add callbacks to more things later so by putting it into a context manager just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1663" target="_blank">00:27:43.200</a></span> | <span class="t">once I think we're going to reduce our maintenance burden I know we do because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1667" target="_blank">00:27:47.800</a></span> | <span class="t">I've had a similar thing in fast AI for some years now and it's been quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1671" target="_blank">00:27:51.760</a></span> | <span class="t">convenient so that's what this context managers about yeah other than that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1682" target="_blank">00:28:02.080</a></span> | <span class="t">code's exactly the same so we create our optimizer and then with our callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1686" target="_blank">00:28:06.960</a></span> | <span class="t">context manager for fit go through each epoch call one epoch set it to training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1694" target="_blank">00:28:14.320</a></span> | <span class="t">or non training mode based on the argument we pass in grab the training or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1699" target="_blank">00:28:19.600</a></span> | <span class="t">validation set based on the argument we trust in and then using the context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1704" target="_blank">00:28:24.120</a></span> | <span class="t">manager for epoch go through each batch in the data loader and then for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1710" target="_blank">00:28:30.360</a></span> | <span class="t">batch in the data loader using the batch context now this is where something gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1717" target="_blank">00:28:37.500</a></span> | <span class="t">quite interesting we call predict get lost and if we're training backward step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1723" target="_blank">00:28:43.000</a></span> | <span class="t">and zero grad but previously we actually called self dot model etc self dot loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1730" target="_blank">00:28:50.880</a></span> | <span class="t">function etc so we go through each batch and call before batch do the batch oh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1745" target="_blank">00:29:05.680</a></span> | <span class="t">they say that's our that's our slow version wait what are we doing oh yes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1751" target="_blank">00:29:11.720</a></span> | <span class="t">we're gonna be over here okay I'm back where we are yes so previously we were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1765" target="_blank">00:29:25.480</a></span> | <span class="t">calling yeah calling calling the model calling the loss function calling loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1769" target="_blank">00:29:29.880</a></span> | <span class="t">dot backward opt dot step opt dot zero grad but now we are calling instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1780" target="_blank">00:29:40.280</a></span> | <span class="t">self dot predict self dot get lost self dot backward and how on earth is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1785" target="_blank">00:29:45.280</a></span> | <span class="t">working because they are not defined here at all and so the reason I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1789" target="_blank">00:29:49.800</a></span> | <span class="t">decided to do this is it gives us a lot of flexibility we can now actually create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1795" target="_blank">00:29:55.240</a></span> | <span class="t">our own way of doing predict get lost backward step and zero grad in different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1801" target="_blank">00:30:01.280</a></span> | <span class="t">situations and we're going to see some of those situations so what happens if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1809" target="_blank">00:30:09.400</a></span> | <span class="t">we call self dot predict and it doesn't exist well it doesn't necessarily cause</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1814" target="_blank">00:30:14.240</a></span> | <span class="t">an error what actually happens is it calls a special magic method in Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1819" target="_blank">00:30:19.840</a></span> | <span class="t">called dunder get atra as we've seen before and what I'm doing here is I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1824" target="_blank">00:30:24.840</a></span> | <span class="t">saying okay well if it's one of these special five things don't raise an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1829" target="_blank">00:30:29.680</a></span> | <span class="t">attribute error which is this is the default thing it does but instead create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1836" target="_blank">00:30:36.800</a></span> | <span class="t">a call back or actually I should say call self dot call back passing in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1843" target="_blank">00:30:43.840</a></span> | <span class="t">name so it's actually going to call self dot call back quote predict and self dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1851" target="_blank">00:30:51.480</a></span> | <span class="t">call back is exactly the same as before and so what that means now is to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1855" target="_blank">00:30:55.200</a></span> | <span class="t">this work exactly the same as it did before I need a call back which does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1859" target="_blank">00:30:59.260</a></span> | <span class="t">these five things and here it is I'm going to call it train call back so here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1865" target="_blank">00:31:05.640</a></span> | <span class="t">are the five things predict get lost backwards step and zero grad so there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1870" target="_blank">00:31:10.760</a></span> | <span class="t">are here predict get lost backwards step and zero grad okay so they're almost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1883" target="_blank">00:31:23.760</a></span> | <span class="t">exactly the same as what they looked like in our intermediate learner except</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1887" target="_blank">00:31:27.560</a></span> | <span class="t">now I just need to have self dot learn in front of everything because we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1891" target="_blank">00:31:31.320</a></span> | <span class="t">remember this is a callback it's not the learner and so for a callback the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1895" target="_blank">00:31:35.000</a></span> | <span class="t">callback can access the learner using self dot learn so self dot learn dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1898" target="_blank">00:31:38.040</a></span> | <span class="t">preds is self dot learn dot model passing in self dot learn dot batch and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1902" target="_blank">00:31:42.040</a></span> | <span class="t">just the independent variables ditto for the loss calls the loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1908" target="_blank">00:31:48.180</a></span> | <span class="t">backward step zero grad so that's at this point this isn't doing anything that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1918" target="_blank">00:31:58.160</a></span> | <span class="t">wasn't doing before but the nice thing is now if you want to use hugging face</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1923" target="_blank">00:32:03.400</a></span> | <span class="t">accelerate or you want something that works on hugging face data styles</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1927" target="_blank">00:32:07.320</a></span> | <span class="t">dictionary things or whatever you can actually change exactly how it behaves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1934" target="_blank">00:32:14.400</a></span> | <span class="t">by just call passing by creating a callback for training and if you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1940" target="_blank">00:32:20.260</a></span> | <span class="t">everything except one thing to be the same you can inherit from train CB so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1943" target="_blank">00:32:23.760</a></span> | <span class="t">this is I've I've not tried this before I haven't seen this done anywhere else</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1948" target="_blank">00:32:28.280</a></span> | <span class="t">so it's a bit of an experiment so I would sit here how you go with it and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1954" target="_blank">00:32:34.520</a></span> | <span class="t">finally I thought it'd be nice to have a progress bar so let's create a progress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1958" target="_blank">00:32:38.720</a></span> | <span class="t">callback and the progress bar is going to show on it our current loss and going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1964" target="_blank">00:32:44.600</a></span> | <span class="t">put create a plot of it so I'm going to use a project that we created called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1972" target="_blank">00:32:52.160</a></span> | <span class="t">fast progress mainly created by the wonderful Sylvain and basically fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1982" target="_blank">00:33:02.400</a></span> | <span class="t">progress is yeah very nice way to create a very flexible progress bars and so let</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1990" target="_blank">00:33:10.760</a></span> | <span class="t">me show you what it looks like first so let's get the model and train and as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=1995" target="_blank">00:33:15.520</a></span> | <span class="t">can see it actually in real time updates the graph and everything there you go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2001" target="_blank">00:33:21.240</a></span> | <span class="t">that's pretty cool so that's the that's the progress bar the metrics callback the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2007" target="_blank">00:33:27.720</a></span> | <span class="t">device callback and the training callback all in action so before we fit we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2013" target="_blank">00:33:33.720</a></span> | <span class="t">actually have to set self dot learn dot epochs now that might look a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2019" target="_blank">00:33:39.960</a></span> | <span class="t">weird but self dot learn dot epochs is the thing that we loop through for self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2026" target="_blank">00:33:46.800</a></span> | <span class="t">dot epoch in so we can change that so it's not just a normal range but instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2032" target="_blank">00:33:52.280</a></span> | <span class="t">it is a progress bar around a range we can then check remember I told you that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2041" target="_blank">00:34:01.080</a></span> | <span class="t">the learner is going to have the metrics attribute applied we can then say oh if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2044" target="_blank">00:34:04.400</a></span> | <span class="t">the learner has a metrics attribute then let's replace the underscore log method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2051" target="_blank">00:34:11.000</a></span> | <span class="t">there with ours and our one instead will write to the progress bar now this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2057" target="_blank">00:34:17.460</a></span> | <span class="t">pretty simple it looks very similar to before but we could easily replace this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2061" target="_blank">00:34:21.000</a></span> | <span class="t">for example with something that creates an HTML table which is another thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2064" target="_blank">00:34:24.840</a></span> | <span class="t">fast progress does or other stuff like that so you can see we can modify the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2069" target="_blank">00:34:29.520</a></span> | <span class="t">nice thing is we can modify how our metrics are displayed so that's a very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2075" target="_blank">00:34:35.080</a></span> | <span class="t">powerful thing that Python lets us do is actually replace one piece of code with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2078" target="_blank">00:34:38.960</a></span> | <span class="t">another and that's the whole purpose of why the metrics callback had this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2086" target="_blank">00:34:46.760</a></span> | <span class="t">underscore log separately so why didn't I just say print here that's because this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2091" target="_blank">00:34:51.800</a></span> | <span class="t">way classes can replace how the metrics are displayed so we could change that to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2098" target="_blank">00:34:58.340</a></span> | <span class="t">like send them over to weights and biases for example or you know create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2103" target="_blank">00:35:03.800</a></span> | <span class="t">visualizations or so forth so before epoch we do a very similar thing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2112" target="_blank">00:35:12.480</a></span> | <span class="t">self dot learn dot DL iterator we change it to have a progress bar wrapped around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2117" target="_blank">00:35:17.400</a></span> | <span class="t">it and then after each bar we set the progress bars comment to be the to be the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2126" target="_blank">00:35:26.240</a></span> | <span class="t">loss it's going to print just going to show the loss on the progress bar as it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2129" target="_blank">00:35:29.320</a></span> | <span class="t">goes and if we've asked for a plot then we will append the losses to a list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2136" target="_blank">00:35:36.040</a></span> | <span class="t">losses and we will update the graph with the losses and the batch numbers so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2151" target="_blank">00:35:51.200</a></span> | <span class="t">there we have it we have a yeah nice working learner which is I think the most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2160" target="_blank">00:36:00.640</a></span> | <span class="t">flexible learner that training loop probably that's I hope has ever been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2165" target="_blank">00:36:05.080</a></span> | <span class="t">written because I think the fast AI 2 one was the most flexible that had ever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2168" target="_blank">00:36:08.880</a></span> | <span class="t">been written before and this is more flexible and the nice thing is you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2174" target="_blank">00:36:14.400</a></span> | <span class="t">make this your own you know you can you know fully understand this training loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2180" target="_blank">00:36:20.760</a></span> | <span class="t">so it's kind of like you can use a framework but it's a framework in which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2185" target="_blank">00:36:25.720</a></span> | <span class="t">you're totally in control of it and you can make it work exactly how you want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2189" target="_blank">00:36:29.280</a></span> | <span class="t">ideally not by changing the change in the learner itself ideally by creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2193" target="_blank">00:36:33.880</a></span> | <span class="t">callbacks but if you want to you could certainly like look at that the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2198" target="_blank">00:36:38.000</a></span> | <span class="t">learner fits on a single screen so you could certainly change that we haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2204" target="_blank">00:36:44.320</a></span> | <span class="t">added inference yet although that shouldn't be too much to add I guess we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2207" target="_blank">00:36:47.880</a></span> | <span class="t">have to do that at some point okay now interestingly I love this about Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2215" target="_blank">00:36:55.440</a></span> | <span class="t">it's so flexible when when we said self dot predict self dot get lost I said if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2223" target="_blank">00:37:03.500</a></span> | <span class="t">they don't exist then it's going to use get atcha and it's going to try to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2228" target="_blank">00:37:08.440</a></span> | <span class="t">those in the callbacks and in fact you could have multiple callbacks that define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2234" target="_blank">00:37:14.420</a></span> | <span class="t">these things and then they would chain them together which would be kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2237" target="_blank">00:37:17.040</a></span> | <span class="t">interesting but there's another way we could make these exist which is which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2244" target="_blank">00:37:24.520</a></span> | <span class="t">that we could subclass this so let's not use train CB just to just to show us how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2250" target="_blank">00:37:30.840</a></span> | <span class="t">this would work and instead we're going to use a subclass so here in a subclass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2258" target="_blank">00:37:38.040</a></span> | <span class="t">learner and I'm going to override the five well it's not exactly overriding I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2263" target="_blank">00:37:43.680</a></span> | <span class="t">didn't have any definition of them before so I'm going to define the five</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2266" target="_blank">00:37:46.200</a></span> | <span class="t">directly in the learner subclass so that way it's never going to end up going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2270" target="_blank">00:37:50.640</a></span> | <span class="t">get atcha because get atcha is only called if something doesn't exist so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2282" target="_blank">00:38:02.160</a></span> | <span class="t">here it's basically all these five are exactly the same as in our train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2287" target="_blank">00:38:07.440</a></span> | <span class="t">callback except we don't need self dot learn anymore we can just use self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2290" target="_blank">00:38:10.560</a></span> | <span class="t">because we're now in the learner but I've changed zero grad to do something a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2295" target="_blank">00:38:15.120</a></span> | <span class="t">bit crazy I'm not sure if this has been done before I haven't seen it but maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2300" target="_blank">00:38:20.120</a></span> | <span class="t">it's an old trick that I just haven't come across but it occurred to me zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2304" target="_blank">00:38:24.680</a></span> | <span class="t">grad which remember is the thing that we call after we take the optimizer step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2310" target="_blank">00:38:30.240</a></span> | <span class="t">doesn't actually have to zero the gradients at all what if instead of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2315" target="_blank">00:38:35.240</a></span> | <span class="t">zeroing the gradients we multiplied them by some number like say 0.85 well what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2327" target="_blank">00:38:47.360</a></span> | <span class="t">would that do well what it would do is it would mean that your previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2333" target="_blank">00:38:53.080</a></span> | <span class="t">gradients would still be there but they would be reduced a bit and remember what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2340" target="_blank">00:39:00.680</a></span> | <span class="t">happens in PyTorch is PyTorch always adds the gradients to the existing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2347" target="_blank">00:39:07.100</a></span> | <span class="t">gradients and that's why we normally have to call zero grad but if instead we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2352" target="_blank">00:39:12.160</a></span> | <span class="t">multiply the gradients by some number I mean we should really make this a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2355" target="_blank">00:39:15.600</a></span> | <span class="t">parameter let's do that shall we so let's create a parameter so probably the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2365" target="_blank">00:39:25.840</a></span> | <span class="t">few ways we could do this well let's do it properly we've got a little bit of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2374" target="_blank">00:39:34.960</a></span> | <span class="t">time so we could say well maybe just copy and paste all those over here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2391" target="_blank">00:39:51.000</a></span> | <span class="t">we'll add momentum momentum equals 0.85 self momentum equals momentum and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2408" target="_blank">00:40:08.200</a></span> | <span class="t">super so make sure you call the super classes passing in all the stuff we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2418" target="_blank">00:40:18.480</a></span> | <span class="t">could use delegates for this and quags that would be possibly another great way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2422" target="_blank">00:40:22.400</a></span> | <span class="t">of doing it but let's just do this for now okay and then so there we wouldn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2427" target="_blank">00:40:27.480</a></span> | <span class="t">make it 0.85 we would make it self dot momentum so you'll see now still trains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2435" target="_blank">00:40:35.560</a></span> | <span class="t">but there's no train CB callback anymore in my list I don't need one because I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2441" target="_blank">00:40:41.880</a></span> | <span class="t">have to find the five methods in the subclass now this training at the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2447" target="_blank">00:40:47.800</a></span> | <span class="t">learning rate for the same time the accuracy it improves by more let's run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2454" target="_blank">00:40:54.100</a></span> | <span class="t">them all yeah this is a lot like gradient accumulation callback they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2462" target="_blank">00:41:02.080</a></span> | <span class="t">kind of cooler I think okay so the let's see the loss has gone from 0.8 to 0.55</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2476" target="_blank">00:41:16.480</a></span> | <span class="t">and the accuracy is gone from about 0.7 to about 0.8 so they've improved why is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2484" target="_blank">00:41:24.400</a></span> | <span class="t">that well we're going to be learning a lot more about this pretty shortly but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2492" target="_blank">00:41:32.220</a></span> | <span class="t">basically what's happening here but basically what's happening here is we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2500" target="_blank">00:41:40.600</a></span> | <span class="t">have just implemented in a very interesting way which I haven't seen done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2504" target="_blank">00:41:44.160</a></span> | <span class="t">before something called momentum and basically what momentum does is it say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2509" target="_blank">00:41:49.200</a></span> | <span class="t">like imagine you are you know you're trying you've got some kind of complex</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2515" target="_blank">00:41:55.240</a></span> | <span class="t">contour lost surface right and you know so imagine these are hills with a marble</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2525" target="_blank">00:42:05.880</a></span> | <span class="t">very similar right and your marbles up here what would normally happen with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2530" target="_blank">00:42:10.920</a></span> | <span class="t">gradient descent is it would go you know in the direction downhill which is this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2536" target="_blank">00:42:16.960</a></span> | <span class="t">way so we'll go whoa over here and then whoa over here right very slow what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2543" target="_blank">00:42:23.880</a></span> | <span class="t">momentum does is it's is the first steps the same and then the second step says oh</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2549" target="_blank">00:42:29.160</a></span> | <span class="t">I wanted to go this way but I'm going to add together the previous direction plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2555" target="_blank">00:42:35.280</a></span> | <span class="t">the new direction but reduce the previous direction a bit so that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2558" target="_blank">00:42:38.800</a></span> | <span class="t">actually make me end up about here and then the second one does the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2564" target="_blank">00:42:44.560</a></span> | <span class="t">and so momentum basically makes you much more quickly go to your destination so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2572" target="_blank">00:42:52.600</a></span> | <span class="t">normally momentum is done it the reason I did it this way partly to show you is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2577" target="_blank">00:42:57.100</a></span> | <span class="t">just a bit of fun a bit of interest but it's very it's very useful because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2580" target="_blank">00:43:00.940</a></span> | <span class="t">normally momentum you have to store a complete copy basically of all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2585" target="_blank">00:43:05.800</a></span> | <span class="t">gradients the momentum version of the gradients so that you can kind of keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2590" target="_blank">00:43:10.080</a></span> | <span class="t">track of that that that running exponentially weighted moving average but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2594" target="_blank">00:43:14.320</a></span> | <span class="t">using this trick you're actually using the dot grad themselves to store the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2600" target="_blank">00:43:20.680</a></span> | <span class="t">exponentially weighted moving average so anyway there's a little bit of fun which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2605" target="_blank">00:43:25.440</a></span> | <span class="t">hopefully particularly those of you who are interested in accelerated optimizers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2611" target="_blank">00:43:31.360</a></span> | <span class="t">and memory saving might find a bit inspiring all right there's one more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2620" target="_blank">00:43:40.220</a></span> | <span class="t">call back I'm going to show before the break which is the wonderful learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2626" target="_blank">00:43:46.200</a></span> | <span class="t">ratefinder I'm assuming that anybody who's watching this already is familiar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2630" target="_blank">00:43:50.760</a></span> | <span class="t">with the learning ratefinder from fast AI if you're not there's lots of videos</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2635" target="_blank">00:43:55.760</a></span> | <span class="t">and tutorials around about it it's an idea that comes from a paper by Leslie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2641" target="_blank">00:44:01.300</a></span> | <span class="t">Smith from a few years ago and the basic idea is that we will increase the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2648" target="_blank">00:44:08.640</a></span> | <span class="t">learning rate I should have put titles on this the the x-axis here is learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2652" target="_blank">00:44:12.320</a></span> | <span class="t">rate the y-axis here is loss we increase the learning rate gradually over time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2659" target="_blank">00:44:19.320</a></span> | <span class="t">and we plot the loss against the learning rate and we find how high can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2664" target="_blank">00:44:24.940</a></span> | <span class="t">we bring the learning rate up before the loss starts getting worse you kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2670" target="_blank">00:44:30.160</a></span> | <span class="t">want roughly where about the steepest slope is so probably here it would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2674" target="_blank">00:44:34.060</a></span> | <span class="t">about 0.1 so it'd be nice to create a learning ratefinder so here's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2681" target="_blank">00:44:41.200</a></span> | <span class="t">learning ratefinder callback so what a learning ratefinder needs to do well you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2686" target="_blank">00:44:46.720</a></span> | <span class="t">have to tell it how much to multiply the learning rate by each batch let's say we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2690" target="_blank">00:44:50.440</a></span> | <span class="t">add 30% to the learning rate each batch and so we'll store that so before we fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2695" target="_blank">00:44:55.920</a></span> | <span class="t">we obviously need to keep track of the learning rates and we need to keep track</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2700" target="_blank">00:45:00.040</a></span> | <span class="t">of the losses because those are the things that we put on a plot the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2705" target="_blank">00:45:05.800</a></span> | <span class="t">thing we have to do is decide when do we stop training so when is it clearly gone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2710" target="_blank">00:45:10.120</a></span> | <span class="t">off the rails and I decided that if the loss is three times higher than the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2716" target="_blank">00:45:16.200</a></span> | <span class="t">minimum loss we've seen then we should stop so we're going to keep track of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2720" target="_blank">00:45:20.520</a></span> | <span class="t">their minimum loss and so let's just initially set that to infinity it's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2725" target="_blank">00:45:25.340</a></span> | <span class="t">nice big number well not quite a number but a number ish like thing so then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2731" target="_blank">00:45:31.360</a></span> | <span class="t">after every batch first of all let's check that we're training okay if we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2735" target="_blank">00:45:35.200</a></span> | <span class="t">not training then we don't want to do anything we don't use the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2739" target="_blank">00:45:39.480</a></span> | <span class="t">finder during validation so here's a really handy thing just raise cancel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2743" target="_blank">00:45:43.680</a></span> | <span class="t">epoch exception and that stops it from doing that epoch entirely so just to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2749" target="_blank">00:45:49.220</a></span> | <span class="t">how that works you can see here one epoch does with the call back context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2758" target="_blank">00:45:58.120</a></span> | <span class="t">manager epoch and that will say oh it's got cancelled so it goes straight to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2764" target="_blank">00:46:04.000</a></span> | <span class="t">accept which is going to go all the way to the end of that code and it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2769" target="_blank">00:46:09.640</a></span> | <span class="t">to skip it so it's you can see that we're using exceptions as control</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2774" target="_blank">00:46:14.960</a></span> | <span class="t">structures which is actually a really powerful programming technique that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2784" target="_blank">00:46:24.000</a></span> | <span class="t">really underutilized in my opinion like a lot of things I do it's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2789" target="_blank">00:46:29.280</a></span> | <span class="t">somewhat controversial some people think it's a bad idea but I find it actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2795" target="_blank">00:46:35.480</a></span> | <span class="t">makes my code more concise and more maintainable and more powerful so I like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2800" target="_blank">00:46:40.920</a></span> | <span class="t">it so let's see yeah so that's we've got our cancel epoch exception so then we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2809" target="_blank">00:46:49.980</a></span> | <span class="t">just going to keep track of our learning rates the learning rates we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2814" target="_blank">00:46:54.200</a></span> | <span class="t">learn a lot more about optimizers shortly so I won't worry too much about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2817" target="_blank">00:46:57.280</a></span> | <span class="t">this but basically the learning rates are stored by PyTorch inside the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2821" target="_blank">00:47:01.020</a></span> | <span class="t">optimizer and they're actually stored in things called param groups parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2824" target="_blank">00:47:04.400</a></span> | <span class="t">groups so don't worry too much about the details but we can grab the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2828" target="_blank">00:47:08.240</a></span> | <span class="t">rate from that dictionary and we'll learn more about that shortly we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2832" target="_blank">00:47:12.480</a></span> | <span class="t">to keep track of the loss appended to our list of losses and if it's less than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2837" target="_blank">00:47:17.320</a></span> | <span class="t">the minimum we've seen then recorded as the minimum and if it's greater than a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2842" target="_blank">00:47:22.000</a></span> | <span class="t">three times the minimum then look at this it's really cool cancel fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2845" target="_blank">00:47:25.240</a></span> | <span class="t">exception so this will stop everything in a very nice clean way no need for lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2855" target="_blank">00:47:35.520</a></span> | <span class="t">of returns and conditionals or and stuff like that just raise the cancel fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2859" target="_blank">00:47:39.760</a></span> | <span class="t">exception and yeah and then finally we've got to actually update our learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2867" target="_blank">00:47:47.920</a></span> | <span class="t">rate to 1.3 times the previous one and so basically the way you do it in PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2874" target="_blank">00:47:54.080</a></span> | <span class="t">is you have to go through each parameter group and grab the learning rate in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2878" target="_blank">00:47:58.160</a></span> | <span class="t">dictionary and multiply it by lrmult so yeah you've already seen it run and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2885" target="_blank">00:48:05.480</a></span> | <span class="t">can at the end of running you will find that there is now a the callback will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2892" target="_blank">00:48:12.280</a></span> | <span class="t">now contain an LR's and a losses so for this callback I can't just add it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2897" target="_blank">00:48:17.600</a></span> | <span class="t">directly to the callback list I need to instantiate it first and the reason I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2902" target="_blank">00:48:22.780</a></span> | <span class="t">need to instantiate it first is because I need to be able to grab its learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2905" target="_blank">00:48:25.800</a></span> | <span class="t">rates and its losses and in fact you know we could grab that whole thing and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2910" target="_blank">00:48:30.280</a></span> | <span class="t">move it in here there's no reason callbacks only have to have the callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2914" target="_blank">00:48:34.120</a></span> | <span class="t">things right so we could do this and now that's just going to become self there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2930" target="_blank">00:48:50.280</a></span> | <span class="t">we go and so then we can train it again and we could just call LR find dot plot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2937" target="_blank">00:48:57.440</a></span> | <span class="t">so callbacks can really be you know quite self-contained nice things as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2943" target="_blank">00:49:03.640</a></span> | <span class="t">can see so there's a more sophisticated callback and I think it's doing a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2948" target="_blank">00:49:08.080</a></span> | <span class="t">really nice stuff here you might have come across something in PyTorch called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2954" target="_blank">00:49:14.880</a></span> | <span class="t">learning rate schedulers and in fact we could implement this whole thing with a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2960" target="_blank">00:49:20.360</a></span> | <span class="t">learning rate scheduler it won't actually save that much time but I just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2964" target="_blank">00:49:24.160</a></span> | <span class="t">want to show you when you use stuff in PyTorch like learning rate schedulers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2968" target="_blank">00:49:28.400</a></span> | <span class="t">you're actually using things that are extremely simple the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2971" target="_blank">00:49:31.720</a></span> | <span class="t">scheduler basically does this one line of code for us so I'm going to now create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2975" target="_blank">00:49:35.960</a></span> | <span class="t">new LR find a CB and this time I'm going to use the PyTorch's exponential LR</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2982" target="_blank">00:49:42.880</a></span> | <span class="t">scheduler which is here so this is now it's interesting that actually the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2991" target="_blank">00:49:51.560</a></span> | <span class="t">documentation of this is kind of actually wrong it claims that it decays</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=2996" target="_blank">00:49:56.600</a></span> | <span class="t">the learning rate of each parameter group by gamma so gamma is just some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3000" target="_blank">00:50:00.320</a></span> | <span class="t">number you pass in I don't know why this has to be a Greek letter but it sounds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3004" target="_blank">00:50:04.600</a></span> | <span class="t">more fancy than multiplying by an LR multiplier it says every epoch but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3011" target="_blank">00:50:11.080</a></span> | <span class="t">not actually done every epoch at all what actually happens is in PyTorch the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3017" target="_blank">00:50:17.560</a></span> | <span class="t">schedulers have a step method and the decay happens each time you call step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3023" target="_blank">00:50:23.240</a></span> | <span class="t">and if you set gamma which is actually LR mult to a number bigger than one it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3029" target="_blank">00:50:29.300</a></span> | <span class="t">not a decay it's an increase so the difference now I guess I'll copy and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3034" target="_blank">00:50:34.400</a></span> | <span class="t">paste the previous version okay so the previous versions on the top so the main</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3043" target="_blank">00:50:43.520</a></span> | <span class="t">difference here is that before fit we're going to create something called a self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3047" target="_blank">00:50:47.360</a></span> | <span class="t">dot shed equal to the scheduler and the scheduler because it's going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3053" target="_blank">00:50:53.300</a></span> | <span class="t">adjusting the learning rates it actually needs access to the optimizer so we pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3056" target="_blank">00:50:56.760</a></span> | <span class="t">in the optimizer and the learning rate model player and so then in after batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3064" target="_blank">00:51:04.200</a></span> | <span class="t">rather than having this line of code we replace it with this line of code self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3069" target="_blank">00:51:09.320</a></span> | <span class="t">dot shed dot step so that's the only difference and you know I mean we're not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3074" target="_blank">00:51:14.040</a></span> | <span class="t">gaining much as I said by using the PyTorch exponential LR scheduler but I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3080" target="_blank">00:51:20.040</a></span> | <span class="t">mainly wanted to do it so you can see that these things like PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3083" target="_blank">00:51:23.440</a></span> | <span class="t">schedulers are not doing anything magic they're just doing that one line of code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3087" target="_blank">00:51:27.960</a></span> | <span class="t">for us and so I run it again using this new version oopsy dozy oh I forgot to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3096" target="_blank">00:51:36.880</a></span> | <span class="t">run this line of code there we go and I guess I should also add the nice little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3104" target="_blank">00:51:44.920</a></span> | <span class="t">plot method maybe we'll just move it to the bottom there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3114" target="_blank">00:51:54.720</a></span> | <span class="t">lrfind dot plot there we go and put that one back to how it was all right perfect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3129" target="_blank">00:52:09.520</a></span> | <span class="t">timing so we added a few very important things in here so make sure we export</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3134" target="_blank">00:52:14.820</a></span> | <span class="t">and we'll be able to use them shortly all right let's have an eight minute break</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3143" target="_blank">00:52:23.120</a></span> | <span class="t">it's just have a 10 minute break so I see you back here at um eight past all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3153" target="_blank">00:52:33.400</a></span> | <span class="t">right welcome back um one suggestion which I lately like is we could rename</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3157" target="_blank">00:52:37.320</a></span> | <span class="t">plot to after fit which I really like because that means we should be able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3167" target="_blank">00:52:47.520</a></span> | <span class="t">then just call learn dot fit and delete the next one and let's see it didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3174" target="_blank">00:52:54.520</a></span> | <span class="t">work why not oh no that doesn't work does it because the hmm you know what I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3187" target="_blank">00:53:07.200</a></span> | <span class="t">think the callback here could go into a finally block actually that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3199" target="_blank">00:53:19.600</a></span> | <span class="t">actually allow us to always call the callback even if we've cancelled I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3206" target="_blank">00:53:26.400</a></span> | <span class="t">that's reasonable that might have its own confusions anyway we could try it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3211" target="_blank">00:53:31.640</a></span> | <span class="t">for now because that would let us put this after fit in there we go so that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3221" target="_blank">00:53:41.760</a></span> | <span class="t">automatically runs then so that's an interesting idea I think I quite like it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3236" target="_blank">00:53:56.040</a></span> | <span class="t">cool so let's now look at notebook 10 so I feel like this is the the next big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3246" target="_blank">00:54:06.640</a></span> | <span class="t">piece we need so we've got a pretty good system now for training models what I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3254" target="_blank">00:54:14.600</a></span> | <span class="t">think we're really missing though is a way to identify how our models are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3260" target="_blank">00:54:20.080</a></span> | <span class="t">training and so try identify how our models are training we need to be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3264" target="_blank">00:54:24.880</a></span> | <span class="t">to look inside them and see what's going on while they train we don't currently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3269" target="_blank">00:54:29.080</a></span> | <span class="t">have any way to do that and therefore it's very hard for us to diagnose and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3274" target="_blank">00:54:34.360</a></span> | <span class="t">fix problems most people have no way of looking inside their models and so most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3279" target="_blank">00:54:39.280</a></span> | <span class="t">people have no way to properly diagnose and fix models and that's why most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3282" target="_blank">00:54:42.920</a></span> | <span class="t">people when they have a problem with training their model randomly try things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3286" target="_blank">00:54:46.200</a></span> | <span class="t">until something starts hopefully working we're not going to do that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3290" target="_blank">00:54:50.920</a></span> | <span class="t">to do it properly so we can import the stuff that we just created in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3296" target="_blank">00:54:56.320</a></span> | <span class="t">learner and the first thing I'm going to do introduce now is a set seed function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3302" target="_blank">00:55:02.440</a></span> | <span class="t">we've been using torch manual seed before we know all about RNGs random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3308" target="_blank">00:55:08.360</a></span> | <span class="t">number generators we've actually got three of them pie torches numpies and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3314" target="_blank">00:55:14.640</a></span> | <span class="t">pythons let's see all of them and also in python pytorch you can use a flag to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3322" target="_blank">00:55:22.520</a></span> | <span class="t">ask it to use deterministic algorithms so things should be reproducible as we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3326" target="_blank">00:55:26.840</a></span> | <span class="t">discussed before you shouldn't always just make things reproducible but for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3330" target="_blank">00:55:30.720</a></span> | <span class="t">lessons I think this is useful so here's a function that lets you set a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3335" target="_blank">00:55:35.000</a></span> | <span class="t">reproducible seed all right let's use the same data set as before a fashion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3339" target="_blank">00:55:39.440</a></span> | <span class="t">MNIST data set will load it up in the same way and let's create a model that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3345" target="_blank">00:55:45.440</a></span> | <span class="t">looks very similar to our previous models this one might be a bit bigger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3349" target="_blank">00:55:49.400</a></span> | <span class="t">might not I didn't actually check okay so let's use multiclass accuracy again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3359" target="_blank">00:55:59.000</a></span> | <span class="t">same callbacks that we used before we'll use the train CB version for no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3364" target="_blank">00:56:04.200</a></span> | <span class="t">particular reason and generally speaking we want to train as fast as possible not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3372" target="_blank">00:56:12.480</a></span> | <span class="t">just because we don't like wasting time but actually more importantly because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3376" target="_blank">00:56:16.240</a></span> | <span class="t">the fact the higher the learning rate you train at the more the more you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3380" target="_blank">00:56:20.800</a></span> | <span class="t">able to find a often more generalizable set of weights and also oh training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3395" target="_blank">00:56:35.080</a></span> | <span class="t">quickly also means that we can look at each batch let each item in the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3400" target="_blank">00:56:40.880</a></span> | <span class="t">less often so we're going to have less issues with overfitting and generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3404" target="_blank">00:56:44.880</a></span> | <span class="t">speaking being if we can train at a high learning rate then that means that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3409" target="_blank">00:56:49.200</a></span> | <span class="t">learning to train in a stable way and stable training is is very good so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3416" target="_blank">00:56:56.840</a></span> | <span class="t">try setting up a high learning rate of point six and see what happens so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3422" target="_blank">00:57:02.600</a></span> | <span class="t">a function that's just going to create a learner with our callbacks and fit it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3427" target="_blank">00:57:07.600</a></span> | <span class="t">and return the learner in case we want to use it and it's training oh and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3434" target="_blank">00:57:14.320</a></span> | <span class="t">it suddenly fell apart so it's going well for a while and then it stopped</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3439" target="_blank">00:57:19.000</a></span> | <span class="t">training nicely so one nice thing about this graph is that we can immediately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3442" target="_blank">00:57:22.640</a></span> | <span class="t">see when it stops training well which is very useful so what happened there why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3450" target="_blank">00:57:30.960</a></span> | <span class="t">did it go badly I mean we can guess that it might have been because of our high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3453" target="_blank">00:57:33.760</a></span> | <span class="t">learning rate but what's really going on so let's try to look inside it so one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3459" target="_blank">00:57:39.440</a></span> | <span class="t">way to look inside it would be we could create our own sequential model which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3466" target="_blank">00:57:46.040</a></span> | <span class="t">just like the sequential model we've built before with do you remember we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3469" target="_blank">00:57:49.920</a></span> | <span class="t">created one using nn.module list in a previous lesson if you've forgotten go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3474" target="_blank">00:57:54.160</a></span> | <span class="t">back and check that out and when we call that model we go through each layer and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3481" target="_blank">00:58:01.840</a></span> | <span class="t">just call the layer and what we could do is though we could add something in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3487" target="_blank">00:58:07.120</a></span> | <span class="t">addition which is at each layer we could also get the mean of that layer and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3497" target="_blank">00:58:17.280</a></span> | <span class="t">standard deviation of that layer and append them to a couple of different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3505" target="_blank">00:58:25.000</a></span> | <span class="t">lists and activation means and activation standard deviations this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3509" target="_blank">00:58:29.240</a></span> | <span class="t">going to contain after we call this model it's going to contain the means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3514" target="_blank">00:58:34.560</a></span> | <span class="t">and standard deviations for each layer and then we could define dunder iter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3522" target="_blank">00:58:42.280</a></span> | <span class="t">which makes this into an iterator as being let's say just oh just it when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3526" target="_blank">00:58:46.400</a></span> | <span class="t">iterate through this model you can iterate through the layers so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3532" target="_blank">00:58:52.400</a></span> | <span class="t">then train this model in the usual way and this is going to give us exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3536" target="_blank">00:58:56.080</a></span> | <span class="t">same outcome as before because I'm using the same seed so you can see it looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3539" target="_blank">00:58:59.440</a></span> | <span class="t">identical but the difference is instead of using nn.sequential we've now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3545" target="_blank">00:59:05.080</a></span> | <span class="t">used something that's actually saved the means and standard deviations of each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3548" target="_blank">00:59:08.600</a></span> | <span class="t">layer and so therefore we can plot them okay so here we've plotted the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3560" target="_blank">00:59:20.240</a></span> | <span class="t">activation means and notice that we've done it for every batch so that's why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3567" target="_blank">00:59:27.880</a></span> | <span class="t">along the x-axis here we have batch number and on the y-axis we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3572" target="_blank">00:59:32.520</a></span> | <span class="t">activation means and then we have it for each layer so rather than starting at one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3577" target="_blank">00:59:37.160</a></span> | <span class="t">because we play from starting at zero so this is the first layer is blue second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3580" target="_blank">00:59:40.960</a></span> | <span class="t">layer is orange third layer green fourth layer red and fifth layer watch for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3588" target="_blank">00:59:48.600</a></span> | <span class="t">like movie kind of color and look what's happened the activations have started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3597" target="_blank">00:59:57.200</a></span> | <span class="t">pretty small close to zero and have increased at an exponentially increasing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3601" target="_blank">01:00:01.640</a></span> | <span class="t">rate and then have crashed and then have increased again an exponential rate and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3607" target="_blank">01:00:07.280</a></span> | <span class="t">crashed again it increased again crashed again and each time they've not gone up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3612" target="_blank">01:00:12.160</a></span> | <span class="t">they've gone up even higher and they've crashed in this case even lower and what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3618" target="_blank">01:00:18.040</a></span> | <span class="t">happens well wait what's happening here when our activations are really close to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3622" target="_blank">01:00:22.040</a></span> | <span class="t">zero well when your activations are really close to zero that means that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3626" target="_blank">01:00:26.200</a></span> | <span class="t">inputs to each layer are numbers very close to zero as a result of which of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3631" target="_blank">01:00:31.680</a></span> | <span class="t">course the outputs are very close to zero because we're doing just matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3636" target="_blank">01:00:36.000</a></span> | <span class="t">multiplies and so this is a disaster when activations are very close to zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3641" target="_blank">01:00:41.920</a></span> | <span class="t">you're there there they're dead units they're not able to do anything and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3647" target="_blank">01:00:47.880</a></span> | <span class="t">can see for ages here it's not training at all and this is so this is the this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3652" target="_blank">01:00:52.680</a></span> | <span class="t">is the activation means the standard deviations tell an even stronger story</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3655" target="_blank">01:00:55.880</a></span> | <span class="t">so you want generally speaking you want the means of the activations to be about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3663" target="_blank">01:01:03.400</a></span> | <span class="t">zero and the standard deviations to be about one mean of zero is fine as long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3669" target="_blank">01:01:09.720</a></span> | <span class="t">as they're spread around zero but a standard deviation of close to zero is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3674" target="_blank">01:01:14.120</a></span> | <span class="t">terrible because that means all of the activations are about the same so here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3678" target="_blank">01:01:18.760</a></span> | <span class="t">after batch 30 all all of the activations are close to zero and all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3684" target="_blank">01:01:24.600</a></span> | <span class="t">their standard deviations are close to zero so all the numbers are about the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3687" target="_blank">01:01:27.680</a></span> | <span class="t">same and they're about zero so nothing's going on and you can see the same things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3693" target="_blank">01:01:33.560</a></span> | <span class="t">happening with standard deviations we start with not very much variety in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3697" target="_blank">01:01:37.220</a></span> | <span class="t">weights it exponentially increases how much variety there is and then it crashes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3701" target="_blank">01:01:41.200</a></span> | <span class="t">again exponentially increases crashes again this is a classic shape of bad</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3708" target="_blank">01:01:48.080</a></span> | <span class="t">behavior and with these two plots you can really understand what's going on in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3715" target="_blank">01:01:55.200</a></span> | <span class="t">your model and if you train a model and at the end of it you kind of think well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3720" target="_blank">01:02:00.200</a></span> | <span class="t">I wonder if this is any good if you haven't looked at this plot you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3723" target="_blank">01:02:03.800</a></span> | <span class="t">know because you haven't checked to see whether it's training nicely maybe it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3727" target="_blank">01:02:07.920</a></span> | <span class="t">could it could be a lot better if you can get something we'll see some nicer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3732" target="_blank">01:02:12.240</a></span> | <span class="t">training pictures later but generally speaking you want something where your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3736" target="_blank">01:02:16.560</a></span> | <span class="t">main is always about zero and your variance is always about one standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3741" target="_blank">01:02:21.880</a></span> | <span class="t">deviation is always about one and if you see that then it's a pretty good chance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3746" target="_blank">01:02:26.840</a></span> | <span class="t">you're training properly if you don't see that you're most certainly not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3750" target="_blank">01:02:30.160</a></span> | <span class="t">training properly okay so what I'm going to do in the rest of this part of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3754" target="_blank">01:02:34.800</a></span> | <span class="t">lesson is explain how to do this in a more elegant way because as I say being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3760" target="_blank">01:02:40.800</a></span> | <span class="t">able to look inside your models is such a critically important thing to building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3765" target="_blank">01:02:45.240</a></span> | <span class="t">and debugging models we don't have to do it manually we don't have to create our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3769" target="_blank">01:02:49.440</a></span> | <span class="t">own sequential model we can actually use a pytorch thing called hooks so as it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3775" target="_blank">01:02:55.680</a></span> | <span class="t">says here a hook is called when a layer that it's registered to is executed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3780" target="_blank">01:03:00.920</a></span> | <span class="t">during the forward pass that's quite a forward hook well the backward pass and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3784" target="_blank">01:03:04.880</a></span> | <span class="t">that's called a backward hook and so the key thing about hooks is we don't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3788" target="_blank">01:03:08.280</a></span> | <span class="t">to rewrite the model we can add them to any existing model so we can just use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3793" target="_blank">01:03:13.320</a></span> | <span class="t">standard nn.sequential passing in our layers which were these ones here and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3803" target="_blank">01:03:23.840</a></span> | <span class="t">we're still going to have something to keep track of the activation means and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3806" target="_blank">01:03:26.720</a></span> | <span class="t">standard deviation so just create an empty list for now for each layer in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3811" target="_blank">01:03:31.940</a></span> | <span class="t">model and let's create a little function it's going to be called because a hawk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3818" target="_blank">01:03:38.040</a></span> | <span class="t">is going to call a function when when during the forward pass for a forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3823" target="_blank">01:03:43.040</a></span> | <span class="t">hook or the backward pass or a backward hook so it could have function called a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3826" target="_blank">01:03:46.160</a></span> | <span class="t">pen stats it's going to be passed the hook number sorry the layer number the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3831" target="_blank">01:03:51.440</a></span> | <span class="t">module and the input and the output so we're going to be grabbing the outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3838" target="_blank">01:03:58.240</a></span> | <span class="t">mean and putting in in activation means and the output standard deviation and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3842" target="_blank">01:04:02.600</a></span> | <span class="t">putting it in activation standard deviations so here's how you do it we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3847" target="_blank">01:04:07.440</a></span> | <span class="t">got a model you go through each layer of the model and you call on it register</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3853" target="_blank">01:04:13.120</a></span> | <span class="t">forward hook that's part of pytorch and we don't need to write it ourselves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3856" target="_blank">01:04:16.960</a></span> | <span class="t">because we already did right it's just doing the same thing as this basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3860" target="_blank">01:04:20.240</a></span> | <span class="t">and what function is always going to be called the function that's going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3868" target="_blank">01:04:28.240</a></span> | <span class="t">called is the append stats function passing in remember partial is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3873" target="_blank">01:04:33.760</a></span> | <span class="t">equivalent of saying a pen stats passing in I as the first element the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3878" target="_blank">01:04:38.940</a></span> | <span class="t">argument so if we now fit that model it trains in the usual way but after each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3886" target="_blank">01:04:46.600</a></span> | <span class="t">after each layer it's going to call this and so you can see we get exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3894" target="_blank">01:04:54.120</a></span> | <span class="t">same thing as before so one question we get here is what's the difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3898" target="_blank">01:04:58.680</a></span> | <span class="t">between a hook and a callback nothing at all hooks and call backs are the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3903" target="_blank">01:05:03.740</a></span> | <span class="t">thing it's just that pytorch defines hooks and they call them hooks instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3909" target="_blank">01:05:09.800</a></span> | <span class="t">of callbacks they are less flexible than the callbacks that we used in in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3918" target="_blank">01:05:18.920</a></span> | <span class="t">learner because you don't have access to all the available states you can't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3922" target="_blank">01:05:22.400</a></span> | <span class="t">change things but there are you know there are particular kind of callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3926" target="_blank">01:05:26.000</a></span> | <span class="t">it's just setting a piece of code that's going to be run for us when we when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3933" target="_blank">01:05:33.620</a></span> | <span class="t">something happens and in this case there's something that happens is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3936" target="_blank">01:05:36.400</a></span> | <span class="t">either layer in the forward pass is called or a layer in the backward pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3939" target="_blank">01:05:39.800</a></span> | <span class="t">is called I guess you could describe the function that's being called back as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3947" target="_blank">01:05:47.180</a></span> | <span class="t">callback and the thing that's doing the callback has the hook I'm not sure if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3952" target="_blank">01:05:52.560</a></span> | <span class="t">that level of distinction is important but maybe that's you could do that okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3957" target="_blank">01:05:57.320</a></span> | <span class="t">so anyway this is a little bit fussy of kind of like creating globals and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3962" target="_blank">01:06:02.080</a></span> | <span class="t">depending to them and stuff like that so let's try to simplify this a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3966" target="_blank">01:06:06.160</a></span> | <span class="t">so what I did here was I created a class called hook so this class when we create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3975" target="_blank">01:06:15.760</a></span> | <span class="t">it we're going to pass in the module that we're hooking so we call M dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3982" target="_blank">01:06:22.160</a></span> | <span class="t">register forward hook and we call the function we pass the function that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3986" target="_blank">01:06:26.280</a></span> | <span class="t">want to be given and so here's the pass the function and we're also going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=3991" target="_blank">01:06:31.080</a></span> | <span class="t">pass in the hook class to the function let's also define a remove because this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4001" target="_blank">01:06:41.540</a></span> | <span class="t">is actually the thing that this is actually the thing that removes the hook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4006" target="_blank">01:06:46.120</a></span> | <span class="t">we don't want it sitting around forever this is called the Dell is called by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4012" target="_blank">01:06:52.080</a></span> | <span class="t">Python when an object is freed so when that happens we should also make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4016" target="_blank">01:06:56.720</a></span> | <span class="t">that we remove this okay so appends that's now we're going to replace it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4025" target="_blank">01:07:05.120</a></span> | <span class="t">going to instead get past the hook instead because that's what we asked to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4033" target="_blank">01:07:13.700</a></span> | <span class="t">be passed and if there's no dot stats attribute in there yet then let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4041" target="_blank">01:07:21.980</a></span> | <span class="t">create one and then we're going to be past the activation so put that on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4049" target="_blank">01:07:29.780</a></span> | <span class="t">CPU and append the mean and at the standard deviation and now the nice thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4055" target="_blank">01:07:35.060</a></span> | <span class="t">is that the stats are actually inside this object which is convenient so now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4060" target="_blank">01:07:40.480</a></span> | <span class="t">we can do exactly the same thing as before but we don't have to set any of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4064" target="_blank">01:07:44.560</a></span> | <span class="t">that global stuff or whatever we can just say okay our hooks is a hook with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4069" target="_blank">01:07:49.440</a></span> | <span class="t">that layer and that function for all those models layers and so we're just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4078" target="_blank">01:07:58.640</a></span> | <span class="t">calling it has called register forward hook for us so now when we fit that it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4085" target="_blank">01:08:05.960</a></span> | <span class="t">going to run with the hooks there we go it trains actually they did do it too</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4102" target="_blank">01:08:22.800</a></span> | <span class="t">okay so then it trains and we get exactly the same shape as usual and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4113" target="_blank">01:08:33.120</a></span> | <span class="t">get back the same results as usual but as we can see we're gradually making</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4115" target="_blank">01:08:35.920</a></span> | <span class="t">this more convenient which is nice so we can make it nicer still because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4124" target="_blank">01:08:44.760</a></span> | <span class="t">generally speaking we're going to be adding multiple hooks and this stuff of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4128" target="_blank">01:08:48.880</a></span> | <span class="t">you know this list comprehension whatever it's a bit inconvenient so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4132" target="_blank">01:08:52.800</a></span> | <span class="t">let's create a hooks class so first of all we'll see how the hooks class works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4137" target="_blank">01:08:57.520</a></span> | <span class="t">in practice so in the hooks class the way we're going to use it is we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4142" target="_blank">01:09:02.520</a></span> | <span class="t">to call with hooks pass in the model pass in the function to use as their hook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4149" target="_blank">01:09:09.920</a></span> | <span class="t">and then we'll fit the model and that's it it's going to be literally just one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4155" target="_blank">01:09:15.000</a></span> | <span class="t">extra line of code to set up the whole thing and then when we then you can then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4159" target="_blank">01:09:19.360</a></span> | <span class="t">go through each hook and plot the main and standard deviation of each layer so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4165" target="_blank">01:09:25.180</a></span> | <span class="t">that's how that's the hooks class is going to make things much easier so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4169" target="_blank">01:09:29.020</a></span> | <span class="t">hooks class as you can see we're using a making it a context manager and we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4178" target="_blank">01:09:38.640</a></span> | <span class="t">to be able to loop through it we want to be an index into it so it's quite a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4183" target="_blank">01:09:43.200</a></span> | <span class="t">of behavior we want believe it or not all that behavior is in this tiny little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4188" target="_blank">01:09:48.040</a></span> | <span class="t">thing and we're going to use the most flexible general way of creating context</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4194" target="_blank">01:09:54.360</a></span> | <span class="t">managers now context managers are things that we can say with the general way of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4198" target="_blank">01:09:58.960</a></span> | <span class="t">creating a context manager is to create a class and to find two special things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4203" target="_blank">01:10:03.560</a></span> | <span class="t">done to enter and done to exit done to enter is a function that's going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4208" target="_blank">01:10:08.600</a></span> | <span class="t">called when it hits the with statement and if you add an as blah after it then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4216" target="_blank">01:10:16.440</a></span> | <span class="t">the contents of this variable will be whatever is returned from done to enter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4221" target="_blank">01:10:21.600</a></span> | <span class="t">and as you can see we just return the object itself so the the hooks object is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4227" target="_blank">01:10:27.240</a></span> | <span class="t">going to be stored in hooks now interestingly the hooks class inherits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4235" target="_blank">01:10:35.440</a></span> | <span class="t">from list you can do this you can actually inherit from stuff like list in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4239" target="_blank">01:10:39.660</a></span> | <span class="t">python so a hooks the hooks object is a list and therefore we need to call the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4245" target="_blank">01:10:45.360</a></span> | <span class="t">super classes constructor and we're going to pass in a that list comprehension we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4251" target="_blank">01:10:51.120</a></span> | <span class="t">saw that list of hooks where it's going to hook into each module in the list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4256" target="_blank">01:10:56.480</a></span> | <span class="t">modules we asked to hook into now we're passing in a model here but because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4264" target="_blank">01:11:04.280</a></span> | <span class="t">model is an nn dot sequential you can actually loop through an nn dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4267" target="_blank">01:11:07.640</a></span> | <span class="t">sequential and it returns each of the layers so this is actually very very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4272" target="_blank">01:11:12.080</a></span> | <span class="t">nice and concise and convenient so that's the constructor done to enter just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4278" target="_blank">01:11:18.000</a></span> | <span class="t">returns it done to exit is what's called automatically at the end of the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4284" target="_blank">01:11:24.360</a></span> | <span class="t">block so when this whole thing's finished it's going to remove the hooks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4289" target="_blank">01:11:29.440</a></span> | <span class="t">and removing the hooks is just going to go through each hook and remove it the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4294" target="_blank">01:11:34.760</a></span> | <span class="t">reason we can do for H and self is because remember this is a list and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4303" target="_blank">01:11:43.560</a></span> | <span class="t">finally we've got a dunder dell like before and I also added a dunder dell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4308" target="_blank">01:11:48.840</a></span> | <span class="t">item this is the thing that lets you delete a single hook from the list which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4313" target="_blank">01:11:53.280</a></span> | <span class="t">will remove that one hook and call the list still item so there's our whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4321" target="_blank">01:12:01.640</a></span> | <span class="t">thing so this is going to this this this one's optional this is the one that lets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4325" target="_blank">01:12:05.000</a></span> | <span class="t">us remove a single hook rather than all of them so let's just understand some of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4332" target="_blank">01:12:12.200</a></span> | <span class="t">what's going on there so here's a dummy context manager as you can see here it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4338" target="_blank">01:12:18.240</a></span> | <span class="t">got a dunder enter which is going to return itself and it's going to print</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4342" target="_blank">01:12:22.960</a></span> | <span class="t">something so you can see here I call with dummy context manager and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4348" target="_blank">01:12:28.400</a></span> | <span class="t">therefore it prints let's go first the second thing it's going to do is call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4354" target="_blank">01:12:34.120</a></span> | <span class="t">this code inside the context manager so we've got as DCM so that's itself and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4360" target="_blank">01:12:40.640</a></span> | <span class="t">so it's gonna call hello which prints hello so here it is and then finally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4368" target="_blank">01:12:48.160</a></span> | <span class="t">it's going to automatically call exit dunder exit which is all done so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4373" target="_blank">01:12:53.920</a></span> | <span class="t">all done so again if you haven't used context managers before you want to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4378" target="_blank">01:12:58.160</a></span> | <span class="t">creating little samples like this yourself and getting them to work so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4382" target="_blank">01:13:02.120</a></span> | <span class="t">this is your key homework for this week is anything in the lesson where we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4389" target="_blank">01:13:09.160</a></span> | <span class="t">using a part of Python you're not a hundred percent familiar with is for you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4393" target="_blank">01:13:13.280</a></span> | <span class="t">to from scratch to create some simple like kind of dummy version that fully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4398" target="_blank">01:13:18.480</a></span> | <span class="t">explores what it's doing if you're familiar with all the Python pieces then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4404" target="_blank">01:13:24.080</a></span> | <span class="t">it's to create your own you know that is to explore do the same thing with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4409" target="_blank">01:13:29.000</a></span> | <span class="t">PyTorch pieces like with with hooks and so forth and so I just wanted to show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4415" target="_blank">01:13:35.640</a></span> | <span class="t">you also what it's like to inherit from list so here I'm here inheriting from a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4420" target="_blank">01:13:40.120</a></span> | <span class="t">list and I could redefine how dunder Dell item works so now I can create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4426" target="_blank">01:13:46.000</a></span> | <span class="t">dummy list and it looks exactly the same as usual but now if I delete an item</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4434" target="_blank">01:13:54.040</a></span> | <span class="t">from the list it's going to call my overridden version and then it will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4441" target="_blank">01:14:01.680</a></span> | <span class="t">call the original version and so the list is now got removed that item and did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4446" target="_blank">01:14:06.840</a></span> | <span class="t">this at the same time so you can see you can actually yeah modify how Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4451" target="_blank">01:14:11.360</a></span> | <span class="t">works or create your own things that get all the behavior or the convenience of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4456" target="_blank">01:14:16.720</a></span> | <span class="t">Python classes like this one and add stuff to them so that's what's happening</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4462" target="_blank">01:14:22.600</a></span> | <span class="t">there okay so that's our hooks class so the next bit was developed largely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4474" target="_blank">01:14:34.600</a></span> | <span class="t">developed the last time I think it was that we did a part 2 course in San</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4479" target="_blank">01:14:39.520</a></span> | <span class="t">Francisco with Stefano so many thanks to him for helping get this next bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4484" target="_blank">01:14:44.000</a></span> | <span class="t">looking great we're going to create my favorite single image explanations of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4492" target="_blank">01:14:52.040</a></span> | <span class="t">what's going on inside a model we call them the colorful dimension which they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4498" target="_blank">01:14:58.160</a></span> | <span class="t">histograms we're going to take our same append stats these are all the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4504" target="_blank">01:15:04.080</a></span> | <span class="t">before we're going to add an extra line of code which is to get a histogram of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4509" target="_blank">01:15:09.040</a></span> | <span class="t">the absolute values of the activations so a histogram a histogram to remind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4515" target="_blank">01:15:15.600</a></span> | <span class="t">you is something that takes a collection of numbers and tells you how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4521" target="_blank">01:15:21.680</a></span> | <span class="t">frequent each group of numbers are and we're going to create 50 bins for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4528" target="_blank">01:15:28.640</a></span> | <span class="t">histogram so we will use our hooks that we just created and we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4540" target="_blank">01:15:40.000</a></span> | <span class="t">this new version of append stats so it's going to train us before but now we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4543" target="_blank">01:15:43.840</a></span> | <span class="t">going to in addition have this extra extra thing in stats we're just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4548" target="_blank">01:15:48.640</a></span> | <span class="t">contain a histogram and so with that we're now going to create this amazing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4556" target="_blank">01:15:56.240</a></span> | <span class="t">plot now what this plot is showing is for the first second third and fourth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4562" target="_blank">01:16:02.960</a></span> | <span class="t">layers what does the training look like and you can immediately see the basic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4567" target="_blank">01:16:07.120</a></span> | <span class="t">idea is that we're seeing this same pattern but what is this pattern showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4575" target="_blank">01:16:15.000</a></span> | <span class="t">what exactly is going on in these pictures so I think it might be best if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4580" target="_blank">01:16:20.120</a></span> | <span class="t">we try and draw a picture of this so let's take a normal histogram okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4595" target="_blank">01:16:35.320</a></span> | <span class="t">let's take a normal histogram where what will be where we basically have like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4604" target="_blank">01:16:44.000</a></span> | <span class="t">have grouped all the data into bins and then we have counts of how much is in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4611" target="_blank">01:16:51.280</a></span> | <span class="t">each bin so for example this will be like the value of the activations and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4619" target="_blank">01:16:59.600</a></span> | <span class="t">might be say from 0 to 10 and then from 10 to 20 and from 20 to 30 and these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4629" target="_blank">01:17:09.160</a></span> | <span class="t">generally equally spaced bins okay and then here is the count so that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4642" target="_blank">01:17:22.360</a></span> | <span class="t">number of items with that range of values so this is called a histogram</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4648" target="_blank">01:17:28.440</a></span> | <span class="t">okay so what Stefano and I did was we actually turn that histogram that whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4662" target="_blank">01:17:42.720</a></span> | <span class="t">histogram into a single column of pixels so if I take one column of pixels with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4670" target="_blank">01:17:50.240</a></span> | <span class="t">that's actually one histogram and the way we do it is we take these numbers so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4678" target="_blank">01:17:58.040</a></span> | <span class="t">let's say let's say it's like 14 that one's like 2 7 9 11 3 2 4 2 say and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4690" target="_blank">01:18:10.880</a></span> | <span class="t">then what we do is we turn it into a single column and so in this case we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4698" target="_blank">01:18:18.960</a></span> | <span class="t">got 1 2 3 4 5 6 7 8 9 groups right so we would create our nine groups sorry they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4709" target="_blank">01:18:29.680</a></span> | <span class="t">were meant to be evenly spaced but they were a good job got our nine groups and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4714" target="_blank">01:18:34.200</a></span> | <span class="t">so we take the first group it's 14 and what we do is we color it with a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4721" target="_blank">01:18:41.120</a></span> | <span class="t">gradient and a color according to how big that number is so 14 is a real big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4726" target="_blank">01:18:46.360</a></span> | <span class="t">number so depending on you know what gradient we use maybe reds really really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4730" target="_blank">01:18:50.160</a></span> | <span class="t">big and the next one's really small which might be like green and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4735" target="_blank">01:18:55.120</a></span> | <span class="t">next one's quite big in the middle which is like blue the next one's getting quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4740" target="_blank">01:19:00.920</a></span> | <span class="t">quite bigger still so maybe it's just a little bit sorry we should go back to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4744" target="_blank">01:19:04.480</a></span> | <span class="t">red go back to more red next one's bigger stills it's even more red and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4751" target="_blank">01:19:11.140</a></span> | <span class="t">forth so basically we're taking the histogram and taking it into a color</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4757" target="_blank">01:19:17.000</a></span> | <span class="t">coded single column plot if that makes sense and so what that means is that at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4765" target="_blank">01:19:25.160</a></span> | <span class="t">the very so let's take layer number two here layer number two we can take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4772" target="_blank">01:19:32.080</a></span> | <span class="t">very first column and so in the color scheme that actually map plot lives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4776" target="_blank">01:19:36.680</a></span> | <span class="t">picked here yellow is the most common and then light green is less common and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4781" target="_blank">01:19:41.880</a></span> | <span class="t">then light blue is less common and then dark blue is zero so you can see the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4786" target="_blank">01:19:46.160</a></span> | <span class="t">vast majority is zero and there's a few with slightly bigger numbers which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4790" target="_blank">01:19:50.600</a></span> | <span class="t">exactly the same that we saw for index one layer here it is right the average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4797" target="_blank">01:19:57.480</a></span> | <span class="t">the average is pretty close to zero the standard deviation is pretty small this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4803" target="_blank">01:20:03.720</a></span> | <span class="t">is giving us more information however so as we train at this point here the at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4815" target="_blank">01:20:15.920</a></span> | <span class="t">this point here there is quite a few activations that are a lot larger as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4822" target="_blank">01:20:22.320</a></span> | <span class="t">can see and still the vast majority of them are very small there's a few big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4826" target="_blank">01:20:26.680</a></span> | <span class="t">ones they still got a bright yellow bar at the bottom the other thing to notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4831" target="_blank">01:20:31.680</a></span> | <span class="t">here is what's happened is we've taken those those stats those histograms we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4836" target="_blank">01:20:36.960</a></span> | <span class="t">stacked them all up into a single tensor and then we've taken their log now log</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4841" target="_blank">01:20:41.620</a></span> | <span class="t">1p is just log of the number plus 1 that's because we've got zeros here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4847" target="_blank">01:20:47.480</a></span> | <span class="t">so just taking the log is going to kind of let us see the full range more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4854" target="_blank">01:20:54.560</a></span> | <span class="t">clearly so that's what the locks for so basically what we'd really ideally like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4862" target="_blank">01:21:02.000</a></span> | <span class="t">to see here is that this whole thing should be a kind of more like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4869" target="_blank">01:21:09.240</a></span> | <span class="t">rectangle you know the maximum should be should be not changing very much there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4874" target="_blank">01:21:14.480</a></span> | <span class="t">shouldn't be a thick yellow bar at the bottom but instead it should be a nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4877" target="_blank">01:21:17.520</a></span> | <span class="t">even gradient matching a normal distribution each single column of pixels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4883" target="_blank">01:21:23.600</a></span> | <span class="t">wants to be kind of like a normal distribution so you know gradually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4888" target="_blank">01:21:28.080</a></span> | <span class="t">decreasing the number of activations that's what we're aiming for there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4896" target="_blank">01:21:36.600</a></span> | <span class="t">another really important and actually easier to read version of this which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4903" target="_blank">01:21:43.480</a></span> | <span class="t">what if we just took those first two bottom pixels so the the least common</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4908" target="_blank">01:21:48.360</a></span> | <span class="t">five percent and counted up how many were in what's not the foot sorry least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4913" target="_blank">01:21:53.560</a></span> | <span class="t">common five percent the least cut the not least common either let's try again in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4919" target="_blank">01:21:59.480</a></span> | <span class="t">the bottom two pixels we've got the smallest two equally sized groups of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4928" target="_blank">01:22:08.280</a></span> | <span class="t">activations we don't want there to be too many of them because those are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4934" target="_blank">01:22:14.320</a></span> | <span class="t">basically dead or nearly dead activations they're much much much smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4938" target="_blank">01:22:18.360</a></span> | <span class="t">than the big ones and so taking the ratio between those bottom two groups</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4944" target="_blank">01:22:24.200</a></span> | <span class="t">and the total basically tells us what percentage have zero or near zero or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4953" target="_blank">01:22:33.140</a></span> | <span class="t">extremely small magnitudes and remember that these are with absolute values so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4964" target="_blank">01:22:44.520</a></span> | <span class="t">if we plot those you can see how bad this is and in particular for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4970" target="_blank">01:22:50.400</a></span> | <span class="t">at the final layer from the you know nearly from the very start really nearly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4975" target="_blank">01:22:55.320</a></span> | <span class="t">all of the activations are they're entirely just about entirely disabled so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4983" target="_blank">01:23:03.700</a></span> | <span class="t">this is this is bad news and if you've got a model where most of your model is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4988" target="_blank">01:23:08.920</a></span> | <span class="t">close to zero then most of your models doing no work and so it's it's really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=4995" target="_blank">01:23:15.680</a></span> | <span class="t">it's really not working so it may look like at the very end things were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5002" target="_blank">01:23:22.720</a></span> | <span class="t">improving but as you can see from this chart that's not true right there's still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5008" target="_blank">01:23:28.360</a></span> | <span class="t">the vast majority are still inactive generally speaking I found that if early</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5013" target="_blank">01:23:33.840</a></span> | <span class="t">in training you see this rising crash rising crash at all you should stop and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5019" target="_blank">01:23:39.920</a></span> | <span class="t">restart training because this your model will probably never recover too many of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5028" target="_blank">01:23:48.600</a></span> | <span class="t">the activations have gone off the rails so we want it to look kind of like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5034" target="_blank">01:23:54.760</a></span> | <span class="t">the whole time but with less of this very thick yellow bar which is showing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5040" target="_blank">01:24:00.280</a></span> | <span class="t">us most are inactive okay so that's our activations so we've got really now all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5061" target="_blank">01:24:21.920</a></span> | <span class="t">of the kind of key pieces I think we need to be able to flexibly change how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5068" target="_blank">01:24:28.800</a></span> | <span class="t">we train models and to understand what's going on inside our models and so from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5075" target="_blank">01:24:35.040</a></span> | <span class="t">this point we've kind of like drilled down as deep as we need to go and we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5081" target="_blank">01:24:41.780</a></span> | <span class="t">now start to come back up again and and put together the pieces building up what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5089" target="_blank">01:24:49.980</a></span> | <span class="t">are all of the things that are going to help us train models reliably and quickly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5096" target="_blank">01:24:56.280</a></span> | <span class="t">and then hopefully we're going to be able to yeah successfully create from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5100" target="_blank">01:25:00.400</a></span> | <span class="t">scratch some really high quality generative models and other models along</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5104" target="_blank">01:25:04.640</a></span> | <span class="t">the way okay I think that's everything for this class but next class we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5113" target="_blank">01:25:13.160</a></span> | <span class="t">going to start looking at things like initialization it's a really important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5116" target="_blank">01:25:16.560</a></span> | <span class="t">topic if you want to do some revision before then just make sure that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5122" target="_blank">01:25:22.680</a></span> | <span class="t">very comfortable with things like standard deviations and stuff like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5127" target="_blank">01:25:27.760</a></span> | <span class="t">because we're using that quite a lot for next time and yeah thanks for joining me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=9YZaYjRKuEc&t=5133" target="_blank">01:25:33.960</a></span> | <span class="t">look forward to the next lesson see you again</span></div></div></body></html>