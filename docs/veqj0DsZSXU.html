<html><head><title>Lesson 14: Deep Learning Foundations to Stable Diffusion</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 14: Deep Learning Foundations to Stable Diffusion</h2><a href="https://www.youtube.com/watch?v=veqj0DsZSXU"><img src="https://i.ytimg.com/vi/veqj0DsZSXU/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=30">0:30</a> Review of code and math from Lesson 13<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=460">7:40</a> f-Strings<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=600">10:0</a> Re-running the Notebook - Run All Above<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=660">11:0</a> Starting code refactoring: torch.nn<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=768">12:48</a> Generator Object<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=806">13:26</a> Class MLP: Inheriting from nn.Module<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1023">17:3</a> Checking the more flexible refactored MLP<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1073">17:53</a> Creating our own nn.Module<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1298">21:38</a> Using PyTorch’s nn.Module<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1431">23:51</a> Using PyTorch’s nn.ModuleList<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1499">24:59</a> reduce()<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1609">26:49</a> PyThorch’s nn.Sequential<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1655">27:35</a> Optimizer<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1777">29:37</a> PyTorch’ optim and get_model()<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1804">30:4</a> Dataset<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2009">33:29</a> DataLoader<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2153">35:53</a> Random sampling, batch size, collation<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2459">40:59</a> What does collate do?<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2717">45:17</a> fastcore’s store_attr()<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2767">46:7</a> Multiprocessing DataLoader<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3036">50:36</a> PyTorch’s Multiprocessing DataLoader<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3235">53:55</a> Validation set<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3371">56:11</a> Hugging Face Datasets, Fashion-MNIST<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3715">61:55</a> collate function<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3881">64:41</a> transforms function<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4007">66:47</a> decorators<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4182">69:42</a> itemgetter<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4315">71:55</a> PyTorch’s default_collate<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4538">75:38</a> Creating a Python library with nbdev<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4733">78:53</a> Plotting images<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4874">81:14</a> kwargs and fastcore’s delegates<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5283">88:3</a> Computer Science concepts with Python: callbacks<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5620">93:40</a> Lambdas and partials<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5786">96:26</a> Callbacks as callable classes<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5878">97:58</a> Multiple callback funcs; *args and **kwargs<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6195">103:15</a> __dunder__ thingies<br><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6453">107:33</a> Wrap-up<br><br><div style="text-align: left;"><a href="./veqj0DsZSXU.html">Whisper Transcript</a> | <a href="./transcript_veqj0DsZSXU.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=0" target="_blank">00:00:00.400</a></span> | <span class="t">Okay. Hi everybody. And welcome to lesson 14. The numbers are getting up pretty high now, huh?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6" target="_blank">00:00:06.320</a></span> | <span class="t">We had a lesson last time talking about calculus and how we implement the chain rule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=17" target="_blank">00:00:17.120</a></span> | <span class="t">in neural network training in an efficient way called backpropagation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=24" target="_blank">00:00:24.640</a></span> | <span class="t">I just wanted to point out that one excellent student, Kaushik Sinha, has produced a very nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=34" target="_blank">00:00:34.880</a></span> | <span class="t">explanation of the code that we looked at last time, and I've linked to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=39" target="_blank">00:00:39.760</a></span> | <span class="t">So it's got the math and then the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=43" target="_blank">00:00:43.520</a></span> | <span class="t">The code's slightly different to what I had, but it's basically the same things and minor changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=52" target="_blank">00:00:52.320</a></span> | <span class="t">And it might be helpful to kind of link between the math and the code to see what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=58" target="_blank">00:00:58.160</a></span> | <span class="t">So you'll find that in the lesson 13 resources.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=63" target="_blank">00:01:03.680</a></span> | <span class="t">But I thought I'd just quickly try to explain it as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=68" target="_blank">00:01:08.240</a></span> | <span class="t">So maybe I could try to copy this and just explain what's going on here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=80" target="_blank">00:01:20.240</a></span> | <span class="t">With this code. So the basic idea is that we have a neural network that is calculating,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=91" target="_blank">00:01:31.200</a></span> | <span class="t">well, a neural network and a loss function that together the calculator loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=95" target="_blank">00:01:35.440</a></span> | <span class="t">So let's imagine that, well, let's just call that the loss function, we'll call it L.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=101" target="_blank">00:01:41.200</a></span> | <span class="t">And the loss function is being applied to the output of the neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=107" target="_blank">00:01:47.680</a></span> | <span class="t">So the neural network function, we'll call n and that takes two things,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=111" target="_blank">00:01:51.520</a></span> | <span class="t">a bunch of weights and a bunch of inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=114" target="_blank">00:01:54.960</a></span> | <span class="t">The loss function also requires the targets, but I'm just going to ignore that for now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=122" target="_blank">00:02:02.320</a></span> | <span class="t">because it's not really part of what we actually care about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=125" target="_blank">00:02:05.040</a></span> | <span class="t">And what we're interested in knowing is if we want to be able to update the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=131" target="_blank">00:02:11.040</a></span> | <span class="t">Let's say this is just a single layer things, keep it simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=134" target="_blank">00:02:14.240</a></span> | <span class="t">If we want to be able to update the weights, we need to know how does the loss change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=143" target="_blank">00:02:23.520</a></span> | <span class="t">if we change the weights, if we change one weight at a time, if you like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=149" target="_blank">00:02:29.760</a></span> | <span class="t">So how would we calculate that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=152" target="_blank">00:02:32.080</a></span> | <span class="t">Well, what we could do is we could rewrite our loss function by saying, well, let's call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=161" target="_blank">00:02:41.040</a></span> | <span class="t">capital N the result of the neural network applied to the weights and the inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=168" target="_blank">00:02:48.720</a></span> | <span class="t">And that way we can now rewrite the loss function to say L equals, big L equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=175" target="_blank">00:02:55.920</a></span> | <span class="t">little L, the loss function applied to the output of the neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=182" target="_blank">00:03:02.240</a></span> | <span class="t">And so maybe you can see where this is going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=186" target="_blank">00:03:06.240</a></span> | <span class="t">We can now say, okay, the derivative of the loss with respect to the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=191" target="_blank">00:03:11.280</a></span> | <span class="t">is going to be equal to the derivative of the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=196" target="_blank">00:03:16.240</a></span> | <span class="t">with respect to the outputs of that neural network layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=200" target="_blank">00:03:20.960</a></span> | <span class="t">times, this is the chain rule, the derivative of the outputs of that neural network layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=212" target="_blank">00:03:32.880</a></span> | <span class="t">I'm going to get my notation consistent since these are not scalar with respect to the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=225" target="_blank">00:03:45.360</a></span> | <span class="t">Right, so you can see we can get rid of those and we end up with the change in loss with respect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=233" target="_blank">00:03:53.840</a></span> | <span class="t">to the weights. And so we can just say this is a chain rule. That's what the chain rule is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=242" target="_blank">00:04:02.000</a></span> | <span class="t">So the change in the loss with respect to the output of the neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=248" target="_blank">00:04:08.240</a></span> | <span class="t">Well, we did the forward pass here and then we took here, this here is where we calculated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=257" target="_blank">00:04:17.280</a></span> | <span class="t">the derivative of the loss with respect to the output of the neural network,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=266" target="_blank">00:04:26.640</a></span> | <span class="t">which came out from here and ended up in diff. So there it is there. So out.g contains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=276" target="_blank">00:04:36.640</a></span> | <span class="t">this derivative. So then to calculate, let's actually do one more. We could also say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=286" target="_blank">00:04:46.880</a></span> | <span class="t">the change in the loss with respect to the inputs, we can do the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=295" target="_blank">00:04:55.040</a></span> | <span class="t">With the chain rule times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=300" target="_blank">00:05:00.880</a></span> | <span class="t">And so this time we have the inputs. So here you can see that is this line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=319" target="_blank">00:05:19.120</a></span> | <span class="t">So that is the change in the loss with respect to the inputs. That's what input.g means. And it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=331" target="_blank">00:05:31.200</a></span> | <span class="t">equal to the change in the loss with respect to the output. So that's what out.g means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=343" target="_blank">00:05:43.680</a></span> | <span class="t">Times, it's actually matrix times because we're doing matrix calculus, times the this derivative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=350" target="_blank">00:05:50.800</a></span> | <span class="t">and since this is a linear layer we were looking at this derivative is simply the weights themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=355" target="_blank">00:05:55.120</a></span> | <span class="t">And then we have exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=358" target="_blank">00:05:58.240</a></span> | <span class="t">for w.g, which is the change in the loss, the derivative of the loss with respect to the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=370" target="_blank">00:06:10.640</a></span> | <span class="t">And so again you've got the same thing. You've got your out.g and remember we actually showed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=374" target="_blank">00:06:14.320</a></span> | <span class="t">how we can simplify this into also a matrix product with a transpose as well. So that's how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=380" target="_blank">00:06:20.000</a></span> | <span class="t">what's happening in our code is mapping to the math. So hopefully that's useful but as I say do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=390" target="_blank">00:06:30.800</a></span> | <span class="t">check out this really nice resource which has a lot more detail if you're interested in digging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=397" target="_blank">00:06:37.280</a></span> | <span class="t">deeper. The other thing I'd say is some people have mentioned that they actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=404" target="_blank">00:06:44.160</a></span> | <span class="t">didn't study this at high school which is fine. We've provided resources on the forum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=412" target="_blank">00:06:52.320</a></span> | <span class="t">for recommending how to learn the basics of derivatives and the chain rule. And so in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=421" target="_blank">00:07:01.280</a></span> | <span class="t">particular I would recommend 3Blue1Brown's Essence of Calculus series and also Khan Academy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=427" target="_blank">00:07:07.200</a></span> | <span class="t">It's not particularly difficult to learn it'll only take you a few hours and then you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=432" target="_blank">00:07:12.560</a></span> | <span class="t">this will make a lot more sense. Or if you did it at high school but you've forgotten it same deal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=438" target="_blank">00:07:18.720</a></span> | <span class="t">So don't worry if you found this difficult because you had forgotten the or had never learned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=447" target="_blank">00:07:27.440</a></span> | <span class="t">the you know basic derivative and chain rule stuff. That's something that you can pick up now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=453" target="_blank">00:07:33.440</a></span> | <span class="t">and I would recommend doing so. Okay so what we then did last time which is actually pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=464" target="_blank">00:07:44.080</a></span> | <span class="t">exciting is we got to a point where we had successfully created a training loop which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=470" target="_blank">00:07:50.880</a></span> | <span class="t">did these four steps. So and the nice thing is that every single thing here is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=479" target="_blank">00:07:59.040</a></span> | <span class="t">that we have implemented from scratch. Now we didn't always use our implemented from scratch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=483" target="_blank">00:08:03.920</a></span> | <span class="t">versions. There's no particular reason to. When we've re-implemented something that already exists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=488" target="_blank">00:08:08.240</a></span> | <span class="t">let's use the version that exists. But every single thing here I guess not argmax but that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=494" target="_blank">00:08:14.240</a></span> | <span class="t">trivially easy to implement. Every single thing here we have implemented ourselves. And we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=503" target="_blank">00:08:23.200</a></span> | <span class="t">successfully trained a an MNIST model to 90 percent 96 percent accurately recognize handwritten</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=512" target="_blank">00:08:32.080</a></span> | <span class="t">digits. So I think that's super neat. It's it's this is I mean this this is not a great metric.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=522" target="_blank">00:08:42.240</a></span> | <span class="t">It's only looking at the training session in particular it's only looking at one batch of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=525" target="_blank">00:08:45.600</a></span> | <span class="t">the training set. Since last time I've just refactored a little bit I've pulled out this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=530" target="_blank">00:08:50.080</a></span> | <span class="t">report function which is now just running at the end of each epoch. And it's just printing out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=539" target="_blank">00:08:59.200</a></span> | <span class="t">the loss and the accuracy. Just something I wanted to mention here is hopefully you've seen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=545" target="_blank">00:09:05.040</a></span> | <span class="t">fstrings before. They're a really helpful part of Python that lets you pop a variable or an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=552" target="_blank">00:09:12.400</a></span> | <span class="t">expression inside curly braces in a string and it it'll evaluate it. You might not have seen this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=558" target="_blank">00:09:18.720</a></span> | <span class="t">colon thing. This is called a format specifier. And with a format specifier you can change how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=566" target="_blank">00:09:26.560</a></span> | <span class="t">things are printed in an fstring. So this is how I'm printing it to do decimal places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=571" target="_blank">00:09:31.280</a></span> | <span class="t">This says a two decimal places floating point number called loss printed out here followed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=578" target="_blank">00:09:38.000</a></span> | <span class="t">by a comma. So I'm not going to show you how to use those other than to say yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=584" target="_blank">00:09:44.320</a></span> | <span class="t">Python fstrings and format specifiers are really helpful. And so if you haven't used them before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=590" target="_blank">00:09:50.720</a></span> | <span class="t">do go look them up tutorial of the documentation because they're definitely something that you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=596" target="_blank">00:09:56.640</a></span> | <span class="t">probably find useful to know about. Okay so let's just rerun all those lines of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=602" target="_blank">00:10:02.480</a></span> | <span class="t">If you're wondering how I just reran all the cells above where I was there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=610" target="_blank">00:10:10.000</a></span> | <span class="t">cell here there's run all above. And it's so helpful that I always make sure there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=619" target="_blank">00:10:19.920</a></span> | <span class="t">keyboard shortcut for that. So you can see here I've added a keyboard shortcut QA. So if I type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=627" target="_blank">00:10:27.520</a></span> | <span class="t">QA it runs all cells above. If I type QB it runs all cells below. And so yeah stuff that you do a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=636" target="_blank">00:10:36.000</a></span> | <span class="t">lot make sure you've got keyboard shortcuts for them. You don't want to be fiddling around moving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=639" target="_blank">00:10:39.600</a></span> | <span class="t">around your mouse everywhere. You want it to be as easy as thinking. So this is really exciting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=646" target="_blank">00:10:46.080</a></span> | <span class="t">We've successfully built and trained a neural network model from scratch and it works okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=651" target="_blank">00:10:51.280</a></span> | <span class="t">It's a bit clunky there's a lot of code there's features we're missing. So let's start refactoring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=657" target="_blank">00:10:57.520</a></span> | <span class="t">it. And so refactoring is all about making it so we have to write less code to do the same work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=671" target="_blank">00:11:11.360</a></span> | <span class="t">And so we're now going to I'm going to show you something that's part of PyTorch and then I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=677" target="_blank">00:11:17.440</a></span> | <span class="t">going to show you how to build it. And then you'll see why this is really useful. So PyTorch has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=683" target="_blank">00:11:23.680</a></span> | <span class="t">sub module called nn torch.nn and in there there's something called the module class. Now we can we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=689" target="_blank">00:11:29.760</a></span> | <span class="t">don't normally use it this way but I just want to show you how it works. We can create an instance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=693" target="_blank">00:11:33.520</a></span> | <span class="t">of it in the usual way where we create instances of classes. And then we can assign things to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=699" target="_blank">00:11:39.600</a></span> | <span class="t">attributes of that module. So for example it's assign a linear layer to it. And if we now print out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=708" target="_blank">00:11:48.080</a></span> | <span class="t">that you'll see it says oh this is a module containing something called foo which is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=715" target="_blank">00:11:55.520</a></span> | <span class="t">linear layer. But here's something quite tricky. This module we can say show me all of the named</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=724" target="_blank">00:12:04.240</a></span> | <span class="t">children of that module. And it says oh there's one called foo and it's a linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=729" target="_blank">00:12:09.760</a></span> | <span class="t">And we can say oh show me all of the parameters of this module. And it says oh okay sure there's two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=740" target="_blank">00:12:20.560</a></span> | <span class="t">of them. There's this four by three tensor that's the weights. And there's this four long vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=750" target="_blank">00:12:30.160</a></span> | <span class="t">that's the biases. And so somehow just by creating this module and assigning this to it it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=758" target="_blank">00:12:38.720</a></span> | <span class="t">automatically tracked what's in this module and what are its parameters. That's pretty neat. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=765" target="_blank">00:12:45.200</a></span> | <span class="t">we're going to see both how and why it does that. I'm just going to point out by the way why did I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=770" target="_blank">00:12:50.640</a></span> | <span class="t">add list here. If I just said m1.name children it just prints out generator object which is not very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=778" target="_blank">00:12:58.880</a></span> | <span class="t">helpful. And that's because this is a kind of iterator called a generator. And it's something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=787" target="_blank">00:13:07.920</a></span> | <span class="t">which is going to only produce the contents of this when I actually do something with it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=794" target="_blank">00:13:14.000</a></span> | <span class="t">such as list them out. So just popping a list around a generator is one way to like run the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=798" target="_blank">00:13:18.880</a></span> | <span class="t">generator and get its output. So that's a little trick when you want to look inside a generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=806" target="_blank">00:13:26.800</a></span> | <span class="t">Okay so now as I said we don't normally use it this way. What we normally do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=813" target="_blank">00:13:33.600</a></span> | <span class="t">is we create our own class. So for example we create our own multi-layer perceptron</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=817" target="_blank">00:13:37.600</a></span> | <span class="t">and we inherit it. We inherit from nn.module. And so then in done to enter this is the thing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=823" target="_blank">00:13:43.760</a></span> | <span class="t">constructs an object of the class. This is the special magic method that does that. We'll say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=830" target="_blank">00:13:50.640</a></span> | <span class="t">okay well how many inputs are there to this multi-layer perceptron. How many hidden activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=836" target="_blank">00:13:56.240</a></span> | <span class="t">And how many output activations are there. So just be one hidden layer. And then here we can do just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=841" target="_blank">00:14:01.680</a></span> | <span class="t">like we did up here where we assigned things as attributes. We can do that in this constructor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=848" target="_blank">00:14:08.880</a></span> | <span class="t">So we'll create an l1 attribute which is a linear layer from number in to number hidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=853" target="_blank">00:14:13.760</a></span> | <span class="t">L2 is a linear layer from number hidden to number out. And we'll also create a value. And so when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=865" target="_blank">00:14:25.840</a></span> | <span class="t">call that module we can take the input that we get and run the linear layer and then run the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=878" target="_blank">00:14:38.400</a></span> | <span class="t">value and then run the l2. And so I can create one of these as you see. And I can have a look and see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=890" target="_blank">00:14:50.800</a></span> | <span class="t">like oh here's the attribute l1. And there it is like I had. And I can say print out the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=898" target="_blank">00:14:58.560</a></span> | <span class="t">and the model knows all the stuff that's in it. And I can go through each of the named children</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=905" target="_blank">00:15:05.840</a></span> | <span class="t">and print out the name and the layer. Now of course if you remember although you can use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=914" target="_blank">00:15:14.720</a></span> | <span class="t">dundercall we actually showed how we can refactor things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=921" target="_blank">00:15:21.440</a></span> | <span class="t">using forward such that it would automatically kind of do the things necessary to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=929" target="_blank">00:15:29.680</a></span> | <span class="t">all the you know automatic gradient stuff work correctly. And so in practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=939" target="_blank">00:15:39.680</a></span> | <span class="t">we're actually not going to do dundercall we would do forward. So this is an example of creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=947" target="_blank">00:15:47.920</a></span> | <span class="t">a custom PyTorch module. And the key thing to recognize is that it knows what are all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=954" target="_blank">00:15:54.720</a></span> | <span class="t">attributes you added to it. And it also knows what are all the parameters. So if I go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=961" target="_blank">00:16:01.680</a></span> | <span class="t">the parameters and print out their shapes you can see I've got my linear layer's weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=966" target="_blank">00:16:06.080</a></span> | <span class="t">First linear layer sorry second linear layer. My first linear layer's weights. My first linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=972" target="_blank">00:16:12.080</a></span> | <span class="t">layer's biases. Second linear layer's weights. Second linear layer's biases. And this 50 is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=977" target="_blank">00:16:17.280</a></span> | <span class="t">because we set nh the number of hidden to 50. So why is that interesting? Well because now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=990" target="_blank">00:16:30.080</a></span> | <span class="t">I don't have to write all this anymore going through layers and having to make sure that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=998" target="_blank">00:16:38.800</a></span> | <span class="t">they've all been put into a list. We've just been able to add them as attributes and they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1004" target="_blank">00:16:44.720</a></span> | <span class="t">automatically going to appear as parameters. So we can just say go through each parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1009" target="_blank">00:16:49.360</a></span> | <span class="t">and update it based on the gradient and the learning rate. And furthermore you can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1017" target="_blank">00:16:57.280</a></span> | <span class="t">just go model.zero grad and it'll zero out all of the gradients. So that's really made our code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1025" target="_blank">00:17:05.520</a></span> | <span class="t">quite a lot nicer and quite a lot more flexible which is cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1029" target="_blank">00:17:09.840</a></span> | <span class="t">So let's check that this still works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1034" target="_blank">00:17:14.240</a></span> | <span class="t">There we go. So just to clarify with if I called report on this before I ran it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1045" target="_blank">00:17:25.920</a></span> | <span class="t">as you would expect the accuracy is about 8% or about 10% bit less and the loss is pretty high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1052" target="_blank">00:17:32.400</a></span> | <span class="t">And so after I run this fit this model the accuracy goes up and the loss goes down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1061" target="_blank">00:17:41.360</a></span> | <span class="t">So basically it's all of this exactly the same as before. The only thing I've changed are these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1067" target="_blank">00:17:47.680</a></span> | <span class="t">two lines of code. So that's a really useful refactoring. So how on earth did this happen?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1072" target="_blank">00:17:52.960</a></span> | <span class="t">How did it know what the parameters and layers are automatically?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1078" target="_blank">00:17:58.320</a></span> | <span class="t">It used a trick called dunder setatra and we're going to create our own nn.module now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1087" target="_blank">00:18:07.680</a></span> | <span class="t">So if there was no such thing as nn.module here's how we'd build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1096" target="_blank">00:18:16.000</a></span> | <span class="t">And so let's actually build it and also add some things to it. So in dunder init</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1100" target="_blank">00:18:20.800</a></span> | <span class="t">we would have to create a dictionary for our named children. This is going to contain a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1105" target="_blank">00:18:25.840</a></span> | <span class="t">a dictionary of all of the layers. Okay and then just like before we'll create a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1110" target="_blank">00:18:30.880</a></span> | <span class="t">linear layers right and then what we're going to do is we're going to define this special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1116" target="_blank">00:18:36.720</a></span> | <span class="t">magic thing that python has called dunder setatra and this is called automatically by python if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1122" target="_blank">00:18:42.160</a></span> | <span class="t">have it every time you set an attribute such as here or here and it's going to be past the name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1129" target="_blank">00:18:49.360</a></span> | <span class="t">of the attribute the key and the value is the actual thing on the right hand side of the equal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1134" target="_blank">00:18:54.400</a></span> | <span class="t">sign. Now generally speaking things that start with an underscore we use for either for private</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1142" target="_blank">00:19:02.160</a></span> | <span class="t">stuff so we check that it doesn't start with an underscore and if it doesn't start with an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1148" target="_blank">00:19:08.480</a></span> | <span class="t">underscore setatra will put this value into the module's dictionary with this key and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1161" target="_blank">00:19:21.440</a></span> | <span class="t">call pythons the normal python setatra to make sure it just actually does the attribute setting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1170" target="_blank">00:19:30.640</a></span> | <span class="t">So super is how you call whatever is in the the super class the base class. So another useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1178" target="_blank">00:19:38.960</a></span> | <span class="t">thing to know about is how do we how does how does it do this nifty thing where you can just type the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1183" target="_blank">00:19:43.840</a></span> | <span class="t">name and it kind of lists out all this information about it. That's a special thing called dunder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1188" target="_blank">00:19:48.960</a></span> | <span class="t">repra. So here dunder repra will just have it return a stringified version of the modules dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1197" target="_blank">00:19:57.680</a></span> | <span class="t">and then here we've got parameters. How did parameters work? So how did this thing work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1202" target="_blank">00:20:02.880</a></span> | <span class="t">Well we can go through each of those modules go through each value so the values of the modules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1211" target="_blank">00:20:11.440</a></span> | <span class="t">is all the actual layers and then go through each of the parameters in each module and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1217" target="_blank">00:20:17.840</a></span> | <span class="t">yield p so that's going to that's going to create an iterator if you remember when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1222" target="_blank">00:20:22.880</a></span> | <span class="t">looked at iterators for all the parameters. So let's try it so we can create one of these modules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1227" target="_blank">00:20:27.840</a></span> | <span class="t">and if we just like before loop through its parameters there they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1232" target="_blank">00:20:32.480</a></span> | <span class="t">Now I'll just mention something that's optional kind of like advanced python that a lot of people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1240" target="_blank">00:20:40.400</a></span> | <span class="t">don't know about which is there's no need to loop through a list or a generator or I guess say loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1247" target="_blank">00:20:47.680</a></span> | <span class="t">through an iterator and yield there's actually a shortcut which is you can just say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1253" target="_blank">00:20:53.280</a></span> | <span class="t">yield from and then give it the iterator and so with that we can get this all down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1264" target="_blank">00:21:04.720</a></span> | <span class="t">to one line of code and it will do exactly the same thing. So that's basically saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1270" target="_blank">00:21:10.880</a></span> | <span class="t">yield one at a time everything in here that's what yield from does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1276" target="_blank">00:21:16.640</a></span> | <span class="t">So there's a cool little advanced python thing totally optional but if you're interested I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1282" target="_blank">00:21:22.000</a></span> | <span class="t">it can be kind of neat. So we've now learned how to create our own implementation of nn.module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1289" target="_blank">00:21:29.120</a></span> | <span class="t">and therefore we are now allowed to use PyTorch's nn.module so that's good news.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1297" target="_blank">00:21:37.840</a></span> | <span class="t">So how would we do using the PyTorch nn.module how would we create the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1308" target="_blank">00:21:48.400</a></span> | <span class="t">that we started with which is where we had this self.layers because we want to somehow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1316" target="_blank">00:21:56.960</a></span> | <span class="t">register all of these all at once that's not going to happen based on the code we just wrote.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1324" target="_blank">00:22:04.800</a></span> | <span class="t">So to do that let's have a look we can so let's make a list of the layers we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1335" target="_blank">00:22:15.280</a></span> | <span class="t">and so we'll create again a subclass of nn.module make sure you call the super classes in it first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1343" target="_blank">00:22:23.760</a></span> | <span class="t">and we'll just store the list of layers and then to tell PyTorch about all those layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1354" target="_blank">00:22:34.000</a></span> | <span class="t">we basically have to loop through them and call add-module and say what the name of the module is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1360" target="_blank">00:22:40.480</a></span> | <span class="t">and what the module is and again you probably should have used forward here in the first place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1369" target="_blank">00:22:49.520</a></span> | <span class="t">and you can see this is now done exactly the same thing okay so if you've used a sequential model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1377" target="_blank">00:22:57.840</a></span> | <span class="t">before you'll see or you can see that we're on the path to creating a sequential model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1383" target="_blank">00:23:03.040</a></span> | <span class="t">Okay so ganache has asked an interesting question which is what on earth is super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1389" target="_blank">00:23:09.120</a></span> | <span class="t">calling because we actually in fact we don't even need the parentheses here we actually don't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1395" target="_blank">00:23:15.360</a></span> | <span class="t">a base class that's because if you don't put any parentheses or if you put empty parentheses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1402" target="_blank">00:23:22.320</a></span> | <span class="t">it's actually a shortcut for writing that and so python has stuff in object which does you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1411" target="_blank">00:23:31.440</a></span> | <span class="t">all the normal objecty things like storing your attributes so that you can get them back later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1417" target="_blank">00:23:37.200</a></span> | <span class="t">so that's what's happening there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1419" target="_blank">00:23:39.680</a></span> | <span class="t">Okay so this is a little bit awkward is to have to store the list and then enumerate and call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1430" target="_blank">00:23:50.160</a></span> | <span class="t">add-module so now that we've implemented that from scratch we can use PyTorch's version which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1435" target="_blank">00:23:55.840</a></span> | <span class="t">they've just got something called module list that just does that for you okay so if you use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1440" target="_blank">00:24:00.640</a></span> | <span class="t">module list and pass it a list of layers it will just go ahead and register them all those modules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1446" target="_blank">00:24:06.320</a></span> | <span class="t">for you so here's something called sequential model so this is just like an n not sequential now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1450" target="_blank">00:24:10.480</a></span> | <span class="t">so if i create it passing in the layers there you go you can see there's my model containing my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1457" target="_blank">00:24:17.360</a></span> | <span class="t">module list with my layers and so i don't know why i never used forward for these things it's silly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1467" target="_blank">00:24:27.600</a></span> | <span class="t">um i guess it doesn't matter terribly in this stage but anyhow okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1471" target="_blank">00:24:31.760</a></span> | <span class="t">call fit and there we go okay so um so in forward here i just go through each layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1485" target="_blank">00:24:45.040</a></span> | <span class="t">and i set the result of that equal to calling that layer on the previous result and then pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1491" target="_blank">00:24:51.120</a></span> | <span class="t">and return it at the end now there's a little um another way of doing this which i think is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1495" target="_blank">00:24:55.680</a></span> | <span class="t">kind of fun it's not like shorter or anything at this stage i just wanted to show an example of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1501" target="_blank">00:25:01.040</a></span> | <span class="t">something that you see quite a lot in machine learning code which is the use of reduce</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1505" target="_blank">00:25:05.280</a></span> | <span class="t">this implementation here is exactly the same as this thing here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1512" target="_blank">00:25:12.160</a></span> | <span class="t">so let me explain how it works what reduce does so reduce is a very common kind of like fundamental</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1522" target="_blank">00:25:22.800</a></span> | <span class="t">computer science concept reductions this is something that does a reduction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1526" target="_blank">00:25:26.880</a></span> | <span class="t">and what a reduction is is it something that says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1528" target="_blank">00:25:28.960</a></span> | <span class="t">start with the third parameter some initial value so we're going to start with x the thing we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1537" target="_blank">00:25:37.600</a></span> | <span class="t">being passed and then loop through a sequence so look through each of our layers and then for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1544" target="_blank">00:25:44.800</a></span> | <span class="t">layer call some function here is our function and the function is going to get passed first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1554" target="_blank">00:25:54.560</a></span> | <span class="t">time around it'll be past the initial value and the first thing in your list so your first layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1560" target="_blank">00:26:00.640</a></span> | <span class="t">and x so it's just going to call my the layer function on x the second time around it takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1568" target="_blank">00:26:08.240</a></span> | <span class="t">the output of that and passes it in as a circuit as the first parameter and passes in the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1573" target="_blank">00:26:13.680</a></span> | <span class="t">layer so then the second time this goes through it's going to be calling the second layer on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1578" target="_blank">00:26:18.960</a></span> | <span class="t">result of the first layer and so forth and that's what a reduction is and so when you might see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1585" target="_blank">00:26:25.440</a></span> | <span class="t">reduce you'll certainly see it talked about quite a lot in in papers and books and you might sometimes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1592" target="_blank">00:26:32.000</a></span> | <span class="t">also see it in code it's a very general concept and so here's how you can implement a sequential</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1600" target="_blank">00:26:40.560</a></span> | <span class="t">model using reduce so there's no explicit loop there although the loop's still happening internally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1608" target="_blank">00:26:48.320</a></span> | <span class="t">all right so now that we've reimplemented sequential we can just go ahead and use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1613" target="_blank">00:26:53.040</a></span> | <span class="t">pytorch's version so there's nn.sequential we can pass in our layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1618" target="_blank">00:26:58.160</a></span> | <span class="t">and we can fit not surprisingly we can see the model so yeah looks very similar to the one we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1624" target="_blank">00:27:04.960</a></span> | <span class="t">built ourselves all right so this thing of looping three parameters and updating our parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1640" target="_blank">00:27:20.160</a></span> | <span class="t">based on gradients and a learning rate and then zeroing them is very common so common that there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1651" target="_blank">00:27:31.760</a></span> | <span class="t">is something that does that all for us and that's called an optimizer it's the stuff in optim so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1658" target="_blank">00:27:38.320</a></span> | <span class="t">let's create our own optimizer and as you can see it's just going to do the two things we just saw</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1663" target="_blank">00:27:43.840</a></span> | <span class="t">it's going to go through each of the parameters and update them using the gradient and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1670" target="_blank">00:27:50.800</a></span> | <span class="t">learning rate and there's also zero grad which will go through each parameter and set their</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1678" target="_blank">00:27:58.720</a></span> | <span class="t">gradients to zero if you use dot data it's like it's just a way of avoiding having to say torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1685" target="_blank">00:28:05.520</a></span> | <span class="t">dot no grad basically okay so in optimizer we're going to pass it the parameters that we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1690" target="_blank">00:28:10.640</a></span> | <span class="t">optimize and we're going to pass it the learning rate and we're just going to store them away</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1695" target="_blank">00:28:15.520</a></span> | <span class="t">and since the parameters might be a generator we'll call list to to turn them into a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1704" target="_blank">00:28:24.400</a></span> | <span class="t">so we are going to create our optimizer pass it in the model dot parameters which have been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1709" target="_blank">00:28:29.840</a></span> | <span class="t">automatically constructed for us by nn dot module and so here's our new loop now we don't have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1715" target="_blank">00:28:35.120</a></span> | <span class="t">do any of the stuff manually we can just say opt dot step so that's going to call this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1722" target="_blank">00:28:42.400</a></span> | <span class="t">and opt dot zero grad and that's going to call this there it is so we've now built our own sgd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1733" target="_blank">00:28:53.840</a></span> | <span class="t">optimizer from scratch so i think this is really interesting right like these things which seem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1739" target="_blank">00:28:59.760</a></span> | <span class="t">like they must be big and complicated once we have this nice structure in place you know an sgd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1746" target="_blank">00:29:06.320</a></span> | <span class="t">optimizer doesn't take much code at all and so it's all very transparent simple clear if you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1753" target="_blank">00:29:13.680</a></span> | <span class="t">having trouble using complex library code that you've found elsewhere you know this can be a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1760" target="_blank">00:29:20.720</a></span> | <span class="t">really good approach is to actually just go all the way back remove as you know as many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1765" target="_blank">00:29:25.920</a></span> | <span class="t">of these abstractions as you can and like run everything by hand to see exactly what's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1772" target="_blank">00:29:32.480</a></span> | <span class="t">on it can be really freeing to see that you can do all this anyways since pytorch has this for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1780" target="_blank">00:29:40.480</a></span> | <span class="t">in torch dot optium it's got a optium dot sgd and just like our version you pass in the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1787" target="_blank">00:29:47.520</a></span> | <span class="t">and you pass in the learning rate so you really see it is just the same so let's define something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1792" target="_blank">00:29:52.640</a></span> | <span class="t">called get model that's going to return the model the sequential model and the optimizer for it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1802" target="_blank">00:30:02.000</a></span> | <span class="t">so if we go model comma opt equals get model and then we can call the loss function to see where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1808" target="_blank">00:30:08.400</a></span> | <span class="t">it's starting and so then we can write our training loop again go through each epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1818" target="_blank">00:30:18.720</a></span> | <span class="t">go through each starting point for our for our batches grab the slice slice into our x and y in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1828" target="_blank">00:30:28.880</a></span> | <span class="t">the training set calculate our predictions calculate our loss do the backward pass do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1834" target="_blank">00:30:34.480</a></span> | <span class="t">optimizer step do the zero gradient and print out how you're going at the end of each one and there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1840" target="_blank">00:30:40.080</a></span> | <span class="t">we go all right so let's keep making this simpler there's still too much code so one thing we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1849" target="_blank">00:30:49.440</a></span> | <span class="t">do is we could replace these lines of code with one line of code by using something we'll call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1856" target="_blank">00:30:56.880</a></span> | <span class="t">the data set plus so the data set class is just something that we're going to pass in our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1862" target="_blank">00:31:02.480</a></span> | <span class="t">independent and dependent variable we'll store them away as self dot x and self dot y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1868" target="_blank">00:31:08.960</a></span> | <span class="t">we'll have something so if you if you define done to len then that's the thing that allows the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1876" target="_blank">00:31:16.800</a></span> | <span class="t">len function to work so the length of the data set will just be the length of the independent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1881" target="_blank">00:31:21.040</a></span> | <span class="t">variables and then done to get item is the thing that will be called automatically anytime you use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1887" target="_blank">00:31:27.680</a></span> | <span class="t">square brackets in python so that just is going to call this function passing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1892" target="_blank">00:31:32.800</a></span> | <span class="t">the indices that you want so when we grab some items from our data set we're going to return a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1899" target="_blank">00:31:39.040</a></span> | <span class="t">tuple of the x values and the y values so then we'll be able to do this so let's create a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1907" target="_blank">00:31:47.760</a></span> | <span class="t">set using this tiny little three line class it's going to be a data set containing the x and y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1914" target="_blank">00:31:54.640</a></span> | <span class="t">training and they'll create another data set containing the x and y valid and those two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1919" target="_blank">00:31:59.920</a></span> | <span class="t">data sets will call train ds and valid ds so let's check the length of those data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1927" target="_blank">00:32:07.040</a></span> | <span class="t">should be the same as the length of the x's and they are and so now we can do exactly what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1935" target="_blank">00:32:15.200</a></span> | <span class="t">hope we could do we can say xb comma yb equals train ds and pass in some slice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1941" target="_blank">00:32:21.280</a></span> | <span class="t">so that's going to give us back our check the shapes are correct it should be five by 28 by 28</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1952" target="_blank">00:32:32.400</a></span> | <span class="t">five by 28 times 28 and the y's should just be five and so here they are the x's and the y's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1961" target="_blank">00:32:41.840</a></span> | <span class="t">so that's nice we've created a data set from scratch and again it's not complicated at all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1968" target="_blank">00:32:48.160</a></span> | <span class="t">and if you look at the actual pytorch source code this is basically all data sets do so let's try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1974" target="_blank">00:32:54.240</a></span> | <span class="t">it we call get model and so now we've replaced our data set line with this one and as per usual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1982" target="_blank">00:33:02.080</a></span> | <span class="t">it still runs and so this is what i do when i'm writing code is i try to like always make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1989" target="_blank">00:33:09.920</a></span> | <span class="t">that my starting code works as i refactor and so you can see all the steps and so somebody reading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1995" target="_blank">00:33:15.360</a></span> | <span class="t">my code can then see exactly like why am i building everything i'm building how does it all fit in see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=1999" target="_blank">00:33:19.920</a></span> | <span class="t">that it still works and i can also keep it clear in my own head so i think this is a really nice way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2004" target="_blank">00:33:24.800</a></span> | <span class="t">of implementing libraries as well all right so now we're going to replace these two lines of code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2015" target="_blank">00:33:35.440</a></span> | <span class="t">with this one line of code so we're going to create something called a data loader and a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2020" target="_blank">00:33:40.000</a></span> | <span class="t">loader is something that's just going to do this okay so we need to create an iterator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2025" target="_blank">00:33:45.520</a></span> | <span class="t">so an iterator is a class that has a dunder iter method when you say for n in python behind the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2035" target="_blank">00:33:55.760</a></span> | <span class="t">scenes it's actually calling dunder iter to get a special object which it can then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2044" target="_blank">00:34:04.400</a></span> | <span class="t">loop through using yield so it's basically getting this thing that you can iterate through using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2049" target="_blank">00:34:09.280</a></span> | <span class="t">yield so a data loader is something that's going to have a data set and a batch size because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2056" target="_blank">00:34:16.400</a></span> | <span class="t">going to go through the batches and grab one batch at a time so we have to store away the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2063" target="_blank">00:34:23.360</a></span> | <span class="t">data set and the batch size and so when you when we call the for loop it's going to call dunder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2068" target="_blank">00:34:28.240</a></span> | <span class="t">iter we're going to want to do exactly what we saw before go through the range just like we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2074" target="_blank">00:34:34.000</a></span> | <span class="t">before and then yield that bit of the data set and that's all so that's a data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2083" target="_blank">00:34:43.600</a></span> | <span class="t">so we can now create a train data loader and a valid data loader from our train data set and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2088" target="_blank">00:34:48.480</a></span> | <span class="t">valid data set and so now we can if you remember the way you can get one thing out of an iterator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2097" target="_blank">00:34:57.440</a></span> | <span class="t">so you don't need to use a for loop you can just say iter and that will also call dunder iter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2103" target="_blank">00:35:03.120</a></span> | <span class="t">next we'll just grab one value from it so here we will run this and you can see we've now just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2108" target="_blank">00:35:08.640</a></span> | <span class="t">confirmed we've xb is a 50 by 784 and yb there it is and then we can check what it looks like so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2120" target="_blank">00:35:20.240</a></span> | <span class="t">let's grab the first element of our x batch make it 28 by 28 and there it is so now that we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2130" target="_blank">00:35:30.720</a></span> | <span class="t">a data loader again we can grab our model and we can simplify our fit function to just go for xb yb</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2137" target="_blank">00:35:37.920</a></span> | <span class="t">and train deal so this is getting nice and small don't you think and it still works the same way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2144" target="_blank">00:35:44.480</a></span> | <span class="t">okay so this is really cool and now that it's nice and concise we can start adding features to it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2152" target="_blank">00:35:52.560</a></span> | <span class="t">so one feature i think we should add is that our training set each time we go through it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2159" target="_blank">00:35:59.600</a></span> | <span class="t">it should be in a different order it should be randomized the order so instead of always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2168" target="_blank">00:36:08.800</a></span> | <span class="t">just going through these indexes in order we want some way to say go use random indexes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2175" target="_blank">00:36:15.680</a></span> | <span class="t">so the way we can do that is creates a class called sampler and what sampler is going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2182" target="_blank">00:36:22.400</a></span> | <span class="t">i'll show you is if we create a sampler without shuffle without randomizing it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2192" target="_blank">00:36:32.960</a></span> | <span class="t">it's going to simply return all the numbers from zero up to n in order and it'll be an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2200" target="_blank">00:36:40.880</a></span> | <span class="t">iterator see this is done to it but if i do want it shuffled then it will randomly shuffle them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2207" target="_blank">00:36:47.600</a></span> | <span class="t">so here you can see i've created a sampler without shuffle so if i then make an iterator from that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2214" target="_blank">00:36:54.320</a></span> | <span class="t">and print a few things from the iterator you can see it's just printing out the indexes it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2220" target="_blank">00:37:00.800</a></span> | <span class="t">to want or i can do exactly the same thing as we learned earlier in the course using i slice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2227" target="_blank">00:37:07.280</a></span> | <span class="t">we can grab the first five so here's the first five things from a sampler when it's not shuffled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2232" target="_blank">00:37:12.000</a></span> | <span class="t">so as you can see these are just indexes so we could add shuffle equals true and now that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2239" target="_blank">00:37:19.920</a></span> | <span class="t">going to call random dot shuffle which just randomly permits them and now if i do the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2246" target="_blank">00:37:26.240</a></span> | <span class="t">i've got random indexes of my source data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2249" target="_blank">00:37:29.600</a></span> | <span class="t">so why is that useful well what we could now do is create something called a batch sampler and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2258" target="_blank">00:37:38.880</a></span> | <span class="t">what the batch sampler is going to do is it's going to basically do this i slice thing for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2264" target="_blank">00:37:44.320</a></span> | <span class="t">so we're going to say okay pass in a sampler so that's something that generates indices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2268" target="_blank">00:37:48.480</a></span> | <span class="t">and pass in a batch size and remember we've looked at chunking before it's going to chunk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2274" target="_blank">00:37:54.960</a></span> | <span class="t">that iterator by that batch size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2277" target="_blank">00:37:57.760</a></span> | <span class="t">and so if i now say all right please take our sampler and create batches of four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2287" target="_blank">00:38:07.920</a></span> | <span class="t">as you can see here it's creating batches of four indices at a time so rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2298" target="_blank">00:38:18.400</a></span> | <span class="t">just looping through them in order i can now loop through this batch sampler</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2305" target="_blank">00:38:25.600</a></span> | <span class="t">so we're going to change our data loader so that now it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2314" target="_blank">00:38:34.560</a></span> | <span class="t">take some batch sampler and it's going to loop through the batch sampler that's going to give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2326" target="_blank">00:38:46.240</a></span> | <span class="t">us indices and then we're going to get that data set item from that batch for everything in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2333" target="_blank">00:38:53.120</a></span> | <span class="t">batch so that's going to give us a list and then we have to stack all of the x's and all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2342" target="_blank">00:39:02.720</a></span> | <span class="t">y's together into tensors so i've created something here called collate function and we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2352" target="_blank">00:39:12.000</a></span> | <span class="t">default that to this little function here which is going to grab our batch pull out the x's and y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2362" target="_blank">00:39:22.640</a></span> | <span class="t">separately and then stack them up into tensors so this is called our collate function okay so if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2371" target="_blank">00:39:31.840</a></span> | <span class="t">we put all that together we can create a training sampler which is a batch sampler over the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2378" target="_blank">00:39:38.000</a></span> | <span class="t">set with shuffle true a validation sampler will be a batch sampler over the validation set with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2386" target="_blank">00:39:46.240</a></span> | <span class="t">shuffle false and so then we can pass that into this data loader class the training data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2396" target="_blank">00:39:56.320</a></span> | <span class="t">and the training sampler and the collate function which we don't really need because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2401" target="_blank">00:40:01.840</a></span> | <span class="t">it's we're just using the default one so i guess we can just get rid of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2404" target="_blank">00:40:04.960</a></span> | <span class="t">and so now there we go we can do exactly the same thing as before x b y b is next iter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2415" target="_blank">00:40:15.440</a></span> | <span class="t">and this time we use the valid data loader check the shapes and this is how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2424" target="_blank">00:40:24.720</a></span> | <span class="t">PyTorch's actual data loaders work this is the this is all the pieces they have they have samplers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2433" target="_blank">00:40:33.520</a></span> | <span class="t">they have batch samplers they have a collation function and they have data loaders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2439" target="_blank">00:40:39.920</a></span> | <span class="t">so remember that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2443" target="_blank">00:40:43.920</a></span> | <span class="t">what i want you to be doing for your homework is experimenting with these carefully to see exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2457" target="_blank">00:40:57.280</a></span> | <span class="t">what each thing's taking in okay so PyTorch is asking on the chat what is this collate thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2463" target="_blank">00:41:03.840</a></span> | <span class="t">doing okay so collate function it defaults to collate what does it do well let's see let's go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2473" target="_blank">00:41:13.840</a></span> | <span class="t">through each of these steps okay so we need so when we've got a batch sampler so let's do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2480" target="_blank">00:41:20.320</a></span> | <span class="t">just the valid sampler okay so the batch sampler here it is so we're going to go through each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2491" target="_blank">00:41:31.120</a></span> | <span class="t">thing in the batch sampler so let's just grab one thing from the batch sampler okay so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2496" target="_blank">00:41:36.640</a></span> | <span class="t">output of the batch sampler will be next it uh okay so here's what the batch sampler contains</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2507" target="_blank">00:41:47.040</a></span> | <span class="t">all right just the first 50 digits not surprisingly because this is our validation sampler</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2511" target="_blank">00:41:51.680</a></span> | <span class="t">if we did a training sampler that would be randomized there they are okay so then what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2517" target="_blank">00:41:57.680</a></span> | <span class="t">we then do is we go self.dataset i for i and b so let's copy that copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2527" target="_blank">00:42:07.200</a></span> | <span class="t">paste and so rather than self.dataset i we'll just say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2535" target="_blank">00:42:15.760</a></span> | <span class="t">valid dsi</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2538" target="_blank">00:42:18.880</a></span> | <span class="t">oh and it's not i and b it's i and o that's what we called it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2548" target="_blank">00:42:28.560</a></span> | <span class="t">um oh we did it for training sorry training okay so what it's created here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2563" target="_blank">00:42:43.520</a></span> | <span class="t">a list of tuples of tensors i think let's have a look so let's have a look so we'll call this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2570" target="_blank">00:42:50.240</a></span> | <span class="t">um p whatever so p zero okay is a tuple it's got the x and the y independent independent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2589" target="_blank">00:43:09.680</a></span> | <span class="t">so that's not what we want what we want is something that we can loop through we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2596" target="_blank">00:43:16.000</a></span> | <span class="t">to get batches so what the collation model is going to do sorry not the collation model the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2603" target="_blank">00:43:23.440</a></span> | <span class="t">collate function is going to do is it's going to take all of our x's and all of our y's and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2612" target="_blank">00:43:32.240</a></span> | <span class="t">collect them into two tensors one tensor of x's and one tensor of y's so the way it does that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2617" target="_blank">00:43:37.760</a></span> | <span class="t">it first of all calls zip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2620" target="_blank">00:43:40.640</a></span> | <span class="t">so zip is a very very commonly used python function it's got nothing to do with the compression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2633" target="_blank">00:43:53.120</a></span> | <span class="t">program zip but instead what it does is it effectively allows us to like transpose things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2638" target="_blank">00:43:58.000</a></span> | <span class="t">so that now as you can see we've got all of the second elements or index one elements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2647" target="_blank">00:44:07.200</a></span> | <span class="t">all together and all of the index zero elements together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2650" target="_blank">00:44:10.240</a></span> | <span class="t">and so then we can stack those all up together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2653" target="_blank">00:44:13.600</a></span> | <span class="t">and that gives us our y's for our batch so that's what collate does so the collate function is used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2665" target="_blank">00:44:25.600</a></span> | <span class="t">an awful lot um uh in in pytorch increasingly nowadays where hugging face stuff uses it a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2678" target="_blank">00:44:38.320</a></span> | <span class="t">and so we'll be using it a lot as well um and basically it's a thing that allows us to customize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2683" target="_blank">00:44:43.840</a></span> | <span class="t">how the data that we get back from our data set once it's been kind of generating a list of of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2692" target="_blank">00:44:52.000</a></span> | <span class="t">things from the data set how do we put it together into some into a bunch of things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2697" target="_blank">00:44:57.760</a></span> | <span class="t">that our model can take as inputs because that's really what we want here so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2702" target="_blank">00:45:02.160</a></span> | <span class="t">what the collation function does oh this is the wrong way around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2714" target="_blank">00:45:14.720</a></span> | <span class="t">like so um this is um something that i do so often that fast core has a quick little shortcut</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2722" target="_blank">00:45:22.400</a></span> | <span class="t">for it just called store address store attributes and so if you just put that in your dunder init</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2728" target="_blank">00:45:28.480</a></span> | <span class="t">then you just need one line of code and it does exactly the same thing so there's a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2733" target="_blank">00:45:33.680</a></span> | <span class="t">shortcut as you see and so you'll see that quite a bit all right let's have a um seven minute break</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2742" target="_blank">00:45:42.800</a></span> | <span class="t">and uh see you back here very soon and we're going to look at a multi-processing data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2749" target="_blank">00:45:49.840</a></span> | <span class="t">and then we all have nearly finished this notebook all right see you soon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2754" target="_blank">00:45:54.000</a></span> | <span class="t">all right let's keep going um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2766" target="_blank">00:46:06.880</a></span> | <span class="t">so we've seen how to create a data loader um and uh sampling from it um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2774" target="_blank">00:46:14.480</a></span> | <span class="t">the pytorch data loader works exactly like this but um it uses a lot more code because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2786" target="_blank">00:46:26.480</a></span> | <span class="t">it implements um multi-processing and so multi-processing means that the actual this thing here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2795" target="_blank">00:46:35.440</a></span> | <span class="t">that code can be run uh in multiple processes they can be run in parallel for multiple items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2802" target="_blank">00:46:42.800</a></span> | <span class="t">so this code for example might be opening up a jpeg rotating it flipping it etc right so because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2812" target="_blank">00:46:52.240</a></span> | <span class="t">remember this is just calling the dunder get item uh for a data set so that could be doing a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2817" target="_blank">00:46:57.840</a></span> | <span class="t">work for each item and we're doing it for every item in the batch so we'd love to do those all in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2821" target="_blank">00:47:01.840</a></span> | <span class="t">parallel so i'll show you a very quick and dirty way that basically does the job um so um python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2832" target="_blank">00:47:12.640</a></span> | <span class="t">has a multi-processing library um it doesn't work particularly well with pytorch tenses so pytorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2840" target="_blank">00:47:20.160</a></span> | <span class="t">has created an exact reimplementation of it so it's identical api wise but it does work well with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2845" target="_blank">00:47:25.920</a></span> | <span class="t">tenses so this is basically we'll just grab the multi-processing so this is not quite cheating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2850" target="_blank">00:47:30.640</a></span> | <span class="t">because multi-processing isn't the standard library and this is api equivalent so i'm going to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2856" target="_blank">00:47:36.320</a></span> | <span class="t">we're allowed to do that um so as we've discussed you know when we call square brackets on a class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2867" target="_blank">00:47:47.040</a></span> | <span class="t">it's actually identical to calling the dunder get item function on on the object so you can see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2876" target="_blank">00:47:56.800</a></span> | <span class="t">if we say give me items three six eight and one it's the same as calling dunder get item passing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2884" target="_blank">00:48:04.240</a></span> | <span class="t">three six eight and one now why does this matter well i'll show you why it matters because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2893" target="_blank">00:48:13.360</a></span> | <span class="t">going to be able to use map and i'll explain why we want to use map in a moment map is a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2897" target="_blank">00:48:17.600</a></span> | <span class="t">important concept you might have heard of map reduce so we've already talked about reductions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2901" target="_blank">00:48:21.520</a></span> | <span class="t">and what those are um maps are kind of the other key piece map is something which takes a sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2908" target="_blank">00:48:28.160</a></span> | <span class="t">and calls a function on every element of that sequence so imagine we had a couple of batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2915" target="_blank">00:48:35.680</a></span> | <span class="t">of indices three and six and eight and one then we're going to call dunder get item</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2922" target="_blank">00:48:42.560</a></span> | <span class="t">on each of those batches so that's what map does map calls this function on every element</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2930" target="_blank">00:48:50.080</a></span> | <span class="t">of this sequence and so that's going to give us the same stuff but now this same as this but now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2938" target="_blank">00:48:58.880</a></span> | <span class="t">batched into two batches now why do we want to do that because multi-processing has something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2946" target="_blank">00:49:06.960</a></span> | <span class="t">called pool where you can tell it how many workers you want to run how many processes you want to run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2953" target="_blank">00:49:13.280</a></span> | <span class="t">and it then has a map which works just like the python normal python map but it runs this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2960" target="_blank">00:49:20.240</a></span> | <span class="t">function in parallel over the items from this iterator so this is how we can create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2968" target="_blank">00:49:28.000</a></span> | <span class="t">multi-processing data loader so here we're creating our data loader and again we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2976" target="_blank">00:49:36.240</a></span> | <span class="t">actually need to pass in the collect function because we're using the default one so if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2979" target="_blank">00:49:39.280</a></span> | <span class="t">say nworkers equals two and then create that if we say next see how it's taking a moment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2986" target="_blank">00:49:46.800</a></span> | <span class="t">and it took a moment because it was firing off those two workers in the background so the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2991" target="_blank">00:49:51.440</a></span> | <span class="t">batch actually comes out more slowly but the reason that we would use a multi-processing data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=2997" target="_blank">00:49:57.520</a></span> | <span class="t">is if this is doing a lot of work we want it to run in parallel and even though the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3004" target="_blank">00:50:04.400</a></span> | <span class="t">the first item might come out a bit slower once those processes are fired up it's going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3009" target="_blank">00:50:09.600</a></span> | <span class="t">faster to run so this is yeah this is a really simplified multi-processing data loader because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3016" target="_blank">00:50:16.080</a></span> | <span class="t">this needs to be super super efficient PyTorch has lots more code than this to make it much more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3023" target="_blank">00:50:23.440</a></span> | <span class="t">efficient but the idea is this and this is actually a perfectly good way of experimenting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3030" target="_blank">00:50:30.960</a></span> | <span class="t">or building your own data loader to make things work exactly how you want so now that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3037" target="_blank">00:50:37.120</a></span> | <span class="t">re-implemented all this from PyTorch let's just grab the PyTorch and as you can see they're exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3042" target="_blank">00:50:42.560</a></span> | <span class="t">the same data loader they don't have one thing called sampler that you pass shuffle to they have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3047" target="_blank">00:50:47.840</a></span> | <span class="t">two separate classes called sequential sample and random sampler I don't know why they do it that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3051" target="_blank">00:50:51.680</a></span> | <span class="t">way it's a little bit more work to me but same idea and I got batch sampler and so it's exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3057" target="_blank">00:50:57.760</a></span> | <span class="t">the same idea the training sampler is a batch sampler with a random sampler the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3064" target="_blank">00:51:04.160</a></span> | <span class="t">sampler is a batch sampler with a sequential sampler passing batch sizes and so we can now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3070" target="_blank">00:51:10.640</a></span> | <span class="t">pass those samplers to the data loader this is now the PyTorch data loader and just like ours it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3077" target="_blank">00:51:17.920</a></span> | <span class="t">also takes a collate function okay and it works cool so that's as you can see it's it's doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3094" target="_blank">00:51:34.000</a></span> | <span class="t">exactly the same stuff that ours is doing with exactly the same API and it's got some shortcuts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3100" target="_blank">00:51:40.000</a></span> | <span class="t">as I'm sure you've noticed when you've used data loaders so for example calling batch sampler is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3108" target="_blank">00:51:48.400</a></span> | <span class="t">very going to be very very common so you can actually just pass the batch size directly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3113" target="_blank">00:51:53.360</a></span> | <span class="t">to a data loader and it will then auto create the batch samplers for you so you don't have to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3118" target="_blank">00:51:58.960</a></span> | <span class="t">in batch sampler at all instead you can just say sampler and it will automatically wrap that in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3125" target="_blank">00:52:05.200</a></span> | <span class="t">a batch sampler for you that does exactly the same thing and in fact because it's so common to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3131" target="_blank">00:52:11.520</a></span> | <span class="t">a random sampler or a sequential sampler for a data set you don't have to do that manually you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3136" target="_blank">00:52:16.400</a></span> | <span class="t">can just pass in shuffle equals true or shuffle equals false to the data loader and that does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3140" target="_blank">00:52:20.960</a></span> | <span class="t">again exactly the same thing there it is now something that is very interesting is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3153" target="_blank">00:52:33.200</a></span> | <span class="t">when you think about it the batch sampler and the collation function are things which are taking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3160" target="_blank">00:52:40.320</a></span> | <span class="t">the result of the sampler looping through them and then collating them together but what we could do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3168" target="_blank">00:52:48.080</a></span> | <span class="t">is actually because our data sets know how to grab multiple indices at once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3179" target="_blank">00:52:59.440</a></span> | <span class="t">we can actually just use the batch sampler as a sampler we don't actually have to loop through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3192" target="_blank">00:53:12.080</a></span> | <span class="t">them and collate them because they're basically instantly they come pre-collated so this is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3200" target="_blank">00:53:20.320</a></span> | <span class="t">trick which actually hugging face stuff can use as well and we'll be seeing it again so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3205" target="_blank">00:53:25.040</a></span> | <span class="t">an important thing to understand is how come we can pass a batch sampler to sampler and what's it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3210" target="_blank">00:53:30.320</a></span> | <span class="t">doing and so rather than trying to look through the pytorch code i suggest going back to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3215" target="_blank">00:53:35.520</a></span> | <span class="t">non-multiprocessing pure python code to see exactly how that would work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3221" target="_blank">00:53:41.360</a></span> | <span class="t">because it's a really nifty trick for things that you can grab multiple things from at once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3230" target="_blank">00:53:50.160</a></span> | <span class="t">and it can save a whole lot of time it can make your code a lot faster</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3233" target="_blank">00:53:53.600</a></span> | <span class="t">okay so now that we've got all that nicely implemented we should now add a validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3240" target="_blank">00:54:00.480</a></span> | <span class="t">set and there's not really too much to talk about here we'll just take our fit function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3245" target="_blank">00:54:05.040</a></span> | <span class="t">and this is exactly the same code that we had before and then we're just going to add something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3253" target="_blank">00:54:13.200</a></span> | <span class="t">which goes through the validation set and gets the predictions and sums up the losses and accuracies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3262" target="_blank">00:54:22.480</a></span> | <span class="t">and from time to time prints out the loss and accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3271" target="_blank">00:54:31.760</a></span> | <span class="t">and so get-dls we will implement by using the pytorch data loader now and so now our whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3281" target="_blank">00:54:41.440</a></span> | <span class="t">process will be get-dls passing in the training and validation data set notice that for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3288" target="_blank">00:54:48.320</a></span> | <span class="t">validation data loader i'm doubling the batch size because it doesn't have to do back propagation so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3294" target="_blank">00:54:54.160</a></span> | <span class="t">it should use about half as much memory so i can use a bigger batch size get our model and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3300" target="_blank">00:55:00.400</a></span> | <span class="t">call this fit and now it's printing out the loss and accuracy on the validation set so finally we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3310" target="_blank">00:55:10.800</a></span> | <span class="t">actually know how we're doing which is that we're getting 97 accuracy on the validation set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3318" target="_blank">00:55:18.000</a></span> | <span class="t">and that's on the whole thing not just on the last batch so that's cool we've now implemented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3323" target="_blank">00:55:23.440</a></span> | <span class="t">a proper working sensible training loop it's still you know a bit more code than i would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3333" target="_blank">00:55:33.120</a></span> | <span class="t">like but it's not bad and every line of code in there and every line of code it's calling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3338" target="_blank">00:55:38.240</a></span> | <span class="t">is all stuff that we have built ourselves reimplemented ourselves so we know exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3345" target="_blank">00:55:45.680</a></span> | <span class="t">what's going on and that means it's going to be much easier for us to create anything we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3350" target="_blank">00:55:50.480</a></span> | <span class="t">can think of we don't have to rely on other people's code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3353" target="_blank">00:55:53.520</a></span> | <span class="t">so hopefully you're as excited about that as i am because it really opens up a whole world for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3366" target="_blank">00:56:06.480</a></span> | <span class="t">so one thing that we're going to want to be able to do now that we've got a training loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3375" target="_blank">00:56:15.280</a></span> | <span class="t">is to grab data and there's a really fantastic library of data sets available on hugging face</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3386" target="_blank">00:56:26.560</a></span> | <span class="t">nowadays and so let's look at how we use those data sets now that we know how to bring things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3394" target="_blank">00:56:34.080</a></span> | <span class="t">into data loaders and stuff so that now we can use the entire world of hugging face data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3401" target="_blank">00:56:41.680</a></span> | <span class="t">with our code so we're going to so you need to pip install data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3410" target="_blank">00:56:50.080</a></span> | <span class="t">and once you've piped and stored data sets you'll be able to say from data sets import</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3416" target="_blank">00:56:56.560</a></span> | <span class="t">and you can import a few things i just these two things now load data set load data set builder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3421" target="_blank">00:57:01.600</a></span> | <span class="t">and we're going to look at a a data set called fashion mnist and so the way things tend to work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3430" target="_blank">00:57:10.160</a></span> | <span class="t">with hugging face is there's something called the hugging face hub which has models and it has data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3434" target="_blank">00:57:14.720</a></span> | <span class="t">sets amongst other things and generally you'll give them a name and you can then say in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3443" target="_blank">00:57:23.200</a></span> | <span class="t">load a data set builder for fashion mnist now a data set builder is just basically something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3450" target="_blank">00:57:30.720</a></span> | <span class="t">which has some metadata about about this data set so the data set builder has a dot info</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3459" target="_blank">00:57:39.920</a></span> | <span class="t">and the dot info has a dot description and here's a description of this and as you can see again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3465" target="_blank">00:57:45.920</a></span> | <span class="t">we've got 28 by 28 grayscale so it's going to be very familiar to us because it's just like mnist</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3471" target="_blank">00:57:51.600</a></span> | <span class="t">and again we've got 10 categories and again we've got 60 000 training examples and again we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3477" target="_blank">00:57:57.040</a></span> | <span class="t">10 000 test examples so this is this is cool so as it says it's direct drop and replacement for mnist</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3483" target="_blank">00:58:03.040</a></span> | <span class="t">and so the data set builder also will tell us what are what's in this data set and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3496" target="_blank">00:58:16.240</a></span> | <span class="t">hugging face stuff generally uses dictionaries rather than tuples so there's going to be an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3501" target="_blank">00:58:21.920</a></span> | <span class="t">of type image there's going to be a label of type class label there's 10 classes and these are the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3508" target="_blank">00:58:28.400</a></span> | <span class="t">names of the classes so it's quite nice that in hugging face data sets you know we can kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3513" target="_blank">00:58:33.840</a></span> | <span class="t">get this information directly it also tells us if there are some recommended training test splits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3520" target="_blank">00:58:40.880</a></span> | <span class="t">we can find out those as well so this is the size of the training split and the number of examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3530" target="_blank">00:58:50.880</a></span> | <span class="t">so now that we're ready to start playing it with it we can load the data set okay so this is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3536" target="_blank">00:58:56.560</a></span> | <span class="t">different string load data set builder versus load data set so this will actually download it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3540" target="_blank">00:59:00.800</a></span> | <span class="t">cache it and here it is and it creates a data set dictionary so a data set dictionary if you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3550" target="_blank">00:59:10.080</a></span> | <span class="t">used fastai is basically just like what we call the data sets class they call the data set dict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3555" target="_blank">00:59:15.280</a></span> | <span class="t">class so it's a dictionary that contains in this case a train and a test item and those are data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3562" target="_blank">00:59:22.560</a></span> | <span class="t">sets these data sets are very much like the data sets that we created in the previous notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3568" target="_blank">00:59:28.080</a></span> | <span class="t">so we can now grab the training and test items from that dictionary and just pop them into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3578" target="_blank">00:59:38.320</a></span> | <span class="t">variables and so we can now have a look at the zero index thing in training and just like we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3585" target="_blank">00:59:45.280</a></span> | <span class="t">were promised it contains an image and a label so as you can see we're not getting tuples anymore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3591" target="_blank">00:59:51.680</a></span> | <span class="t">we're getting dictionaries containing the x and the y in this case image and label so i'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3597" target="_blank">00:59:57.440</a></span> | <span class="t">to get i'm pretty bored writing image and label and strings all the time so i'm just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3602" target="_blank">01:00:02.320</a></span> | <span class="t">store them as x and y so x is going to be the string image and y will be the string label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3607" target="_blank">01:00:07.200</a></span> | <span class="t">um i guess the other way i could have done that would have been to say x comma y equals that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3622" target="_blank">01:00:22.400</a></span> | <span class="t">that would probably be a bit neater um because it's coming straight from the features and if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3629" target="_blank">01:00:29.840</a></span> | <span class="t">if you iterate into a dictionary you get back it's it's keys that's why that works so anyway i've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3636" target="_blank">01:00:36.320</a></span> | <span class="t">done it manually here which is a bit sad but there you go okay so we can now grab the from train zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3644" target="_blank">01:00:44.320</a></span> | <span class="t">which we've already seen we can grab the x i.e the image and there it is there's the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3659" target="_blank">01:00:59.520</a></span> | <span class="t">we could grab the first five images and the first five labels for example and there they are now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3667" target="_blank">01:01:07.920</a></span> | <span class="t">we already know what the names of the classes are so we could now see what these map to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3676" target="_blank">01:01:16.000</a></span> | <span class="t">by grabbing those features so there they are so um this is a special hugging face class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3687" target="_blank">01:01:27.440</a></span> | <span class="t">which most libraries have something including fastai that works like this there's something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3692" target="_blank">01:01:32.480</a></span> | <span class="t">called int to string which is going to take these and convert them to these so if i call it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3699" target="_blank">01:01:39.600</a></span> | <span class="t">on our y batch you'll see we've got first is ankle boot and there that is indeed an ankle boot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3706" target="_blank">01:01:46.400</a></span> | <span class="t">then we'll have a couple of t-shirts and address</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3714" target="_blank">01:01:54.160</a></span> | <span class="t">okay so um how do we use this to train a model well we're going to need a data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3721" target="_blank">01:02:01.760</a></span> | <span class="t">and we want a data loader that for now we're going to do just like we've done it before it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3727" target="_blank">01:02:07.440</a></span> | <span class="t">return um uh well actually we're going to do something a bit different we're going to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3735" target="_blank">01:02:15.200</a></span> | <span class="t">our collate function is actually going to return a dictionary actually this is pretty common for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3741" target="_blank">01:02:21.040</a></span> | <span class="t">um hugging face stuff um and pytorch doesn't mind if you it's happy for you to return a dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3748" target="_blank">01:02:28.160</a></span> | <span class="t">from a collation function so rather than returning a tuple of the stacked up hopefully this looks very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3754" target="_blank">01:02:34.960</a></span> | <span class="t">familiar this looks a lot like the thing that goes through the data set for each one and stacks them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3760" target="_blank">01:02:40.720</a></span> | <span class="t">up just like we did um in the previous notebook so that's what we're doing we're doing all in one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3765" target="_blank">01:02:45.680</a></span> | <span class="t">step here in our collate function and then again exactly the same thing go through our batch grab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3772" target="_blank">01:02:52.480</a></span> | <span class="t">the y and this is just stacking them up with the integers so we don't have to call stack</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3777" target="_blank">01:02:57.440</a></span> | <span class="t">and so we're now going to have the image and label bits in our dictionary so if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3785" target="_blank">01:03:05.280</a></span> | <span class="t">create our data loader using that collation function grab one batch so we can go batch x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3794" target="_blank">01:03:14.000</a></span> | <span class="t">dot shape is a 16 by 1 by 28 by 28 and our y if the batch here here it is so the thing to notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3802" target="_blank">01:03:22.960</a></span> | <span class="t">here is that we haven't done any transforms or anything or written our own data set class or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3812" target="_blank">01:03:32.880</a></span> | <span class="t">anything we're actually putting all the work directly in the collation function so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3817" target="_blank">01:03:37.360</a></span> | <span class="t">like a really nice way to skip all of the kind of abstractions of your framework if you want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3825" target="_blank">01:03:45.680</a></span> | <span class="t">is you can just do all of your work and collate functions so it's going to pass you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3829" target="_blank">01:03:49.760</a></span> | <span class="t">each item so it's going to you're going to get the batch directly you just go through each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3836" target="_blank">01:03:56.640</a></span> | <span class="t">item and so here we're saying okay grab the x key from that dictionary convert it to a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3848" target="_blank">01:04:08.400</a></span> | <span class="t">and then do that for everything in the batch and then stack them all together so this is yeah this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3854" target="_blank">01:04:14.160</a></span> | <span class="t">is like can be quite a nice way to do things if you want to do things just very manually without</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3862" target="_blank">01:04:22.080</a></span> | <span class="t">having to think too much about you know a framework particularly if you're doing really custom stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3866" target="_blank">01:04:26.000</a></span> | <span class="t">this can be quite helpful having said that um hugging face data sets absolutely lets you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3872" target="_blank">01:04:32.080</a></span> | <span class="t">avoid doing everything in collate function which if we want to create really simple applications</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3877" target="_blank">01:04:37.760</a></span> | <span class="t">that's where we're going to eventually want to head so we can um do this using a transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3887" target="_blank">01:04:47.280</a></span> | <span class="t">instead and so the way we do that is we create a function you're going to take our batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3895" target="_blank">01:04:55.040</a></span> | <span class="t">it's going to replace the x in our batch with the tensor version of each of those pao images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3901" target="_blank">01:05:01.760</a></span> | <span class="t">and i'm not even stacking them or anything and then we're going to return that batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3906" target="_blank">01:05:06.400</a></span> | <span class="t">and so uh hugging face data sets has something called with transform and that's going to take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3912" target="_blank">01:05:12.240</a></span> | <span class="t">your data set your hugging face data set and it's going to apply this function to every element</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3920" target="_blank">01:05:20.080</a></span> | <span class="t">and it doesn't run at all now it's going to basically when when it behind the scenes when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3926" target="_blank">01:05:26.000</a></span> | <span class="t">it calls done to get item it will call this function on the fly so in other words this could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3932" target="_blank">01:05:32.320</a></span> | <span class="t">have data augmentation which can be random or whatever because it's going to be rerun every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3937" target="_blank">01:05:37.040</a></span> | <span class="t">time you grab an item it's not cached or anything like that so other than that this data set has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3943" target="_blank">01:05:43.600</a></span> | <span class="t">exactly the api same api as any other data set it has a length it has a done to get item so you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3948" target="_blank">01:05:48.800</a></span> | <span class="t">pass it to a data loader and so um um pytorch already knows how to collate dictionaries of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3960" target="_blank">01:06:00.960</a></span> | <span class="t">tenses so we've got a dictionary of tenses now so that means we don't need a collate function anymore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3966" target="_blank">01:06:06.800</a></span> | <span class="t">i can create a data loader from this without a collate function as you can see and so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3974" target="_blank">01:06:14.160</a></span> | <span class="t">giving exactly the same thing as before but without having to create a custom collate function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3979" target="_blank">01:06:19.120</a></span> | <span class="t">now even this is a bit more code than i want having to return this seems a bit silly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3984" target="_blank">01:06:24.240</a></span> | <span class="t">but the reason i had to do this is because hugging face data sets expects the with transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=3991" target="_blank">01:06:31.120</a></span> | <span class="t">function to return the the new version of the of the data so i wanted to be able to write it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4000" target="_blank">01:06:40.080</a></span> | <span class="t">like this transform in place and just say the change i want to make and have it automatically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4005" target="_blank">01:06:45.920</a></span> | <span class="t">return that so if i call if i create this function that's exactly the same as the previous one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4012" target="_blank">01:06:52.240</a></span> | <span class="t">that doesn't have return how would i turn this into something which does return the result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4018" target="_blank">01:06:58.720</a></span> | <span class="t">so here's an interesting trick we could take that function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4025" target="_blank">01:07:05.840</a></span> | <span class="t">pass it to another function to create a new function which is the version of this in place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4032" target="_blank">01:07:12.960</a></span> | <span class="t">function that returns the result and the way i do that is by creating a function called inplace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4037" target="_blank">01:07:17.600</a></span> | <span class="t">it takes a function it returns a function the function it returns is one that calls</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4046" target="_blank">01:07:26.320</a></span> | <span class="t">my original function and then returns the result so this is the function this is a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4053" target="_blank">01:07:33.760</a></span> | <span class="t">generating function and it's modifying an in place function to become a function that returns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4063" target="_blank">01:07:43.840</a></span> | <span class="t">the new version of that data and so this is a function this function is passed to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4072" target="_blank">01:07:52.000</a></span> | <span class="t">function which returns a function and here it is so here's the version that hugging face will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4076" target="_blank">01:07:56.880</a></span> | <span class="t">able to use so i can now pass that to with transform and it does exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4083" target="_blank">01:08:03.200</a></span> | <span class="t">so this is very very common in python it's so common that this line of code can be entirely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4092" target="_blank">01:08:12.320</a></span> | <span class="t">removed and replaced with this little token if you have a function and put at at the start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4102" target="_blank">01:08:22.960</a></span> | <span class="t">you can then put that before a function and what it says is take this whole function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4106" target="_blank">01:08:26.880</a></span> | <span class="t">pass it to this function and replace it with the result so this is exactly the same as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4116" target="_blank">01:08:36.960</a></span> | <span class="t">combination of this and this and when we do it this way this kind of little syntax sugar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4123" target="_blank">01:08:43.680</a></span> | <span class="t">is called a decorator okay so there's nothing nothing magic about decorators it's literally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4130" target="_blank">01:08:50.080</a></span> | <span class="t">identical to this oh i guess the only difference is we don't end up with this unnecessary intermediate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4136" target="_blank">01:08:56.880</a></span> | <span class="t">underscore version but the result is exactly the same and therefore i can create a transformed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4144" target="_blank">01:09:04.240</a></span> | <span class="t">data set by using this and there we go it's all working fine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4155" target="_blank">01:09:15.760</a></span> | <span class="t">um yeah so i mean none of this is particularly um necessary but what we're doing is we're just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4166" target="_blank">01:09:26.240</a></span> | <span class="t">kind of like seeing you know the pieces that we can we can put in place um to make this stuff as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4175" target="_blank">01:09:35.840</a></span> | <span class="t">easy as possible and we don't have to think about things too much um all right now with all this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4185" target="_blank">01:09:45.200</a></span> | <span class="t">we can basically make things pretty automatic um and the way we can make things pretty automatic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4191" target="_blank">01:09:51.600</a></span> | <span class="t">is we're going to use a cool thing in python called item getter and item getter is a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4197" target="_blank">01:09:57.040</a></span> | <span class="t">that returns a function so hopefully you're getting used to this idea now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4201" target="_blank">01:10:01.200</a></span> | <span class="t">this creates a function that gets the a and c</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4208" target="_blank">01:10:08.960</a></span> | <span class="t">items from a dictionary or something that looks like a dictionary so here's a dictionary it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4217" target="_blank">01:10:17.040</a></span> | <span class="t">contains keys a b and c so this function will take a dictionary and return the a and c values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4227" target="_blank">01:10:27.520</a></span> | <span class="t">and as you can see it has done exactly that um explain why this is useful in a moment um i just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4236" target="_blank">01:10:36.080</a></span> | <span class="t">wanted to briefly mention what did i mean when i said something that looks like a dictionary i</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4240" target="_blank">01:10:40.720</a></span> | <span class="t">mean this is a dictionary okay that looks like a dictionary but python doesn't care about what type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4247" target="_blank">01:10:47.760</a></span> | <span class="t">things actually are it only cares about what they look like and remember that when we call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4254" target="_blank">01:10:54.160</a></span> | <span class="t">something with square brackets when we index into something behind the scenes it's just called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4258" target="_blank">01:10:58.240</a></span> | <span class="t">calling dunder get item so we could create our own class and it's dunder get item gets the key</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4265" target="_blank">01:11:05.920</a></span> | <span class="t">and it's just going to manually return one if k equals a or two if k equals b or three otherwise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4271" target="_blank">01:11:11.200</a></span> | <span class="t">and look that class also works just fine with an item getter um the reason this is interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4279" target="_blank">01:11:19.520</a></span> | <span class="t">is because like a lot of people write python as if it's like c plus plus or java or something they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4287" target="_blank">01:11:27.200</a></span> | <span class="t">write as if as if it's this kind of statically type thing um but i really wanted to point out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4292" target="_blank">01:11:32.320</a></span> | <span class="t">that it's an extremely dynamic language and there's a lot more flexibility than you might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4297" target="_blank">01:11:37.120</a></span> | <span class="t">have realized anyway that's a littler side um so what we can do is um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4306" target="_blank">01:11:46.720</a></span> | <span class="t">think about a batch for example where we've got these two dictionaries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4313" target="_blank">01:11:53.200</a></span> | <span class="t">okay so um pytorch comes with a default collation function called not surprisingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4321" target="_blank">01:12:01.760</a></span> | <span class="t">default collate so that's part of um pytorch and what default collate does with dictionaries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4328" target="_blank">01:12:08.560</a></span> | <span class="t">is it simply takes the matching keys and then grabs their values and stacks them together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4334" target="_blank">01:12:14.960</a></span> | <span class="t">and so that's why if i call default collate a is now one three b is now two four that's actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4342" target="_blank">01:12:22.000</a></span> | <span class="t">what happened before when we created this data loader is it used the default collation function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4349" target="_blank">01:12:29.200</a></span> | <span class="t">which does that it also works on things that are tuples not dictionaries which is what most of you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4354" target="_blank">01:12:34.560</a></span> | <span class="t">would have used before and what we can do therefore is we could create something called collate dict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4360" target="_blank">01:12:40.240</a></span> | <span class="t">which is something which is going to take a um data set um and it's going to create a item getter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4372" target="_blank">01:12:52.880</a></span> | <span class="t">function for the features in that data set which in this case is image and label so this is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4378" target="_blank">01:12:58.720</a></span> | <span class="t">function which will get the image and label items and so we're now going to return a function and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4386" target="_blank">01:13:06.000</a></span> | <span class="t">that function is simply going to call our item getter on default collate and what this is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4392" target="_blank">01:13:12.400</a></span> | <span class="t">to do is it's going to take a dictionary and collate it into a tuple um just like we did up here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4400" target="_blank">01:13:20.560</a></span> | <span class="t">so if we run that so we're now going to call data loader on our transform data set passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4408" target="_blank">01:13:28.400</a></span> | <span class="t">in and remember this is a function that returns a function so it's a collation function for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4414" target="_blank">01:13:34.800</a></span> | <span class="t">data set and there it is so now this looks a lot like what we had in our previous notebook this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4421" target="_blank">01:13:41.040</a></span> | <span class="t">is not returning a dictionary but it's returning a tuple so this is um a really important idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4430" target="_blank">01:13:50.160</a></span> | <span class="t">for particularly for working with hugging face data sets is that they tend to do things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4435" target="_blank">01:13:55.040</a></span> | <span class="t">with dictionaries and most other things in the pytorch world tend to work with tuples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4441" target="_blank">01:14:01.600</a></span> | <span class="t">so you can just use this now to convert anything that takes that returns dictionaries into something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4449" target="_blank">01:14:09.440</a></span> | <span class="t">that provides tuples by passing it as a collation function to your data loader so remember you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4456" target="_blank">01:14:16.160</a></span> | <span class="t">the thing you want to be doing this this week is is doing things like import pdb pdb dot set trace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4463" target="_blank">01:14:23.200</a></span> | <span class="t">right put break points step through see exactly what's happening you know um not just here but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4470" target="_blank">01:14:30.720</a></span> | <span class="t">also even more importantly doing it inside inside the inner most inner function um so then you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4481" target="_blank">01:14:41.440</a></span> | <span class="t">see um what did i do wrong there oh today let's set underscore trace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4489" target="_blank">01:14:49.760</a></span> | <span class="t">um so then we can see exactly what's going on print out b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4499" target="_blank">01:14:59.040</a></span> | <span class="t">list the code and i could step into it and look i'm now inside the default collate function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4511" target="_blank">01:15:11.520</a></span> | <span class="t">which is inside pytorch and so i can now see exactly how that works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4516" target="_blank">01:15:16.000</a></span> | <span class="t">there it all is so it's going to go through and this code is going to look very familiar because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4523" target="_blank">01:15:23.440</a></span> | <span class="t">we've implemented all this ourselves except it's being careful that like it works for lots of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4528" target="_blank">01:15:28.400</a></span> | <span class="t">different types of things dictionaries numpy arrays so on and so forth um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4538" target="_blank">01:15:38.160</a></span> | <span class="t">so the first thing i wanted to do oh actually something i do want to mention here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4542" target="_blank">01:15:42.080</a></span> | <span class="t">this is so useful we want to be able to use it in all of our notebooks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4546" target="_blank">01:15:46.000</a></span> | <span class="t">so rather than copying and pasting this every time it would be really nice to create a python module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4553" target="_blank">01:15:53.760</a></span> | <span class="t">that contains this definition so we've created um a library called nbdev um it's really a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4562" target="_blank">01:16:02.400</a></span> | <span class="t">system called nbdev which does exactly that it creates um modules you can use from your notebooks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4568" target="_blank">01:16:08.480</a></span> | <span class="t">and the way you do it is you use this special uh thing we call comment directives which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4575" target="_blank">01:16:15.600</a></span> | <span class="t">hash pipe and then hash pipe export so you put this at the top of a cell and it says do something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4582" target="_blank">01:16:22.400</a></span> | <span class="t">special for this cell what this does is it says put this into a python module for me please</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4586" target="_blank">01:16:26.480</a></span> | <span class="t">export it to a python module what python module is it going to put it in well if you go all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4593" target="_blank">01:16:33.120</a></span> | <span class="t">way to the top you tell it what default export module to create so it's going to create a module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4600" target="_blank">01:16:40.000</a></span> | <span class="t">called datasets so what i do at the very end of this module is i've got this line that says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4609" target="_blank">01:16:49.440</a></span> | <span class="t">import nbdev nbdev.nbdev export and what that's going to do for me is create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4622" target="_blank">01:17:02.960</a></span> | <span class="t">a library a python library it's going to have a datasets.py in it and we'll see everything that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4631" target="_blank">01:17:11.680</a></span> | <span class="t">we exported here it is collect dict will appear in this for me and so what that means is now in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4638" target="_blank">01:17:18.720</a></span> | <span class="t">future in my notebooks i will be able to import collect dict from the from my datasets now you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4646" target="_blank">01:17:26.400</a></span> | <span class="t">might wonder well how does it know to call it mini AI what's mini AI well in nbdev you create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4652" target="_blank">01:17:32.880</a></span> | <span class="t">settings.ini file where you say what the name of your library is so we're going to be using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4659" target="_blank">01:17:39.840</a></span> | <span class="t">quite a lot now because we're getting to the point where we're starting to implement stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4666" target="_blank">01:17:46.880</a></span> | <span class="t">that didn't exist before so previously most of the stuff or pretty much all the stuff we've created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4672" target="_blank">01:17:52.880</a></span> | <span class="t">i've said like oh that already exists in pytorch so we don't need it we just use pytorches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4679" target="_blank">01:17:59.040</a></span> | <span class="t">but we're now getting to a point where we're starting to create stuff that doesn't exist</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4683" target="_blank">01:18:03.760</a></span> | <span class="t">anywhere we've created it ourselves and so therefore we want to be able to use it again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4690" target="_blank">01:18:10.320</a></span> | <span class="t">so during the rest of this course we're going to be building together a library called mini AI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4697" target="_blank">01:18:17.600</a></span> | <span class="t">that's going to be our framework our version of something like fastai maybe it's something like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4703" target="_blank">01:18:23.840</a></span> | <span class="t">what fastai3 will end up being we'll see so that's what's going on here to so we're going to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4715" target="_blank">01:18:35.200</a></span> | <span class="t">once i start using mini AI i'll show you exactly how to install this but that's what this export</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4719" target="_blank">01:18:39.840</a></span> | <span class="t">is and so you might have noticed i also had an export on this in place thing and i also had it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4728" target="_blank">01:18:48.160</a></span> | <span class="t">on my necessary import statements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4731" target="_blank">01:18:51.120</a></span> | <span class="t">okay um we want to be able to see what this data set looks like so i thought it now's a good time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4740" target="_blank">01:19:00.400</a></span> | <span class="t">to talk a bit about plotting because knowing how to visualize things well is really important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4746" target="_blank">01:19:06.240</a></span> | <span class="t">and again the idea is we we're not allowed to use fastai's plotting library so we've got to learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4752" target="_blank">01:19:12.960</a></span> | <span class="t">how to do everything ourselves so here's the basic way to plot some an image using matplotlib</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4760" target="_blank">01:19:20.960</a></span> | <span class="t">so we can create a batch grab the x part of it um grab the very first thing in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4770" target="_blank">01:19:30.320</a></span> | <span class="t">and i am show means show an image and here it is there is our anchor boot um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4778" target="_blank">01:19:38.560</a></span> | <span class="t">so let's start to think about what stuff we might create which we can export to make this a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4785" target="_blank">01:19:45.360</a></span> | <span class="t">easier so let's create something called show image which basically does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4794" target="_blank">01:19:54.880</a></span> | <span class="t">iamshow but we're going to do a few extra things we will make sure that it's in the correct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4804" target="_blank">01:20:04.800</a></span> | <span class="t">access order we will make sure it's not on cuda that's on the cpu</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4810" target="_blank">01:20:10.400</a></span> | <span class="t">if it's not a numpy array we'll convert it to a numpy array</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4815" target="_blank">01:20:15.120</a></span> | <span class="t">we'll be able to pass in an existing access which we'll talk about soon if we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4824" target="_blank">01:20:24.240</a></span> | <span class="t">we'll be able to set a title if we want to and also this thing here removes all this ugly 0 5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4831" target="_blank">01:20:31.200</a></span> | <span class="t">blah blah blah axis because we're showing an image we don't want any of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4834" target="_blank">01:20:34.320</a></span> | <span class="t">so if we try that you can see there we go we've also been able to say what size we want the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4843" target="_blank">01:20:43.200</a></span> | <span class="t">there it all is now here's something interesting when i say help</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4850" target="_blank">01:20:50.640</a></span> | <span class="t">the help shows the things that i implemented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4854" target="_blank">01:20:54.720</a></span> | <span class="t">but it also shows a whole lot more things how did that magic thing happen and you can see they work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4862" target="_blank">01:21:02.960</a></span> | <span class="t">because here's fixed size which i didn't add oh sorry i did add well okay that's a bad example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4869" target="_blank">01:21:09.200</a></span> | <span class="t">anyway these other ones all work as well um so how did that happen well the trick is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4876" target="_blank">01:21:16.080</a></span> | <span class="t">that i added star star quags here and star star quags says grab um you can you know pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4883" target="_blank">01:21:23.760</a></span> | <span class="t">as many or any other arguments as you like that aren't listed and they'll all be put into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4889" target="_blank">01:21:29.200</a></span> | <span class="t">dictionary with this name and then when i call i am show i pass that entire dictionary star star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4898" target="_blank">01:21:38.640</a></span> | <span class="t">here means as separate arguments and that's how come it works and then how come does it know how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4904" target="_blank">01:21:44.800</a></span> | <span class="t">come it knows what help to provide the reason why is that fast core has a special thing called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4911" target="_blank">01:21:51.200</a></span> | <span class="t">delegates which is a decorator so now you know what a decorator is and you tell it what is it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4919" target="_blank">01:21:59.120</a></span> | <span class="t">that you're going to be passing quags to i'm going to be passing it to i am show and then it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4924" target="_blank">01:22:04.960</a></span> | <span class="t">automatically creates the documentation correctly to show you what quags can do so this is a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4934" target="_blank">01:22:14.160</a></span> | <span class="t">helpful way of being able to kind of extend existing functions like i am show and still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4941" target="_blank">01:22:21.600</a></span> | <span class="t">get all of their functionality and all of their documentation and add your own so delegates is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4945" target="_blank">01:22:25.920</a></span> | <span class="t">one of the most useful things we have in fast core in my opinion so we're going to export that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4951" target="_blank">01:22:31.600</a></span> | <span class="t">so now we can use show image anytime you want which is nice um something that's really helpful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4958" target="_blank">01:22:38.400</a></span> | <span class="t">to know about matplotlib is how to create subplots so for example what happens if you want to plot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4966" target="_blank">01:22:46.240</a></span> | <span class="t">two images next to each other so in matplotlib subplots creates multiple plots and you pass it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4974" target="_blank">01:22:54.720</a></span> | <span class="t">number of rows and the number of columns so this here has as you see one row and two columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4983" target="_blank">01:23:03.920</a></span> | <span class="t">and it returns axes now what it calls axes is what it refers to as the individual plots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=4991" target="_blank">01:23:11.120</a></span> | <span class="t">so if we now call show image on the first image passing in axes zero it's going to get that here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5000" target="_blank">01:23:20.640</a></span> | <span class="t">right then we call ax.am show that means put the image on this subplot they don't call it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5009" target="_blank">01:23:29.040</a></span> | <span class="t">a subplot unfortunately they call it an axis put it on this axis so that's how come we're able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5014" target="_blank">01:23:34.320</a></span> | <span class="t">show an image one image on the first axis and then show a second image on the second axis by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5020" target="_blank">01:23:40.800</a></span> | <span class="t">which we mean subplot and there's our two images so that's pretty handy um so i've decided to add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5030" target="_blank">01:23:50.320</a></span> | <span class="t">some additional functionality to subplots so therefore i use delegates on subplots because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5035" target="_blank">01:23:55.040</a></span> | <span class="t">i'm adding functionality to it and i'm going to be taking quags and passing it through to subplots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5042" target="_blank">01:24:02.320</a></span> | <span class="t">and the main thing i wanted to do is to automatically create an appropriate figure size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5047" target="_blank">01:24:07.360</a></span> | <span class="t">by just finding out you tell us what image size you want and i also want to be able to add a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5054" target="_blank">01:24:14.320</a></span> | <span class="t">title for the whole set of subplots and so there it is and then i also want to show you that in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5065" target="_blank">01:24:25.280</a></span> | <span class="t">it'll automatically if we want to create documentation for us as well for our library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5069" target="_blank">01:24:29.680</a></span> | <span class="t">and here is the documentation so as you can see here for the stuff i've added it's telling me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5078" target="_blank">01:24:38.160</a></span> | <span class="t">exactly what each of these parameters are their type their defaults and information about each one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5085" target="_blank">01:24:45.600</a></span> | <span class="t">and that information is automatically coming from these little comments is we call these documents</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5092" target="_blank">01:24:52.240</a></span> | <span class="t">this is all automatic stuff done by fast core and nbdev and so you might have noticed when you look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5099" target="_blank">01:24:59.600</a></span> | <span class="t">at fastai library documentation it always has all this info that's that's that's why you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5105" target="_blank">01:25:05.520</a></span> | <span class="t">actually have to call showdoc it's automatically added to your documentation for you i'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5110" target="_blank">01:25:10.400</a></span> | <span class="t">showing you here what it's going to end up looking like and you can see that it's worked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5114" target="_blank">01:25:14.480</a></span> | <span class="t">with delegates it's put all the extra stuff from delegates in here as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5118" target="_blank">01:25:18.320</a></span> | <span class="t">and here they all listed out here as well so anyway subplots so let's create a three by three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5127" target="_blank">01:25:27.200</a></span> | <span class="t">set of plots and we'll grab the first two images and so now we can go through each of the subplots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5135" target="_blank">01:25:35.520</a></span> | <span class="t">now it returns it as a three by three basically a list of three lists of three items so i flatten</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5142" target="_blank">01:25:42.640</a></span> | <span class="t">them all out into a single list so we'll go through each of those subplots and go through each image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5149" target="_blank">01:25:49.520</a></span> | <span class="t">and show each image on each axis and so here's a quick way to quickly show them all as you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5157" target="_blank">01:25:57.440</a></span> | <span class="t">it's a little bit ugly here so we'll keep on adding more useful plotting functionality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5164" target="_blank">01:26:04.480</a></span> | <span class="t">so here's something that again it calls our subplots delegates to it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5168" target="_blank">01:26:08.960</a></span> | <span class="t">but we're going to be able to say for example how many subplots do we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5175" target="_blank">01:26:15.440</a></span> | <span class="t">and it'll automatically calculate the rows and the columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5178" target="_blank">01:26:18.080</a></span> | <span class="t">and it's going to remove the axes for any ones that we're not actually using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5185" target="_blank">01:26:25.360</a></span> | <span class="t">and so here we got that so that's what get grid's going to let us do so we're getting quite close</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5193" target="_blank">01:26:33.360</a></span> | <span class="t">and so finally why don't we just create a single thing called show images that's going to get our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5200" target="_blank">01:26:40.800</a></span> | <span class="t">grid and it's going to go through our images optionally with a list of titles and show each one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5207" target="_blank">01:26:47.920</a></span> | <span class="t">and we can use that here you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5214" target="_blank">01:26:54.720</a></span> | <span class="t">we have successfully got all of our labeled images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5221" target="_blank">01:27:01.520</a></span> | <span class="t">and so we yeah I think all this stuff for the plotting is pretty useful so as you might have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5234" target="_blank">01:27:14.560</a></span> | <span class="t">noticed they were all exported so in our datasets.py we've got our get grid we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5239" target="_blank">01:27:19.840</a></span> | <span class="t">got our subplots we've got our show images so that's going to make life easier for us now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5244" target="_blank">01:27:24.800</a></span> | <span class="t">since we have to create everything from scratch we have created all of those things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5249" target="_blank">01:27:29.760</a></span> | <span class="t">so as I mentioned at the very end we have this one line of code to run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5258" target="_blank">01:27:38.400</a></span> | <span class="t">and so just to show you if I remove</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5263" target="_blank">01:27:43.840</a></span> | <span class="t">miniai.datasets.minibidai/datasets.py so it's all empty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5273" target="_blank">01:27:53.120</a></span> | <span class="t">and then I run this line of code and now it's back as you can see and it tells you it's auto generated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5281" target="_blank">01:28:01.200</a></span> | <span class="t">all right so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5286" target="_blank">01:28:06.160</a></span> | <span class="t">we are nearly at the point where we can build our learner and once we've built our learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5294" target="_blank">01:28:14.880</a></span> | <span class="t">we're going to be able to really dive deep into training and studying models so we've kind of got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5301" target="_blank">01:28:21.120</a></span> | <span class="t">nearly got all of our infrastructure in place before we do there's some pieces of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5309" target="_blank">01:28:29.520</a></span> | <span class="t">python which not everybody knows and I want to kind of talk about and kind of computer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5316" target="_blank">01:28:36.640</a></span> | <span class="t">science concepts I want to talk about so that's what o6 foundations is about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5320" target="_blank">01:28:40.560</a></span> | <span class="t">so this whole section is just going to tell it just going to talk about some stuff in python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5329" target="_blank">01:28:49.120</a></span> | <span class="t">that you may not have come across before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5330" target="_blank">01:28:50.880</a></span> | <span class="t">or you know maybe it's a review for some of you as well and it's all stuff we're going to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5338" target="_blank">01:28:58.640</a></span> | <span class="t">basically in the next notebook so that's why I wanted to to cover it so we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5344" target="_blank">01:29:04.560</a></span> | <span class="t">creating a learner class so a learner class is going to be a very general purpose training loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5351" target="_blank">01:29:11.920</a></span> | <span class="t">which we can get to to do anything that we wanted to do and we're going to be creating things called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5358" target="_blank">01:29:18.000</a></span> | <span class="t">callbacks to make that happen and so therefore we're going to just spend a few moments talking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5363" target="_blank">01:29:23.120</a></span> | <span class="t">about what are callbacks how are they used in in computer science how are they implemented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5369" target="_blank">01:29:29.360</a></span> | <span class="t">look at some examples they come up a lot perhaps the most common place that you see callbacks in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5376" target="_blank">01:29:36.720</a></span> | <span class="t">software is for GUI events so for events from some graphical user interface so the main graphical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5384" target="_blank">01:29:44.800</a></span> | <span class="t">user interface library in jupyter notebooks is called ipy widgets and we can create a widget</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5393" target="_blank">01:29:53.520</a></span> | <span class="t">like a button like so and when we display it it shows me a button and at the moment it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5400" target="_blank">01:30:00.640</a></span> | <span class="t">do anything if I click on it what we can do though is we can add an onclick callback to it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5414" target="_blank">01:30:14.560</a></span> | <span class="t">which is something which is a fun we're going to pass it a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5417" target="_blank">01:30:17.840</a></span> | <span class="t">which is called when you click it so let's define that function so I'm going to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5425" target="_blank">01:30:25.440</a></span> | <span class="t">w.onclickf is going to assign the f function to the onclick callback now if I click this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5433" target="_blank">01:30:33.680</a></span> | <span class="t">there you go it's doing it now what does that mean well a callback is simply a call of all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5443" target="_blank">01:30:43.920</a></span> | <span class="t">that you've provided so remember a callable is a more general version of a function so in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5448" target="_blank">01:30:48.400</a></span> | <span class="t">place it is a function that you've provided that will be called back to when something happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5454" target="_blank">01:30:54.560</a></span> | <span class="t">so in this case there's something that's happening is that they're clicking a button</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5458" target="_blank">01:30:58.080</a></span> | <span class="t">so this is how we are defining and using a callback as a GUI event so basically everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5467" target="_blank">01:31:07.200</a></span> | <span class="t">in ipy widgets if you want to create your own graphical user interfaces for jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5472" target="_blank">01:31:12.880</a></span> | <span class="t">you can do it with ipy widgets and by using these callbacks so these particular kinds of callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5481" target="_blank">01:31:21.280</a></span> | <span class="t">are called events but it's just a callback all right so that's somebody else's callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5488" target="_blank">01:31:28.800</a></span> | <span class="t">let's create our own callback so let's say we've got some very slow calculation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5498" target="_blank">01:31:38.080</a></span> | <span class="t">and so it takes a very long time to add up the numbers 0 to 5 squared because we sleep for a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5504" target="_blank">01:31:44.720</a></span> | <span class="t">second after each one so let's run our slow calculation still running oh how's it going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5510" target="_blank">01:31:50.960</a></span> | <span class="t">come on finish our calculation there we go the answer is 30 now for a slow calculation like that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5516" target="_blank">01:31:56.400</a></span> | <span class="t">such as training a model it's a slow calculation it would be nice to do things like i don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5522" target="_blank">01:32:02.640</a></span> | <span class="t">print you know print out the loss from time to time or show a progress bar or whatever so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5528" target="_blank">01:32:08.480</a></span> | <span class="t">generally for those kinds of things we would like to define a callback that is called at the end of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5535" target="_blank">01:32:15.920</a></span> | <span class="t">each epoch or batch or every few seconds or something like that so here's how we can modify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5543" target="_blank">01:32:23.120</a></span> | <span class="t">our slow calculation routine such that you can optionally pass at a callback and so all of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5549" target="_blank">01:32:29.360</a></span> | <span class="t">code's the same except we've added this one line of code that says if there's a callback then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5555" target="_blank">01:32:35.680</a></span> | <span class="t">call it and pass in what what we're where we're up to so then we could create our callback function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5564" target="_blank">01:32:44.400</a></span> | <span class="t">so this is just like we created a full callback function f let's create a show progress callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5568" target="_blank">01:32:48.960</a></span> | <span class="t">function that's going to tell us how far we've got so now if we call show slow calculation passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5576" target="_blank">01:32:56.880</a></span> | <span class="t">in our callback you can see it's going to call this function at the end of each step so here we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5586" target="_blank">01:33:06.960</a></span> | <span class="t">created our own callback so there's nothing special about a callback like it doesn't require its own</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5594" target="_blank">01:33:14.160</a></span> | <span class="t">like syntax it's not a new concept it's just an idea really which is the idea of passing in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5602" target="_blank">01:33:22.160</a></span> | <span class="t">function which some other function will call at particular times such as at the end of a step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5609" target="_blank">01:33:29.040</a></span> | <span class="t">or such as when you click a button so that's what we mean by callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5613" target="_blank">01:33:33.840</a></span> | <span class="t">we don't have to define the function ahead of time we could define the function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5622" target="_blank">01:33:42.160</a></span> | <span class="t">at the same time that we call the slow calculation by using lambda so as we've discussed before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5630" target="_blank">01:33:50.720</a></span> | <span class="t">lambda just defines a function but it doesn't give it a name so here's a function it takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5635" target="_blank">01:33:55.520</a></span> | <span class="t">one parameter and prints out exactly the same thing as before so here's the same way as doing it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5639" target="_blank">01:33:59.760</a></span> | <span class="t">but using a lambda</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5641" target="_blank">01:34:01.360</a></span> | <span class="t">um we could make it more sophisticated now and rather than always saying also we finished epoch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5651" target="_blank">01:34:11.360</a></span> | <span class="t">whatever we could have let you pass in an exclamation and we print that out and so in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5658" target="_blank">01:34:18.640</a></span> | <span class="t">this case we could now have our lambda call that function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5663" target="_blank">01:34:23.200</a></span> | <span class="t">and so one of the things that we can do now is to again we can create a function that returns a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5673" target="_blank">01:34:33.040</a></span> | <span class="t">function and so we could create a make show progress function where you pass in the exclamation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5679" target="_blank">01:34:39.920</a></span> | <span class="t">we could then create and there's no need to give it a name actually it's just return it directly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5687" target="_blank">01:34:47.680</a></span> | <span class="t">we can return a function that calls that exclamation so here we are passing in nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5700" target="_blank">01:35:00.080</a></span> | <span class="t">and that's exactly the same as doing something like what we've done before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5707" target="_blank">01:35:07.520</a></span> | <span class="t">we could say instead of using a lambda we can create an inner function like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5717" target="_blank">01:35:17.280</a></span> | <span class="t">so here is now a function that returns a function this does exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5720" target="_blank">01:35:20.960</a></span> | <span class="t">okay so one way with a lambda one way out of lambda</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5726" target="_blank">01:35:26.800</a></span> | <span class="t">and one of the reasons I wanted to show you that is so I can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5730" target="_blank">01:35:30.800</a></span> | <span class="t">I've got so many here's is that we can do exactly the same thing using partial so with partial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5745" target="_blank">01:35:45.680</a></span> | <span class="t">it's going to do exactly the same thing as this kind of make show progress it's going to call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5751" target="_blank">01:35:51.600</a></span> | <span class="t">show progress and pass okay I guess so this is an again an example of a function returning a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5757" target="_blank">01:35:57.360</a></span> | <span class="t">function and so this is a function that calls show progress passing in this as the first parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5763" target="_blank">01:36:03.600</a></span> | <span class="t">and again it does exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5771" target="_blank">01:36:11.760</a></span> | <span class="t">okay so we go we tend to use partial a lot so that's certainly something worth spending time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5779" target="_blank">01:36:19.200</a></span> | <span class="t">practicing now as we've discussed python doesn't care about types in particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5789" target="_blank">01:36:29.440</a></span> | <span class="t">and there's nothing about any of this that requires cb to be a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5796" target="_blank">01:36:36.480</a></span> | <span class="t">it just has to be it just has to be a callable a callable is something that that you can that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5802" target="_blank">01:36:42.720</a></span> | <span class="t">can call and so as we've discussed another way of creating a callable is defining dunder call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5808" target="_blank">01:36:48.320</a></span> | <span class="t">so here's a class and this is going to work exactly the same as our make show progress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5814" target="_blank">01:36:54.960</a></span> | <span class="t">thing but now as a class so there's a dunder in it which draws the exclamation and a dunder call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5821" target="_blank">01:37:01.520</a></span> | <span class="t">that prints and so now we're creating a object which is callable and does exactly the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5830" target="_blank">01:37:10.560</a></span> | <span class="t">okay so these are all like um fundamental ideas that I want you to get really comfortable with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5841" target="_blank">01:37:21.360</a></span> | <span class="t">the idea of dunder call dunder things in general partials classes because they come up all the time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5851" target="_blank">01:37:31.840</a></span> | <span class="t">um in pytorch code and um and in the code we'll be writing and in fact pretty much all frameworks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5859" target="_blank">01:37:39.760</a></span> | <span class="t">so it's really important to feel comfortable with them and remember you don't have to rely on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5865" target="_blank">01:37:45.520</a></span> | <span class="t">the resources we're providing you know if there's certain things here that are very new to you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5871" target="_blank">01:37:51.520</a></span> | <span class="t">you know google around for some tutorials or ask for help on the forums finding things and so forth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5878" target="_blank">01:37:58.240</a></span> | <span class="t">and then I'm just going to briefly recover something I've mentioned before which is star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5883" target="_blank">01:38:03.040</a></span> | <span class="t">args and star star quags because again they come up a lot um I just wanted to show you how they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5888" target="_blank">01:38:08.400</a></span> | <span class="t">work so if we create a function that has star args and star star quags nothing else and I'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5896" target="_blank">01:38:16.160</a></span> | <span class="t">going to have this function just print them now I'm going to call the function I'm going to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5902" target="_blank">01:38:22.160</a></span> | <span class="t">three I'm going to pass a and I'm going to pass thing one equals hello now these are passed what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5909" target="_blank">01:38:29.440</a></span> | <span class="t">we would say by position we haven't got a blah equals they're just stuck there things that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5915" target="_blank">01:38:35.440</a></span> | <span class="t">passed by position are placed in star args if you have one it doesn't have to be called args you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5921" target="_blank">01:38:41.360</a></span> | <span class="t">call this anything you like but in the star bit and so you can see here that args is a tuple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5929" target="_blank">01:38:49.200</a></span> | <span class="t">containing the positionally passed arguments and then quags is a dictionary containing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5937" target="_blank">01:38:57.120</a></span> | <span class="t">the named arguments so that is all that star args and star star quags too and as I say there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5944" target="_blank">01:39:04.160</a></span> | <span class="t">nothing special about these names I'll call this a I'll call this b</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5951" target="_blank">01:39:11.760</a></span> | <span class="t">okay and it'll do exactly the same thing okay so um this comes up a lot um and so it's it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5963" target="_blank">01:39:23.120</a></span> | <span class="t">important to remember this is literally all that they're doing and then um on the other hand</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5973" target="_blank">01:39:33.200</a></span> | <span class="t">let's say we had a function which takes a couple of okay let's try that print</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5984" target="_blank">01:39:44.160</a></span> | <span class="t">a actually just print them directly a b c okay we can also rather than just using them as parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=5998" target="_blank">01:39:58.400</a></span> | <span class="t">we can also use them when calling something so let's say I create something called args again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6003" target="_blank">01:40:03.920</a></span> | <span class="t">doesn't have to be called args called which contains one comma two and I create something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6010" target="_blank">01:40:10.560</a></span> | <span class="t">called quags that contains a dictionary containing c colon three I can then call g and I can pass in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6023" target="_blank">01:40:23.120</a></span> | <span class="t">star args comma star star quags and that's going to take this one two and pass them as individual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6032" target="_blank">01:40:32.320</a></span> | <span class="t">arguments for positionally and it's going to take the c three and pass that as a named argument c</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6038" target="_blank">01:40:38.800</a></span> | <span class="t">equals three and there it is okay so they're kind of two linked but different ways that use star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6048" target="_blank">01:40:48.640</a></span> | <span class="t">and star star um okay now here's a slightly different way of doing callbacks which I really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6059" target="_blank">01:40:59.280</a></span> | <span class="t">like in this case I've now passing in a callback that's not callable but instead it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6067" target="_blank">01:41:07.360</a></span> | <span class="t">have a method called before calc and another method called after calc and I'm so now my callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6077" target="_blank">01:41:17.760</a></span> | <span class="t">is going to be a class containing a before calc and an after calc method and so if I run that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6088" target="_blank">01:41:28.480</a></span> | <span class="t">you can see it's that there it goes okay and so this is printing before and after every step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6099" target="_blank">01:41:39.200</a></span> | <span class="t">by call calling before calc and after calc so callback actually doesn't have to be a callable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6104" target="_blank">01:41:44.160</a></span> | <span class="t">doesn't have to be a function a callback could be something that contains methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6108" target="_blank">01:41:48.240</a></span> | <span class="t">so we could have a version of this which actually as you can see here it's going to pass in to after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6120" target="_blank">01:42:00.560</a></span> | <span class="t">calc both the epoch number and the value it's up to but by using star args and star star quags I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6127" target="_blank">01:42:07.520</a></span> | <span class="t">can just safely ignore them if I don't want them right so it's just going to chew them up and not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6133" target="_blank">01:42:13.120</a></span> | <span class="t">complain if I didn't have those here it won't work see because it got passed in vowel equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6144" target="_blank">01:42:24.640</a></span> | <span class="t">and there's nothing here looking for vowel equals it doesn't like that so this is one good use of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6151" target="_blank">01:42:31.760</a></span> | <span class="t">star args and star star quags is to etap arguments you don't want um or we could use the argument so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6159" target="_blank">01:42:39.920</a></span> | <span class="t">let's actually use epoch and val and print them out and there it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6169" target="_blank">01:42:49.280</a></span> | <span class="t">so this is a more sophisticated callback that's giving us status as we go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6176" target="_blank">01:42:56.320</a></span> | <span class="t">um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6186" target="_blank">01:43:06.800</a></span> | <span class="t">I'm going to skip this bit because we don't really care about that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6192" target="_blank">01:43:12.960</a></span> | <span class="t">okay so finally let's just review this idea of dunder which we've mentioned before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6200" target="_blank">01:43:20.640</a></span> | <span class="t">but just to to really nail this home anything that looks like this underscore underscore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6206" target="_blank">01:43:26.560</a></span> | <span class="t">something underscore underscore something is special and basically it could be that python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6212" target="_blank">01:43:32.240</a></span> | <span class="t">has to find that special thing or pytorch has to find that special thing or numpy has to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6216" target="_blank">01:43:36.960</a></span> | <span class="t">that special thing but they're special these are called dunder methods um and some of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6225" target="_blank">01:43:45.520</a></span> | <span class="t">are defined as part of the python data model and so if you go to the python documentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6232" target="_blank">01:43:52.640</a></span> | <span class="t">it'll tell you about these various different here's repra which we used earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6239" target="_blank">01:43:59.040</a></span> | <span class="t">here's init that we used earlier so they're all here pytorch has some of its own numpy has some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6245" target="_blank">01:44:05.600</a></span> | <span class="t">of its own so for example if python sees plus what it actually does is it calls dunder add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6253" target="_blank">01:44:13.760</a></span> | <span class="t">so if we want to create something that's not very good at adding things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6259" target="_blank">01:44:19.040</a></span> | <span class="t">it actually already also always adds 0.01 to it then i can say sloppy adder one plus sloppy adder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6269" target="_blank">01:44:29.280</a></span> | <span class="t">two equals 3.01 so plus here is actually calling dunder add so if you're not familiar with these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6280" target="_blank">01:44:40.320</a></span> | <span class="t">click on this data model link and read about these specific one two three four five six seven eight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6285" target="_blank">01:44:45.760</a></span> | <span class="t">nine ten eleven methods because we'll be using all of these in the course so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6291" target="_blank">01:44:51.840</a></span> | <span class="t">i'll try to revise them when we can but i'm generally going to assume that you know these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6296" target="_blank">01:44:56.960</a></span> | <span class="t">a particularly interesting one is getatra we've seen setatra already getatra is just the opposite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6308" target="_blank">01:45:08.880</a></span> | <span class="t">take a look at this here's a class it just contains two attributes a and b that are set to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6315" target="_blank">01:45:15.040</a></span> | <span class="t">one and two so i'll create that an object of that class a dot b equals two because i set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6320" target="_blank">01:45:20.240</a></span> | <span class="t">b to two okay now when you say a dot b that's just syntax sugar basically in python what it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6328" target="_blank">01:45:28.720</a></span> | <span class="t">actually calling behind the scenes is getatra it calls getatra on the object and so this one here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6337" target="_blank">01:45:37.840</a></span> | <span class="t">is the same as getatra a comma b which hopefully oh actually that that'll be um yeah so it calls</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6348" target="_blank">01:45:48.640</a></span> | <span class="t">getatra a comma b and this can kind of be fun because you could call getatra a comma and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6354" target="_blank">01:45:54.160</a></span> | <span class="t">either b or a randomly how's that for crazy so if i run this two one one one two as you can see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6364" target="_blank">01:46:04.080</a></span> | <span class="t">random um so yeah python's such a dynamic language you can even set it up so you literally don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6372" target="_blank">01:46:12.080</a></span> | <span class="t">what attributes going to be called now getatra behind the scenes is actually calling something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6381" target="_blank">01:46:21.280</a></span> | <span class="t">called done to getatra and by default it'll use the version in the object base class so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6388" target="_blank">01:46:28.160</a></span> | <span class="t">something just like a it's got i've got a and b defined but i've also got done to getatra defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6394" target="_blank">01:46:34.160</a></span> | <span class="t">and so done to getatra it's only called for stuff that hasn't been defined yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6398" target="_blank">01:46:38.640</a></span> | <span class="t">and it'll pass in the key or the the the name of the attribute so generally speaking if the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6407" target="_blank">01:46:47.600</a></span> | <span class="t">character is an underscore it's going to be private or special so i'm just going to raise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6412" target="_blank">01:46:52.880</a></span> | <span class="t">an attribute error error otherwise i'm going to steal it and return hello from k so if i go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6422" target="_blank">01:47:02.160</a></span> | <span class="t">b dot a that's defined so it gives me one if i go b dot foo that's not defined so it calls getatra</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6430" target="_blank">01:47:10.880</a></span> | <span class="t">and i get back hello from foo and so um uh this gets used a lot in both fastai code and also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6437" target="_blank">01:47:17.040</a></span> | <span class="t">hugging face code um to you know often make it more convenient to access things um so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6446" target="_blank">01:47:26.640</a></span> | <span class="t">yeah that's how the getatra function and the done to getatra method work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6452" target="_blank">01:47:32.480</a></span> | <span class="t">um okay so i went over that pretty quickly um since i know for quite a few folks this will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6460" target="_blank">01:47:40.080</a></span> | <span class="t">all review but i know for folks who haven't seen any of this this is a lot to cover so i'm hoping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6465" target="_blank">01:47:45.680</a></span> | <span class="t">that you'll kind of go back over this revise it slowly experiment with it and look up some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6470" target="_blank">01:47:50.480</a></span> | <span class="t">additional resources and ask on the forum and stuff for anything that's not clear remember um</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6476" target="_blank">01:47:56.560</a></span> | <span class="t">everybody has parts of the course that's really easy for them and parts of the course that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6484" target="_blank">01:48:04.400</a></span> | <span class="t">completely unfamiliar for them and so if this particular part of the course is completely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6488" target="_blank">01:48:08.320</a></span> | <span class="t">unfamiliar to you it's not because this is harder um or going to be more difficult or whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6495" target="_blank">01:48:15.760</a></span> | <span class="t">it's just so happens that this is a bit that you're less familiar with or maybe the stuff about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6502" target="_blank">01:48:22.000</a></span> | <span class="t">calculus in the last lesson was a bit that you're less familiar with um there isn't really anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6507" target="_blank">01:48:27.280</a></span> | <span class="t">particularly in the course that's more difficult than other parts it's just that you know based on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6513" target="_blank">01:48:33.120</a></span> | <span class="t">whether you happen to have that background and so yeah if you spend a few hours studying and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6519" target="_blank">01:48:39.280</a></span> | <span class="t">practicing you know you'll be able to pick up these things and um yeah so don't stress if there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6526" target="_blank">01:48:46.080</a></span> | <span class="t">are things that you don't get right away just take the time and if you yeah if you do get lost please</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6532" target="_blank">01:48:52.000</a></span> | <span class="t">ask because people are very keen to help if you've tried asking on the forum hopefully you've noticed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6537" target="_blank">01:48:57.440</a></span> | <span class="t">that people are really keen to help all right so um i think this has been a pretty successful lesson</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6545" target="_blank">01:49:05.040</a></span> | <span class="t">we've we've got to a point where we've got a pretty nicely optimized training loop we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6549" target="_blank">01:49:09.280</a></span> | <span class="t">understand exactly what data loaders and data sets do we've got an optimizer we've been playing with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6555" target="_blank">01:49:15.600</a></span> | <span class="t">hugging face data sets and we've got those working really smoothly um so we really feel like we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6560" target="_blank">01:49:20.720</a></span> | <span class="t">in a pretty good position to to write our generic learner training loop and then we can start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6566" target="_blank">01:49:26.880</a></span> | <span class="t">building and experimenting with lots of models so look forward to seeing you next time to doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=veqj0DsZSXU&t=6572" target="_blank">01:49:32.080</a></span> | <span class="t">that together. Okay, bye!</span></div></div></body></html>