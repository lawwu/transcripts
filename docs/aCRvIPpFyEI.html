<html><head><title>Mixtral 8X7B — Deploying an *Open* AI Agent</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Mixtral 8X7B — Deploying an *Open* AI Agent</h2><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI"><img src="https://i.ytimg.com/vi_webp/aCRvIPpFyEI/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=0">0:0</a> Mixtral 8X7B is better than GPT 3.5<br><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=50">0:50</a> Deploying Mixtral 8x7B<br><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=201">3:21</a> Mixtral Code Setup<br><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=497">8:17</a> Using Mixtral Instructions<br><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=604">10:4</a> Mixtral Special Tokens<br><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=809">13:29</a> Parsing Multiple Agent Tools<br><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=868">14:28</a> RAG with Mixtral<br><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1021">17:1</a> Final Thoughts on Mixtral<br><br><div style="text-align: left;"><a href="./aCRvIPpFyEI.html">Whisper Transcript</a> | <a href="./transcript_aCRvIPpFyEI.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we have a very exciting video, we are going to test and see the performance of the new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=6" target="_blank">00:00:06.960</a></span> | <span class="t">Mixedraw 8x 7 billion parameter model, which honestly from what I've seen so far is pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=14" target="_blank">00:00:14.160</a></span> | <span class="t">incredible. It is far better than any other open model that I've tested and at the same time it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=20" target="_blank">00:00:20.720</a></span> | <span class="t">very fast. Most open models I've tested that have you know reasonably large and reasonably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=25" target="_blank">00:00:25.600</a></span> | <span class="t">performance are just incredibly slow and you can't really use them. This is actually incredibly fast,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=30" target="_blank">00:00:30.800</a></span> | <span class="t">incredibly performance and I can actually use this rather than something like Jupyter 3.5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=36" target="_blank">00:00:36.080</a></span> | <span class="t">and that's the first time I can actually confidently say that about an open weights model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=41" target="_blank">00:00:41.280</a></span> | <span class="t">So let's jump straight into how we can use this model and we're going to toy around with using it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=46" target="_blank">00:00:46.880</a></span> | <span class="t">in almost like an agent like flow. So I'm going to use it through RunPod. RunPod seems to be pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=55" target="_blank">00:00:55.840</a></span> | <span class="t">good, I tried a few different options to see what would be kind of easy to use and not super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=61" target="_blank">00:01:01.920</a></span> | <span class="t">expensive and RunPod seemed pretty good. They're not sponsoring this or anything, they just seem</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=68" target="_blank">00:01:08.080</a></span> | <span class="t">like a really very good option compared to what else is out there and yeah we have a few H100s</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=75" target="_blank">00:01:15.760</a></span> | <span class="t">on here which is pretty cool but what we can go with is the A100s, it's cheaper and it works just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=82" target="_blank">00:01:22.080</a></span> | <span class="t">as well. So I'm going to set up two A100s, I'm going to click deploy and then you can customize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=89" target="_blank">00:01:29.680</a></span> | <span class="t">your deployment here. Okay for that custom deployment I think you can probably go a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=95" target="_blank">00:01:35.680</a></span> | <span class="t">little lower than what I'm going here but this worked well for me without being too obsessive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=102" target="_blank">00:01:42.400</a></span> | <span class="t">So I set my container disk to 120 and my volume disk to 600 and that's going to get us pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=109" target="_blank">00:01:49.200</a></span> | <span class="t">close to the limit but you know we're going to still have some breathing room. So I'm going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=114" target="_blank">00:01:54.240</a></span> | <span class="t">set those overrides and the one thing like this doesn't matter, we're not going to be using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=120" target="_blank">00:02:00.160</a></span> | <span class="t">but we are going to be using Jupyter Notebook so make sure that is checked and we'll just continue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=128" target="_blank">00:02:08.320</a></span> | <span class="t">Okay so we have the pricing cast, it's not cheap but it could be worse and we can go ahead and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=135" target="_blank">00:02:15.440</a></span> | <span class="t">deploy that. I will expect that this is going to get cheaper as we have the quantized models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=142" target="_blank">00:02:22.800</a></span> | <span class="t">being released and I've already seen that some of them have been released so we're going to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=149" target="_blank">00:02:29.200</a></span> | <span class="t">those anyway. Now in here we have this one running so this is the one I just created,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=155" target="_blank">00:02:35.920</a></span> | <span class="t">it's starting up. I'm going to stop it in a moment because I already have another one running and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=161" target="_blank">00:02:41.440</a></span> | <span class="t">can see that my container utilization is about 78%. If you go too low on the volume during the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=170" target="_blank">00:02:50.000</a></span> | <span class="t">build time then you'll probably exceed that so you don't want to go too low on volume but at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=176" target="_blank">00:02:56.400</a></span> | <span class="t">moment it's like zero percent whilst nothing is being downloaded or running. So I'm going to stop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=183" target="_blank">00:03:03.360</a></span> | <span class="t">that and just delete it quickly and what I'm going to do is come over to my my pod here, we go to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=194" target="_blank">00:03:14.960</a></span> | <span class="t">connect and we click on this connect to JupyterLab. That opens this window here and yours should be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=204" target="_blank">00:03:24.400</a></span> | <span class="t">empty. I'm going to be using this notebook here, there will be a link to this notebook at the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=210" target="_blank">00:03:30.480</a></span> | <span class="t">of the video right now. You can download this notebook and then you can just upload it to your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=216" target="_blank">00:03:36.480</a></span> | <span class="t">run pod here. So you do upload and just find your file in here so I'd be uploading this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=224" target="_blank">00:03:44.400</a></span> | <span class="t">Okay cool so I have some notes here, I'm trying to write this out into more of like a written</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=230" target="_blank">00:03:50.080</a></span> | <span class="t">guide as well but for now let's just jump straight into what we need prerequisites and actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=235" target="_blank">00:03:55.440</a></span> | <span class="t">testing all this. So for the pip installs we have Hugging Face Transformers so we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=242" target="_blank">00:04:02.160</a></span> | <span class="t">using the Hugging Face Transformers version of the model. Accelerate which is sort of a Hugging</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=249" target="_blank">00:04:09.040</a></span> | <span class="t">Face thing it's so that we're using the GPU in the way that we would like to use it and because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=254" target="_blank">00:04:14.160</a></span> | <span class="t">we're using agents I wanted to add a couple of like tools to our agent. So one of those is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=260" target="_blank">00:04:20.000</a></span> | <span class="t">to be a web search tool. Those will install, I already have them installed so I don't need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=265" target="_blank">00:04:25.600</a></span> | <span class="t">reinstall and then we'll come down to here and we're going to be using the instruct model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=270" target="_blank">00:04:30.800</a></span> | <span class="t">fine-tune model of Mixture 8x7b. There's also I think the normal model is just this so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=280" target="_blank">00:04:40.080</a></span> | <span class="t">the pre-trained without the extra instruct fine-tuning. We run this, there's a few things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=285" target="_blank">00:04:45.840</a></span> | <span class="t">in here that are important that you should be aware of. I don't think I need the CUDA here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=290" target="_blank">00:04:50.240</a></span> | <span class="t">So we're trusting remote code basically Hugging Face hasn't got an object class for Mixture yet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=299" target="_blank">00:04:59.040</a></span> | <span class="t">so we have to do this trust remote code so that it basically modifies some of the code and runs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=304" target="_blank">00:05:04.480</a></span> | <span class="t">things in like within the object itself. So we also want the torch data type we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=312" target="_blank">00:05:12.800</a></span> | <span class="t">using float 16 and the device map is going to be auto. Okay so for this bit here this is where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=320" target="_blank">00:05:20.000</a></span> | <span class="t">need accelerate installed. So that actually just installed super quickly for me because I already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=326" target="_blank">00:05:26.880</a></span> | <span class="t">had it downloaded. When you first download this model on my run pod I think it took probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=334" target="_blank">00:05:34.560</a></span> | <span class="t">around 20 to 25 minutes so it does take a little while because there's a lot of waits in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=342" target="_blank">00:05:42.160</a></span> | <span class="t">Okay cool so let's take a look at the tokenizer or what is next. So with LLMs and transform models in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=353" target="_blank">00:05:53.280</a></span> | <span class="t">general what they use is something called a tokenizer to translate things from plain text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=360" target="_blank">00:06:00.480</a></span> | <span class="t">to these arrays of tokens which are then read by the first layer of the transformer/LLM model. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=367" target="_blank">00:06:07.760</a></span> | <span class="t">we need to initialize the tokenizer that Mixture uses so we just pass in the Mixture model ID</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=374" target="_blank">00:06:14.080</a></span> | <span class="t">into auto tokenizer from pre-trained and that will load that tokenizer for us and then with all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=380" target="_blank">00:06:20.560</a></span> | <span class="t">that set up we can go ahead and initialize this text generation pipeline. So the text generation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=387" target="_blank">00:06:27.680</a></span> | <span class="t">pipeline needs a model so the Mixture model and we also need Mixture's tokenizer. Return for text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=394" target="_blank">00:06:34.480</a></span> | <span class="t">I've set that to false basically if you're using line chain or at least the last time I used this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=400" target="_blank">00:06:40.000</a></span> | <span class="t">with line chain you had to set that to true for things to work. We're going to be using text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=404" target="_blank">00:06:44.800</a></span> | <span class="t">generation as the the task that we're doing here and then there's a few parameters here that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=409" target="_blank">00:06:49.200</a></span> | <span class="t">can modify. Okay so repetition penalty for example this was important for all some of the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=416" target="_blank">00:06:56.320</a></span> | <span class="t">models I was toying around with. I'm not sure how important it is with Mixture but you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=422" target="_blank">00:07:02.960</a></span> | <span class="t">essentially increase this number and it will reduce the likelihood of the model repeating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=428" target="_blank">00:07:08.400</a></span> | <span class="t">itself which is actually something I see in even in GPT 3.5 quite often when you keep repeating the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=435" target="_blank">00:07:15.280</a></span> | <span class="t">same input it tends to kind of go into a loop. So yeah we can generate some text on the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=444" target="_blank">00:07:24.400</a></span> | <span class="t">the first time you run this it takes a lot longer and then after that it should be pretty quick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=450" target="_blank">00:07:30.240</a></span> | <span class="t">So I'll wait a moment now while that's running we can come over to here. So this is the the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=456" target="_blank">00:07:36.160</a></span> | <span class="t">ROM pod that we have and we can just take a look at how much GPU this is actually using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=460" target="_blank">00:07:40.880</a></span> | <span class="t">Okay so you can see it started to pick up now. We have okay memory used zero nothing on or nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=470" target="_blank">00:07:50.720</a></span> | <span class="t">much on one yet so that's still running. Okay we see that we're using number one as well and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=479" target="_blank">00:07:59.200</a></span> | <span class="t">get our output. Okay and the output is you know kind of random because we just put in some random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=485" target="_blank">00:08:05.680</a></span> | <span class="t">text we can use these special tokens or any or provide any instructions as to what the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=490" target="_blank">00:08:10.400</a></span> | <span class="t">should be doing. So this sort of random output here is that's pretty normal. Now let's take a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=497" target="_blank">00:08:17.760</a></span> | <span class="t">look at the okay how do we not to get that sort of output and get something that's actually useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=503" target="_blank">00:08:23.760</a></span> | <span class="t">So as I said we haven't provided any instructions to the model so that's the first thing that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=508" target="_blank">00:08:28.560</a></span> | <span class="t">should do. So I'm going to do that here. I'm going to say okay you're a helpful AI assistant you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=514" target="_blank">00:08:34.560</a></span> | <span class="t">help with a ton of things so on and so on. We add some descriptions for the tools that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=522" target="_blank">00:08:42.560</a></span> | <span class="t">to be using. So you can see that here we're talking about Python code that is for the calculator tool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=529" target="_blank">00:08:49.120</a></span> | <span class="t">which does its calculations using Python. The search tool which is for the search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=534" target="_blank">00:08:54.560</a></span> | <span class="t">and the final answer which is like return an answer to the user. And then it tells you it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=541" target="_blank">00:09:01.840</a></span> | <span class="t">has a little bit of an example how to use them and then we finish with okay this is the end right the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=550" target="_blank">00:09:10.240</a></span> | <span class="t">user's query is as follows and then we have the user's query and then we have the assistant and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=554" target="_blank">00:09:14.720</a></span> | <span class="t">we are using this json format it aligns with the long chain format for agents where we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=563" target="_blank">00:09:23.280</a></span> | <span class="t">tool name and we'll also have the input okay and we've given the model instructions on how to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=569" target="_blank">00:09:29.200</a></span> | <span class="t">that here. So this is like the primer okay we run this and and then we want to generate some more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=577" target="_blank">00:09:37.280</a></span> | <span class="t">text okay so it's super quick all right so it's saying if I look at the question that we asked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=583" target="_blank">00:09:43.680</a></span> | <span class="t">hi there I'm stuck on the math problem can you help my question is what is square root of 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=589" target="_blank">00:09:49.840</a></span> | <span class="t">multiplied by 7 and it decides to go with the calculator and the input is from math import</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=597" target="_blank">00:09:57.440</a></span> | <span class="t">square root and then square root of 512 multiplied by 7. So that looks pretty correct now the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=605" target="_blank">00:10:05.840</a></span> | <span class="t">thing that I mentioned up here is how we should structure those inputs to get good outputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=612" target="_blank">00:10:12.000</a></span> | <span class="t">is here we've not used the recommended instruction format which looks something like this I'm not 100%</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=617" target="_blank">00:10:17.440</a></span> | <span class="t">sure on it exactly if that is is perfect but this is what I've seen being used so what we have is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=625" target="_blank">00:10:25.920</a></span> | <span class="t">what we are going to be inputting into the model is this beginning of string we're going to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=630" target="_blank">00:10:30.720</a></span> | <span class="t">beginning of instructions end of instructions and then we have our primer text right and then we let</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=636" target="_blank">00:10:36.640</a></span> | <span class="t">the lm generate some outputs originally I actually moved this over here and we'll get some pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=643" target="_blank">00:10:43.680</a></span> | <span class="t">weird results so I think it's supposed to be like this so let's come down to here and we'll see how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=649" target="_blank">00:10:49.440</a></span> | <span class="t">we'd actually do that so we come to instruction format we're going to do beginning of string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=655" target="_blank">00:10:55.360</a></span> | <span class="t">winning of instructions end of instructions and then we have our user input our system and so on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=660" target="_blank">00:11:00.080</a></span> | <span class="t">okay we don't add that final end of string in there so I'm going to run this we need to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=667" target="_blank">00:11:07.440</a></span> | <span class="t">in our system message which is this the same as we saw before and then we want to pass in the user's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=672" target="_blank">00:11:12.960</a></span> | <span class="t">query so we run that and then we can have a look at what we have so print input format sorry input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=684" target="_blank">00:11:24.560</a></span> | <span class="t">prompt okay so this is the input we're getting and we'll come down to here we see end the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=692" target="_blank">00:11:32.160</a></span> | <span class="t">instructions after the instructions are finished and then we have the chat log so it can be hi there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=697" target="_blank">00:11:37.600</a></span> | <span class="t">I'm stuck in a math problem so on and so on and then the assistant is starting to reply with this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=702" target="_blank">00:11:42.400</a></span> | <span class="t">but then we need to generate the the rest of this so we do that here and we get a calculator and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=711" target="_blank">00:11:51.600</a></span> | <span class="t">tells us the correct thing there now we can pass this into python executable code all right so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=718" target="_blank">00:11:58.000</a></span> | <span class="t">is kind of how an agent would work then we use that to get our formatted output so this is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=726" target="_blank">00:12:06.160</a></span> | <span class="t">python dictionary now and then we use the calculator so we say if the actual name is calculator then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=733" target="_blank">00:12:13.280</a></span> | <span class="t">we're going to use the calculator which is python and we get this one five eight okay so that is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=739" target="_blank">00:12:19.520</a></span> | <span class="t">the answer now if we add all this information that we just received to our prompt we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=745" target="_blank">00:12:25.040</a></span> | <span class="t">to get something like this so we have our agent template and then we append all the other stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=748" target="_blank">00:12:28.720</a></span> | <span class="t">into there and we also get our output which is this number here so run this run this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=757" target="_blank">00:12:37.520</a></span> | <span class="t">you can see the bottom we have that where do we have it the tool output which the lm can now use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=766" target="_blank">00:12:46.720</a></span> | <span class="t">so now using this full prompt with the additional stuff in there we're going to run this generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=773" target="_blank">00:12:53.680</a></span> | <span class="t">text and see what happens so again we get the correct format we have final answer and we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=779" target="_blank">00:12:59.280</a></span> | <span class="t">the input that we'd like so we're in this and yeah so it's basically passing in all that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=785" target="_blank">00:13:05.680</a></span> | <span class="t">information that we saw so far into the final lm call and we get this so the square root of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=792" target="_blank">00:13:12.080</a></span> | <span class="t">512 multiplied by 7 is approximately you know similar the number okay so that's a good sort</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=797" target="_blank">00:13:17.440</a></span> | <span class="t">of human-like answer now if we say okay the user or we would like to return final answer so we'd</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=804" target="_blank">00:13:24.720</a></span> | <span class="t">like to actually respond to the user we have another function for that and then we kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=811" target="_blank">00:13:31.120</a></span> | <span class="t">put all the tool of passing logic into a single function okay so we decide on which tool this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=818" target="_blank">00:13:38.720</a></span> | <span class="t">dictionary here contains the tool name and with that we can just go ahead and use that tool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=825" target="_blank">00:13:45.520</a></span> | <span class="t">so we're going to do create some prompt and once we have our input prompt yeah we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=833" target="_blank">00:13:53.680</a></span> | <span class="t">passing that to the run function here so let's run this pass our input prompt into the run function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=839" target="_blank">00:13:59.280</a></span> | <span class="t">and then we get this tool output right so it's using it's deciding based on what we've asked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=843" target="_blank">00:14:03.920</a></span> | <span class="t">it that it needs to use the the calculator tool and this is what we get so now we add the so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=851" target="_blank">00:14:11.360</a></span> | <span class="t">have this information in our context already and now we just add that primer again so assistant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=856" target="_blank">00:14:16.320</a></span> | <span class="t">jason tool name that's a primer so we run this and then let's see what we get as well okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=863" target="_blank">00:14:23.120</a></span> | <span class="t">we get pretty good output here's this is what we'd expect so that's good but i wanted to try something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=870" target="_blank">00:14:30.400</a></span> | <span class="t">more because we we've built this like agent type thing and it has multiple tools one of those we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=876" target="_blank">00:14:36.080</a></span> | <span class="t">haven't used yet which is the search tool okay so this is just say a web search using go search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=881" target="_blank">00:14:41.680</a></span> | <span class="t">the reason we're using this because it's super simple to do of course we can do more complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=888" target="_blank">00:14:48.640</a></span> | <span class="t">tooling here as well but what it's going to do is use the go search it's going to retrieve the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=894" target="_blank">00:14:54.800</a></span> | <span class="t">items or the results that we get and it's going to return them in this format here so basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=900" target="_blank">00:15:00.800</a></span> | <span class="t">a set of results separated by new lines and these three dashes and then we're going to return that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=909" target="_blank">00:15:09.120</a></span> | <span class="t">as the tool output okay so kind of like what we did here but we're going to return context so to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=916" target="_blank">00:15:16.240</a></span> | <span class="t">do that we need to ask another question so i'm going to go with a query and that query will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=923" target="_blank">00:15:23.520</a></span> | <span class="t">who is the current prime minister</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=927" target="_blank">00:15:27.200</a></span> | <span class="t">of the uk you know this is not a question that most of us can answer so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=935" target="_blank">00:15:35.920</a></span> | <span class="t">an llm by itself would have no chance we can try this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=940" target="_blank">00:15:40.400</a></span> | <span class="t">and let's see what we get we might want to print this i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=951" target="_blank">00:15:51.040</a></span> | <span class="t">okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=953" target="_blank">00:15:53.600</a></span> | <span class="t">so it turns out rishi sunak is still the prime minister that's surprising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=959" target="_blank">00:15:59.200</a></span> | <span class="t">and yeah we get these results but we don't obviously want this tool output we want our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=966" target="_blank">00:16:06.640</a></span> | <span class="t">lm2 producer a nicer output for us so we then pass this output here so actually i don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=974" target="_blank">00:16:14.880</a></span> | <span class="t">if i showed you that so if i print the out one it's basically going to show us a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=982" target="_blank">00:16:22.160</a></span> | <span class="t">input prompt plus what we've just generated okay and you can see we have like everything in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=988" target="_blank">00:16:28.480</a></span> | <span class="t">plus the most recent so the tool input the search who's the current prime minister of uk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=993" target="_blank">00:16:33.280</a></span> | <span class="t">the tool outputs and the last thing we want to do is add onto that uh what you know this here okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1001" target="_blank">00:16:41.680</a></span> | <span class="t">so i want to run this again and then let's see what we get okay so again rishi sunak has been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1011" target="_blank">00:16:51.040</a></span> | <span class="t">a prime minister of the uk since the 25th of october 2024 so yeah that's that looks pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1019" target="_blank">00:16:59.920</a></span> | <span class="t">good i think those are pretty good results and i think what i'm taking from this i haven't tested</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1027" target="_blank">00:17:07.120</a></span> | <span class="t">the new mixer model enough yet to confidently say it's incredible but it seems to work incredibly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1033" target="_blank">00:17:13.840</a></span> | <span class="t">well from what i have seen so far if i compare it to using gpt 3.5 as an agent which is probably the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1040" target="_blank">00:17:20.640</a></span> | <span class="t">most common agent model out there it seems to be more reliable just from the limited testing i have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1048" target="_blank">00:17:28.960</a></span> | <span class="t">done with gpt 3.5 i would often be adding in output passes that handling like malformed json</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1056" target="_blank">00:17:36.960</a></span> | <span class="t">and so on and so on this i haven't needed to do that at all which i think seems pretty promising</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1065" target="_blank">00:17:45.600</a></span> | <span class="t">but anyway that's it for this video i think this is super exciting i'm definitely going to do more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1069" target="_blank">00:17:49.680</a></span> | <span class="t">on mixture going forwards we're also going to talk about mixture of experts i think that'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1074" target="_blank">00:17:54.320</a></span> | <span class="t">be pretty interesting as well but we'll leave it there for now thank you very much for watching</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1078" target="_blank">00:17:58.800</a></span> | <span class="t">i hope it's been useful and interesting and i will see you again in the next one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1097" target="_blank">00:18:17.360</a></span> | <span class="t">(gentle music)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=aCRvIPpFyEI&t=1099" target="_blank">00:18:19.940</a></span> | <span class="t">you</span></div></div></body></html>