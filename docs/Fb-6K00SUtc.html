<html><head><title>Table Question-Answering with TAPAS in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Table Question-Answering with TAPAS in Python</h2><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc"><img src="https://i.ytimg.com/vi_webp/Fb-6K00SUtc/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=64">1:4</a> Table QA process<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=218">3:38</a> Getting the code<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=248">4:8</a> Colab GPU and prerequisites<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=273">4:33</a> Dataset download and preprocessing<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=370">6:10</a> Table QA retrieval pipeline<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=689">11:29</a> First test, can it retrieve tables?<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=775">12:55</a> TAPAS model for table QA<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=904">15:4</a> Asking more table QA questions<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1057">17:37</a> Asking advanced aggregation questions to TAPAS<br><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1178">19:38</a> Final thoughts<br><br><div style="text-align: left;"><a href="./Fb-6K00SUtc.html">Whisper Transcript</a> | <a href="./transcript_Fb-6K00SUtc.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we're going to be taking a look at table question answering, which is essentially if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=6" target="_blank">00:00:06.240</a></span> | <span class="t">could ask a excel sheet a question like what is the GDP across both China and Indonesia and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=17" target="_blank">00:00:17.200</a></span> | <span class="t">would be able to look at the table, identify the two parts of the table that are relevant to that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=23" target="_blank">00:00:23.680</a></span> | <span class="t">question, sum those both together and return you that answer. But imagine we take that and we apply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=31" target="_blank">00:00:31.280</a></span> | <span class="t">it not to just one table in excel but we apply it to millions or even billions of tables and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=41" target="_blank">00:00:41.360</a></span> | <span class="t">system is actually capable of taking our question, retrieving the correct table to answer that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=46" target="_blank">00:00:46.640</a></span> | <span class="t">question and then repeating the process I just mentioned before where it extracts the specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=52" target="_blank">00:00:52.240</a></span> | <span class="t">parts of the table that are relevant to our query and even performs operations like summing over</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=58" target="_blank">00:00:58.560</a></span> | <span class="t">those values or averaging over those values. That is what we're going to learn about in this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=64" target="_blank">00:01:04.400</a></span> | <span class="t">So let me just describe the process that we're going to be taking in order to implement this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=70" target="_blank">00:01:10.640</a></span> | <span class="t">We're going to start with a vector database</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=76" target="_blank">00:01:16.480</a></span> | <span class="t">here naturally we'll be using Pinecone for that then what we do is we add something called a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=83" target="_blank">00:01:23.680</a></span> | <span class="t">retriever model. Now this retriever model will be an MPNET model so typically with natural language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=91" target="_blank">00:01:31.760</a></span> | <span class="t">semantic search MPNET is a really good option but this MPNET model has been trained for table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=98" target="_blank">00:01:38.720</a></span> | <span class="t">or reading tables so this is our retriever model. Now what's going to happen is we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=106" target="_blank">00:01:46.720</a></span> | <span class="t">going to ask a question like the question I mentioned before so something like what is GDP</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=112" target="_blank">00:01:52.480</a></span> | <span class="t">across certain conditions. So we're going to ask that sort of question we're going to take that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=121" target="_blank">00:02:01.440</a></span> | <span class="t">it's going to go into this retriever model which is our MPNET table retriever model and it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=127" target="_blank">00:02:07.760</a></span> | <span class="t">to encode that text into a vector and that vector represents the meaning behind that question. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=137" target="_blank">00:02:17.600</a></span> | <span class="t">that MPNET encoded vector goes into our vector database our vector database then returns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=145" target="_blank">00:02:25.360</a></span> | <span class="t">relevant tables which have also been encoded by that MPNET table model and it returns them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=154" target="_blank">00:02:34.480</a></span> | <span class="t">to our next model which is going to be a table reader model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=158" target="_blank">00:02:38.160</a></span> | <span class="t">It's going to be a table reader now this table reader model is also going to read our question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=169" target="_blank">00:02:49.440</a></span> | <span class="t">from up here so it's going to see both of those it's going to see what we've returned from Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=175" target="_blank">00:02:55.040</a></span> | <span class="t">over here and also our question and for the table reader we're going to be using a model called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=181" target="_blank">00:03:01.200</a></span> | <span class="t">TAPAS. Now what TAPAS can do is what I mentioned before where we take a table essentially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=189" target="_blank">00:03:09.760</a></span> | <span class="t">and it's going to identify the parts of that table that answer our particular question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=199" target="_blank">00:03:19.520</a></span> | <span class="t">and it's going to also say whether we need to sum over those parts whether we need to average or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=205" target="_blank">00:03:25.440</a></span> | <span class="t">whether we don't even need to do anything whether just the value itself is relevant and answers our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=211" target="_blank">00:03:31.280</a></span> | <span class="t">question. So that's the system we're going to be building let's move on to the code and we'll start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=217" target="_blank">00:03:37.440</a></span> | <span class="t">putting that all together. Okay so we're going to be running through this table question answering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=222" target="_blank">00:03:42.320</a></span> | <span class="t">document example from Pinecone so you can find that docs pinecone io slash docs table QA and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=232" target="_blank">00:03:52.320</a></span> | <span class="t">then what I'm going to be doing is just going through the Colab so you can just click on open</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=235" target="_blank">00:03:55.600</a></span> | <span class="t">Colab and run through the exact same code that I'm going to be going through. So that will open this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=241" target="_blank">00:04:01.200</a></span> | <span class="t">Colab notebook here this is another really cool idea and example notebook from Archeroke so again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=246" target="_blank">00:04:06.960</a></span> | <span class="t">thank you for that. Now the first thing we want to do is come up to runtime go to change runtime type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=254" target="_blank">00:04:14.080</a></span> | <span class="t">and switch this or make sure this is on GPU if it is not that will just make things a lot faster</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=259" target="_blank">00:04:19.680</a></span> | <span class="t">later on. There are a few prerequisites that we need to install torch scatter might take a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=264" target="_blank">00:04:24.480</a></span> | <span class="t">bit of time so if it is taking some time to install everything that is the reason why. I'm not going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=270" target="_blank">00:04:30.800</a></span> | <span class="t">rerun that because I have already done it and then what we want to do is we need to initialize this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=277" target="_blank">00:04:37.120</a></span> | <span class="t">notebook here. This is just from the HuggingFace datasets hub, Archeroke has uploaded it. It is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=285" target="_blank">00:04:45.040</a></span> | <span class="t">subset of the open table and text question answering dataset which is just below text and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=291" target="_blank">00:04:51.120</a></span> | <span class="t">tables from Wikipedia. Now once that has downloaded we'll see that we have a few features of URL so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=298" target="_blank">00:04:58.000</a></span> | <span class="t">where is it from title headers which is literally the headers of the table and then data within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=304" target="_blank">00:05:04.400</a></span> | <span class="t">that table. So we can have a look at one of those now the bits that we are most interested in is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=311" target="_blank">00:05:11.520</a></span> | <span class="t">here so the headers so this is about American football no baseball I think one of those things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=323" target="_blank">00:05:23.360</a></span> | <span class="t">I'm not sure and you have your headers here level team league manager and then you have the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=332" target="_blank">00:05:32.000</a></span> | <span class="t">so in level you'd have triple A, double A, AA and rookie and then so on with the other bits of data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=339" target="_blank">00:05:39.120</a></span> | <span class="t">in there as well. Now what we can do is we can format all those into pandas state frames which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=345" target="_blank">00:05:45.360</a></span> | <span class="t">just makes things a lot easier for us in both reading and later formatting so let's go ahead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=351" target="_blank">00:05:51.600</a></span> | <span class="t">and do that this again might take a moment to run okay 14 seconds and then we can run this and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=358" target="_blank">00:05:58.720</a></span> | <span class="t">can have a look at what I just showed you set from in table format so now we'll see it's a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=366" target="_blank">00:06:06.000</a></span> | <span class="t">easier to read nice formatting so great now I want to do is move on to that retriever so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=373" target="_blank">00:06:13.520</a></span> | <span class="t">remember in that visual before we had the pinecone vector database which led into the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=381" target="_blank">00:06:21.360</a></span> | <span class="t">MPNET table retriever model we're going to go ahead and initialize all of that so the retriever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=389" target="_blank">00:06:29.600</a></span> | <span class="t">we're going to be using this deep set all MPNET based v2 table model so we execute that as I said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=397" target="_blank">00:06:37.120</a></span> | <span class="t">this model has been fine tuned specifically on retrieving and embedding table like data and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=406" target="_blank">00:06:46.400</a></span> | <span class="t">matching those up to natural language queries now once that had downloaded we'll see this kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=413" target="_blank">00:06:53.680</a></span> | <span class="t">explainer or summary of the model so we have the MPNET transforming model fine-tuned specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=420" target="_blank">00:07:00.320</a></span> | <span class="t">for this we have the pooling method it is using mean pooling you can see that there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=426" target="_blank">00:07:06.960</a></span> | <span class="t">and there's a normalization after so because it has that normalization that means we can use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=432" target="_blank">00:07:12.240</a></span> | <span class="t">both cosine similarity which we can use if there is normalization or not and we can also use dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=440" target="_blank">00:07:20.240</a></span> | <span class="t">product similarity because we have that normalization component now this retriever does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=447" target="_blank">00:07:27.360</a></span> | <span class="t">expect tables to be in a particular format so we need to initialize this and let's have a look what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=453" target="_blank">00:07:33.440</a></span> | <span class="t">that format actually looks like so we are going to have something like this so looking again at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=461" target="_blank">00:07:41.840</a></span> | <span class="t">that same table at the top here we have the headers and then we have a new line character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=468" target="_blank">00:07:48.320</a></span> | <span class="t">okay and then we have the next row of the table all these separated by commas as you can see and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=474" target="_blank">00:07:54.240</a></span> | <span class="t">then we have a new line again so essentially we're just reformatting it into a comma separated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=481" target="_blank">00:08:01.120</a></span> | <span class="t">file format now the next thing we want to do is initialize our pinecone vector database for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=490" target="_blank">00:08:10.720</a></span> | <span class="t">we need an api key which is free and we can get it from this link here if you're in the notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=496" target="_blank">00:08:16.320</a></span> | <span class="t">or if not we just head on over to app.pinecone.io this will either lead you to a sign up or sign</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=506" target="_blank">00:08:26.240</a></span> | <span class="t">in page or it will lead to this if you're already signed up and what you need to do is head over to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=511" target="_blank">00:08:31.680</a></span> | <span class="t">your default project or any other project if you have other projects in there you go to api keys</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=519" target="_blank">00:08:39.600</a></span> | <span class="t">go to default here and you want to copy this and then you need to just paste it into here now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=526" target="_blank">00:08:46.720</a></span> | <span class="t">i have pasted mine into a variable called apig so i can add that in there run this and that just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=535" target="_blank">00:08:55.920</a></span> | <span class="t">initializes our connection to pinecone from there what we need to do is create a new vector index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=542" target="_blank">00:09:02.800</a></span> | <span class="t">we're going to store all of these formatted table objects but after they've been encoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=549" target="_blank">00:09:09.920</a></span> | <span class="t">by our retriever model so i'm going to call my index table qa i'm going to use cosine here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=557" target="_blank">00:09:17.040</a></span> | <span class="t">although like i said before we also use dot product similarity dimensionality this just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=562" target="_blank">00:09:22.640</a></span> | <span class="t">aligns with the model so we can actually see that if we do model dot get sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=571" target="_blank">00:09:31.280</a></span> | <span class="t">embedding some dimension or retriever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=575" target="_blank">00:09:35.760</a></span> | <span class="t">okay and then we get this seven six eight so we could also put that in here if we wanted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=584" target="_blank">00:09:44.480</a></span> | <span class="t">so rather than hard coding it you can just do this and yeah we run that for me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=590" target="_blank">00:09:50.640</a></span> | <span class="t">i've already created this index so that will happen very quickly if you haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=596" target="_blank">00:09:56.640</a></span> | <span class="t">created the index that will probably take like 10-15 seconds to run then what we want to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=602" target="_blank">00:10:02.960</a></span> | <span class="t">we're essentially going to go through our entire data set in batches of 64 we are going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=609" target="_blank">00:10:09.840</a></span> | <span class="t">get our process tables we're going to then encode them using our retrieve model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=619" target="_blank">00:10:19.360</a></span> | <span class="t">and the output of that we need to convert into a list for pinecone we're going to create a set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=625" target="_blank">00:10:25.840</a></span> | <span class="t">of unique ids now this is just a count if you prefer you can use something else but this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=632" target="_blank">00:10:32.160</a></span> | <span class="t">this works for this example so leave it with that we add all those into what we call an upsert list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=641" target="_blank">00:10:41.360</a></span> | <span class="t">so we're just going to pass the ids and embeddings we could also if you wanted to saw we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=647" target="_blank">00:10:47.520</a></span> | <span class="t">store the tables locally we could also saw the plain text version of the tables in a metadata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=655" target="_blank">00:10:55.040</a></span> | <span class="t">dictionary and upload those but we're not going to do that we're just going to use the local ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=661" target="_blank">00:11:01.280</a></span> | <span class="t">for the sake of simplicity and then what we want to do is just upsert all these into pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=667" target="_blank">00:11:07.680</a></span> | <span class="t">we would run that that will take a little bit of time i don't think too long maybe six or seven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=674" target="_blank">00:11:14.800</a></span> | <span class="t">minutes on colab but i have already run it so okay i can see it's working again here so now i'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=682" target="_blank">00:11:22.320</a></span> | <span class="t">going to stop it because all of these have already been uploaded into my vector index now what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=689" target="_blank">00:11:29.760</a></span> | <span class="t">going to do is begin asking questions so this is not the full what we're doing right now we're just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=696" target="_blank">00:11:36.400</a></span> | <span class="t">we have the vector database and we have the retriever we don't have the later table reader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=702" target="_blank">00:11:42.080</a></span> | <span class="t">and we're going to implement that in a moment but for now i just want to see is it going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=705" target="_blank">00:11:45.840</a></span> | <span class="t">return the correct table for us so we're going to say what was the gdp of china in 2020 we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=713" target="_blank">00:11:53.520</a></span> | <span class="t">to encode that using the retriever to create our query vector and then we're going to pass that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=720" target="_blank">00:12:00.480</a></span> | <span class="t">to pinecone and we're just going to return the top table we could return several tables if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=726" target="_blank">00:12:06.080</a></span> | <span class="t">wanted to return 100 if you wanted but we're just going to be applying a reader to a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=732" target="_blank">00:12:12.560</a></span> | <span class="t">table so i'm going to go with that for now okay and you see that we get this id here now this id</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=741" target="_blank">00:12:21.440</a></span> | <span class="t">is like i said it was a count that we created earlier so we can actually use that value in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=747" target="_blank">00:12:27.360</a></span> | <span class="t">order to extract from our tables that we created earlier the tables variable we can just extract</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=754" target="_blank">00:12:34.800</a></span> | <span class="t">that specific item and you can see that it does seem to give us a pretty relevant table so right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=763" target="_blank">00:12:43.360</a></span> | <span class="t">top here of china and we have their millions of usd in gdp and the year as well which is 2020 so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=770" target="_blank">00:12:50.720</a></span> | <span class="t">that looks pretty accurate okay so we've retrieved the correct table now what we need to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=778" target="_blank">00:12:58.000</a></span> | <span class="t">extract that specific piece of information using our table reader model now for the table reader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=785" target="_blank">00:13:05.520</a></span> | <span class="t">model we're going to be using a tapas model that has been fine-tuned for this specific task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=790" target="_blank">00:13:10.560</a></span> | <span class="t">and to do that we we need this so we are going to use the model name google tapas base fine-tuned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=802" target="_blank">00:13:22.320</a></span> | <span class="t">wtq and we're going to be using the hug and face transformers library and we need to initialize a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=810" target="_blank">00:13:30.400</a></span> | <span class="t">tapas tokenizer which is going to convert our natural language query and the tables themselves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=818" target="_blank">00:13:38.160</a></span> | <span class="t">into tokens or token ids they get passed into this tapas for question answering which is a tapas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=826" target="_blank">00:13:46.160</a></span> | <span class="t">transform model followed by a question answering head and it'll basically go through all those and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=832" target="_blank">00:13:52.240</a></span> | <span class="t">it will identify the specific part of the table that answers our question and it can also do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=838" target="_blank">00:13:58.400</a></span> | <span class="t">things like say whether we need to sum certain values within that table or whether we need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=843" target="_blank">00:14:03.440</a></span> | <span class="t">average them or do all these different operations which is pretty impressive in my opinion at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=849" target="_blank">00:14:09.840</a></span> | <span class="t">so we're going to package all that up into this pipeline here which is a table question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=855" target="_blank">00:14:15.760</a></span> | <span class="t">answering pipeline and it would just include our model and the tokenizer we run that and then what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=861" target="_blank">00:14:21.200</a></span> | <span class="t">we can do is we'll pass the table that we retrieved okay so the china gdp table we pass that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=869" target="_blank">00:14:29.360</a></span> | <span class="t">and we also pass our query which is what is the gdp of china in 2020 okay and run that okay cool so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=880" target="_blank">00:14:40.000</a></span> | <span class="t">you see that it wants us to take the average over one cell okay so it is correct that we should just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=889" target="_blank">00:14:49.280</a></span> | <span class="t">take the average over this one cell because that is our answer so the 27.8 million million i think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=896" target="_blank">00:14:56.240</a></span> | <span class="t">it is in usd so if we come up here we can see it right there okay so that is our answer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=904" target="_blank">00:15:04.320</a></span> | <span class="t">now what i want to do is i want to ask more questions okay i'm going to ask more questions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=909" target="_blank">00:15:09.920</a></span> | <span class="t">but i want to do it a lot more efficiently than writing all that code out again so i'm just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=915" target="_blank">00:15:15.280</a></span> | <span class="t">to create a few functions here that will help us so query pine cone which is going to retrieve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=922" target="_blank">00:15:22.800</a></span> | <span class="t">the relevant information and then match that up to a particular table return that to us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=930" target="_blank">00:15:30.800</a></span> | <span class="t">and then we want this which is just get the answer of the table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=935" target="_blank">00:15:35.680</a></span> | <span class="t">and that is just going to feed everything into our pipe and return those answers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=940" target="_blank">00:15:40.320</a></span> | <span class="t">okay so for this first question i'm saying which car manufacturers produce cars with top speed of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=950" target="_blank">00:15:50.400</a></span> | <span class="t">above 108 kilometers per hour now you can see that this is again a super relevant table and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=958" target="_blank">00:15:58.080</a></span> | <span class="t">this is already at least for me impressive in itself that is managing to get this and we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=963" target="_blank">00:16:03.840</a></span> | <span class="t">see max weight okay 220 190 185 186 so there's four manufacturers that do that that is fiat bugatti</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=976" target="_blank">00:16:16.720</a></span> | <span class="t">bend and miller so we come down here and we're going to do get answer from table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=985" target="_blank">00:16:25.280</a></span> | <span class="t">and we get this so fiat bugatti bends and miller is our answer there's no aggregator this is text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=992" target="_blank">00:16:32.000</a></span> | <span class="t">so it's saying okay you don't need to average or do anything here these are just the answers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=997" target="_blank">00:16:37.280</a></span> | <span class="t">okay let's do another one which scientist is known for improving the seam engine okay and we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1005" target="_blank">00:16:45.600</a></span> | <span class="t">in this table if we have a look here for improving the seam engine so we should expect the answer to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1010" target="_blank">00:16:50.640</a></span> | <span class="t">be george henry callis let's get the answer from the table george henry callis pretty cool let's do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1019" target="_blank">00:16:59.680</a></span> | <span class="t">another one another kind of simple query and we'll move on to more advanced queries so what is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1024" target="_blank">00:17:04.320</a></span> | <span class="t">maldivian island name for obluse select at sanghelli resort okay and we can see obluse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1032" target="_blank">00:17:12.960</a></span> | <span class="t">let at sanghelli and we have akiri fushi it's probably terrible pronunciation i'm very sorry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1042" target="_blank">00:17:22.560</a></span> | <span class="t">to any maldivians watching this and yeah we get the right answer of course so that in itself is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1051" target="_blank">00:17:31.920</a></span> | <span class="t">already really impressive but it actually doesn't stop there it gets even more insane than this we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1057" target="_blank">00:17:37.600</a></span> | <span class="t">can start asking really more complex questions that take sort of more than one step for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1064" target="_blank">00:17:44.560</a></span> | <span class="t">model to figure out so i want to say what was the total gdp of china and indonesia in 2020 okay let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1072" target="_blank">00:17:52.800</a></span> | <span class="t">query we should get the same table that we got before yes we do and then we want to get the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1079" target="_blank">00:17:59.200</a></span> | <span class="t">answer from this table and we get this so we get this aggregator sum so it sounds to sum these two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1088" target="_blank">00:18:08.240</a></span> | <span class="t">values here okay so the 27.8 million and 3.8 million and you can see here that these this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1097" target="_blank">00:18:17.760</a></span> | <span class="t">correct right so we could just maybe add a little bit of a wrapper function that consumes different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1104" target="_blank">00:18:24.000</a></span> | <span class="t">types of aggregators like some or average and just handles that little bit of logic at the end there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1110" target="_blank">00:18:30.960</a></span> | <span class="t">and we have our answer which is insane so that is that's another thing really really impressive and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1119" target="_blank">00:18:39.440</a></span> | <span class="t">it's not just some we actually kind of saw this earlier although it wasn't in that used in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1125" target="_blank">00:18:45.200</a></span> | <span class="t">right way but let's have a look at this what is the average carbon emission of power stations in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1131" target="_blank">00:18:51.440</a></span> | <span class="t">australia canada and germany okay let's take a look okay looks pretty accurate although this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1143" target="_blank">00:19:03.920</a></span> | <span class="t">just like a random selection of different power stations in these different countries so it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1149" target="_blank">00:19:09.760</a></span> | <span class="t">perfect but nonetheless we can we can go with this and then we can see okay we have an aggregator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1156" target="_blank">00:19:16.720</a></span> | <span class="t">average and we need to average over these values here so number one is not being very good who is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1164" target="_blank">00:19:24.240</a></span> | <span class="t">that australia yeah very bad but that is really impressive at least to me i was pretty blown away</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1176" target="_blank">00:19:36.240</a></span> | <span class="t">with this example so that's it for this video i hope this has been interesting and useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1185" target="_blank">00:19:45.360</a></span> | <span class="t">it definitely is for me i'm really enjoying seeing how we can actually apply question answering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1190" target="_blank">00:19:50.960</a></span> | <span class="t">to tables and even more so with the little aggregations at the end very little feature</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1196" target="_blank">00:19:56.640</a></span> | <span class="t">but i think makes a pretty big difference so thank you very much for watching the video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1203" target="_blank">00:20:03.120</a></span> | <span class="t">i hope it has been useful and i will see you again in the next one bye</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1216" target="_blank">00:20:16.880</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=Fb-6K00SUtc&t=1218" target="_blank">00:20:18.940</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>