<html><head><title>Advanced Sentiment Analysis with NLP Transformers + Vector Search</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Advanced Sentiment Analysis with NLP Transformers + Vector Search</h2><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs"><img src="https://i.ytimg.com/vi/iIGlAsN1nEs/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=31">0:31</a> What we will build<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=181">3:1</a> Code links and prerequisites<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=256">4:16</a> Dataset download and preprocessing<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=349">5:49</a> Using RoBERTa sentiment analysis model<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=495">8:15</a> Retriever model for building dense vectors<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=579">9:39</a> Create Pinecone vector index<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=700">11:40</a> Sentiment scores, vectors, and indexing<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1055">17:35</a> Sentiment analysis / opinion mining<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1243">20:43</a> Sentiment analysis with specific date range<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1304">21:44</a> Sentiment analysis on specific info<br><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1438">23:58</a> Final notes<br><br><div style="text-align: left;"><a href="./iIGlAsN1nEs.html">Whisper Transcript</a> | <a href="./transcript_iIGlAsN1nEs.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we're going to learn how to do sentiment mining using vector search and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=6" target="_blank">00:00:06.140</a></span> | <span class="t">transform models. At the core of this we have sentiment analysis. Now sentiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=11" target="_blank">00:00:11.040</a></span> | <span class="t">analysis is a NLP technique where we essentially want to extract the emotion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=18" target="_blank">00:00:18.720</a></span> | <span class="t">or the sentiment behind some text. Naturally this makes it a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=24" target="_blank">00:00:24.000</a></span> | <span class="t">interesting and useful tool when it comes to analyzing a ton of language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=30" target="_blank">00:00:30.280</a></span> | <span class="t">text data. And here we're gonna have a look at how to apply sentiment analysis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=37" target="_blank">00:00:37.720</a></span> | <span class="t">and more specifically sentiment mining to the hotel industry so that we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=43" target="_blank">00:00:43.140</a></span> | <span class="t">understand customer perception through hotel reviews. With this we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=48" target="_blank">00:00:48.640</a></span> | <span class="t">identify the perfect hotel for whatever it is we want. Or from the other side, from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=54" target="_blank">00:00:54.680</a></span> | <span class="t">the hotel management side, we can analyze customer reviews and maybe identify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=61" target="_blank">00:01:01.240</a></span> | <span class="t">areas that are pretty strong and other areas that could do a bit of work. So the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=66" target="_blank">00:01:06.040</a></span> | <span class="t">idea here is we're gonna take a ton of these customer reviews for different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=70" target="_blank">00:01:10.080</a></span> | <span class="t">hotels and apply this technique to them. But of course we don't have to restrict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=76" target="_blank">00:01:16.120</a></span> | <span class="t">this to reviews, although we can we can do product reviews for example. But we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=81" target="_blank">00:01:21.400</a></span> | <span class="t">can actually apply this to any text where we want to extract sentiment and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=85" target="_blank">00:01:25.840</a></span> | <span class="t">maybe you want to analyze different ideas or features within that data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=92" target="_blank">00:01:32.760</a></span> | <span class="t">So the hotel example maybe you want to have a look at whether people think our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=97" target="_blank">00:01:37.560</a></span> | <span class="t">room sizes are good or whether they like the breakfast and we could do that with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=102" target="_blank">00:01:42.800</a></span> | <span class="t">this sentiment mining. So to do that we are essentially going to take all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=109" target="_blank">00:01:49.080</a></span> | <span class="t">these reviews we're going to embed them using something called a sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=114" target="_blank">00:01:54.280</a></span> | <span class="t">transformer model. We're going to index those within a vector database and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=118" target="_blank">00:01:58.880</a></span> | <span class="t">going to search for things like "are customers satisfied with room sizes for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=125" target="_blank">00:02:05.040</a></span> | <span class="t">hotels in London" and that will return a set of reviews that are relevant to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=133" target="_blank">00:02:13.080</a></span> | <span class="t">particular query and then assess the general sentiment around them. Now we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=138" target="_blank">00:02:18.620</a></span> | <span class="t">also pair this with metadata which is just attached bits of information to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=144" target="_blank">00:02:24.160</a></span> | <span class="t">each vector or piece or record within our vector database and we could use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=149" target="_blank">00:02:29.680</a></span> | <span class="t">that to maybe visualize the sentiment across different hotels. Or we could even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=154" target="_blank">00:02:34.200</a></span> | <span class="t">take that a little further and use something called metadata filtering to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=157" target="_blank">00:02:37.680</a></span> | <span class="t">for example look at reviews over time and we could use that to look at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=163" target="_blank">00:02:43.360</a></span> | <span class="t">sentiment of different hotels or different aspects with each of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=168" target="_blank">00:02:48.240</a></span> | <span class="t">hotels over time and see if things are either improving or getting worse and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=173" target="_blank">00:02:53.520</a></span> | <span class="t">on. But we'll look at all of that in a lot more detail towards the end of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=177" target="_blank">00:02:57.280</a></span> | <span class="t">video. For now what we're going to do is have a look at the actual notebook that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=181" target="_blank">00:03:01.760</a></span> | <span class="t">we are going to be going through. So if you'd like to follow along with me you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=186" target="_blank">00:03:06.360</a></span> | <span class="t">can actually get the notebook either in the description of this video or you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=192" target="_blank">00:03:12.280</a></span> | <span class="t">go over to here pinecone.io/docs/examples/sentiment-mining and up at the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=199" target="_blank">00:03:19.040</a></span> | <span class="t">here you can either get the notebook on github or you can click over here to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=204" target="_blank">00:03:24.680</a></span> | <span class="t">open it in Colab which is what I'm going to be running through. Now credit for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=209" target="_blank">00:03:29.080</a></span> | <span class="t">this idea and notebook goes to usherac again so it's a really cool example and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=216" target="_blank">00:03:36.280</a></span> | <span class="t">it's really useful. So we'll start going through it now. So the first thing we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=221" target="_blank">00:03:41.120</a></span> | <span class="t">need to do is install any dependencies that we have. So we have a few here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=226" target="_blank">00:03:46.240</a></span> | <span class="t">mainly sentence transformers, PyHandClient, datasets which we can pull</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=231" target="_blank">00:03:51.480</a></span> | <span class="t">everything from and then for visualizations seaborn and matplotlib.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=235" target="_blank">00:03:55.640</a></span> | <span class="t">So we run that and one other thing we should also check if you are running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=240" target="_blank">00:04:00.480</a></span> | <span class="t">this in Colab is in your runtime go over to change runtime type and just make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=246" target="_blank">00:04:06.800</a></span> | <span class="t">sure that you have the hardware accelerator on GPU here. So if you do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=252" target="_blank">00:04:12.120</a></span> | <span class="t">need to switch you just have to restart and reinstall those prerequisites there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=256" target="_blank">00:04:16.720</a></span> | <span class="t">So once that is ready you can go to load and prepare dataset. So we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=262" target="_blank">00:04:22.040</a></span> | <span class="t">using this dataset that usherac is hosting on HuggingFace. So usherac</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=267" target="_blank">00:04:27.640</a></span> | <span class="t">hotel reviews. We're going to take the training split and we're just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=270" target="_blank">00:04:30.840</a></span> | <span class="t">convert it into a pandas data frame. So run this and once that has completed we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=277" target="_blank">00:04:37.200</a></span> | <span class="t">come down to here and some of these reviews can obviously be much longer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=284" target="_blank">00:04:44.280</a></span> | <span class="t">than others. So what we are going to do is just limit it to the first 800</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=290" target="_blank">00:04:50.400</a></span> | <span class="t">characters of each review because later on when we're creating our embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=295" target="_blank">00:04:55.200</a></span> | <span class="t">the models we will be using do have a maximum sequence length. So anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=301" target="_blank">00:05:01.120</a></span> | <span class="t">beyond that will get truncated anyway. So we're just going to do that now rather</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=306" target="_blank">00:05:06.200</a></span> | <span class="t">than later on. This will also help us when we later want to sort the text from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=313" target="_blank">00:05:13.240</a></span> | <span class="t">these reviews in the Pinecone Vector database there are size limits to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=318" target="_blank">00:05:18.840</a></span> | <span class="t">So by cutting down the length here we're going to make sure that we definitely do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=325" target="_blank">00:05:25.080</a></span> | <span class="t">not go over that. So here we can see we have a single hotel here there are several in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=330" target="_blank">00:05:30.400</a></span> | <span class="t">this dataset and we just have the reviews. So you can see it's just natural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=336" target="_blank">00:05:36.480</a></span> | <span class="t">language here there's nothing specific there are no like star ratings or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=342" target="_blank">00:05:42.200</a></span> | <span class="t">anything here. So we really have to rely on the natural language of these reviews</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=346" target="_blank">00:05:46.360</a></span> | <span class="t">and sentiment analysis to actually understand those. So we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=350" target="_blank">00:05:50.800</a></span> | <span class="t">initialize our sentiment analysis model. We're going to be using Roberta here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=355" target="_blank">00:05:55.240</a></span> | <span class="t">it has been fine-tuned specifically for this. So what we're going to do is we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=360" target="_blank">00:06:00.800</a></span> | <span class="t">going to set our device to GPU if it is available. It may not be but if you are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=366" target="_blank">00:06:06.960</a></span> | <span class="t">using Colab and you set the runtime up here you should be able to get that. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=371" target="_blank">00:06:11.480</a></span> | <span class="t">this here is just using the CUDA zero device. Okay and then from Transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=377" target="_blank">00:06:17.560</a></span> | <span class="t">we're going to import a few things. We've got a pipeline which is going to be our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=381" target="_blank">00:06:21.120</a></span> | <span class="t">sentiment analysis pipeline later on. We have a tokenizer and a model for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=386" target="_blank">00:06:26.440</a></span> | <span class="t">sequence classification which is our again our sentiment analysis model. Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=392" target="_blank">00:06:32.320</a></span> | <span class="t">so we're going to be using this Roberta based sentiment sentiment analysis model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=396" target="_blank">00:06:36.720</a></span> | <span class="t">We have three labels here so that's positive, negative and neutral. We're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=402" target="_blank">00:06:42.600</a></span> | <span class="t">going to load our tokenizer from HuggingFace and then we're going to load</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=406" target="_blank">00:06:46.520</a></span> | <span class="t">all of that into this pipeline here. So this sentiment analysis pipeline on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=411" target="_blank">00:06:51.360</a></span> | <span class="t">device that we've chosen already and that's everything. So that will just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=417" target="_blank">00:06:57.600</a></span> | <span class="t">package everything up into like really easy to use pipeline where we can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=421" target="_blank">00:07:01.280</a></span> | <span class="t">feed in some text and it's going to output us a little dictionary telling us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=425" target="_blank">00:07:05.680</a></span> | <span class="t">the sentiment of that text. Now we will need to map these so the output that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=433" target="_blank">00:07:13.720</a></span> | <span class="t">get will say either label 0, 1 or 2. That isn't obviously clear what that means so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=439" target="_blank">00:07:19.560</a></span> | <span class="t">we're just going to map those to their actual meanings which is negative,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=442" target="_blank">00:07:22.800</a></span> | <span class="t">neutral or positive. Then we take a look at this one. So room is small for a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=448" target="_blank">00:07:28.360</a></span> | <span class="t">superior room and poorly lit. No view, need better lighting. It's obviously not a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=453" target="_blank">00:07:33.360</a></span> | <span class="t">very good review. They're not particularly happy with the room. So let's run this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=459" target="_blank">00:07:39.520</a></span> | <span class="t">and we're going to see what we get. So I think I just need to run this again. Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=466" target="_blank">00:07:46.960</a></span> | <span class="t">and then come down here run again and you see that we get this label 0 and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=474" target="_blank">00:07:54.960</a></span> | <span class="t">that's a predicted sentiment and we get this score so the confidence. So if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=480" target="_blank">00:08:00.040</a></span> | <span class="t">come up here we can see label 0 is negative right? Label 0 negative. Cool so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=489" target="_blank">00:08:09.560</a></span> | <span class="t">77% confidence in this being negative and I think that's fair enough. Now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=496" target="_blank">00:08:16.400</a></span> | <span class="t">what we're going to do is initialize what's called a retriever model. So the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=499" target="_blank">00:08:19.560</a></span> | <span class="t">retriever model is going to handle the construction of our vector embeddings. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=505" target="_blank">00:08:25.200</a></span> | <span class="t">we're going to take all of these reviews we're going to convert them into what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=509" target="_blank">00:08:29.640</a></span> | <span class="t">are called dense vector embeddings and these are essentially a vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=516" target="_blank">00:08:36.080</a></span> | <span class="t">representation of the meaning behind each one of these reviews and what that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=522" target="_blank">00:08:42.360</a></span> | <span class="t">does is allows us to search for something based on its meaning. So the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=527" target="_blank">00:08:47.840</a></span> | <span class="t">earlier example I used which was something like hotel room sizes for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=532" target="_blank">00:08:52.280</a></span> | <span class="t">London hotels. We can search for that and return reviews that are relevant to that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=539" target="_blank">00:08:59.520</a></span> | <span class="t">particular query. That's not based on words being matched but the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=543" target="_blank">00:09:03.760</a></span> | <span class="t">meaning behind what we have said. So we're going to initialize a model for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=551" target="_blank">00:09:11.800</a></span> | <span class="t">that it's a sentence transformer it's a pretty small one this mini LM is like an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=556" target="_blank">00:09:16.800</a></span> | <span class="t">efficient smaller model but it still works very well. So we will download that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=563" target="_blank">00:09:23.080</a></span> | <span class="t">and we can see it creates these vector embeddings which are 384 dimensions in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=569" target="_blank">00:09:29.840</a></span> | <span class="t">size. So we're essentially taking our text and encoding all that meaning into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=575" target="_blank">00:09:35.520</a></span> | <span class="t">a 384 dimensional vector embedding. Okay and then what we need to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=581" target="_blank">00:09:41.400</a></span> | <span class="t">initialize a pinecone index. So this is going to be our vector database where we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=585" target="_blank">00:09:45.600</a></span> | <span class="t">going to store all of these vector embeddings. What we want to do here is we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=591" target="_blank">00:09:51.120</a></span> | <span class="t">first need to get an API key. Okay so we would go over to app.pinecone.io</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=599" target="_blank">00:09:59.320</a></span> | <span class="t">When you come into this you probably just have a single project. You</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=605" target="_blank">00:10:05.280</a></span> | <span class="t">may need to sign up and that's free so don't worry about that you sign up and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=609" target="_blank">00:10:09.600</a></span> | <span class="t">you'll probably have a single project here. That will be your name followed by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=613" target="_blank">00:10:13.840</a></span> | <span class="t">default project so like this one for me. I'll click on that and this will probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=619" target="_blank">00:10:19.800</a></span> | <span class="t">be empty which is fine because we're going to create an index but what we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=623" target="_blank">00:10:23.760</a></span> | <span class="t">need is we need to go to the API keys here. We need to go to copy key value and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=628" target="_blank">00:10:28.840</a></span> | <span class="t">then you just copy that value into here. Okay and that is your personal API key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=636" target="_blank">00:10:36.600</a></span> | <span class="t">Now for me I have stored that in a variable called API key. So I will run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=644" target="_blank">00:10:44.360</a></span> | <span class="t">that. That will connect and that initializes our connection to our pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=649" target="_blank">00:10:49.800</a></span> | <span class="t">project. Now what we can do is initialize a index. So for me I've actually already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=657" target="_blank">00:10:57.320</a></span> | <span class="t">created this in advance so this here will basically check if it already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=662" target="_blank">00:11:02.920</a></span> | <span class="t">exists. If it doesn't already exist it will create the index with these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=667" target="_blank">00:11:07.360</a></span> | <span class="t">parameters here. So dimensionality is at 384 that's the vector embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=672" target="_blank">00:11:12.640</a></span> | <span class="t">dimensionality of the model that we saw earlier and also the metric here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=677" target="_blank">00:11:17.960</a></span> | <span class="t">essentially how we compare each of the vectors within our vector index. So that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=683" target="_blank">00:11:23.600</a></span> | <span class="t">will depend on the retrieval model that you are using. In this case with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=689" target="_blank">00:11:29.200</a></span> | <span class="t">retrieval model we're using we need to use the cosine metric and once that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=693" target="_blank">00:11:33.400</a></span> | <span class="t">created or just identified as already existing we would connect to that index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=699" target="_blank">00:11:39.600</a></span> | <span class="t">like so. From here what we want to do is actually move on to generating our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=704" target="_blank">00:11:44.080</a></span> | <span class="t">embeddings. So what we are going to do here is take all of our reviews we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=710" target="_blank">00:11:50.120</a></span> | <span class="t">going to run them through our sentiment analysis model and get their sentiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=717" target="_blank">00:11:57.440</a></span> | <span class="t">scores whether they are positive, negative, neutral and we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=722" target="_blank">00:12:02.200</a></span> | <span class="t">that using this function here. So get sentiment and we'll just pass the reviews</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=727" target="_blank">00:12:07.560</a></span> | <span class="t">through there and we can see okay we take these first three reviews, run that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=735" target="_blank">00:12:15.560</a></span> | <span class="t">and we'll get the first three sentiments for those first three reviews. So we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=741" target="_blank">00:12:21.160</a></span> | <span class="t">the very first item is negative so if I let's have a look at what we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=747" target="_blank">00:12:27.160</a></span> | <span class="t">actually looking at there. So review</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=752" target="_blank">00:12:32.280</a></span> | <span class="t">first three so actually you can't see that there. Do this okay so this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=761" target="_blank">00:12:41.360</a></span> | <span class="t">first one yeah it looks pretty negative straight away. Number one so this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=766" target="_blank">00:12:46.940</a></span> | <span class="t">neutral one with a confidence score of 77. Yes just the location view doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=773" target="_blank">00:12:53.480</a></span> | <span class="t">really make any sense and number two positive and yeah I mean it's it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=779" target="_blank">00:12:59.760</a></span> | <span class="t">generally positive it's not not super over-the-top but they're saying it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=783" target="_blank">00:13:03.880</a></span> | <span class="t">pretty central I think and also it's very helpful. So that sounds pretty good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=790" target="_blank">00:13:10.080</a></span> | <span class="t">and there's a confidence of 89.7% there. So we're basically going to do that for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=796" target="_blank">00:13:16.320</a></span> | <span class="t">all of our data but there are a few other things that I want to be able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=800" target="_blank">00:13:20.760</a></span> | <span class="t">do here. So I want to be able to use metadata filtering to search through a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=805" target="_blank">00:13:25.680</a></span> | <span class="t">particular date range and to do that we need to get the timestamps from our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=811" target="_blank">00:13:31.120</a></span> | <span class="t">dataset. Now if we have a look at our dataset we can see that we have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=818" target="_blank">00:13:38.880</a></span> | <span class="t">review date but in order to be able to use those dates in Pinecone for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=825" target="_blank">00:13:45.760</a></span> | <span class="t">filtering like above a certain date or below a certain date we actually need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=829" target="_blank">00:13:49.560</a></span> | <span class="t">convert them into a number. So to do that we use the DateUtil parser and if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=838" target="_blank">00:13:58.320</a></span> | <span class="t">we just take one example so we're going to get the time some for review date 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=843" target="_blank">00:14:03.320</a></span> | <span class="t">so the first one if we have a look okay so we're going to take that and we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=855" target="_blank">00:14:15.120</a></span> | <span class="t">get the timestamp like so. Okay that would just allow us to compare all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=860" target="_blank">00:14:20.080</a></span> | <span class="t">dates using greater than, less than operators and so on. Now from here we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=867" target="_blank">00:14:27.840</a></span> | <span class="t">have everything we need so we can create our or we can get our sentiments, we can get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=875" target="_blank">00:14:35.200</a></span> | <span class="t">our dates and what we now do is actually create our embeddings, pull all that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=880" target="_blank">00:14:40.000</a></span> | <span class="t">together and then insert them into our Pinecone vector database. So we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=886" target="_blank">00:14:46.480</a></span> | <span class="t">to do this in batches of 64 there's two reasons for that, one to avoid putting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=892" target="_blank">00:14:52.720</a></span> | <span class="t">too much data into our sentence transformer at once which will basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=897" target="_blank">00:14:57.080</a></span> | <span class="t">cause an out-of-memory error and also to avoid sending too much data in one go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=903" target="_blank">00:15:03.040</a></span> | <span class="t">through the API calls to Pinecone. So we extract the batch from our data frame, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=911" target="_blank">00:15:11.920</a></span> | <span class="t">encode so this creates the embeddings for that batch, we then get the timestamp</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=918" target="_blank">00:15:18.320</a></span> | <span class="t">using the values that we saw before so that getTimeStamp function. We want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=924" target="_blank">00:15:24.640</a></span> | <span class="t">get the sentiment labels and scores here so this positive, negative, neutral and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=930" target="_blank">00:15:30.480</a></span> | <span class="t">actual confidence score. We get those and then we use this here to convert all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=935" target="_blank">00:15:35.320</a></span> | <span class="t">that into a metadata dictionary. So if I just show you very quickly what that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=940" target="_blank">00:15:40.240</a></span> | <span class="t">might look like, it will basically be something like label is equal to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=945" target="_blank">00:15:45.800</a></span> | <span class="t">positive for example. We would also have the date or timestamp, that'll be whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=955" target="_blank">00:15:55.240</a></span> | <span class="t">number there. We'll have a score and very important for us to be able to read the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=965" target="_blank">00:16:05.560</a></span> | <span class="t">review after is we'll also have the review. So that is essentially what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=972" target="_blank">00:16:12.360</a></span> | <span class="t">building within this meta variable here but it will actually be within a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=976" target="_blank">00:16:16.760</a></span> | <span class="t">and we'll have several of these dictionaries one after the other and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=982" target="_blank">00:16:22.600</a></span> | <span class="t">final thing that we need to do is just create some unique IDs. Now these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=985" target="_blank">00:16:25.880</a></span> | <span class="t">just numbers, there's nothing special there. Obviously if you have unique IDs that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=990" target="_blank">00:16:30.500</a></span> | <span class="t">need to use for your reviews or your data set, use those actual unique IDs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=996" target="_blank">00:16:36.160</a></span> | <span class="t">rather than just account like we're doing here. Then from there we add all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1000" target="_blank">00:16:40.640</a></span> | <span class="t">those into what we call the upsert list. So the upsert list is just a list of tuples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1005" target="_blank">00:16:45.920</a></span> | <span class="t">So we have the list here of the tuples and those tuples are the record ID and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1012" target="_blank">00:16:52.400</a></span> | <span class="t">the record dense vector and the record metadata and then we upsert all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1018" target="_blank">00:16:58.400</a></span> | <span class="t">in to Pineco. So let's go ahead and run that. Now as you can see this will take a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1026" target="_blank">00:17:06.080</a></span> | <span class="t">little bit of time so on here showing about 25 minutes which is not too long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1032" target="_blank">00:17:12.040</a></span> | <span class="t">but what I, I don't know where that long I've already done it so I am going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1037" target="_blank">00:17:17.440</a></span> | <span class="t">come here I'm gonna stop this and I'm just gonna take this to show you that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1041" target="_blank">00:17:21.800</a></span> | <span class="t">have everything in there already. Okay so describe index sets and we should see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1048" target="_blank">00:17:28.080</a></span> | <span class="t">okay total vector count we have 93.7 thousand items in there. Okay cool so now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1056" target="_blank">00:17:36.680</a></span> | <span class="t">what we can do is move on to our opinion mining or sentiment mining where we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1062" target="_blank">00:17:42.060</a></span> | <span class="t">essentially going to ask some questions and we're going to take a look and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1065" target="_blank">00:17:45.840</a></span> | <span class="t">analyze the sentiment for the hotel reviews based on what is we're searching</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1071" target="_blank">00:17:51.400</a></span> | <span class="t">for. So the first thing I want to search for which is what I mentioned right at the start is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1076" target="_blank">00:17:56.200</a></span> | <span class="t">room sizes. So are customers happy with room sizes for London hotels. So we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1084" target="_blank">00:18:04.160</a></span> | <span class="t">going to return 500 reviews that are relevant to this query. We're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1090" target="_blank">00:18:10.520</a></span> | <span class="t">include the metadata so that makes sure that we include the metadata that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1096" target="_blank">00:18:16.080</a></span> | <span class="t">index so the review text which is it's pretty useful for us to understand what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1100" target="_blank">00:18:20.640</a></span> | <span class="t">we're returning here. We also want to see the sentiment scores which is pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1106" target="_blank">00:18:26.960</a></span> | <span class="t">useful for actually analyzing what we're seeing here and the actual sentiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1112" target="_blank">00:18:32.080</a></span> | <span class="t">labels. So we can do that now that will return a little dictionary looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1120" target="_blank">00:18:40.160</a></span> | <span class="t">this. Okay so we can see here we have a ton of these actually so let's just have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1129" target="_blank">00:18:49.240</a></span> | <span class="t">a look at one. So we have the ID so 37796 like I said it's just a count so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1136" target="_blank">00:18:56.440</a></span> | <span class="t">the 37,000 item that we indexed. We have the hotel name that it's coming from so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1145" target="_blank">00:19:05.760</a></span> | <span class="t">also included that before. We have labels so this is a negative response and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1151" target="_blank">00:19:11.960</a></span> | <span class="t">is the actual taste of review. Did not like the first room offered was not in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1156" target="_blank">00:19:16.320</a></span> | <span class="t">hotel but over the road so yeah it doesn't seem that happy about it. It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1162" target="_blank">00:19:22.320</a></span> | <span class="t">happy with the manager but reception staffed it's not very happy with so a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1167" target="_blank">00:19:27.680</a></span> | <span class="t">bit of a mixed review but generally I think it seems kind of negative. Then down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1172" target="_blank">00:19:32.280</a></span> | <span class="t">here we have our timestamp which is what we use in order to do the metadata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1177" target="_blank">00:19:37.840</a></span> | <span class="t">filtering that you'll see later. Okay great so let's come down and what we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1183" target="_blank">00:19:43.080</a></span> | <span class="t">do we can run this. This is just showing a few of the reviews we already looked at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1189" target="_blank">00:19:49.280</a></span> | <span class="t">them so let's not go through that again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1193" target="_blank">00:19:53.240</a></span> | <span class="t">Okay and what we can do is we're just going to count the sentiment of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1199" target="_blank">00:19:59.400</a></span> | <span class="t">everything returned. So we have negative, neutral, positive you can see here we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1204" target="_blank">00:20:04.140</a></span> | <span class="t">have the labels here. So we're just going to count out of everything we return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1208" target="_blank">00:20:08.600</a></span> | <span class="t">what is the overall sentiment that we're seeing. So we run this or I think I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1217" target="_blank">00:20:17.160</a></span> | <span class="t">skipping ahead a little bit. I need to run this. Okay so you see you get negative,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1221" target="_blank">00:20:21.280</a></span> | <span class="t">neutral, positive, way more positive than anything else there. So surprisingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1226" target="_blank">00:20:26.960</a></span> | <span class="t">people are actually happy with the room sizes for London hotels but generally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1231" target="_blank">00:20:31.800</a></span> | <span class="t">speaking we don't want to just know this for all London hotels or maybe we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1236" target="_blank">00:20:36.120</a></span> | <span class="t">to be a little more specific in what we're searching for. So let's go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1240" target="_blank">00:20:40.080</a></span> | <span class="t">and see how we can do that. So first thing we want to look at is the metadata</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1245" target="_blank">00:20:45.320</a></span> | <span class="t">filtering for fine-tuning our search to a specific date range. So what we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1250" target="_blank">00:20:50.560</a></span> | <span class="t">is get a start time and end time. So we're going to do 2015 December so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1257" target="_blank">00:20:57.240</a></span> | <span class="t">Christmas up to the end of the year in 2015 as well and that will just generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1264" target="_blank">00:21:04.240</a></span> | <span class="t">those integer numbers that you saw before or there might be floats actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1269" target="_blank">00:21:09.320</a></span> | <span class="t">So the timestamps. Yep and we're basically going to say to Pinecone we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1274" target="_blank">00:21:14.920</a></span> | <span class="t">only want to search within the space where we have records that are either</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1279" target="_blank">00:21:19.040</a></span> | <span class="t">have a timestamp that is larger in this value or less than this value. So to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1285" target="_blank">00:21:25.180</a></span> | <span class="t">that we're going to add a filter timestamp greater than or equal to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1289" target="_blank">00:21:29.000</a></span> | <span class="t">start time or less than or equal to the end time. Run that and we're just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1294" target="_blank">00:21:34.160</a></span> | <span class="t">to plot our bar chart here and we see that during this time people still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1298" target="_blank">00:21:38.680</a></span> | <span class="t">generally quite positive although there's definitely a lot more negatives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1302" target="_blank">00:21:42.680</a></span> | <span class="t">within that time frame. So another thing we can do is actually apply the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1307" target="_blank">00:21:47.000</a></span> | <span class="t">thing to different hotels. So we'll apply that and what we're going to do is look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1312" target="_blank">00:21:52.400</a></span> | <span class="t">into five different areas. We're going to look at the room sizes, the cleanliness, staff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1316" target="_blank">00:21:56.880</a></span> | <span class="t">food and air conditioning. So what we do is we'll have a query for each one of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1323" target="_blank">00:22:03.000</a></span> | <span class="t">these. Are customers happy with room sizes? Are customers satisfied with cleanliness of rooms?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1327" target="_blank">00:22:07.920</a></span> | <span class="t">Essentially we're just taking each one of these parameters and we're reformatting it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1332" target="_blank">00:22:12.120</a></span> | <span class="t">into more of a natural language question. So we run this, come down and we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1340" target="_blank">00:22:20.240</a></span> | <span class="t">to go through each of the hotels that we pulled from up here. So Strand Palace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1346" target="_blank">00:22:26.440</a></span> | <span class="t">Hotel, Britannia, Grand Royale and so on and so on and we're just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1351" target="_blank">00:22:31.040</a></span> | <span class="t">iterate through those. We're going to filter for each one of those hotel names</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1355" target="_blank">00:22:35.020</a></span> | <span class="t">here so that we're returning results specific to each one of those hotels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1359" target="_blank">00:22:39.380</a></span> | <span class="t">We're going to make sure that we here we need to encode that query as we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1363" target="_blank">00:22:43.600</a></span> | <span class="t">before to create our query embedding. We're going to count the sentiment as we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1367" target="_blank">00:22:47.560</a></span> | <span class="t">did before and then we're going to store all of this into a set of results here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1372" target="_blank">00:22:52.680</a></span> | <span class="t">Okay so let's go and do this. Area by the way is just what we set up here. So room</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1379" target="_blank">00:22:59.720</a></span> | <span class="t">size, cleanliness and so on. So we'll go through each one of those and get our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1384" target="_blank">00:23:04.880</a></span> | <span class="t">results. Okay so that will run for a moment. Okay so 10 seconds to run there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1391" target="_blank">00:23:11.400</a></span> | <span class="t">and then what we can do is take a look. So we have all these results here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1396" target="_blank">00:23:16.400</a></span> | <span class="t">then we can go ahead and visualize that to make a little more sense of it and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1403" target="_blank">00:23:23.400</a></span> | <span class="t">there we go. So we have all the different parameters here. Room size, cleanliness,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1409" target="_blank">00:23:29.840</a></span> | <span class="t">staff, food, AC for each one of those hotels. So generally speaking looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1417" target="_blank">00:23:37.160</a></span> | <span class="t">everyone just loves Intercontinental London the O2. Grand Royale London Hyde</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1422" target="_blank">00:23:42.280</a></span> | <span class="t">Park seems pretty popular as well and we shouldn't never stay here especially if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1427" target="_blank">00:23:47.840</a></span> | <span class="t">you want AC. So you can go through and read each of these. These are just kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1432" target="_blank">00:23:52.760</a></span> | <span class="t">of like an analysis that we've pulled from each one of these results but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1438" target="_blank">00:23:58.640</a></span> | <span class="t">generally speaking you see really easily how useful sentiment mining can be. Just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1444" target="_blank">00:24:04.560</a></span> | <span class="t">analyzing the customer sentiment around in this case hotels but also products or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1451" target="_blank">00:24:11.040</a></span> | <span class="t">services or cafes you know all these different things and probably a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1456" target="_blank">00:24:16.040</a></span> | <span class="t">other things that have absolutely nothing to do with customer reviews and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1460" target="_blank">00:24:20.440</a></span> | <span class="t">we can of course also do this in pretty much near real time. So we can run our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1467" target="_blank">00:24:27.360</a></span> | <span class="t">sentiment analysis model on reviews coming in, upsert them into Pinecone and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1471" target="_blank">00:24:31.720</a></span> | <span class="t">that comes with a almost instant refresh. So we can then update these visuals and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1478" target="_blank">00:24:38.520</a></span> | <span class="t">our analysis over time in near real time which is pretty cool. So that's it for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1486" target="_blank">00:24:46.360</a></span> | <span class="t">this video, this example. I hope this has been interesting and useful. Thank you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1493" target="_blank">00:24:53.160</a></span> | <span class="t">very much for watching and I will see you again in the next one. Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1499" target="_blank">00:24:59.160</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1501" target="_blank">00:25:01.220</a></span> | <span class="t">you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1503" target="_blank">00:25:03.280</a></span> | <span class="t">(gentle music)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=iIGlAsN1nEs&t=1505" target="_blank">00:25:05.860</a></span> | <span class="t">you</span></div></div></body></html>