<html><head><title>Text Summarization with Google AI's T5 in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Text Summarization with Google AI's T5 in Python</h2><a href="https://www.youtube.com/watch?v=egDIqQIjDCI"><img src="https://i.ytimg.com/vi/egDIqQIjDCI/maxresdefault.jpg" style="width:50%;"></a><div><br></div><div style="text-align: left;"><a href="./egDIqQIjDCI.html">Whisper Transcript</a> | <a href="./transcript_egDIqQIjDCI.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi and welcome to this video on text summarization. We're going to go ahead and build a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=6" target="_blank">00:00:06.800</a></span> | <span class="t">really simple easy to use text summarizer using Google AI's T5 model. So this is insanely easy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=16" target="_blank">00:00:16.080</a></span> | <span class="t">to do. Altogether we actually only need seven lines of code and with that we can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=21" target="_blank">00:00:21.200</a></span> | <span class="t">summarize tech using Google's T5 model which is actually the cutting edge in terms of text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=28" target="_blank">00:00:28.480</a></span> | <span class="t">summarization at the moment. So it's really impressive that we can do this so easily and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=34" target="_blank">00:00:34.320</a></span> | <span class="t">we'll just run through really quickly and see what we can do. So we need to import Torch and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=42" target="_blank">00:00:42.240</a></span> | <span class="t">the Transformers library. And from the Transformers library we just need the auto tokenizer and auto</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=51" target="_blank">00:00:51.840</a></span> | <span class="t">model with LM head. Whilst they're importing we can initialize our tokenizer and model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=70" target="_blank">00:01:10.240</a></span> | <span class="t">So all we do for this is tokenizer and then we load our tokenizer from pre-trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=76" target="_blank">00:01:16.960</a></span> | <span class="t">And we will be using the T5 base model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=85" target="_blank">00:01:25.680</a></span> | <span class="t">Then we do the same for our model except with the auto model with LM head plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=99" target="_blank">00:01:39.360</a></span> | <span class="t">And we also need to make sure that we return a dictionary here as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=112" target="_blank">00:01:52.640</a></span> | <span class="t">Okay for this we're going to take some text from the PDF page about Winston Churchill.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=123" target="_blank">00:02:03.680</a></span> | <span class="t">And we will just take this text here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=131" target="_blank">00:02:11.920</a></span> | <span class="t">I've already formatted it over here so I'm just going to take this and paste it in. But this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=140" target="_blank">00:02:20.160</a></span> | <span class="t">exactly the same as what I highlighted just here without the numbers and headers. So we run that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=148" target="_blank">00:02:28.960</a></span> | <span class="t">and we simply build our input IDs. So all we're doing here is taking each of these words splitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=159" target="_blank">00:02:39.920</a></span> | <span class="t">them into tokens. So imagine if we split one sentence into a list of words we would have this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=166" target="_blank">00:02:46.800</a></span> | <span class="t">his first speech as prime minister. Each one of these words would be a separate token. So we split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=174" target="_blank">00:02:54.560</a></span> | <span class="t">them into those tokens and then we convert those tokens into unique identifier numbers. Each of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=181" target="_blank">00:03:01.440</a></span> | <span class="t">these identifying numbers will be used by the model to map that word, which is now a number,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=188" target="_blank">00:03:08.240</a></span> | <span class="t">to a vector that has been trained and represents that word. I've summarized at the front here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=196" target="_blank">00:03:16.000</a></span> | <span class="t">Followed by our sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=204" target="_blank">00:03:24.240</a></span> | <span class="t">Because we are using PyTorch we want to return PT tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=208" target="_blank">00:03:28.080</a></span> | <span class="t">And we set a max length of 512 tokens, which is the maximum number of tokens that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=221" target="_blank">00:03:41.920</a></span> | <span class="t">T5 can handle at once. Anything longer than this we would like to truncate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=232" target="_blank">00:03:52.240</a></span> | <span class="t">So now we can have a look at those inputs and we can see we have our tensor of input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=238" target="_blank">00:03:58.160</a></span> | <span class="t">Now we need to run these input IDs through our model. So we do model generate and this will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=248" target="_blank">00:04:08.640</a></span> | <span class="t">output a this will generate a certain number of output tokens which are also numeric representations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=256" target="_blank">00:04:16.800</a></span> | <span class="t">of the words. Now all we need to do here is pass our inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=262" target="_blank">00:04:22.480</a></span> | <span class="t">and then we give a max length and minimum length as well. This just tells the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=271" target="_blank">00:04:31.680</a></span> | <span class="t">we do not want anything longer than we're going to use 150 characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=276" target="_blank">00:04:36.400</a></span> | <span class="t">and anything less than 80 words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=286" target="_blank">00:04:46.160</a></span> | <span class="t">Now we have a length penalty parameter here as well. So the higher the number the more the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=292" target="_blank">00:04:52.560</a></span> | <span class="t">would be penalized for going either below or above that min and maximum length. We're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=298" target="_blank">00:04:58.640</a></span> | <span class="t">to use quite a high value here of 5. And we use two beams. Now what we also need to do here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=317" target="_blank">00:05:17.520</a></span> | <span class="t">actually pass these into another variable outputs and then when we want to access these outputs we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=325" target="_blank">00:05:25.440</a></span> | <span class="t">will use outputs 0 as this is the tensor containing our numeric word IDs. Now we can use tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=335" target="_blank">00:05:35.920</a></span> | <span class="t">again to decode our outputs. So this is converting our outputs from the numeric IDs into text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=343" target="_blank">00:05:43.920</a></span> | <span class="t">And we also want to give that to another variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=353" target="_blank">00:05:53.120</a></span> | <span class="t">Finally we can print our summary. And here we can see that the model has taken some of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=361" target="_blank">00:06:01.200</a></span> | <span class="t">information I think entirely from this second paragraph here and created a summary of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=370" target="_blank">00:06:10.560</a></span> | <span class="t">full text. Out of the box this is pretty good because if you read through this it includes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=376" target="_blank">00:06:16.320</a></span> | <span class="t">a lot of the main points. Now the first paragraph isn't that relevant and I would say the final</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=382" target="_blank">00:06:22.640</a></span> | <span class="t">paragraph is not either. Most of the information that we want from my point of view is in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=388" target="_blank">00:06:28.400</a></span> | <span class="t">second and third paragraph. Now the model has quite clearly only extracted information from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=394" target="_blank">00:06:34.880</a></span> | <span class="t">the second paragraph which is not ideal but for an out of box solution it still performed pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=400" target="_blank">00:06:40.640</a></span> | <span class="t">So that's it for this model. I hope this has been pretty useful and insightful as to how quickly we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=407" target="_blank">00:06:47.280</a></span> | <span class="t">can actually build a pretty good text summarizer and implement Google's T5 model in almost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=egDIqQIjDCI&t=414" target="_blank">00:06:54.160</a></span> | <span class="t">no lines of code. So I hope you enjoyed and I will see you in the next one.</span></div></div></body></html>