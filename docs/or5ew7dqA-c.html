<html><head><title>Fine-tune High Performance Sentence Transformers (with Multiple Negatives Ranking)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Fine-tune High Performance Sentence Transformers (with Multiple Negatives Ranking)</h2><a href="https://www.youtube.com/watch?v=or5ew7dqA-c"><img src="https://i.ytimg.com/vi/or5ew7dqA-c/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=62">1:2</a> NLI Training Data<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=176">2:56</a> Preprocessing<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=611">10:11</a> SBERT Finetuning Visuals<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=854">14:14</a> MNR Loss Visual<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=997">16:37</a> MNR in PyTorch<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1384">23:4</a> MNR in Sentence Transformers<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2060">34:20</a> Results<br><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2174">36:14</a> Outro<br><br><div style="text-align: left;"><a href="./or5ew7dqA-c.html">Whisper Transcript</a> | <a href="./transcript_or5ew7dqA-c.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi, welcome to the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1" target="_blank">00:00:01.760</a></span> | <span class="t">We're going to be having a look today</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=3" target="_blank">00:00:03.560</a></span> | <span class="t">at something called a multiple negatives ranking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=7" target="_blank">00:00:07.000</a></span> | <span class="t">loss, or MNL loss, for training sentence transformers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=11" target="_blank">00:00:11.880</a></span> | <span class="t">Now, if you're new to sentence transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=15" target="_blank">00:00:15.080</a></span> | <span class="t">they're essentially NLP models using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=18" target="_blank">00:00:18.440</a></span> | <span class="t">transformers that have been trained specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=20" target="_blank">00:00:20.480</a></span> | <span class="t">for building dense vector representations of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=26" target="_blank">00:00:26.040</a></span> | <span class="t">And the highest performing sentence transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=30" target="_blank">00:00:30.040</a></span> | <span class="t">at the moment are all trained using this method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=32" target="_blank">00:00:32.600</a></span> | <span class="t">So they're trained on a natural language inference data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=36" target="_blank">00:00:36.600</a></span> | <span class="t">and they are trained with MNL loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=40" target="_blank">00:00:40.640</a></span> | <span class="t">So in this video, we are going to learn about MNL loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=44" target="_blank">00:00:44.560</a></span> | <span class="t">how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=46" target="_blank">00:00:46.120</a></span> | <span class="t">We're going to work through a PyTorch example very quickly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=48" target="_blank">00:00:48.720</a></span> | <span class="t">and then we're going to look at how we can implement it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=51" target="_blank">00:00:51.080</a></span> | <span class="t">ourselves using the sentence transformers library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=54" target="_blank">00:00:54.400</a></span> | <span class="t">So let's jump straight into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=56" target="_blank">00:00:56.240</a></span> | <span class="t">So if you saw our previous article and video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=67" target="_blank">00:01:07.440</a></span> | <span class="t">you'll remember that we had a NLI data set, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=72" target="_blank">00:01:12.080</a></span> | <span class="t">is built from the Stanford NLI data set and the multi-genre NLI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=77" target="_blank">00:01:17.360</a></span> | <span class="t">data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=77" target="_blank">00:01:17.880</a></span> | <span class="t">We're using the same data set here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=80" target="_blank">00:01:20.280</a></span> | <span class="t">So in essence, all it is is a load of sentence pairs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=85" target="_blank">00:01:25.000</a></span> | <span class="t">and there is a label 0, 1, or 2, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=88" target="_blank">00:01:28.680</a></span> | <span class="t">indicates whether those sentence pairs either infer each other,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=94" target="_blank">00:01:34.240</a></span> | <span class="t">are not really related, like they could both be true,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=98" target="_blank">00:01:38.160</a></span> | <span class="t">but not necessarily because of each other,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=101" target="_blank">00:01:41.160</a></span> | <span class="t">or if they contradict each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=103" target="_blank">00:01:43.800</a></span> | <span class="t">So there are the three labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=105" target="_blank">00:01:45.640</a></span> | <span class="t">And what we covered in the previous video and article</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=109" target="_blank">00:01:49.440</a></span> | <span class="t">was something called softmax loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=111" target="_blank">00:01:51.080</a></span> | <span class="t">With softmax loss, we use those labels, the 0, 1, or 2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=117" target="_blank">00:01:57.400</a></span> | <span class="t">to produce a classification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=120" target="_blank">00:02:00.760</a></span> | <span class="t">We optimize on that label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=124" target="_blank">00:02:04.760</a></span> | <span class="t">Now, with MNR loss, we don't actually use those labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=129" target="_blank">00:02:09.280</a></span> | <span class="t">We just use the sentence pairs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=130" target="_blank">00:02:10.880</a></span> | <span class="t">And what I'm going to show you is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=134" target="_blank">00:02:14.160</a></span> | <span class="t">where we use something called a Siamese network, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=137" target="_blank">00:02:17.680</a></span> | <span class="t">means we only have an anchor and a positive sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=142" target="_blank">00:02:22.400</a></span> | <span class="t">Now, what that means is an anchor is a--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=147" target="_blank">00:02:27.320</a></span> | <span class="t">you can think of it as like a base sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=149" target="_blank">00:02:29.720</a></span> | <span class="t">And a positive to that anchor sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=154" target="_blank">00:02:34.200</a></span> | <span class="t">is just a sentence that indicates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=157" target="_blank">00:02:37.520</a></span> | <span class="t">that the anchor is true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=160" target="_blank">00:02:40.440</a></span> | <span class="t">Now, we could also have negatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=162" target="_blank">00:02:42.320</a></span> | <span class="t">And a negative would indicate that that anchor is not true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=166" target="_blank">00:02:46.840</a></span> | <span class="t">And we can extract that from the NMI data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=169" target="_blank">00:02:49.960</a></span> | <span class="t">So let's start pre-processing our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=174" target="_blank">00:02:54.080</a></span> | <span class="t">and have a look at what we need to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=177" target="_blank">00:02:57.480</a></span> | <span class="t">So this code here, we already wrote it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=181" target="_blank">00:03:01.160</a></span> | <span class="t">in the previous video and article.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=183" target="_blank">00:03:03.000</a></span> | <span class="t">But we're going to go through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=184" target="_blank">00:03:04.400</a></span> | <span class="t">So if you've never seen any of this before, it's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=186" target="_blank">00:03:06.960</a></span> | <span class="t">We're going to go through it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=188" target="_blank">00:03:08.120</a></span> | <span class="t">I'm going to explain everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=189" target="_blank">00:03:09.460</a></span> | <span class="t">It's not a problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=190" target="_blank">00:03:10.760</a></span> | <span class="t">So basically, up here, all I'm saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=193" target="_blank">00:03:13.680</a></span> | <span class="t">is what I just told you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=195" target="_blank">00:03:15.520</a></span> | <span class="t">So these are our labels in our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=198" target="_blank">00:03:18.280</a></span> | <span class="t">We have this 0, entailment, 1, neutral, and 2, contradiction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=203" target="_blank">00:03:23.760</a></span> | <span class="t">And then I'm just saying, if M and R,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=205" target="_blank">00:03:25.520</a></span> | <span class="t">we don't actually need those labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=207" target="_blank">00:03:27.760</a></span> | <span class="t">All we need are anchor-positive pairs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=210" target="_blank">00:03:30.040</a></span> | <span class="t">e.g. a pair where the premise suggests the hypothesis,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=214" target="_blank">00:03:34.800</a></span> | <span class="t">so where the positive indicates the anchor or the other way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=222" target="_blank">00:03:42.160</a></span> | <span class="t">around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=225" target="_blank">00:03:45.000</a></span> | <span class="t">So essentially, what we need are just rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=227" target="_blank">00:03:47.960</a></span> | <span class="t">where we have the label 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=230" target="_blank">00:03:50.400</a></span> | <span class="t">So we're going to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=231" target="_blank">00:03:51.600</a></span> | <span class="t">But first, we need to actually get our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=233" target="_blank">00:03:53.440</a></span> | <span class="t">So we're using the HugInface dataset library here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=237" target="_blank">00:03:57.000</a></span> | <span class="t">which is very good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=239" target="_blank">00:03:59.000</a></span> | <span class="t">And we're getting the Stanford Natural Language Inference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=242" target="_blank">00:04:02.640</a></span> | <span class="t">dataset here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=244" target="_blank">00:04:04.200</a></span> | <span class="t">Now, down here, this format you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=248" target="_blank">00:04:08.640</a></span> | <span class="t">is the format of the dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=250" target="_blank">00:04:10.840</a></span> | <span class="t">So we have these three features, premise, hypothesis,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=253" target="_blank">00:04:13.960</a></span> | <span class="t">and label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=255" target="_blank">00:04:15.160</a></span> | <span class="t">And if we come down here, we can see what one of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=257" target="_blank">00:04:17.440</a></span> | <span class="t">looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=257" target="_blank">00:04:17.940</a></span> | <span class="t">So we have premise, a person on a horse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=260" target="_blank">00:04:20.640</a></span> | <span class="t">jumped over a broken-down airplane,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=262" target="_blank">00:04:22.680</a></span> | <span class="t">and this hypothesis, a person is training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=264" target="_blank">00:04:24.840</a></span> | <span class="t">his horse for a competition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=266" target="_blank">00:04:26.480</a></span> | <span class="t">And the label for that is 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=268" target="_blank">00:04:28.440</a></span> | <span class="t">Come up here, 1 means neutral.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=269" target="_blank">00:04:29.880</a></span> | <span class="t">So basically, this here, a person</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=273" target="_blank">00:04:33.760</a></span> | <span class="t">is training his horse for a competition,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=275" target="_blank">00:04:35.440</a></span> | <span class="t">does not necessarily mean the person on a horse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=278" target="_blank">00:04:38.200</a></span> | <span class="t">is jumping over a broken-down airplane.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=281" target="_blank">00:04:41.480</a></span> | <span class="t">And then we come down here, and I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=283" target="_blank">00:04:43.120</a></span> | <span class="t">think this one's entailment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=285" target="_blank">00:04:45.160</a></span> | <span class="t">So this one is a pair that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=287" target="_blank">00:04:47.240</a></span> | <span class="t">This is an anchor positive pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=290" target="_blank">00:04:50.280</a></span> | <span class="t">And we have a person's outdoors on a horse,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=293" target="_blank">00:04:53.200</a></span> | <span class="t">and a person on a horse jumps over a broken-down airplane.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=295" target="_blank">00:04:55.880</a></span> | <span class="t">If they're jumping over a broken-down airplane,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=297" target="_blank">00:04:57.640</a></span> | <span class="t">they're probably outside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=298" target="_blank">00:04:58.680</a></span> | <span class="t">In fact, they-- well, almost definitely outside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=302" target="_blank">00:05:02.440</a></span> | <span class="t">So this indicates it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=306" target="_blank">00:05:06.560</a></span> | <span class="t">So this is an entailment, means it's an anchor positive pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=311" target="_blank">00:05:11.280</a></span> | <span class="t">So I said before, we have two data sets, not just one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=316" target="_blank">00:05:16.320</a></span> | <span class="t">So we have the Stanford Natural Language Inference Dataset,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=320" target="_blank">00:05:20.360</a></span> | <span class="t">and we also have the Multi-Genre Natural Language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=323" target="_blank">00:05:23.400</a></span> | <span class="t">Inference Dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=324" target="_blank">00:05:24.160</a></span> | <span class="t">And that's what we're getting here, MLI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=326" target="_blank">00:05:26.800</a></span> | <span class="t">So I'm just loading that with the Load Dataset here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=330" target="_blank">00:05:30.800</a></span> | <span class="t">We're loading it from the Glue Dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=333" target="_blank">00:05:33.480</a></span> | <span class="t">Within Glue, there is this MLI, which is the data that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=337" target="_blank">00:05:37.440</a></span> | <span class="t">And we're just getting the training data from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=339" target="_blank">00:05:39.820</a></span> | <span class="t">We don't-- because I think there's also--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=342" target="_blank">00:05:42.040</a></span> | <span class="t">maybe there's validation data, and there's also test data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=345" target="_blank">00:05:45.080</a></span> | <span class="t">We don't want that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=346" target="_blank">00:05:46.080</a></span> | <span class="t">We just want the training data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=348" target="_blank">00:05:48.520</a></span> | <span class="t">So we can see the format for this data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=353" target="_blank">00:05:53.120</a></span> | <span class="t">almost exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=354" target="_blank">00:05:54.760</a></span> | <span class="t">We just have this extra ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=359" target="_blank">00:05:59.000</a></span> | <span class="t">So what we can do is we just remove those columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=362" target="_blank">00:06:02.080</a></span> | <span class="t">So we MLI.RemoveColumns, and we specify</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=365" target="_blank">00:06:05.800</a></span> | <span class="t">that we don't want the ID column,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=367" target="_blank">00:06:07.640</a></span> | <span class="t">because we're going to merge these two data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=369" target="_blank">00:06:09.680</a></span> | <span class="t">But to merge them, they both need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=371" target="_blank">00:06:11.700</a></span> | <span class="t">to have the exact same format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=373" target="_blank">00:06:13.020</a></span> | <span class="t">So after that, what we do is we perform this Cast function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=380" target="_blank">00:06:20.660</a></span> | <span class="t">Now, if we didn't perform this Cast function--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=383" target="_blank">00:06:23.940</a></span> | <span class="t">let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=384" target="_blank">00:06:24.620</a></span> | <span class="t">So I need to run these anyway, so start running them now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=389" target="_blank">00:06:29.420</a></span> | <span class="t">Come down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=391" target="_blank">00:06:31.380</a></span> | <span class="t">I'm going to Load Dataset, Remove Columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=394" target="_blank">00:06:34.700</a></span> | <span class="t">And OK, let's say I'm not going to do this Cast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=398" target="_blank">00:06:38.180</a></span> | <span class="t">I'm just going to concatenate the data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=400" target="_blank">00:06:40.060</a></span> | <span class="t">I'm going to merge those two data sets together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=403" target="_blank">00:06:43.500</a></span> | <span class="t">I do that, and we get this arrow, InvalidError.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=407" target="_blank">00:06:47.440</a></span> | <span class="t">And the reason for that is because although those two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=410" target="_blank">00:06:50.220</a></span> | <span class="t">data sets look very similar, they're not actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=413" target="_blank">00:06:53.180</a></span> | <span class="t">exactly the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=414" target="_blank">00:06:54.780</a></span> | <span class="t">The data sets used in one of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=417" target="_blank">00:06:57.740</a></span> | <span class="t">includes this NotNull specification,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=421" target="_blank">00:07:01.700</a></span> | <span class="t">whereas the other one does not include that NotNull</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=424" target="_blank">00:07:04.500</a></span> | <span class="t">specification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=425" target="_blank">00:07:05.180</a></span> | <span class="t">So I assume that means that this other data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=429" target="_blank">00:07:09.020</a></span> | <span class="t">can include null values, whereas this one cannot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=432" target="_blank">00:07:12.020</a></span> | <span class="t">So we can't merge them both because they're not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=435" target="_blank">00:07:15.460</a></span> | <span class="t">the same data type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=437" target="_blank">00:07:17.180</a></span> | <span class="t">So what we do, we come up here, and we have to do this Cast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=440" target="_blank">00:07:20.340</a></span> | <span class="t">So we're Casting the features of the SNLY dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=445" target="_blank">00:07:25.260</a></span> | <span class="t">to be the same as the MNLY dataset features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=448" target="_blank">00:07:28.220</a></span> | <span class="t">So we do that, run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=449" target="_blank">00:07:29.900</a></span> | <span class="t">We come down here, we can run it again, and it will work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=455" target="_blank">00:07:35.740</a></span> | <span class="t">And now in Dataset, we have the full data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=460" target="_blank">00:07:40.940</a></span> | <span class="t">That's both MNLY and SNLY.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=464" target="_blank">00:07:44.660</a></span> | <span class="t">And you can see that because we have 943,000 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=469" target="_blank">00:07:49.940</a></span> | <span class="t">If you come up here, we only have 392 in the MNLY dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=474" target="_blank">00:07:54.260</a></span> | <span class="t">And up here, we have 550 in the SNLY dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=479" target="_blank">00:07:59.220</a></span> | <span class="t">So we have all the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=483" target="_blank">00:08:03.780</a></span> | <span class="t">And now in the previous video, an article I mentioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=489" target="_blank">00:08:09.900</a></span> | <span class="t">we have these negative 1 labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=494" target="_blank">00:08:14.940</a></span> | <span class="t">Now, this is an error in the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=498" target="_blank">00:08:18.620</a></span> | <span class="t">Or it's not an error, but it's where whoever labeled the data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=503" target="_blank">00:08:23.180</a></span> | <span class="t">they couldn't decide whether this was--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=506" target="_blank">00:08:26.980</a></span> | <span class="t">they couldn't decide on the nature of the relationship</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=510" target="_blank">00:08:30.060</a></span> | <span class="t">between the pair of sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=512" target="_blank">00:08:32.100</a></span> | <span class="t">So they just put minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=513" target="_blank">00:08:33.380</a></span> | <span class="t">There's not very few.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=514" target="_blank">00:08:34.500</a></span> | <span class="t">I think it's 700 or so sentences in there or pairs in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=519" target="_blank">00:08:39.740</a></span> | <span class="t">that are labeled with this minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=521" target="_blank">00:08:41.620</a></span> | <span class="t">But that's not a label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=523" target="_blank">00:08:43.980</a></span> | <span class="t">We can't do anything with that in our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=528" target="_blank">00:08:48.060</a></span> | <span class="t">Now, what we do is we use this filter method to remove.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=533" target="_blank">00:08:53.500</a></span> | <span class="t">So we say false for the row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=535" target="_blank">00:08:55.700</a></span> | <span class="t">So the row is false if the label is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=538" target="_blank">00:08:58.500</a></span> | <span class="t">equal to minus 1, which is saying that row is false,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=542" target="_blank">00:09:02.020</a></span> | <span class="t">e.g. we do not keep it if its label value is equal to minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=547" target="_blank">00:09:07.620</a></span> | <span class="t">Otherwise, we do keep it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=549" target="_blank">00:09:09.940</a></span> | <span class="t">Now, things are a bit different now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=552" target="_blank">00:09:12.100</a></span> | <span class="t">because we actually only want anchor positive pairs, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=557" target="_blank">00:09:17.220</a></span> | <span class="t">means we want to remove--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=559" target="_blank">00:09:19.660</a></span> | <span class="t">or we only want to keep the rows which have a 0 label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=564" target="_blank">00:09:24.820</a></span> | <span class="t">We want to remove everything else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=567" target="_blank">00:09:27.220</a></span> | <span class="t">So we need to modify this to just keep the 0 values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=575" target="_blank">00:09:35.060</a></span> | <span class="t">So we'll say, OK, false if x label is not equal to 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=584" target="_blank">00:09:44.660</a></span> | <span class="t">Else it's true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=585" target="_blank">00:09:45.660</a></span> | <span class="t">So this is going to keep only 0 values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=588" target="_blank">00:09:48.420</a></span> | <span class="t">and remove everything else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=590" target="_blank">00:09:50.220</a></span> | <span class="t">So that removes those error-less rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=592" target="_blank">00:09:52.980</a></span> | <span class="t">and also removes the neutral and contradiction rows as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=597" target="_blank">00:09:57.780</a></span> | <span class="t">Now, we remove that and let that run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=605" target="_blank">00:10:05.020</a></span> | <span class="t">Now, while that's running, let me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=607" target="_blank">00:10:07.020</a></span> | <span class="t">show you some visuals of how this will work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=611" target="_blank">00:10:11.900</a></span> | <span class="t">So what we have here is we have that anchor positive pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=618" target="_blank">00:10:18.580</a></span> | <span class="t">from before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=619" target="_blank">00:10:19.420</a></span> | <span class="t">So here, our anchor would be, I think, from i's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=625" target="_blank">00:10:25.580</a></span> | <span class="t">And the positive would be our hypothesis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=629" target="_blank">00:10:29.540</a></span> | <span class="t">But it would obviously only be rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=631" target="_blank">00:10:31.300</a></span> | <span class="t">where the label is equal to 0, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=638" target="_blank">00:10:38.380</a></span> | <span class="t">is the entailment label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=641" target="_blank">00:10:41.700</a></span> | <span class="t">Now, we have our anchor and positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=644" target="_blank">00:10:44.980</a></span> | <span class="t">And as we usually would with a transform model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=648" target="_blank">00:10:48.740</a></span> | <span class="t">we tokenize them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=650" target="_blank">00:10:50.300</a></span> | <span class="t">So we tokenize them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=652" target="_blank">00:10:52.740</a></span> | <span class="t">We're going to do that with just a tokenizer method,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=655" target="_blank">00:10:55.700</a></span> | <span class="t">a pre-trained tokenizer from the base transformers library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=661" target="_blank">00:11:01.100</a></span> | <span class="t">Or we do that if we're using PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=664" target="_blank">00:11:04.780</a></span> | <span class="t">If we're using the sentence transformers library,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=667" target="_blank">00:11:07.700</a></span> | <span class="t">it's a lot easier, and we don't actually need to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=670" target="_blank">00:11:10.060</a></span> | <span class="t">It will deal with that for us, which is quite nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=673" target="_blank">00:11:13.060</a></span> | <span class="t">And what that produces is just a tokenized version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=679" target="_blank">00:11:19.700</a></span> | <span class="t">of the anchor and the positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=682" target="_blank">00:11:22.140</a></span> | <span class="t">So here, we have our--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=683" target="_blank">00:11:23.700</a></span> | <span class="t">so I'm just going to put A for anchor, and over here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=687" target="_blank">00:11:27.340</a></span> | <span class="t">P for positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=689" target="_blank">00:11:29.140</a></span> | <span class="t">And then what happens next is we have a single BERT model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=696" target="_blank">00:11:36.140</a></span> | <span class="t">We actually visualize it as two BERT models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=699" target="_blank">00:11:39.100</a></span> | <span class="t">because we're processing the anchor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=702" target="_blank">00:11:42.020</a></span> | <span class="t">And then after we've processed the anchor data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=705" target="_blank">00:11:45.420</a></span> | <span class="t">we move on to processing the positive data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=709" target="_blank">00:11:49.060</a></span> | <span class="t">So it's like we're using-- for every single training step,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=711" target="_blank">00:11:51.940</a></span> | <span class="t">we're using the same BERT model twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=715" target="_blank">00:11:55.380</a></span> | <span class="t">So we process both of those through our BERT model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=719" target="_blank">00:11:59.380</a></span> | <span class="t">and that produces token embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=721" target="_blank">00:12:01.460</a></span> | <span class="t">So token embeddings are 512 dense vectors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=726" target="_blank">00:12:06.900</a></span> | <span class="t">which contains 168 dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=730" target="_blank">00:12:10.060</a></span> | <span class="t">And then we use something called a mean pooling function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=732" target="_blank">00:12:12.940</a></span> | <span class="t">So mean pooling function is, say we have some vectors here--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=739" target="_blank">00:12:19.420</a></span> | <span class="t">1, 2, and 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=743" target="_blank">00:12:23.300</a></span> | <span class="t">What we're going to do is take the mean value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=750" target="_blank">00:12:30.220</a></span> | <span class="t">across each dimension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=752" target="_blank">00:12:32.180</a></span> | <span class="t">So let's say we have three dimensions here in our--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=756" target="_blank">00:12:36.260</a></span> | <span class="t">no, that's a bad idea, because we have three vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=758" target="_blank">00:12:38.980</a></span> | <span class="t">Let's say we have five dimensions here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=763" target="_blank">00:12:43.780</a></span> | <span class="t">And we take the average across each of those dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=766" target="_blank">00:12:46.660</a></span> | <span class="t">And what we produce from that mean pooling operation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=771" target="_blank">00:12:51.500</a></span> | <span class="t">is a single five-dimensional vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=774" target="_blank">00:12:54.220</a></span> | <span class="t">So we have the mean of each of those--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=780" target="_blank">00:13:00.940</a></span> | <span class="t">across each of those dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=783" target="_blank">00:13:03.060</a></span> | <span class="t">That's the mean pooling operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=785" target="_blank">00:13:05.380</a></span> | <span class="t">And obviously, from that, we produce</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=787" target="_blank">00:13:07.300</a></span> | <span class="t">what is our sentence embedding, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=788" target="_blank">00:13:08.980</a></span> | <span class="t">is a single one-dimensional dense vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=793" target="_blank">00:13:13.700</a></span> | <span class="t">And we produce that sentence embedding both for A, our anchor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=797" target="_blank">00:13:17.940</a></span> | <span class="t">and for P, our positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=800" target="_blank">00:13:20.260</a></span> | <span class="t">And what we have here--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=807" target="_blank">00:13:27.140</a></span> | <span class="t">so I don't know if I mentioned it, but we--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=810" target="_blank">00:13:30.860</a></span> | <span class="t">so this is a Siamese network, this double network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=815" target="_blank">00:13:35.860</a></span> | <span class="t">And this triple network is a triplet network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=819" target="_blank">00:13:39.900</a></span> | <span class="t">And it works in the exact same way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=821" target="_blank">00:13:41.860</a></span> | <span class="t">but we also have a negative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=824" target="_blank">00:13:44.660</a></span> | <span class="t">So where before we had the contradiction label,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=830" target="_blank">00:13:50.740</a></span> | <span class="t">I think the label is 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=832" target="_blank">00:13:52.500</a></span> | <span class="t">But I could be wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=833" target="_blank">00:13:53.900</a></span> | <span class="t">I think it-- no, I think it is 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=837" target="_blank">00:13:57.340</a></span> | <span class="t">That would be a negative sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=841" target="_blank">00:14:01.260</a></span> | <span class="t">because it contradicts the anchor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=845" target="_blank">00:14:05.060</a></span> | <span class="t">And what we do is we process that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=848" target="_blank">00:14:08.060</a></span> | <span class="t">And then we would also get a negative vector--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=851" target="_blank">00:14:11.900</a></span> | <span class="t">negative sentence embedding at the end there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=854" target="_blank">00:14:14.460</a></span> | <span class="t">And what we do with that during training--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=857" target="_blank">00:14:17.300</a></span> | <span class="t">so the whole MNR loss thing, multiple negative ranking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=861" target="_blank">00:14:21.860</a></span> | <span class="t">thing--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=863" target="_blank">00:14:23.500</a></span> | <span class="t">is we take all of those vectors that we produce,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=867" target="_blank">00:14:27.540</a></span> | <span class="t">the A, which is the anchors, the P, and the N</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=872" target="_blank">00:14:32.260</a></span> | <span class="t">for the positive and negatives, if we're using negatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=876" target="_blank">00:14:36.260</a></span> | <span class="t">If not, we just basically blank out the dark blue part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=880" target="_blank">00:14:40.980</a></span> | <span class="t">of this visual.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=883" target="_blank">00:14:43.340</a></span> | <span class="t">All we do is we calculate the cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=888" target="_blank">00:14:48.100</a></span> | <span class="t">between our anchor and our positive,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=891" target="_blank">00:14:51.260</a></span> | <span class="t">and maybe our neutral negative as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=893" target="_blank">00:14:53.820</a></span> | <span class="t">But I'm just going to say I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=895" target="_blank">00:14:55.540</a></span> | <span class="t">to go through the anchor and positive version of it for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=900" target="_blank">00:15:00.220</a></span> | <span class="t">So we calculate the cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=902" target="_blank">00:15:02.340</a></span> | <span class="t">between the anchor and positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=904" target="_blank">00:15:04.540</a></span> | <span class="t">And we do that for every anchor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=907" target="_blank">00:15:07.980</a></span> | <span class="t">So anchor 0 for the first one, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=911" target="_blank">00:15:11.620</a></span> | <span class="t">would calculate the cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=913" target="_blank">00:15:13.180</a></span> | <span class="t">between anchor 0 and positive 0, 1, 2, 3, and 4, and so on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=920" target="_blank">00:15:20.180</a></span> | <span class="t">up until the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=922" target="_blank">00:15:22.260</a></span> | <span class="t">So what we have there is the actual--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=924" target="_blank">00:15:24.460</a></span> | <span class="t">so the number of sentence embeddings that we have there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=929" target="_blank">00:15:29.020</a></span> | <span class="t">is equal to the batch size that we are using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=932" target="_blank">00:15:32.380</a></span> | <span class="t">And obviously, what we would expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=934" target="_blank">00:15:34.700</a></span> | <span class="t">with our anchor and positive pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=936" target="_blank">00:15:36.660</a></span> | <span class="t">is that we would expect the cosine similarity between A0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=940" target="_blank">00:15:40.780</a></span> | <span class="t">and P0 to be greater than the cosine similarity between,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=945" target="_blank">00:15:45.100</a></span> | <span class="t">let's say, A0 and P1, or P2, or P3, or P4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=950" target="_blank">00:15:50.740</a></span> | <span class="t">And likewise, if we had A3, we would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=954" target="_blank">00:15:54.500</a></span> | <span class="t">expect the cosine similarity between A3 and P3</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=958" target="_blank">00:15:58.420</a></span> | <span class="t">to be greater than that between A3 and P0, or P1, or P2, or P4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=968" target="_blank">00:16:08.060</a></span> | <span class="t">So that's how we optimize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=969" target="_blank">00:16:09.620</a></span> | <span class="t">We say, OK, the target label for A0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=974" target="_blank">00:16:14.900</a></span> | <span class="t">is just going to have the greatest argmax value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=979" target="_blank">00:16:19.740</a></span> | <span class="t">with the value of P0, or with the pair P0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=984" target="_blank">00:16:24.340</a></span> | <span class="t">And for A3, it's going to be with P3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=988" target="_blank">00:16:28.540</a></span> | <span class="t">So the labels for this are actually just 0, 1, 2, 3, 4,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=993" target="_blank">00:16:33.100</a></span> | <span class="t">up until the batch size, which we will see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=995" target="_blank">00:16:35.980</a></span> | <span class="t">I'm going to show you that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=998" target="_blank">00:16:38.620</a></span> | <span class="t">OK, so here we have what is our involved MNR loss training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1006" target="_blank">00:16:46.220</a></span> | <span class="t">notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1007" target="_blank">00:16:47.180</a></span> | <span class="t">So I'm just going to take you through this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1008" target="_blank">00:16:48.980</a></span> | <span class="t">We're just using PyTorch rather than the Sentence Transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1011" target="_blank">00:16:51.740</a></span> | <span class="t">library here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1013" target="_blank">00:16:53.020</a></span> | <span class="t">Now, I'm going to go through, and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1015" target="_blank">00:16:55.740</a></span> | <span class="t">going to come to where we actually start training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1021" target="_blank">00:17:01.940</a></span> | <span class="t">So we have a mean pooling operation here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1025" target="_blank">00:17:05.660</a></span> | <span class="t">So I mentioned before we had that mean pooling function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1028" target="_blank">00:17:08.140</a></span> | <span class="t">where we're getting the average across dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1030" target="_blank">00:17:10.380</a></span> | <span class="t">That's what this is dealing with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1031" target="_blank">00:17:11.940</a></span> | <span class="t">The reason it looks more complicated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1033" target="_blank">00:17:13.380</a></span> | <span class="t">than just taking the average is because we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1035" target="_blank">00:17:15.100</a></span> | <span class="t">need to consider where we have padding values, where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1039" target="_blank">00:17:19.140</a></span> | <span class="t">the mask value is 0, because we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1044" target="_blank">00:17:24.340</a></span> | <span class="t">want to consider those in our average function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1046" target="_blank">00:17:26.700</a></span> | <span class="t">because then it's going to obviously bring down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1048" target="_blank">00:17:28.780</a></span> | <span class="t">our average a lot just for having more padding tokens,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1052" target="_blank">00:17:32.620</a></span> | <span class="t">which doesn't make sense, obviously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1054" target="_blank">00:17:34.820</a></span> | <span class="t">So that's why it looks more complicated than you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1057" target="_blank">00:17:37.860</a></span> | <span class="t">probably expect for an averaging function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1062" target="_blank">00:17:42.140</a></span> | <span class="t">And then so we're using PyTorch here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1064" target="_blank">00:17:44.300</a></span> | <span class="t">So we're moving some set model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1066" target="_blank">00:17:46.620</a></span> | <span class="t">It's just a BERT model that we're using here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1069" target="_blank">00:17:49.020</a></span> | <span class="t">plain, straight BERT model, nothing special about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1073" target="_blank">00:17:53.580</a></span> | <span class="t">I think it's BERT based on case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1076" target="_blank">00:17:56.700</a></span> | <span class="t">And just moving it to a CUDA GPU if we have one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1081" target="_blank">00:18:01.020</a></span> | <span class="t">So it is available, checking if it's available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1084" target="_blank">00:18:04.940</a></span> | <span class="t">And then here we're defining some layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1087" target="_blank">00:18:07.740</a></span> | <span class="t">that we're going to be using in MNR loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1090" target="_blank">00:18:10.740</a></span> | <span class="t">So we have the cosine similarity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1092" target="_blank">00:18:12.420</a></span> | <span class="t">I said before we're doing that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1094" target="_blank">00:18:14.020</a></span> | <span class="t">We're checking and calculating similarity between pairs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1097" target="_blank">00:18:17.420</a></span> | <span class="t">That's what we're doing here, just initializing that function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1101" target="_blank">00:18:21.020</a></span> | <span class="t">And we also have a loss function, of course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1103" target="_blank">00:18:23.220</a></span> | <span class="t">So here we're using a categorical cross-entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1107" target="_blank">00:18:27.540</a></span> | <span class="t">And we'll see how that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1109" target="_blank">00:18:29.820</a></span> | <span class="t">We can also use a scale function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1112" target="_blank">00:18:32.460</a></span> | <span class="t">So I think I thought I did use it a bit later on, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1117" target="_blank">00:18:37.460</a></span> | <span class="t">But it's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1120" target="_blank">00:18:40.020</a></span> | <span class="t">It's not really too important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1122" target="_blank">00:18:42.860</a></span> | <span class="t">But we just use that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1124" target="_blank">00:18:44.180</a></span> | <span class="t">We multiply our similarity score value by the scale value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1131" target="_blank">00:18:51.040</a></span> | <span class="t">later on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1132" target="_blank">00:18:52.980</a></span> | <span class="t">Down here, so we're using Transforms Optimization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1136" target="_blank">00:18:56.060</a></span> | <span class="t">So what we're doing here is we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1139" target="_blank">00:18:59.340</a></span> | <span class="t">saying, for the first 10% of the training data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1143" target="_blank">00:19:03.940</a></span> | <span class="t">I want to warm up to this learning rate of 2e to minus 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1148" target="_blank">00:19:08.780</a></span> | <span class="t">So we're not going to start at that learning rate initially.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1152" target="_blank">00:19:12.060</a></span> | <span class="t">We're going to slowly build up to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1153" target="_blank">00:19:13.900</a></span> | <span class="t">And yeah, that's all we're doing there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1159" target="_blank">00:19:19.480</a></span> | <span class="t">And we can see our batch here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1164" target="_blank">00:19:24.540</a></span> | <span class="t">So we have attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1168" target="_blank">00:19:28.100</a></span> | <span class="t">So sorry, we have the anchor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1169" target="_blank">00:19:29.540</a></span> | <span class="t">And in the anchor, we have our attention mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1171" target="_blank">00:19:31.420</a></span> | <span class="t">and we have our input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1173" target="_blank">00:19:33.780</a></span> | <span class="t">And then in positive, we also have the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1176" target="_blank">00:19:36.220</a></span> | <span class="t">We have attention mask and input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1178" target="_blank">00:19:38.740</a></span> | <span class="t">So input IDs and attention mask, if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1180" target="_blank">00:19:40.340</a></span> | <span class="t">use the Transformers library before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1182" target="_blank">00:19:42.140</a></span> | <span class="t">you probably recognize these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1183" target="_blank">00:19:43.780</a></span> | <span class="t">It's just the input tensors that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1186" target="_blank">00:19:46.140</a></span> | <span class="t">use when we're feeding text into a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1189" target="_blank">00:19:49.820</a></span> | <span class="t">So that's how our Transformer understands our text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1197" target="_blank">00:19:57.540</a></span> | <span class="t">Yeah, I'll just mention here what is in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1201" target="_blank">00:20:01.300</a></span> | <span class="t">And let's come down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1202" target="_blank">00:20:02.740</a></span> | <span class="t">Is there anything important?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1204" target="_blank">00:20:04.020</a></span> | <span class="t">I don't think so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1205" target="_blank">00:20:05.820</a></span> | <span class="t">OK, let's come down to the training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1207" target="_blank">00:20:07.860</a></span> | <span class="t">So yeah, using a scale value of 20 there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1212" target="_blank">00:20:12.980</a></span> | <span class="t">And we come to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1214" target="_blank">00:20:14.580</a></span> | <span class="t">So here, we have our anchor embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1219" target="_blank">00:20:19.540</a></span> | <span class="t">So these are sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1221" target="_blank">00:20:21.420</a></span> | <span class="t">So we have the anchor sentence embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1223" target="_blank">00:20:23.500</a></span> | <span class="t">and we have positive sentence embeddings, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1225" target="_blank">00:20:25.900</a></span> | <span class="t">we've output from our BERT model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1228" target="_blank">00:20:28.380</a></span> | <span class="t">And what we do, we do the mean pooling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1231" target="_blank">00:20:31.340</a></span> | <span class="t">So when I said sentence embeddings here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1233" target="_blank">00:20:33.700</a></span> | <span class="t">they are the token embeddings, sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1235" target="_blank">00:20:35.340</a></span> | <span class="t">So we have 512 token embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1237" target="_blank">00:20:37.860</a></span> | <span class="t">And then we do the mean pooling to get the sentence embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1242" target="_blank">00:20:42.500</a></span> | <span class="t">And then what we do is we calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1244" target="_blank">00:20:44.940</a></span> | <span class="t">the cosine similarity between each of our anchors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1249" target="_blank">00:20:49.660</a></span> | <span class="t">and all of the positive values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1252" target="_blank">00:20:52.860</a></span> | <span class="t">So we create that array of values of cosine similarities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1260" target="_blank">00:21:00.260</a></span> | <span class="t">And on each row, obviously, we would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1261" target="_blank">00:21:01.900</a></span> | <span class="t">expect the true pair to have the highest cosine similarity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1265" target="_blank">00:21:05.940</a></span> | <span class="t">So that is what we will do a little further down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1270" target="_blank">00:21:10.940</a></span> | <span class="t">So labels, what this value does here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1274" target="_blank">00:21:14.940</a></span> | <span class="t">is just outputs a tensor, which is 0, 1, 2, 3, 4,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1280" target="_blank">00:21:20.220</a></span> | <span class="t">up until the batch size of the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1285" target="_blank">00:21:25.340</a></span> | <span class="t">So that's where you'd expect the argmax value to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1291" target="_blank">00:21:31.100</a></span> | <span class="t">So for A3, you'd expect the maximum cosine similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1296" target="_blank">00:21:36.500</a></span> | <span class="t">to be in the third index, where P3, where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1299" target="_blank">00:21:39.980</a></span> | <span class="t">it's been compared to P3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1301" target="_blank">00:21:41.100</a></span> | <span class="t">And then here, we are calculating the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1308" target="_blank">00:21:48.620</a></span> | <span class="t">So we're calculating between the scores, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1312" target="_blank">00:21:52.820</a></span> | <span class="t">we have up here, and the labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1315" target="_blank">00:21:55.340</a></span> | <span class="t">So this is taking the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1318" target="_blank">00:21:58.540</a></span> | <span class="t">we're basically looking for this value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1320" target="_blank">00:22:00.700</a></span> | <span class="t">here to be the maximum value in a specific row at the index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1327" target="_blank">00:22:07.920</a></span> | <span class="t">equal to the current label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1330" target="_blank">00:22:10.360</a></span> | <span class="t">So that's the A3, P3 pair that I'm talking about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1334" target="_blank">00:22:14.940</a></span> | <span class="t">Now we're just optimizing on that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1336" target="_blank">00:22:16.460</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1337" target="_blank">00:22:17.620</a></span> | <span class="t">That's the order is to mnr loss in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1344" target="_blank">00:22:24.140</a></span> | <span class="t">But when I say that's order, it's actually quite a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1346" target="_blank">00:22:26.780</a></span> | <span class="t">I mean, there's a lot of code going into this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1348" target="_blank">00:22:28.860</a></span> | <span class="t">And it's very confusing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1352" target="_blank">00:22:32.140</a></span> | <span class="t">Oh, here is the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1353" target="_blank">00:22:33.620</a></span> | <span class="t">that's the labels tensor that I just mentioned, by the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1356" target="_blank">00:22:36.220</a></span> | <span class="t">So you can see it's just counting up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1357" target="_blank">00:22:37.780</a></span> | <span class="t">to our batch size, which is 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1360" target="_blank">00:22:40.460</a></span> | <span class="t">So that's the PyTorch implementation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1367" target="_blank">00:22:47.260</a></span> | <span class="t">But it's complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1369" target="_blank">00:22:49.780</a></span> | <span class="t">And to be honest, if you do the same with sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1373" target="_blank">00:22:53.760</a></span> | <span class="t">transformers, you're probably going to get better results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1376" target="_blank">00:22:56.420</a></span> | <span class="t">So I'm going to show you how to do that with sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1380" target="_blank">00:23:00.620</a></span> | <span class="t">transformers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1381" target="_blank">00:23:01.740</a></span> | <span class="t">It's a lot easier and a lot more effective.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1385" target="_blank">00:23:05.060</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1385" target="_blank">00:23:05.540</a></span> | <span class="t">So in sentence transformers, so we're back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1388" target="_blank">00:23:08.620</a></span> | <span class="t">in the first notebook now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1391" target="_blank">00:23:11.380</a></span> | <span class="t">So we have our data set, 314 rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1394" target="_blank">00:23:14.940</a></span> | <span class="t">And it is just anchor positive pairs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1398" target="_blank">00:23:18.740</a></span> | <span class="t">So with sentence transformers, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1402" target="_blank">00:23:22.140</a></span> | <span class="t">use something called an input example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1404" target="_blank">00:23:24.660</a></span> | <span class="t">So we have a big list of input examples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1407" target="_blank">00:23:27.220</a></span> | <span class="t">which is the data format that our sentence transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1413" target="_blank">00:23:33.460</a></span> | <span class="t">library training methods would expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1417" target="_blank">00:23:37.300</a></span> | <span class="t">So we want to do from sentence transformers import input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1428" target="_blank">00:23:48.060</a></span> | <span class="t">example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1429" target="_blank">00:23:49.020</a></span> | <span class="t">And what we'll do is we'll just initialize the list here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1432" target="_blank">00:23:52.180</a></span> | <span class="t">so samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1433" target="_blank">00:23:53.260</a></span> | <span class="t">And this is very simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1435" target="_blank">00:23:55.580</a></span> | <span class="t">We're just going to go for sample in--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1440" target="_blank">00:24:00.660</a></span> | <span class="t">or for row, let's say, for row in data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1446" target="_blank">00:24:06.380</a></span> | <span class="t">We want to say samples.append.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1451" target="_blank">00:24:11.580</a></span> | <span class="t">And in here, we have our input example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1454" target="_blank">00:24:14.860</a></span> | <span class="t">So the thing we just import, the object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1458" target="_blank">00:24:18.820</a></span> | <span class="t">the special sentence transformers object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1461" target="_blank">00:24:21.500</a></span> | <span class="t">And in the previous video and article,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1464" target="_blank">00:24:24.100</a></span> | <span class="t">this accepts two different parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1467" target="_blank">00:24:27.620</a></span> | <span class="t">It accepts the text and label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1470" target="_blank">00:24:30.180</a></span> | <span class="t">Now, like I said, we don't have labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1472" target="_blank">00:24:32.460</a></span> | <span class="t">We just generate them as we're performing the training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1476" target="_blank">00:24:36.580</a></span> | <span class="t">So we don't need the label here, so we just write text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1481" target="_blank">00:24:41.340</a></span> | <span class="t">And in here, we-- so list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1484" target="_blank">00:24:44.780</a></span> | <span class="t">And in there, we want our row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1487" target="_blank">00:24:47.620</a></span> | <span class="t">We want the premise, which is our anchor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1492" target="_blank">00:24:52.780</a></span> | <span class="t">And we also want the hypothesis, which is our positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1500" target="_blank">00:25:00.180</a></span> | <span class="t">OK, and that's all we need, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1504" target="_blank">00:25:04.700</a></span> | <span class="t">So that will take a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1510" target="_blank">00:25:10.900</a></span> | <span class="t">So what you can do is if I just go from tqdm.auto,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1518" target="_blank">00:25:18.260</a></span> | <span class="t">import tqdm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1520" target="_blank">00:25:20.580</a></span> | <span class="t">So we can add this to our loop here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1523" target="_blank">00:25:23.060</a></span> | <span class="t">so that we have a nice progress bar,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1525" target="_blank">00:25:25.140</a></span> | <span class="t">so we can see how far along we are,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1527" target="_blank">00:25:27.700</a></span> | <span class="t">how long it's going to take.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1530" target="_blank">00:25:30.860</a></span> | <span class="t">And I mean, it's very quick anyway,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1533" target="_blank">00:25:33.060</a></span> | <span class="t">but I think it's nice to be able to see that, especially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1535" target="_blank">00:25:35.460</a></span> | <span class="t">for the longer data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1537" target="_blank">00:25:37.580</a></span> | <span class="t">Now, here we need to initialize what is a data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1542" target="_blank">00:25:42.620</a></span> | <span class="t">Usually, we use the PyTorch data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1544" target="_blank">00:25:44.820</a></span> | <span class="t">This time, we're not going to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1546" target="_blank">00:25:46.060</a></span> | <span class="t">This time, we're going to use a special data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1548" target="_blank">00:25:48.180</a></span> | <span class="t">loader from the sentence transformers library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1551" target="_blank">00:25:51.620</a></span> | <span class="t">And I'll explain why in just a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1554" target="_blank">00:25:54.340</a></span> | <span class="t">So from sentence transformers, I want to import data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1562" target="_blank">00:26:02.300</a></span> | <span class="t">We set the batch size, as we usually do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1564" target="_blank">00:26:04.700</a></span> | <span class="t">We're going to set that equal to 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1568" target="_blank">00:26:08.540</a></span> | <span class="t">And we're creating a data loader,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1572" target="_blank">00:26:12.180</a></span> | <span class="t">so we're just going to call that loader again, as we usually do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1579" target="_blank">00:26:19.300</a></span> | <span class="t">And in here, we want to write data sets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1582" target="_blank">00:26:22.060</a></span> | <span class="t">and we want the no duplicates data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1586" target="_blank">00:26:26.300</a></span> | <span class="t">So you can see that there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1588" target="_blank">00:26:28.020</a></span> | <span class="t">And what this is going to do is, unlike a normal data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1591" target="_blank">00:26:31.420</a></span> | <span class="t">loader in PyTorch, which would just feed you--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1595" target="_blank">00:26:35.460</a></span> | <span class="t">it would just feed you 32, in this case, samples at once,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1601" target="_blank">00:26:41.980</a></span> | <span class="t">it wouldn't check the data in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1603" target="_blank">00:26:43.620</a></span> | <span class="t">Or no duplicates data loader checks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1607" target="_blank">00:26:47.340</a></span> | <span class="t">that you don't have any duplicates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1610" target="_blank">00:26:50.260</a></span> | <span class="t">within the same batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1612" target="_blank">00:26:52.060</a></span> | <span class="t">Now, realistically, with this data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1613" target="_blank">00:26:53.700</a></span> | <span class="t">probably not going to get that anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1616" target="_blank">00:26:56.060</a></span> | <span class="t">But if you do have data sets which might have duplicates,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1620" target="_blank">00:27:00.500</a></span> | <span class="t">you can use this to avoid that issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1623" target="_blank">00:27:03.020</a></span> | <span class="t">Because if you think, OK, if you have a duplicate,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1626" target="_blank">00:27:06.020</a></span> | <span class="t">and our labels are saying that pair A1 and P1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1631" target="_blank">00:27:11.660</a></span> | <span class="t">should be the same, but in reality, over here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1635" target="_blank">00:27:15.060</a></span> | <span class="t">we have A7 and P7, which are exactly the same,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1639" target="_blank">00:27:19.140</a></span> | <span class="t">it's going to confuse the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1640" target="_blank">00:27:20.420</a></span> | <span class="t">And it's going to say that A1 and P7 should be matching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1645" target="_blank">00:27:25.860</a></span> | <span class="t">But in reality, it should just be A1 and P1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1649" target="_blank">00:27:29.820</a></span> | <span class="t">So that's why we use this no duplicates data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1652" target="_blank">00:27:32.860</a></span> | <span class="t">to remove any possibility of that happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1656" target="_blank">00:27:36.900</a></span> | <span class="t">Now, as well, if that happens occasionally,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1660" target="_blank">00:27:40.420</a></span> | <span class="t">it's not really an issue anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1662" target="_blank">00:27:42.380</a></span> | <span class="t">But it's nice to just be careful with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1666" target="_blank">00:27:46.780</a></span> | <span class="t">So we have our samples, and we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1668" target="_blank">00:27:48.540</a></span> | <span class="t">the batch size, which is equal to our batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1674" target="_blank">00:27:54.180</a></span> | <span class="t">So that's our data loader.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1676" target="_blank">00:27:56.980</a></span> | <span class="t">Now, what we need to do is initialize a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1680" target="_blank">00:28:00.180</a></span> | <span class="t">So in Sentence Transformers, we can do the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1683" target="_blank">00:28:03.620</a></span> | <span class="t">as we do with Hug and Face Transformers, where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1685" target="_blank">00:28:05.540</a></span> | <span class="t">we load a pre-trained model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1688" target="_blank">00:28:08.300</a></span> | <span class="t">But we can also initialize a new model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1691" target="_blank">00:28:11.580</a></span> | <span class="t">using what are called modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1693" target="_blank">00:28:13.820</a></span> | <span class="t">So in this case, we're going to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1695" target="_blank">00:28:15.980</a></span> | <span class="t">two modules, which is going to be the Transformer module,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1700" target="_blank">00:28:20.060</a></span> | <span class="t">so the actual bear itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1701" target="_blank">00:28:21.780</a></span> | <span class="t">And that's going to be followed by a pooling module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1704" target="_blank">00:28:24.380</a></span> | <span class="t">for the mean pooling that we do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1708" target="_blank">00:28:28.340</a></span> | <span class="t">So we're going to write, from Sentence Transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1713" target="_blank">00:28:33.380</a></span> | <span class="t">import models, and also Sentence Transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1720" target="_blank">00:28:40.820</a></span> | <span class="t">And we say, OK, BERT is equal to models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1725" target="_blank">00:28:45.140</a></span> | <span class="t">and it's a Transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1728" target="_blank">00:28:48.180</a></span> | <span class="t">So we initialize that, and we're using a BERT base on case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1734" target="_blank">00:28:54.220</a></span> | <span class="t">model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1735" target="_blank">00:28:55.660</a></span> | <span class="t">And we also have our pooling module,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1741" target="_blank">00:29:01.420</a></span> | <span class="t">and that is models pooling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1747" target="_blank">00:29:07.100</a></span> | <span class="t">And in here, the pooling approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1749" target="_blank">00:29:09.060</a></span> | <span class="t">needs to know the dimensionality of the vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1752" target="_blank">00:29:12.900</a></span> | <span class="t">that it's going to be dealing with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1754" target="_blank">00:29:14.540</a></span> | <span class="t">And we can get that from BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1755" target="_blank">00:29:15.860</a></span> | <span class="t">We can say, get word embedding dimension, which is the 768.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1764" target="_blank">00:29:24.220</a></span> | <span class="t">And as well as that, we also need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1766" target="_blank">00:29:26.420</a></span> | <span class="t">to know which type of pooling we want to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1770" target="_blank">00:29:30.660</a></span> | <span class="t">And for that, we can write pooling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1773" target="_blank">00:29:33.940</a></span> | <span class="t">And we can see we have all these different methods in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1777" target="_blank">00:29:37.620</a></span> | <span class="t">So we have the pooling mode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1778" target="_blank">00:29:38.940</a></span> | <span class="t">We can use the CLS token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1781" target="_blank">00:29:41.740</a></span> | <span class="t">We can take the maximum value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1783" target="_blank">00:29:43.140</a></span> | <span class="t">We can take the mean and consider the square root</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1788" target="_blank">00:29:48.980</a></span> | <span class="t">of the length of the tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1790" target="_blank">00:29:50.780</a></span> | <span class="t">I don't know this one, so I could be completely wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1794" target="_blank">00:29:54.500</a></span> | <span class="t">And we also have the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1795" target="_blank">00:29:55.900</a></span> | <span class="t">So this is a mean pooling method that I mentioned before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1799" target="_blank">00:29:59.140</a></span> | <span class="t">We're going to be using that one, so we say true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1802" target="_blank">00:30:02.780</a></span> | <span class="t">And then to actually initialize the model using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1806" target="_blank">00:30:06.740</a></span> | <span class="t">those two parts or two modules, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1811" target="_blank">00:30:11.140</a></span> | <span class="t">are going to write model equals sentence transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1815" target="_blank">00:30:15.460</a></span> | <span class="t">And like I said before, this is how you would usually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1818" target="_blank">00:30:18.380</a></span> | <span class="t">load a pre-trained model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1819" target="_blank">00:30:19.660</a></span> | <span class="t">So if you wanted to load a pre-trained model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1821" target="_blank">00:30:21.580</a></span> | <span class="t">you'd be like BERT base on case, like in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1824" target="_blank">00:30:24.620</a></span> | <span class="t">We're not doing that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1825" target="_blank">00:30:25.620</a></span> | <span class="t">We are initializing a new model using these two modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1829" target="_blank">00:30:29.620</a></span> | <span class="t">So we write modules equals.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1833" target="_blank">00:30:33.260</a></span> | <span class="t">And we have BERT followed by the pooling function or module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1841" target="_blank">00:30:41.900</a></span> | <span class="t">And then we can have a look at what we have there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1844" target="_blank">00:30:44.020</a></span> | <span class="t">So we have the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1845" target="_blank">00:30:45.540</a></span> | <span class="t">So hopefully, it doesn't take too long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1849" target="_blank">00:30:49.660</a></span> | <span class="t">We get our list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1850" target="_blank">00:30:50.380</a></span> | <span class="t">This is fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1851" target="_blank">00:30:51.060</a></span> | <span class="t">It's just coming from, I think, Honey Face.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1853" target="_blank">00:30:53.820</a></span> | <span class="t">And then here, we have the structure of our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1857" target="_blank">00:30:57.220</a></span> | <span class="t">So we can see with transformer, we're using the BERT model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1861" target="_blank">00:31:01.940</a></span> | <span class="t">And in here, the pooling--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1864" target="_blank">00:31:04.980</a></span> | <span class="t">we have the embedding dimension, 7, 6, 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1867" target="_blank">00:31:07.820</a></span> | <span class="t">And we see that the only one of these values that is true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1871" target="_blank">00:31:11.300</a></span> | <span class="t">is the pooling mode mean tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1873" target="_blank">00:31:13.860</a></span> | <span class="t">And the rest of them are false because we're not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1875" target="_blank">00:31:15.860</a></span> | <span class="t">using those methods.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1879" target="_blank">00:31:19.340</a></span> | <span class="t">Now, all we need to do is do the--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1884" target="_blank">00:31:24.100</a></span> | <span class="t">we need to initialize the loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1886" target="_blank">00:31:26.300</a></span> | <span class="t">So from Sentence Transformers, import losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1892" target="_blank">00:31:32.940</a></span> | <span class="t">And our loss function is going to be equal to losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1896" target="_blank">00:31:36.660</a></span> | <span class="t">And we have the multiple negatives ranking loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1900" target="_blank">00:31:40.580</a></span> | <span class="t">which we can see there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1902" target="_blank">00:31:42.860</a></span> | <span class="t">And all we need to pass to that is a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1905" target="_blank">00:31:45.740</a></span> | <span class="t">So it knows what model it is--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1910" target="_blank">00:31:50.020</a></span> | <span class="t">it knows the model parameters that it's dealing with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1913" target="_blank">00:31:53.220</a></span> | <span class="t">So let's run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1914" target="_blank">00:31:54.580</a></span> | <span class="t">And with that, we're ready to actually start training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1918" target="_blank">00:31:58.700</a></span> | <span class="t">or fine-tuning the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1921" target="_blank">00:32:01.220</a></span> | <span class="t">So we'll say, OK, we want to use one epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1926" target="_blank">00:32:06.900</a></span> | <span class="t">And the number of warm-up steps--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1929" target="_blank">00:32:09.220</a></span> | <span class="t">so like I said before, we have that 10% of warm-up steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1933" target="_blank">00:32:13.100</a></span> | <span class="t">that we want to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1936" target="_blank">00:32:16.220</a></span> | <span class="t">But it isn't as complicated to set that this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1939" target="_blank">00:32:19.900</a></span> | <span class="t">We just want to say, OK, 10% 0.1 multiplied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1943" target="_blank">00:32:23.220</a></span> | <span class="t">by the total number of steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1945" target="_blank">00:32:25.500</a></span> | <span class="t">What total number of steps?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1947" target="_blank">00:32:27.620</a></span> | <span class="t">Well, it would be the length of the loader, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1955" target="_blank">00:32:35.300</a></span> | <span class="t">And we write int there, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1959" target="_blank">00:32:39.180</a></span> | <span class="t">And that was our warm-up steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1963" target="_blank">00:32:43.900</a></span> | <span class="t">And then we can call model.fit, so like tennis flow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1968" target="_blank">00:32:48.640</a></span> | <span class="t">And then in here, we just pass a few--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1970" target="_blank">00:32:50.820</a></span> | <span class="t">now, we pass our model configuration and setup</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1975" target="_blank">00:32:55.420</a></span> | <span class="t">and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1977" target="_blank">00:32:57.780</a></span> | <span class="t">So the first thing we want to do is set our train objectives,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1983" target="_blank">00:33:03.820</a></span> | <span class="t">which is just a list containing train objective pairs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1988" target="_blank">00:33:08.660</a></span> | <span class="t">you could say.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1989" target="_blank">00:33:09.860</a></span> | <span class="t">For us, we just have one of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1991" target="_blank">00:33:11.340</a></span> | <span class="t">And that is loader followed by loss, so our objectives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1997" target="_blank">00:33:17.420</a></span> | <span class="t">And then we have the epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=1999" target="_blank">00:33:19.900</a></span> | <span class="t">So epochs, just put one there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2002" target="_blank">00:33:22.340</a></span> | <span class="t">It's probably easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2004" target="_blank">00:33:24.500</a></span> | <span class="t">We have number of warm-up steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2006" target="_blank">00:33:26.940</a></span> | <span class="t">So we write warm-up steps is equal to warm-up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2011" target="_blank">00:33:31.220</a></span> | <span class="t">And then we have the output path,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2012" target="_blank">00:33:32.500</a></span> | <span class="t">so where we're going to save our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2016" target="_blank">00:33:36.780</a></span> | <span class="t">So I think I use that MNR2 or something for the final one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2022" target="_blank">00:33:42.500</a></span> | <span class="t">that I put together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2025" target="_blank">00:33:45.940</a></span> | <span class="t">And then after that, final thing, if you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2030" target="_blank">00:33:50.660</a></span> | <span class="t">So this will come up with a progress bar</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2033" target="_blank">00:33:53.780</a></span> | <span class="t">like we saw before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2034" target="_blank">00:33:54.620</a></span> | <span class="t">But the progress bar, for me, it will just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2036" target="_blank">00:33:56.940</a></span> | <span class="t">print every single step update.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2039" target="_blank">00:33:59.440</a></span> | <span class="t">So it's quite annoying.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2040" target="_blank">00:34:00.940</a></span> | <span class="t">So you can set show progress bar equal to false, if you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2046" target="_blank">00:34:06.260</a></span> | <span class="t">And then you just run this, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2048" target="_blank">00:34:08.180</a></span> | <span class="t">We run this, and this will fine-tune our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2051" target="_blank">00:34:11.380</a></span> | <span class="t">Now, I've already run it, so I'm not going to run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2054" target="_blank">00:34:14.220</a></span> | <span class="t">It takes a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2057" target="_blank">00:34:17.140</a></span> | <span class="t">So what I'm going to show you are just the results from that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2060" target="_blank">00:34:20.300</a></span> | <span class="t">OK, so this is my other notebook where I already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2065" target="_blank">00:34:25.900</a></span> | <span class="t">ran all of what you just saw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2068" target="_blank">00:34:28.980</a></span> | <span class="t">We have our sentences here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2070" target="_blank">00:34:30.700</a></span> | <span class="t">So it's a load of random sentences, but a couple of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2072" target="_blank">00:34:32.980</a></span> | <span class="t">do match up, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2074" target="_blank">00:34:34.860</a></span> | <span class="t">So we have this sushi one here, and there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2078" target="_blank">00:34:38.260</a></span> | <span class="t">another sushi one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2079" target="_blank">00:34:39.380</a></span> | <span class="t">But what I've done is not use the same words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2082" target="_blank">00:34:42.060</a></span> | <span class="t">in both sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2084" target="_blank">00:34:44.740</a></span> | <span class="t">We've got knit noodles and weaving spaghetti.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2088" target="_blank">00:34:48.180</a></span> | <span class="t">And we also have dental specialists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2090" target="_blank">00:34:50.340</a></span> | <span class="t">with construction materials and dentists with trim bricks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2094" target="_blank">00:34:54.700</a></span> | <span class="t">So similar in concept, but they don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2096" target="_blank">00:34:56.980</a></span> | <span class="t">share any of the same words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2098" target="_blank">00:34:58.180</a></span> | <span class="t">And it's quite abstract as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2101" target="_blank">00:35:01.740</a></span> | <span class="t">So down here, so we have our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2105" target="_blank">00:35:05.220</a></span> | <span class="t">We're just encoding those sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2108" target="_blank">00:35:08.020</a></span> | <span class="t">And then what I'm doing is I'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2110" target="_blank">00:35:10.580</a></span> | <span class="t">creating a similarity matrix between all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2114" target="_blank">00:35:14.220</a></span> | <span class="t">of these different sentences, or the encodings produced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2118" target="_blank">00:35:18.700</a></span> | <span class="t">by our model, the sentence embeddings produced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2121" target="_blank">00:35:21.220</a></span> | <span class="t">by our model, and all of the equivalent embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2126" target="_blank">00:35:26.180</a></span> | <span class="t">from this list of sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2129" target="_blank">00:35:29.100</a></span> | <span class="t">And we just use matplotlib and seaborn to actually plot that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2135" target="_blank">00:35:35.060</a></span> | <span class="t">And we see that we get this nice visualization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2138" target="_blank">00:35:38.820</a></span> | <span class="t">And we see that we have 4 and 3 that align,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2142" target="_blank">00:35:42.460</a></span> | <span class="t">and also 9 and 1, and 7 and 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2145" target="_blank">00:35:45.460</a></span> | <span class="t">And those are the three pairs I mentioned before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2150" target="_blank">00:35:50.140</a></span> | <span class="t">that are very similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2152" target="_blank">00:35:52.060</a></span> | <span class="t">And the rest of these values are all very low,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2156" target="_blank">00:35:56.060</a></span> | <span class="t">which is obviously very good because those pairs are not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2161" target="_blank">00:36:01.300</a></span> | <span class="t">similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2162" target="_blank">00:36:02.100</a></span> | <span class="t">Maybe they have some sort of similarity,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2164" target="_blank">00:36:04.460</a></span> | <span class="t">but they're not similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2165" target="_blank">00:36:05.700</a></span> | <span class="t">So we can obviously see straight away</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2169" target="_blank">00:36:09.020</a></span> | <span class="t">where the true pairs are, or the true semantic pairs are there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2175" target="_blank">00:36:15.020</a></span> | <span class="t">OK, so I think that's pretty much it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2179" target="_blank">00:36:19.980</a></span> | <span class="t">We've kind of gone through multiple negatives, ranking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2184" target="_blank">00:36:24.500</a></span> | <span class="t">loss, and how to implement it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2187" target="_blank">00:36:27.460</a></span> | <span class="t">And like I said before, this is really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2189" target="_blank">00:36:29.460</a></span> | <span class="t">if you're going to train a sentence transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2192" target="_blank">00:36:32.340</a></span> | <span class="t">or fine-tune a sentence transformer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2194" target="_blank">00:36:34.940</a></span> | <span class="t">this is the approach I would probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2198" target="_blank">00:36:38.060</a></span> | <span class="t">go with, depending on the data that you have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2201" target="_blank">00:36:41.580</a></span> | <span class="t">Now, I mean, that's everything for the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2204" target="_blank">00:36:44.020</a></span> | <span class="t">So thank you very much for watching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2207" target="_blank">00:36:47.940</a></span> | <span class="t">I hope you've enjoyed it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=or5ew7dqA-c&t=2209" target="_blank">00:36:49.220</a></span> | <span class="t">And I will see you in the next one.</span></div></div></body></html>