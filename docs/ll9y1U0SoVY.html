<html><head><title>Lesson 6: Practical Deep Learning for Coders</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 6: Practical Deep Learning for Coders</h2><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY"><img src="https://i.ytimg.com/vi_webp/ll9y1U0SoVY/sddefault.webp" style="width:50%;"></a><div><br></div><div style="text-align: left;"><a href="./ll9y1U0SoVY.html">Whisper Transcript</a> | <a href="./transcript_ll9y1U0SoVY.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">We talked about pseudo-labeling a couple of weeks ago and this is this way of dealing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7" target="_blank">00:00:07.080</a></span> | <span class="t">with semi-supervised learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=9" target="_blank">00:00:09.960</a></span> | <span class="t">Remember how in the state-farm competition we had far more unlabeled images in the test</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=16" target="_blank">00:00:16.160</a></span> | <span class="t">set than we had in the training set?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=19" target="_blank">00:00:19.040</a></span> | <span class="t">And so the question was like how do we take advantage of knowing something about the structure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=22" target="_blank">00:00:22.880</a></span> | <span class="t">even though we don't have labels?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=26" target="_blank">00:00:26.040</a></span> | <span class="t">We learned this crazy technique called pseudo-labeling, or a combination of pseudo-labeling and not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=29" target="_blank">00:00:29.920</a></span> | <span class="t">a knowledge distillation, which is where you predict the outputs of the test set and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=38" target="_blank">00:00:38.120</a></span> | <span class="t">you act as if those outputs were true labels and you kind of add them in to your training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=45" target="_blank">00:00:45.360</a></span> | <span class="t">And the reason I wasn't able to actually implement that and see how it works was because we needed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=50" target="_blank">00:00:50.080</a></span> | <span class="t">a way of combining two different sets of batches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=54" target="_blank">00:00:54.320</a></span> | <span class="t">And in particular, I think the advice I saw from Jeff Hinton when he wrote about pseudo-labeling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=61" target="_blank">00:01:01.840</a></span> | <span class="t">is that you want something like 1 in 3 or 1 in 4 of your training data to come from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=68" target="_blank">00:01:08.720</a></span> | <span class="t">the pseudo-label data and the rest to come from your real data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=73" target="_blank">00:01:13.720</a></span> | <span class="t">So the good news is I built that thing and it was ridiculously easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=81" target="_blank">00:01:21.280</a></span> | <span class="t">This is the entire code, I called it the mix iterator, and it will be in our utils+ from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=89" target="_blank">00:01:29.000</a></span> | <span class="t">tomorrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=91" target="_blank">00:01:31.000</a></span> | <span class="t">And all it does is it's something where you create whatever generators of batches you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=96" target="_blank">00:01:36.720</a></span> | <span class="t">like and then you pass an array of those iterators to this constructor and then every time the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=106" target="_blank">00:01:46.240</a></span> | <span class="t">Keras system calls Next on it, it grabs the next batch from all of those sets of batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=112" target="_blank">00:01:52.760</a></span> | <span class="t">and concatenates them all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=115" target="_blank">00:01:55.200</a></span> | <span class="t">And so what that means in practice is that I tried doing pseudo-labeling, for example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=120" target="_blank">00:02:00.440</a></span> | <span class="t">on MNIST.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=121" target="_blank">00:02:01.440</a></span> | <span class="t">Because remember on MNIST we already had that pretty close to state-of-the-art result, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=127" target="_blank">00:02:07.360</a></span> | <span class="t">was 99.69, so I thought can we improve it anymore if we use pseudo-labeling on the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=140" target="_blank">00:02:20.240</a></span> | <span class="t">And so to do so, you just do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=144" target="_blank">00:02:24.040</a></span> | <span class="t">You grab your training batches as usual using data augmentation if you want, whatever else,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=151" target="_blank">00:02:31.440</a></span> | <span class="t">so here's my training batches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=153" target="_blank">00:02:33.760</a></span> | <span class="t">And then you create your pseudo-batches by saying, okay, my data is my test set and my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=165" target="_blank">00:02:45.320</a></span> | <span class="t">labels are my predictions, and these are the predictions that I calculated back up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=171" target="_blank">00:02:51.960</a></span> | <span class="t">So now this is the second set of batches, which is my pseudo-batches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=177" target="_blank">00:02:57.720</a></span> | <span class="t">And so then passing an array of those two things to the mix iterator now creates a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=182" target="_blank">00:03:02.480</a></span> | <span class="t">batch generator, which is going to give us a few images from here and a few images from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=188" target="_blank">00:03:08.680</a></span> | <span class="t">here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=189" target="_blank">00:03:09.680</a></span> | <span class="t">How many?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=190" target="_blank">00:03:10.680</a></span> | <span class="t">Well, however many you asked for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=192" target="_blank">00:03:12.520</a></span> | <span class="t">So in this case, I was getting 64 from my training set and 64/4 from my test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=205" target="_blank">00:03:25.080</a></span> | <span class="t">Now I can use that just like any other generator, so then I just call model.fitGenerator and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=215" target="_blank">00:03:35.840</a></span> | <span class="t">pass in that thing that I just created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=219" target="_blank">00:03:39.240</a></span> | <span class="t">And so what it's going to do is create a bunch of batches which will be 64 items from my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=228" target="_blank">00:03:48.400</a></span> | <span class="t">regular training set and a quarter of that number of items from my pseudo-labeled set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=236" target="_blank">00:03:56.000</a></span> | <span class="t">And lo and behold, it gave me a slightly better score.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=240" target="_blank">00:04:00.320</a></span> | <span class="t">There's only so much better we can do at this point, but that took us up to 99.72.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=245" target="_blank">00:04:05.520</a></span> | <span class="t">It's worth mentioning that every 0.01% at this point is just one image, so we're really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=251" target="_blank">00:04:11.400</a></span> | <span class="t">kind of on the edges at this point, but this is getting even closer to the state-of-the-art</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=257" target="_blank">00:04:17.120</a></span> | <span class="t">despite the fact we're not doing any handwriting-specific techniques.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=261" target="_blank">00:04:21.440</a></span> | <span class="t">I also tried it on the fish dataset and I realized at that point that this allows us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=268" target="_blank">00:04:28.040</a></span> | <span class="t">to do something else which is pretty neat, which is normally when we train on the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=273" target="_blank">00:04:33.780</a></span> | <span class="t">set and set aside a validation set, if we don't want to submit to Kaggle, we've only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=279" target="_blank">00:04:39.520</a></span> | <span class="t">trained on a subset of the data that they gave us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=282" target="_blank">00:04:42.340</a></span> | <span class="t">We didn't train on the validation set as well, which is not great, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=287" target="_blank">00:04:47.120</a></span> | <span class="t">So what you can actually do is you can send three sets of batches to the MixCederator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=292" target="_blank">00:04:52.820</a></span> | <span class="t">You can have your regular training batches, you can have your pseudo-label test batches,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=299" target="_blank">00:04:59.800</a></span> | <span class="t">and if you think about it, you could also add in some validation batches using the true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=304" target="_blank">00:05:04.240</a></span> | <span class="t">labels from the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=306" target="_blank">00:05:06.080</a></span> | <span class="t">So this is something you do just right at the end when you say this is a model I'm happy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=310" target="_blank">00:05:10.800</a></span> | <span class="t">with, you could fine-tune it a bit using some of the real validation data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=315" target="_blank">00:05:15.920</a></span> | <span class="t">You can see here I've got out of my batch size of 64, I'm putting 44 from the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=320" target="_blank">00:05:20.260</a></span> | <span class="t">set, 4 from the validation set, and 16 from the pseudo-label test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=326" target="_blank">00:05:26.080</a></span> | <span class="t">And again, this worked pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=328" target="_blank">00:05:28.520</a></span> | <span class="t">It got me from about 110th to about 60th on the leaderboard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=342" target="_blank">00:05:42.720</a></span> | <span class="t">So if we go to cross-documentation, there is something called sample weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=347" target="_blank">00:05:47.120</a></span> | <span class="t">And I wonder if you can just set the sample weight to be lower for...</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=352" target="_blank">00:05:52.680</a></span> | <span class="t">Yeah, you can use the sample weight, but you would still have to manually construct the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=358" target="_blank">00:05:58.240</a></span> | <span class="t">consolidated data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=360" target="_blank">00:06:00.920</a></span> | <span class="t">So this is like a more convenient way where you don't have to append it all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=374" target="_blank">00:06:14.800</a></span> | <span class="t">I will mention that I found the way I'm doing it seems a little slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=379" target="_blank">00:06:19.640</a></span> | <span class="t">There are some obvious ways I can speed it up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=382" target="_blank">00:06:22.560</a></span> | <span class="t">I'm not quite sure why it is, but it might be because this concatenation each time is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=389" target="_blank">00:06:29.440</a></span> | <span class="t">kind of having to create new memory and that takes a long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=393" target="_blank">00:06:33.420</a></span> | <span class="t">There are some obvious things I can do to try and speed it up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=397" target="_blank">00:06:37.520</a></span> | <span class="t">It's good enough and seems to do the job.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=399" target="_blank">00:06:39.560</a></span> | <span class="t">I'm pleased that we now have a way to do convenient pseudo-labeling in Keras and it seems to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=406" target="_blank">00:06:46.360</a></span> | <span class="t">a pretty good job.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=411" target="_blank">00:06:51.840</a></span> | <span class="t">So the other thing I wanted to talk about before we moved on to the new material today</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=416" target="_blank">00:06:56.800</a></span> | <span class="t">is embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=417" target="_blank">00:06:57.800</a></span> | <span class="t">I've had lots of questions about embeddings and I think it's pretty clear that at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=425" target="_blank">00:07:05.560</a></span> | <span class="t">for some of you some additional explanations would be helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=429" target="_blank">00:07:09.160</a></span> | <span class="t">So I wanted to start out by reminding you that when I introduced embeddings to you,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=436" target="_blank">00:07:16.680</a></span> | <span class="t">the data that we had, we looked at this crosstab form of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=442" target="_blank">00:07:22.800</a></span> | <span class="t">When it's in this crosstab form, it's very easy to visualize what embeddings look like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=447" target="_blank">00:07:27.000</a></span> | <span class="t">which is for movie_27 and user_id number 14, here is that movie_id's embedding right here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=454" target="_blank">00:07:34.000</a></span> | <span class="t">and here is that user_id's embedding right here and so here is the dot product of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=458" target="_blank">00:07:38.920</a></span> | <span class="t">two right here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=461" target="_blank">00:07:41.760</a></span> | <span class="t">So that was all pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=464" target="_blank">00:07:44.920</a></span> | <span class="t">And so then all we had to do to optimize our embeddings was use the gradient descent solver</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=471" target="_blank">00:07:51.000</a></span> | <span class="t">that is built into Microsoft Excel, which is called solver, and we just told it what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=478" target="_blank">00:07:58.320</a></span> | <span class="t">our objective is, which is this cell, and we set to minimize it by changing these sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=485" target="_blank">00:08:05.280</a></span> | <span class="t">of cells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=488" target="_blank">00:08:08.520</a></span> | <span class="t">Now the data that we are given in the movie lens dataset, however, requires some manipulation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=496" target="_blank">00:08:16.960</a></span> | <span class="t">to get into a crosstab form, we're actually given it in this form, and we wouldn't want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=500" target="_blank">00:08:20.920</a></span> | <span class="t">to create a crosstab with all of this data because it would be way too big, every single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=505" target="_blank">00:08:25.960</a></span> | <span class="t">user times every single movie, and it would also be very inconvenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=509" target="_blank">00:08:29.480</a></span> | <span class="t">So that's not how Keras works, Keras uses this data in exactly this format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=515" target="_blank">00:08:35.560</a></span> | <span class="t">And so let me show you how that works and what an embedding is really doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=521" target="_blank">00:08:41.200</a></span> | <span class="t">So here is the exact same thing, but I'm going to show you this using the data in the format</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=526" target="_blank">00:08:46.840</a></span> | <span class="t">that Keras uses it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=528" target="_blank">00:08:48.360</a></span> | <span class="t">So this is our input data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=531" target="_blank">00:08:51.520</a></span> | <span class="t">Every rating is a row, it has a user_id, a movie_id, and a rating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=537" target="_blank">00:08:57.420</a></span> | <span class="t">And this is what an embedding matrix looks like for 15 users.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=542" target="_blank">00:09:02.600</a></span> | <span class="t">So these are the user_id's, and for each user_id, here's user_id 14's embedding, and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=550" target="_blank">00:09:10.360</a></span> | <span class="t">29's embedding, and this is 72's embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=552" target="_blank">00:09:12.760</a></span> | <span class="t">At this stage, they're just random, they're just initializing random numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=556" target="_blank">00:09:16.880</a></span> | <span class="t">So this thing here is called an embedding matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=560" target="_blank">00:09:20.880</a></span> | <span class="t">And here is the movie embedding matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=563" target="_blank">00:09:23.720</a></span> | <span class="t">So the embedding matrix for movie_27 are these 5 numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=569" target="_blank">00:09:29.360</a></span> | <span class="t">So what happens when we look at user_id 14, movie_id for 17, rating number 2?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=577" target="_blank">00:09:37.340</a></span> | <span class="t">Well the first thing that happens is that we have to find user_id number 14.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=581" target="_blank">00:09:41.840</a></span> | <span class="t">And here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=582" target="_blank">00:09:42.840</a></span> | <span class="t">User_id 14 is the first thing in this array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=586" target="_blank">00:09:46.820</a></span> | <span class="t">So the index of user_id 14 is 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=590" target="_blank">00:09:50.760</a></span> | <span class="t">So then here is the first row from the user_embedding matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=601" target="_blank">00:10:01.240</a></span> | <span class="t">Similarly movie_id 4.1.7, here is movie_id 4.1.7, and it is the 14th row of this table.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=615" target="_blank">00:10:15.600</a></span> | <span class="t">And so we want to return the 14th row, and so you can see here it has looked up and found</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=621" target="_blank">00:10:21.280</a></span> | <span class="t">that it's the 14th row, and then indexed into the table and grabbed the 14th row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=626" target="_blank">00:10:26.640</a></span> | <span class="t">And so then to calculate the dot product, we simply take the dot product of the user</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=632" target="_blank">00:10:32.120</a></span> | <span class="t">embedding with the movie embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=635" target="_blank">00:10:35.120</a></span> | <span class="t">And then to calculate the loss, we simply take the rating and subtract the prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=640" target="_blank">00:10:40.680</a></span> | <span class="t">and square it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=642" target="_blank">00:10:42.040</a></span> | <span class="t">And then to get the total loss function, we just add that all up and take the square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=648" target="_blank">00:10:48.240</a></span> | <span class="t">So the orange background cells are the cells which we want our SGD solver to change in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=658" target="_blank">00:10:58.600</a></span> | <span class="t">order to minimize this cell here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=663" target="_blank">00:11:03.880</a></span> | <span class="t">And then all of the orange bold cells are the calculated cells.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=669" target="_blank">00:11:09.160</a></span> | <span class="t">So when I was saying last week that an embedding is simply looking up an array by an index,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=677" target="_blank">00:11:17.360</a></span> | <span class="t">you can see why I was saying that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=678" target="_blank">00:11:18.800</a></span> | <span class="t">It's literally taking an index and it looks it up in an array and returns that row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=684" target="_blank">00:11:24.560</a></span> | <span class="t">That's literally all it's doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=687" target="_blank">00:11:27.600</a></span> | <span class="t">You might want to convince yourself during the week that this is identical to taking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=692" target="_blank">00:11:32.720</a></span> | <span class="t">a one-hot encoded matrix and multiplying it by an embedding matrix that's identical to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=699" target="_blank">00:11:39.040</a></span> | <span class="t">doing this kind of lookup.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=701" target="_blank">00:11:41.440</a></span> | <span class="t">So we can do exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=704" target="_blank">00:11:44.040</a></span> | <span class="t">In this way, we can say data solver, we want to set this cell to a minimum by changing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=714" target="_blank">00:11:54.560</a></span> | <span class="t">these cells and if I say solve, then x_l will go away and try to improve our objective and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=723" target="_blank">00:12:03.040</a></span> | <span class="t">you can see it's decreasing, it's up to about 2.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=727" target="_blank">00:12:07.160</a></span> | <span class="t">And so what it's doing here is it's using gradient descent to try to find ways to increase or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=732" target="_blank">00:12:12.680</a></span> | <span class="t">decrease all of these numbers such that that RMSE becomes as low as possible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=740" target="_blank">00:12:20.400</a></span> | <span class="t">So that's literally all that is going on in our Keras example, here, this .product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=753" target="_blank">00:12:33.320</a></span> | <span class="t">So this thing here where we said create an embedding for a user, that's just saying create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=757" target="_blank">00:12:37.280</a></span> | <span class="t">something where I can look up the user_id and find their row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=761" target="_blank">00:12:41.600</a></span> | <span class="t">This is doing the same for a movie, look up the movie_id and find its row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=765" target="_blank">00:12:45.760</a></span> | <span class="t">And this here says take the .product once you've found the two, and then this here says train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=771" target="_blank">00:12:51.600</a></span> | <span class="t">a model where you take in that user_id and movie_id and try to predict the rating and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=776" target="_blank">00:12:56.400</a></span> | <span class="t">use SGD to make it better and better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=784" target="_blank">00:13:04.000</a></span> | <span class="t">So you can see here that it's got the RMSE down to 0.4, so for example the first one predicted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=794" target="_blank">00:13:14.960</a></span> | <span class="t">3, it's actually 2, 4.5, 4.6, 5 and so forth, so you get the idea of how it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=805" target="_blank">00:13:25.020</a></span> | <span class="t">Word embeddings work exactly the same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=808" target="_blank">00:13:28.360</a></span> | <span class="t">So inspired by one of the students who talked about this during the week, I grabbed the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=815" target="_blank">00:13:35.920</a></span> | <span class="t">text of Green Eggs and Ham.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=819" target="_blank">00:13:39.800</a></span> | <span class="t">And so here is the text of Green Eggs and Ham.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=821" target="_blank">00:13:41.640</a></span> | <span class="t">I am Daniel, I am Sam, Sam I am, that's Sam I am, etc.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=827" target="_blank">00:13:47.920</a></span> | <span class="t">And I've turned this poem into a matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=835" target="_blank">00:13:55.280</a></span> | <span class="t">And the way I did that was to take every unique word in that poem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=843" target="_blank">00:14:03.080</a></span> | <span class="t">Here is the ID of each of those words, just index from 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=847" target="_blank">00:14:07.480</a></span> | <span class="t">And so then I just randomly generated an embedding matrix, I equally well could have used the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=854" target="_blank">00:14:14.560</a></span> | <span class="t">downloaded glove embeddings instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=858" target="_blank">00:14:18.880</a></span> | <span class="t">And so then just for each word, I just look up in the list to find that word and find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=863" target="_blank">00:14:23.360</a></span> | <span class="t">out what number it is, so I is number 8, and so here is the 8th row of the embedding matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=871" target="_blank">00:14:31.040</a></span> | <span class="t">So you can see here that we've started with a poem and we've turned it into a matrix of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=877" target="_blank">00:14:37.960</a></span> | <span class="t">floats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=878" target="_blank">00:14:38.960</a></span> | <span class="t">And so the reason we do this is because our machine learning tools want a matrix of floats,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=885" target="_blank">00:14:45.240</a></span> | <span class="t">not a poem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=887" target="_blank">00:14:47.680</a></span> | <span class="t">So all of the questions about does it matter what the word IDs are, you can see it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=894" target="_blank">00:14:54.920</a></span> | <span class="t">matter at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=895" target="_blank">00:14:55.920</a></span> | <span class="t">All we're doing is we're looking them up in this matrix and returning the floats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=901" target="_blank">00:15:01.880</a></span> | <span class="t">And once we've done that, we never use them again, we just use this matrix of floats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=907" target="_blank">00:15:07.520</a></span> | <span class="t">So that's what embeddings are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=912" target="_blank">00:15:12.840</a></span> | <span class="t">So I hope that's helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=913" target="_blank">00:15:13.840</a></span> | <span class="t">Feel free to ask if you have any questions either now or at any other time because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=918" target="_blank">00:15:18.800</a></span> | <span class="t">going to be using embeddings throughout this class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=923" target="_blank">00:15:23.960</a></span> | <span class="t">So hopefully that helped a few people clarify what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=933" target="_blank">00:15:33.980</a></span> | <span class="t">So let's get back to recurrent neural networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=939" target="_blank">00:15:39.240</a></span> | <span class="t">So to remind you, we talked about the purpose of recurrent neural networks as being really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=950" target="_blank">00:15:50.920</a></span> | <span class="t">all about memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=958" target="_blank">00:15:58.360</a></span> | <span class="t">So it's really all about this idea of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=962" target="_blank">00:16:02.880</a></span> | <span class="t">If we're going to handle something like recognizing a comment start and a comment end, and being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=969" target="_blank">00:16:09.760</a></span> | <span class="t">able to keep track of the fact that we're in a comment for all of this time so that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=974" target="_blank">00:16:14.120</a></span> | <span class="t">we can do modeling on this kind of structured language data, we're really going to need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=978" target="_blank">00:16:18.560</a></span> | <span class="t">memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=980" target="_blank">00:16:20.920</a></span> | <span class="t">That allows us to handle long-term dependencies and it provides this stateful representation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=987" target="_blank">00:16:27.240</a></span> | <span class="t">So in general, the stuff we're talking about, we're going to be looking at things that kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=990" target="_blank">00:16:30.360</a></span> | <span class="t">of particularly need these three things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=992" target="_blank">00:16:32.840</a></span> | <span class="t">And it's also somewhat helpful just for when you have a variable length sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=999" target="_blank">00:16:39.960</a></span> | <span class="t">Questions about embeddings?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1001" target="_blank">00:16:41.840</a></span> | <span class="t">One is how does the size of my embedding depend on the number of unique words?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1006" target="_blank">00:16:46.280</a></span> | <span class="t">So mapping green eggs and ham to five real numbers seems sufficient but wouldn't be for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1011" target="_blank">00:16:51.100</a></span> | <span class="t">all of JRR Tolkien.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1014" target="_blank">00:16:54.000</a></span> | <span class="t">So your choice of how big to make your embedding matrix, as in how many latent factors to create,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1021" target="_blank">00:17:01.680</a></span> | <span class="t">is one of these architectural decisions which we don't really have an answer to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1028" target="_blank">00:17:08.880</a></span> | <span class="t">My best suggestion is to read the Word2Vec paper which introduced a lot of this and look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1042" target="_blank">00:17:22.240</a></span> | <span class="t">at the difference between a 50 dimensional, 100 dimensional, 200, 300, 600 dimensional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1048" target="_blank">00:17:28.240</a></span> | <span class="t">and see what are the different levels of accuracy that those different size embedding matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1053" target="_blank">00:17:33.120</a></span> | <span class="t">created when the authors of that paper provided this information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1058" target="_blank">00:17:38.840</a></span> | <span class="t">So that's a quick shortcut because other people have already experimented and provided those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1062" target="_blank">00:17:42.960</a></span> | <span class="t">results for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1064" target="_blank">00:17:44.840</a></span> | <span class="t">The other is to do your own experiments, try a few different sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1068" target="_blank">00:17:48.700</a></span> | <span class="t">It's not really about the length of the word list, it's really about the complexity of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1074" target="_blank">00:17:54.640</a></span> | <span class="t">the language or other problem that you're trying to solve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1079" target="_blank">00:17:59.960</a></span> | <span class="t">That's really problem dependent and will require both your intuition developed from reading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1085" target="_blank">00:18:05.720</a></span> | <span class="t">and experimenting and also your own experiments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1089" target="_blank">00:18:09.500</a></span> | <span class="t">And what would be the range of root mean squared error value to say that a model is good?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1096" target="_blank">00:18:16.760</a></span> | <span class="t">To say that a model is good is another model specific issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1101" target="_blank">00:18:21.980</a></span> | <span class="t">So a root mean squared error is very interpretable, it's basically how far out is it on average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1109" target="_blank">00:18:29.800</a></span> | <span class="t">So we were finding that we were getting ratings within about 0.4, this mini Excel dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1118" target="_blank">00:18:38.000</a></span> | <span class="t">is too small to really make intelligent comments, but let's say it was bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1123" target="_blank">00:18:43.180</a></span> | <span class="t">If we're getting within 0.4 on average, that sounds like it's probably good enough to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1129" target="_blank">00:18:49.280</a></span> | <span class="t">useful for helping people find movies that they might like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1133" target="_blank">00:18:53.880</a></span> | <span class="t">But there's really no one solution, I actually wrote a whole paper about this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1149" target="_blank">00:19:09.640</a></span> | <span class="t">If you look up "Designing Great Data Products" and look at my name, this is based on really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1156" target="_blank">00:19:16.040</a></span> | <span class="t">mainly 10 years of work I did at a company I created called Optimal Decision Group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1162" target="_blank">00:19:22.240</a></span> | <span class="t">And Optimal Decision Group was all about how to use predictive modeling not just to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1170" target="_blank">00:19:30.060</a></span> | <span class="t">predictions but to optimize actions, and this whole paper is about that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1175" target="_blank">00:19:35.460</a></span> | <span class="t">In the end, it's really about coming up with a way to measure the benefit to your organization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1182" target="_blank">00:19:42.120</a></span> | <span class="t">or to your project of getting that extra 0.1% accuracy, and there are some suggestions on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1188" target="_blank">00:19:48.040</a></span> | <span class="t">how to do that in this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1197" target="_blank">00:19:57.760</a></span> | <span class="t">So we looked at a kind of a visual vocabulary that we developed for writing down neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1208" target="_blank">00:20:08.660</a></span> | <span class="t">nets where any colored box represents a matrix of activations, that's a really important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1217" target="_blank">00:20:17.360</a></span> | <span class="t">point to remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1218" target="_blank">00:20:18.360</a></span> | <span class="t">A colored box represents a matrix of activations, so it could either be the input matrix, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1225" target="_blank">00:20:25.880</a></span> | <span class="t">could be the output matrix, or it could be the matrix that comes from taking an input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1231" target="_blank">00:20:31.840</a></span> | <span class="t">and putting it through like a matrix product.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1237" target="_blank">00:20:37.280</a></span> | <span class="t">The rectangle boxes represent inputs, the circular ones represent hidden, so intermediate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1244" target="_blank">00:20:44.360</a></span> | <span class="t">activations, and the triangles represent outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1249" target="_blank">00:20:49.200</a></span> | <span class="t">Arrows, very importantly, represent what we'll call layer operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1254" target="_blank">00:20:54.760</a></span> | <span class="t">And a layer operation is anything that you do to one colored box to create another colored</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1258" target="_blank">00:20:58.560</a></span> | <span class="t">box.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1259" target="_blank">00:20:59.560</a></span> | <span class="t">In general, it's almost always going to involve some kind of linear function like a matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1264" target="_blank">00:21:04.000</a></span> | <span class="t">product or convolution, and it will probably also include some kind of activation function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1268" target="_blank">00:21:08.880</a></span> | <span class="t">like ReLU or softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1273" target="_blank">00:21:13.960</a></span> | <span class="t">Because the activation functions are pretty unimportant in terms of detail, I started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1279" target="_blank">00:21:19.560</a></span> | <span class="t">removing those from the pictures as we started to look at more complex models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1285" target="_blank">00:21:25.560</a></span> | <span class="t">And then in fact, because the layer operations actually are pretty consistent, we probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1289" target="_blank">00:21:29.320</a></span> | <span class="t">know what they are, I started removing those as well, just to keep these simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1295" target="_blank">00:21:35.560</a></span> | <span class="t">And so we're simplifying these diagrams to try and just keep the main pieces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1300" target="_blank">00:21:40.200</a></span> | <span class="t">And as we did so, we could start to create more complex diagrams.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1303" target="_blank">00:21:43.520</a></span> | <span class="t">And so we talked about a kind of language model where we would take inputs of a character,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1310" target="_blank">00:21:50.800</a></span> | <span class="t">character number 1 and character number 2, and we would try and predict character number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1315" target="_blank">00:21:55.280</a></span> | <span class="t">3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1317" target="_blank">00:21:57.360</a></span> | <span class="t">And so we thought one way to do that would be to create a deep neural network with two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1323" target="_blank">00:22:03.200</a></span> | <span class="t">layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1325" target="_blank">00:22:05.040</a></span> | <span class="t">The character 1 input would go through a layer operation to create our first fully connected</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1330" target="_blank">00:22:10.280</a></span> | <span class="t">layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1331" target="_blank">00:22:11.920</a></span> | <span class="t">That would go through another layer operation to create a second fully connected layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1335" target="_blank">00:22:15.820</a></span> | <span class="t">And we would also add our second character input going through its own fully connected</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1341" target="_blank">00:22:21.600</a></span> | <span class="t">layer at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1343" target="_blank">00:22:23.440</a></span> | <span class="t">And to recall, the last important thing we have to learn is that two arrows going into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1348" target="_blank">00:22:28.160</a></span> | <span class="t">a single shape means that we are adding the results of those two layer operations together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1354" target="_blank">00:22:34.360</a></span> | <span class="t">So two arrows going into a shape represents summing up, element-wise, the results of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1361" target="_blank">00:22:41.960</a></span> | <span class="t">two layer operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1365" target="_blank">00:22:45.440</a></span> | <span class="t">So this was the kind of little visual vocabulary that we set up last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1371" target="_blank">00:22:51.060</a></span> | <span class="t">And I've kept track of it down here as to what the things are in case you forget.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1376" target="_blank">00:22:56.760</a></span> | <span class="t">So now I wanted to point out something really interesting, which is that there's three kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1383" target="_blank">00:23:03.760</a></span> | <span class="t">of layer operations going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1387" target="_blank">00:23:07.440</a></span> | <span class="t">Here I'm expanding this now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1388" target="_blank">00:23:08.480</a></span> | <span class="t">We've got predicting a fourth character of a sequence using characters 1, 2 and 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1393" target="_blank">00:23:13.400</a></span> | <span class="t">It's exactly the same method as on the previous slide.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1398" target="_blank">00:23:18.640</a></span> | <span class="t">There are layer operations that turn a character input into a hidden activation matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1406" target="_blank">00:23:26.240</a></span> | <span class="t">There's one here, here's one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1409" target="_blank">00:23:29.480</a></span> | <span class="t">There are layer operations that turn one hidden layer activation into a new hidden layer activation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1416" target="_blank">00:23:36.920</a></span> | <span class="t">And then there's an operation that takes hidden activations and turns it into output activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1423" target="_blank">00:23:43.360</a></span> | <span class="t">And so you can see here, I've colored them in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1425" target="_blank">00:23:45.040</a></span> | <span class="t">And here I've got a little legend of these different colors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1429" target="_blank">00:23:49.240</a></span> | <span class="t">Green are the input to hidden, blue is the output, and orange is the hidden to hidden.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1436" target="_blank">00:23:56.560</a></span> | <span class="t">So my claim is that the dimensions of the weight matrices for each of these different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1443" target="_blank">00:24:03.360</a></span> | <span class="t">colored arrows, all of the green ones have the same dimensions because they're taking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1447" target="_blank">00:24:07.480</a></span> | <span class="t">an input of vocab size and turning it into an output hidden activation of size number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1455" target="_blank">00:24:15.840</a></span> | <span class="t">of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1457" target="_blank">00:24:17.360</a></span> | <span class="t">So all of these arrows represent weight matrices which are of the same dimensionality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1462" target="_blank">00:24:22.640</a></span> | <span class="t">Ditto, the orange arrows represent weight matrices with the same dimensionality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1468" target="_blank">00:24:28.800</a></span> | <span class="t">I would go further than that though and say the green arrows represent semantically the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1473" target="_blank">00:24:33.920</a></span> | <span class="t">same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1475" target="_blank">00:24:35.320</a></span> | <span class="t">They're all saying how do you take a character and convert it into a hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1481" target="_blank">00:24:41.200</a></span> | <span class="t">And the orange arrows are all saying how do you take a hidden state from a previous character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1486" target="_blank">00:24:46.240</a></span> | <span class="t">and turn it into a hidden state for a new character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1489" target="_blank">00:24:49.660</a></span> | <span class="t">And then the blue one is saying how do you take a hidden state and turn it into an output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1495" target="_blank">00:24:55.920</a></span> | <span class="t">When you look at it that way, all of these circles are basically the same thing, they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1500" target="_blank">00:25:00.240</a></span> | <span class="t">just representing this hidden state at a different point in time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1504" target="_blank">00:25:04.400</a></span> | <span class="t">And I'm going to use this word 'time' in a fairly general way, I'm not really talking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1509" target="_blank">00:25:09.360</a></span> | <span class="t">about time, I'm just talking about the sequence in which we're presenting additional pieces</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1513" target="_blank">00:25:13.600</a></span> | <span class="t">of information to this model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1515" target="_blank">00:25:15.360</a></span> | <span class="t">We first of all present the first character, the second character and the third character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1521" target="_blank">00:25:21.840</a></span> | <span class="t">So we could redraw this whole thing in a simpler way and a more general way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1528" target="_blank">00:25:28.400</a></span> | <span class="t">Before we do, I'm actually going to show you in Keras how to build this model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1535" target="_blank">00:25:35.640</a></span> | <span class="t">And in doing so, we're going to learn a bit more about the functional API which hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1539" target="_blank">00:25:39.480</a></span> | <span class="t">you'll find pretty interesting and useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1547" target="_blank">00:25:47.240</a></span> | <span class="t">To do that, we are going to use this corpus of all of the collected works of niche shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1554" target="_blank">00:25:54.040</a></span> | <span class="t">So we load in those works, we find all of the unique characters of which there are 86.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1563" target="_blank">00:26:03.440</a></span> | <span class="t">Here they are, joined up together, and then we create a mapping from the character to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1569" target="_blank">00:26:09.640</a></span> | <span class="t">the index at which it appears in this list and a mapping from the index to the character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1575" target="_blank">00:26:15.720</a></span> | <span class="t">So this is basically creating the equivalent of these tables, or more specifically I guess</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1584" target="_blank">00:26:24.160</a></span> | <span class="t">this table.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1585" target="_blank">00:26:25.160</a></span> | <span class="t">But rather than using words, we're looking at characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1589" target="_blank">00:26:29.400</a></span> | <span class="t">So that allows us to take the text of Nietzsche and convert it into a list of numbers where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1597" target="_blank">00:26:37.320</a></span> | <span class="t">the numbers represent the number at which the character appears in this list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1602" target="_blank">00:26:42.360</a></span> | <span class="t">So here are the first 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1605" target="_blank">00:26:45.320</a></span> | <span class="t">So at any point we can turn this, that's called IDX, so we've converted our whole text into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1610" target="_blank">00:26:50.880</a></span> | <span class="t">the equivalent indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1614" target="_blank">00:26:54.040</a></span> | <span class="t">At any point we can turn it back into text by simply taking those indexes and looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1618" target="_blank">00:26:58.680</a></span> | <span class="t">them up in our index to character mapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1622" target="_blank">00:27:02.480</a></span> | <span class="t">So here you can see we turn it back into the start of the text again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1627" target="_blank">00:27:07.080</a></span> | <span class="t">So that's the data we're working with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1628" target="_blank">00:27:08.280</a></span> | <span class="t">The data we're working with is a list of character IDs at this point where those character IDs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1633" target="_blank">00:27:13.600</a></span> | <span class="t">represent the collected works of Nietzsche.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1638" target="_blank">00:27:18.060</a></span> | <span class="t">So we're going to build a model which attempts to predict the fourth character from the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1648" target="_blank">00:27:28.140</a></span> | <span class="t">three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1650" target="_blank">00:27:30.040</a></span> | <span class="t">So to do that, we're going to go through our whole list of indexes from 0 up to the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1659" target="_blank">00:27:39.560</a></span> | <span class="t">minus 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1661" target="_blank">00:27:41.920</a></span> | <span class="t">And we're going to create a whole list of the 0th, 4th, 8th, 12th etc characters and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1672" target="_blank">00:27:52.240</a></span> | <span class="t">a list of the 1st, 5th, 9th etc and the 2nd, 6th, 10th and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1680" target="_blank">00:28:00.320</a></span> | <span class="t">So this is going to represent the first character of each sequence, the second character of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1683" target="_blank">00:28:03.920</a></span> | <span class="t">each sequence, the third character of each sequence and this is the one we want to predict,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1687" target="_blank">00:28:07.440</a></span> | <span class="t">the fourth character of each sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1691" target="_blank">00:28:11.080</a></span> | <span class="t">So we can now turn these into NumPy arrays just by stacking them up together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1696" target="_blank">00:28:16.560</a></span> | <span class="t">And so now we've got our input for our first characters, second characters and third characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1702" target="_blank">00:28:22.160</a></span> | <span class="t">of every four character piece of this collected works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1707" target="_blank">00:28:27.440</a></span> | <span class="t">And then our y's, our labels, will simply be the fourth characters of each sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1713" target="_blank">00:28:33.680</a></span> | <span class="t">So here you can see them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1715" target="_blank">00:28:35.800</a></span> | <span class="t">So for example, if we took x1, x2 and x3 and took the first element of each, this is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1723" target="_blank">00:28:43.640</a></span> | <span class="t">first character of the text, the second character of the text, the third character of the text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1730" target="_blank">00:28:50.560</a></span> | <span class="t">and the fourth character of the text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1732" target="_blank">00:28:52.240</a></span> | <span class="t">So we'll be trying to predict this based on these three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1736" target="_blank">00:28:56.960</a></span> | <span class="t">And then we'll try to predict this based on these three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1741" target="_blank">00:29:01.460</a></span> | <span class="t">So that's our data format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1746" target="_blank">00:29:06.800</a></span> | <span class="t">So you can see we've got about 200,000 of these inputs for each of x1 through x3 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1757" target="_blank">00:29:17.000</a></span> | <span class="t">for y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1758" target="_blank">00:29:18.600</a></span> | <span class="t">And so as per usual, we're going to first of all turn them into embeddings by creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1763" target="_blank">00:29:23.320</a></span> | <span class="t">an embedding matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1765" target="_blank">00:29:25.120</a></span> | <span class="t">I will mention this is not normal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1769" target="_blank">00:29:29.840</a></span> | <span class="t">I haven't actually seen anybody else do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1773" target="_blank">00:29:33.360</a></span> | <span class="t">Most people just treat them as one-hot encodings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1777" target="_blank">00:29:37.440</a></span> | <span class="t">So for example, the most widely used blog post about car RNNs, which really made them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1786" target="_blank">00:29:46.800</a></span> | <span class="t">popular, was Andre Kepathys, and it's quite fantastic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1791" target="_blank">00:29:51.280</a></span> | <span class="t">And you can see that in his version, he shows them as being one-hot encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1803" target="_blank">00:30:03.040</a></span> | <span class="t">We're not going to do that, we're going to turn them into embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1810" target="_blank">00:30:10.080</a></span> | <span class="t">I think it makes a lot of sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1813" target="_blank">00:30:13.240</a></span> | <span class="t">Capital A and lowercase a have some similarities that an embedding can understand.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1817" target="_blank">00:30:17.880</a></span> | <span class="t">Different types of things that have to be opened and closed, like different types of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1821" target="_blank">00:30:21.640</a></span> | <span class="t">parentheses and quotes, have certain characteristics that can be constructed in embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1827" target="_blank">00:30:27.520</a></span> | <span class="t">There's all kinds of things that we would expect an embedding to capture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1831" target="_blank">00:30:31.560</a></span> | <span class="t">So my hypothesis was that an embedding is going to do a better job than just a one-hot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1847" target="_blank">00:30:47.120</a></span> | <span class="t">encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1848" target="_blank">00:30:48.880</a></span> | <span class="t">In my experiments over the last couple of weeks, that generally seems to be true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1854" target="_blank">00:30:54.960</a></span> | <span class="t">So we're going to take each character, 1-3, and turn them into embeddings by first creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1861" target="_blank">00:31:01.680</a></span> | <span class="t">an input layer for them and then creating an embedding layer for that input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1867" target="_blank">00:31:07.160</a></span> | <span class="t">And then we can return the input layer and the flattened version of the embedding layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1872" target="_blank">00:31:12.880</a></span> | <span class="t">So this is the input to an output of each of our three embedding layers for our three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1879" target="_blank">00:31:19.680</a></span> | <span class="t">input characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1882" target="_blank">00:31:22.300</a></span> | <span class="t">So that's basically our inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1886" target="_blank">00:31:26.280</a></span> | <span class="t">So we now have to decide how many activations do we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1898" target="_blank">00:31:38.320</a></span> | <span class="t">And so that's something we can just pick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1900" target="_blank">00:31:40.680</a></span> | <span class="t">So I've decided to go with 256.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1903" target="_blank">00:31:43.040</a></span> | <span class="t">That's something that seems reasonable, seems to have worked okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1907" target="_blank">00:31:47.840</a></span> | <span class="t">So we now have to somehow construct something where each of our green arrows ends up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1917" target="_blank">00:31:57.720</a></span> | <span class="t">the same weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1919" target="_blank">00:31:59.680</a></span> | <span class="t">And it turns out Keras makes this really easy with the Keras Functional API.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1925" target="_blank">00:32:05.200</a></span> | <span class="t">When you call dense like this, what it's actually doing is it's creating a layer with a specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1934" target="_blank">00:32:14.960</a></span> | <span class="t">weight matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1936" target="_blank">00:32:16.880</a></span> | <span class="t">Notice that I haven't passed in anything here to say what it's connected to, so it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1940" target="_blank">00:32:20.680</a></span> | <span class="t">part of a model yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1942" target="_blank">00:32:22.400</a></span> | <span class="t">This is just saying, I'm going to have something which is a dense layer which creates 256 activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1953" target="_blank">00:32:33.920</a></span> | <span class="t">and I'm going to call it dense_in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1956" target="_blank">00:32:36.280</a></span> | <span class="t">So it doesn't actually do anything until I then do this, so I connect it to something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1961" target="_blank">00:32:41.160</a></span> | <span class="t">So here I'm going to say character1's hidden state comes from taking character1, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1967" target="_blank">00:32:47.000</a></span> | <span class="t">was the output of our first embedding, and putting it through this dense_in layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1973" target="_blank">00:32:53.660</a></span> | <span class="t">So this is the thing which creates our first circle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1978" target="_blank">00:32:58.760</a></span> | <span class="t">So the embedding is the thing that creates the output of our first rectangle, this creates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1982" target="_blank">00:33:02.480</a></span> | <span class="t">our first circle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1984" target="_blank">00:33:04.080</a></span> | <span class="t">And so dense_in is the green arrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1988" target="_blank">00:33:08.960</a></span> | <span class="t">So what that means is that in order to create the next set of activations, we need to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1994" target="_blank">00:33:14.880</a></span> | <span class="t">the orange arrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=1996" target="_blank">00:33:16.560</a></span> | <span class="t">So since the orange arrow is different weight matrix to the green arrow, we have to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2000" target="_blank">00:33:20.920</a></span> | <span class="t">a new dense layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2002" target="_blank">00:33:22.240</a></span> | <span class="t">So here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2003" target="_blank">00:33:23.240</a></span> | <span class="t">I've got a new dense layer, and again, with n hidden outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2008" target="_blank">00:33:28.500</a></span> | <span class="t">So by creating a new dense layer, this is a whole separate weight matrix, this is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2012" target="_blank">00:33:32.000</a></span> | <span class="t">to keep track of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2014" target="_blank">00:33:34.800</a></span> | <span class="t">So now that I've done that, I can create my character2 hidden state, which is here, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2023" target="_blank">00:33:43.040</a></span> | <span class="t">I'm going to have to sum up two separate things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2025" target="_blank">00:33:45.980</a></span> | <span class="t">I'm going to take my character2 embedding, put it through my green arrow, dense_in, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2033" target="_blank">00:33:53.200</a></span> | <span class="t">going to be there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2034" target="_blank">00:33:54.200</a></span> | <span class="t">I'm going to take the output of my character1's hidden state and run it through my orange</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2041" target="_blank">00:34:01.840</a></span> | <span class="t">arrow, which we call dense_hidden, and then we're going to merge the two together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2048" target="_blank">00:34:08.280</a></span> | <span class="t">And merge by default does a sum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2052" target="_blank">00:34:12.040</a></span> | <span class="t">So this is adding together these two outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2056" target="_blank">00:34:16.880</a></span> | <span class="t">In other words, it's adding together these two layer operation outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2061" target="_blank">00:34:21.080</a></span> | <span class="t">And that gives us this circle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2064" target="_blank">00:34:24.600</a></span> | <span class="t">So the third character output is done in exactly the same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2068" target="_blank">00:34:28.160</a></span> | <span class="t">We take the third character's embedding, run it through our green arrow, take the result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2072" target="_blank">00:34:32.880</a></span> | <span class="t">of our previous hidden activations and run it through our orange arrow, and then merge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2076" target="_blank">00:34:36.920</a></span> | <span class="t">the two together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2078" target="_blank">00:34:38.000</a></span> | <span class="t">Question- Is the first output the size of the latent fields in the embedding?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2084" target="_blank">00:34:44.800</a></span> | <span class="t">Answer- The size of the latent embeddings we defined when we created the embeddings up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2095" target="_blank">00:34:55.600</a></span> | <span class="t">here, and we defined them as having nFAT size, and nFAT we defined as 42.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2107" target="_blank">00:35:07.200</a></span> | <span class="t">So C1, C2 and C3 represent the result of putting each character through this embedding and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2113" target="_blank">00:35:13.280</a></span> | <span class="t">getting out 42 latent factors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2118" target="_blank">00:35:18.800</a></span> | <span class="t">Those are then the things that we put into our green arrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2125" target="_blank">00:35:25.240</a></span> | <span class="t">So after doing this three times, we now have C3 hidden, which is 1, 2, 3 here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2133" target="_blank">00:35:33.160</a></span> | <span class="t">So we now need a new set of weights, we need another dense layer, the blue arrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2139" target="_blank">00:35:39.280</a></span> | <span class="t">So we'll call that "dense out".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2142" target="_blank">00:35:42.240</a></span> | <span class="t">And this needs to create an output of size 86, vocab size, we need to create something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2148" target="_blank">00:35:48.360</a></span> | <span class="t">which can match to the one-hot encoded list of possible characters, which is 86 long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2154" target="_blank">00:35:54.520</a></span> | <span class="t">So now that we've got this orange arrow, we can apply that to our final hidden state to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2159" target="_blank">00:35:59.800</a></span> | <span class="t">get our output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2162" target="_blank">00:36:02.400</a></span> | <span class="t">So in Keras, all we need to do now is call model "passing in" the three inputs, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2169" target="_blank">00:36:09.560</a></span> | <span class="t">the three inputs were returned to us way back here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2174" target="_blank">00:36:14.160</a></span> | <span class="t">Each time we created an embedding, we returned the input layer, so C1 in C2 in C3 input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2183" target="_blank">00:36:23.640</a></span> | <span class="t">So passing in the three inputs, and passing in our output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2188" target="_blank">00:36:28.220</a></span> | <span class="t">So that's our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2189" target="_blank">00:36:29.640</a></span> | <span class="t">And so we can now compile it, set a learning rate, fit it, and as you can see, its loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2195" target="_blank">00:36:35.900</a></span> | <span class="t">is gradually decreasing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2199" target="_blank">00:36:39.080</a></span> | <span class="t">And we can then test that out very easily by creating a little function that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2203" target="_blank">00:36:43.680</a></span> | <span class="t">to pass three letters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2206" target="_blank">00:36:46.520</a></span> | <span class="t">We're going to take those three letters and turn them into character indices, just look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2212" target="_blank">00:36:52.000</a></span> | <span class="t">them up to find the indexes, turn each of those into a numpy array, call model.predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2218" target="_blank">00:36:58.960</a></span> | <span class="t">on those three arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2222" target="_blank">00:37:02.960</a></span> | <span class="t">That gives us 86 outputs, which we then do argmax to find which index into those 86 is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2234" target="_blank">00:37:14.240</a></span> | <span class="t">the highest, and that's the character number that we want to return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2238" target="_blank">00:37:18.400</a></span> | <span class="t">So if we pass in PHI, it thinks that L is most likely next, space th is most likely next,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2247" target="_blank">00:37:27.640</a></span> | <span class="t">space an, it thinks that d is most likely next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2251" target="_blank">00:37:31.480</a></span> | <span class="t">So you can see that it seems to be doing a pretty reasonable job of taking three characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2256" target="_blank">00:37:36.480</a></span> | <span class="t">and returning a fourth character that seems pretty sensible, not the world's most powerful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2262" target="_blank">00:37:42.800</a></span> | <span class="t">model, but a good example of how we can construct pretty arbitrary architectures using Keras</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2272" target="_blank">00:37:52.880</a></span> | <span class="t">and then letting SGD do the work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2280" target="_blank">00:38:00.640</a></span> | <span class="t">This model, how would it consider the context in which we are trying to predict the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2286" target="_blank">00:38:06.520</a></span> | <span class="t">context, it knows nothing about the context, all it has at any point in time is the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2292" target="_blank">00:38:12.960</a></span> | <span class="t">three characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2293" target="_blank">00:38:13.960</a></span> | <span class="t">So it's not a great model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2296" target="_blank">00:38:16.960</a></span> | <span class="t">We're going to improve it though, we've got to start somewhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2301" target="_blank">00:38:21.200</a></span> | <span class="t">In order to answer your question, let's build this up a little further, and rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2318" target="_blank">00:38:38.560</a></span> | <span class="t">trying to predict character 4 from the previous three characters, let's try and predict character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2323" target="_blank">00:38:43.120</a></span> | <span class="t">n from the previous n-1 characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2326" target="_blank">00:38:46.920</a></span> | <span class="t">And since all of these circles basically mean the same thing, which is the hidden state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2331" target="_blank">00:38:51.040</a></span> | <span class="t">at this point, and since all of these orange arrows are literally the same thing, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2335" target="_blank">00:38:55.520</a></span> | <span class="t">a dense layer with exactly the same weight matrix, let's take all of the circles on top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2339" target="_blank">00:38:59.640</a></span> | <span class="t">of each other, which means that these orange arrows then can just become one arrow pointing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2344" target="_blank">00:39:04.280</a></span> | <span class="t">into itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2346" target="_blank">00:39:06.040</a></span> | <span class="t">And this is the definition of a recurrent neural network.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2350" target="_blank">00:39:10.400</a></span> | <span class="t">When we see it in this form, we say that we're looking at it in its recurrent form.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2355" target="_blank">00:39:15.280</a></span> | <span class="t">When we see it in this form, we can say that we're looking at it in its unrolled form, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2361" target="_blank">00:39:21.080</a></span> | <span class="t">unfolded form.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2362" target="_blank">00:39:22.080</a></span> | <span class="t">They're both very common.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2364" target="_blank">00:39:24.000</a></span> | <span class="t">This is obviously neater.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2367" target="_blank">00:39:27.840</a></span> | <span class="t">And so for quickly sketching out an RNN architecture, this is much more convenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2373" target="_blank">00:39:33.040</a></span> | <span class="t">But actually, this unrolled form is really important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2375" target="_blank">00:39:35.880</a></span> | <span class="t">For example, when Keras uses TensorFlow as a backend, it actually always unrolls it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2382" target="_blank">00:39:42.560</a></span> | <span class="t">this way in order to compute it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2387" target="_blank">00:39:47.160</a></span> | <span class="t">That obviously takes up a lot more memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2390" target="_blank">00:39:50.760</a></span> | <span class="t">And so it's quite nice being able to use the Theano backend with Keras which can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2395" target="_blank">00:39:55.200</a></span> | <span class="t">directly implement it as this kind of loop, and that's what we'll be doing today shortly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2403" target="_blank">00:40:03.160</a></span> | <span class="t">But in general, we've got the same idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2404" target="_blank">00:40:04.360</a></span> | <span class="t">We're going to have character 1 input come in, go through the first green arrow, go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2411" target="_blank">00:40:11.640</a></span> | <span class="t">the first orange arrow, and from then on, we can just say take the second character,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2417" target="_blank">00:40:17.760</a></span> | <span class="t">repeat the third character, repeat, and at each time period, we're getting a new character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2423" target="_blank">00:40:23.680</a></span> | <span class="t">going through a layer operation, as well as taking the previous hidden state and putting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2428" target="_blank">00:40:28.200</a></span> | <span class="t">it through its layer operation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2431" target="_blank">00:40:31.440</a></span> | <span class="t">And then at the very end, we will put it through a different layer operation, the blue arrow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2435" target="_blank">00:40:35.800</a></span> | <span class="t">to get our output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2437" target="_blank">00:40:37.960</a></span> | <span class="t">So I'm going to show you this in Keras now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2440" target="_blank">00:40:40.640</a></span> | <span class="t">Does every fully connected layer have to have the same activation function?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2450" target="_blank">00:40:50.560</a></span> | <span class="t">In general, no, in all of the models we've seen so far, we have constructed them in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2461" target="_blank">00:41:01.200</a></span> | <span class="t">way where you can write anything you like as the activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2467" target="_blank">00:41:07.440</a></span> | <span class="t">In general though, I haven't seen any examples of successful architectures which mix activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2474" target="_blank">00:41:14.120</a></span> | <span class="t">functions other than at the output layer would pretty much always be a softmax for classification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2482" target="_blank">00:41:22.080</a></span> | <span class="t">I'm not sure it's not something that might become a good idea, it's just not something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2487" target="_blank">00:41:27.840</a></span> | <span class="t">that anybody has done very successfully with so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2492" target="_blank">00:41:32.560</a></span> | <span class="t">I will mention something important about activation functions though, which is that you can use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2499" target="_blank">00:41:39.360</a></span> | <span class="t">pretty much almost any nonlinear function as an activation function and get pretty reasonable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2504" target="_blank">00:41:44.360</a></span> | <span class="t">results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2505" target="_blank">00:41:45.360</a></span> | <span class="t">There are actually some pretty cool papers that people have written where they've tried</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2508" target="_blank">00:41:48.680</a></span> | <span class="t">all kinds of weird activation functions and they pretty much all work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2512" target="_blank">00:41:52.760</a></span> | <span class="t">So it's not something to get hung up about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2515" target="_blank">00:41:55.280</a></span> | <span class="t">It's more just certain activation functions will train more quickly and more resiliently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2522" target="_blank">00:42:02.360</a></span> | <span class="t">In particular, ReLU and ReLU variations tend to work particularly well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2530" target="_blank">00:42:10.560</a></span> | <span class="t">So let's implement this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2535" target="_blank">00:42:15.320</a></span> | <span class="t">So we're going to use a very similar approach to what we used before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2540" target="_blank">00:42:20.840</a></span> | <span class="t">And we're going to create our first RNN and we're going to create it from scratch using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2545" target="_blank">00:42:25.520</a></span> | <span class="t">nothing but standard Keras dense layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2549" target="_blank">00:42:29.920</a></span> | <span class="t">In this case, we can't create C1, C2 and C3, we're going to have to create an array of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2558" target="_blank">00:42:38.840</a></span> | <span class="t">our inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2559" target="_blank">00:42:39.840</a></span> | <span class="t">We're going to have to decide what N we're going to use, and so for this one I've decided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2564" target="_blank">00:42:44.480</a></span> | <span class="t">to use 8, so CS is characters, so I'm going to use 8 characters to predict the 9th character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2572" target="_blank">00:42:52.880</a></span> | <span class="t">So I'm going to create an array with 8 elements in it, and each element will contain a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2580" target="_blank">00:43:00.280</a></span> | <span class="t">of the 0, 8, 16, 24th character, the 1, 9, 17, etc. character, the 2, 10, 18, etc. character,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2591" target="_blank">00:43:11.400</a></span> | <span class="t">just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2592" target="_blank">00:43:12.400</a></span> | <span class="t">So we're going to have a sequence of inputs where each one is offset by 1 from the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2600" target="_blank">00:43:20.480</a></span> | <span class="t">one, and then our output will be exactly the same thing, except we're going to look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2607" target="_blank">00:43:27.960</a></span> | <span class="t">the index to cross by CS, so 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2611" target="_blank">00:43:31.800</a></span> | <span class="t">So this will be the 8th thing in each sequence and we're going to predict it with the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2616" target="_blank">00:43:36.480</a></span> | <span class="t">ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2619" target="_blank">00:43:39.640</a></span> | <span class="t">So now we can go through every one of those input data items, lists, and turn them into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2624" target="_blank">00:43:44.960</a></span> | <span class="t">a NumPy array, and so here you can see that we have 8 inputs, and each one is at length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2636" target="_blank">00:43:56.560</a></span> | <span class="t">75,000 or so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2639" target="_blank">00:43:59.560</a></span> | <span class="t">Do the same thing for our y, get a NumPy array out of it, and here we can visualize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2649" target="_blank">00:44:09.200</a></span> | <span class="t">So here are the first 8 elements of x, so in looking at the first 8 elements of x, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2659" target="_blank">00:44:19.280</a></span> | <span class="t">look at the very first element of each one, 40, 42, 29.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2663" target="_blank">00:44:23.460</a></span> | <span class="t">So this column is the first 8 characters of our text, and here is the 9th character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2671" target="_blank">00:44:31.560</a></span> | <span class="t">So the first thing that the model will try to do is to look at these 8 to predict this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2676" target="_blank">00:44:36.480</a></span> | <span class="t">and then look at these 8 to predict this, and look at these 8 and predict this and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2681" target="_blank">00:44:41.400</a></span> | <span class="t">And indeed you can see that this list here is exactly the same as this list here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2688" target="_blank">00:44:48.360</a></span> | <span class="t">The final character of each sequence is the same as the first character of the next sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2693" target="_blank">00:44:53.040</a></span> | <span class="t">So it's almost exactly the same as our previous data, we've just done it in a more flexible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2697" target="_blank">00:44:57.200</a></span> | <span class="t">way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2699" target="_blank">00:44:59.040</a></span> | <span class="t">We'll create 43 latent factors as before, where we use exactly the same embedding input function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2705" target="_blank">00:45:05.960</a></span> | <span class="t">as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2706" target="_blank">00:45:06.960</a></span> | <span class="t">And again, we're just going to have to use lists to store everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2711" target="_blank">00:45:11.960</a></span> | <span class="t">So in this case, all of our embeddings are going to be in a list, so we'll go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2715" target="_blank">00:45:15.400</a></span> | <span class="t">each of our characters and create an embedding input and output for each one, store it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2725" target="_blank">00:45:25.400</a></span> | <span class="t">And here we're going to define them all at once, our green arrow, orange arrow, and blue</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2730" target="_blank">00:45:30.200</a></span> | <span class="t">arrow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2731" target="_blank">00:45:31.200</a></span> | <span class="t">So here we're basically saying we've got 3 different weight matrices that we want Keras</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2735" target="_blank">00:45:35.720</a></span> | <span class="t">to keep track of for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2739" target="_blank">00:45:39.960</a></span> | <span class="t">So the very first hidden state here is going to take the list of all of our inputs, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2749" target="_blank">00:45:49.200</a></span> | <span class="t">first one of those, and then that's a tuple of two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2752" target="_blank">00:45:52.960</a></span> | <span class="t">The first is the input to it, and the second is the output of the embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2756" target="_blank">00:45:56.320</a></span> | <span class="t">So we're going to take the output of the embedding for the very first character, pass that into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2761" target="_blank">00:46:01.840</a></span> | <span class="t">our green arrow, and that's going to give us our initial hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2768" target="_blank">00:46:08.240</a></span> | <span class="t">And then this looks exactly the same as we saw before, but rather than doing it listing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2774" target="_blank">00:46:14.160</a></span> | <span class="t">separately, we're just going to loop through all of our remaining 1 through 8 characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2779" target="_blank">00:46:19.400</a></span> | <span class="t">and go ahead and create the green arrow, orange arrow, and add the two together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2787" target="_blank">00:46:27.900</a></span> | <span class="t">So finally we can take that final hidden state, put it through our blue arrow to create our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2793" target="_blank">00:46:33.400</a></span> | <span class="t">final output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2795" target="_blank">00:46:35.280</a></span> | <span class="t">So we can then tell Keras that our model is all of the embedding inputs for that list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2802" target="_blank">00:46:42.040</a></span> | <span class="t">we created together, that's our inputs, and then our output that we just created is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2806" target="_blank">00:46:46.880</a></span> | <span class="t">output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2808" target="_blank">00:46:48.280</a></span> | <span class="t">And we can go ahead and fit that model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2811" target="_blank">00:46:51.000</a></span> | <span class="t">So we would expect this to be more accurate because it's now got 8 pieces of context in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2817" target="_blank">00:46:57.720</a></span> | <span class="t">order to predict.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2819" target="_blank">00:46:59.080</a></span> | <span class="t">So previously we were getting this time we get down to 1.8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2831" target="_blank">00:47:11.200</a></span> | <span class="t">So it's still not great, but it's an improvement and we can create exactly the same kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2835" target="_blank">00:47:15.160</a></span> | <span class="t">tests as before, so now we can pass in 8 characters and get a prediction of the ninth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2840" target="_blank">00:47:20.640</a></span> | <span class="t">And these all look pretty reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2844" target="_blank">00:47:24.160</a></span> | <span class="t">So that is our first RNN that we've now built from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2850" target="_blank">00:47:30.440</a></span> | <span class="t">This kind of RNN where we're taking a list and predicting a single thing is most likely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2858" target="_blank">00:47:38.160</a></span> | <span class="t">to be useful for things like sentiment analysis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2864" target="_blank">00:47:44.160</a></span> | <span class="t">Remember our sentiment analysis example using IMDB?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2867" target="_blank">00:47:47.880</a></span> | <span class="t">So in this case we were taking a sequence, being a list of words in a sentence, and predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2872" target="_blank">00:47:52.840</a></span> | <span class="t">whether or not something is positive sentiment or negative sentiment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2876" target="_blank">00:47:56.400</a></span> | <span class="t">So that would seem like an appropriate kind of use case for this style of RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2886" target="_blank">00:48:06.300</a></span> | <span class="t">So at that moment my computer crashed and we lost a little bit of the class's video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2893" target="_blank">00:48:13.000</a></span> | <span class="t">So I'm just going to fill in the bit that we missed here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2903" target="_blank">00:48:23.440</a></span> | <span class="t">So I wanted to show you something kind of interesting, which you may have noticed, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2907" target="_blank">00:48:27.620</a></span> | <span class="t">is when we created our hidden dense layer, that is our orange arrow, I did not initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2920" target="_blank">00:48:40.160</a></span> | <span class="t">it in the default way which is the GLORO initialization, but instead I said "init = identity".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2928" target="_blank">00:48:48.600</a></span> | <span class="t">You may also have noticed that the equivalent thing was shown in our Keras RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2937" target="_blank">00:48:57.320</a></span> | <span class="t">This here where it says "inner init = identity" was referring to the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2942" target="_blank">00:49:02.360</a></span> | <span class="t">It's referring to what is the initialization that is used for this orange arrow, how are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2949" target="_blank">00:49:09.040</a></span> | <span class="t">those weights originally initialized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2952" target="_blank">00:49:12.120</a></span> | <span class="t">So rather than initializing them randomly, we're going to initialize them with an identity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2958" target="_blank">00:49:18.040</a></span> | <span class="t">matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2959" target="_blank">00:49:19.040</a></span> | <span class="t">An identity matrix, you may recall from your linear algebra at school, is a matrix which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2964" target="_blank">00:49:24.740</a></span> | <span class="t">is all zeros, except it is just ones down the diagonal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2970" target="_blank">00:49:30.320</a></span> | <span class="t">So if you multiply any matrix by the identity matrix, it doesn't change the original matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2976" target="_blank">00:49:36.800</a></span> | <span class="t">at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2977" target="_blank">00:49:37.800</a></span> | <span class="t">You can write back exactly what you started with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2980" target="_blank">00:49:40.440</a></span> | <span class="t">So in other words, we're going to start off by initializing our orange arrow, not with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2987" target="_blank">00:49:47.660</a></span> | <span class="t">a random matrix, but with a matrix that causes the hidden state to not change at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=2996" target="_blank">00:49:56.880</a></span> | <span class="t">That makes some intuitive sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3000" target="_blank">00:50:00.040</a></span> | <span class="t">It seems reasonable to say "well in the absence of other knowledge to the country, why don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3004" target="_blank">00:50:04.520</a></span> | <span class="t">we start off by having the hidden state stay the same until the SGD has a chance to update</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3011" target="_blank">00:50:11.320</a></span> | <span class="t">that."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3012" target="_blank">00:50:12.320</a></span> | <span class="t">But it actually turns out that it also makes sense based on an empirical analysis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3018" target="_blank">00:50:18.360</a></span> | <span class="t">So since we always only do things that Jeffrey Hinton tells us to do, that's good news because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3023" target="_blank">00:50:23.680</a></span> | <span class="t">this is a paper by Jeff Hinton in which he points out this rather neat trick which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3029" target="_blank">00:50:29.960</a></span> | <span class="t">if you initialize an RNN with the hidden weight matrix initialized to an identity matrix and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3039" target="_blank">00:50:39.960</a></span> | <span class="t">use rectified linear units as we are here, you actually get an architecture which can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3051" target="_blank">00:50:51.260</a></span> | <span class="t">get fantastic results on some reasonably significant problems including speech recognition and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3059" target="_blank">00:50:59.840</a></span> | <span class="t">language modeling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3060" target="_blank">00:51:00.840</a></span> | <span class="t">I don't see this paper referred to or discussed very often, even though it is well over a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3067" target="_blank">00:51:07.600</a></span> | <span class="t">year old now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3069" target="_blank">00:51:09.240</a></span> | <span class="t">So I'm not sure if people forgot about it or haven't noticed it or what, but this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3073" target="_blank">00:51:13.200</a></span> | <span class="t">actually a good trick to remember is that you can often get quite a long way doing nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3079" target="_blank">00:51:19.560</a></span> | <span class="t">but an identity matrix initialization and rectified linear units in just as we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3085" target="_blank">00:51:25.680</a></span> | <span class="t">done here to set up our architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3089" target="_blank">00:51:29.780</a></span> | <span class="t">Okay, so that's a nice little trick to remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3096" target="_blank">00:51:36.440</a></span> | <span class="t">And so the next thing we're going to do is to make a couple of minor changes to this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3105" target="_blank">00:51:45.120</a></span> | <span class="t">diagram.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3107" target="_blank">00:51:47.200</a></span> | <span class="t">So the first change we're going to make is we're going to take this rectangle here, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3111" target="_blank">00:51:51.160</a></span> | <span class="t">this rectangle is referring to what is it that we repeat and so since in this case we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3117" target="_blank">00:51:57.320</a></span> | <span class="t">predicting character n from characters 1 through n minus 1, then this whole area here we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3126" target="_blank">00:52:06.040</a></span> | <span class="t">looping from 2 to n minus 1 before we generate our output once again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3133" target="_blank">00:52:13.480</a></span> | <span class="t">So what we're going to do is we're going to take this triangle and we're going to put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3137" target="_blank">00:52:17.540</a></span> | <span class="t">it inside the loop, put it inside the rectangle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3141" target="_blank">00:52:21.700</a></span> | <span class="t">And so what that means is that every time we loop through this, we're going to generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3146" target="_blank">00:52:26.200</a></span> | <span class="t">another output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3147" target="_blank">00:52:27.440</a></span> | <span class="t">So rather than generating one output at the end, this is going to predict characters 2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3152" target="_blank">00:52:32.120</a></span> | <span class="t">through n using characters n1 through n minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3157" target="_blank">00:52:37.980</a></span> | <span class="t">So it's going to predict character 2 using character 1 and character 3 using characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3164" target="_blank">00:52:44.200</a></span> | <span class="t">1 and 2 and character 4 using characters 1, 2 and 3 and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3170" target="_blank">00:52:50.440</a></span> | <span class="t">And so that's what this model would do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3171" target="_blank">00:52:51.840</a></span> | <span class="t">It's nearly exactly the same as the previous model, except after every single step after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3178" target="_blank">00:52:58.760</a></span> | <span class="t">creating the hidden state on every step, we're going to create an output every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3183" target="_blank">00:53:03.040</a></span> | <span class="t">So this is not going to create a single output like this does, which predicted a single character,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3189" target="_blank">00:53:09.120</a></span> | <span class="t">the last character, in fact, the next after the last character of the sequence, character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3194" target="_blank">00:53:14.480</a></span> | <span class="t">n using characters 1 through n minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3198" target="_blank">00:53:18.880</a></span> | <span class="t">This is going to predict a whole sequence of characters 2 through n using characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3202" target="_blank">00:53:22.640</a></span> | <span class="t">1 through n minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3205" target="_blank">00:53:25.480</a></span> | <span class="t">OK, so that was all the stuff that we'd lost when we had our computer crash.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3211" target="_blank">00:53:31.120</a></span> | <span class="t">So let's now go back to the lesson.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3214" target="_blank">00:53:34.400</a></span> | <span class="t">Let's now talk about how we would implement this sequence, where we're going to predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3218" target="_blank">00:53:38.400</a></span> | <span class="t">characters 2 through n using characters 1 through n minus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3224" target="_blank">00:53:44.520</a></span> | <span class="t">Now why would this be a good idea?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3227" target="_blank">00:53:47.120</a></span> | <span class="t">There's a few reasons, but one obvious reason why this would be a good idea is that if we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3231" target="_blank">00:53:51.800</a></span> | <span class="t">only predicting one output for every n inputs, then the number of times that our model has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3239" target="_blank">00:53:59.520</a></span> | <span class="t">the opportunity to back-propagate those in gradients and improve those weights is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3245" target="_blank">00:54:05.400</a></span> | <span class="t">once for each sequence of characters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3248" target="_blank">00:54:08.880</a></span> | <span class="t">Whereas if we predict characters 2 through n using characters 1 through n minus 1, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3255" target="_blank">00:54:15.280</a></span> | <span class="t">actually getting a whole lot of feedback about how our model is going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3258" target="_blank">00:54:18.840</a></span> | <span class="t">So we can back-propagate n times, or actually n minus 1 times every time we do another sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3267" target="_blank">00:54:27.600</a></span> | <span class="t">So there's a lot more learning going on for nearly the same amount of computation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3275" target="_blank">00:54:35.240</a></span> | <span class="t">The other reason this is handy is that as you'll see in a moment, it's very helpful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3278" target="_blank">00:54:38.960</a></span> | <span class="t">for creating RNNs which can do truly long-term dependencies or context, as one of the people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3287" target="_blank">00:54:47.480</a></span> | <span class="t">asking a question earlier described it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3289" target="_blank">00:54:49.920</a></span> | <span class="t">So we're going to start here before we look at how to do context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3293" target="_blank">00:54:53.800</a></span> | <span class="t">And so really anytime you're doing a kind of sequence-to-sequence exercise, you probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3300" target="_blank">00:55:00.000</a></span> | <span class="t">want to construct something of this format where your triangle is inside the square rather</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3305" target="_blank">00:55:05.920</a></span> | <span class="t">than outside the square.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3310" target="_blank">00:55:10.240</a></span> | <span class="t">It's going to look very similar, and so I'm calling this returning sequences, rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3315" target="_blank">00:55:15.840</a></span> | <span class="t">returning a single character, we're going to return a sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3319" target="_blank">00:55:19.200</a></span> | <span class="t">And really, most things are the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3322" target="_blank">00:55:22.400</a></span> | <span class="t">Our character_in data is identical to before, so I've just commented it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3328" target="_blank">00:55:28.600</a></span> | <span class="t">And now our character_out output isn't just a single character, but it's actually a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3334" target="_blank">00:55:34.520</a></span> | <span class="t">of 8 sequences again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3336" target="_blank">00:55:36.480</a></span> | <span class="t">In fact, it's exactly the same as the input, except that I have removed the -1, so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3343" target="_blank">00:55:43.360</a></span> | <span class="t">just shifted over by 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3347" target="_blank">00:55:47.320</a></span> | <span class="t">In each sequence, the first character will be used to predict the second, the first and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3351" target="_blank">00:55:51.720</a></span> | <span class="t">second will predict the third, the first, second and third will predict the fourth and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3358" target="_blank">00:55:58.000</a></span> | <span class="t">So we've got a lot more predictions going on, and therefore a lot more opportunity for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3361" target="_blank">00:56:01.600</a></span> | <span class="t">the model to learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3364" target="_blank">00:56:04.380</a></span> | <span class="t">So then we will create our y's just as before with our x's.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3372" target="_blank">00:56:12.400</a></span> | <span class="t">And so now our y dataset looks exactly like our x dataset did, but everything's just shifted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3378" target="_blank">00:56:18.520</a></span> | <span class="t">across by one character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3381" target="_blank">00:56:21.360</a></span> | <span class="t">And the model's going to look almost identical as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3384" target="_blank">00:56:24.160</a></span> | <span class="t">We've got our three dense layers as before, but we're going to do one other thing different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3391" target="_blank">00:56:31.160</a></span> | <span class="t">to before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3392" target="_blank">00:56:32.160</a></span> | <span class="t">Rather than treating the first character as special, I won't treat it as special.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3397" target="_blank">00:56:37.400</a></span> | <span class="t">I'm going to move the character into here, so rather than repeating from 2 to n-1, I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3402" target="_blank">00:56:42.960</a></span> | <span class="t">going to repeat from 1 to n-1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3405" target="_blank">00:56:45.040</a></span> | <span class="t">So I've moved my first character into here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3407" target="_blank">00:56:47.520</a></span> | <span class="t">So the only thing I have to be careful of is that we have to somehow initialize our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3411" target="_blank">00:56:51.640</a></span> | <span class="t">hidden state to something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3413" target="_blank">00:56:53.440</a></span> | <span class="t">So we're going to initialize our hidden state to a vector of zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3419" target="_blank">00:56:59.200</a></span> | <span class="t">So here we do that, we say we're going to have something to initialize our hidden state,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3424" target="_blank">00:57:04.080</a></span> | <span class="t">which we're going to feed it with a vector of zeros shortly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3426" target="_blank">00:57:06.680</a></span> | <span class="t">So our initial hidden state is just going to be the result of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3431" target="_blank">00:57:11.180</a></span> | <span class="t">And then our loop is identical to before, but at the end of every loop, we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3436" target="_blank">00:57:16.720</a></span> | <span class="t">to append this output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3440" target="_blank">00:57:20.080</a></span> | <span class="t">So we're now going to have 8 outputs for every sequence rather than 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3444" target="_blank">00:57:24.960</a></span> | <span class="t">And so now our model has two changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3447" target="_blank">00:57:27.400</a></span> | <span class="t">The first is it's got an array of outputs, and the second is that we have to add the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3453" target="_blank">00:57:33.480</a></span> | <span class="t">thing that we're going to use to store our vector of zeros somewhere, so we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3458" target="_blank">00:57:38.640</a></span> | <span class="t">to put this into our input as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3461" target="_blank">00:57:41.040</a></span> | <span class="t">The box refers to the area that we're looping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3471" target="_blank">00:57:51.880</a></span> | <span class="t">So initially we repeated the character n input coming into here, and then the hidden state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3479" target="_blank">00:57:59.680</a></span> | <span class="t">coming into itself from 2 to n-1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3482" target="_blank">00:58:02.040</a></span> | <span class="t">So the box is the thing which I'm looping through all those times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3487" target="_blank">00:58:07.000</a></span> | <span class="t">This time I'm looping through this whole thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3489" target="_blank">00:58:09.360</a></span> | <span class="t">So a character input coming in, generating the hidden state, and creating an output, repeating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3494" target="_blank">00:58:14.780</a></span> | <span class="t">that whole thing every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3498" target="_blank">00:58:18.500</a></span> | <span class="t">And so now you can see creating the output is inside the loop rather than outside the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3504" target="_blank">00:58:24.960</a></span> | <span class="t">loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3505" target="_blank">00:58:25.960</a></span> | <span class="t">So therefore we end up with an array of outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3510" target="_blank">00:58:30.920</a></span> | <span class="t">So our model's nearly exactly the same as before, it's just got these two changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3514" target="_blank">00:58:34.680</a></span> | <span class="t">So now when we fit our model, we're going to add an array of zeros to the start of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3525" target="_blank">00:58:45.320</a></span> | <span class="t">inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3526" target="_blank">00:58:46.320</a></span> | <span class="t">Our outputs are going to be those lists of 8 that have been offset by 1, and we can go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3532" target="_blank">00:58:52.800</a></span> | <span class="t">ahead and train this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3535" target="_blank">00:58:55.160</a></span> | <span class="t">And you can see that as we train it, now we don't just have one loss, we have 8 losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3544" target="_blank">00:59:04.400</a></span> | <span class="t">And that's because every one of those 8 outputs has its own loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3548" target="_blank">00:59:08.000</a></span> | <span class="t">How are we going at predicting character 1 in each sequence?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3550" target="_blank">00:59:10.440</a></span> | <span class="t">2, 3, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3551" target="_blank">00:59:11.880</a></span> | <span class="t">And as you would expect, our ability to predict the first character using nothing but a vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3558" target="_blank">00:59:18.500</a></span> | <span class="t">of zeros is pretty limited.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3560" target="_blank">00:59:20.640</a></span> | <span class="t">So that very quickly flattens out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3563" target="_blank">00:59:23.880</a></span> | <span class="t">Whereas our ability to predict the 8th character, it has a lot more context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3568" target="_blank">00:59:28.760</a></span> | <span class="t">It has 7 characters of context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3571" target="_blank">00:59:31.840</a></span> | <span class="t">And so you can see that the 8th character's loss keeps on improving.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3577" target="_blank">00:59:37.200</a></span> | <span class="t">And indeed, by a few epochs, we have a significantly better loss than we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3584" target="_blank">00:59:44.160</a></span> | <span class="t">So this is what a sequence model looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3586" target="_blank">00:59:46.800</a></span> | <span class="t">And so you can see a sequence model when we test it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3590" target="_blank">00:59:50.760</a></span> | <span class="t">We pass in a sequence like this, space this is, and after every character, it returns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3598" target="_blank">00:59:58.200</a></span> | <span class="t">its guess.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3599" target="_blank">00:59:59.200</a></span> | <span class="t">So after seeing a space, it guesses the next will be a t.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3602" target="_blank">01:00:02.600</a></span> | <span class="t">After seeing a space t, it guesses the next will be an h.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3605" target="_blank">01:00:05.840</a></span> | <span class="t">After seeing a space th, it guesses the next will be an e and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3612" target="_blank">01:00:12.080</a></span> | <span class="t">And so you can see that it's predicting some pretty reasonable things here, and indeed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3618" target="_blank">01:00:18.120</a></span> | <span class="t">quite often there, what actually happened.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3621" target="_blank">01:00:21.080</a></span> | <span class="t">So after seeing space par t, it expects that will be the end of the word, and indeed it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3626" target="_blank">01:00:26.040</a></span> | <span class="t">was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3627" target="_blank">01:00:27.040</a></span> | <span class="t">So after seeing par t, it's guessing that the next word is going to be of, and indeed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3630" target="_blank">01:00:30.760</a></span> | <span class="t">it was.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3632" target="_blank">01:00:32.560</a></span> | <span class="t">So it's able to use sequences of 8 to create a context, which isn't brilliant, but it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3640" target="_blank">01:00:40.400</a></span> | <span class="t">an improvement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3644" target="_blank">01:00:44.360</a></span> | <span class="t">So how do we do that same thing with Keras?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3647" target="_blank">01:00:47.600</a></span> | <span class="t">With Keras, it's identical to our previous model, except that we have to use the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3655" target="_blank">01:00:55.560</a></span> | <span class="t">input and output arrays, just like I just showed you, so the whole sequence of labels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3661" target="_blank">01:01:01.360</a></span> | <span class="t">and the whole sequence of inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3665" target="_blank">01:01:05.720</a></span> | <span class="t">And then the second thing we have to do is add one parameter, which is return_sequences_equals_true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3671" target="_blank">01:01:11.920</a></span> | <span class="t">return_sequences_equals_true simply says rather than putting the triangle outside the loop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3677" target="_blank">01:01:17.880</a></span> | <span class="t">put the triangle inside the loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3679" target="_blank">01:01:19.960</a></span> | <span class="t">And so return an output from every time you go to another time step rather than just returning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3685" target="_blank">01:01:25.920</a></span> | <span class="t">a single output at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3688" target="_blank">01:01:28.740</a></span> | <span class="t">So it's that easy in Keras.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3690" target="_blank">01:01:30.800</a></span> | <span class="t">I add this return_sequences_equals_true, I don't have to change my data at all other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3697" target="_blank">01:01:37.360</a></span> | <span class="t">than some very minor dimensionality changes, and then I can just go ahead and fit it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3705" target="_blank">01:01:45.720</a></span> | <span class="t">As you can see, I get a pretty similar loss function to what I did before, and I can build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3713" target="_blank">01:01:53.100</a></span> | <span class="t">something that looks very much like we had before and generate some pretty similar results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3718" target="_blank">01:01:58.880</a></span> | <span class="t">So that's how we create a sequence model with Keras.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3727" target="_blank">01:02:07.600</a></span> | <span class="t">So then the question of how do you create more state, how do you generate a model which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3735" target="_blank">01:02:15.920</a></span> | <span class="t">able to handle long-term dependencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3739" target="_blank">01:02:19.620</a></span> | <span class="t">To generate a model that understands long-term dependencies, we can't anymore present our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3746" target="_blank">01:02:26.880</a></span> | <span class="t">pieces of data at random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3748" target="_blank">01:02:28.780</a></span> | <span class="t">So so far, we've always been using the default model, which is shuffle=true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3756" target="_blank">01:02:36.960</a></span> | <span class="t">So it's passing across these sequences of 8 in a random order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3762" target="_blank">01:02:42.800</a></span> | <span class="t">If we're going to do something which understands long-term dependencies, the first thing we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3766" target="_blank">01:02:46.160</a></span> | <span class="t">are going to have to do is we're going to have to use shuffle=false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3770" target="_blank">01:02:50.920</a></span> | <span class="t">The second thing we're going to have to do is we're going to have to stop passing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3776" target="_blank">01:02:56.000</a></span> | <span class="t">an array of zeros as my starting point every time around.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3781" target="_blank">01:03:01.820</a></span> | <span class="t">So effectively what I want to do is I want to pass in my array of zeros right at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3792" target="_blank">01:03:12.000</a></span> | <span class="t">very start when I first start training, but then at the end of my sequence of 8, rather</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3798" target="_blank">01:03:18.000</a></span> | <span class="t">than going back to initialize to zeros, I actually want to keep this hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3804" target="_blank">01:03:24.680</a></span> | <span class="t">So then I'd start my next sequence of 8 with this hidden state exactly where it was before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3809" target="_blank">01:03:29.960</a></span> | <span class="t">and that's going to allow it to basically build up arbitrarily long dependencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3817" target="_blank">01:03:37.360</a></span> | <span class="t">So in Keras, that's actually as simple as adding one additional parameter, and the additional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3826" target="_blank">01:03:46.260</a></span> | <span class="t">parameter is called stateful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3833" target="_blank">01:03:53.360</a></span> | <span class="t">And so when you say stateful=true, what that tells Keras is at the end of each sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3841" target="_blank">01:04:01.280</a></span> | <span class="t">don't reset the hidden activations to zero, but leave them as they are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3847" target="_blank">01:04:07.320</a></span> | <span class="t">And that means that we have to make sure we pass shuffle=false when we train it, so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3852" target="_blank">01:04:12.960</a></span> | <span class="t">now going to pass the first 8 characters of the book and then the second 8 characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3856" target="_blank">01:04:16.560</a></span> | <span class="t">of the book and then the third 8 characters of the book, leaving the hidden state untouched</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3862" target="_blank">01:04:22.640</a></span> | <span class="t">between each one, and therefore it's allowing it to continue to build up as much state as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3867" target="_blank">01:04:27.040</a></span> | <span class="t">it wants to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3870" target="_blank">01:04:30.720</a></span> | <span class="t">Training these stateful models is a lot harder than training the models we've seen so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3878" target="_blank">01:04:38.240</a></span> | <span class="t">And the reason is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3879" target="_blank">01:04:39.920</a></span> | <span class="t">In these stateful models, this orange arrow, this single weight matrix, it's being applied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3887" target="_blank">01:04:47.920</a></span> | <span class="t">to this hidden matrix not 8 times, but 100,000 times or more, depending on how big your text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3896" target="_blank">01:04:56.400</a></span> | <span class="t">is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3897" target="_blank">01:04:57.400</a></span> | <span class="t">And just imagine if this weight matrix was even slightly poorly scaled, so if there was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3903" target="_blank">01:05:03.120</a></span> | <span class="t">like one number in it which was just a bit too high, then effectively that number is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3908" target="_blank">01:05:08.920</a></span> | <span class="t">going to be to the power of 100,000, it's being multiplied again and again and again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3915" target="_blank">01:05:15.560</a></span> | <span class="t">So what can happen is you get this problem they call exploding gradients, or really in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3920" target="_blank">01:05:20.900</a></span> | <span class="t">some ways it's better described as exploding activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3924" target="_blank">01:05:24.560</a></span> | <span class="t">Because we're multiplying this by this almost the same weight matrix each time, if that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3930" target="_blank">01:05:30.520</a></span> | <span class="t">weight matrix is anything less than perfectly scaled, then it's going to make our hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3936" target="_blank">01:05:36.520</a></span> | <span class="t">matrix disappear off into infinity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3940" target="_blank">01:05:40.360</a></span> | <span class="t">And so we have to be very careful of how to train these, and indeed these kinds of long-term</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3945" target="_blank">01:05:45.920</a></span> | <span class="t">dependency models were thought of as impossible to train for a while, until some folks in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3954" target="_blank">01:05:54.640</a></span> | <span class="t">the mid-90s came up with a model called the LSTM, or Long Short-Term Memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3963" target="_blank">01:06:03.520</a></span> | <span class="t">And in the Long Short-Term Memory, and we'll learn more about it next week, and we're actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3967" target="_blank">01:06:07.040</a></span> | <span class="t">going to implement it ourselves from scratch, we replace this loop here with a loop where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3972" target="_blank">01:06:12.960</a></span> | <span class="t">there is actually a neural network inside the loop that decides how much of this state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3980" target="_blank">01:06:20.240</a></span> | <span class="t">matrix to keep and how much to use at each activation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3985" target="_blank">01:06:25.480</a></span> | <span class="t">And so by having a neural network which actually controls how much state is kept and how much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3991" target="_blank">01:06:31.320</a></span> | <span class="t">is used, it can actually learn how to avoid those gradient explosions, it can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=3999" target="_blank">01:06:39.640</a></span> | <span class="t">learn how to create an effective sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4004" target="_blank">01:06:44.560</a></span> | <span class="t">So we're going to look at that a lot more next week, but for now I will tell you that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4010" target="_blank">01:06:50.000</a></span> | <span class="t">when I tried to run this using a simple RNN, even with an identity matrix, initialization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4017" target="_blank">01:06:57.120</a></span> | <span class="t">and reuse, I had no luck at all. So I had to replace it with an LSTM. Even that wasn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4023" target="_blank">01:07:03.880</a></span> | <span class="t">enough, I had to have well-scaled inputs, so I added a batch normalization layer after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4029" target="_blank">01:07:09.800</a></span> | <span class="t">my embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4031" target="_blank">01:07:11.320</a></span> | <span class="t">And after I did those things, then I could fit it. It still ran pretty slowly, so before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4040" target="_blank">01:07:20.600</a></span> | <span class="t">I was getting 4 seconds per epoch, now it's 13 seconds per epoch, and the reason here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4045" target="_blank">01:07:25.200</a></span> | <span class="t">is it's much harder to parallelize this. It has to do each sequence in order, so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4051" target="_blank">01:07:31.560</a></span> | <span class="t">going to be slower. But over time, it does eventually get substantially better loss than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4060" target="_blank">01:07:40.200</a></span> | <span class="t">I had before, and that's because it's able to keep track of and use this state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4064" target="_blank">01:07:44.800</a></span> | <span class="t">That's a good question. Definitely maybe. There's been a lot of discussion and papers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4081" target="_blank">01:08:01.620</a></span> | <span class="t">about this recently. There's something called layer normalization, which is a method which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4086" target="_blank">01:08:06.920</a></span> | <span class="t">is explicitly designed to work well with RNNs. Standard batch norm doesn't. It turns out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4096" target="_blank">01:08:16.000</a></span> | <span class="t">it's actually very easy to do layer normalization with Keras using a couple of simple parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4101" target="_blank">01:08:21.880</a></span> | <span class="t">you can provide for the normal batch norm constructor. In my experiments, that hasn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4107" target="_blank">01:08:27.960</a></span> | <span class="t">worked so well, and I will show you a lot more about that in just a few minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4118" target="_blank">01:08:38.200</a></span> | <span class="t">Stateful models are great. We're going to look at some very successful stateful models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4123" target="_blank">01:08:43.120</a></span> | <span class="t">in just a moment, but just be aware that they are more challenging to train. You'll see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4128" target="_blank">01:08:48.120</a></span> | <span class="t">another thing I had to do here is I had to reduce the learning rate in the middle, again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4133" target="_blank">01:08:53.840</a></span> | <span class="t">because you just have to be so careful of these exploding gradient problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4144" target="_blank">01:09:04.840</a></span> | <span class="t">Let me show you what I did with this, which is I tried to create a stateful model which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4152" target="_blank">01:09:12.720</a></span> | <span class="t">worked as well as I could. I took the same Nietzsche data as before, and I tried splitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4159" target="_blank">01:09:19.920</a></span> | <span class="t">it into chunks of 40 rather than 8, so each one could do more work. Here are some examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4168" target="_blank">01:09:28.840</a></span> | <span class="t">of those chunks of 40.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4173" target="_blank">01:09:33.120</a></span> | <span class="t">I built a model that was slightly more sophisticated than the previous one in two ways. The first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4177" target="_blank">01:09:37.800</a></span> | <span class="t">is it has an RNN feeding into an RNN. That's kind of a crazy idea, so I've drawn a picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4189" target="_blank">01:09:49.480</a></span> | <span class="t">An RNN feeding into an RNN means that the output is no longer going to an output, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4197" target="_blank">01:09:57.080</a></span> | <span class="t">actually the output of the first RNN is becoming the input to the second RNN. So the character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4205" target="_blank">01:10:05.680</a></span> | <span class="t">input goes into our first RNN and has the state updates as per usual, and then each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4211" target="_blank">01:10:11.200</a></span> | <span class="t">time we go through the sequence, it feeds the result to the state of the second RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4219" target="_blank">01:10:19.040</a></span> | <span class="t">Why is this useful? Well, because it means that this output is now coming from not just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4225" target="_blank">01:10:25.640</a></span> | <span class="t">a single dense matrix and then a single dense matrix here, it's actually going through one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4236" target="_blank">01:10:36.960</a></span> | <span class="t">two, three dense matrices and activation functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4241" target="_blank">01:10:41.760</a></span> | <span class="t">So I now have a deep neural network, assuming that two layers get to count as deep, between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4248" target="_blank">01:10:48.180</a></span> | <span class="t">my first character and my first output. And then indeed, between every hidden state and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4254" target="_blank">01:10:54.520</a></span> | <span class="t">every output, I now have multiple hidden layers. So effectively, what this is allowing us to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4260" target="_blank">01:11:00.080</a></span> | <span class="t">do is to create a little deep neural net for all of our activations. That turns out to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4269" target="_blank">01:11:09.200</a></span> | <span class="t">work really well because the structure of language is pretty complex and so it's nice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4275" target="_blank">01:11:15.560</a></span> | <span class="t">to be able to give it a more flexible function that it can learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4282" target="_blank">01:11:22.120</a></span> | <span class="t">That's the first thing I do. It's this easy to create that. You just copy and paste whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4288" target="_blank">01:11:28.380</a></span> | <span class="t">your RNN line is twice. You can see I've now added dropout inside my RNN. And as I talked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4298" target="_blank">01:11:38.160</a></span> | <span class="t">about before, adding dropout inside your RNN turns out to be a really good idea. There's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4304" target="_blank">01:11:44.200</a></span> | <span class="t">a really great paper about that quite recently showing that this is a great way to regularize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4311" target="_blank">01:11:51.240</a></span> | <span class="t">an RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4312" target="_blank">01:11:52.840</a></span> | <span class="t">And then the second change I made is rather than going straight from the RNN to our output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4319" target="_blank">01:11:59.600</a></span> | <span class="t">I went through a dense layer. Now there's something that you might have noticed here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4325" target="_blank">01:12:05.920</a></span> | <span class="t">is that our dense layers have this extra word at the front. Why do they have this extra</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4331" target="_blank">01:12:11.800</a></span> | <span class="t">word at the front? Time distributed. It might be easier to understand why by looking at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4338" target="_blank">01:12:18.760</a></span> | <span class="t">this earlier sequence model with Keras.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4343" target="_blank">01:12:23.160</a></span> | <span class="t">And note that the output of our RNN is not just a vector of length 256, but 8 vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4352" target="_blank">01:12:32.200</a></span> | <span class="t">of length 256 because it's actually predicting 8 outputs. So we can't just have a normal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4358" target="_blank">01:12:38.040</a></span> | <span class="t">dense layer because a normal dense layer needs a single dimension that it can squish down.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4368" target="_blank">01:12:48.040</a></span> | <span class="t">So in this case, what we actually want to do is create 8 separate dense layers at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4373" target="_blank">01:12:53.260</a></span> | <span class="t">output, one for every one of the outputs. And so what time distributed does is it says whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4379" target="_blank">01:12:59.680</a></span> | <span class="t">the layer is in the middle, I want you to create 8 copies of them, or however long this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4387" target="_blank">01:13:07.160</a></span> | <span class="t">dimension is. And every one of those copies is going to share the same weight matrix,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4391" target="_blank">01:13:11.880</a></span> | <span class="t">which is exactly what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4393" target="_blank">01:13:13.940</a></span> | <span class="t">So the short version here is in Keras, anytime you say return_sequences=true, any dense layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4401" target="_blank">01:13:21.880</a></span> | <span class="t">you have after that will always have to have time distributed wrapped around them because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4407" target="_blank">01:13:27.120</a></span> | <span class="t">we want to create not just one dense layer, but 8 dense layers. So in this case, since</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4415" target="_blank">01:13:35.280</a></span> | <span class="t">we're saying return_sequences=true, we then have a time distributed dense layer, some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4421" target="_blank">01:13:41.120</a></span> | <span class="t">dropout, and another time distributed dense layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4424" target="_blank">01:13:44.280</a></span> | <span class="t">I have a few questions. Does the first RNN complete before it passes to the second or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4431" target="_blank">01:13:51.760</a></span> | <span class="t">is it layer by layer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4433" target="_blank">01:13:53.800</a></span> | <span class="t">No, it's operating exactly like this. So my initialization starts, my first character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4442" target="_blank">01:14:02.880</a></span> | <span class="t">comes in, and at the output of that comes two things, the hidden state for my next hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4449" target="_blank">01:14:09.020</a></span> | <span class="t">state and the output that goes into my second LSTM. The best way to think of this is to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4461" target="_blank">01:14:21.240</a></span> | <span class="t">draw it in the unrolled form, and then you'll realize there's nothing magical about this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4468" target="_blank">01:14:28.080</a></span> | <span class="t">at all. In an unrolled form, it just looks like a pretty standard deep neural net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4473" target="_blank">01:14:33.880</a></span> | <span class="t">What's dropout_u and dropout_w?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4478" target="_blank">01:14:38.240</a></span> | <span class="t">We'll talk about that more next week. In an LSTM, I mentioned that there's kind of like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4484" target="_blank">01:14:44.040</a></span> | <span class="t">little neural nets that control how the state updates work, and so this is talking about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4488" target="_blank">01:14:48.640</a></span> | <span class="t">how the dropout works inside these little neural nets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4493" target="_blank">01:14:53.280</a></span> | <span class="t">And when stateful is false, can you explain again what is reset after each training example?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4501" target="_blank">01:15:01.800</a></span> | <span class="t">The best way to describe that is to show us doing it. Remember that the RNNs that we built</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4512" target="_blank">01:15:12.720</a></span> | <span class="t">are identical to what Keras does, or close enough to identical. Let's go and have a look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4519" target="_blank">01:15:19.120</a></span> | <span class="t">at our version of return sequences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4524" target="_blank">01:15:24.480</a></span> | <span class="t">You can see that what we did was we created a matrix of zeros that we stuck onto the front</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4533" target="_blank">01:15:33.360</a></span> | <span class="t">of our inputs. Every set of 8 characters now starts with a vector of zeros. In other words,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4543" target="_blank">01:15:43.800</a></span> | <span class="t">this initialize to zeros happens every time we finish a sequence. In other words, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4551" target="_blank">01:15:51.360</a></span> | <span class="t">hidden state gets initialized to 0 at the end of every sequence. It's this hidden state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4558" target="_blank">01:15:58.280</a></span> | <span class="t">which is where all of these dependencies and state is kept. So doing that is resetting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4565" target="_blank">01:16:05.920</a></span> | <span class="t">the state every time we look at a new sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4569" target="_blank">01:16:09.760</a></span> | <span class="t">So when we say stateful = false, it only does this initialize to 0 once at the very start,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4579" target="_blank">01:16:19.920</a></span> | <span class="t">or when we explicitly ask it to. So when I actually run this model, the way I do it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4588" target="_blank">01:16:28.120</a></span> | <span class="t">I wrote a little thing called run epochs that goes model.resetStates and then does a fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4594" target="_blank">01:16:34.800</a></span> | <span class="t">on one epoch, which is what you really want at the end of your entire works of Nietzsche.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4601" target="_blank">01:16:41.320</a></span> | <span class="t">You want to reset the state because you're about to go back to the very start and start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4612" target="_blank">01:16:52.360</a></span> | <span class="t">again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4615" target="_blank">01:16:55.760</a></span> | <span class="t">So with this multilayer LSTM going into a multilayer neural net, I then tried seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4623" target="_blank">01:17:03.640</a></span> | <span class="t">how that goes. And remember that with our simpler versions, we were getting 1.6 loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4630" target="_blank">01:17:10.600</a></span> | <span class="t">was the best we could do. After one epoch, it's awful. And now rather than just printing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4639" target="_blank">01:17:19.840</a></span> | <span class="t">out one letter, I'm starting with a whole sequence of letters, which is that, and asking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4646" target="_blank">01:17:26.280</a></span> | <span class="t">it to generate a sequence. You can see it starts out by generating a pretty rubbishy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4650" target="_blank">01:17:30.160</a></span> | <span class="t">sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4651" target="_blank">01:17:31.160</a></span> | <span class="t">One more question. In the double LSTM layer model, what is the input to the second LSTM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4659" target="_blank">01:17:39.840</a></span> | <span class="t">in addition to the output of the first LSTM?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4665" target="_blank">01:17:45.960</a></span> | <span class="t">In addition to the output of the first LSTM is the previous output of its own hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4675" target="_blank">01:17:55.440</a></span> | <span class="t">Okay, so after a few more epochs, it's starting to create some actual proper English words,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4688" target="_blank">01:18:08.480</a></span> | <span class="t">although the English words aren't necessarily making a lot of sense. So I keep running epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4695" target="_blank">01:18:15.120</a></span> | <span class="t">At this point, it's learned how to start chapters. This is actually how in this book the chapters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4700" target="_blank">01:18:20.680</a></span> | <span class="t">always start with a number and then an equal sign. It hasn't learned how to close quotes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4706" target="_blank">01:18:26.040</a></span> | <span class="t">apparently, it's not really saying anything useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4709" target="_blank">01:18:29.920</a></span> | <span class="t">So anyway, I kind of ran this overnight, and I then seeded it with a large amount of data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4719" target="_blank">01:18:39.560</a></span> | <span class="t">so I seeded it with all this data, and I started getting some pretty reasonable results. Shreds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4726" target="_blank">01:18:46.360</a></span> | <span class="t">into one's own suffering sounds exactly like the kind of thing that you might see. Religions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4732" target="_blank">01:18:52.000</a></span> | <span class="t">have acts done by man. It's not all perfect, but it's not bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4737" target="_blank">01:18:57.520</a></span> | <span class="t">Interestingly, this sequence here, when I looked it up, it actually appears in his book.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4745" target="_blank">01:19:05.120</a></span> | <span class="t">This makes sense, right? It's kind of overfitting in a sense. He loves talking in all caps,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4754" target="_blank">01:19:14.440</a></span> | <span class="t">but he only does it from time to time. So once it so happened to start writing something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4761" target="_blank">01:19:21.040</a></span> | <span class="t">in all caps that looked like this phrase that only appeared once and is very unique, there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4767" target="_blank">01:19:27.200</a></span> | <span class="t">was kind of no other way that it could have finished it. So sometimes you get these little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4772" target="_blank">01:19:32.880</a></span> | <span class="t">rare phrases that basically it's plagiarized directly from each of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4779" target="_blank">01:19:39.080</a></span> | <span class="t">Now I didn't stop there because I thought, how can we improve this? And it was at this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4783" target="_blank">01:19:43.440</a></span> | <span class="t">point that I started thinking about batch normalization. And I started fiddling around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4787" target="_blank">01:19:47.840</a></span> | <span class="t">with a lot of different types of batch normalization and layer normalization and discovered this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4794" target="_blank">01:19:54.400</a></span> | <span class="t">interesting insight, which is that at least in this case, the very best approach was when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4803" target="_blank">01:20:03.320</a></span> | <span class="t">I simply applied batch normalization to the embedding layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4814" target="_blank">01:20:14.840</a></span> | <span class="t">When I applied batch normalization to the embedding layer, this is the training curve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4819" target="_blank">01:20:19.800</a></span> | <span class="t">that I got. So over epochs, this is my loss. With no batch normalization on the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4825" target="_blank">01:20:25.940</a></span> | <span class="t">layer, this was my loss. And so you can see this was actually starting to flatten out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4831" target="_blank">01:20:31.840</a></span> | <span class="t">This one really wasn't, and this one was training a lot quicker. So then I tried training it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4836" target="_blank">01:20:36.960</a></span> | <span class="t">with batch norm on the embedding layer overnight, and I was pretty stunned by the results. This</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4845" target="_blank">01:20:45.560</a></span> | <span class="t">was my seeding text, and after 1000 epochs, this is what it came up with. And it's got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4859" target="_blank">01:20:59.160</a></span> | <span class="t">all kinds of pretty interesting little things. Perhaps some morality equals self-glorification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4866" target="_blank">01:21:06.680</a></span> | <span class="t">This is really cool. For there are holy eyes to Schopenhauer's blind. This is interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4875" target="_blank">01:21:15.400</a></span> | <span class="t">In reality, we must step above it. You can see that it's learnt to close quotes even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4879" target="_blank">01:21:19.580</a></span> | <span class="t">when those quotes were opened a long time ago. So if we weren't using stateful, it would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4883" target="_blank">01:21:23.760</a></span> | <span class="t">never have learnt how to do this. I've looked up these words in the original text and pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4892" target="_blank">01:21:32.320</a></span> | <span class="t">much none of these phrases appear. This is actually a genuinely, novelly produced piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4899" target="_blank">01:21:39.400</a></span> | <span class="t">of text. It's not perfect by any means, but considering that this is only doing it character</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4908" target="_blank">01:21:48.240</a></span> | <span class="t">by character, using nothing but a 42 long embedding matrix for each character and nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4916" target="_blank">01:21:56.040</a></span> | <span class="t">but there's no pre-trained vectors, there's just a pretty short 600,000 character epoch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4923" target="_blank">01:22:03.760</a></span> | <span class="t">I think it's done a pretty amazing job of creating a pretty good model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4929" target="_blank">01:22:09.680</a></span> | <span class="t">And so there's all kinds of things you could do with a model like this. The most obvious</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4933" target="_blank">01:22:13.320</a></span> | <span class="t">one would be if you were producing a software keyboard for a mobile phone, for example. You</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4940" target="_blank">01:22:20.600</a></span> | <span class="t">could use this to have a pretty accurate guess as to what they were going to type next and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4944" target="_blank">01:22:24.600</a></span> | <span class="t">correct it for them. You could do something similar on a word basis. But more generally,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4951" target="_blank">01:22:31.800</a></span> | <span class="t">you could do something like anomaly detection with this. You could generate a sequence that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4958" target="_blank">01:22:38.000</a></span> | <span class="t">is predicting what the rest of the sequence is going to look like for the next hour and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4962" target="_blank">01:22:42.760</a></span> | <span class="t">then recognize if something falls outside of what your prediction was and you know there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4967" target="_blank">01:22:47.760</a></span> | <span class="t">been some kind of anomaly. There's all kinds of things you can do with these kinds of models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4974" target="_blank">01:22:54.660</a></span> | <span class="t">I think that's pretty fun, but I want to show you something else which is pretty fun, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4981" target="_blank">01:23:01.720</a></span> | <span class="t">is to build an RNN from scratch in Theano. And what we're going to do is we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4990" target="_blank">01:23:10.680</a></span> | <span class="t">to try and work up to next week where we're going to build an RNN from scratch in NumPy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=4998" target="_blank">01:23:18.920</a></span> | <span class="t">And we're also going to build an LSTM from scratch in Theano. And the reason we're doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5006" target="_blank">01:23:26.900</a></span> | <span class="t">this is because next week's our last class in this part of the course, I want us to leave</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5014" target="_blank">01:23:34.680</a></span> | <span class="t">with kind of feeling like we really understand the details of what's going on behind the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5019" target="_blank">01:23:39.560</a></span> | <span class="t">scenes. The main thing I wanted to teach in this class is the applied stuff, these kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5024" target="_blank">01:23:44.960</a></span> | <span class="t">of practical tips about how you build a sequence model. Use return equals true, put batch null</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5031" target="_blank">01:23:51.160</a></span> | <span class="t">in the embedding layer, add time distributed to the dense layer. But I also know that to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5039" target="_blank">01:23:59.760</a></span> | <span class="t">really debug your models and to build your architectures and stuff, it really helps to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5045" target="_blank">01:24:05.440</a></span> | <span class="t">understand what's going on. Particularly in the current situation where the tools and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5052" target="_blank">01:24:12.120</a></span> | <span class="t">libraries available are not that mature, they still require a whole lot of manual stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5059" target="_blank">01:24:19.680</a></span> | <span class="t">So I do want to try and explain a bit more about what's going on behind the scenes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5067" target="_blank">01:24:27.800</a></span> | <span class="t">In order to build an RNN in Theano, first of all make a small change to our Keras model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5076" target="_blank">01:24:36.560</a></span> | <span class="t">which is that I'm going to use One Hot encoding. I don't know if you noticed this, but we did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5081" target="_blank">01:24:41.240</a></span> | <span class="t">something pretty cool in all of our models so far, which is that we never actually One</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5089" target="_blank">01:24:49.240</a></span> | <span class="t">Hot encoded our output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5091" target="_blank">01:24:51.840</a></span> | <span class="t">Question 3. Will time distributed dense take longer to train than dense? And is it really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5097" target="_blank">01:24:57.920</a></span> | <span class="t">that important to use time distributed dense?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5101" target="_blank">01:25:01.240</a></span> | <span class="t">So if you don't add time distributed dense to a model where return sequence equals true,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5106" target="_blank">01:25:06.840</a></span> | <span class="t">it literally won't work. It won't compile. Because you're trying to predict eight things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5113" target="_blank">01:25:13.080</a></span> | <span class="t">and the dense layer is going to stick that all into one thing. So it's going to say there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5116" target="_blank">01:25:16.360</a></span> | <span class="t">a mismatch in your dimensions. But no, it doesn't really add much time because that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5126" target="_blank">01:25:26.240</a></span> | <span class="t">something that can be very easily paralyzed. And since a lot of things in RNNs can't be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5132" target="_blank">01:25:32.040</a></span> | <span class="t">easily paralyzed, there generally is plenty of room in your GPU to do more work. So that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5138" target="_blank">01:25:38.760</a></span> | <span class="t">should be fun. The short answer is you have to use it, otherwise it won't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5146" target="_blank">01:25:46.000</a></span> | <span class="t">I wanted to point out something which is that in all of our models so far, we did not One</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5152" target="_blank">01:25:52.760</a></span> | <span class="t">Hot encode our outputs. So our outputs, remember, looked like this. They were sequences of numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5168" target="_blank">01:26:08.400</a></span> | <span class="t">And so always before, we've had to One Hot encode our outputs to use them. It turns out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5176" target="_blank">01:26:16.160</a></span> | <span class="t">that Keras has a very cool loss function called sparse-categorical-cross-entropy. This is identical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5186" target="_blank">01:26:26.080</a></span> | <span class="t">to categorical-cross-entropy, but rather than taking a One Hot encoded target, it takes an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5194" target="_blank">01:26:34.360</a></span> | <span class="t">integer target, and basically it acts as if you had One Hot encoded it. So it basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5200" target="_blank">01:26:40.440</a></span> | <span class="t">does the indexing into it directly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5204" target="_blank">01:26:44.240</a></span> | <span class="t">So this is a really helpful thing to know about because when you have a lot of output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5210" target="_blank">01:26:50.100</a></span> | <span class="t">categories like, for example, if you're doing a word model, you could have 100,000 output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5217" target="_blank">01:26:57.120</a></span> | <span class="t">categories. There's no way you want to create a matrix that is 100,000 long, nearly all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5222" target="_blank">01:27:02.960</a></span> | <span class="t">zeros for every single word in your output. So by using sparse-categorical-cross-entropy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5229" target="_blank">01:27:09.880</a></span> | <span class="t">you can just forget the whole One Hot encode. You don't have to do it. Keras implicitly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5235" target="_blank">01:27:15.800</a></span> | <span class="t">does it for you, but without ever actually explicitly doing it, it just does a direct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5240" target="_blank">01:27:20.280</a></span> | <span class="t">look up into the matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5243" target="_blank">01:27:23.960</a></span> | <span class="t">However, because I want to make things simpler for us to understand, I'm going to go ahead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5250" target="_blank">01:27:30.160</a></span> | <span class="t">and recreate our Keras model using One Hot encoding. So I'm going to take exactly the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5258" target="_blank">01:27:38.280</a></span> | <span class="t">same model that we had before with return_sequences=true, but this time I'm going to use normal-categorical-cross-entropy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5269" target="_blank">01:27:49.320</a></span> | <span class="t">which means that -- and the other thing I'm doing is I don't have an embedding layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5273" target="_blank">01:27:53.120</a></span> | <span class="t">So since I don't have an embedding layer, I also have to One Hot encode my inputs. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5278" target="_blank">01:27:58.200</a></span> | <span class="t">you can see I'm calling 2-categorical on all my inputs and 2-categorical on all my outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5286" target="_blank">01:28:06.760</a></span> | <span class="t">So now the shape is 75,000 x 8, as before, by 86. So this is the One Hot encoding dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5296" target="_blank">01:28:16.960</a></span> | <span class="t">with which there are 85 zeros and 1 1. So we fit this in exactly the same way, we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5304" target="_blank">01:28:24.160</a></span> | <span class="t">exactly the same answer. So the only reason I was doing that was because I want to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5311" target="_blank">01:28:31.920</a></span> | <span class="t">One Hot encoding for the version that we're going to create ourselves from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5319" target="_blank">01:28:39.960</a></span> | <span class="t">So we haven't really looked at Theano before, but particularly if you come back next year,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5327" target="_blank">01:28:47.640</a></span> | <span class="t">as we start to try to add more and more stuff on top of Keras or into Keras, increasingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5337" target="_blank">01:28:57.240</a></span> | <span class="t">you'll find yourself wanting to use Theano, because Theano is the language, if you like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5343" target="_blank">01:29:03.640</a></span> | <span class="t">that Keras is using behind the scenes, and therefore it's the language which you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5349" target="_blank">01:29:09.200</a></span> | <span class="t">use to extend it. Of course you can use TensorFlow as well, but we're using Theano in this course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5355" target="_blank">01:29:15.920</a></span> | <span class="t">because I think it's much easier for this kind of application.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5363" target="_blank">01:29:23.520</a></span> | <span class="t">So let's learn to use Theano. In the process of doing it in Theano, we're going to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5370" target="_blank">01:29:30.360</a></span> | <span class="t">to force ourselves to think through a lot more of the details than we have before, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5377" target="_blank">01:29:37.720</a></span> | <span class="t">Theano doesn't have any of the conveniences that Keras has. There's no such thing as a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5382" target="_blank">01:29:42.920</a></span> | <span class="t">variable. We have to think about all of the weight matrices and activation functions and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5387" target="_blank">01:29:47.720</a></span> | <span class="t">everything else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5389" target="_blank">01:29:49.360</a></span> | <span class="t">So let me show you how it works. In Theano, there's this concept of a variable, and a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5398" target="_blank">01:29:58.680</a></span> | <span class="t">variable is something which we basically define like so. We can say there is a variable which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5405" target="_blank">01:30:05.000</a></span> | <span class="t">is a matrix which I will call T_input, and there is a variable which is a matrix that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5410" target="_blank">01:30:10.480</a></span> | <span class="t">we'll call T_output, and there is a variable that is a vector that we will call H0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5416" target="_blank">01:30:16.520</a></span> | <span class="t">What these are all saying is that these are things that we will give values to later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5425" target="_blank">01:30:25.280</a></span> | <span class="t">Programming in Theano is very different to programming in normal Python, and the reason</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5429" target="_blank">01:30:29.800</a></span> | <span class="t">for this is Theano's job in life is to provide a way for you to describe a computation that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5437" target="_blank">01:30:37.560</a></span> | <span class="t">you want to do, and then it's going to compile it for the GPU, and then it's going to run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5443" target="_blank">01:30:43.740</a></span> | <span class="t">it on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5445" target="_blank">01:30:45.880</a></span> | <span class="t">So it's going to be a little more complex to work in Theano, because Theano isn't going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5449" target="_blank">01:30:49.880</a></span> | <span class="t">to be something where we immediately say do this, and then do this, and then do this. Instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5455" target="_blank">01:30:55.400</a></span> | <span class="t">we're going to build up what's called a computation graph. It's going to be a series of steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5459" target="_blank">01:30:59.840</a></span> | <span class="t">We're going to say in the future, I'm going to give you some data, and when I do, I want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5465" target="_blank">01:31:05.800</a></span> | <span class="t">you to do these steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5468" target="_blank">01:31:08.200</a></span> | <span class="t">So rather than actually starting off by giving it data, we start off by just describing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5473" target="_blank">01:31:13.640</a></span> | <span class="t">types of data that when we do give it data, we're going to give it. So eventually we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5478" target="_blank">01:31:18.400</a></span> | <span class="t">going to give it some input data, we're going to give it some output data, and we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5484" target="_blank">01:31:24.640</a></span> | <span class="t">to give it some way of initializing the first hidden state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5489" target="_blank">01:31:29.600</a></span> | <span class="t">And also we'll give it a learning rate, because we might want to change it later. So that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5495" target="_blank">01:31:35.240</a></span> | <span class="t">all these things do. They create Theano variables. So then we can create a list of those, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5501" target="_blank">01:31:41.600</a></span> | <span class="t">so this is all of the arguments that we're going to have to provide to Theano later on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5505" target="_blank">01:31:45.960</a></span> | <span class="t">So there's no data here, nothing's being computed, we're just telling Theano that these things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5510" target="_blank">01:31:50.920</a></span> | <span class="t">are going to be used in the future.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5514" target="_blank">01:31:54.680</a></span> | <span class="t">The next thing that we need to do, because we're going to try to build this, is we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5522" target="_blank">01:32:02.480</a></span> | <span class="t">going to have to build all of the pieces in all of these layer operations. So specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5527" target="_blank">01:32:07.800</a></span> | <span class="t">we're going to have to create the weight vector and bias matrix for the orange arrow, the weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5533" target="_blank">01:32:13.560</a></span> | <span class="t">vector and the bias matrix for the green arrow, the weight matrix and the bias vector for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5538" target="_blank">01:32:18.400</a></span> | <span class="t">orange arrow, the weight matrix and the bias vector for the green arrow, and the weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5542" target="_blank">01:32:22.080</a></span> | <span class="t">matrix and the bias vector for the blue arrow, because that's what these layer operations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5546" target="_blank">01:32:26.120</a></span> | <span class="t">are. They're a matrix multiplier followed by a non-linear activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5553" target="_blank">01:32:33.120</a></span> | <span class="t">So I've created some functions to do that. WH is what I'm going to call the weights and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5561" target="_blank">01:32:41.080</a></span> | <span class="t">bias to my hidden layer, Wx will be my weights and bias to my input, and Wy will be my weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5567" target="_blank">01:32:47.120</a></span> | <span class="t">and bias to my output. So to create them, I've created this little function called weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5572" target="_blank">01:32:52.920</a></span> | <span class="t">and bias in which I tell it the size of the matrix that I want to create. So the matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5580" target="_blank">01:33:00.320</a></span> | <span class="t">that goes from input to hidden therefore has n input rows and n hidden columns. So weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5590" target="_blank">01:33:10.320</a></span> | <span class="t">and bias is here, and it's going to return a tuple, it's going to return our weights,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5598" target="_blank">01:33:18.600</a></span> | <span class="t">and it's going to return our bias. So how do we create the weights?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5603" target="_blank">01:33:23.600</a></span> | <span class="t">To create the weights, we first of all calculate the magic Glorow number, the square root of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5609" target="_blank">01:33:29.480</a></span> | <span class="t">2 over fan n, so that's the scale of the random numbers that we're going to use. We then create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5616" target="_blank">01:33:36.800</a></span> | <span class="t">those random numbers using the numpy_normal_random_number function, and then we use a special Theano</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5627" target="_blank">01:33:47.420</a></span> | <span class="t">keyword called 'shared'. What shared does is it says to Theano, this data is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5635" target="_blank">01:33:55.680</a></span> | <span class="t">that I'm going to want you to pass off to the GPU later and keep track of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5640" target="_blank">01:34:00.840</a></span> | <span class="t">So as soon as you wrap something in shared, it kind of belongs to Theano now. So here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5646" target="_blank">01:34:06.280</a></span> | <span class="t">is a weight matrix that belongs to Theano, here is a vector of zeros that belongs to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5653" target="_blank">01:34:13.500</a></span> | <span class="t">Theano and that's our initial bias. So we've initialized our weights and our bias, so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5659" target="_blank">01:34:19.800</a></span> | <span class="t">can do that for our inputs and we can do that for our outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5666" target="_blank">01:34:26.080</a></span> | <span class="t">And then for our hidden, which is the orange error, we're going to do something slightly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5672" target="_blank">01:34:32.480</a></span> | <span class="t">different which is we will initialize it using an identity matrix. And rather amusingly in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5678" target="_blank">01:34:38.640</a></span> | <span class="t">numpy, it is 'i' for identity. So this is an identity matrix, believe it or not, of size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5687" target="_blank">01:34:47.320</a></span> | <span class="t">n by n. And so that's our initial weights and our initial bias is exactly as before. It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5695" target="_blank">01:34:55.280</a></span> | <span class="t">a vector of zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5698" target="_blank">01:34:58.320</a></span> | <span class="t">So you can see we've had to manually construct each of these 3 weight matrices and bias vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5708" target="_blank">01:35:08.200</a></span> | <span class="t">It's nice to now stick them all into a single list. And Python has this thing called chain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5713" target="_blank">01:35:13.120</a></span> | <span class="t">from iterable, which basically takes all of these tuples and dumps them all together into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5717" target="_blank">01:35:17.920</a></span> | <span class="t">a single list. And so this now has all 6 weight matrices and bias vectors in a single list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5730" target="_blank">01:35:30.400</a></span> | <span class="t">We have defined the initial contents of each of these arrows. And we've also defined kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5737" target="_blank">01:35:37.280</a></span> | <span class="t">of symbolically the concept that we're going to have something to initialize it with here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5743" target="_blank">01:35:43.360</a></span> | <span class="t">something to initialize it with here and some time to initialize it with here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5748" target="_blank">01:35:48.080</a></span> | <span class="t">So the next thing we have to do is to tell Theano what happens each time we take a single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5755" target="_blank">01:35:55.160</a></span> | <span class="t">step of this RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5760" target="_blank">01:36:00.680</a></span> | <span class="t">On the GPU, you can't use a for loop. The reason you can't use a for loop is because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5767" target="_blank">01:36:07.000</a></span> | <span class="t">a GPU wants to be able to parallelize things and wants to do things at the same time. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5771" target="_blank">01:36:11.800</a></span> | <span class="t">a for loop by definition can't do the second part of the loop until it's done the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5776" target="_blank">01:36:16.120</a></span> | <span class="t">part of the loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5777" target="_blank">01:36:17.120</a></span> | <span class="t">I don't know if we'll get time to do it in this course or not, but there's a very neat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5782" target="_blank">01:36:22.600</a></span> | <span class="t">result which shows that there's something very similar to a for loop that you can parallelize,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5788" target="_blank">01:36:28.320</a></span> | <span class="t">and it's called a scan operation. A scan operation is something that's defined in a very particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5796" target="_blank">01:36:36.960</a></span> | <span class="t">way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5797" target="_blank">01:36:37.960</a></span> | <span class="t">A scan operation is something where you call some function for every element of some sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5808" target="_blank">01:36:48.040</a></span> | <span class="t">And at every point, the function returns some output, and the next time through that function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5815" target="_blank">01:36:55.320</a></span> | <span class="t">is called, it's going to get the output of the previous time you called it, along with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5820" target="_blank">01:37:00.800</a></span> | <span class="t">the next element of the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5823" target="_blank">01:37:03.600</a></span> | <span class="t">So in fact, I've got an example of it. I actually wrote a very simple example of it in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5837" target="_blank">01:37:17.920</a></span> | <span class="t">Here is the definition of scan, and here is an example of scan. Let's start with the example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5844" target="_blank">01:37:24.000</a></span> | <span class="t">I want to do a scan, and the function I'm going to use is to add two things together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5851" target="_blank">01:37:31.840</a></span> | <span class="t">And I'm going to start off with the number 0, and then I'm going to pass in a range of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5856" target="_blank">01:37:36.940</a></span> | <span class="t">numbers from 0 to 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5859" target="_blank">01:37:39.600</a></span> | <span class="t">So what scan does is it starts out by taking the first time through, it's going to call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5865" target="_blank">01:37:45.000</a></span> | <span class="t">this function with that argument and the first element of this. So it's going to be 0 plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5871" target="_blank">01:37:51.160</a></span> | <span class="t">0 equals 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5873" target="_blank">01:37:53.520</a></span> | <span class="t">The second time, it's going to call this function with the second element of this, along with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5880" target="_blank">01:38:00.440</a></span> | <span class="t">the result of the previous call. So it will be 0 plus 1 equals 1. The next time through,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5888" target="_blank">01:38:08.040</a></span> | <span class="t">it's going to call this function with the result of the previous call plus the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5893" target="_blank">01:38:13.320</a></span> | <span class="t">element of this range, so it will be 1 plus 2 equals 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5898" target="_blank">01:38:18.640</a></span> | <span class="t">So you can see here, this scan operation defines a cumulative sum. And so you can see the definition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5906" target="_blank">01:38:26.600</a></span> | <span class="t">of scan here. We're going to be returning an array of results. Initially, we take our starting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5912" target="_blank">01:38:32.920</a></span> | <span class="t">point, 0, and that's our initial value for the previous answer from scan. And then we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5920" target="_blank">01:38:40.400</a></span> | <span class="t">going to go through everything in the sequence, which is 0 through 4. We're going to apply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5925" target="_blank">01:38:45.240</a></span> | <span class="t">this function, which in this case was AddThingsUp, and we're going to apply it to the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5930" target="_blank">01:38:50.640</a></span> | <span class="t">result along with the next element of the sequence. Stick the result at the end of our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5936" target="_blank">01:38:56.400</a></span> | <span class="t">list, set the previous result to whatever we just got, and then go back to the next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5942" target="_blank">01:39:02.520</a></span> | <span class="t">element of the sequence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5944" target="_blank">01:39:04.800</a></span> | <span class="t">So it may be very surprising, I mean hopefully it is very surprising because it's an extraordinary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5950" target="_blank">01:39:10.000</a></span> | <span class="t">result, but it is possible to write a parallel version of this. So if you can turn your algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5958" target="_blank">01:39:18.640</a></span> | <span class="t">into a scan, you can run it quickly on GPU. So what we're going to do is our job is to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5965" target="_blank">01:39:25.360</a></span> | <span class="t">turn this RNN into something that we can put into this kind of format, into a scan. So let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5975" target="_blank">01:39:35.640</a></span> | <span class="t">do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5985" target="_blank">01:39:45.640</a></span> | <span class="t">So the function that we're going to call on each step through is the function called Step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5992" target="_blank">01:39:52.500</a></span> | <span class="t">And the function called Step is going to be something which hopefully will not be very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=5996" target="_blank">01:39:56.600</a></span> | <span class="t">surprising to you. It's going to be something which takes our input, x, it does a dot product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6002" target="_blank">01:40:02.520</a></span> | <span class="t">by that weight matrix we created earlier, wx, and adds on that bias vector we created earlier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6010" target="_blank">01:40:10.400</a></span> | <span class="t">And then we do the same thing, taking our previous hidden state, multiplying it by the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6015" target="_blank">01:40:15.240</a></span> | <span class="t">weight matrix for the hidden state, and adding the biases for the hidden state, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6019" target="_blank">01:40:19.760</a></span> | <span class="t">puts the whole thing through an activation function, relu.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6024" target="_blank">01:40:24.000</a></span> | <span class="t">So in other words, let's go back to the unrolled version. So we had one bit which was calculating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6031" target="_blank">01:40:31.860</a></span> | <span class="t">our previous hidden state and putting it through the hidden state weight matrix. It was taking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6040" target="_blank">01:40:40.040</a></span> | <span class="t">our next input and putting it through the input one and then adding the two together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6047" target="_blank">01:40:47.880</a></span> | <span class="t">So that's what we have here, the x by wx and the h by wh, and then adding the two together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6054" target="_blank">01:40:54.780</a></span> | <span class="t">along with the biases, and then put that through an activation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6059" target="_blank">01:40:59.980</a></span> | <span class="t">So once we've done that, we now want to create an output every single time, and so our output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6067" target="_blank">01:41:07.980</a></span> | <span class="t">is going to be exactly the same thing. It's going to take the result of that, which we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6071" target="_blank">01:41:11.720</a></span> | <span class="t">called h, our hidden state, multiply it by the output's weight vector, adding on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6077" target="_blank">01:41:17.480</a></span> | <span class="t">bias, and this time we're going to use softmax. So you can see that this sequence here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6085" target="_blank">01:41:25.600</a></span> | <span class="t">describing how to do one of these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6091" target="_blank">01:41:31.480</a></span> | <span class="t">And so this therefore defines what we want to do each step through. And at the end of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6097" target="_blank">01:41:37.400</a></span> | <span class="t">that, we're going to return the hidden state we have so far and our output. So that's what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6106" target="_blank">01:41:46.400</a></span> | <span class="t">going to happen each step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6108" target="_blank">01:41:48.560</a></span> | <span class="t">So the sequence that we're going to pass into it is, well, we're not going to give it any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6115" target="_blank">01:41:55.040</a></span> | <span class="t">data yet because remember, all we're doing is we're describing a computation. So for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6119" target="_blank">01:41:59.160</a></span> | <span class="t">now, we're just telling it that it's going to be, it will be a matrix. So we're saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6126" target="_blank">01:42:06.560</a></span> | <span class="t">it will be a matrix, we're going to pass you a matrix. It also needs a starting point,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6134" target="_blank">01:42:14.080</a></span> | <span class="t">and so the starting point is, again, we are going to provide to you an initial value for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6141" target="_blank">01:42:21.100</a></span> | <span class="t">our hidden state, but we haven't done it yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6146" target="_blank">01:42:26.080</a></span> | <span class="t">And then finally in Theano, you have to tell it what are all of the other things that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6149" target="_blank">01:42:29.520</a></span> | <span class="t">passed to the function, and we're going to pass it that whole list of weights. That's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6154" target="_blank">01:42:34.480</a></span> | <span class="t">why we have here the x, the hidden, and then all of the weights and biases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6165" target="_blank">01:42:45.360</a></span> | <span class="t">So that's now described how to execute a whole sequence of steps for an RNN. So we've now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6175" target="_blank">01:42:55.560</a></span> | <span class="t">described how to do this to Theano. We haven't given it any data to do it, we've just set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6182" target="_blank">01:43:02.120</a></span> | <span class="t">up the computation. And so when that computation is run, it's going to return two things because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6189" target="_blank">01:43:09.640</a></span> | <span class="t">step returns two things. It's going to return the hidden state and it's going to return our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6196" target="_blank">01:43:16.320</a></span> | <span class="t">output activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6199" target="_blank">01:43:19.040</a></span> | <span class="t">So now we need to calculate our error. Our error will be the categorical cross-entropy,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6205" target="_blank">01:43:25.160</a></span> | <span class="t">and so these things are all part of Theano. You can see I'm using some Theano functions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6208" target="_blank">01:43:28.920</a></span> | <span class="t">here. And so we're going to compare the output that came out of our scan, and we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6215" target="_blank">01:43:35.520</a></span> | <span class="t">to compare it to what we don't know yet, but it will be a matrix. And then once you do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6223" target="_blank">01:43:43.040</a></span> | <span class="t">that, add it all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6225" target="_blank">01:43:45.880</a></span> | <span class="t">Now here's the amazing thing. Every step we're going to want to apply SGD, which means every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6231" target="_blank">01:43:51.560</a></span> | <span class="t">step we're going to want to take the derivative of this whole thing with respect to all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6239" target="_blank">01:43:59.480</a></span> | <span class="t">the weights and use that, along with the learning rate, to update all of the weights. In Theano,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6247" target="_blank">01:44:07.360</a></span> | <span class="t">that's how you do it. You just say, "Please tell me the gradient of this function with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6254" target="_blank">01:44:14.600</a></span> | <span class="t">respect to these inputs." And Theano will symbolically, automatically calculate all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6260" target="_blank">01:44:20.240</a></span> | <span class="t">of the derivatives for you. So that's very nearly magic, but we don't have to worry about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6266" target="_blank">01:44:26.700</a></span> | <span class="t">derivatives because it's going to calculate them all for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6271" target="_blank">01:44:31.200</a></span> | <span class="t">So at this point, I now have a function that calculates our loss, and I have a function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6276" target="_blank">01:44:36.240</a></span> | <span class="t">that calculates all of the gradients that we need with respect to all of the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6280" target="_blank">01:44:40.000</a></span> | <span class="t">weights and parameters that we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6283" target="_blank">01:44:43.720</a></span> | <span class="t">So we're now ready to build our final function. Our final function, as input, takes all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6291" target="_blank">01:44:51.640</a></span> | <span class="t">our arguments, that is, these four things, which is the things we told it we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6297" target="_blank">01:44:57.360</a></span> | <span class="t">to need later. The thing that's going to create an output is the error, which was this output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6307" target="_blank">01:45:07.360</a></span> | <span class="t">And then at each step, it's going to do some updates. What are the updates going to do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6312" target="_blank">01:45:12.680</a></span> | <span class="t">The updates it's going to do is the result of this little function. And this little function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6317" target="_blank">01:45:17.240</a></span> | <span class="t">is something that creates a dictionary that is going to map every one of our weights to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6324" target="_blank">01:45:24.880</a></span> | <span class="t">that weight minus each one of our gradients times the learning rate. So it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6333" target="_blank">01:45:33.840</a></span> | <span class="t">update every weight to itself minus its gradient times the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6341" target="_blank">01:45:41.480</a></span> | <span class="t">So basically what Theano does is it says, it's got this little thing called updates,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6346" target="_blank">01:45:46.760</a></span> | <span class="t">it says every time you calculate the next step, I want you to change your shared variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6353" target="_blank">01:45:53.720</a></span> | <span class="t">as follows. So there's our list of changes to make.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6358" target="_blank">01:45:58.960</a></span> | <span class="t">And so that's it. So we use our one hot encoded x's and our one hot encoded y's, and we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6365" target="_blank">01:46:05.520</a></span> | <span class="t">to now manually create our own loop. Theano doesn't have any built-in stuff for us, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6371" target="_blank">01:46:11.440</a></span> | <span class="t">we're going to go through every element of our input and we're going to say let's call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6379" target="_blank">01:46:19.320</a></span> | <span class="t">that function, so that function is the function that we just created, and now we have to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6384" target="_blank">01:46:24.480</a></span> | <span class="t">in all of these inputs. So we have to finally pass in a value for the initial hidden state,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6392" target="_blank">01:46:32.320</a></span> | <span class="t">the input, the target, and the learning rate. So this is where we get to do it is when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6397" target="_blank">01:46:37.880</a></span> | <span class="t">finally call it here. So here's our initial hidden state, it's just a bunch of zeros, our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6404" target="_blank">01:46:44.920</a></span> | <span class="t">input, our output, and our learning rate, which we set to 0.01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6410" target="_blank">01:46:50.880</a></span> | <span class="t">And then I've just set it to something here that says every thousand times, print out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6414" target="_blank">01:46:54.720</a></span> | <span class="t">the error. And so as you can see, over time, it learns. And so at the end of learning, I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6425" target="_blank">01:47:05.800</a></span> | <span class="t">get a new theano function which takes some piece of input, along with some initial hidden</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6433" target="_blank">01:47:13.080</a></span> | <span class="t">state, and it produces not the loss, but the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6439" target="_blank">01:47:19.160</a></span> | <span class="t">Are we using gradient descent and not stochastic gradient descent here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6447" target="_blank">01:47:27.240</a></span> | <span class="t">We're using stochastic gradient descent with a mini-batch size of 1. So gradient descent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6452" target="_blank">01:47:32.920</a></span> | <span class="t">without stochastic actually means you're using a mini-batch size of the whole data set. This</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6457" target="_blank">01:47:37.400</a></span> | <span class="t">is kind of the opposite of that. I think this is called online gradient descent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6465" target="_blank">01:47:45.320</a></span> | <span class="t">So remember earlier on, we had this thing to calculate the vector of outputs. So now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6474" target="_blank">01:47:54.120</a></span> | <span class="t">to do our testing, we're going to create a new function which goes from our input to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6478" target="_blank">01:47:58.760</a></span> | <span class="t">our vector of outputs. And so our predictions will be to take that function, pass it in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6485" target="_blank">01:48:05.600</a></span> | <span class="t">our initial hidden state, and some input, and that's going to give us some predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6493" target="_blank">01:48:13.640</a></span> | <span class="t">So if we call it, we can now see, let's now grab some sequence of text, pass it to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6507" target="_blank">01:48:27.280</a></span> | <span class="t">function to get some predictions, and let's see what it does. So after t, it expected</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6511" target="_blank">01:48:31.200</a></span> | <span class="t">h, after th, it expected e, after th e, expected space, after th en, expected the space, after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6520" target="_blank">01:48:40.880</a></span> | <span class="t">th en, question mark, it expected the space. So you can see here that we have successfully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6535" target="_blank">01:48:55.080</a></span> | <span class="t">built an RNN from scratch using Theano.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6540" target="_blank">01:49:00.040</a></span> | <span class="t">That's been a very, very quick run-through. My goal really tonight is to kind of get to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6550" target="_blank">01:49:10.400</a></span> | <span class="t">a point where you can start to look at this during the week and kind of see all the pieces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6556" target="_blank">01:49:16.240</a></span> | <span class="t">Because next week, we're going to try and build an LSTM in Theano, which is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6562" target="_blank">01:49:22.320</a></span> | <span class="t">mean that I want you by next week to start to feel like you've got a good understanding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6567" target="_blank">01:49:27.560</a></span> | <span class="t">of what's going on. So please ask lots of questions on the forum, look at the documentation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6574" target="_blank">01:49:34.680</a></span> | <span class="t">and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6576" target="_blank">01:49:36.560</a></span> | <span class="t">And then the next thing we're going to do after that is we're going to build an RNN</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6582" target="_blank">01:49:42.920</a></span> | <span class="t">without using Theano. We're going to use pure NumPy. And that means that we're not going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6588" target="_blank">01:49:48.040</a></span> | <span class="t">to be able to use t.grad, we're going to have to calculate the gradients by hand. So hopefully</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6595" target="_blank">01:49:55.960</a></span> | <span class="t">that will be a useful exercise in really understanding what's going on in that propagation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6609" target="_blank">01:50:09.120</a></span> | <span class="t">So I kind of want to make sure you feel like you've got enough information to get started</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6613" target="_blank">01:50:13.600</a></span> | <span class="t">with looking at Theano this week. So did anybody want to ask any questions about this piece</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6621" target="_blank">01:50:21.160</a></span> | <span class="t">so far?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6624" target="_blank">01:50:24.960</a></span> | <span class="t">So this is maybe a bit too far away from what we did today, but how would you apply an RNN</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6637" target="_blank">01:50:37.920</a></span> | <span class="t">to say something other than text? So that's something that's worth doing, and if so, what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6642" target="_blank">01:50:42.680</a></span> | <span class="t">would change it about it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6643" target="_blank">01:50:43.960</a></span> | <span class="t">Yeah, sure. So the main way in which an RNN is applied to images is what we looked at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6651" target="_blank">01:50:51.020</a></span> | <span class="t">last week, which is these things called attentional models, which is where you basically say,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6657" target="_blank">01:50:57.680</a></span> | <span class="t">given which part of the image you're currently looking at, which part would make sense to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6663" target="_blank">01:51:03.960</a></span> | <span class="t">look at next. This is most useful on really big images where you can't really look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6683" target="_blank">01:51:23.120</a></span> | <span class="t">the whole thing at once because it would just eat up all your GPU's RAM, so you can only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6688" target="_blank">01:51:28.600</a></span> | <span class="t">look at it a little bit at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6692" target="_blank">01:51:32.200</a></span> | <span class="t">Another way that RNNs are very useful for images is for captioning images. We'll talk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6709" target="_blank">01:51:49.680</a></span> | <span class="t">a lot more about this in the next year's course, but have a think about this in the meantime.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6716" target="_blank">01:51:56.440</a></span> | <span class="t">If we've got an image, then a CNN can turn that into a vector representation of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6726" target="_blank">01:52:06.620</a></span> | <span class="t">image. For example, we could chuck it through VGG and take the penultimate layers activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6734" target="_blank">01:52:14.480</a></span> | <span class="t">There's all kinds of things we could do, but in some way we can turn an image and turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6739" target="_blank">01:52:19.900</a></span> | <span class="t">it into some vector representation of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6746" target="_blank">01:52:26.240</a></span> | <span class="t">We could do the same thing to a sentence. We can take a sentence consisting of a number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6750" target="_blank">01:52:30.520</a></span> | <span class="t">of words and we can stick that through RNN, and at the end of it we will get some state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6761" target="_blank">01:52:41.680</a></span> | <span class="t">And that state is also just a vector. What we could then do is learn a neural network</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6771" target="_blank">01:52:51.440</a></span> | <span class="t">which maps the picture to the text, assuming that this sentence was originally a caption</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6782" target="_blank">01:53:02.320</a></span> | <span class="t">that had been created for this image. In that way, if we can learn a mapping from some representation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6793" target="_blank">01:53:13.820</a></span> | <span class="t">of the image that came out of a CNN to some representation of a sentence that came out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6801" target="_blank">01:53:21.040</a></span> | <span class="t">of an RNN, then we could basically reverse that in order to generate captions for an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6808" target="_blank">01:53:28.360</a></span> | <span class="t">image. So basically what we could then do is we could take some new image that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6812" target="_blank">01:53:32.840</a></span> | <span class="t">never seen before, chuck it through the CNN to get our state out, and then we could figure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6820" target="_blank">01:53:40.000</a></span> | <span class="t">out what RNN state we would expect would be attached to that based on this neural net</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6828" target="_blank">01:53:48.360</a></span> | <span class="t">that we had learned, and then we can basically do a sequence generation just like we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6834" target="_blank">01:53:54.680</a></span> | <span class="t">been today and generate a sequence of words. And this is roughly how these image captioning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6843" target="_blank">01:54:03.160</a></span> | <span class="t">systems that I'm sure you've seen this work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6850" target="_blank">01:54:10.680</a></span> | <span class="t">So RNNs, I guess finally the only other way in which I've seen RNNs applied to images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6858" target="_blank">01:54:18.200</a></span> | <span class="t">is for really big 3D images, for example, like in medical imaging. So if you've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6867" target="_blank">01:54:27.000</a></span> | <span class="t">something like MRI that's basically a series of bladers, it's too big to look at the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6872" target="_blank">01:54:32.720</a></span> | <span class="t">thing. Instead you can use an RNN to start in the top corner and then look one pixel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6882" target="_blank">01:54:42.440</a></span> | <span class="t">to the left, then one pixel across, then one pixel back, and then it can go down into the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6887" target="_blank">01:54:47.200</a></span> | <span class="t">next layer and it can gradually look one pixel at a time. And it can do that and gradually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6893" target="_blank">01:54:53.000</a></span> | <span class="t">cover the whole thing. And in that way, it's gradually able to generate state about what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6901" target="_blank">01:55:01.720</a></span> | <span class="t">is contained in this 3D volume.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6906" target="_blank">01:55:06.000</a></span> | <span class="t">And so this is not something which is very widely used, at least at this point, but I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6913" target="_blank">01:55:13.640</a></span> | <span class="t">think it's worth thinking about. Because again, you could combine this with a CNN. Maybe you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6919" target="_blank">01:55:19.440</a></span> | <span class="t">could have a CNN that looks at large chunks of this MRI at a time and generates state</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6928" target="_blank">01:55:28.160</a></span> | <span class="t">for each of these chunks, and then maybe you could use an RNN to go through the chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6933" target="_blank">01:55:33.560</a></span> | <span class="t">There's all kinds of ways that you can combine CNNs and RNNs together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6945" target="_blank">01:55:45.600</a></span> | <span class="t">So can you build a custom layer in Theano and then mix it with Keras?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6974" target="_blank">01:56:14.460</a></span> | <span class="t">There's lots of examples of them that you'll generally find in the GitHub issues where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6983" target="_blank">01:56:23.400</a></span> | <span class="t">people will show like I was trying to build this layer and I had this problem. But it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6990" target="_blank">01:56:30.840</a></span> | <span class="t">kind of a good way to see how to build them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=6993" target="_blank">01:56:33.600</a></span> | <span class="t">The other thing I find really useful to do is to actually look at the definition of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7009" target="_blank">01:56:49.400</a></span> | <span class="t">layers in Keras. One of the things I actually did was I created this little thing called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7023" target="_blank">01:57:03.200</a></span> | <span class="t">PyPath which allows me to put in any Python module and it returns the directory that that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7036" target="_blank">01:57:16.880</a></span> | <span class="t">module is defined in, so I can go, let's have a look at how any particular layer is defined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7049" target="_blank">01:57:29.560</a></span> | <span class="t">So let's say I want to look at pooling. Here is a max_pooling1d layer and you can see it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7059" target="_blank">01:57:39.000</a></span> | <span class="t">defined in nine lines of code. Generally speaking, you can kind of see that layers don't take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7069" target="_blank">01:57:49.160</a></span> | <span class="t">very much code at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7073" target="_blank">01:57:53.400</a></span> | <span class="t">Could we, given a caption, create an image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7082" target="_blank">01:58:02.040</a></span> | <span class="t">You can absolutely create an image from a caption. There's a lot of image generation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7087" target="_blank">01:58:07.040</a></span> | <span class="t">stuff going on at the moment. It's not at a point that's probably useful for anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7093" target="_blank">01:58:13.480</a></span> | <span class="t">in practice. It's more like an interesting research journey I guess. So generally speaking,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7103" target="_blank">01:58:23.400</a></span> | <span class="t">this is in the area called generative models. We'll be looking at generative models next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7108" target="_blank">01:58:28.440</a></span> | <span class="t">year because they're very important for unsupervised and semi-supervised learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7112" target="_blank">01:58:32.520</a></span> | <span class="t">What could get the best performance on a document classification task? Is CNN, RNN, or both?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7121" target="_blank">01:58:41.080</a></span> | <span class="t">That's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7123" target="_blank">01:58:43.040</a></span> | <span class="t">So let's go back to sentiment analysis. To remind ourselves, when we looked at sentiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7130" target="_blank">01:58:50.560</a></span> | <span class="t">analysis for IMDB, the best result we got came from a multi-size convolutional neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7137" target="_blank">01:58:57.400</a></span> | <span class="t">network where we basically took a bunch of convolutional neural networks of varying sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7143" target="_blank">01:59:03.000</a></span> | <span class="t">A simple convolutional network was nearly as good. I actually tried an LSTM for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7158" target="_blank">01:59:18.280</a></span> | <span class="t">and I found the accuracy that I got was less good than the accuracy of the CNN. I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7169" target="_blank">01:59:29.320</a></span> | <span class="t">the reason for this is that when you have a whole movie review, which is a few paragraphs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7180" target="_blank">01:59:40.000</a></span> | <span class="t">the information you can get just by looking at a few words at a time is enough to tell</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7184" target="_blank">01:59:44.880</a></span> | <span class="t">you whether this is a positive review or a negative review. If you see a sequence of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7191" target="_blank">01:59:51.360</a></span> | <span class="t">five words like this is totally shit, you can probably learn that's not a good thing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7197" target="_blank">01:59:57.520</a></span> | <span class="t">or else if this is totally awesome, you can probably learn that is a good thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7201" target="_blank">02:00:01.840</a></span> | <span class="t">The amount of nuance built into reading word-by-word an entire review just doesn't seem like there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7211" target="_blank">02:00:11.200</a></span> | <span class="t">any need for that in practice. In general, once you get to a certain sized piece of text,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7221" target="_blank">02:00:21.240</a></span> | <span class="t">like a paragraph or two, there doesn't seem to be any sign that RNNs are helpful at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7230" target="_blank">02:00:30.600</a></span> | <span class="t">at this stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7235" target="_blank">02:00:35.240</a></span> | <span class="t">Before I close off, I wanted to show you two little tricks because I don't spend enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7239" target="_blank">02:00:39.840</a></span> | <span class="t">time showing you cool little tricks. When I was working with Brad today, there were two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7244" target="_blank">02:00:44.760</a></span> | <span class="t">little tricks that we realized that other people might like to learn about. The first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7250" target="_blank">02:00:50.720</a></span> | <span class="t">trick I wanted to point out to you is, if you want to learn about how a function works,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7271" target="_blank">02:01:11.080</a></span> | <span class="t">what would be a quick way to find out? If you've got a function there on your screen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7277" target="_blank">02:01:17.000</a></span> | <span class="t">and you hit Shift + Tab, all of the parameters to it will pop up. If you hit Shift + Tab twice,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7286" target="_blank">02:01:26.440</a></span> | <span class="t">the documentation will pop up. So that was one little tip that I wanted you guys to know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7292" target="_blank">02:01:32.240</a></span> | <span class="t">about because I think it's pretty handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7295" target="_blank">02:01:35.640</a></span> | <span class="t">The second little tip that you may not have been aware of is that you can actually run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7299" target="_blank">02:01:39.560</a></span> | <span class="t">the Python debugger inside Jupyter Notebook. So today we were trying to do that when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7305" target="_blank">02:01:45.040</a></span> | <span class="t">were trying to debug our pure Python RNN. So we can see an example of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7318" target="_blank">02:01:58.240</a></span> | <span class="t">So let's say we were having some problem inside our loop here. You can go import pdb, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7325" target="_blank">02:02:05.480</a></span> | <span class="t">the Python debugger, and then you can set a breakpoint anywhere. So now if I run this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7334" target="_blank">02:02:14.600</a></span> | <span class="t">as soon as it gets to here, it pops up a little dialog box and at this point I can look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7341" target="_blank">02:02:21.720</a></span> | <span class="t">anything. For example, I can say what's the value of 'er' at this point? And I can say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7346" target="_blank">02:02:26.960</a></span> | <span class="t">what are the lines I'm about to execute? And I can say execute the next one line and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7353" target="_blank">02:02:33.080</a></span> | <span class="t">shows me what line is coming next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7355" target="_blank">02:02:35.520</a></span> | <span class="t">If you want to learn about the Python debugger, just Google for a Python debugger, but learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7361" target="_blank">02:02:41.640</a></span> | <span class="t">to use the debugger is one of the most helpful things because it lets you step through each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7366" target="_blank">02:02:46.600</a></span> | <span class="t">step of what's going on and see the values of all of your variables and do all kinds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7373" target="_blank">02:02:53.000</a></span> | <span class="t">of cool stuff like that. So those were two little tips I thought I would leave you with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7377" target="_blank">02:02:57.440</a></span> | <span class="t">so we can finish on a high note.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7379" target="_blank">02:02:59.080</a></span> | <span class="t">And that's 9 o'clock. Thanks very much everybody.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ll9y1U0SoVY&t=7381" target="_blank">02:03:01.800</a></span> | <span class="t">(audience applauds)</span></div></div></body></html>