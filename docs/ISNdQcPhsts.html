<html><head><title>Coding a Transformer from scratch on PyTorch, with full explanation, training and inference.</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Coding a Transformer from scratch on PyTorch, with full explanation, training and inference.</h2><a href="https://www.youtube.com/watch?v=ISNdQcPhsts"><img src="https://i.ytimg.com/vi/ISNdQcPhsts/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=80">1:20</a> Input Embeddings<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=296">4:56</a> Positional Encodings<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=810">13:30</a> Layer Normalization<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1092">18:12</a> Feed Forward<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1303">21:43</a> Multi-Head Attention<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2561">42:41</a> Residual Connection<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2690">44:50</a> Encoder<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3112">51:52</a> Decoder<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3560">59:20</a> Linear Layer<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3685">61:25</a> Transformer<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4620">77:0</a> Task overview<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4722">78:42</a> Tokenizer<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5495">91:35</a> Dataset<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6925">115:25</a> Training loop<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8405">140:5</a> Validation loop<br><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9690">161:30</a> Attention visualization<br><br><div style="text-align: left;"><a href="./ISNdQcPhsts.html">Whisper Transcript</a> | <a href="./transcript_ISNdQcPhsts.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hello guys, welcome to another episode about the transformer. In this episode we will be building the transformer from scratch using PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7" target="_blank">00:00:07.880</a></span> | <span class="t">so coding it from zero. We will be building the model and we will also build the code for training it for inferencing and for visualizing the attention scores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=16" target="_blank">00:00:16.780</a></span> | <span class="t">stick with me because it's gonna be a long video but I assure you that by the end of the video you will have a deep knowledge of the transformer model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=24" target="_blank">00:00:24.800</a></span> | <span class="t">not only from a conceptual point of view but also from a practical point of view</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=29" target="_blank">00:00:29.120</a></span> | <span class="t">we will be building a translation model which means that our model will be able to translate from one language to another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=36" target="_blank">00:00:36.300</a></span> | <span class="t">I chose a data set that is called Opus Books and it's a synthesis taken from famous books</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=43" target="_blank">00:00:43.580</a></span> | <span class="t">I chose the English to Italian because I'm Italian so I can understand and I can tell that if the translation is good or not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=51" target="_blank">00:00:51.520</a></span> | <span class="t">but I will show you which point you can change the language so you can test the same model with the language of your choice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=58" target="_blank">00:00:58.800</a></span> | <span class="t">let's get started! Let's open the IDE of our choice, in my case I really love Visual Studio Code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=65" target="_blank">00:01:05.100</a></span> | <span class="t">and let's create our first file which is the model of the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=70" target="_blank">00:01:10.100</a></span> | <span class="t">okay, let's go have a look at the transformer model first so we know which part we are going to build first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=78" target="_blank">00:01:18.600</a></span> | <span class="t">and then we will build each part one by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=81" target="_blank">00:01:21.100</a></span> | <span class="t">the first part that we will be building is the input embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=84" target="_blank">00:01:24.600</a></span> | <span class="t">as you can see the input embeddings take the input and convert into an embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=89" target="_blank">00:01:29.100</a></span> | <span class="t">what is the input embedding?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=90" target="_blank">00:01:30.600</a></span> | <span class="t">as you remember from my previous video the input embeddings allows to convert the original sentence into a vector of 512 dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=100" target="_blank">00:01:40.100</a></span> | <span class="t">for example in this sentence "your cat is a lovely cat" first we convert the sentence into a list of input IDs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=108" target="_blank">00:01:48.300</a></span> | <span class="t">that is numbers that correspond to the position of each word inside the vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=113" target="_blank">00:01:53.900</a></span> | <span class="t">and then each of this number corresponds to an embedding which is a vector of size 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=120" target="_blank">00:02:00.200</a></span> | <span class="t">so let's build this layer first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=122" target="_blank">00:02:02.200</a></span> | <span class="t">the first thing we need to do is to import Torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=125" target="_blank">00:02:05.700</a></span> | <span class="t">and then we need to create our class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=135" target="_blank">00:02:15.500</a></span> | <span class="t">this is the constructor we will need to tell him what is the dimension of the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=148" target="_blank">00:02:28.500</a></span> | <span class="t">so the dimension of the vector in the paper this is called D model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=153" target="_blank">00:02:33.500</a></span> | <span class="t">and we also need to tell him what is the vocabulary size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=158" target="_blank">00:02:38.500</a></span> | <span class="t">so how many words there are in the vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=163" target="_blank">00:02:43.300</a></span> | <span class="t">(typing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=180" target="_blank">00:03:00.300</a></span> | <span class="t">save these two values and now we can create the actual embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=184" target="_blank">00:03:04.300</a></span> | <span class="t">actually PyTorch already provides with a layer that does exactly what we want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=190" target="_blank">00:03:10.300</a></span> | <span class="t">that is given a number it will provide you with the same vector every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=195" target="_blank">00:03:15.300</a></span> | <span class="t">and this is exactly what embedding does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=197" target="_blank">00:03:17.300</a></span> | <span class="t">it's just a mapping between numbers and a vector of size 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=201" target="_blank">00:03:21.300</a></span> | <span class="t">512 here in this our case is the D model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=205" target="_blank">00:03:25.300</a></span> | <span class="t">so this is done by the embedding layer and n.embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=210" target="_blank">00:03:30.300</a></span> | <span class="t">and vocab size and D model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=215" target="_blank">00:03:35.300</a></span> | <span class="t">let me check why my autocomplete is not working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=220" target="_blank">00:03:40.300</a></span> | <span class="t">(typing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=226" target="_blank">00:03:46.300</a></span> | <span class="t">okay so now let's implement the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=229" target="_blank">00:03:49.300</a></span> | <span class="t">(typing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=234" target="_blank">00:03:54.300</a></span> | <span class="t">what we do in the embedding is that we just use the embedding layer provided by PyTorch to do this mapping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=241" target="_blank">00:04:01.300</a></span> | <span class="t">so return self.embedding(x)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=246" target="_blank">00:04:06.300</a></span> | <span class="t">now actually there is a little detail that is written on the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=249" target="_blank">00:04:09.300</a></span> | <span class="t">that is let's have a look at the paper actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=251" target="_blank">00:04:11.300</a></span> | <span class="t">let's go here and if we check the embedding and softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=254" target="_blank">00:04:14.300</a></span> | <span class="t">we will see that in this sentence in the embedding layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=257" target="_blank">00:04:17.300</a></span> | <span class="t">we multiply the weights of the embedding by square root of D model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=261" target="_blank">00:04:21.300</a></span> | <span class="t">so what the authors do they take the embedding given by this embedding layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=268" target="_blank">00:04:28.300</a></span> | <span class="t">which I remind you is just a dictionary kind of layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=271" target="_blank">00:04:31.300</a></span> | <span class="t">that just maps numbers to the same vector every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=275" target="_blank">00:04:35.300</a></span> | <span class="t">and this vector is learned by the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=278" target="_blank">00:04:38.300</a></span> | <span class="t">so we just multiply this by math.sqrt of D model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=284" target="_blank">00:04:44.300</a></span> | <span class="t">(typing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=287" target="_blank">00:04:47.300</a></span> | <span class="t">you also need to import math</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=290" target="_blank">00:04:50.300</a></span> | <span class="t">okay now the input embeddings are ready</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=294" target="_blank">00:04:54.300</a></span> | <span class="t">let's go to the next module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=296" target="_blank">00:04:56.300</a></span> | <span class="t">the next module we are going to build is the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=299" target="_blank">00:04:59.300</a></span> | <span class="t">let's have also a look at what are the positional encoding very fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=303" target="_blank">00:05:03.300</a></span> | <span class="t">so we saw before that our original sentence gets mapped to a list of vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=308" target="_blank">00:05:08.300</a></span> | <span class="t">by the embeddings layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=312" target="_blank">00:05:12.300</a></span> | <span class="t">and this is our embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=314" target="_blank">00:05:14.300</a></span> | <span class="t">now we want to convey to the model the information about the position of each word inside the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=321" target="_blank">00:05:21.300</a></span> | <span class="t">and this is done by adding another vector of the same size as the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=325" target="_blank">00:05:25.300</a></span> | <span class="t">so of size 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=327" target="_blank">00:05:27.300</a></span> | <span class="t">that includes some special values given by a formula that I will show later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=331" target="_blank">00:05:31.300</a></span> | <span class="t">that tells the model that this particular word occupies this position in the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=336" target="_blank">00:05:36.300</a></span> | <span class="t">so we will create these vectors called the position embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=340" target="_blank">00:05:40.300</a></span> | <span class="t">and we will add them to the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=342" target="_blank">00:05:42.300</a></span> | <span class="t">okay let's go do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=343" target="_blank">00:05:43.300</a></span> | <span class="t">okay let's define the class positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=346" target="_blank">00:05:46.300</a></span> | <span class="t">(typing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=352" target="_blank">00:05:52.300</a></span> | <span class="t">and we define the constructor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=355" target="_blank">00:05:55.300</a></span> | <span class="t">okay what we need to give to the constructor is for sure the D model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=360" target="_blank">00:06:00.300</a></span> | <span class="t">because this is the size of the vector that the positional encoding should be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=364" target="_blank">00:06:04.300</a></span> | <span class="t">and the sequence length this is the maximum length of the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=369" target="_blank">00:06:09.300</a></span> | <span class="t">and because we need to create one vector for each position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=373" target="_blank">00:06:13.300</a></span> | <span class="t">and we also need to give the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=376" target="_blank">00:06:16.300</a></span> | <span class="t">dropout is to make the model less over fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=380" target="_blank">00:06:20.300</a></span> | <span class="t">(typing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=397" target="_blank">00:06:37.300</a></span> | <span class="t">okay let's actually build a positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=401" target="_blank">00:06:41.300</a></span> | <span class="t">okay first of all the positional encoding is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=404" target="_blank">00:06:44.300</a></span> | <span class="t">we will build a matrix of shape sequence length to D model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=407" target="_blank">00:06:47.300</a></span> | <span class="t">why sequence length to D model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=409" target="_blank">00:06:49.300</a></span> | <span class="t">because we need vectors of D model size so 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=414" target="_blank">00:06:54.300</a></span> | <span class="t">but we need sequence length number of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=417" target="_blank">00:06:57.300</a></span> | <span class="t">because the maximum length of the sentence is sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=420" target="_blank">00:07:00.300</a></span> | <span class="t">so let's do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=423" target="_blank">00:07:03.300</a></span> | <span class="t">(typing)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=435" target="_blank">00:07:15.300</a></span> | <span class="t">okay before we create the matrix and we know how to create the matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=440" target="_blank">00:07:20.300</a></span> | <span class="t">let's have a look at the formula used to create the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=443" target="_blank">00:07:23.300</a></span> | <span class="t">so let's go have a look at the formula used to create the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=447" target="_blank">00:07:27.300</a></span> | <span class="t">this is the slide from my previous video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=450" target="_blank">00:07:30.300</a></span> | <span class="t">and let's have a look at how to build the vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=453" target="_blank">00:07:33.300</a></span> | <span class="t">so as you remember we have a sentence let's say in this case we have three words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=456" target="_blank">00:07:36.300</a></span> | <span class="t">we use these two formulas taken from the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=460" target="_blank">00:07:40.300</a></span> | <span class="t">we create a vector of size 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=463" target="_blank">00:07:43.300</a></span> | <span class="t">and one for each possible position so up to sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=468" target="_blank">00:07:48.300</a></span> | <span class="t">and in the even positions we apply the first formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=472" target="_blank">00:07:52.300</a></span> | <span class="t">in the odd positions of the vector we apply the second formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=476" target="_blank">00:07:56.300</a></span> | <span class="t">in this case I will actually simplify the calculation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=480" target="_blank">00:08:00.300</a></span> | <span class="t">because I saw online it has been simplified also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=483" target="_blank">00:08:03.300</a></span> | <span class="t">so we will do a slightly modified calculation using log space</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=488" target="_blank">00:08:08.300</a></span> | <span class="t">this is for numerical stability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=490" target="_blank">00:08:10.300</a></span> | <span class="t">so when you apply the exponential and then the log of something inside the exponential</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=495" target="_blank">00:08:15.300</a></span> | <span class="t">the result is the same number but it's more numerically stable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=499" target="_blank">00:08:19.300</a></span> | <span class="t">so first we create a vector called position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=502" target="_blank">00:08:22.300</a></span> | <span class="t">that will represent the position of the word inside the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=506" target="_blank">00:08:26.300</a></span> | <span class="t">and this vector can go from 0 to sequence length -1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=516" target="_blank">00:08:36.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=533" target="_blank">00:08:53.300</a></span> | <span class="t">so actually we are creating a tensor of shape sequence length to 1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=540" target="_blank">00:09:00.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=550" target="_blank">00:09:10.300</a></span> | <span class="t">okay now we create the denominator of the formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=575" target="_blank">00:09:35.300</a></span> | <span class="t">and these are the two terms we see inside the formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=579" target="_blank">00:09:39.300</a></span> | <span class="t">let's go back to the slide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=580" target="_blank">00:09:40.300</a></span> | <span class="t">so the first tensor that we build that's called position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=584" target="_blank">00:09:44.300</a></span> | <span class="t">it's this pause here and the second tensor that we build is the denominator here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=588" target="_blank">00:09:48.300</a></span> | <span class="t">but we calculated it in log space for numerical stability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=592" target="_blank">00:09:52.300</a></span> | <span class="t">the value actually will be slightly different but the result will be the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=596" target="_blank">00:09:56.300</a></span> | <span class="t">the model will learn this positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=598" target="_blank">00:09:58.300</a></span> | <span class="t">don't worry if you don't fully understand this part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=601" target="_blank">00:10:01.300</a></span> | <span class="t">it's just very special let's say functions that convey this positional information to the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=607" target="_blank">00:10:07.300</a></span> | <span class="t">and if you watched my previous video you will also understand why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=611" target="_blank">00:10:11.300</a></span> | <span class="t">now we apply this to denominator and denominator to the sine and the cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=615" target="_blank">00:10:15.300</a></span> | <span class="t">as you remember the sine is only used for the even positions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=619" target="_blank">00:10:19.300</a></span> | <span class="t">and the cosine only for the odd positions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=621" target="_blank">00:10:21.300</a></span> | <span class="t">so we will apply it twice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=623" target="_blank">00:10:23.300</a></span> | <span class="t">let's do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=624" target="_blank">00:10:24.300</a></span> | <span class="t">so apply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=626" target="_blank">00:10:26.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=632" target="_blank">00:10:32.300</a></span> | <span class="t">so every position will have the sine but only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=637" target="_blank">00:10:37.300</a></span> | <span class="t">so every word will have the sine but only the even dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=641" target="_blank">00:10:41.300</a></span> | <span class="t">so starting from 0 up to the end and going forward by 2 means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=646" target="_blank">00:10:46.300</a></span> | <span class="t">every from 0 then the number 2 then the number 4 etc etc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=651" target="_blank">00:10:51.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=654" target="_blank">00:10:54.300</a></span> | <span class="t">position multiplied by diphtherm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=657" target="_blank">00:10:57.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=659" target="_blank">00:10:59.300</a></span> | <span class="t">then we do the same for the cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=662" target="_blank">00:11:02.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=666" target="_blank">00:11:06.300</a></span> | <span class="t">in this case we start from 1 and go forward by 2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=669" target="_blank">00:11:09.300</a></span> | <span class="t">it means 1, 3, 5 etc</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=672" target="_blank">00:11:12.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=678" target="_blank">00:11:18.300</a></span> | <span class="t">and then we need to add the batch dimension to this tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=682" target="_blank">00:11:22.300</a></span> | <span class="t">so that we can apply it to the whole sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=685" target="_blank">00:11:25.300</a></span> | <span class="t">so to all the batch of sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=687" target="_blank">00:11:27.300</a></span> | <span class="t">because now the shape is sequence length to demodule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=689" target="_blank">00:11:29.300</a></span> | <span class="t">but we will have a batch of sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=691" target="_blank">00:11:31.300</a></span> | <span class="t">so what we do is we add a new dimension to this PE</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=695" target="_blank">00:11:35.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=697" target="_blank">00:11:37.300</a></span> | <span class="t">and this is done using unsqueeze</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=699" target="_blank">00:11:39.300</a></span> | <span class="t">and in the first position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=701" target="_blank">00:11:41.300</a></span> | <span class="t">so it will become a tensor of shape 1 to sequence length to demodule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=708" target="_blank">00:11:48.300</a></span> | <span class="t">and finally we can register this tensor in the buffer of this module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=713" target="_blank">00:11:53.300</a></span> | <span class="t">so what is the buffer of the module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=715" target="_blank">00:11:55.300</a></span> | <span class="t">let's first do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=717" target="_blank">00:11:57.300</a></span> | <span class="t">register buffer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=719" target="_blank">00:11:59.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=722" target="_blank">00:12:02.300</a></span> | <span class="t">so basically when you have a tensor that you want to keep inside the module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=727" target="_blank">00:12:07.300</a></span> | <span class="t">not as a parameter, learned parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=729" target="_blank">00:12:09.300</a></span> | <span class="t">but you want it to be saved when you save the file of the module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=733" target="_blank">00:12:13.300</a></span> | <span class="t">you should register it as a buffer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=735" target="_blank">00:12:15.300</a></span> | <span class="t">this way the tensor will be saved in the file along with the state of the module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=739" target="_blank">00:12:19.300</a></span> | <span class="t">then we do the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=742" target="_blank">00:12:22.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=746" target="_blank">00:12:26.300</a></span> | <span class="t">so as you remember from before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=748" target="_blank">00:12:28.300</a></span> | <span class="t">we need to add this positional encoding to every word inside the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=753" target="_blank">00:12:33.300</a></span> | <span class="t">so let's do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=755" target="_blank">00:12:35.300</a></span> | <span class="t">so we just do x is equal to x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=757" target="_blank">00:12:37.300</a></span> | <span class="t">plus the positional encoding for this particular sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=761" target="_blank">00:12:41.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=771" target="_blank">00:12:51.300</a></span> | <span class="t">and we also tell the module that we don't want to learn this positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=776" target="_blank">00:12:56.300</a></span> | <span class="t">because they are fixed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=778" target="_blank">00:12:58.300</a></span> | <span class="t">they will always be the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=780" target="_blank">00:13:00.300</a></span> | <span class="t">they are not learned along the training process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=782" target="_blank">00:13:02.300</a></span> | <span class="t">so we just do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=784" target="_blank">00:13:04.300</a></span> | <span class="t">require squared false</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=786" target="_blank">00:13:06.300</a></span> | <span class="t">this will make this particular tensor not learned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=790" target="_blank">00:13:10.300</a></span> | <span class="t">and then we apply the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=792" target="_blank">00:13:12.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=796" target="_blank">00:13:16.300</a></span> | <span class="t">and that's it, this is the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=798" target="_blank">00:13:18.300</a></span> | <span class="t">let's have a look at the next module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=800" target="_blank">00:13:20.300</a></span> | <span class="t">first we will build the encoder part of the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=804" target="_blank">00:13:24.300</a></span> | <span class="t">which is this left side here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=806" target="_blank">00:13:26.300</a></span> | <span class="t">and we still have the multihead attention to build the add and norm and the feedforward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=811" target="_blank">00:13:31.300</a></span> | <span class="t">and actually there is another layer which connects this skip connection to all these sublayers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=816" target="_blank">00:13:36.300</a></span> | <span class="t">so let's start with the easiest one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=818" target="_blank">00:13:38.300</a></span> | <span class="t">let's start with layer normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=819" target="_blank">00:13:39.300</a></span> | <span class="t">which is this add and norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=821" target="_blank">00:13:41.300</a></span> | <span class="t">as you remember from my previous video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=823" target="_blank">00:13:43.300</a></span> | <span class="t">let's have a look at the layer normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=825" target="_blank">00:13:45.300</a></span> | <span class="t">a little briefing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=827" target="_blank">00:13:47.300</a></span> | <span class="t">layer normalization basically means that if you have a batch of n items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=830" target="_blank">00:13:50.300</a></span> | <span class="t">in this case only 3</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=832" target="_blank">00:13:52.300</a></span> | <span class="t">each item will have some features</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=834" target="_blank">00:13:54.300</a></span> | <span class="t">let's say that these are actually sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=837" target="_blank">00:13:57.300</a></span> | <span class="t">and each sentence is made up of many words with its numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=840" target="_blank">00:14:00.300</a></span> | <span class="t">so this is our 3 items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=843" target="_blank">00:14:03.300</a></span> | <span class="t">and layer normalization means that for each item in this batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=847" target="_blank">00:14:07.300</a></span> | <span class="t">we calculate a mean and a variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=849" target="_blank">00:14:09.300</a></span> | <span class="t">independently from the other items of the batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=852" target="_blank">00:14:12.300</a></span> | <span class="t">and then we calculate the new values for each of them using their own mean and their own variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=858" target="_blank">00:14:18.300</a></span> | <span class="t">in the layer normalization usually we also introduce some parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=863" target="_blank">00:14:23.300</a></span> | <span class="t">called gamma and beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=865" target="_blank">00:14:25.300</a></span> | <span class="t">some people call it alpha and beta</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=867" target="_blank">00:14:27.300</a></span> | <span class="t">some people call it alpha and bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=869" target="_blank">00:14:29.300</a></span> | <span class="t">ok, it doesn't matter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=870" target="_blank">00:14:30.300</a></span> | <span class="t">one is multiplicative, so it's multiplied by each of these x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=873" target="_blank">00:14:33.300</a></span> | <span class="t">and one is additive, so it's added to each one of these x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=877" target="_blank">00:14:37.300</a></span> | <span class="t">why?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=878" target="_blank">00:14:38.300</a></span> | <span class="t">because we want the model to have the possibility to amplify these values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=883" target="_blank">00:14:43.300</a></span> | <span class="t">when he needs this value to be amplified</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=886" target="_blank">00:14:46.300</a></span> | <span class="t">so the model will learn to multiply this gamma by these values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=891" target="_blank">00:14:51.300</a></span> | <span class="t">in such a way to amplify the values that it wants to be amplified</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=894" target="_blank">00:14:54.300</a></span> | <span class="t">ok, let's go to build the code for this layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=897" target="_blank">00:14:57.300</a></span> | <span class="t">let's define the layer normalization class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=906" target="_blank">00:15:06.300</a></span> | <span class="t">and constructor as usual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=909" target="_blank">00:15:09.300</a></span> | <span class="t">in this case we don't need any parameter except for one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=914" target="_blank">00:15:14.300</a></span> | <span class="t">that I will show you now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=916" target="_blank">00:15:16.300</a></span> | <span class="t">which is epsilon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=918" target="_blank">00:15:18.300</a></span> | <span class="t">and usually EPS stands for epsilon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=921" target="_blank">00:15:21.300</a></span> | <span class="t">which is a very small number that you need to give to the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=924" target="_blank">00:15:24.300</a></span> | <span class="t">and I will also show you why we need this number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=927" target="_blank">00:15:27.300</a></span> | <span class="t">in this case we use 10 to the power of -6</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=931" target="_blank">00:15:31.300</a></span> | <span class="t">let's save it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=933" target="_blank">00:15:33.300</a></span> | <span class="t">ok, this epsilon is needed because if we look at the slide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=937" target="_blank">00:15:37.300</a></span> | <span class="t">we have this epsilon here in the denominator of this formula here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=941" target="_blank">00:15:41.300</a></span> | <span class="t">so x with cap is equal to xj minus mu</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=945" target="_blank">00:15:45.300</a></span> | <span class="t">divided by the square root of sigma square plus epsilon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=949" target="_blank">00:15:49.300</a></span> | <span class="t">why we need this epsilon?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=951" target="_blank">00:15:51.300</a></span> | <span class="t">because imagine this denominator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=953" target="_blank">00:15:53.300</a></span> | <span class="t">if sigma happens to be 0 or very close to 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=957" target="_blank">00:15:57.300</a></span> | <span class="t">this x new will become very big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=960" target="_blank">00:16:00.300</a></span> | <span class="t">which is undesirable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=961" target="_blank">00:16:01.300</a></span> | <span class="t">as we know that the CPU or the GPU can only represent numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=965" target="_blank">00:16:05.300</a></span> | <span class="t">up to a certain position and scale</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=968" target="_blank">00:16:08.300</a></span> | <span class="t">so we don't want very big numbers or very small numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=971" target="_blank">00:16:11.300</a></span> | <span class="t">so usually for numerical stability we use this epsilon</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=974" target="_blank">00:16:14.300</a></span> | <span class="t">also to avoid division by 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=976" target="_blank">00:16:16.300</a></span> | <span class="t">let's go forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=977" target="_blank">00:16:17.300</a></span> | <span class="t">so now let's introduce the two parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=979" target="_blank">00:16:19.300</a></span> | <span class="t">that we will use for the layer normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=981" target="_blank">00:16:21.300</a></span> | <span class="t">one is called alpha which will be multiplied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=983" target="_blank">00:16:23.300</a></span> | <span class="t">and one is bias which will be added</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=985" target="_blank">00:16:25.300</a></span> | <span class="t">usually the additive is called bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=988" target="_blank">00:16:28.300</a></span> | <span class="t">it's always added</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=989" target="_blank">00:16:29.300</a></span> | <span class="t">and the alpha is the one that is multiplied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=991" target="_blank">00:16:31.300</a></span> | <span class="t">in this case we will use nn.parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=996" target="_blank">00:16:36.300</a></span> | <span class="t">this makes the parameter learnable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=999" target="_blank">00:16:39.300</a></span> | <span class="t">and we define also the bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1006" target="_blank">00:16:46.300</a></span> | <span class="t">this I want to remind you is multiplied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1013" target="_blank">00:16:53.300</a></span> | <span class="t">and this is added</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1018" target="_blank">00:16:58.300</a></span> | <span class="t">let's define the forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1020" target="_blank">00:17:00.300</a></span> | <span class="t">okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1023" target="_blank">00:17:03.300</a></span> | <span class="t">as you remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1024" target="_blank">00:17:04.300</a></span> | <span class="t">we need to calculate the mean and the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1026" target="_blank">00:17:06.300</a></span> | <span class="t">or the variance for both of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1028" target="_blank">00:17:08.300</a></span> | <span class="t">we will calculate the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1030" target="_blank">00:17:10.300</a></span> | <span class="t">of the last dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1037" target="_blank">00:17:17.300</a></span> | <span class="t">so everything after the batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1040" target="_blank">00:17:20.300</a></span> | <span class="t">and we keep the dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1044" target="_blank">00:17:24.300</a></span> | <span class="t">so this parameter keep dimension means that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1047" target="_blank">00:17:27.300</a></span> | <span class="t">usually the mean cancels the dimension to which it is applied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1051" target="_blank">00:17:31.300</a></span> | <span class="t">but we want to keep it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1053" target="_blank">00:17:33.300</a></span> | <span class="t">and then we just apply the formula that we saw on the slide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1070" target="_blank">00:17:50.300</a></span> | <span class="t">alpha multiplied by what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1072" target="_blank">00:17:52.300</a></span> | <span class="t">x minus its mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1075" target="_blank">00:17:55.300</a></span> | <span class="t">divided by the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1078" target="_blank">00:17:58.300</a></span> | <span class="t">plus self.eps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1081" target="_blank">00:18:01.300</a></span> | <span class="t">everything added to bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1084" target="_blank">00:18:04.300</a></span> | <span class="t">and this is our layer normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1089" target="_blank">00:18:09.300</a></span> | <span class="t">okay let's go have a look at the next layer we are going to build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1092" target="_blank">00:18:12.300</a></span> | <span class="t">the next layer we are going to build is the feed forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1095" target="_blank">00:18:15.300</a></span> | <span class="t">you can see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1096" target="_blank">00:18:16.300</a></span> | <span class="t">and the feed forward is basically a fully connected layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1101" target="_blank">00:18:21.300</a></span> | <span class="t">that the model uses both in the encoder and in the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1106" target="_blank">00:18:26.300</a></span> | <span class="t">let's first have a look at the paper to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1108" target="_blank">00:18:28.300</a></span> | <span class="t">what are the details of this feed forward layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1111" target="_blank">00:18:31.300</a></span> | <span class="t">in the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1112" target="_blank">00:18:32.300</a></span> | <span class="t">the feed forward layer is basically two matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1115" target="_blank">00:18:35.300</a></span> | <span class="t">one w1 one w2 that are multiplied by this x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1119" target="_blank">00:18:39.300</a></span> | <span class="t">one after another with a relu in between and with a bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1123" target="_blank">00:18:43.300</a></span> | <span class="t">we can do this in PyTorch using a linear layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1127" target="_blank">00:18:47.300</a></span> | <span class="t">in which we define the first one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1130" target="_blank">00:18:50.300</a></span> | <span class="t">to be the matrix with the w1 and b1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1133" target="_blank">00:18:53.300</a></span> | <span class="t">and the second one to be the w2 and the b2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1136" target="_blank">00:18:56.300</a></span> | <span class="t">and in between we apply a relu</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1138" target="_blank">00:18:58.300</a></span> | <span class="t">in the paper we can also see the dimensions of these matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1142" target="_blank">00:19:02.300</a></span> | <span class="t">so the first one is basically d model to dff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1146" target="_blank">00:19:06.300</a></span> | <span class="t">and the second one is from dff to d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1149" target="_blank">00:19:09.300</a></span> | <span class="t">so dff is 2048 and d model is 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1153" target="_blank">00:19:13.300</a></span> | <span class="t">let's go build it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1154" target="_blank">00:19:14.300</a></span> | <span class="t">class feed forward block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1158" target="_blank">00:19:18.300</a></span> | <span class="t">we also build in this case the constructor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1164" target="_blank">00:19:24.300</a></span> | <span class="t">and in the constructor we need to define these two values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1170" target="_blank">00:19:30.300</a></span> | <span class="t">that we saw on the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1171" target="_blank">00:19:31.300</a></span> | <span class="t">so d model dff and also in this case dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1176" target="_blank">00:19:36.300</a></span> | <span class="t">we define the first matrix so w1 and b1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1190" target="_blank">00:19:50.300</a></span> | <span class="t">to be the linear one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1192" target="_blank">00:19:52.300</a></span> | <span class="t">and it's from d model to dff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1198" target="_blank">00:19:58.300</a></span> | <span class="t">and then we apply the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1200" target="_blank">00:20:00.300</a></span> | <span class="t">actually we define the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1204" target="_blank">00:20:04.300</a></span> | <span class="t">and then we define the second matrix w2 and b2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1211" target="_blank">00:20:11.300</a></span> | <span class="t">so let me write the comments here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1213" target="_blank">00:20:13.300</a></span> | <span class="t">it's w1 and b1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1216" target="_blank">00:20:16.300</a></span> | <span class="t">of dff to d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1225" target="_blank">00:20:25.300</a></span> | <span class="t">and this is w2 and b2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1228" target="_blank">00:20:28.300</a></span> | <span class="t">why we have b2?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1229" target="_blank">00:20:29.300</a></span> | <span class="t">because actually as you can see here bias is by default it's true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1234" target="_blank">00:20:34.300</a></span> | <span class="t">so it's already defining a bias matrix for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1237" target="_blank">00:20:37.300</a></span> | <span class="t">okay let's define the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1243" target="_blank">00:20:43.300</a></span> | <span class="t">in this case what we are going to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1247" target="_blank">00:20:47.300</a></span> | <span class="t">we have an input sentence which is batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1251" target="_blank">00:20:51.300</a></span> | <span class="t">it's a tensor with dimension batch sequence length and d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1257" target="_blank">00:20:57.300</a></span> | <span class="t">first we will convert it using linear 1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1260" target="_blank">00:21:00.300</a></span> | <span class="t">into another tensor of batch to sequence length to dff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1267" target="_blank">00:21:07.300</a></span> | <span class="t">because if we apply this linear it will convert the d model into dff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1271" target="_blank">00:21:11.300</a></span> | <span class="t">and then we apply the linear 2 which will convert it back to d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1276" target="_blank">00:21:16.300</a></span> | <span class="t">we apply the dropout in between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1290" target="_blank">00:21:30.300</a></span> | <span class="t">and this is our feed forward block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1300" target="_blank">00:21:40.300</a></span> | <span class="t">let's go have a look at the next block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1302" target="_blank">00:21:42.300</a></span> | <span class="t">our next block is the most important and most interesting one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1306" target="_blank">00:21:46.300</a></span> | <span class="t">and it's the multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1308" target="_blank">00:21:48.300</a></span> | <span class="t">we saw briefly in the last video how the multi-head attention works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1314" target="_blank">00:21:54.300</a></span> | <span class="t">so I will open now the slide again to show to rehearse how it actually works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1320" target="_blank">00:22:00.300</a></span> | <span class="t">and then we will do it practically by coding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1323" target="_blank">00:22:03.300</a></span> | <span class="t">as you remember in the encoder we have the multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1326" target="_blank">00:22:06.300</a></span> | <span class="t">that takes the input of the encoder and uses it three times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1331" target="_blank">00:22:11.300</a></span> | <span class="t">one time it's called query, one time it's called key and one time it's called values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1336" target="_blank">00:22:16.300</a></span> | <span class="t">you can also think it like a duplication of the input three times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1340" target="_blank">00:22:20.300</a></span> | <span class="t">or you can just say that it's the same input applied three times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1343" target="_blank">00:22:23.300</a></span> | <span class="t">and the multi-head attention basically works like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1346" target="_blank">00:22:26.300</a></span> | <span class="t">we have our input sequence which is sequence length by d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1350" target="_blank">00:22:30.300</a></span> | <span class="t">we transform into three matrices q, k and v</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1355" target="_blank">00:22:35.300</a></span> | <span class="t">which are exactly the same as the input in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1358" target="_blank">00:22:38.300</a></span> | <span class="t">because we are talking about the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1360" target="_blank">00:22:40.300</a></span> | <span class="t">you see that in the decoder it's a slightly different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1362" target="_blank">00:22:42.300</a></span> | <span class="t">and then we multiply this by matrices called w, q, w, k and w, v</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1369" target="_blank">00:22:49.300</a></span> | <span class="t">and this results in a new matrix of dimension sequence by d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1374" target="_blank">00:22:54.300</a></span> | <span class="t">we then split these matrices into h matrices, smaller matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1379" target="_blank">00:22:59.300</a></span> | <span class="t">why h? because it's the number of head we want for this multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1383" target="_blank">00:23:03.300</a></span> | <span class="t">and we split these matrices along the embedding dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1387" target="_blank">00:23:07.300</a></span> | <span class="t">not along the sequence dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1388" target="_blank">00:23:08.300</a></span> | <span class="t">which means that each head we will have access to the full sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1392" target="_blank">00:23:12.300</a></span> | <span class="t">but a different part of the embedding of each word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1396" target="_blank">00:23:16.300</a></span> | <span class="t">we apply the attention to each of these smaller matrices using this formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1401" target="_blank">00:23:21.300</a></span> | <span class="t">which will give us smaller matrices as a result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1404" target="_blank">00:23:24.300</a></span> | <span class="t">then we combine them back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1406" target="_blank">00:23:26.300</a></span> | <span class="t">so we concatenate them back just like the paper says</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1410" target="_blank">00:23:30.300</a></span> | <span class="t">so concatenation of head one up to head h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1413" target="_blank">00:23:33.300</a></span> | <span class="t">and finally we multiply it by w, o to get the multi-head attention output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1418" target="_blank">00:23:38.300</a></span> | <span class="t">which again is a matrix that has the same dimension as the input matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1423" target="_blank">00:23:43.300</a></span> | <span class="t">as you can see the output of the multi-head attention is also sequenced by d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1428" target="_blank">00:23:48.300</a></span> | <span class="t">in this slide actually I didn't show the batch dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1431" target="_blank">00:23:51.300</a></span> | <span class="t">because we are talking about one sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1433" target="_blank">00:23:53.300</a></span> | <span class="t">but when we code the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1435" target="_blank">00:23:55.300</a></span> | <span class="t">we don't work only with one sentence but with multiple sentences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1438" target="_blank">00:23:58.300</a></span> | <span class="t">so we need to think that we have another dimension here which is the batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1443" target="_blank">00:24:03.300</a></span> | <span class="t">okay let's go to code this multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1447" target="_blank">00:24:07.300</a></span> | <span class="t">I will do it a little more slower</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1449" target="_blank">00:24:09.300</a></span> | <span class="t">so we can see in detail everything how it's done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1453" target="_blank">00:24:13.300</a></span> | <span class="t">but I really wanted you to have an overview again of how it works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1457" target="_blank">00:24:17.300</a></span> | <span class="t">and why we are doing what we are doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1459" target="_blank">00:24:19.300</a></span> | <span class="t">so let's go code it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1461" target="_blank">00:24:21.300</a></span> | <span class="t">class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1469" target="_blank">00:24:29.300</a></span> | <span class="t">also in this case we define the constructor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1473" target="_blank">00:24:33.300</a></span> | <span class="t">and what we need to give to this multi-head attention as parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1477" target="_blank">00:24:37.300</a></span> | <span class="t">for sure the d model of the model which is in our case 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1482" target="_blank">00:24:42.300</a></span> | <span class="t">the number of heads which we call h just like in the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1486" target="_blank">00:24:46.300</a></span> | <span class="t">so h indicates the number of heads we want and then the dropout value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1492" target="_blank">00:24:52.300</a></span> | <span class="t">we save these values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1500" target="_blank">00:25:00.300</a></span> | <span class="t">as you can see we need to divide this embedding vector into h heads</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1505" target="_blank">00:25:05.300</a></span> | <span class="t">which means that this d model should be divisible by h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1508" target="_blank">00:25:08.300</a></span> | <span class="t">otherwise we cannot divide equally the same vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1513" target="_blank">00:25:13.300</a></span> | <span class="t">representing the embedding into equal matrices for each head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1517" target="_blank">00:25:17.300</a></span> | <span class="t">so we make sure that d model is divisible by h basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1533" target="_blank">00:25:33.300</a></span> | <span class="t">and this will make the check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1535" target="_blank">00:25:35.300</a></span> | <span class="t">if we watch again my slide we can see that the value d model divided by h is called dk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1541" target="_blank">00:25:41.300</a></span> | <span class="t">as we can see here if we divide the d model by h heads</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1548" target="_blank">00:25:48.300</a></span> | <span class="t">we get a new value which is called dk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1550" target="_blank">00:25:50.300</a></span> | <span class="t">and to be aligned with what the paper with the nomenclature used in the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1554" target="_blank">00:25:54.300</a></span> | <span class="t">we will also call it dk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1556" target="_blank">00:25:56.300</a></span> | <span class="t">so dk is d model divided by h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1568" target="_blank">00:26:08.300</a></span> | <span class="t">okay let's also define the matrices by which we will multiply the query the key and the values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1574" target="_blank">00:26:14.300</a></span> | <span class="t">and also the output matrix w o</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1581" target="_blank">00:26:21.300</a></span> | <span class="t">this again is a linear so from d model to d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1585" target="_blank">00:26:25.300</a></span> | <span class="t">why from d model to d model because as you can see from my slides</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1590" target="_blank">00:26:30.300</a></span> | <span class="t">this is d model by d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1593" target="_blank">00:26:33.300</a></span> | <span class="t">so that the output will be sequenced by d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1599" target="_blank">00:26:39.300</a></span> | <span class="t">so this is wq</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1608" target="_blank">00:26:48.300</a></span> | <span class="t">this is wk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1620" target="_blank">00:27:00.300</a></span> | <span class="t">and this is wv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1623" target="_blank">00:27:03.300</a></span> | <span class="t">finally we also have the output matrix which is called w o here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1626" target="_blank">00:27:06.300</a></span> | <span class="t">this w o is h by dv by d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1631" target="_blank">00:27:11.300</a></span> | <span class="t">so h by dv, dv is what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1633" target="_blank">00:27:13.300</a></span> | <span class="t">dv is actually equal to dk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1635" target="_blank">00:27:15.300</a></span> | <span class="t">because it's the d model divided by h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1638" target="_blank">00:27:18.300</a></span> | <span class="t">but why it's called dv here and dk here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1641" target="_blank">00:27:21.300</a></span> | <span class="t">because this head is actually the result this head comes from this multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1647" target="_blank">00:27:27.300</a></span> | <span class="t">and the last multiplication is by v</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1649" target="_blank">00:27:29.300</a></span> | <span class="t">and in the paper they call this value dv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1652" target="_blank">00:27:32.300</a></span> | <span class="t">but on a practical level it's equal to dk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1656" target="_blank">00:27:36.300</a></span> | <span class="t">so our w o is also a matrix that is d model by d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1661" target="_blank">00:27:41.300</a></span> | <span class="t">because h by dv is equal to d model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1672" target="_blank">00:27:52.300</a></span> | <span class="t">and this is w o</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1674" target="_blank">00:27:54.300</a></span> | <span class="t">finally we create the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1682" target="_blank">00:28:02.300</a></span> | <span class="t">let's implement the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1684" target="_blank">00:28:04.300</a></span> | <span class="t">and let's see how the multi head attention works in detail during the coding process</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1691" target="_blank">00:28:11.300</a></span> | <span class="t">we define the query, the key and the values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1696" target="_blank">00:28:16.300</a></span> | <span class="t">and there is this mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1698" target="_blank">00:28:18.300</a></span> | <span class="t">so what is this mask?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1700" target="_blank">00:28:20.300</a></span> | <span class="t">the mask is basically if we want some words to not interact with other words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1706" target="_blank">00:28:26.300</a></span> | <span class="t">we mask them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1708" target="_blank">00:28:28.300</a></span> | <span class="t">and we saw in my previous video but now let's go back to those slides</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1711" target="_blank">00:28:31.300</a></span> | <span class="t">to see what is the mask doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1713" target="_blank">00:28:33.300</a></span> | <span class="t">as you remember when we calculate the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1716" target="_blank">00:28:36.300</a></span> | <span class="t">using this formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1717" target="_blank">00:28:37.300</a></span> | <span class="t">so softmax of q multiplied by kt</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1720" target="_blank">00:28:40.300</a></span> | <span class="t">divided by square root of dk and then by v</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1723" target="_blank">00:28:43.300</a></span> | <span class="t">we get this head matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1726" target="_blank">00:28:46.300</a></span> | <span class="t">but before we multiply by v</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1728" target="_blank">00:28:48.300</a></span> | <span class="t">so only this multiplication here with q by k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1733" target="_blank">00:28:53.300</a></span> | <span class="t">we get this matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1734" target="_blank">00:28:54.300</a></span> | <span class="t">which is each word with each other word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1737" target="_blank">00:28:57.300</a></span> | <span class="t">it's a sequence by sequence matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1740" target="_blank">00:29:00.300</a></span> | <span class="t">and if we don't want some words to interact with other words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1743" target="_blank">00:29:03.300</a></span> | <span class="t">we basically replace their value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1745" target="_blank">00:29:05.300</a></span> | <span class="t">so their attention score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1747" target="_blank">00:29:07.300</a></span> | <span class="t">with something that is very small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1749" target="_blank">00:29:09.300</a></span> | <span class="t">before we apply the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1751" target="_blank">00:29:11.300</a></span> | <span class="t">and when we apply the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1753" target="_blank">00:29:13.300</a></span> | <span class="t">these values will become zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1755" target="_blank">00:29:15.300</a></span> | <span class="t">because as you remember the softmax on the numerator has e to the power of x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1759" target="_blank">00:29:19.300</a></span> | <span class="t">so if x goes to minus infinity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1762" target="_blank">00:29:22.300</a></span> | <span class="t">so a very small number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1763" target="_blank">00:29:23.300</a></span> | <span class="t">e to the power of minus infinity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1765" target="_blank">00:29:25.300</a></span> | <span class="t">will become very small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1767" target="_blank">00:29:27.300</a></span> | <span class="t">so very close to zero</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1768" target="_blank">00:29:28.300</a></span> | <span class="t">so basically we hide the attention for those two words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1773" target="_blank">00:29:33.300</a></span> | <span class="t">so this is the job of the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1777" target="_blank">00:29:37.300</a></span> | <span class="t">just following my slide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1779" target="_blank">00:29:39.300</a></span> | <span class="t">we do the multiplication one by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1781" target="_blank">00:29:41.300</a></span> | <span class="t">so as we remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1782" target="_blank">00:29:42.300</a></span> | <span class="t">we calculate first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1783" target="_blank">00:29:43.300</a></span> | <span class="t">the query are multiplied by the wq</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1786" target="_blank">00:29:46.300</a></span> | <span class="t">so self.wq multiplied with the query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1790" target="_blank">00:29:50.300</a></span> | <span class="t">gives us a new matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1792" target="_blank">00:29:52.300</a></span> | <span class="t">which is called the q prime in my slides</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1794" target="_blank">00:29:54.300</a></span> | <span class="t">I just call it query here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1799" target="_blank">00:29:59.300</a></span> | <span class="t">we do the same with the keys</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1801" target="_blank">00:30:01.300</a></span> | <span class="t">and the same with the values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1807" target="_blank">00:30:07.300</a></span> | <span class="t">let me also write the dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1809" target="_blank">00:30:09.300</a></span> | <span class="t">so we are going from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1811" target="_blank">00:30:11.300</a></span> | <span class="t">batch, sequence, length, d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1816" target="_blank">00:30:16.300</a></span> | <span class="t">with this multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1817" target="_blank">00:30:17.300</a></span> | <span class="t">we are going to another matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1819" target="_blank">00:30:19.300</a></span> | <span class="t">which is batch, sequence, length, d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1823" target="_blank">00:30:23.300</a></span> | <span class="t">and you can see that from the slides</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1825" target="_blank">00:30:25.300</a></span> | <span class="t">so when we do sequence by d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1828" target="_blank">00:30:28.300</a></span> | <span class="t">multiplied by d, model by d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1830" target="_blank">00:30:30.300</a></span> | <span class="t">we get a new matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1831" target="_blank">00:30:31.300</a></span> | <span class="t">which has the same dimension as the initial matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1833" target="_blank">00:30:33.300</a></span> | <span class="t">so sequence by d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1836" target="_blank">00:30:36.300</a></span> | <span class="t">and it's the same for all three of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1843" target="_blank">00:30:43.300</a></span> | <span class="t">now what we want to do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1845" target="_blank">00:30:45.300</a></span> | <span class="t">we want to divide this query key and value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1848" target="_blank">00:30:48.300</a></span> | <span class="t">into smaller matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1849" target="_blank">00:30:49.300</a></span> | <span class="t">so that we can give each small matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1852" target="_blank">00:30:52.300</a></span> | <span class="t">to a different head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1854" target="_blank">00:30:54.300</a></span> | <span class="t">so let's do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1856" target="_blank">00:30:56.300</a></span> | <span class="t">we will divide into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1858" target="_blank">00:30:58.300</a></span> | <span class="t">using the view method of PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1860" target="_blank">00:31:00.300</a></span> | <span class="t">which means that we keep the batch dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1863" target="_blank">00:31:03.300</a></span> | <span class="t">because we don't want to split the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1866" target="_blank">00:31:06.300</a></span> | <span class="t">we want to split the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1868" target="_blank">00:31:08.300</a></span> | <span class="t">into h parts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1872" target="_blank">00:31:12.300</a></span> | <span class="t">we also want to keep the second dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1874" target="_blank">00:31:14.300</a></span> | <span class="t">which is the sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1875" target="_blank">00:31:15.300</a></span> | <span class="t">because we don't want to split it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1877" target="_blank">00:31:17.300</a></span> | <span class="t">and the third dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1879" target="_blank">00:31:19.300</a></span> | <span class="t">so the d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1880" target="_blank">00:31:20.300</a></span> | <span class="t">we want to split it into two smaller dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1883" target="_blank">00:31:23.300</a></span> | <span class="t">which is h by d, k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1885" target="_blank">00:31:25.300</a></span> | <span class="t">so self.h, self.d,k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1890" target="_blank">00:31:30.300</a></span> | <span class="t">as you remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1891" target="_blank">00:31:31.300</a></span> | <span class="t">d, k is basically d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1893" target="_blank">00:31:33.300</a></span> | <span class="t">divided by h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1894" target="_blank">00:31:34.300</a></span> | <span class="t">so this multiplied by this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1896" target="_blank">00:31:36.300</a></span> | <span class="t">gives you d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1900" target="_blank">00:31:40.300</a></span> | <span class="t">and then we transpose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1905" target="_blank">00:31:45.300</a></span> | <span class="t">one, two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1906" target="_blank">00:31:46.300</a></span> | <span class="t">why do we transpose?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1907" target="_blank">00:31:47.300</a></span> | <span class="t">because we prefer to have the h dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1912" target="_blank">00:31:52.300</a></span> | <span class="t">instead of being the third dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1914" target="_blank">00:31:54.300</a></span> | <span class="t">we want it to be the second dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1916" target="_blank">00:31:56.300</a></span> | <span class="t">and this way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1919" target="_blank">00:31:59.300</a></span> | <span class="t">each view, each head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1920" target="_blank">00:32:00.300</a></span> | <span class="t">will see all the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1922" target="_blank">00:32:02.300</a></span> | <span class="t">so we'll see this dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1923" target="_blank">00:32:03.300</a></span> | <span class="t">so the sequence length by d, k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1927" target="_blank">00:32:07.300</a></span> | <span class="t">let me also write the comment here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1931" target="_blank">00:32:11.300</a></span> | <span class="t">so we are going from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1933" target="_blank">00:32:13.300</a></span> | <span class="t">batch, sequence length, d, model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1936" target="_blank">00:32:16.300</a></span> | <span class="t">to batch, sequence length, h, d, k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1944" target="_blank">00:32:24.300</a></span> | <span class="t">and then by using the transposition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1946" target="_blank">00:32:26.300</a></span> | <span class="t">we are going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1948" target="_blank">00:32:28.300</a></span> | <span class="t">batch, h, sequence length, and d, k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1953" target="_blank">00:32:33.300</a></span> | <span class="t">this is really important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1954" target="_blank">00:32:34.300</a></span> | <span class="t">because we want each batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1959" target="_blank">00:32:39.300</a></span> | <span class="t">we want each head to watch this stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1962" target="_blank">00:32:42.300</a></span> | <span class="t">so the sequence length by d, k</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1964" target="_blank">00:32:44.300</a></span> | <span class="t">which means that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1965" target="_blank">00:32:45.300</a></span> | <span class="t">each head will see the full sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1967" target="_blank">00:32:47.300</a></span> | <span class="t">so each word in the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1969" target="_blank">00:32:49.300</a></span> | <span class="t">but only a smaller part of the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1971" target="_blank">00:32:51.300</a></span> | <span class="t">we do the same thing for the key and the value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=1975" target="_blank">00:32:55.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2001" target="_blank">00:33:21.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2027" target="_blank">00:33:47.300</a></span> | <span class="t">ok, now that we have these smaller matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2030" target="_blank">00:33:50.300</a></span> | <span class="t">so let me go back to the slide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2032" target="_blank">00:33:52.300</a></span> | <span class="t">so I can show you where we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2034" target="_blank">00:33:54.300</a></span> | <span class="t">so we did this multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2036" target="_blank">00:33:56.300</a></span> | <span class="t">we obtained query, key, and values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2038" target="_blank">00:33:58.300</a></span> | <span class="t">we split into smaller matrices</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2040" target="_blank">00:34:00.300</a></span> | <span class="t">now we need to calculate the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2042" target="_blank">00:34:02.300</a></span> | <span class="t">using this formula here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2044" target="_blank">00:34:04.300</a></span> | <span class="t">before we can calculate the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2046" target="_blank">00:34:06.300</a></span> | <span class="t">let's create a function to calculate the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2048" target="_blank">00:34:08.300</a></span> | <span class="t">so if we create a new function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2050" target="_blank">00:34:10.300</a></span> | <span class="t">that can be used also later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2053" target="_blank">00:34:13.300</a></span> | <span class="t">so self, attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2056" target="_blank">00:34:16.300</a></span> | <span class="t">let's define it as a static method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2059" target="_blank">00:34:19.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2064" target="_blank">00:34:24.300</a></span> | <span class="t">so static method means basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2066" target="_blank">00:34:26.300</a></span> | <span class="t">that you can call this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2068" target="_blank">00:34:28.300</a></span> | <span class="t">without having an instance of this class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2070" target="_blank">00:34:30.300</a></span> | <span class="t">you can just say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2071" target="_blank">00:34:31.300</a></span> | <span class="t">multi head attention block dot attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2073" target="_blank">00:34:33.300</a></span> | <span class="t">instead of having an instance of this class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2076" target="_blank">00:34:36.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2081" target="_blank">00:34:41.300</a></span> | <span class="t">we also give him the dropout layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2084" target="_blank">00:34:44.300</a></span> | <span class="t">ok, what we do is we get the decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2089" target="_blank">00:34:49.300</a></span> | <span class="t">what is the decay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2090" target="_blank">00:34:50.300</a></span> | <span class="t">it's the last dimension of the query, key, and the value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2093" target="_blank">00:34:53.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2098" target="_blank">00:34:58.300</a></span> | <span class="t">and we will be using this function here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2100" target="_blank">00:35:00.300</a></span> | <span class="t">let me first call it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2102" target="_blank">00:35:02.300</a></span> | <span class="t">so that you can understand how we will use it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2104" target="_blank">00:35:04.300</a></span> | <span class="t">and then we define it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2106" target="_blank">00:35:06.300</a></span> | <span class="t">so we want from this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2108" target="_blank">00:35:08.300</a></span> | <span class="t">we want two things, the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2110" target="_blank">00:35:10.300</a></span> | <span class="t">and we want the attention scores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2112" target="_blank">00:35:12.300</a></span> | <span class="t">so the output of the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2115" target="_blank">00:35:15.300</a></span> | <span class="t">attention scores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2117" target="_blank">00:35:17.300</a></span> | <span class="t">and we will call it like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2121" target="_blank">00:35:21.300</a></span> | <span class="t">so we give it the query, the key, the value, the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2126" target="_blank">00:35:26.300</a></span> | <span class="t">and the dropout layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2128" target="_blank">00:35:28.300</a></span> | <span class="t">now let's go back here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2131" target="_blank">00:35:31.300</a></span> | <span class="t">so we have the decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2133" target="_blank">00:35:33.300</a></span> | <span class="t">now what we do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2134" target="_blank">00:35:34.300</a></span> | <span class="t">first we apply the first part of the formula</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2136" target="_blank">00:35:36.300</a></span> | <span class="t">that is the query multiplied by the transpose of the key</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2140" target="_blank">00:35:40.300</a></span> | <span class="t">divided by the square root of decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2143" target="_blank">00:35:43.300</a></span> | <span class="t">so these are our attention scores</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2146" target="_blank">00:35:46.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2149" target="_blank">00:35:49.300</a></span> | <span class="t">query matrix multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2152" target="_blank">00:35:52.300</a></span> | <span class="t">so this @ sign means matrix multiplication in PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2155" target="_blank">00:35:55.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2158" target="_blank">00:35:58.300</a></span> | <span class="t">we transpose the last two dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2161" target="_blank">00:36:01.300</a></span> | <span class="t">-1 means transpose the last two dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2164" target="_blank">00:36:04.300</a></span> | <span class="t">so this will become</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2166" target="_blank">00:36:06.300</a></span> | <span class="t">the last dimension is sequence length by decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2169" target="_blank">00:36:09.300</a></span> | <span class="t">it will become decay by sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2172" target="_blank">00:36:12.300</a></span> | <span class="t">and then we divide this by math.decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2178" target="_blank">00:36:18.300</a></span> | <span class="t">before, as we saw before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2181" target="_blank">00:36:21.300</a></span> | <span class="t">before applying the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2183" target="_blank">00:36:23.300</a></span> | <span class="t">we need to apply the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2184" target="_blank">00:36:24.300</a></span> | <span class="t">so we want to hide some interaction between words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2187" target="_blank">00:36:27.300</a></span> | <span class="t">we apply the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2188" target="_blank">00:36:28.300</a></span> | <span class="t">and then we apply the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2190" target="_blank">00:36:30.300</a></span> | <span class="t">so the softmax will take care of the values that we replaced</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2193" target="_blank">00:36:33.300</a></span> | <span class="t">how do we apply the mask?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2195" target="_blank">00:36:35.300</a></span> | <span class="t">we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2196" target="_blank">00:36:36.300</a></span> | <span class="t">all the values that we want to mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2198" target="_blank">00:36:38.300</a></span> | <span class="t">we replace them with very very small values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2200" target="_blank">00:36:40.300</a></span> | <span class="t">so that the softmax will replace them with 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2203" target="_blank">00:36:43.300</a></span> | <span class="t">so if a mask is defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2206" target="_blank">00:36:46.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2208" target="_blank">00:36:48.300</a></span> | <span class="t">apply it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2209" target="_blank">00:36:49.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2222" target="_blank">00:37:02.300</a></span> | <span class="t">this means basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2224" target="_blank">00:37:04.300</a></span> | <span class="t">replace all the values for which this statement is true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2228" target="_blank">00:37:08.300</a></span> | <span class="t">with this value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2230" target="_blank">00:37:10.300</a></span> | <span class="t">the mask we will define in such a way that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2233" target="_blank">00:37:13.300</a></span> | <span class="t">where this value, this expression is true</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2236" target="_blank">00:37:16.300</a></span> | <span class="t">we want it to be replaced by this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2238" target="_blank">00:37:18.300</a></span> | <span class="t">later we will see also how we will build the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2241" target="_blank">00:37:21.300</a></span> | <span class="t">for now just take it for granted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2243" target="_blank">00:37:23.300</a></span> | <span class="t">that these are all the values that we don't want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2246" target="_blank">00:37:26.300</a></span> | <span class="t">to have in the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2248" target="_blank">00:37:28.300</a></span> | <span class="t">so we don't want for example some word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2251" target="_blank">00:37:31.300</a></span> | <span class="t">to watch future words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2253" target="_blank">00:37:33.300</a></span> | <span class="t">for example when we will build a decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2255" target="_blank">00:37:35.300</a></span> | <span class="t">or we don't want the padding values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2257" target="_blank">00:37:37.300</a></span> | <span class="t">to interact with other values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2259" target="_blank">00:37:39.300</a></span> | <span class="t">because they are just filler words to reach the sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2262" target="_blank">00:37:42.300</a></span> | <span class="t">we will replace them with -1 to the power of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2265" target="_blank">00:37:45.300</a></span> | <span class="t">-10 to the power of 9</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2269" target="_blank">00:37:49.300</a></span> | <span class="t">which is a very big number in the negative range</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2273" target="_blank">00:37:53.300</a></span> | <span class="t">which basically represents -infinity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2277" target="_blank">00:37:57.300</a></span> | <span class="t">and then when we apply now the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2280" target="_blank">00:38:00.300</a></span> | <span class="t">it will be replaced by 0</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2282" target="_blank">00:38:02.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2289" target="_blank">00:38:09.300</a></span> | <span class="t">we apply it to this dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2292" target="_blank">00:38:12.300</a></span> | <span class="t">ok, let me write some comments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2294" target="_blank">00:38:14.300</a></span> | <span class="t">so in this case we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2297" target="_blank">00:38:17.300</a></span> | <span class="t">batch by h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2300" target="_blank">00:38:20.300</a></span> | <span class="t">so each head will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2302" target="_blank">00:38:22.300</a></span> | <span class="t">and then sequence length and sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2306" target="_blank">00:38:26.300</a></span> | <span class="t">alright, if we also have a dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2309" target="_blank">00:38:29.300</a></span> | <span class="t">so if dropout is not known</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2312" target="_blank">00:38:32.300</a></span> | <span class="t">we also apply the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2314" target="_blank">00:38:34.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2321" target="_blank">00:38:41.300</a></span> | <span class="t">and finally as we saw in the original slide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2324" target="_blank">00:38:44.300</a></span> | <span class="t">we multiply the output of the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2327" target="_blank">00:38:47.300</a></span> | <span class="t">by the vmatrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2329" target="_blank">00:38:49.300</a></span> | <span class="t">matrix multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2331" target="_blank">00:38:51.300</a></span> | <span class="t">so we return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2333" target="_blank">00:38:53.300</a></span> | <span class="t">attention scores multiplied by value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2336" target="_blank">00:38:56.300</a></span> | <span class="t">and also the attention score itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2338" target="_blank">00:38:58.300</a></span> | <span class="t">so why are we returning a tuple?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2340" target="_blank">00:39:00.300</a></span> | <span class="t">because we want this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2342" target="_blank">00:39:02.300</a></span> | <span class="t">of course we need it for the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2344" target="_blank">00:39:04.300</a></span> | <span class="t">because we need to give it to the next layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2346" target="_blank">00:39:06.300</a></span> | <span class="t">but this will be used for visualization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2349" target="_blank">00:39:09.300</a></span> | <span class="t">so the output of the self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2353" target="_blank">00:39:13.300</a></span> | <span class="t">so the multi-head attention in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2355" target="_blank">00:39:15.300</a></span> | <span class="t">is actually going to be here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2358" target="_blank">00:39:18.300</a></span> | <span class="t">and we will use it for visualizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2360" target="_blank">00:39:20.300</a></span> | <span class="t">so for visualizing what is the score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2362" target="_blank">00:39:22.300</a></span> | <span class="t">given by the model for that particular interaction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2365" target="_blank">00:39:25.300</a></span> | <span class="t">let me also write some comments here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2369" target="_blank">00:39:29.300</a></span> | <span class="t">so here we are doing like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2372" target="_blank">00:39:32.300</a></span> | <span class="t">batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2374" target="_blank">00:39:34.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2386" target="_blank">00:39:46.300</a></span> | <span class="t">and let's go back here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2388" target="_blank">00:39:48.300</a></span> | <span class="t">now we have our multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2390" target="_blank">00:39:50.300</a></span> | <span class="t">so the output of the multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2392" target="_blank">00:39:52.300</a></span> | <span class="t">what we do is finally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2394" target="_blank">00:39:54.300</a></span> | <span class="t">we, ok let's go back to the slide first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2397" target="_blank">00:39:57.300</a></span> | <span class="t">where we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2399" target="_blank">00:39:59.300</a></span> | <span class="t">we calculated these smaller matrices here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2402" target="_blank">00:40:02.300</a></span> | <span class="t">so we applied the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2404" target="_blank">00:40:04.300</a></span> | <span class="t">Q by KT</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2406" target="_blank">00:40:06.300</a></span> | <span class="t">divided by the square root of DV</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2408" target="_blank">00:40:08.300</a></span> | <span class="t">and then we multiplied it also by V</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2410" target="_blank">00:40:10.300</a></span> | <span class="t">we can see it here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2412" target="_blank">00:40:12.300</a></span> | <span class="t">which gives us this small matrix here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2415" target="_blank">00:40:15.300</a></span> | <span class="t">head 1, head 2, head 3 and head 4</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2417" target="_blank">00:40:17.300</a></span> | <span class="t">now we need to combine them together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2419" target="_blank">00:40:19.300</a></span> | <span class="t">concat, just like the formula says from the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2422" target="_blank">00:40:22.300</a></span> | <span class="t">and finally multiply it by WO</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2424" target="_blank">00:40:24.300</a></span> | <span class="t">so let's do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2426" target="_blank">00:40:26.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2433" target="_blank">00:40:33.300</a></span> | <span class="t">we transpose because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2435" target="_blank">00:40:35.300</a></span> | <span class="t">before we transformed the matrix into sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2439" target="_blank">00:40:39.300</a></span> | <span class="t">we had the sequence length as the third dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2441" target="_blank">00:40:41.300</a></span> | <span class="t">we wanted back in the first place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2444" target="_blank">00:40:44.300</a></span> | <span class="t">to combine them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2446" target="_blank">00:40:46.300</a></span> | <span class="t">because the resulting tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2448" target="_blank">00:40:48.300</a></span> | <span class="t">we want the sequence length to be in the second position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2450" target="_blank">00:40:50.300</a></span> | <span class="t">so let me write it first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2452" target="_blank">00:40:52.300</a></span> | <span class="t">what we want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2454" target="_blank">00:40:54.300</a></span> | <span class="t">batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2456" target="_blank">00:40:56.300</a></span> | <span class="t">we started from this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2459" target="_blank">00:40:59.300</a></span> | <span class="t">sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2461" target="_blank">00:41:01.300</a></span> | <span class="t">first we do a transposition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2464" target="_blank">00:41:04.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2469" target="_blank">00:41:09.300</a></span> | <span class="t">and then what we want is this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2472" target="_blank">00:41:12.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2477" target="_blank">00:41:17.300</a></span> | <span class="t">so this transposition takes us here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2480" target="_blank">00:41:20.300</a></span> | <span class="t">and then we do a view</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2484" target="_blank">00:41:24.300</a></span> | <span class="t">but we cannot do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2486" target="_blank">00:41:26.300</a></span> | <span class="t">we need to use contiguous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2488" target="_blank">00:41:28.300</a></span> | <span class="t">this means basically that PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2490" target="_blank">00:41:30.300</a></span> | <span class="t">to transform the shape of a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2493" target="_blank">00:41:33.300</a></span> | <span class="t">needs to put the memory to be contiguous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2496" target="_blank">00:41:36.300</a></span> | <span class="t">so we can just do it in place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2498" target="_blank">00:41:38.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2506" target="_blank">00:41:46.300</a></span> | <span class="t">-1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2508" target="_blank">00:41:48.300</a></span> | <span class="t">and self.h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2510" target="_blank">00:41:50.300</a></span> | <span class="t">multiplied by self.dk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2512" target="_blank">00:41:52.300</a></span> | <span class="t">which as you remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2514" target="_blank">00:41:54.300</a></span> | <span class="t">this is the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2516" target="_blank">00:41:56.300</a></span> | <span class="t">because we defined dk to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2519" target="_blank">00:41:59.300</a></span> | <span class="t">here the model by h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2521" target="_blank">00:42:01.300</a></span> | <span class="t">divide by h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2523" target="_blank">00:42:03.300</a></span> | <span class="t">ok</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2525" target="_blank">00:42:05.300</a></span> | <span class="t">and finally we multiply this x by wo</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2528" target="_blank">00:42:08.300</a></span> | <span class="t">which is our output matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2530" target="_blank">00:42:10.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2533" target="_blank">00:42:13.300</a></span> | <span class="t">of x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2535" target="_blank">00:42:15.300</a></span> | <span class="t">this will give us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2537" target="_blank">00:42:17.300</a></span> | <span class="t">we go from batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2540" target="_blank">00:42:20.300</a></span> | <span class="t">[typing sounds]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2548" target="_blank">00:42:28.300</a></span> | <span class="t">and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2550" target="_blank">00:42:30.300</a></span> | <span class="t">and this is our multi-head attention block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2553" target="_blank">00:42:33.300</a></span> | <span class="t">we have I think all the ingredients now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2555" target="_blank">00:42:35.300</a></span> | <span class="t">to combine them all together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2557" target="_blank">00:42:37.300</a></span> | <span class="t">we just miss one small layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2559" target="_blank">00:42:39.300</a></span> | <span class="t">let's go have a look at it first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2561" target="_blank">00:42:41.300</a></span> | <span class="t">there is one last layer we need to build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2563" target="_blank">00:42:43.300</a></span> | <span class="t">which is the connection we can see here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2565" target="_blank">00:42:45.300</a></span> | <span class="t">for example here we have some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2567" target="_blank">00:42:47.300</a></span> | <span class="t">output of this layer, so addNorm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2569" target="_blank">00:42:49.300</a></span> | <span class="t">that is taken here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2571" target="_blank">00:42:51.300</a></span> | <span class="t">with this connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2573" target="_blank">00:42:53.300</a></span> | <span class="t">and this one part is sent here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2575" target="_blank">00:42:55.300</a></span> | <span class="t">then the output of this is sent to the addNorm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2577" target="_blank">00:42:57.300</a></span> | <span class="t">and then combined together by this layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2579" target="_blank">00:42:59.300</a></span> | <span class="t">so we need to create this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2581" target="_blank">00:43:01.300</a></span> | <span class="t">layer that manages this skip connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2583" target="_blank">00:43:03.300</a></span> | <span class="t">so we take the input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2585" target="_blank">00:43:05.300</a></span> | <span class="t">we give it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2587" target="_blank">00:43:07.300</a></span> | <span class="t">we skip it by one layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2589" target="_blank">00:43:09.300</a></span> | <span class="t">we take the output of the previous layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2591" target="_blank">00:43:11.300</a></span> | <span class="t">so in this case the multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2593" target="_blank">00:43:13.300</a></span> | <span class="t">we give it to this layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2595" target="_blank">00:43:15.300</a></span> | <span class="t">but also combining with this part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2597" target="_blank">00:43:17.300</a></span> | <span class="t">so let's build this layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2599" target="_blank">00:43:19.300</a></span> | <span class="t">I will call it residual connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2602" target="_blank">00:43:22.300</a></span> | <span class="t">because it's basically a skip connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2604" target="_blank">00:43:24.300</a></span> | <span class="t">ok let's build this residual connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2607" target="_blank">00:43:27.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2615" target="_blank">00:43:35.300</a></span> | <span class="t">as usual we define the constructor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2617" target="_blank">00:43:37.300</a></span> | <span class="t">and in this case we just need a dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2620" target="_blank">00:43:40.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2631" target="_blank">00:43:51.300</a></span> | <span class="t">as you remember the skip connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2634" target="_blank">00:43:54.300</a></span> | <span class="t">is between the add and the norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2636" target="_blank">00:43:56.300</a></span> | <span class="t">and the previous layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2638" target="_blank">00:43:58.300</a></span> | <span class="t">so we also need the norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2640" target="_blank">00:44:00.300</a></span> | <span class="t">which is our layer normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2642" target="_blank">00:44:02.300</a></span> | <span class="t">which we defined before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2644" target="_blank">00:44:04.300</a></span> | <span class="t">and then we define the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2646" target="_blank">00:44:06.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2649" target="_blank">00:44:09.300</a></span> | <span class="t">and the sublayer which is the previous layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2652" target="_blank">00:44:12.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2654" target="_blank">00:44:14.300</a></span> | <span class="t">what we do is we take the X</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2656" target="_blank">00:44:16.300</a></span> | <span class="t">and we combine it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2658" target="_blank">00:44:18.300</a></span> | <span class="t">with the output of the next layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2660" target="_blank">00:44:20.300</a></span> | <span class="t">which in this case is called sublayer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2662" target="_blank">00:44:22.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2665" target="_blank">00:44:25.300</a></span> | <span class="t">and we apply the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2667" target="_blank">00:44:27.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2671" target="_blank">00:44:31.300</a></span> | <span class="t">so this is the definition of add and norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2673" target="_blank">00:44:33.300</a></span> | <span class="t">actually there is a slight difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2675" target="_blank">00:44:35.300</a></span> | <span class="t">that we first apply the normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2677" target="_blank">00:44:37.300</a></span> | <span class="t">and then we apply the sublayer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2679" target="_blank">00:44:39.300</a></span> | <span class="t">in the case of the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2681" target="_blank">00:44:41.300</a></span> | <span class="t">they apply first the sublayer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2683" target="_blank">00:44:43.300</a></span> | <span class="t">and then the normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2685" target="_blank">00:44:45.300</a></span> | <span class="t">I saw many implementations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2687" target="_blank">00:44:47.300</a></span> | <span class="t">and most of them actually did it like this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2689" target="_blank">00:44:49.300</a></span> | <span class="t">so we will also stick with this particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2691" target="_blank">00:44:51.300</a></span> | <span class="t">as you remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2693" target="_blank">00:44:53.300</a></span> | <span class="t">we have these blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2695" target="_blank">00:44:55.300</a></span> | <span class="t">are combined together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2697" target="_blank">00:44:57.300</a></span> | <span class="t">by this bigger block here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2699" target="_blank">00:44:59.300</a></span> | <span class="t">and we have N of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2701" target="_blank">00:45:01.300</a></span> | <span class="t">so this big block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2703" target="_blank">00:45:03.300</a></span> | <span class="t">we will call it encoder block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2705" target="_blank">00:45:05.300</a></span> | <span class="t">and each of this encoder block is repeated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2707" target="_blank">00:45:07.300</a></span> | <span class="t">N times where the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2709" target="_blank">00:45:09.300</a></span> | <span class="t">of the previous is sent to the next one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2711" target="_blank">00:45:11.300</a></span> | <span class="t">and the output of the last one is sent to the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2713" target="_blank">00:45:13.300</a></span> | <span class="t">so we need to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2715" target="_blank">00:45:15.300</a></span> | <span class="t">this block which will contain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2717" target="_blank">00:45:17.300</a></span> | <span class="t">one multi head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2719" target="_blank">00:45:19.300</a></span> | <span class="t">two add and norm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2721" target="_blank">00:45:21.300</a></span> | <span class="t">and one feed forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2723" target="_blank">00:45:23.300</a></span> | <span class="t">so let's do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2725" target="_blank">00:45:25.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2727" target="_blank">00:45:27.300</a></span> | <span class="t">we will call this block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2729" target="_blank">00:45:29.300</a></span> | <span class="t">the encoder block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2731" target="_blank">00:45:31.300</a></span> | <span class="t">because the decoder has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2733" target="_blank">00:45:33.300</a></span> | <span class="t">three blocks inside</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2735" target="_blank">00:45:35.300</a></span> | <span class="t">the encoder has only two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2737" target="_blank">00:45:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2739" target="_blank">00:45:39.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2741" target="_blank">00:45:41.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2743" target="_blank">00:45:43.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2745" target="_blank">00:45:45.300</a></span> | <span class="t">and as I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2747" target="_blank">00:45:47.300</a></span> | <span class="t">saw before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2749" target="_blank">00:45:49.300</a></span> | <span class="t">we have the self attention block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2751" target="_blank">00:45:51.300</a></span> | <span class="t">inside which is the multi head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2753" target="_blank">00:45:53.300</a></span> | <span class="t">we call it self attention because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2755" target="_blank">00:45:55.300</a></span> | <span class="t">in the case of the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2757" target="_blank">00:45:57.300</a></span> | <span class="t">it is applied to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2759" target="_blank">00:45:59.300</a></span> | <span class="t">same input with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2761" target="_blank">00:46:01.300</a></span> | <span class="t">three different roles</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2763" target="_blank">00:46:03.300</a></span> | <span class="t">the role of query, of the key and the value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2765" target="_blank">00:46:05.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2767" target="_blank">00:46:07.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2769" target="_blank">00:46:09.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2771" target="_blank">00:46:11.300</a></span> | <span class="t">which is our feed forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2773" target="_blank">00:46:13.300</a></span> | <span class="t">and then we have a dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2775" target="_blank">00:46:15.300</a></span> | <span class="t">which is a floating point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2777" target="_blank">00:46:17.300</a></span> | <span class="t">and then we define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2779" target="_blank">00:46:19.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2781" target="_blank">00:46:21.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2783" target="_blank">00:46:23.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2785" target="_blank">00:46:25.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2787" target="_blank">00:46:27.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2789" target="_blank">00:46:29.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2791" target="_blank">00:46:31.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2793" target="_blank">00:46:33.300</a></span> | <span class="t">and then we define the two residual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2795" target="_blank">00:46:35.300</a></span> | <span class="t">connections</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2797" target="_blank">00:46:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2799" target="_blank">00:46:39.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2801" target="_blank">00:46:41.300</a></span> | <span class="t">we use the module list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2803" target="_blank">00:46:43.300</a></span> | <span class="t">which is a way to organize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2805" target="_blank">00:46:45.300</a></span> | <span class="t">a list of modules</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2807" target="_blank">00:46:47.300</a></span> | <span class="t">in this case we need two of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2809" target="_blank">00:46:49.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2811" target="_blank">00:46:51.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2813" target="_blank">00:46:53.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2815" target="_blank">00:46:55.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2817" target="_blank">00:46:57.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2819" target="_blank">00:46:59.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2821" target="_blank">00:47:01.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2823" target="_blank">00:47:03.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2825" target="_blank">00:47:05.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2827" target="_blank">00:47:07.300</a></span> | <span class="t">okay let's define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2829" target="_blank">00:47:09.300</a></span> | <span class="t">the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2831" target="_blank">00:47:11.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2833" target="_blank">00:47:13.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2835" target="_blank">00:47:15.300</a></span> | <span class="t">I define the source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2837" target="_blank">00:47:17.300</a></span> | <span class="t">mask, what is the source mask?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2839" target="_blank">00:47:19.300</a></span> | <span class="t">it's the mask that we want to apply to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2841" target="_blank">00:47:21.300</a></span> | <span class="t">input of the encoder, and why do we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2843" target="_blank">00:47:23.300</a></span> | <span class="t">need a mask for the input of the encoder?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2845" target="_blank">00:47:25.300</a></span> | <span class="t">because we want to hide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2847" target="_blank">00:47:27.300</a></span> | <span class="t">the interaction of the padding word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2849" target="_blank">00:47:29.300</a></span> | <span class="t">with other words, we don't want the padding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2851" target="_blank">00:47:31.300</a></span> | <span class="t">word to interact with other words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2853" target="_blank">00:47:33.300</a></span> | <span class="t">so we apply the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2855" target="_blank">00:47:35.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2857" target="_blank">00:47:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2859" target="_blank">00:47:39.300</a></span> | <span class="t">and let's do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2861" target="_blank">00:47:41.300</a></span> | <span class="t">first residual connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2863" target="_blank">00:47:43.300</a></span> | <span class="t">let's go back to check the video actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2865" target="_blank">00:47:45.300</a></span> | <span class="t">to check the slide so we can understand what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2867" target="_blank">00:47:47.300</a></span> | <span class="t">are doing now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2869" target="_blank">00:47:49.300</a></span> | <span class="t">so the first skip connection is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2871" target="_blank">00:47:51.300</a></span> | <span class="t">this X here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2873" target="_blank">00:47:53.300</a></span> | <span class="t">is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2875" target="_blank">00:47:55.300</a></span> | <span class="t">here, but before it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2877" target="_blank">00:47:57.300</a></span> | <span class="t">added and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2879" target="_blank">00:47:59.300</a></span> | <span class="t">we add a norm, we first need to apply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2881" target="_blank">00:48:01.300</a></span> | <span class="t">the multi-head attention, so we take this X</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2883" target="_blank">00:48:03.300</a></span> | <span class="t">we send it to the multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2885" target="_blank">00:48:05.300</a></span> | <span class="t">and at the same time we also send it here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2887" target="_blank">00:48:07.300</a></span> | <span class="t">and then we combine the two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2889" target="_blank">00:48:09.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2891" target="_blank">00:48:11.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2893" target="_blank">00:48:13.300</a></span> | <span class="t">so the first skip connection is between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2895" target="_blank">00:48:15.300</a></span> | <span class="t">X and then the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2897" target="_blank">00:48:17.300</a></span> | <span class="t">X is coming from the self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2899" target="_blank">00:48:19.300</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2901" target="_blank">00:48:21.300</a></span> | <span class="t">this is the function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2903" target="_blank">00:48:23.300</a></span> | <span class="t">so I will define the sub-layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2905" target="_blank">00:48:25.300</a></span> | <span class="t">using a lambda, so this basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2907" target="_blank">00:48:27.300</a></span> | <span class="t">means first apply the self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2909" target="_blank">00:48:29.300</a></span> | <span class="t">self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2911" target="_blank">00:48:31.300</a></span> | <span class="t">in which we give the query key</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2913" target="_blank">00:48:33.300</a></span> | <span class="t">and the value is our X</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2915" target="_blank">00:48:35.300</a></span> | <span class="t">so our input, so this is why it's called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2917" target="_blank">00:48:37.300</a></span> | <span class="t">self-attention, because the role of the query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2919" target="_blank">00:48:39.300</a></span> | <span class="t">key and the value is X</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2921" target="_blank">00:48:41.300</a></span> | <span class="t">itself, so the input itself, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2923" target="_blank">00:48:43.300</a></span> | <span class="t">it's the sentence that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2925" target="_blank">00:48:45.300</a></span> | <span class="t">watching itself, so each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2927" target="_blank">00:48:47.300</a></span> | <span class="t">word of one sentence is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2929" target="_blank">00:48:49.300</a></span> | <span class="t">interacting with other words of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2931" target="_blank">00:48:51.300</a></span> | <span class="t">same sentence, we will see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2933" target="_blank">00:48:53.300</a></span> | <span class="t">in the decoder it's different because we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2935" target="_blank">00:48:55.300</a></span> | <span class="t">the cross-attention, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2937" target="_blank">00:48:57.300</a></span> | <span class="t">the keys coming from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2939" target="_blank">00:48:59.300</a></span> | <span class="t">the decoder are watching the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2941" target="_blank">00:49:01.300</a></span> | <span class="t">sorry, the query coming from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2943" target="_blank">00:49:03.300</a></span> | <span class="t">decoder are watching the key and the values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2945" target="_blank">00:49:05.300</a></span> | <span class="t">coming from the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2947" target="_blank">00:49:07.300</a></span> | <span class="t">we give it the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2949" target="_blank">00:49:09.300</a></span> | <span class="t">source mask, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2951" target="_blank">00:49:11.300</a></span> | <span class="t">what is this, basically we are calling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2953" target="_blank">00:49:13.300</a></span> | <span class="t">this function, the forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2955" target="_blank">00:49:15.300</a></span> | <span class="t">function of the multi-head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2957" target="_blank">00:49:17.300</a></span> | <span class="t">attention block, so we give query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2959" target="_blank">00:49:19.300</a></span> | <span class="t">key value and the mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2961" target="_blank">00:49:21.300</a></span> | <span class="t">this will be combined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2963" target="_blank">00:49:23.300</a></span> | <span class="t">with this by using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2965" target="_blank">00:49:25.300</a></span> | <span class="t">the residual connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2967" target="_blank">00:49:27.300</a></span> | <span class="t">then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2969" target="_blank">00:49:29.300</a></span> | <span class="t">again we do the second one, the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2971" target="_blank">00:49:31.300</a></span> | <span class="t">one is the feed forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2973" target="_blank">00:49:33.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2975" target="_blank">00:49:35.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2977" target="_blank">00:49:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2979" target="_blank">00:49:39.300</a></span> | <span class="t">we don't need lambda here actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2981" target="_blank">00:49:41.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2983" target="_blank">00:49:43.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2985" target="_blank">00:49:45.300</a></span> | <span class="t">and then we return X</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2987" target="_blank">00:49:47.300</a></span> | <span class="t">so this means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2989" target="_blank">00:49:49.300</a></span> | <span class="t">combine the feed forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2991" target="_blank">00:49:51.300</a></span> | <span class="t">and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2993" target="_blank">00:49:53.300</a></span> | <span class="t">X itself, so the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2995" target="_blank">00:49:55.300</a></span> | <span class="t">of the previous layer, which is this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2997" target="_blank">00:49:57.300</a></span> | <span class="t">and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=2999" target="_blank">00:49:59.300</a></span> | <span class="t">apply the residual connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3001" target="_blank">00:50:01.300</a></span> | <span class="t">this defines our encoder block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3003" target="_blank">00:50:03.300</a></span> | <span class="t">now we can define the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3005" target="_blank">00:50:05.300</a></span> | <span class="t">encoder object, so because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3007" target="_blank">00:50:07.300</a></span> | <span class="t">encoder is made up of many encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3009" target="_blank">00:50:09.300</a></span> | <span class="t">blocks, we can have up to N of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3011" target="_blank">00:50:11.300</a></span> | <span class="t">according to the paper, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3013" target="_blank">00:50:13.300</a></span> | <span class="t">let's define the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3015" target="_blank">00:50:15.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3017" target="_blank">00:50:17.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3019" target="_blank">00:50:19.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3021" target="_blank">00:50:21.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3023" target="_blank">00:50:23.300</a></span> | <span class="t">how many layers we will have, we will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3025" target="_blank">00:50:25.300</a></span> | <span class="t">have N, so we have many layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3027" target="_blank">00:50:27.300</a></span> | <span class="t">and they are applied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3029" target="_blank">00:50:29.300</a></span> | <span class="t">one after another, so this is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3031" target="_blank">00:50:31.300</a></span> | <span class="t">module list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3033" target="_blank">00:50:33.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3035" target="_blank">00:50:35.300</a></span> | <span class="t">and at the end we will apply a layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3037" target="_blank">00:50:37.300</a></span> | <span class="t">normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3039" target="_blank">00:50:39.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3041" target="_blank">00:50:41.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3043" target="_blank">00:50:43.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3045" target="_blank">00:50:45.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3047" target="_blank">00:50:47.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3049" target="_blank">00:50:49.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3051" target="_blank">00:50:51.300</a></span> | <span class="t">so we apply one layer after another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3053" target="_blank">00:50:53.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3055" target="_blank">00:50:55.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3057" target="_blank">00:50:57.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3059" target="_blank">00:50:59.300</a></span> | <span class="t">the output of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3061" target="_blank">00:51:01.300</a></span> | <span class="t">previous layer becomes the input for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3063" target="_blank">00:51:03.300</a></span> | <span class="t">next layer, here I forgot something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3065" target="_blank">00:51:05.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3067" target="_blank">00:51:07.300</a></span> | <span class="t">and finally we apply the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3069" target="_blank">00:51:09.300</a></span> | <span class="t">normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3071" target="_blank">00:51:11.300</a></span> | <span class="t">and this concludes our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3073" target="_blank">00:51:13.300</a></span> | <span class="t">journey around the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3075" target="_blank">00:51:15.300</a></span> | <span class="t">let's go have a brief overview</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3077" target="_blank">00:51:17.300</a></span> | <span class="t">of what we have done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3079" target="_blank">00:51:19.300</a></span> | <span class="t">we have taken the inputs, send it to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3081" target="_blank">00:51:21.300</a></span> | <span class="t">we didn't, ok, we didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3083" target="_blank">00:51:23.300</a></span> | <span class="t">combine all the blocks together for now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3085" target="_blank">00:51:25.300</a></span> | <span class="t">we just built this big block here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3087" target="_blank">00:51:27.300</a></span> | <span class="t">called encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3089" target="_blank">00:51:29.300</a></span> | <span class="t">which contains two smaller</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3091" target="_blank">00:51:31.300</a></span> | <span class="t">blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3093" target="_blank">00:51:33.300</a></span> | <span class="t">that are the skip connection, the skip connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3095" target="_blank">00:51:35.300</a></span> | <span class="t">first one is between the multihead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3097" target="_blank">00:51:37.300</a></span> | <span class="t">attention and this X that is sent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3099" target="_blank">00:51:39.300</a></span> | <span class="t">here, the second one is between this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3101" target="_blank">00:51:41.300</a></span> | <span class="t">feedforward and this X that is sent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3103" target="_blank">00:51:43.300</a></span> | <span class="t">here, we have N of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3105" target="_blank">00:51:45.300</a></span> | <span class="t">these blocks one after another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3107" target="_blank">00:51:47.300</a></span> | <span class="t">the output of the last will be sent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3109" target="_blank">00:51:49.300</a></span> | <span class="t">to the decoder before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3111" target="_blank">00:51:51.300</a></span> | <span class="t">but before we apply the normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3113" target="_blank">00:51:53.300</a></span> | <span class="t">now we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3115" target="_blank">00:51:55.300</a></span> | <span class="t">built the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3117" target="_blank">00:51:57.300</a></span> | <span class="t">decoder part, now in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3119" target="_blank">00:51:59.300</a></span> | <span class="t">decoder the output embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3121" target="_blank">00:52:01.300</a></span> | <span class="t">are the same as the input embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3123" target="_blank">00:52:03.300</a></span> | <span class="t">I mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3125" target="_blank">00:52:05.300</a></span> | <span class="t">the class that we need to define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3127" target="_blank">00:52:07.300</a></span> | <span class="t">is the same, so we will just initialize it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3129" target="_blank">00:52:09.300</a></span> | <span class="t">twice and the same goes for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3131" target="_blank">00:52:11.300</a></span> | <span class="t">the positional encodings, we can use the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3133" target="_blank">00:52:13.300</a></span> | <span class="t">values that we use for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3135" target="_blank">00:52:15.300</a></span> | <span class="t">encoder, also for the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3137" target="_blank">00:52:17.300</a></span> | <span class="t">what we need to define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3139" target="_blank">00:52:19.300</a></span> | <span class="t">is this big block here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3141" target="_blank">00:52:21.300</a></span> | <span class="t">which is made of masked multihead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3143" target="_blank">00:52:23.300</a></span> | <span class="t">attention, add a norm, so one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3145" target="_blank">00:52:25.300</a></span> | <span class="t">skip connection here, another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3147" target="_blank">00:52:27.300</a></span> | <span class="t">multihead attention with another skip connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3149" target="_blank">00:52:29.300</a></span> | <span class="t">and the feedforward with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3151" target="_blank">00:52:31.300</a></span> | <span class="t">skip connection here, the way we define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3153" target="_blank">00:52:33.300</a></span> | <span class="t">the multihead attention class actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3155" target="_blank">00:52:35.300</a></span> | <span class="t">already takes into consideration</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3157" target="_blank">00:52:37.300</a></span> | <span class="t">the masks, so we don't need to reinvent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3159" target="_blank">00:52:39.300</a></span> | <span class="t">the wheel, also for the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3161" target="_blank">00:52:41.300</a></span> | <span class="t">we can just define the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3163" target="_blank">00:52:43.300</a></span> | <span class="t">decoder block which is this big block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3165" target="_blank">00:52:45.300</a></span> | <span class="t">here made of three sublayers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3167" target="_blank">00:52:47.300</a></span> | <span class="t">and then we build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3169" target="_blank">00:52:49.300</a></span> | <span class="t">the decoder using this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3171" target="_blank">00:52:51.300</a></span> | <span class="t">n number of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3173" target="_blank">00:52:53.300</a></span> | <span class="t">decoder blocks, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3175" target="_blank">00:52:55.300</a></span> | <span class="t">let's do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3177" target="_blank">00:52:57.300</a></span> | <span class="t">let's define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3179" target="_blank">00:52:59.300</a></span> | <span class="t">first the decoder block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3181" target="_blank">00:53:01.300</a></span> | <span class="t">in the decoder we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3193" target="_blank">00:53:13.300</a></span> | <span class="t">the self attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3195" target="_blank">00:53:15.300</a></span> | <span class="t">which is, let's go back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3197" target="_blank">00:53:17.300</a></span> | <span class="t">this is a self attention because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3199" target="_blank">00:53:19.300</a></span> | <span class="t">we have this input that is used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3201" target="_blank">00:53:21.300</a></span> | <span class="t">three times in the masked multihead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3203" target="_blank">00:53:23.300</a></span> | <span class="t">attention, so this is called self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3205" target="_blank">00:53:25.300</a></span> | <span class="t">attention because the same input plays the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3207" target="_blank">00:53:27.300</a></span> | <span class="t">role of the query, the key and the values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3209" target="_blank">00:53:29.300</a></span> | <span class="t">which means that the same sentence is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3211" target="_blank">00:53:31.300</a></span> | <span class="t">each word in the sentence is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3213" target="_blank">00:53:33.300</a></span> | <span class="t">matched with each other word in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3215" target="_blank">00:53:35.300</a></span> | <span class="t">same sentence, but in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3217" target="_blank">00:53:37.300</a></span> | <span class="t">this part here we will have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3219" target="_blank">00:53:39.300</a></span> | <span class="t">an attention calculated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3221" target="_blank">00:53:41.300</a></span> | <span class="t">using the query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3223" target="_blank">00:53:43.300</a></span> | <span class="t">coming from the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3225" target="_blank">00:53:45.300</a></span> | <span class="t">while the key and the values will come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3227" target="_blank">00:53:47.300</a></span> | <span class="t">from the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3229" target="_blank">00:53:49.300</a></span> | <span class="t">so this is not a self</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3231" target="_blank">00:53:51.300</a></span> | <span class="t">attention, this is called cross attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3233" target="_blank">00:53:53.300</a></span> | <span class="t">because we are crossing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3235" target="_blank">00:53:55.300</a></span> | <span class="t">two kind of different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3237" target="_blank">00:53:57.300</a></span> | <span class="t">objects together and matching them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3239" target="_blank">00:53:59.300</a></span> | <span class="t">somehow to calculate the relationship</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3241" target="_blank">00:54:01.300</a></span> | <span class="t">between them, ok let's define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3253" target="_blank">00:54:13.300</a></span> | <span class="t">this is the cross</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3255" target="_blank">00:54:15.300</a></span> | <span class="t">attention block which is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3257" target="_blank">00:54:17.300</a></span> | <span class="t">the multihead attention but we will give it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3259" target="_blank">00:54:19.300</a></span> | <span class="t">the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3261" target="_blank">00:54:21.300</a></span> | <span class="t">parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3263" target="_blank">00:54:23.300</a></span> | <span class="t">this is our feedforward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3267" target="_blank">00:54:27.300</a></span> | <span class="t">and then we have a dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3269" target="_blank">00:54:29.300</a></span> | <span class="t">dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3271" target="_blank">00:54:31.300</a></span> | <span class="t">ok, we defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3295" target="_blank">00:54:55.300</a></span> | <span class="t">also the residual connection, in this case we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3297" target="_blank">00:54:57.300</a></span> | <span class="t">three of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3299" target="_blank">00:54:59.300</a></span> | <span class="t">wonderful, ok let's build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3319" target="_blank">00:55:19.300</a></span> | <span class="t">the forward method which is very similar to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3321" target="_blank">00:55:21.300</a></span> | <span class="t">encoder with a slight difference that I will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3323" target="_blank">00:55:23.300</a></span> | <span class="t">highlight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3325" target="_blank">00:55:25.300</a></span> | <span class="t">we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3327" target="_blank">00:55:27.300</a></span> | <span class="t">x, what is x?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3329" target="_blank">00:55:29.300</a></span> | <span class="t">it's the input of the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3331" target="_blank">00:55:31.300</a></span> | <span class="t">but we also need the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3333" target="_blank">00:55:33.300</a></span> | <span class="t">output of the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3335" target="_blank">00:55:35.300</a></span> | <span class="t">we need the source mask which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3337" target="_blank">00:55:37.300</a></span> | <span class="t">the mask applied to the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3339" target="_blank">00:55:39.300</a></span> | <span class="t">and the target mask which is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3341" target="_blank">00:55:41.300</a></span> | <span class="t">mask applied to the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3343" target="_blank">00:55:43.300</a></span> | <span class="t">why they are called source mask and target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3345" target="_blank">00:55:45.300</a></span> | <span class="t">mask? because in this particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3347" target="_blank">00:55:47.300</a></span> | <span class="t">case we are dealing with a translation task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3349" target="_blank">00:55:49.300</a></span> | <span class="t">so we have a source language, in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3351" target="_blank">00:55:51.300</a></span> | <span class="t">it's english and we have a target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3353" target="_blank">00:55:53.300</a></span> | <span class="t">language which in our case is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3355" target="_blank">00:55:55.300</a></span> | <span class="t">italian, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3357" target="_blank">00:55:57.300</a></span> | <span class="t">you can call it encoder mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3359" target="_blank">00:55:59.300</a></span> | <span class="t">or decoder mask but basically we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3361" target="_blank">00:56:01.300</a></span> | <span class="t">two masks, one is the one coming from the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3363" target="_blank">00:56:03.300</a></span> | <span class="t">one is the one coming from the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3365" target="_blank">00:56:05.300</a></span> | <span class="t">so in our case we will call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3367" target="_blank">00:56:07.300</a></span> | <span class="t">it source, so the source mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3369" target="_blank">00:56:09.300</a></span> | <span class="t">is the one coming from the encoder, so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3371" target="_blank">00:56:11.300</a></span> | <span class="t">source language and the target mask is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3373" target="_blank">00:56:13.300</a></span> | <span class="t">one coming from the decoder, so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3375" target="_blank">00:56:15.300</a></span> | <span class="t">target language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3377" target="_blank">00:56:17.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3383" target="_blank">00:56:23.300</a></span> | <span class="t">and just like before we calculate the self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3385" target="_blank">00:56:25.300</a></span> | <span class="t">first, which is the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3387" target="_blank">00:56:27.300</a></span> | <span class="t">part of the decoder block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3389" target="_blank">00:56:29.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3393" target="_blank">00:56:33.300</a></span> | <span class="t">in which the query, the key and the values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3395" target="_blank">00:56:35.300</a></span> | <span class="t">are the same input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3397" target="_blank">00:56:37.300</a></span> | <span class="t">but with the mask of the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3399" target="_blank">00:56:39.300</a></span> | <span class="t">because this is the self-attention block of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3401" target="_blank">00:56:41.300</a></span> | <span class="t">decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3403" target="_blank">00:56:43.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3405" target="_blank">00:56:45.300</a></span> | <span class="t">and then we need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3407" target="_blank">00:56:47.300</a></span> | <span class="t">combine, we need to calculate the cross-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3409" target="_blank">00:56:49.300</a></span> | <span class="t">which is our second residual connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3411" target="_blank">00:56:51.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3421" target="_blank">00:57:01.300</a></span> | <span class="t">we give him</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3423" target="_blank">00:57:03.300</a></span> | <span class="t">ok, in this case we are giving the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3425" target="_blank">00:57:05.300</a></span> | <span class="t">query coming from the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3427" target="_blank">00:57:07.300</a></span> | <span class="t">so the x, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3429" target="_blank">00:57:09.300</a></span> | <span class="t">key and the values coming from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3431" target="_blank">00:57:11.300</a></span> | <span class="t">encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3433" target="_blank">00:57:13.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3435" target="_blank">00:57:15.300</a></span> | <span class="t">and the mask of the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3437" target="_blank">00:57:17.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3447" target="_blank">00:57:27.300</a></span> | <span class="t">and finally the feedforward block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3449" target="_blank">00:57:29.300</a></span> | <span class="t">just like before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3451" target="_blank">00:57:31.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3453" target="_blank">00:57:33.300</a></span> | <span class="t">and that's it, we have all the ingredients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3455" target="_blank">00:57:35.300</a></span> | <span class="t">actually to build the decoder now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3457" target="_blank">00:57:37.300</a></span> | <span class="t">which is just n times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3459" target="_blank">00:57:39.300</a></span> | <span class="t">this block one after another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3461" target="_blank">00:57:41.300</a></span> | <span class="t">just like we did for the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3463" target="_blank">00:57:43.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3473" target="_blank">00:57:53.300</a></span> | <span class="t">also in this case we will provide with many layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3475" target="_blank">00:57:55.300</a></span> | <span class="t">so layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3477" target="_blank">00:57:57.300</a></span> | <span class="t">this is just a model list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3479" target="_blank">00:57:59.300</a></span> | <span class="t">and we will also have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3481" target="_blank">00:58:01.300</a></span> | <span class="t">normalization at the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3483" target="_blank">00:58:03.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3507" target="_blank">00:58:27.300</a></span> | <span class="t">just like we did before, we apply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3509" target="_blank">00:58:29.300</a></span> | <span class="t">the input to one layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3511" target="_blank">00:58:31.300</a></span> | <span class="t">and then we use the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3513" target="_blank">00:58:33.300</a></span> | <span class="t">of the previous layer and give it as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3515" target="_blank">00:58:35.300</a></span> | <span class="t">an input of the next layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3517" target="_blank">00:58:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3525" target="_blank">00:58:45.300</a></span> | <span class="t">each layer is a decoder block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3527" target="_blank">00:58:47.300</a></span> | <span class="t">so we need to give it x</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3529" target="_blank">00:58:49.300</a></span> | <span class="t">we need to give it the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3531" target="_blank">00:58:51.300</a></span> | <span class="t">output, then the source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3533" target="_blank">00:58:53.300</a></span> | <span class="t">mask and the target mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3535" target="_blank">00:58:55.300</a></span> | <span class="t">so each of them is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3537" target="_blank">00:58:57.300</a></span> | <span class="t">this, we are calling the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3539" target="_blank">00:58:59.300</a></span> | <span class="t">here, so nothing different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3541" target="_blank">00:59:01.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3545" target="_blank">00:59:05.300</a></span> | <span class="t">and finally we apply the normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3547" target="_blank">00:59:07.300</a></span> | <span class="t">and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3549" target="_blank">00:59:09.300</a></span> | <span class="t">our decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3551" target="_blank">00:59:11.300</a></span> | <span class="t">there is one last ingredient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3553" target="_blank">00:59:13.300</a></span> | <span class="t">we need to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3555" target="_blank">00:59:15.300</a></span> | <span class="t">what is a full</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3557" target="_blank">00:59:17.300</a></span> | <span class="t">transformer, so let's have a look at it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3559" target="_blank">00:59:19.300</a></span> | <span class="t">the last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3561" target="_blank">00:59:21.300</a></span> | <span class="t">ingredient we need is this layer here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3563" target="_blank">00:59:23.300</a></span> | <span class="t">the linear layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3565" target="_blank">00:59:25.300</a></span> | <span class="t">as you remember from my slides</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3567" target="_blank">00:59:27.300</a></span> | <span class="t">the output of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3569" target="_blank">00:59:29.300</a></span> | <span class="t">multi-head attention is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3571" target="_blank">00:59:31.300</a></span> | <span class="t">that is sequenced by D-model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3573" target="_blank">00:59:33.300</a></span> | <span class="t">so here, we expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3575" target="_blank">00:59:35.300</a></span> | <span class="t">to have the output to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3577" target="_blank">00:59:37.300</a></span> | <span class="t">sequenced by D-model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3579" target="_blank">00:59:39.300</a></span> | <span class="t">if we don't consider the batch dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3581" target="_blank">00:59:41.300</a></span> | <span class="t">however, we want to map these words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3583" target="_blank">00:59:43.300</a></span> | <span class="t">back into the vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3585" target="_blank">00:59:45.300</a></span> | <span class="t">so that's why we need this linear layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3587" target="_blank">00:59:47.300</a></span> | <span class="t">which will convert the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3589" target="_blank">00:59:49.300</a></span> | <span class="t">into a position of the vocabulary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3591" target="_blank">00:59:51.300</a></span> | <span class="t">I will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3593" target="_blank">00:59:53.300</a></span> | <span class="t">call this layer, call the projection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3595" target="_blank">00:59:55.300</a></span> | <span class="t">layer, because it's projecting the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3597" target="_blank">00:59:57.300</a></span> | <span class="t">embedding into the vocabulary, let's go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3599" target="_blank">00:59:59.300</a></span> | <span class="t">build it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3601" target="_blank">01:00:01.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3609" target="_blank">01:00:09.300</a></span> | <span class="t">what we need for this layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3611" target="_blank">01:00:11.300</a></span> | <span class="t">is the D-model, so the D-model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3613" target="_blank">01:00:13.300</a></span> | <span class="t">which is an integer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3615" target="_blank">01:00:15.300</a></span> | <span class="t">and the vocabulary size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3617" target="_blank">01:00:17.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3619" target="_blank">01:00:19.300</a></span> | <span class="t">this is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3621" target="_blank">01:00:21.300</a></span> | <span class="t">a linear layer that is converting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3623" target="_blank">01:00:23.300</a></span> | <span class="t">from D-model to vocabulary size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3625" target="_blank">01:00:25.300</a></span> | <span class="t">so .projectionlayer is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3627" target="_blank">01:00:27.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3637" target="_blank">01:00:37.300</a></span> | <span class="t">let's define the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3639" target="_blank">01:00:39.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3641" target="_blank">01:00:41.300</a></span> | <span class="t">ok, what we want to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3643" target="_blank">01:00:43.300</a></span> | <span class="t">let me write this little comment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3645" target="_blank">01:00:45.300</a></span> | <span class="t">we want to batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3647" target="_blank">01:00:47.300</a></span> | <span class="t">sequence length to D-model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3649" target="_blank">01:00:49.300</a></span> | <span class="t">converted into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3651" target="_blank">01:00:51.300</a></span> | <span class="t">batch sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3653" target="_blank">01:00:53.300</a></span> | <span class="t">vocabulary size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3655" target="_blank">01:00:55.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3657" target="_blank">01:00:57.300</a></span> | <span class="t">and in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3659" target="_blank">01:00:59.300</a></span> | <span class="t">we will also already apply the softmax</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3661" target="_blank">01:01:01.300</a></span> | <span class="t">and actually we will apply the log</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3663" target="_blank">01:01:03.300</a></span> | <span class="t">softmax for numerical stability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3665" target="_blank">01:01:05.300</a></span> | <span class="t">like I showed before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3667" target="_blank">01:01:07.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3677" target="_blank">01:01:17.300</a></span> | <span class="t">to the last dimension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3679" target="_blank">01:01:19.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3681" target="_blank">01:01:21.300</a></span> | <span class="t">and that's it, this is our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3683" target="_blank">01:01:23.300</a></span> | <span class="t">projection layer, now we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3685" target="_blank">01:01:25.300</a></span> | <span class="t">all the ingredients we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3687" target="_blank">01:01:27.300</a></span> | <span class="t">for the transformer, so let's define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3689" target="_blank">01:01:29.300</a></span> | <span class="t">our transformer block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3691" target="_blank">01:01:31.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3703" target="_blank">01:01:43.300</a></span> | <span class="t">in a transformer we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3705" target="_blank">01:01:45.300</a></span> | <span class="t">an encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3707" target="_blank">01:01:47.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3709" target="_blank">01:01:49.300</a></span> | <span class="t">which is our encoder, we have a decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3711" target="_blank">01:01:51.300</a></span> | <span class="t">which is our decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3713" target="_blank">01:01:53.300</a></span> | <span class="t">we have a source embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3715" target="_blank">01:01:55.300</a></span> | <span class="t">why we need a source embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3717" target="_blank">01:01:57.300</a></span> | <span class="t">and a target embedding, because we are dealing with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3719" target="_blank">01:01:59.300</a></span> | <span class="t">multiple languages, so we have one input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3721" target="_blank">01:02:01.300</a></span> | <span class="t">embedding for the source language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3723" target="_blank">01:02:03.300</a></span> | <span class="t">and one input embedding for the target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3725" target="_blank">01:02:05.300</a></span> | <span class="t">language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3727" target="_blank">01:02:07.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3733" target="_blank">01:02:13.300</a></span> | <span class="t">and we have the target embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3735" target="_blank">01:02:15.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3739" target="_blank">01:02:19.300</a></span> | <span class="t">then we have the source position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3741" target="_blank">01:02:21.300</a></span> | <span class="t">and the target position</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3743" target="_blank">01:02:23.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3750" target="_blank">01:02:30.300</a></span> | <span class="t">which will be the same actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3752" target="_blank">01:02:32.300</a></span> | <span class="t">and then we have the projection layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3754" target="_blank">01:02:34.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3763" target="_blank">01:02:43.300</a></span> | <span class="t">we just save this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3765" target="_blank">01:02:45.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3787" target="_blank">01:03:07.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3797" target="_blank">01:03:17.300</a></span> | <span class="t">now we define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3799" target="_blank">01:03:19.300</a></span> | <span class="t">three methods, one to encode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3801" target="_blank">01:03:21.300</a></span> | <span class="t">one to decode and one to project</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3803" target="_blank">01:03:23.300</a></span> | <span class="t">we will apply them in succession</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3805" target="_blank">01:03:25.300</a></span> | <span class="t">why we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3807" target="_blank">01:03:27.300</a></span> | <span class="t">just build one forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3809" target="_blank">01:03:29.300</a></span> | <span class="t">because as we will see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3811" target="_blank">01:03:31.300</a></span> | <span class="t">during inferencing we can reuse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3813" target="_blank">01:03:33.300</a></span> | <span class="t">the output of the encoder, we don't need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3815" target="_blank">01:03:35.300</a></span> | <span class="t">calculate it every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3817" target="_blank">01:03:37.300</a></span> | <span class="t">and also we prefer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3819" target="_blank">01:03:39.300</a></span> | <span class="t">to keep these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3821" target="_blank">01:03:41.300</a></span> | <span class="t">outputs separate also for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3823" target="_blank">01:03:43.300</a></span> | <span class="t">visualizing the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3825" target="_blank">01:03:45.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3829" target="_blank">01:03:49.300</a></span> | <span class="t">so for the encoder we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3831" target="_blank">01:03:51.300</a></span> | <span class="t">the source of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3833" target="_blank">01:03:53.300</a></span> | <span class="t">because we have the source language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3835" target="_blank">01:03:55.300</a></span> | <span class="t">and the source mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3837" target="_blank">01:03:57.300</a></span> | <span class="t">so what we do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3839" target="_blank">01:03:59.300</a></span> | <span class="t">we apply first the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3841" target="_blank">01:04:01.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3847" target="_blank">01:04:07.300</a></span> | <span class="t">then we apply the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3849" target="_blank">01:04:09.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3853" target="_blank">01:04:13.300</a></span> | <span class="t">and finally we apply the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3855" target="_blank">01:04:15.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3860" target="_blank">01:04:20.300</a></span> | <span class="t">then we define the decode method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3862" target="_blank">01:04:22.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3865" target="_blank">01:04:25.300</a></span> | <span class="t">which takes the encoder output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3867" target="_blank">01:04:27.300</a></span> | <span class="t">which is the tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3869" target="_blank">01:04:29.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3871" target="_blank">01:04:31.300</a></span> | <span class="t">the source mask which is the tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3873" target="_blank">01:04:33.300</a></span> | <span class="t">the target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3875" target="_blank">01:04:35.300</a></span> | <span class="t">and the target mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3877" target="_blank">01:04:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3881" target="_blank">01:04:41.300</a></span> | <span class="t">oops</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3883" target="_blank">01:04:43.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3885" target="_blank">01:04:45.300</a></span> | <span class="t">and what we do is target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3887" target="_blank">01:04:47.300</a></span> | <span class="t">we first apply the target embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3889" target="_blank">01:04:49.300</a></span> | <span class="t">to the target sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3891" target="_blank">01:04:51.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3895" target="_blank">01:04:55.300</a></span> | <span class="t">then we apply the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3897" target="_blank">01:04:57.300</a></span> | <span class="t">to the target sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3899" target="_blank">01:04:59.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3903" target="_blank">01:05:03.300</a></span> | <span class="t">and finally we decode</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3905" target="_blank">01:05:05.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3915" target="_blank">01:05:15.300</a></span> | <span class="t">this is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3917" target="_blank">01:05:17.300</a></span> | <span class="t">the forward method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3919" target="_blank">01:05:19.300</a></span> | <span class="t">of this decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3921" target="_blank">01:05:21.300</a></span> | <span class="t">so we have the same order</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3923" target="_blank">01:05:23.300</a></span> | <span class="t">of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3925" target="_blank">01:05:25.300</a></span> | <span class="t">yes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3927" target="_blank">01:05:27.300</a></span> | <span class="t">finally we define the project method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3929" target="_blank">01:05:29.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3931" target="_blank">01:05:31.300</a></span> | <span class="t">in which we just apply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3933" target="_blank">01:05:33.300</a></span> | <span class="t">the projection so we take from the embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3935" target="_blank">01:05:35.300</a></span> | <span class="t">to the vocabulary size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3937" target="_blank">01:05:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3945" target="_blank">01:05:45.300</a></span> | <span class="t">ok, this is also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3947" target="_blank">01:05:47.300</a></span> | <span class="t">this is the last block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3949" target="_blank">01:05:49.300</a></span> | <span class="t">we had to build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3951" target="_blank">01:05:51.300</a></span> | <span class="t">but we didn't make a method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3953" target="_blank">01:05:53.300</a></span> | <span class="t">to combine all these blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3955" target="_blank">01:05:55.300</a></span> | <span class="t">together, so we built many blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3957" target="_blank">01:05:57.300</a></span> | <span class="t">we need one that given the hyperparameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3959" target="_blank">01:05:59.300</a></span> | <span class="t">of the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3961" target="_blank">01:06:01.300</a></span> | <span class="t">builds for us one single transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3963" target="_blank">01:06:03.300</a></span> | <span class="t">initializing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3965" target="_blank">01:06:05.300</a></span> | <span class="t">all the encoder, decoder, the embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3967" target="_blank">01:06:07.300</a></span> | <span class="t">etc. so let's build this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3969" target="_blank">01:06:09.300</a></span> | <span class="t">function, let's call it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3971" target="_blank">01:06:11.300</a></span> | <span class="t">buildTransformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3973" target="_blank">01:06:13.300</a></span> | <span class="t">that given all the hyperparameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3975" target="_blank">01:06:15.300</a></span> | <span class="t">will build the transformer for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3977" target="_blank">01:06:17.300</a></span> | <span class="t">and also initialize the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3979" target="_blank">01:06:19.300</a></span> | <span class="t">with some initial values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3981" target="_blank">01:06:21.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3983" target="_blank">01:06:23.300</a></span> | <span class="t">what we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3985" target="_blank">01:06:25.300</a></span> | <span class="t">to define a transformer, for sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3987" target="_blank">01:06:27.300</a></span> | <span class="t">in this case we are talking about translation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3989" target="_blank">01:06:29.300</a></span> | <span class="t">ok, this model that we are building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3991" target="_blank">01:06:31.300</a></span> | <span class="t">we will be using for translation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3993" target="_blank">01:06:33.300</a></span> | <span class="t">but you can use it for any task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3995" target="_blank">01:06:35.300</a></span> | <span class="t">so the naming I'm using are basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3997" target="_blank">01:06:37.300</a></span> | <span class="t">the ones used in the translation task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=3999" target="_blank">01:06:39.300</a></span> | <span class="t">later you can change the naming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4001" target="_blank">01:06:41.300</a></span> | <span class="t">but the structure is the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4003" target="_blank">01:06:43.300</a></span> | <span class="t">so you can use it for any other task</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4005" target="_blank">01:06:45.300</a></span> | <span class="t">for which the transformer is applicable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4007" target="_blank">01:06:47.300</a></span> | <span class="t">so the first thing we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4009" target="_blank">01:06:49.300</a></span> | <span class="t">is the vocabulary size of the source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4011" target="_blank">01:06:51.300</a></span> | <span class="t">and the target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4013" target="_blank">01:06:53.300</a></span> | <span class="t">because we need to build the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4015" target="_blank">01:06:55.300</a></span> | <span class="t">embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4017" target="_blank">01:06:57.300</a></span> | <span class="t">because the embedding need to convert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4019" target="_blank">01:06:59.300</a></span> | <span class="t">from the token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4021" target="_blank">01:07:01.300</a></span> | <span class="t">of the vocabulary into a vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4023" target="_blank">01:07:03.300</a></span> | <span class="t">of size 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4025" target="_blank">01:07:05.300</a></span> | <span class="t">so it needs to know how big</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4027" target="_blank">01:07:07.300</a></span> | <span class="t">is the vocabulary, so how many vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4029" target="_blank">01:07:09.300</a></span> | <span class="t">it needs to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4031" target="_blank">01:07:11.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4033" target="_blank">01:07:13.300</a></span> | <span class="t">then the target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4035" target="_blank">01:07:15.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4037" target="_blank">01:07:17.300</a></span> | <span class="t">which is also an integer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4039" target="_blank">01:07:19.300</a></span> | <span class="t">then we need to tell him</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4041" target="_blank">01:07:21.300</a></span> | <span class="t">what is the source sequence length and the target sequence length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4043" target="_blank">01:07:23.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4045" target="_blank">01:07:25.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4047" target="_blank">01:07:27.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4049" target="_blank">01:07:29.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4051" target="_blank">01:07:31.300</a></span> | <span class="t">this is very important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4053" target="_blank">01:07:33.300</a></span> | <span class="t">they could also be the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4055" target="_blank">01:07:35.300</a></span> | <span class="t">in our case it will be the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4057" target="_blank">01:07:37.300</a></span> | <span class="t">but they can also be different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4059" target="_blank">01:07:39.300</a></span> | <span class="t">for example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4061" target="_blank">01:07:41.300</a></span> | <span class="t">in case you are using the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4063" target="_blank">01:07:43.300</a></span> | <span class="t">that is dealing with two very different languages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4065" target="_blank">01:07:45.300</a></span> | <span class="t">for example for translation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4067" target="_blank">01:07:47.300</a></span> | <span class="t">in which the tokens needed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4069" target="_blank">01:07:49.300</a></span> | <span class="t">for the source languages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4071" target="_blank">01:07:51.300</a></span> | <span class="t">are much higher or much lower than the other ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4073" target="_blank">01:07:53.300</a></span> | <span class="t">so you don't need to keep the same length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4075" target="_blank">01:07:55.300</a></span> | <span class="t">you can use different lengths</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4077" target="_blank">01:07:57.300</a></span> | <span class="t">the next hyperparameter is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4079" target="_blank">01:07:59.300</a></span> | <span class="t">dmodel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4081" target="_blank">01:08:01.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4083" target="_blank">01:08:03.300</a></span> | <span class="t">which we initialize with 512</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4085" target="_blank">01:08:05.300</a></span> | <span class="t">because we want to keep the same values as the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4087" target="_blank">01:08:07.300</a></span> | <span class="t">then we define the hyperparameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4089" target="_blank">01:08:09.300</a></span> | <span class="t">n which is the number of layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4091" target="_blank">01:08:11.300</a></span> | <span class="t">so the number of encoder blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4093" target="_blank">01:08:13.300</a></span> | <span class="t">that we will be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4095" target="_blank">01:08:15.300</a></span> | <span class="t">is according to the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4097" target="_blank">01:08:17.300</a></span> | <span class="t">is 6</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4099" target="_blank">01:08:19.300</a></span> | <span class="t">then we define the hyperparameter h</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4101" target="_blank">01:08:21.300</a></span> | <span class="t">which is the number of heads we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4103" target="_blank">01:08:23.300</a></span> | <span class="t">and according to the paper it is 8</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4105" target="_blank">01:08:25.300</a></span> | <span class="t">the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4107" target="_blank">01:08:27.300</a></span> | <span class="t">dropout is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4109" target="_blank">01:08:29.300</a></span> | <span class="t">0.1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4111" target="_blank">01:08:31.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4113" target="_blank">01:08:33.300</a></span> | <span class="t">and finally we have the hidden layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4115" target="_blank">01:08:35.300</a></span> | <span class="t">dff of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4117" target="_blank">01:08:37.300</a></span> | <span class="t">feedforward layer which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4119" target="_blank">01:08:39.300</a></span> | <span class="t">2048 as we saw before on the paper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4121" target="_blank">01:08:41.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4123" target="_blank">01:08:43.300</a></span> | <span class="t">and this builds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4125" target="_blank">01:08:45.300</a></span> | <span class="t">a transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4127" target="_blank">01:08:47.300</a></span> | <span class="t">ok</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4129" target="_blank">01:08:49.300</a></span> | <span class="t">so first we do is we create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4131" target="_blank">01:08:51.300</a></span> | <span class="t">the embedding layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4133" target="_blank">01:08:53.300</a></span> | <span class="t">so source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4135" target="_blank">01:08:55.300</a></span> | <span class="t">embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4137" target="_blank">01:08:57.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4139" target="_blank">01:08:59.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4141" target="_blank">01:09:01.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4143" target="_blank">01:09:03.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4145" target="_blank">01:09:05.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4147" target="_blank">01:09:07.300</a></span> | <span class="t">then the target embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4149" target="_blank">01:09:09.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4151" target="_blank">01:09:11.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4153" target="_blank">01:09:13.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4155" target="_blank">01:09:15.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4157" target="_blank">01:09:17.300</a></span> | <span class="t">then we create the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4159" target="_blank">01:09:19.300</a></span> | <span class="t">layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4161" target="_blank">01:09:21.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4163" target="_blank">01:09:23.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4165" target="_blank">01:09:25.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4167" target="_blank">01:09:27.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4169" target="_blank">01:09:29.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4171" target="_blank">01:09:31.300</a></span> | <span class="t">we don't need to create two positional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4173" target="_blank">01:09:33.300</a></span> | <span class="t">encoding layers because actually they do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4175" target="_blank">01:09:35.300</a></span> | <span class="t">the same job and they also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4177" target="_blank">01:09:37.300</a></span> | <span class="t">don't add any parameter but because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4179" target="_blank">01:09:39.300</a></span> | <span class="t">they have the dropout and also because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4181" target="_blank">01:09:41.300</a></span> | <span class="t">I want to make it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4183" target="_blank">01:09:43.300</a></span> | <span class="t">verbal so you can understand each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4185" target="_blank">01:09:45.300</a></span> | <span class="t">part without making</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4187" target="_blank">01:09:47.300</a></span> | <span class="t">any optimization I think actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4189" target="_blank">01:09:49.300</a></span> | <span class="t">it's fine because this is for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4191" target="_blank">01:09:51.300</a></span> | <span class="t">educational purpose so I don't want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4193" target="_blank">01:09:53.300</a></span> | <span class="t">optimize the code I want to make it as much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4195" target="_blank">01:09:55.300</a></span> | <span class="t">comprehensible as possible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4197" target="_blank">01:09:57.300</a></span> | <span class="t">so I do every part I need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4199" target="_blank">01:09:59.300</a></span> | <span class="t">I don't take shortcuts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4201" target="_blank">01:10:01.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4203" target="_blank">01:10:03.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4205" target="_blank">01:10:05.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4207" target="_blank">01:10:07.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4209" target="_blank">01:10:09.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4211" target="_blank">01:10:11.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4213" target="_blank">01:10:13.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4215" target="_blank">01:10:15.300</a></span> | <span class="t">and then we create the encoder blocks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4217" target="_blank">01:10:17.300</a></span> | <span class="t">we have n of them so let's define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4219" target="_blank">01:10:19.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4221" target="_blank">01:10:21.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4223" target="_blank">01:10:23.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4225" target="_blank">01:10:25.300</a></span> | <span class="t">let's create an empty array</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4227" target="_blank">01:10:27.300</a></span> | <span class="t">so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4229" target="_blank">01:10:29.300</a></span> | <span class="t">we have n of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4231" target="_blank">01:10:31.300</a></span> | <span class="t">so each encoder block has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4233" target="_blank">01:10:33.300</a></span> | <span class="t">a self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4235" target="_blank">01:10:35.300</a></span> | <span class="t">so encoder self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4237" target="_blank">01:10:37.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4239" target="_blank">01:10:39.300</a></span> | <span class="t">which is a multi-head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4241" target="_blank">01:10:41.300</a></span> | <span class="t">attention block, the multi-head attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4243" target="_blank">01:10:43.300</a></span> | <span class="t">requires the demodule</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4245" target="_blank">01:10:45.300</a></span> | <span class="t">the edge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4247" target="_blank">01:10:47.300</a></span> | <span class="t">and the dropout value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4249" target="_blank">01:10:49.300</a></span> | <span class="t">then we have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4251" target="_blank">01:10:51.300</a></span> | <span class="t">feed-forward block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4253" target="_blank">01:10:53.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4255" target="_blank">01:10:55.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4257" target="_blank">01:10:57.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4259" target="_blank">01:10:59.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4261" target="_blank">01:11:01.300</a></span> | <span class="t">as you can see also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4263" target="_blank">01:11:03.300</a></span> | <span class="t">the names I'm using are quite long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4265" target="_blank">01:11:05.300</a></span> | <span class="t">mostly because I want to make it as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4267" target="_blank">01:11:07.300</a></span> | <span class="t">comprehensible as possible for everyone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4269" target="_blank">01:11:09.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4271" target="_blank">01:11:11.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4273" target="_blank">01:11:13.300</a></span> | <span class="t">so each encoder block is made of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4275" target="_blank">01:11:15.300</a></span> | <span class="t">a self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4277" target="_blank">01:11:17.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4279" target="_blank">01:11:19.300</a></span> | <span class="t">and a feed-forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4281" target="_blank">01:11:21.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4283" target="_blank">01:11:23.300</a></span> | <span class="t">and finally we tell him how much is the dropout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4285" target="_blank">01:11:25.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4287" target="_blank">01:11:27.300</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4289" target="_blank">01:11:29.300</a></span> | <span class="t">Finally we add this encoder block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4297" target="_blank">01:11:37.380</a></span> | <span class="t">And then we can create the decoder blocks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4321" target="_blank">01:12:01.860</a></span> | <span class="t">We also have the cross attention for the decoder block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4336" target="_blank">01:12:16.880</a></span> | <span class="t">We also have the feedforward, just like the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4354" target="_blank">01:12:34.280</a></span> | <span class="t">Then we define the decoder block itself, which is decoder block, cross attention and finally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4368" target="_blank">01:12:48.400</a></span> | <span class="t">the feedforward and the dropout.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4375" target="_blank">01:12:55.960</a></span> | <span class="t">And finally we save it in its array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4386" target="_blank">01:13:06.600</a></span> | <span class="t">We now can create the encoder and the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4404" target="_blank">01:13:24.760</a></span> | <span class="t">We give him all his blocks, which are n and then also the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4417" target="_blank">01:13:37.560</a></span> | <span class="t">And we create the projection layer, which will convert the model into vocabulary size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4429" target="_blank">01:13:49.920</a></span> | <span class="t">Which vocabulary?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4430" target="_blank">01:13:50.920</a></span> | <span class="t">Of course the target, because we want to take from the source language to the target language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4435" target="_blank">01:13:55.460</a></span> | <span class="t">So we want to project our output into the target vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4442" target="_blank">01:14:02.800</a></span> | <span class="t">And then we build the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4452" target="_blank">01:14:12.560</a></span> | <span class="t">What does it need?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4453" target="_blank">01:14:13.560</a></span> | <span class="t">An encoder, a decoder, source embedding, target embedding, then source positional encoding,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4469" target="_blank">01:14:29.520</a></span> | <span class="t">target positional encoding, and finally the projection layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4478" target="_blank">01:14:38.640</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4479" target="_blank">01:14:39.640</a></span> | <span class="t">Now we can just initialize the parameters using the Xavier uniform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4485" target="_blank">01:14:45.640</a></span> | <span class="t">This is a way to initialize the parameters to make the training faster so they don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4490" target="_blank">01:14:50.040</a></span> | <span class="t">just start with random values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4494" target="_blank">01:14:54.400</a></span> | <span class="t">And there are many algorithms to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4496" target="_blank">01:14:56.920</a></span> | <span class="t">I saw many implementations using Xavier, so I think it's a quite good start for the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4501" target="_blank">01:15:01.400</a></span> | <span class="t">to learn from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4518" target="_blank">01:15:18.920</a></span> | <span class="t">Finally return our beloved transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4522" target="_blank">01:15:22.800</a></span> | <span class="t">And this is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4523" target="_blank">01:15:23.800</a></span> | <span class="t">This is how you build the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4526" target="_blank">01:15:26.440</a></span> | <span class="t">And now that we have built the model, we will go further to use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4530" target="_blank">01:15:30.040</a></span> | <span class="t">So we will first have a look at the dataset, then we will build the training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4537" target="_blank">01:15:37.800</a></span> | <span class="t">After the training loop, we will also build the inferencing part and the code for visualizing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4544" target="_blank">01:15:44.480</a></span> | <span class="t">the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4546" target="_blank">01:15:46.240</a></span> | <span class="t">So hold on and take some coffee, take some tea, because it's going to be a little long,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4553" target="_blank">01:15:53.080</a></span> | <span class="t">but it's going to be worth it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4554" target="_blank">01:15:54.960</a></span> | <span class="t">Now that we have built the code for the model, our next step is to build the training code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4561" target="_blank">01:16:01.060</a></span> | <span class="t">But before we do that, let's recheck the code, because we may have some typos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4567" target="_blank">01:16:07.400</a></span> | <span class="t">I actually already made this check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4569" target="_blank">01:16:09.640</a></span> | <span class="t">And there are a few mistakes in the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4573" target="_blank">01:16:13.120</a></span> | <span class="t">I compared the old with the new one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4576" target="_blank">01:16:16.000</a></span> | <span class="t">It is very minor problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4578" target="_blank">01:16:18.280</a></span> | <span class="t">So we wrote "feedForward" instead of "feedForward" here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4583" target="_blank">01:16:23.920</a></span> | <span class="t">And so the same problem is also present in every reference to "feedForward".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4589" target="_blank">01:16:29.520</a></span> | <span class="t">And also here, when we are building the decoder block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4594" target="_blank">01:16:34.360</a></span> | <span class="t">And the other problem is that here, when we build the decoder block, we just wrote "nn.module".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4599" target="_blank">01:16:39.040</a></span> | <span class="t">Instead, it should be "nn.moduleList".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4602" target="_blank">01:16:42.680</a></span> | <span class="t">And then the "feedForward" should be also fixed here and here in the buildTransformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4607" target="_blank">01:16:47.400</a></span> | <span class="t">method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4609" target="_blank">01:16:49.000</a></span> | <span class="t">Now, I can delete the old one, so we don't need it anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4614" target="_blank">01:16:54.200</a></span> | <span class="t">Let me check the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4615" target="_blank">01:16:55.200</a></span> | <span class="t">It's the correct one, with "feedForward".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4619" target="_blank">01:16:59.440</a></span> | <span class="t">Yes, okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4622" target="_blank">01:17:02.480</a></span> | <span class="t">Our next step is to build the training code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4624" target="_blank">01:17:04.840</a></span> | <span class="t">But before we build the training code, we have to look at the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4628" target="_blank">01:17:08.240</a></span> | <span class="t">What kind of data are we going to work with?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4630" target="_blank">01:17:10.780</a></span> | <span class="t">So as I said before, we are dealing with a translation task.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4634" target="_blank">01:17:14.120</a></span> | <span class="t">And I have chosen this dataset called "opus_books", which we can find on HuggingFace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4639" target="_blank">01:17:19.620</a></span> | <span class="t">And we will also use the library from HuggingFace to download this dataset for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4644" target="_blank">01:17:24.280</a></span> | <span class="t">And this is the only library we will be using beside PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4648" target="_blank">01:17:28.200</a></span> | <span class="t">Because of course we cannot reinvent the dataset by ourselves, so we will use this dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4653" target="_blank">01:17:33.880</a></span> | <span class="t">And we will also use the HuggingFace tokenizer library to transform this text into vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4662" target="_blank">01:17:42.200</a></span> | <span class="t">Because our goal is to build the transformer, so not to reinvent the wheel about everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4668" target="_blank">01:17:48.040</a></span> | <span class="t">So we will be only focusing on building and training the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4672" target="_blank">01:17:52.800</a></span> | <span class="t">And in my particular case, I will be using the subset "English to Italian", but we will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4677" target="_blank">01:17:57.440</a></span> | <span class="t">build the code in such a way that you can choose the language and the code will act</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4682" target="_blank">01:18:02.680</a></span> | <span class="t">accordingly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4683" target="_blank">01:18:03.680</a></span> | <span class="t">If we look at the data, we can see that each data item is a pair of sentences in English</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4691" target="_blank">01:18:11.140</a></span> | <span class="t">and in Italian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4692" target="_blank">01:18:12.480</a></span> | <span class="t">For example, there was no possibility of taking a walk that day, which in Italian means "In</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4697" target="_blank">01:18:17.040</a></span> | <span class="t">quel giorno era impossibile passeggiare".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4700" target="_blank">01:18:20.000</a></span> | <span class="t">So we will train our transformer to translate from the source language, which is English,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4706" target="_blank">01:18:26.640</a></span> | <span class="t">into the target language, which is Italian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4709" target="_blank">01:18:29.040</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4710" target="_blank">01:18:30.480</a></span> | <span class="t">We will do it step by step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4712" target="_blank">01:18:32.240</a></span> | <span class="t">So first we will make the code to download this dataset and to create the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4717" target="_blank">01:18:37.940</a></span> | <span class="t">So what is a tokenizer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4720" target="_blank">01:18:40.080</a></span> | <span class="t">Let's go back to the slides to just have a brief overview of what we are going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4724" target="_blank">01:18:44.440</a></span> | <span class="t">with this data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4725" target="_blank">01:18:45.440</a></span> | <span class="t">The tokenizer is what comes before the input embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4729" target="_blank">01:18:49.300</a></span> | <span class="t">So we have an English sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4731" target="_blank">01:18:51.440</a></span> | <span class="t">So for example, "Your cat is a lovely cat", but this sentence will come from our dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4736" target="_blank">01:18:56.280</a></span> | <span class="t">The goal of the tokenizer is to create this token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4739" target="_blank">01:18:59.680</a></span> | <span class="t">So split this sentence into single words, which has many strategies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4744" target="_blank">01:19:04.480</a></span> | <span class="t">As you can see here, we have a sentence, which is "Your cat is a lovely cat".</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4749" target="_blank">01:19:09.180</a></span> | <span class="t">And the goal of the tokenizer is to split this sentence into single words, which can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4754" target="_blank">01:19:14.500</a></span> | <span class="t">be done in many ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4756" target="_blank">01:19:16.320</a></span> | <span class="t">There is the BPE tokenizer, there is the word-level tokenizer, there is the sub-word-level, word-part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4762" target="_blank">01:19:22.220</a></span> | <span class="t">tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4763" target="_blank">01:19:23.220</a></span> | <span class="t">There are many tokenizers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4764" target="_blank">01:19:24.220</a></span> | <span class="t">The one we will be using is the simplest one called the word-level tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4767" target="_blank">01:19:27.980</a></span> | <span class="t">So the word-level tokenizer basically will split this sentence, let's say by space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4772" target="_blank">01:19:32.420</a></span> | <span class="t">So each space defines the boundary of a word, and so into the single words, and each word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4779" target="_blank">01:19:39.380</a></span> | <span class="t">will be mapped to one number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4781" target="_blank">01:19:41.420</a></span> | <span class="t">So this is the job of the tokenizer, to build the vocabulary of these numbers and to map</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4787" target="_blank">01:19:47.540</a></span> | <span class="t">each word into a number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4791" target="_blank">01:19:51.100</a></span> | <span class="t">When we build the tokenizer, we can also create special tokens, which we will use for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4795" target="_blank">01:19:55.620</a></span> | <span class="t">transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4796" target="_blank">01:19:56.620</a></span> | <span class="t">For example, the tokens called padding, the token called the start-of-sentence, end-of-sentence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4802" target="_blank">01:20:02.540</a></span> | <span class="t">which are necessary for training the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4805" target="_blank">01:20:05.580</a></span> | <span class="t">But we will do it step-by-step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4807" target="_blank">01:20:07.540</a></span> | <span class="t">So let's build first the code for building the tokenizer and to download the dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4813" target="_blank">01:20:13.980</a></span> | <span class="t">Let's create a new file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4815" target="_blank">01:20:15.100</a></span> | <span class="t">Let's call it train.py.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4818" target="_blank">01:20:18.180</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4819" target="_blank">01:20:19.180</a></span> | <span class="t">Let's import our usual library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4822" target="_blank">01:20:22.220</a></span> | <span class="t">So torch, we will also import torch.nm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4827" target="_blank">01:20:27.380</a></span> | <span class="t">And we also, because we are using a library from HuggingFace, we also need to import these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4833" target="_blank">01:20:33.780</a></span> | <span class="t">two libraries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4834" target="_blank">01:20:34.940</a></span> | <span class="t">We will be using the datasets library, which you can install using pip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4841" target="_blank">01:20:41.300</a></span> | <span class="t">So datasets, we will be using load dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4850" target="_blank">01:20:50.060</a></span> | <span class="t">And we will also be using the tokenizers library also from HuggingFace, which you can install</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4856" target="_blank">01:20:56.140</a></span> | <span class="t">with pip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4862" target="_blank">01:21:02.600</a></span> | <span class="t">We also need the, which tokenizer we need, so we will use the word-level tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4879" target="_blank">01:21:19.800</a></span> | <span class="t">And there is also the trainers, so the tokenizer, the class that will train the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4887" target="_blank">01:21:27.520</a></span> | <span class="t">So that will create the vocabulary given the list of sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4900" target="_blank">01:21:40.800</a></span> | <span class="t">And we will split the word according to the white space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4904" target="_blank">01:21:44.800</a></span> | <span class="t">I will build one method by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4907" target="_blank">01:21:47.460</a></span> | <span class="t">So I will build first the methods to create the tokenizer, and I will describe each parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4915" target="_blank">01:21:55.240</a></span> | <span class="t">For now, you will not have the bigger picture, but later when we combine all these methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4919" target="_blank">01:21:59.380</a></span> | <span class="t">together, you will have the bigger picture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4921" target="_blank">01:22:01.840</a></span> | <span class="t">So let's first make the method that builds the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4925" target="_blank">01:22:05.500</a></span> | <span class="t">So we will call it getOrBuildTokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4933" target="_blank">01:22:13.380</a></span> | <span class="t">And this method takes the configuration, which is the configuration of our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4937" target="_blank">01:22:17.000</a></span> | <span class="t">We will define it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4938" target="_blank">01:22:18.760</a></span> | <span class="t">The dataset and the language for which we are going to build the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4945" target="_blank">01:22:25.920</a></span> | <span class="t">We define the tokenizer path, so the file where we will be save this tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4952" target="_blank">01:22:32.200</a></span> | <span class="t">And we do it path of config.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4961" target="_blank">01:22:41.400</a></span> | <span class="t">Okay, let me define some things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4966" target="_blank">01:22:46.800</a></span> | <span class="t">First of all, this path is coming from the pathlib, so from pathlib.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4973" target="_blank">01:22:53.580</a></span> | <span class="t">This is a library that allows you to create absolute path given relative paths.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4978" target="_blank">01:22:58.420</a></span> | <span class="t">And we pretend that we have a configuration called the tokenizer file, which is the path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4983" target="_blank">01:23:03.420</a></span> | <span class="t">to the tokenizer file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4985" target="_blank">01:23:05.360</a></span> | <span class="t">And this path is formattable using the language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=4988" target="_blank">01:23:08.280</a></span> | <span class="t">So for example, we can have something like this, for example, something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5003" target="_blank">01:23:23.360</a></span> | <span class="t">And this will be, given the language, it will create a tokenizer English or tokenizer Italian,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5011" target="_blank">01:23:31.140</a></span> | <span class="t">for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5012" target="_blank">01:23:32.140</a></span> | <span class="t">So if the tokenizer doesn't exist, we create it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5025" target="_blank">01:23:45.200</a></span> | <span class="t">I took all this code actually from HuggingFace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5028" target="_blank">01:23:48.220</a></span> | <span class="t">It's nothing complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5029" target="_blank">01:23:49.580</a></span> | <span class="t">I just taken their quick tour of their tokenizers library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5034" target="_blank">01:23:54.500</a></span> | <span class="t">And it's really easy to use it, and saves you a lot of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5038" target="_blank">01:23:58.680</a></span> | <span class="t">Because tokenizer, to build a tokenizer is really reinventing the wheel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5051" target="_blank">01:24:11.060</a></span> | <span class="t">And we will also introduce the unknown word, unknown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5055" target="_blank">01:24:15.460</a></span> | <span class="t">So what does it mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5056" target="_blank">01:24:16.800</a></span> | <span class="t">If our tokenizer sees a word that it doesn't recognize in its vocabulary, it will replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5061" target="_blank">01:24:21.560</a></span> | <span class="t">it with this word, unknown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5064" target="_blank">01:24:24.120</a></span> | <span class="t">It will map it to the number corresponding to this word, unknown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5071" target="_blank">01:24:31.580</a></span> | <span class="t">The pre-tokenizer means basically that we split by whitespace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5076" target="_blank">01:24:36.320</a></span> | <span class="t">And then we train, we build the trainer to train our tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5095" target="_blank">01:24:55.360</a></span> | <span class="t">Okay, this is the trainer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5120" target="_blank">01:25:20.860</a></span> | <span class="t">What does it mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5121" target="_blank">01:25:21.860</a></span> | <span class="t">It means it will be a word-level trainer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5124" target="_blank">01:25:24.340</a></span> | <span class="t">So it will split words using the whitespace and using the single words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5128" target="_blank">01:25:28.980</a></span> | <span class="t">And it will also have four special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5131" target="_blank">01:25:31.340</a></span> | <span class="t">One is unknown, which means that if you cannot find that particular word in the vocabulary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5137" target="_blank">01:25:37.860</a></span> | <span class="t">just replace it with unknown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5139" target="_blank">01:25:39.700</a></span> | <span class="t">It will also have the padding, which we will use to train the transformer, the start of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5145" target="_blank">01:25:45.180</a></span> | <span class="t">sentence and the end of sentence special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5147" target="_blank">01:25:47.820</a></span> | <span class="t">In frequency means that a word, for a word to appear in our vocabulary, it has to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5152" target="_blank">01:25:52.980</a></span> | <span class="t">a frequency of at least two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5156" target="_blank">01:25:56.380</a></span> | <span class="t">Now we can train the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5164" target="_blank">01:26:04.020</a></span> | <span class="t">We use this method, which means we build first a method that gives all the sentences from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5170" target="_blank">01:26:10.680</a></span> | <span class="t">our data set and we will build it later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5198" target="_blank">01:26:38.220</a></span> | <span class="t">Okay, so let's build also this method called getAllSentence so that we can iterate through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5219" target="_blank">01:26:59.140</a></span> | <span class="t">the data set to get all the sentences corresponding to the particular language for which we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5224" target="_blank">01:27:04.640</a></span> | <span class="t">creating the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5237" target="_blank">01:27:17.200</a></span> | <span class="t">As you remember, each item in the data set, it's a pair of sentences, one in English,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5241" target="_blank">01:27:21.680</a></span> | <span class="t">one in Italian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5242" target="_blank">01:27:22.680</a></span> | <span class="t">We just want to extract one particular language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5252" target="_blank">01:27:32.000</a></span> | <span class="t">This is the item representing the pair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5255" target="_blank">01:27:35.400</a></span> | <span class="t">And from this pair, we extract only the one language that we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5260" target="_blank">01:27:40.600</a></span> | <span class="t">And this is the code to build the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5263" target="_blank">01:27:43.520</a></span> | <span class="t">Now let's write the code to load the data set and then to build the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5269" target="_blank">01:27:49.360</a></span> | <span class="t">We will call this method getDataset and which also takes the configuration of the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5275" target="_blank">01:27:55.880</a></span> | <span class="t">which we will define later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5279" target="_blank">01:27:59.340</a></span> | <span class="t">So let's load the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5280" target="_blank">01:28:00.800</a></span> | <span class="t">We will call it dsRow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5284" target="_blank">01:28:04.800</a></span> | <span class="t">Okay, HuggingFace allows us to download its data sets very easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5292" target="_blank">01:28:12.680</a></span> | <span class="t">We just need to tell him what is the name of the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5297" target="_blank">01:28:17.920</a></span> | <span class="t">And then tell him what is the subset we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5300" target="_blank">01:28:20.920</a></span> | <span class="t">We want the subset that is English to Italian, but we want to also make it configurable for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5305" target="_blank">01:28:25.200</a></span> | <span class="t">you guys to change the language very fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5307" target="_blank">01:28:27.160</a></span> | <span class="t">So let's build this subset dynamically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5321" target="_blank">01:28:41.040</a></span> | <span class="t">We will have two parameters in the configuration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5324" target="_blank">01:28:44.140</a></span> | <span class="t">One is called languageSource and one is called languageTarget.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5337" target="_blank">01:28:57.040</a></span> | <span class="t">Later we can also define what split we want of this data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5340" target="_blank">01:29:00.960</a></span> | <span class="t">In our case, there is only the training split in the original data set from HuggingFace,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5347" target="_blank">01:29:07.640</a></span> | <span class="t">but we will split by ourself into the validation and the training data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5353" target="_blank">01:29:13.480</a></span> | <span class="t">So let's build the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5367" target="_blank">01:29:27.080</a></span> | <span class="t">This is the raw data set and we also have the target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5386" target="_blank">01:29:46.240</a></span> | <span class="t">Okay, now, because we only have the training split from HuggingFace, we can split it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5392" target="_blank">01:29:52.760</a></span> | <span class="t">by ourself into a training and the validation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5395" target="_blank">01:29:55.520</a></span> | <span class="t">We keep 90% of the data for training and 10% for validation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5417" target="_blank">01:30:17.840</a></span> | <span class="t">Okay, let's build the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5445" target="_blank">01:30:45.880</a></span> | <span class="t">The method randomSplit allows, it's a method from PyTorch that allows to split a data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5459" target="_blank">01:30:59.280</a></span> | <span class="t">using the size that we give as input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5462" target="_blank">01:31:02.520</a></span> | <span class="t">So in this case, it means split this data set into this two smaller data set, one of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5468" target="_blank">01:31:08.240</a></span> | <span class="t">this size and one of this size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5470" target="_blank">01:31:10.320</a></span> | <span class="t">But let's import the method from Torch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5483" target="_blank">01:31:23.280</a></span> | <span class="t">Let's also import the one that we will need later, TotalOrder and randomSplit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5496" target="_blank">01:31:36.660</a></span> | <span class="t">Now we need to create the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5499" target="_blank">01:31:39.100</a></span> | <span class="t">The data set that our model will use to access the tensors directly, because now we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5504" target="_blank">01:31:44.560</a></span> | <span class="t">created the tokenizer and we just loaded the data, but we need to create the tensors that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5510" target="_blank">01:31:50.880</a></span> | <span class="t">our model will use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5512" target="_blank">01:31:52.400</a></span> | <span class="t">So let's create the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5514" target="_blank">01:31:54.080</a></span> | <span class="t">Let's call it bilingual data set and for that we create a new file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5527" target="_blank">01:32:07.360</a></span> | <span class="t">So here we import Torch and that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5551" target="_blank">01:32:31.440</a></span> | <span class="t">We will call the data set, we will call it bilingual data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5561" target="_blank">01:32:41.620</a></span> | <span class="t">Okay as usual we define the constructor and in this constructor we need to give him the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5569" target="_blank">01:32:49.920</a></span> | <span class="t">data set downloaded from HuggingFace, the tokenizer of the source language, the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5575" target="_blank">01:32:55.880</a></span> | <span class="t">of the target language, the source language, the name of the source language, the name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5580" target="_blank">01:33:00.920</a></span> | <span class="t">of the target language and the sequence length that we will use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5594" target="_blank">01:33:14.360</a></span> | <span class="t">Okay we save all these values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5617" target="_blank">01:33:37.320</a></span> | <span class="t">We can also save the tokens, the particular tokens that we will use to create the tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5625" target="_blank">01:33:45.520</a></span> | <span class="t">for the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5626" target="_blank">01:33:46.840</a></span> | <span class="t">So we need the start of sentence, end of sentence and the padding token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5630" target="_blank">01:33:50.640</a></span> | <span class="t">So how do we convert the token start of sentence into a number, into the input ID?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5637" target="_blank">01:33:57.840</a></span> | <span class="t">There is a special method of the tokenizer to do that, so let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5642" target="_blank">01:34:02.920</a></span> | <span class="t">So this is the start of sentence token, we want to build it into a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5650" target="_blank">01:34:10.680</a></span> | <span class="t">This tensor will contain only one number which is given by, we can use this tokenizer from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5657" target="_blank">01:34:17.480</a></span> | <span class="t">the source or the target, it doesn't matter because they both contain these particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5660" target="_blank">01:34:20.960</a></span> | <span class="t">tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5664" target="_blank">01:34:24.640</a></span> | <span class="t">This is the method to convert the token into a number, so start of sentence and the type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5673" target="_blank">01:34:33.540</a></span> | <span class="t">of this token, of this tensor is, we want it long because the vocabulary can be more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5686" target="_blank">01:34:46.600</a></span> | <span class="t">than 32-bit long, the vocabulary size, so we usually use the long 64-bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5695" target="_blank">01:34:55.160</a></span> | <span class="t">And we do the same for the end of sentence and the padding token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5723" target="_blank">01:35:23.100</a></span> | <span class="t">We also need to define the length method of this dataset, which tells the length of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5733" target="_blank">01:35:33.260</a></span> | <span class="t">dataset itself, so basically just the length of the dataset from hugging face, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5740" target="_blank">01:35:40.180</a></span> | <span class="t">we need to define the get item method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5755" target="_blank">01:35:55.540</a></span> | <span class="t">First of all we will extract the original pair from the hugging face dataset, then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5769" target="_blank">01:36:09.580</a></span> | <span class="t">extract the source text and the target text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5798" target="_blank">01:36:38.500</a></span> | <span class="t">And finally we convert each text into tokens, and then into input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5807" target="_blank">01:36:47.220</a></span> | <span class="t">What does it mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5808" target="_blank">01:36:48.220</a></span> | <span class="t">We will first, the tokenizer will first split the sentence into single words, and then will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5814" target="_blank">01:36:54.020</a></span> | <span class="t">map each word into its corresponding number in the vocabulary, and it will do it in one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5818" target="_blank">01:36:58.700</a></span> | <span class="t">pass only, this is done by the encode method.ids, this gives us the input IDs, so the numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5838" target="_blank">01:37:18.600</a></span> | <span class="t">corresponding to each word in the original sentence, and it will be given as an array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5854" target="_blank">01:37:34.220</a></span> | <span class="t">We did the same for the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5856" target="_blank">01:37:36.260</a></span> | <span class="t">Now as you remember, we also need to pad the sentence to reach the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5863" target="_blank">01:37:43.420</a></span> | <span class="t">This is really important because we want our model to always work, I mean the model always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5869" target="_blank">01:37:49.220</a></span> | <span class="t">works with a fixed length, sequence length, but we don't have enough words in every sentence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5874" target="_blank">01:37:54.960</a></span> | <span class="t">so we use the padding token, so this PAD here, as the padding token to fill the sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5881" target="_blank">01:38:01.540</a></span> | <span class="t">until it reaches the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5884" target="_blank">01:38:04.020</a></span> | <span class="t">So we calculate how many padding tokens we need to add for the encoder side and for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5887" target="_blank">01:38:07.940</a></span> | <span class="t">decoder side, which is basically how many we need to reach the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5902" target="_blank">01:38:22.080</a></span> | <span class="t">Minus two, why minus two here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5904" target="_blank">01:38:24.260</a></span> | <span class="t">So we already have this amount of tokens, we need to reach this one, but we will add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5908" target="_blank">01:38:28.780</a></span> | <span class="t">also the start of sentence token and the end of sentence token to the encoder side, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5915" target="_blank">01:38:35.200</a></span> | <span class="t">we also have minus two here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5929" target="_blank">01:38:49.380</a></span> | <span class="t">And here only minus one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5930" target="_blank">01:38:50.900</a></span> | <span class="t">If you remember my previous video, when we do the training, we add only the start of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5937" target="_blank">01:38:57.420</a></span> | <span class="t">sentence token to the decoder side, and then in the label we only add the end of sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5943" target="_blank">01:39:03.660</a></span> | <span class="t">token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5944" target="_blank">01:39:04.660</a></span> | <span class="t">So in this case we only need to add one token, special token to the sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5949" target="_blank">01:39:09.160</a></span> | <span class="t">We also make sure that this sequence length that we have chosen is enough to represent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5955" target="_blank">01:39:15.500</a></span> | <span class="t">all the sentences in our dataset, and if we chose too small one, we want to raise an exception.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5965" target="_blank">01:39:25.500</a></span> | <span class="t">So basically this number of padding tokens should never become negative.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=5982" target="_blank">01:39:42.340</a></span> | <span class="t">Okay, now let's build the two tensors for the encoder input and for the decoder input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6001" target="_blank">01:40:01.200</a></span> | <span class="t">but also for the label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6002" target="_blank">01:40:02.820</a></span> | <span class="t">So one sentence will be sent to the input of the encoder, one sentence will be sent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6008" target="_blank">01:40:08.000</a></span> | <span class="t">to the input of the decoder, and one sentence is the one that we expect as the output of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6014" target="_blank">01:40:14.900</a></span> | <span class="t">the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6016" target="_blank">01:40:16.220</a></span> | <span class="t">And that output we will call label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6019" target="_blank">01:40:19.380</a></span> | <span class="t">Usually it's called target or label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6021" target="_blank">01:40:21.200</a></span> | <span class="t">I call it label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6028" target="_blank">01:40:28.360</a></span> | <span class="t">We can cut the tensor of the start, okay, we can cut three tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6035" target="_blank">01:40:35.460</a></span> | <span class="t">First is the start of sentence token, then the tokens of the source text, then the end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6056" target="_blank">01:40:56.660</a></span> | <span class="t">of sentence token, and then enough padding tokens to reach the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6065" target="_blank">01:41:05.260</a></span> | <span class="t">We already calculated how many impeding tokens we need to add to this sentence, so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6069" target="_blank">01:41:09.480</a></span> | <span class="t">just do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6096" target="_blank">01:41:36.160</a></span> | <span class="t">And this is the encoder input, so let me write some comment here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6100" target="_blank">01:41:40.240</a></span> | <span class="t">This is add SOS and AOS to the source text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6110" target="_blank">01:41:50.780</a></span> | <span class="t">Then we build the decoder input, which is also a concatenation of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6121" target="_blank">01:42:01.680</a></span> | <span class="t">In this case we don't have the start of sentence, we just have the start of sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6146" target="_blank">01:42:26.640</a></span> | <span class="t">And finally we add enough padding tokens to reach the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6153" target="_blank">01:42:33.560</a></span> | <span class="t">We already calculated how many we need, just use this value now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6159" target="_blank">01:42:39.040</a></span> | <span class="t">And then we build the label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6180" target="_blank">01:43:00.120</a></span> | <span class="t">In the label we only add the end of sentence token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6196" target="_blank">01:43:16.400</a></span> | <span class="t">Because we need the same number of padding tokens as for the decoder input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6205" target="_blank">01:43:25.480</a></span> | <span class="t">Just for debugging, let's double check that we actually reach the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6217" target="_blank">01:43:37.160</a></span> | <span class="t">Ok, now that we have made this check, let me also write some comments here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6241" target="_blank">01:44:01.240</a></span> | <span class="t">Here we are only adding SOS to the decoder input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6249" target="_blank">01:44:09.680</a></span> | <span class="t">And here is add EOS to the label, what we expect as output from the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6265" target="_blank">01:44:25.280</a></span> | <span class="t">Now we can return all these tensors so that our training can use them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6272" target="_blank">01:44:32.360</a></span> | <span class="t">We return a dictionary comprised of encoder input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6281" target="_blank">01:44:41.920</a></span> | <span class="t">What is the encoder input?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6282" target="_blank">01:44:42.920</a></span> | <span class="t">It's basically of size sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6286" target="_blank">01:44:46.880</a></span> | <span class="t">Then we have the decoder input, which is also just a sequence length number of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6299" target="_blank">01:44:59.220</a></span> | <span class="t">I forgot a comma here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6306" target="_blank">01:45:06.480</a></span> | <span class="t">And then we have the encoder mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6308" target="_blank">01:45:08.720</a></span> | <span class="t">So what is the encoder mask?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6311" target="_blank">01:45:11.240</a></span> | <span class="t">As you remember, we are increasing the size of the encoder input sentence by adding padding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6319" target="_blank">01:45:19.180</a></span> | <span class="t">tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6320" target="_blank">01:45:20.180</a></span> | <span class="t">But we don't want these padding tokens to participate in the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6324" target="_blank">01:45:24.820</a></span> | <span class="t">So what we need is to build a mask that says that we don't want these tokens to be seen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6330" target="_blank">01:45:30.280</a></span> | <span class="t">by the self-attention mechanism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6332" target="_blank">01:45:32.700</a></span> | <span class="t">And so we build the mask for the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6337" target="_blank">01:45:37.360</a></span> | <span class="t">How do we build this mask?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6338" target="_blank">01:45:38.400</a></span> | <span class="t">We just say that all the tokens that are not padding are okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6344" target="_blank">01:45:44.120</a></span> | <span class="t">All the tokens that are padding are not okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6350" target="_blank">01:45:50.680</a></span> | <span class="t">We also unscreeze to add this sequence dimension and also to add the batch dimension later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6361" target="_blank">01:46:01.160</a></span> | <span class="t">And we convert into integers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6363" target="_blank">01:46:03.160</a></span> | <span class="t">So this is 1, 1 sequence length, because this will be used in the self-attention mechanism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6372" target="_blank">01:46:12.200</a></span> | <span class="t">However, for the decoder, we need a special mask that is a causal mask, which means that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6379" target="_blank">01:46:19.640</a></span> | <span class="t">each word can only look at the previous word and each word can only look at non-padding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6387" target="_blank">01:46:27.240</a></span> | <span class="t">words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6388" target="_blank">01:46:28.240</a></span> | <span class="t">So we don't want, again, we don't want the padding tokens to participate in the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6392" target="_blank">01:46:32.560</a></span> | <span class="t">We only want real words to participate in this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6395" target="_blank">01:46:35.680</a></span> | <span class="t">And we also don't want each word to watch at words that come after it, but only that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6402" target="_blank">01:46:42.360</a></span> | <span class="t">words come before it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6405" target="_blank">01:46:45.160</a></span> | <span class="t">So I will use a method here called causal mask that will build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6409" target="_blank">01:46:49.480</a></span> | <span class="t">Later we will build it also.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6410" target="_blank">01:46:50.600</a></span> | <span class="t">So now I just call it to show you how it's used, and then we will proceed to build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6420" target="_blank">01:47:00.760</a></span> | <span class="t">So in this case, we don't want the padding tokens, and we add the necessary dimensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6429" target="_blank">01:47:09.480</a></span> | <span class="t">And also we do a Boolean end with causal mask, which is a method that we will build right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6440" target="_blank">01:47:20.840</a></span> | <span class="t">now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6442" target="_blank">01:47:22.360</a></span> | <span class="t">And this causal mask needs to build a matrix of size sequence length to sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6447" target="_blank">01:47:27.240</a></span> | <span class="t">What is sequence length is basically the size of our decoder input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6456" target="_blank">01:47:36.480</a></span> | <span class="t">And this, let me write a comment for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6459" target="_blank">01:47:39.000</a></span> | <span class="t">So this is one, two, sequence length, combined with, so the end with one sequence length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6470" target="_blank">01:47:50.640</a></span> | <span class="t">sequence length, and this can be broadcasted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6476" target="_blank">01:47:56.240</a></span> | <span class="t">Let's go define this method, causal mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6479" target="_blank">01:47:59.280</a></span> | <span class="t">So what is causal mask?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6482" target="_blank">01:48:02.480</a></span> | <span class="t">Causal mask basically means that we want, let's go back to the slides actually, as you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6487" target="_blank">01:48:07.280</a></span> | <span class="t">remember from the slides, we want each word in the decoder to only watch words that come</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6492" target="_blank">01:48:12.800</a></span> | <span class="t">before it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6493" target="_blank">01:48:13.800</a></span> | <span class="t">So what we want is to make all these values above this diagonal that represents the multiplication,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6500" target="_blank">01:48:20.360</a></span> | <span class="t">this matrix represents the multiplication of the queries by the keys in the self-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6505" target="_blank">01:48:25.240</a></span> | <span class="t">mechanism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6506" target="_blank">01:48:26.480</a></span> | <span class="t">What we want is to hide all these values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6508" target="_blank">01:48:28.640</a></span> | <span class="t">So your cannot watch the word cat is a lovely cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6513" target="_blank">01:48:33.360</a></span> | <span class="t">It can only watch itself, but this word here, for example, this word lovely can watch everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6518" target="_blank">01:48:38.720</a></span> | <span class="t">that comes before it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6520" target="_blank">01:48:40.040</a></span> | <span class="t">So from your up to lovely itself, but not the word cat that comes after it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6525" target="_blank">01:48:45.540</a></span> | <span class="t">So what we do is we want all these values here to be masked out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6531" target="_blank">01:48:51.440</a></span> | <span class="t">So which also means that we want all the values above this diagonal to be masked out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6536" target="_blank">01:48:56.880</a></span> | <span class="t">And there is a very practical method in PyTorch to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6541" target="_blank">01:49:01.040</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6542" target="_blank">01:49:02.280</a></span> | <span class="t">Let's go build this method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6544" target="_blank">01:49:04.700</a></span> | <span class="t">So the mask is basically torch.triu, which means give me every value that is above the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6553" target="_blank">01:49:13.420</a></span> | <span class="t">diagonal that I am telling you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6555" target="_blank">01:49:15.440</a></span> | <span class="t">So we want a matrix, which matrix, matrix made of all ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6563" target="_blank">01:49:23.180</a></span> | <span class="t">And this method will return every value above the diagonal and everything else will become</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6569" target="_blank">01:49:29.520</a></span> | <span class="t">zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6570" target="_blank">01:49:30.880</a></span> | <span class="t">So we want diagonal one type, we want it to be integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6580" target="_blank">01:49:40.000</a></span> | <span class="t">And what we do is return mask is equal to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6583" target="_blank">01:49:43.460</a></span> | <span class="t">So this will return all the values above the diagonal and everything below the diagonal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6589" target="_blank">01:49:49.200</a></span> | <span class="t">will become zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6590" target="_blank">01:49:50.200</a></span> | <span class="t">But we want actually the opposite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6591" target="_blank">01:49:51.760</a></span> | <span class="t">So we say, okay, everything that is zero should will become true with this expression and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6596" target="_blank">01:49:56.040</a></span> | <span class="t">everything that is not zero will become false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6601" target="_blank">01:50:01.360</a></span> | <span class="t">So we apply it here to build this mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6603" target="_blank">01:50:03.540</a></span> | <span class="t">So this mask will be one by sequence length by sequence length, which is exactly what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6609" target="_blank">01:50:09.760</a></span> | <span class="t">we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6611" target="_blank">01:50:11.320</a></span> | <span class="t">Okay, let's add also the label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6619" target="_blank">01:50:19.000</a></span> | <span class="t">The label is also, oh, I forgot the comma.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6626" target="_blank">01:50:26.000</a></span> | <span class="t">Sequence length and then we have the source text just for visualization, we can send it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6630" target="_blank">01:50:30.480</a></span> | <span class="t">source text and then the target text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6641" target="_blank">01:50:41.640</a></span> | <span class="t">And this is our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6644" target="_blank">01:50:44.380</a></span> | <span class="t">Now let's go back to our training method to continue writing the training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6650" target="_blank">01:50:50.620</a></span> | <span class="t">So now that we have the data set, we can create it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6655" target="_blank">01:50:55.120</a></span> | <span class="t">We can create two data sets, one for training, one for validation, and then we send it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6661" target="_blank">01:51:01.120</a></span> | <span class="t">a data loader and finally to our training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6671" target="_blank">01:51:11.020</a></span> | <span class="t">We forgot to import the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6674" target="_blank">01:51:14.480</a></span> | <span class="t">So let's import it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6678" target="_blank">01:51:18.280</a></span> | <span class="t">We also import the causal mask, which we will need later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6703" target="_blank">01:51:43.480</a></span> | <span class="t">What is our source language? it's in the configuration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6710" target="_blank">01:51:50.040</a></span> | <span class="t">What is our target language?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6716" target="_blank">01:51:56.520</a></span> | <span class="t">And what is our sequence length?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6717" target="_blank">01:51:57.720</a></span> | <span class="t">It's also in the configuration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6721" target="_blank">01:52:01.800</a></span> | <span class="t">We do the same for the validation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6729" target="_blank">01:52:09.480</a></span> | <span class="t">But the only difference is that we use this one now and the rest is same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6735" target="_blank">01:52:15.960</a></span> | <span class="t">We also, just for choosing the max sequence length, we also want to watch what is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6741" target="_blank">01:52:21.200</a></span> | <span class="t">maximum length of each sentence in the source and the target for each of the two splits</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6747" target="_blank">01:52:27.320</a></span> | <span class="t">that we created here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6748" target="_blank">01:52:28.760</a></span> | <span class="t">So that if we choose a very small sequence length, we will know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6766" target="_blank">01:52:46.840</a></span> | <span class="t">Basically what we do, I load each sentence from each language, from the source and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6771" target="_blank">01:52:51.640</a></span> | <span class="t">target language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6772" target="_blank">01:52:52.640</a></span> | <span class="t">I convert into IDs using the tokenizer and I check the length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6776" target="_blank">01:52:56.340</a></span> | <span class="t">If the length is, let's say 180, we can choose 200 as sequence length, because it will cover</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6782" target="_blank">01:53:02.640</a></span> | <span class="t">all the possible sentences that we have in this data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6786" target="_blank">01:53:06.360</a></span> | <span class="t">If it's, let's say 500, we can use 510 or something like this, because we also need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6791" target="_blank">01:53:11.160</a></span> | <span class="t">to add the start of sentence and the end of sentence tokens to these sentences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6819" target="_blank">01:53:39.420</a></span> | <span class="t">This is the source IDs, then let's create also the target IDs, and this is the language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6826" target="_blank">01:53:46.280</a></span> | <span class="t">of target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6830" target="_blank">01:53:50.240</a></span> | <span class="t">And then we just say the source maximum length is the maximum of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6842" target="_blank">01:54:02.640</a></span> | <span class="t">and the length of the current sentence, the target is the target and the target IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6851" target="_blank">01:54:11.760</a></span> | <span class="t">Then we print these two values, we also do it for the target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6869" target="_blank">01:54:29.440</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6870" target="_blank">01:54:30.440</a></span> | <span class="t">Now we can proceed to create the data loaders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6882" target="_blank">01:54:42.760</a></span> | <span class="t">We define the batch size according to our configuration, which we still didn't define,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6887" target="_blank">01:54:47.160</a></span> | <span class="t">but you can already guess what are its values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6893" target="_blank">01:54:53.280</a></span> | <span class="t">We want it to be shuffled.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6907" target="_blank">01:55:07.500</a></span> | <span class="t">For the validation, I will use a batch size of one, because I want to process each sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6913" target="_blank">01:55:13.000</a></span> | <span class="t">one by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6917" target="_blank">01:55:17.640</a></span> | <span class="t">And this method returns the data loader of the training, the data loader of the validation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6924" target="_blank">01:55:24.180</a></span> | <span class="t">the tokenizer of the source language and the tokenizer of the target language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6930" target="_blank">01:55:30.880</a></span> | <span class="t">Now we can start building the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6934" target="_blank">01:55:34.960</a></span> | <span class="t">So let's define a new method called getModel, which will, according to our configuration,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6940" target="_blank">01:55:40.880</a></span> | <span class="t">our vocabulary size, build the model, the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6952" target="_blank">01:55:52.260</a></span> | <span class="t">So the model is, we didn't import the model, so let's import it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6965" target="_blank">01:56:05.600</a></span> | <span class="t">Model transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6971" target="_blank">01:56:11.280</a></span> | <span class="t">What is the first?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6972" target="_blank">01:56:12.280</a></span> | <span class="t">The source vocabulary size and the target vocabulary size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6980" target="_blank">01:56:20.280</a></span> | <span class="t">And then we have the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6985" target="_blank">01:56:25.200</a></span> | <span class="t">And we have the sequence length of the source language and the sequence length of the target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6990" target="_blank">01:56:30.880</a></span> | <span class="t">language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6991" target="_blank">01:56:31.880</a></span> | <span class="t">We will use the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6995" target="_blank">01:56:35.160</a></span> | <span class="t">For both.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=6997" target="_blank">01:56:37.080</a></span> | <span class="t">And then we have the dModule, which is the size of the embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7003" target="_blank">01:56:43.800</a></span> | <span class="t">We can keep all the rest, the default, as in the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7009" target="_blank">01:56:49.640</a></span> | <span class="t">If the model is too big for your GPU to be trained on, you can try to reduce the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7014" target="_blank">01:56:54.520</a></span> | <span class="t">of heads or the number of layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7016" target="_blank">01:56:56.640</a></span> | <span class="t">Of course, it will impact the performance of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7020" target="_blank">01:57:00.640</a></span> | <span class="t">But I think given the dataset, which is not so big and not so complicated, it should not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7026" target="_blank">01:57:06.260</a></span> | <span class="t">be a big problem because we are not building a huge dataset anyway.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7030" target="_blank">01:57:10.640</a></span> | <span class="t">OK, now that we have the model, we can start building the training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7035" target="_blank">01:57:15.800</a></span> | <span class="t">But before we build the training loop, let me as define this configuration because it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7039" target="_blank">01:57:19.960</a></span> | <span class="t">keeps coming and I think it's better to define the structure now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7046" target="_blank">01:57:26.400</a></span> | <span class="t">So let's create a new file called config.py in which we define two methods.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7052" target="_blank">01:57:32.660</a></span> | <span class="t">One is called getConfig and one is to map to get the path where we will save the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7060" target="_blank">01:57:40.760</a></span> | <span class="t">of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7064" target="_blank">01:57:44.880</a></span> | <span class="t">OK, let's define the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7074" target="_blank">01:57:54.240</a></span> | <span class="t">I choose 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7075" target="_blank">01:57:55.240</a></span> | <span class="t">You can choose something bigger if your computer allows it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7078" target="_blank">01:57:58.440</a></span> | <span class="t">The number of epochs for which we will be training, I would say 20 is enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7083" target="_blank">01:58:03.840</a></span> | <span class="t">The learning rate, I am using 10 to the power of -4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7088" target="_blank">01:58:08.740</a></span> | <span class="t">You can use other values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7091" target="_blank">01:58:11.640</a></span> | <span class="t">I thought this learning rate is reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7096" target="_blank">01:58:16.880</a></span> | <span class="t">It's possible to change the learning rate during training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7101" target="_blank">01:58:21.320</a></span> | <span class="t">It's quite common to give a very high learning rate and then reduce it gradually with every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7106" target="_blank">01:58:26.360</a></span> | <span class="t">epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7107" target="_blank">01:58:27.360</a></span> | <span class="t">We will not be using it because it will just complicate the code a little more and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7111" target="_blank">01:58:31.160</a></span> | <span class="t">is not actually the goal of this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7113" target="_blank">01:58:33.840</a></span> | <span class="t">The goal of this video is to teach how the transformer works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7121" target="_blank">01:58:41.080</a></span> | <span class="t">I have already checked the sequence length that we need for this particular dataset from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7126" target="_blank">01:58:46.760</a></span> | <span class="t">English to Italian, which is 350 is more than enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7130" target="_blank">01:58:50.760</a></span> | <span class="t">And the D model that we will be using is the default of 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7135" target="_blank">01:58:55.680</a></span> | <span class="t">The language source is English.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7139" target="_blank">01:58:59.120</a></span> | <span class="t">So we are going from English.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7140" target="_blank">01:59:00.880</a></span> | <span class="t">The language target is Italian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7143" target="_blank">01:59:03.520</a></span> | <span class="t">We are going to translate into Italian.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7147" target="_blank">01:59:07.640</a></span> | <span class="t">We will save the model into the folder called weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7156" target="_blank">01:59:16.760</a></span> | <span class="t">And the file name of which model will be T model, so transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7165" target="_blank">01:59:25.480</a></span> | <span class="t">I also built the code to preload the model in case we want to restart the training after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7172" target="_blank">01:59:32.080</a></span> | <span class="t">maybe it crashed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7183" target="_blank">01:59:43.680</a></span> | <span class="t">And this is the tokenizer file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7186" target="_blank">01:59:46.320</a></span> | <span class="t">So it will be saved like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7187" target="_blank">01:59:47.560</a></span> | <span class="t">So tokenizer n and tokenizer it according to the language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7192" target="_blank">01:59:52.720</a></span> | <span class="t">And this is the experiment name for TensorBoard on which we will save the losses while training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7204" target="_blank">02:00:04.720</a></span> | <span class="t">I think there is a comma here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7208" target="_blank">02:00:08.080</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7209" target="_blank">02:00:09.080</a></span> | <span class="t">Now let's define another method that allows us to find the part where we need to save</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7213" target="_blank">02:00:13.280</a></span> | <span class="t">the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7219" target="_blank">02:00:19.520</a></span> | <span class="t">Why I'm creating such a complicated structure is because I will provide also notebooks to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7226" target="_blank">02:00:26.600</a></span> | <span class="t">run this training on Google Colab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7229" target="_blank">02:00:29.720</a></span> | <span class="t">So we just need to change these parameters to make it work on Google Colab and save the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7234" target="_blank">02:00:34.320</a></span> | <span class="t">weights directly on your Google Drive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7236" target="_blank">02:00:36.560</a></span> | <span class="t">I have already created actually this code and it will be provided on GitHub and I will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7242" target="_blank">02:00:42.880</a></span> | <span class="t">also provide the link in the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7262" target="_blank">02:01:02.240</a></span> | <span class="t">Okay, the file is built according to model base name, then the epoch.pt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7287" target="_blank">02:01:27.920</a></span> | <span class="t">Let's import also here the path library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7307" target="_blank">02:01:47.560</a></span> | <span class="t">Okay, now let's go back to our training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7312" target="_blank">02:01:52.880</a></span> | <span class="t">Okay, we can build the training loop now finally.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7315" target="_blank">02:01:55.840</a></span> | <span class="t">So train model given the configuration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7319" target="_blank">02:01:59.960</a></span> | <span class="t">Okay, first we need to define which device on which we will put all the tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7325" target="_blank">02:02:05.680</a></span> | <span class="t">So define the device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7353" target="_blank">02:02:33.120</a></span> | <span class="t">Then we also print.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7364" target="_blank">02:02:44.960</a></span> | <span class="t">We make sure that the weights folder is created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7384" target="_blank">02:03:04.760</a></span> | <span class="t">And then we load our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7408" target="_blank">02:03:28.040</a></span> | <span class="t">To get the vocabulary size, there is method called get_vocab_size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7417" target="_blank">02:03:37.720</a></span> | <span class="t">And I think we don't have any other parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7421" target="_blank">02:03:41.160</a></span> | <span class="t">And finally, we transfer the model to our device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7427" target="_blank">02:03:47.520</a></span> | <span class="t">We also start TensorBoard.TensorBoard allows to visualize the loss, the graphics, the charts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7446" target="_blank">02:04:06.320</a></span> | <span class="t">Let's also import TensorBoard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7468" target="_blank">02:04:28.920</a></span> | <span class="t">Let's go back.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7470" target="_blank">02:04:30.240</a></span> | <span class="t">Let's also create the optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7473" target="_blank">02:04:33.280</a></span> | <span class="t">I will be using the Adam optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7488" target="_blank">02:04:48.000</a></span> | <span class="t">Okay, since we also have the configuration that allow us to resume the training in case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7501" target="_blank">02:05:01.000</a></span> | <span class="t">the model crashes or something crashes, let's implement that one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7505" target="_blank">02:05:05.480</a></span> | <span class="t">And that will allow us to restore the state of the model and the state of the optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7531" target="_blank">02:05:31.160</a></span> | <span class="t">Let's import this method we defined in the data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7558" target="_blank">02:05:58.720</a></span> | <span class="t">We load the file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7583" target="_blank">02:06:23.120</a></span> | <span class="t">And we run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7611" target="_blank">02:06:51.760</a></span> | <span class="t">Here we have a typo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7617" target="_blank">02:06:57.480</a></span> | <span class="t">Okay, the loss function we will be using is the cross entropy loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7627" target="_blank">02:07:07.880</a></span> | <span class="t">We need to tell him what is the ignore index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7630" target="_blank">02:07:10.160</a></span> | <span class="t">So we want him to ignore the padding token basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7634" target="_blank">02:07:14.080</a></span> | <span class="t">We don't want the padding token to contribute to the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7654" target="_blank">02:07:34.480</a></span> | <span class="t">And we also will be using label smoothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7658" target="_blank">02:07:38.160</a></span> | <span class="t">Label smoothing basically allows our model to be less confident about its decision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7665" target="_blank">02:07:45.040</a></span> | <span class="t">So how to say, imagine our model is telling us to choose the word number three and with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7672" target="_blank">02:07:52.280</a></span> | <span class="t">a very high probability.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7673" target="_blank">02:07:53.600</a></span> | <span class="t">So what we will do with label smoothing is take a little percentage of that probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7677" target="_blank">02:07:57.320</a></span> | <span class="t">and distribute to the other tokens so that our model becomes less sure of its choices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7684" target="_blank">02:08:04.280</a></span> | <span class="t">So kind of less over fit and this actually improves the accuracy of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7692" target="_blank">02:08:12.020</a></span> | <span class="t">So we will use a label smoothing of 0.1 which means from every highest probability token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7699" target="_blank">02:08:19.240</a></span> | <span class="t">take 0.1% of score and give it to the others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7708" target="_blank">02:08:28.240</a></span> | <span class="t">Okay let's build finally the training loop, we tell the model to train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7727" target="_blank">02:08:47.320</a></span> | <span class="t">I build a batch iterator for the data loader using tqodm which will show a very nice progress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7735" target="_blank">02:08:55.540</a></span> | <span class="t">bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7758" target="_blank">02:09:18.400</a></span> | <span class="t">And we need to import tqodm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7774" target="_blank">02:09:34.280</a></span> | <span class="t">Okay finally we get the tensors, the encoder input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7789" target="_blank">02:09:49.000</a></span> | <span class="t">What is the size of this tensor?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7791" target="_blank">02:09:51.280</a></span> | <span class="t">It's batch to sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7794" target="_blank">02:09:54.880</a></span> | <span class="t">The decoder input is batch of decoder input and we also move it to our device, batch to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7806" target="_blank">02:10:06.160</a></span> | <span class="t">sequence length, we get the two masks also.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7825" target="_blank">02:10:25.040</a></span> | <span class="t">This is the size and then the decoder mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7841" target="_blank">02:10:41.320</a></span> | <span class="t">Okay why these two masks are different?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7844" target="_blank">02:10:44.240</a></span> | <span class="t">Because in the one case we are only telling him to hide only the padding tokens, in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7851" target="_blank">02:10:51.240</a></span> | <span class="t">other case we are also telling him to hide all these subsequent words, for each word</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7857" target="_blank">02:10:57.120</a></span> | <span class="t">to hide all the subsequent words to mask them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7862" target="_blank">02:11:02.440</a></span> | <span class="t">Okay now we run the tensors through the transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7870" target="_blank">02:11:10.880</a></span> | <span class="t">So first we calculate the output of the encoder and we encode using what the encoder input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7880" target="_blank">02:11:20.480</a></span> | <span class="t">and the mask of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7884" target="_blank">02:11:24.360</a></span> | <span class="t">Then we calculate the decoder output using the encoder output, the source, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7896" target="_blank">02:11:36.920</a></span> | <span class="t">mask of the encoder, then the decoder input and the decoder mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7906" target="_blank">02:11:46.800</a></span> | <span class="t">Okay as we know this the result of this so the output of the model.encode will be a batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7914" target="_blank">02:11:54.840</a></span> | <span class="t">sequence length d model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7919" target="_blank">02:11:59.800</a></span> | <span class="t">Also the output of the decoder will be batch sequence length d model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7928" target="_blank">02:12:08.120</a></span> | <span class="t">But we want to map it back to the vocabulary so we need the projection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7931" target="_blank">02:12:11.620</a></span> | <span class="t">So let's get the projection output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7939" target="_blank">02:12:19.960</a></span> | <span class="t">And this will produce a B so batch sequence length and target vocabulary size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7949" target="_blank">02:12:29.440</a></span> | <span class="t">Okay now that we have the output of the model we want to compare it with our label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7954" target="_blank">02:12:34.360</a></span> | <span class="t">So first let's extract the label from the batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7962" target="_blank">02:12:42.580</a></span> | <span class="t">And we also put it on our device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7965" target="_blank">02:12:45.180</a></span> | <span class="t">So what is the label it's B so batch to sequence length in which each position tell so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7972" target="_blank">02:12:52.700</a></span> | <span class="t">label is already for each B and sequence length so for each dimension tells us what is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7980" target="_blank">02:13:00.140</a></span> | <span class="t">position in the vocabulary of that particular word and we want these two to be comparable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7988" target="_blank">02:13:08.660</a></span> | <span class="t">so we first need to compute the loss into this I show you now projection output view</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=7998" target="_blank">02:13:18.180</a></span> | <span class="t">minus one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8008" target="_blank">02:13:28.620</a></span> | <span class="t">Okay what does this do this basically transforms the I show you here this size into this size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8020" target="_blank">02:13:40.600</a></span> | <span class="t">B multiplied by sequence length and then target vocabulary size vocabulary size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8029" target="_blank">02:13:49.140</a></span> | <span class="t">Okay because we want to compare it with this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8032" target="_blank">02:13:52.600</a></span> | <span class="t">This is how the cross entropy wants the tensors to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8040" target="_blank">02:14:00.300</a></span> | <span class="t">And also the label.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8044" target="_blank">02:14:04.660</a></span> | <span class="t">Okay now we can we have calculated the loss we can update our progress bar this one with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8051" target="_blank">02:14:11.620</a></span> | <span class="t">the loss we have calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8079" target="_blank">02:14:39.560</a></span> | <span class="t">This is this will show the loss on our progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8083" target="_blank">02:14:43.340</a></span> | <span class="t">We can also log it on TensorBoard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8092" target="_blank">02:14:52.380</a></span> | <span class="t">Let's also flush it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8107" target="_blank">02:15:07.260</a></span> | <span class="t">Okay now we can back propagate the loss so loss.backward and finally we update the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8117" target="_blank">02:15:17.620</a></span> | <span class="t">of the model so that is the job of the optimizer and finally we can zero out the grad and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8128" target="_blank">02:15:28.040</a></span> | <span class="t">move the global step by one the global step is being used mostly for TensorBoard to keep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8132" target="_blank">02:15:32.820</a></span> | <span class="t">track of the loss we can save the model every epoch okay model file name which we get from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8145" target="_blank">02:15:45.700</a></span> | <span class="t">our special methods this one we tell him the configuration we have and the name of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8154" target="_blank">02:15:54.140</a></span> | <span class="t">file which is the epoch but with zeros in front and we save our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8166" target="_blank">02:16:06.860</a></span> | <span class="t">It is very good idea when we want to be able to resume the training to also save not only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8172" target="_blank">02:16:12.740</a></span> | <span class="t">the state of the model but also the state of the optimizer because the optimizer also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8178" target="_blank">02:16:18.340</a></span> | <span class="t">keep tracks of some statistics one for each weight to understand how to move each weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8184" target="_blank">02:16:24.820</a></span> | <span class="t">independently and usually actually I saw that the optimizer dictionary is quite big so even</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8195" target="_blank">02:16:35.860</a></span> | <span class="t">if it's big if you want your training to be resumable you need to save it otherwise the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8200" target="_blank">02:16:40.800</a></span> | <span class="t">optimizer will always start from zero and we'll have to figure out from zero even if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8205" target="_blank">02:16:45.980</a></span> | <span class="t">you start from a previous epoch how to move each weight so every time we save some snapshot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8212" target="_blank">02:16:52.660</a></span> | <span class="t">I always include it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8218" target="_blank">02:16:58.660</a></span> | <span class="t">State of the model this is all the weights of the model we also want to save the optimizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8229" target="_blank">02:17:09.020</a></span> | <span class="t">let's do also the global step and we want to save all this into the file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8248" target="_blank">02:17:28.240</a></span> | <span class="t">name so model file name and that's it now let's build the code to run this so if name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8264" target="_blank">02:17:44.280</a></span> | <span class="t">I really find the warnings frustrating so I want to filter them out because I have some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8270" target="_blank">02:17:50.260</a></span> | <span class="t">a lot of libraries especially CUDA I already know what's the content and so I don't want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8277" target="_blank">02:17:57.040</a></span> | <span class="t">to visualize them every time but for sure for you guys I suggest watching them at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8282" target="_blank">02:18:02.680</a></span> | <span class="t">once to understand if there is any big problem otherwise they're just complaining from CUDA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8302" target="_blank">02:18:22.440</a></span> | <span class="t">okay let's try to run this code and see if everything is working fine we should what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8309" target="_blank">02:18:29.760</a></span> | <span class="t">we expect is that the code should download the data set the first time then it should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8315" target="_blank">02:18:35.240</a></span> | <span class="t">create the tokenizer and save it into its file and it should also start training the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8322" target="_blank">02:18:42.960</a></span> | <span class="t">model for 30 epochs of course it will never finish but let's do it let me check again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8328" target="_blank">02:18:48.760</a></span> | <span class="t">the configuration tokenizer okay let's run it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8353" target="_blank">02:19:13.520</a></span> | <span class="t">okay it's building the tokenizer and we have some problem here sequence length okay finally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8360" target="_blank">02:19:20.040</a></span> | <span class="t">the model is training I show you recap you guys what I had mistaken first of all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8366" target="_blank">02:19:26.920</a></span> | <span class="t">sequence length was written incorrectly there was a capital L here and also in the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8372" target="_blank">02:19:32.720</a></span> | <span class="t">set I forgot to save it here and here I had it also written capitalized so L was capital</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8381" target="_blank">02:19:41.120</a></span> | <span class="t">and now the training is going on and as you can see the training is quite fast or at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8388" target="_blank">02:19:48.440</a></span> | <span class="t">on my computer actually not so fast but because I chose a batch size of 8 I could try to increase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8395" target="_blank">02:19:55.680</a></span> | <span class="t">it and it's happening on CUDA the loss is decreasing and the weights will be saved here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8403" target="_blank">02:20:03.080</a></span> | <span class="t">so if we reach the end of the epoch it will create the first weight here so let's wait</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8407" target="_blank">02:20:07.720</a></span> | <span class="t">until the end of the epoch and see if the weight is actually created before actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8412" target="_blank">02:20:12.800</a></span> | <span class="t">finishing the training of the model let's do another thing we also would like to visualize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8419" target="_blank">02:20:19.000</a></span> | <span class="t">the output of the model while we are training and this is called validation so we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8423" target="_blank">02:20:23.960</a></span> | <span class="t">check how our model is evolving while it is getting trained so what we want to build is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8431" target="_blank">02:20:31.160</a></span> | <span class="t">a validation loop which will allow us to evaluate the model which also means that we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8436" target="_blank">02:20:36.940</a></span> | <span class="t">inference from this model and check some sample sentences and see if how they get translated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8443" target="_blank">02:20:43.520</a></span> | <span class="t">so let's start building the validation loop the first thing we do is we build a new method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8448" target="_blank">02:20:48.280</a></span> | <span class="t">called run validation and this method will accept some parameters that we will use for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8461" target="_blank">02:21:01.920</a></span> | <span class="t">now I just write all of them and later I explain how they will be used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8465" target="_blank">02:21:05.500</a></span> | <span class="t">so, we have a new method called run validation and this method will accept some parameters, we will use them later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8472" target="_blank">02:21:12.500</a></span> | <span class="t">[typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8498" target="_blank">02:21:38.500</a></span> | <span class="t">okay the first thing we do to run the validation is we put our model into evaluation mode so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8506" target="_blank">02:21:46.260</a></span> | <span class="t">we do model.eval and this means that this tells PyTorch that we are going to evaluate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8512" target="_blank">02:21:52.100</a></span> | <span class="t">our model and then what we will do we will inference two sentences and see what is the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8521" target="_blank">02:22:01.740</a></span> | <span class="t">output of the model. [typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8550" target="_blank">02:22:30.740</a></span> | <span class="t">so with torch.nodegrad we are disabling the gradient calculation for this for every tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8567" target="_blank">02:22:47.400</a></span> | <span class="t">that we will run inside this with block and this is exactly what we want we just want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8572" target="_blank">02:22:52.100</a></span> | <span class="t">to inference from the model we don't want to train it during this loop so let's get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8578" target="_blank">02:22:58.700</a></span> | <span class="t">a batch from the validation data set because we want to inference only two so we keep a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8585" target="_blank">02:23:05.380</a></span> | <span class="t">count of how many we have already processed and we get the input from this current batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8593" target="_blank">02:23:13.340</a></span> | <span class="t">I want to remind you that for the validation ds we only have a batch size of 1 [typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8608" target="_blank">02:23:28.120</a></span> | <span class="t">this is the encoder input and we can also get the encoder mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8623" target="_blank">02:23:43.100</a></span> | <span class="t">let's just verify that the size of the batch is actually 1 [typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8641" target="_blank">02:24:01.040</a></span> | <span class="t">and now let's go to the interesting part so as you remember when we calculate the when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8649" target="_blank">02:24:09.360</a></span> | <span class="t">we want to inference the model we need to calculate the encoder output only once and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8654" target="_blank">02:24:14.440</a></span> | <span class="t">reuse it for every token that the model will output from the decoder so let's create another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8660" target="_blank">02:24:20.600</a></span> | <span class="t">function that will run the greedy decoding on our model and we will see that it will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8666" target="_blank">02:24:26.520</a></span> | <span class="t">run the encoder only once so let's call this function greedy decode [typing]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8694" target="_blank">02:24:54.080</a></span> | <span class="t">okay let's create some tokens that we will need so the SOS token which is the start of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8701" target="_blank">02:25:01.140</a></span> | <span class="t">sentence we can get it from either tokenizer it doesn't matter if it's the target or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8719" target="_blank">02:25:19.660</a></span> | <span class="t">target EOS okay and then we what we do is we pre-compute the encoder output and reuse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8735" target="_blank">02:25:35.740</a></span> | <span class="t">it for every token we get from the decoder so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8742" target="_blank">02:25:42.180</a></span> | <span class="t">we just give the source and the source mask which is the encoder input and the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8757" target="_blank">02:25:57.340</a></span> | <span class="t">mask we can also call it encoder input and encoder mask then we get the then we okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8766" target="_blank">02:26:06.800</a></span> | <span class="t">how do we do the inferencing the first thing we do is we give to the decoder the start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8771" target="_blank">02:26:11.820</a></span> | <span class="t">of sentence token so that the decoder will output the first token of the sentence of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8778" target="_blank">02:26:18.060</a></span> | <span class="t">the translated sentence then at every iteration just like we saw in my slides at every iteration</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8784" target="_blank">02:26:24.540</a></span> | <span class="t">we add the previous token to the to the decoder input and so that the decoder can output the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8791" target="_blank">02:26:31.660</a></span> | <span class="t">next token then we take the next token we put it again in front of the input to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8796" target="_blank">02:26:36.620</a></span> | <span class="t">decoder and we get the successive token so let's build a decoder input for the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8802" target="_blank">02:26:42.780</a></span> | <span class="t">iteration which is only the start of sentence token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8826" target="_blank">02:27:06.780</a></span> | <span class="t">we fill this one with the start of sentence token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8837" target="_blank">02:27:17.280</a></span> | <span class="t">and it has the same type as the encoder input okay now we will keep in asking the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8846" target="_blank">02:27:26.740</a></span> | <span class="t">to output the next token until we reach either the end of sentence token or the max length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8852" target="_blank">02:27:32.420</a></span> | <span class="t">we have defined here so we can do a while true and then our first stopping condition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8859" target="_blank">02:27:39.260</a></span> | <span class="t">is if we the decoder output which is becomes the input of the next step becomes large larger</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8866" target="_blank">02:27:46.760</a></span> | <span class="t">than max length or which is max length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8878" target="_blank">02:27:58.140</a></span> | <span class="t">here why do we have two dimensions one is for the batch and one is for the tokens of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8882" target="_blank">02:28:02.620</a></span> | <span class="t">the of the decoder input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8889" target="_blank">02:28:09.740</a></span> | <span class="t">now we also need to create a mask for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8904" target="_blank">02:28:24.820</a></span> | <span class="t">we can use our function causal mask to say that we don't want the input to watch future</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8911" target="_blank">02:28:31.580</a></span> | <span class="t">words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8919" target="_blank">02:28:39.780</a></span> | <span class="t">and we don't need the other mask because here we don't have any padding token as you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8923" target="_blank">02:28:43.260</a></span> | <span class="t">see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8932" target="_blank">02:28:52.900</a></span> | <span class="t">now we calculate the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8947" target="_blank">02:29:07.820</a></span> | <span class="t">we reuse the output of the encoder for every iteration of the loop we reuse the source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8955" target="_blank">02:29:15.260</a></span> | <span class="t">mask so the input the mask of the encoder then we give the decoder input and along with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8961" target="_blank">02:29:21.220</a></span> | <span class="t">its mask the decoder mask and then we get the next token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8971" target="_blank">02:29:31.860</a></span> | <span class="t">so we get the probabilities of the next token using the projection layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8979" target="_blank">02:29:39.860</a></span> | <span class="t">but we only want the projection of the last token so the next token after the last we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8987" target="_blank">02:29:47.260</a></span> | <span class="t">have given to the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8991" target="_blank">02:29:51.980</a></span> | <span class="t">now we can use the max</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=8999" target="_blank">02:29:59.460</a></span> | <span class="t">so we get the token with the maximum probability this is the greedy search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9018" target="_blank">02:30:18.620</a></span> | <span class="t">and then we get this word and we append it back to this one because it will become the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9024" target="_blank">02:30:24.740</a></span> | <span class="t">input of the next iteration</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9030" target="_blank">02:30:30.140</a></span> | <span class="t">and we concat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9033" target="_blank">02:30:33.700</a></span> | <span class="t">so we take the decoder input and we append the next token so we create another tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9039" target="_blank">02:30:39.900</a></span> | <span class="t">for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9068" target="_blank">02:31:08.900</a></span> | <span class="t">yeah should be correct okay if the next token so if the next word or token is equal equal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9085" target="_blank">02:31:25.700</a></span> | <span class="t">to the end of sentence token then we also stop the loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9091" target="_blank">02:31:31.260</a></span> | <span class="t">and this is our greedy search now we can just return the output so the output is basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9097" target="_blank">02:31:37.660</a></span> | <span class="t">the decoder input because every time we are appending the next token to it and we remove</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9102" target="_blank">02:31:42.540</a></span> | <span class="t">the batch dimension so we squeeze it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9107" target="_blank">02:31:47.660</a></span> | <span class="t">and that's our greedy decoding now we can use it here in this function so in the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9114" target="_blank">02:31:54.060</a></span> | <span class="t">function so we can finally get the model output is equal to greedy decode in which we give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9122" target="_blank">02:32:02.300</a></span> | <span class="t">him all the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9139" target="_blank">02:32:19.620</a></span> | <span class="t">and then we want to compare this model output with what we expected so with the label so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9146" target="_blank">02:32:26.900</a></span> | <span class="t">let's append all of these so what we give to the input we gave to the model what the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9152" target="_blank">02:32:32.820</a></span> | <span class="t">model output the output of the model so the predicted and what we expected as output we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9158" target="_blank">02:32:38.500</a></span> | <span class="t">save all of this in this lists and then at the end of the loop we will print them on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9177" target="_blank">02:32:57.780</a></span> | <span class="t">to get the text of the output of the model we need to use the tokenizer again to convert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9198" target="_blank">02:33:18.500</a></span> | <span class="t">the tokens back into text and we use of course the target tokenizer because this is the target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9205" target="_blank">02:33:25.940</a></span> | <span class="t">the language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9220" target="_blank">02:33:40.460</a></span> | <span class="t">okay and now we save them all of this into their respective lists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9246" target="_blank">02:34:06.620</a></span> | <span class="t">and we can also print it on the console</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9253" target="_blank">02:34:13.820</a></span> | <span class="t">while we are using why we are we using this function called print message and why not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9258" target="_blank">02:34:18.540</a></span> | <span class="t">just use the print of the Python because we are using here in the main loop in the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9263" target="_blank">02:34:23.940</a></span> | <span class="t">loop we are using here tqdm which is our really nice looking progress bar but it is not suggested</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9272" target="_blank">02:34:32.260</a></span> | <span class="t">to print directly on the console when this progress bar is running so to print on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9278" target="_blank">02:34:38.460</a></span> | <span class="t">console there is one method called the print provided by tqdm and we will give this method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9285" target="_blank">02:34:45.740</a></span> | <span class="t">to this function so that the output does not interfere with the progress bar printing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9298" target="_blank">02:34:58.900</a></span> | <span class="t">so we print some bars</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9304" target="_blank">02:35:04.420</a></span> | <span class="t">and then we print all the messages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9305" target="_blank">02:35:05.860</a></span> | <span class="t">okay so we have a message here and we have a message here and we have a message here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9334" target="_blank">02:35:34.300</a></span> | <span class="t">and if we have already processed number of examples then we just break so why we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9348" target="_blank">02:35:48.260</a></span> | <span class="t">created these lists actually we can also send all of this to to a tensor board so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9358" target="_blank">02:35:58.700</a></span> | <span class="t">so for example if we have tensor board enabled we can send all of this to the tensor board</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9364" target="_blank">02:36:04.280</a></span> | <span class="t">and to do that actually we need another library that allow us to calculate some metrics I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9370" target="_blank">02:36:10.900</a></span> | <span class="t">think we can skip this part but if you are really interested in the code I published</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9377" target="_blank">02:36:17.620</a></span> | <span class="t">on github you will find that I use this library called the torch metrics that allows us to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9384" target="_blank">02:36:24.020</a></span> | <span class="t">calculate the char error rate and the bleu metric which is really useful for translation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9391" target="_blank">02:36:31.820</a></span> | <span class="t">tasks and the word error rate so if you really interested you can find the code on the github</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9399" target="_blank">02:36:39.420</a></span> | <span class="t">but for our demonstration I think it's not necessary so and actually this we can also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9407" target="_blank">02:36:47.220</a></span> | <span class="t">remove it given that we are not doing this part okay so now that we have our run validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9415" target="_blank">02:36:55.140</a></span> | <span class="t">method we can just call it okay what I usually do is I run the validation at every few steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9425" target="_blank">02:37:05.700</a></span> | <span class="t">but because we want to see it as soon as possible what we will do is we will first run it at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9433" target="_blank">02:37:13.880</a></span> | <span class="t">every iteration and we also put this model.train inside of this loop so that every time after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9442" target="_blank">02:37:22.100</a></span> | <span class="t">we run the validation the model is back into its training mode so now we can just run validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9449" target="_blank">02:37:29.500</a></span> | <span class="t">and we give it all the parameter that it needs to run the validation so give it model okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9477" target="_blank">02:37:57.140</a></span> | <span class="t">for printing message are we printing any message we are so let's create a lambda and we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9489" target="_blank">02:38:09.020</a></span> | <span class="t">do and this is the message to write with the tqdm then we need to give the global step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9505" target="_blank">02:38:25.060</a></span> | <span class="t">and the writer which we will not use but okay now I think we can run the training again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9513" target="_blank">02:38:33.660</a></span> | <span class="t">and see if the validation works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9538" target="_blank">02:38:58.660</a></span> | <span class="t">all right looks like it is working so the model is okay it's running the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9545" target="_blank">02:39:05.780</a></span> | <span class="t">at every step which is not desirable at all but at least we know that the greedy search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9550" target="_blank">02:39:10.820</a></span> | <span class="t">is working and it's not at least looks like it is working and the model is not predicting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9557" target="_blank">02:39:17.060</a></span> | <span class="t">anything useful actually it's just predicting a bunch of commas because it's not training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9563" target="_blank">02:39:23.980</a></span> | <span class="t">at all but if we train the model after a while we should see that at after a few epochs the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9569" target="_blank">02:39:29.940</a></span> | <span class="t">model should become better and better and better so let's stop this training and let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9576" target="_blank">02:39:36.980</a></span> | <span class="t">put this one back to where it belongs so at the end of every epoch here and this one we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9583" target="_blank">02:39:43.880</a></span> | <span class="t">can keep it here no problem yeah okay I will now skip fast forward to a model that has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9592" target="_blank">02:39:52.860</a></span> | <span class="t">been pre-trained I pre-trained it for a few hours so that we can inference it and we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9598" target="_blank">02:39:58.980</a></span> | <span class="t">visualize the attention I have copied the pre-trained weights that I pre-calculated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9605" target="_blank">02:40:05.660</a></span> | <span class="t">and I also created this notebook reusing the functions that we have defined before in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9610" target="_blank">02:40:10.900</a></span> | <span class="t">train file the code is very simple actually I just copy and pasted the code from the train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9615" target="_blank">02:40:15.980</a></span> | <span class="t">file I just load the model and run the validation the same method that we just wrote and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9622" target="_blank">02:40:22.460</a></span> | <span class="t">I ran the validation on the pre-trained let's run it again for example and as you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9628" target="_blank">02:40:28.860</a></span> | <span class="t">the model is inferencing 10 examples sentences and the result is not bad I mean we can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9635" target="_blank">02:40:35.020</a></span> | <span class="t">that LevinSmile, LevinSorrisse, LevinSorrisse it's matching and most of them matching actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9640" target="_blank">02:40:40.420</a></span> | <span class="t">we could also say that it's nearly over fit for this particular data but this is the power</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9647" target="_blank">02:40:47.740</a></span> | <span class="t">of the transformer I didn't train it for many days I just trained it for a few hours if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9653" target="_blank">02:40:53.020</a></span> | <span class="t">I remember correctly and the results are really really good and now let's write let's make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9658" target="_blank">02:40:58.760</a></span> | <span class="t">the notebook that we will use to visualize the attention of this pre-trained model given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9666" target="_blank">02:41:06.080</a></span> | <span class="t">the file that we built before so train.py you can also train your own model choosing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9670" target="_blank">02:41:10.820</a></span> | <span class="t">the language of your choice which I highly recommend that you change the language and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9675" target="_blank">02:41:15.060</a></span> | <span class="t">try to see how the model is performing and try to diagnose why the model is performing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9681" target="_blank">02:41:21.240</a></span> | <span class="t">bad if it's performing bad or if it's performing well try to understand how can you improve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9686" target="_blank">02:41:26.620</a></span> | <span class="t">it further so let's try to visualize the attention so let's create a new notebook let's call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9693" target="_blank">02:41:33.660</a></span> | <span class="t">it let's say attention visualization okay so the first thing we do we import all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9707" target="_blank">02:41:47.740</a></span> | <span class="t">libraries we will need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9734" target="_blank">02:42:14.060</a></span> | <span class="t">I will also be using this library called Altair it's a visualization library for charts it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9745" target="_blank">02:42:25.180</a></span> | <span class="t">nothing related to deep learning actually it's just a visualization function and in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9750" target="_blank">02:42:30.420</a></span> | <span class="t">particular the visualization function actually I found it online it's not written by me just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9754" target="_blank">02:42:34.660</a></span> | <span class="t">like most of the visualization functions you can find easily on the internet if you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9758" target="_blank">02:42:38.240</a></span> | <span class="t">to build a chart or if you want to build a histogram etc so I am using this library mostly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9763" target="_blank">02:42:43.920</a></span> | <span class="t">because I copied the code from the internet to visualize it but all the rest is my own</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9768" target="_blank">02:42:48.700</a></span> | <span class="t">code so let's import it okay let's import all of this and of course you will have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9796" target="_blank">02:43:16.780</a></span> | <span class="t">install this particular library when you run the code on your computer let's also define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9802" target="_blank">02:43:22.280</a></span> | <span class="t">the device you can just copy the code from here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9818" target="_blank">02:43:38.760</a></span> | <span class="t">and then we load the model which we can copy from here like this okay let's paste it here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9831" target="_blank">02:43:51.640</a></span> | <span class="t">and this one becomes vocabulary source and vocabulary target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9858" target="_blank">02:44:18.320</a></span> | <span class="t">okay now let's make a function to load the batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9862" target="_blank">02:44:22.560</a></span> | <span class="t">okay so we have a function called load_batch which is a function that loads the batch and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9891" target="_blank">02:44:51.000</a></span> | <span class="t">oops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9898" target="_blank">02:44:58.000</a></span> | <span class="t">I will convert the batch into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9927" target="_blank">02:45:27.960</a></span> | <span class="t">I will convert the tokens now using the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9929" target="_blank">02:45:29.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9932" target="_blank">02:45:32.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9935" target="_blank">02:45:35.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9938" target="_blank">02:45:38.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9941" target="_blank">02:45:41.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9950" target="_blank">02:45:50.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9959" target="_blank">02:45:59.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9966" target="_blank">02:46:06.600</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9968" target="_blank">02:46:08.760</a></span> | <span class="t">And of course, for the decoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9970" target="_blank">02:46:10.000</a></span> | <span class="t">we use the target vocabulary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9971" target="_blank">02:46:11.760</a></span> | <span class="t">So the target tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9975" target="_blank">02:46:15.560</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9979" target="_blank">02:46:19.560</a></span> | <span class="t">So let's just infer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9990" target="_blank">02:46:30.800</a></span> | <span class="t">using our greedy decode algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9996" target="_blank">02:46:36.800</a></span> | <span class="t">So we provide the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=9998" target="_blank">02:46:38.520</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10025" target="_blank">02:47:05.000</a></span> | <span class="t">We return all this information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10027" target="_blank">02:47:07.520</a></span> | <span class="t">(keyboard clicking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10030" target="_blank">02:47:10.520</a></span> | <span class="t">Okay, now I will build the necessary functions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10038" target="_blank">02:47:18.520</a></span> | <span class="t">to visualize the attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10043" target="_blank">02:47:23.440</a></span> | <span class="t">I will copy some functions from another file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10045" target="_blank">02:47:25.480</a></span> | <span class="t">because actually what we are going to build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10047" target="_blank">02:47:27.520</a></span> | <span class="t">is nothing interesting from a learning point of view</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10051" target="_blank">02:47:31.480</a></span> | <span class="t">with regards to the deep learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10053" target="_blank">02:47:33.720</a></span> | <span class="t">It's mostly functions to visualize the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10056" target="_blank">02:47:36.240</a></span> | <span class="t">So I will copy it because it's quite long to write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10059" target="_blank">02:47:39.040</a></span> | <span class="t">and the salient part I will explain, of course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10062" target="_blank">02:47:42.280</a></span> | <span class="t">And this is the function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10064" target="_blank">02:47:44.160</a></span> | <span class="t">Okay, what does this function do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10066" target="_blank">02:47:46.600</a></span> | <span class="t">Basically, we have the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10068" target="_blank">02:47:48.680</a></span> | <span class="t">that we will get from the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10070" target="_blank">02:47:50.440</a></span> | <span class="t">How to get the attention from the encoder?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10073" target="_blank">02:47:53.120</a></span> | <span class="t">For example, the attention we have in three positions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10075" target="_blank">02:47:55.800</a></span> | <span class="t">First is in the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10077" target="_blank">02:47:57.120</a></span> | <span class="t">The second one is in the decoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10079" target="_blank">02:47:59.200</a></span> | <span class="t">at the beginning of the decoder,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10080" target="_blank">02:48:00.560</a></span> | <span class="t">so the self-attention of the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10082" target="_blank">02:48:02.400</a></span> | <span class="t">And then we have the cross-attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10084" target="_blank">02:48:04.160</a></span> | <span class="t">between the encoder and the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10086" target="_blank">02:48:06.360</a></span> | <span class="t">So we can visualize three type of attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10089" target="_blank">02:48:09.000</a></span> | <span class="t">How to get the information about the attention?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10091" target="_blank">02:48:11.560</a></span> | <span class="t">Well, we load the other model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10093" target="_blank">02:48:13.600</a></span> | <span class="t">We have the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10094" target="_blank">02:48:14.800</a></span> | <span class="t">We choose which layer we want to get the attention from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10098" target="_blank">02:48:18.400</a></span> | <span class="t">And then from each layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10099" target="_blank">02:48:19.400</a></span> | <span class="t">we can get the self-attention block</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10101" target="_blank">02:48:21.880</a></span> | <span class="t">and then its attention scores.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10103" target="_blank">02:48:23.720</a></span> | <span class="t">How do, where does this variable come from?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10108" target="_blank">02:48:28.000</a></span> | <span class="t">If you remember when we defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10109" target="_blank">02:48:29.720</a></span> | <span class="t">the attention calculation here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10112" target="_blank">02:48:32.240</a></span> | <span class="t">here, when we calculate the attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10116" target="_blank">02:48:36.960</a></span> | <span class="t">we not only return the output to the next layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10120" target="_blank">02:48:40.680</a></span> | <span class="t">we also give this attention scores,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10122" target="_blank">02:48:42.680</a></span> | <span class="t">which is the output of the softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10125" target="_blank">02:48:45.640</a></span> | <span class="t">And we save it here in this variable,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10129" target="_blank">02:48:49.560</a></span> | <span class="t">self.attentionscores.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10131" target="_blank">02:48:51.200</a></span> | <span class="t">Now we can just retrieve it and visualize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10135" target="_blank">02:48:55.720</a></span> | <span class="t">So this function will,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10138" target="_blank">02:48:58.080</a></span> | <span class="t">based on which attention we want to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10140" target="_blank">02:49:00.320</a></span> | <span class="t">from which layer and from which head,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10142" target="_blank">02:49:02.120</a></span> | <span class="t">will select the matrix, the correct matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10146" target="_blank">02:49:06.440</a></span> | <span class="t">This function builds a data frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10149" target="_blank">02:49:09.400</a></span> | <span class="t">to visualize the information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10151" target="_blank">02:49:11.400</a></span> | <span class="t">So the tokens and the score</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10154" target="_blank">02:49:14.400</a></span> | <span class="t">extracted from this matrix here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10156" target="_blank">02:49:16.640</a></span> | <span class="t">So it will, this matrix,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10158" target="_blank">02:49:18.280</a></span> | <span class="t">we extract the row and the column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10161" target="_blank">02:49:21.320</a></span> | <span class="t">And then we also build the chart.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10164" target="_blank">02:49:24.040</a></span> | <span class="t">The chart is built with Altair.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10167" target="_blank">02:49:27.600</a></span> | <span class="t">And what we will build, actually,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10169" target="_blank">02:49:29.760</a></span> | <span class="t">is we will get the attention for all the,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10173" target="_blank">02:49:33.920</a></span> | <span class="t">I built this method to get the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10177" target="_blank">02:49:37.560</a></span> | <span class="t">for all the heads and all the layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10180" target="_blank">02:49:40.000</a></span> | <span class="t">that we pass to this function as input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10183" target="_blank">02:49:43.840</a></span> | <span class="t">So let me run this cell now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10186" target="_blank">02:49:46.120</a></span> | <span class="t">Okay, let's create a new cell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10189" target="_blank">02:49:49.520</a></span> | <span class="t">And then let's just run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10191" target="_blank">02:49:51.320</a></span> | <span class="t">Okay, first we want to visualize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10193" target="_blank">02:49:53.200</a></span> | <span class="t">the sentence that we are dealing with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10195" target="_blank">02:49:55.320</a></span> | <span class="t">So the batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10197" target="_blank">02:49:57.200</a></span> | <span class="t">Order input tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10204" target="_blank">02:50:04.440</a></span> | <span class="t">So we load a batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10210" target="_blank">02:50:10.680</a></span> | <span class="t">And then we visualize what is the source and the target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10214" target="_blank">02:50:14.640</a></span> | <span class="t">(keys clacking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10217" target="_blank">02:50:17.320</a></span> | <span class="t">(keys clacking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10246" target="_blank">02:50:46.560</a></span> | <span class="t">And then also the target.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10248" target="_blank">02:50:48.640</a></span> | <span class="t">And finally we calculate also the length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10257" target="_blank">02:50:57.680</a></span> | <span class="t">What is the length?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10268" target="_blank">02:51:08.040</a></span> | <span class="t">Okay, it's basically all the characters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10270" target="_blank">02:51:10.400</a></span> | <span class="t">that come before the padding character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10272" target="_blank">02:51:12.440</a></span> | <span class="t">So the first occurrence of the padding character.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10275" target="_blank">02:51:15.000</a></span> | <span class="t">Because this is the batch taken from the dataset,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10277" target="_blank">02:51:17.320</a></span> | <span class="t">which is already the tensor built for training,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10279" target="_blank">02:51:19.680</a></span> | <span class="t">so they already include the padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10281" target="_blank">02:51:21.400</a></span> | <span class="t">In our case, we just want to retrieve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10283" target="_blank">02:51:23.000</a></span> | <span class="t">the number of actual characters in our sentence.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10286" target="_blank">02:51:26.880</a></span> | <span class="t">So this one, we can,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10288" target="_blank">02:51:28.280</a></span> | <span class="t">the number of actual words in our sentence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10290" target="_blank">02:51:30.600</a></span> | <span class="t">so we can check the number of words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10292" target="_blank">02:51:32.560</a></span> | <span class="t">that come before padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10294" target="_blank">02:51:34.000</a></span> | <span class="t">So let's run this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10297" target="_blank">02:51:37.120</a></span> | <span class="t">And there is some problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10299" target="_blank">02:51:39.120</a></span> | <span class="t">(keys clacking)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10301" target="_blank">02:51:41.800</a></span> | <span class="t">Ah, here I forgot to,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10308" target="_blank">02:51:48.680</a></span> | <span class="t">this function was wrong, so now it should work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10314" target="_blank">02:51:54.120</a></span> | <span class="t">Okay, this sentence is too small, let's get a longer one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10317" target="_blank">02:51:57.560</a></span> | <span class="t">Okay, let me check the quality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10320" target="_blank">02:52:00.920</a></span> | <span class="t">You cannot remain as you are, especially you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10323" target="_blank">02:52:03.240</a></span> | <span class="t">(speaking in foreign language)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10326" target="_blank">02:52:06.240</a></span> | <span class="t">Okay, looks not bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10328" target="_blank">02:52:08.920</a></span> | <span class="t">Okay, let's print the attention for the layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10331" target="_blank">02:52:11.800</a></span> | <span class="t">let's say, zero, one, and two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10334" target="_blank">02:52:14.680</a></span> | <span class="t">Because we have six of them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10335" target="_blank">02:52:15.960</a></span> | <span class="t">if you remember, the parameter is n is equal to six.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10339" target="_blank">02:52:19.520</a></span> | <span class="t">So we will just visualize three layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10342" target="_blank">02:52:22.440</a></span> | <span class="t">And we will visualize all the heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10344" target="_blank">02:52:24.840</a></span> | <span class="t">We have eight of them for each layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10347" target="_blank">02:52:27.080</a></span> | <span class="t">So the head number zero,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10348" target="_blank">02:52:28.320</a></span> | <span class="t">one, two, three, four, five, six, seven, and seven.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10351" target="_blank">02:52:31.860</a></span> | <span class="t">Okay, let's first visualize the encoder self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10358" target="_blank">02:52:38.800</a></span> | <span class="t">And we do get all attention maps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10361" target="_blank">02:52:41.440</a></span> | <span class="t">Which one we want?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10362" target="_blank">02:52:42.400</a></span> | <span class="t">So the encoder one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10364" target="_blank">02:52:44.520</a></span> | <span class="t">And we want these layers and these heads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10368" target="_blank">02:52:48.160</a></span> | <span class="t">And what are the row tokens?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10369" target="_blank">02:52:49.840</a></span> | <span class="t">The encoder input tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10372" target="_blank">02:52:52.600</a></span> | <span class="t">And what do we want in the column?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10375" target="_blank">02:52:55.580</a></span> | <span class="t">Because we are gonna build a grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10377" target="_blank">02:52:57.320</a></span> | <span class="t">So as you know, the attention is a grid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10381" target="_blank">02:53:01.680</a></span> | <span class="t">that correlates rows with columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10384" target="_blank">02:53:04.000</a></span> | <span class="t">In our case, we are talking about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10385" target="_blank">02:53:05.600</a></span> | <span class="t">the self-attention of the encoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10387" target="_blank">02:53:07.040</a></span> | <span class="t">So it's the same sentence that is attending itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10391" target="_blank">02:53:11.160</a></span> | <span class="t">So we need to provide the input sentence of the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10394" target="_blank">02:53:14.760</a></span> | <span class="t">on both the rows and the columns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10397" target="_blank">02:53:17.360</a></span> | <span class="t">And what is the maximum number of length</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10399" target="_blank">02:53:19.380</a></span> | <span class="t">that we want to visualize?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10401" target="_blank">02:53:21.120</a></span> | <span class="t">Okay, let's say we want to visualize no more than 20.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10404" target="_blank">02:53:24.000</a></span> | <span class="t">So the minimum of 20 and sentence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10407" target="_blank">02:53:27.240</a></span> | <span class="t">Okay, this is our visualization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10412" target="_blank">02:53:32.780</a></span> | <span class="t">We can see, and as we expected, actually,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10416" target="_blank">02:53:36.920</a></span> | <span class="t">when we visualize the attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10418" target="_blank">02:53:38.260</a></span> | <span class="t">we expect the values along the diagonals to be high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10422" target="_blank">02:53:42.280</a></span> | <span class="t">because it's the dot product of each token with itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10425" target="_blank">02:53:45.880</a></span> | <span class="t">And we can see also that there are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10428" target="_blank">02:53:48.800</a></span> | <span class="t">other interesting relationship.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10430" target="_blank">02:53:50.160</a></span> | <span class="t">For example, we see that the start of sentence token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10433" target="_blank">02:53:53.520</a></span> | <span class="t">and the end of sentence token,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10434" target="_blank">02:53:54.840</a></span> | <span class="t">at least for the head zero and the layer zero,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10437" target="_blank">02:53:57.640</a></span> | <span class="t">they are not related to other words,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10439" target="_blank">02:53:59.880</a></span> | <span class="t">like I would expect, actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10442" target="_blank">02:54:02.880</a></span> | <span class="t">But other heads, they do learn some very small mapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10447" target="_blank">02:54:07.640</a></span> | <span class="t">If we hover over each of the grid cells,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10450" target="_blank">02:54:10.840</a></span> | <span class="t">we can see the actual value of the self-attention,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10454" target="_blank">02:54:14.320</a></span> | <span class="t">so the score of the self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10456" target="_blank">02:54:16.360</a></span> | <span class="t">For example, we can see the attention is very strong here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10459" target="_blank">02:54:19.480</a></span> | <span class="t">so the word especially and specially are related,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10463" target="_blank">02:54:23.100</a></span> | <span class="t">so it's the same word with itself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10464" target="_blank">02:54:24.980</a></span> | <span class="t">but also especially and now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10468" target="_blank">02:54:28.280</a></span> | <span class="t">And we can visualize this kind of attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10471" target="_blank">02:54:31.560</a></span> | <span class="t">for all the layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10472" target="_blank">02:54:32.520</a></span> | <span class="t">So because each head will watch different aspect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10477" target="_blank">02:54:37.520</a></span> | <span class="t">of each word because we are distributing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10479" target="_blank">02:54:39.760</a></span> | <span class="t">the word embedding among the heads equally,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10482" target="_blank">02:54:42.760</a></span> | <span class="t">so each head will see a different part</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10485" target="_blank">02:54:45.720</a></span> | <span class="t">of the embedding of the word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10487" target="_blank">02:54:47.360</a></span> | <span class="t">We also hope that they learn different kind of mapping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10491" target="_blank">02:54:51.300</a></span> | <span class="t">between the words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10492" target="_blank">02:54:52.160</a></span> | <span class="t">And this is actually the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10494" target="_blank">02:54:54.760</a></span> | <span class="t">And between one layer and the next,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10497" target="_blank">02:54:57.360</a></span> | <span class="t">we also have different WQ, WK, and WV metrics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10501" target="_blank">02:55:01.880</a></span> | <span class="t">So they should also learn different relationships.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10506" target="_blank">02:55:06.560</a></span> | <span class="t">Now we can also want, we may also want to visualize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10509" target="_blank">02:55:09.520</a></span> | <span class="t">the attention of the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10512" target="_blank">02:55:12.260</a></span> | <span class="t">So let's do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10513" target="_blank">02:55:13.960</a></span> | <span class="t">Let me just copy the code and just change the parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10531" target="_blank">02:55:31.520</a></span> | <span class="t">Okay, here we want the decoder one,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10534" target="_blank">02:55:34.080</a></span> | <span class="t">we want the same layers, et cetera,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10536" target="_blank">02:55:36.100</a></span> | <span class="t">but the tokens that will be on the rows and the columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10541" target="_blank">02:55:41.040</a></span> | <span class="t">are the decoder tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10543" target="_blank">02:55:43.160</a></span> | <span class="t">So decoder input tokens and decoder input tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10546" target="_blank">02:55:46.480</a></span> | <span class="t">Let's visualize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10548" target="_blank">02:55:48.120</a></span> | <span class="t">And also we should see Italian language now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10550" target="_blank">02:55:50.600</a></span> | <span class="t">because we are using the decoder self-attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10553" target="_blank">02:55:53.480</a></span> | <span class="t">And it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10555" target="_blank">02:55:55.160</a></span> | <span class="t">So here we see a different kind of attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10557" target="_blank">02:55:57.840</a></span> | <span class="t">on the decoder side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10559" target="_blank">02:55:59.720</a></span> | <span class="t">And also here we have multiple heads</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10562" target="_blank">02:56:02.560</a></span> | <span class="t">that should learn different mapping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10564" target="_blank">02:56:04.320</a></span> | <span class="t">and also different layers should learn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10566" target="_blank">02:56:06.020</a></span> | <span class="t">different mappings between words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10567" target="_blank">02:56:07.720</a></span> | <span class="t">The one I find most interesting is the cross attention.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10571" target="_blank">02:56:11.840</a></span> | <span class="t">So let's have a look at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10573" target="_blank">02:56:13.320</a></span> | <span class="t">Okay, let me just copy the code and run it again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10586" target="_blank">02:56:26.080</a></span> | <span class="t">Okay, so if you remember the method,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10589" target="_blank">02:56:29.120</a></span> | <span class="t">it's encoder, decoder, same layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10592" target="_blank">02:56:32.520</a></span> | <span class="t">So here on the rows we will show the encoder input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10596" target="_blank">02:56:36.960</a></span> | <span class="t">and on the columns we will show the decoder input tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10600" target="_blank">02:56:40.120</a></span> | <span class="t">because it's a cross attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10601" target="_blank">02:56:41.520</a></span> | <span class="t">between the encoder and the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10603" target="_blank">02:56:43.280</a></span> | <span class="t">Okay, this is more or less how the interaction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10610" target="_blank">02:56:50.880</a></span> | <span class="t">between the encoder and the decoder works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10615" target="_blank">02:56:55.240</a></span> | <span class="t">and how it happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10616" target="_blank">02:56:56.960</a></span> | <span class="t">So this is where we find the cross attention calculated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10621" target="_blank">02:57:01.960</a></span> | <span class="t">using the keys and the values coming from the encoder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10627" target="_blank">02:57:07.160</a></span> | <span class="t">while the query is coming from the decoder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10629" target="_blank">02:57:09.600</a></span> | <span class="t">So this is actually where the translation task happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10634" target="_blank">02:57:14.480</a></span> | <span class="t">And this is how the model learns to relate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10639" target="_blank">02:57:19.480</a></span> | <span class="t">these two sentences to each other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10641" target="_blank">02:57:21.840</a></span> | <span class="t">to actually calculate the translation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10644" target="_blank">02:57:24.880</a></span> | <span class="t">So I invite you guys to run the code by yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10649" target="_blank">02:57:29.520</a></span> | <span class="t">So the first suggestion I give you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10651" target="_blank">02:57:31.160</a></span> | <span class="t">is to write the code along with me with the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10655" target="_blank">02:57:35.040</a></span> | <span class="t">You can pause the video, you can write the code by yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10659" target="_blank">02:57:39.800</a></span> | <span class="t">Okay, let me give you some practical examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10662" target="_blank">02:57:42.400</a></span> | <span class="t">For example, when I'm writing the model code,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10665" target="_blank">02:57:45.120</a></span> | <span class="t">I suggest you watch me write the code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10668" target="_blank">02:57:48.440</a></span> | <span class="t">for one particular layer and then stop the video,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10672" target="_blank">02:57:52.680</a></span> | <span class="t">write it by yourself, take some time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10675" target="_blank">02:57:55.040</a></span> | <span class="t">Don't watch the solution right away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10677" target="_blank">02:57:57.440</a></span> | <span class="t">Try to figure out what is going wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10679" target="_blank">02:57:59.920</a></span> | <span class="t">And if you really cannot, after one, two minutes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10682" target="_blank">02:58:02.440</a></span> | <span class="t">you cannot really figure out what is the problem,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10684" target="_blank">02:58:04.440</a></span> | <span class="t">you can have a glimpse at the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10686" target="_blank">02:58:06.160</a></span> | <span class="t">But try to do it by yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10688" target="_blank">02:58:08.200</a></span> | <span class="t">Some things, of course, you cannot come up by yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10691" target="_blank">02:58:11.120</a></span> | <span class="t">So for example, for the positional encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10693" target="_blank">02:58:13.000</a></span> | <span class="t">and all this calculation,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10694" target="_blank">02:58:14.200</a></span> | <span class="t">it's basically just an application of formulas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10697" target="_blank">02:58:17.920</a></span> | <span class="t">But the point is you should at least be able</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10700" target="_blank">02:58:20.480</a></span> | <span class="t">to come with a structure by yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10702" target="_blank">02:58:22.320</a></span> | <span class="t">So how all the layers are interacting with each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10706" target="_blank">02:58:26.360</a></span> | <span class="t">This is my first recommendation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10708" target="_blank">02:58:28.280</a></span> | <span class="t">And while about the training loop,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10710" target="_blank">02:58:30.440</a></span> | <span class="t">the training part actually is quite standard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10713" target="_blank">02:58:33.800</a></span> | <span class="t">So it's very similar to other training loops</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10717" target="_blank">02:58:37.440</a></span> | <span class="t">that you may have seen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10718" target="_blank">02:58:38.840</a></span> | <span class="t">The interesting part is how we calculate the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10723" target="_blank">02:58:43.160</a></span> | <span class="t">and how we use the transformer model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10726" target="_blank">02:58:46.120</a></span> | <span class="t">And the last thing that is really important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10728" target="_blank">02:58:48.640</a></span> | <span class="t">is how we inference the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10730" target="_blank">02:58:50.480</a></span> | <span class="t">which is in this greedy decode.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10732" target="_blank">02:58:52.800</a></span> | <span class="t">So thank you everyone for watching the video</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10735" target="_blank">02:58:55.280</a></span> | <span class="t">and for staying with me for so long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10737" target="_blank">02:58:57.480</a></span> | <span class="t">I can assure you that it was worth it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10739" target="_blank">02:58:59.760</a></span> | <span class="t">And I hope in the next videos to make more examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10744" target="_blank">02:59:04.680</a></span> | <span class="t">of transformers and other models that I am familiar with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10749" target="_blank">02:59:09.160</a></span> | <span class="t">and I also want to explore with you guys.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10751" target="_blank">02:59:11.640</a></span> | <span class="t">So let me know if there is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10753" target="_blank">02:59:13.320</a></span> | <span class="t">that you don't understand or you want me to explain better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10756" target="_blank">02:59:16.960</a></span> | <span class="t">I will also for sure follow the comment section.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10760" target="_blank">02:59:20.280</a></span> | <span class="t">and please write me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=ISNdQcPhsts&t=10761" target="_blank">02:59:21.800</a></span> | <span class="t">Thank you and have a nice day.</span></div></div></body></html>