<html><head><title>Lesson 10 (2019) - Looking inside the model</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 10 (2019) - Looking inside the model</h2><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U"><img src="https://i.ytimg.com/vi_webp/HR0lt1hlR6U/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=21">0:21</a> Dont worry<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=128">2:8</a> Where are we<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=169">2:49</a> Training loop<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=266">4:26</a> Faster Audio<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=345">5:45</a> Vision Topics<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=432">7:12</a> What is a callback<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=680">11:20</a> Creating a callback<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=811">13:31</a> lambda notation<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1043">17:23</a> partial function application<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1105">18:25</a> class as a callback<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1193">19:53</a> kwargs<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1453">24:13</a> change<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1642">27:22</a> dunder<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1774">29:34</a> editor tips<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2121">35:21</a> variance<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2415">40:15</a> covariance<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2699">44:59</a> softmax<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3164">52:44</a> learning rate finder<br><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3274">54:34</a> refactoring<br><br><div style="text-align: left;"><a href="./HR0lt1hlR6U.html">Whisper Transcript</a> | <a href="./transcript_HR0lt1hlR6U.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Welcome to lesson 10, which I've rather enthusiastically titled wrapping up our CNN, but looking at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=10" target="_blank">00:00:10.020</a></span> | <span class="t">how many things we want to cover, I've added a nearly to the end and I'm not actually sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=14" target="_blank">00:00:14.800</a></span> | <span class="t">how nearly we'll get there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=15" target="_blank">00:00:15.880</a></span> | <span class="t">We'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=16" target="_blank">00:00:16.880</a></span> | <span class="t">We'll probably have a few more things to cover next week as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=22" target="_blank">00:00:22.680</a></span> | <span class="t">I just wanted to remind you after hearing from a few folks during the week who are very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=28" target="_blank">00:00:28.200</a></span> | <span class="t">sad that they're not quite keeping up with everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=31" target="_blank">00:00:31.680</a></span> | <span class="t">That's totally okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=33" target="_blank">00:00:33.280</a></span> | <span class="t">Don't worry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=34" target="_blank">00:00:34.480</a></span> | <span class="t">As I mentioned in lesson one, I'm trying to give you enough here to keep you busy until</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=39" target="_blank">00:00:39.920</a></span> | <span class="t">the next part to next year.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=44" target="_blank">00:00:44.780</a></span> | <span class="t">So you can dive into the bits you're interested in and go back and look over stuff and yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=52" target="_blank">00:00:52.200</a></span> | <span class="t">don't feel like you have to understand everything within within a week of first hearing it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=57" target="_blank">00:00:57.580</a></span> | <span class="t">But also if you're not putting in the time during the homework or you didn't put in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=62" target="_blank">00:01:02.440</a></span> | <span class="t">time during the homework in the last part, you know, expect to have to go back and recover</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=67" target="_blank">00:01:07.160</a></span> | <span class="t">things particularly because a lot of the stuff we covered in part one, I'm kind of assuming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=71" target="_blank">00:01:11.880</a></span> | <span class="t">that you're deeply comfortable with at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=76" target="_blank">00:01:16.100</a></span> | <span class="t">Not because you're stupid if you're not, but just because it gives you the opportunity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=80" target="_blank">00:01:20.000</a></span> | <span class="t">to go back and re-study it and practice and experiment until you are deeply comfortable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=86" target="_blank">00:01:26.320</a></span> | <span class="t">So yeah, if you're finding it whizzing along at a pace, that is because it is whizzing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=91" target="_blank">00:01:31.680</a></span> | <span class="t">along at a pace.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=92" target="_blank">00:01:32.880</a></span> | <span class="t">Also it's covering a lot of more software engineering kind of stuff, which for the people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=98" target="_blank">00:01:38.720</a></span> | <span class="t">who are practicing software engineers, you'll be thinking this is all pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=102" target="_blank">00:01:42.640</a></span> | <span class="t">And for those of you that are not, you'll be thinking, wow, there's a lot here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=107" target="_blank">00:01:47.880</a></span> | <span class="t">Part of that is because I think data scientists need to be good software engineers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=112" target="_blank">00:01:52.080</a></span> | <span class="t">So I'm trying to show you some of these things, but, you know, it's stuff which people can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=116" target="_blank">00:01:56.360</a></span> | <span class="t">spend years learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=118" target="_blank">00:01:58.420</a></span> | <span class="t">And so hopefully this is the start of a long process for you that haven't done software</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=122" target="_blank">00:02:02.520</a></span> | <span class="t">engineering before of becoming better software engineers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=125" target="_blank">00:02:05.160</a></span> | <span class="t">And there are some useful tips, hopefully.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=129" target="_blank">00:02:09.200</a></span> | <span class="t">So to remind you, we're trying to recreate fast AI and much of PyTorch from these foundations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=141" target="_blank">00:02:21.280</a></span> | <span class="t">And starting to make things even better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=144" target="_blank">00:02:24.600</a></span> | <span class="t">And today you'll actually see some bits, well, in fact, you've already seen some bits that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=148" target="_blank">00:02:28.000</a></span> | <span class="t">are going to be even better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=149" target="_blank">00:02:29.800</a></span> | <span class="t">I think the next version of fast AI will have this new callback system, which I think is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=153" target="_blank">00:02:33.120</a></span> | <span class="t">better than the old one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=154" target="_blank">00:02:34.480</a></span> | <span class="t">And today we're going to be showing you some new previously unpublished research, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=159" target="_blank">00:02:39.400</a></span> | <span class="t">will be finding its way into fast AI and maybe other libraries as well also.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=165" target="_blank">00:02:45.680</a></span> | <span class="t">So we're going to try and stick to, and we will stick to, using nothing but these foundations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=171" target="_blank">00:02:51.100</a></span> | <span class="t">And we're working through developing a modern CNN model, and we've got to the point where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=175" target="_blank">00:02:55.180</a></span> | <span class="t">we've done our training loop at this point, and we've got a nice flexible training loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=181" target="_blank">00:03:01.960</a></span> | <span class="t">So from here, the rest of it, when I say we're going to finish out a modern CNN model, it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=189" target="_blank">00:03:09.320</a></span> | <span class="t">not just going to be some basic getting by model, but we're actually going to endeavor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=193" target="_blank">00:03:13.660</a></span> | <span class="t">to get something that is approximately state-of-the-art on ImageNet in the next week or two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=200" target="_blank">00:03:20.160</a></span> | <span class="t">So that's the goal.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=202" target="_blank">00:03:22.840</a></span> | <span class="t">And in our testing at this point, we're feeling pretty good about showing you some stuff that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=209" target="_blank">00:03:29.080</a></span> | <span class="t">maybe hasn't been seen before on ImageNet results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=212" target="_blank">00:03:32.960</a></span> | <span class="t">So that's where we're going to try and head as a group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=216" target="_blank">00:03:36.200</a></span> | <span class="t">And so these are some of the things that we're going to be covering to get there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=223" target="_blank">00:03:43.700</a></span> | <span class="t">One of the things you might not have seen before in this section called optimization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=226" target="_blank">00:03:46.560</a></span> | <span class="t">is LAM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=228" target="_blank">00:03:48.480</a></span> | <span class="t">The reason for this is that this was going to be some of the unpublished research we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=231" target="_blank">00:03:51.520</a></span> | <span class="t">were going to show you, which is a new optimization algorithm that we've been developing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=236" target="_blank">00:03:56.960</a></span> | <span class="t">The framework is still going to be new, but actually the particular approach to using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=241" target="_blank">00:04:01.260</a></span> | <span class="t">it was published by Google two days ago, so we've kind of been scooped there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=247" target="_blank">00:04:07.000</a></span> | <span class="t">So this is a cool paper, really great, and they introduce a new optimization algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=251" target="_blank">00:04:11.640</a></span> | <span class="t">called LAM, which we'll be showing you how to implement it very easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=258" target="_blank">00:04:18.600</a></span> | <span class="t">And if you're wondering how we're able to do that so fast, it's because we've kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=261" target="_blank">00:04:21.520</a></span> | <span class="t">been working on the same thing ourselves for a few weeks now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=266" target="_blank">00:04:26.880</a></span> | <span class="t">So then from next week, we'll start also developing a completely new fast.ai module called fastai.audio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=276" target="_blank">00:04:36.000</a></span> | <span class="t">So you'll be seeing how to actually create modules and how to write Jupyter documentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=279" target="_blank">00:04:39.760</a></span> | <span class="t">and tests.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=281" target="_blank">00:04:41.240</a></span> | <span class="t">And we're going to be learning about audio, such as complex numbers and Fourier transforms,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=285" target="_blank">00:04:45.480</a></span> | <span class="t">which if you're like me at this point, you're going, oh, what, no, because I managed to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=290" target="_blank">00:04:50.840</a></span> | <span class="t">spend my life avoiding complex numbers and Fourier transforms on the whole.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=294" target="_blank">00:04:54.920</a></span> | <span class="t">But don't worry, it'll be OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=298" target="_blank">00:04:58.680</a></span> | <span class="t">It's actually not at all bad, or at least the bits we need to learn about are not at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=302" target="_blank">00:05:02.000</a></span> | <span class="t">all bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=303" target="_blank">00:05:03.000</a></span> | <span class="t">And you'll totally get it even if you've never ever touched these before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=306" target="_blank">00:05:06.920</a></span> | <span class="t">We'll be learning about audio formats and spectrograms, doing data augmentation and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=312" target="_blank">00:05:12.560</a></span> | <span class="t">things that aren't images, and some particular kinds of loss functions and architectures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=317" target="_blank">00:05:17.280</a></span> | <span class="t">for audio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=319" target="_blank">00:05:19.800</a></span> | <span class="t">And as much as anything, it'll just be a great kind of exercise in, OK, I've got some different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=324" target="_blank">00:05:24.100</a></span> | <span class="t">data type that's not in fastai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=326" target="_blank">00:05:26.100</a></span> | <span class="t">How do I build up all the bits I need to make it work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=331" target="_blank">00:05:31.000</a></span> | <span class="t">Then we'll be looking at neural translation as a way to learn about sequence to sequence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=334" target="_blank">00:05:34.620</a></span> | <span class="t">with attention models, and then we'll be going deeper and deeper into attention models, looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=338" target="_blank">00:05:38.460</a></span> | <span class="t">at transformer, and it's even more fantastic, descendant, transformer, Excel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=346" target="_blank">00:05:46.840</a></span> | <span class="t">And then we'll wrap up our Python adventures with a deep dive into some really interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=351" target="_blank">00:05:51.640</a></span> | <span class="t">vision topics, which is going to require building some bigger models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=356" target="_blank">00:05:56.520</a></span> | <span class="t">So we'll talk about how to build your own deep learning box, how to run big experiments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=360" target="_blank">00:06:00.520</a></span> | <span class="t">on AWS with a new library we've developed called Fast EC2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=366" target="_blank">00:06:06.560</a></span> | <span class="t">And then we're going to see exactly what happened last course when we did that unit super resolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=371" target="_blank">00:06:11.240</a></span> | <span class="t">image generation, what are some of the pieces there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=375" target="_blank">00:06:15.100</a></span> | <span class="t">And we've actually got some really exciting new results to show you, which have been done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=378" target="_blank">00:06:18.920</a></span> | <span class="t">in collaboration with some really cool partners.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=381" target="_blank">00:06:21.140</a></span> | <span class="t">So I'm looking forward to showing you that to give you a tip.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=385" target="_blank">00:06:25.240</a></span> | <span class="t">Generative video models is what we're going to be looking at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=388" target="_blank">00:06:28.720</a></span> | <span class="t">And then we'll be looking at some interesting different applications, device, cycleGAN,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=393" target="_blank">00:06:33.520</a></span> | <span class="t">and object detection.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=396" target="_blank">00:06:36.320</a></span> | <span class="t">And then Swift, of course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=400" target="_blank">00:06:40.960</a></span> | <span class="t">So the Swift lessons are coming together nicely, really excited about them, and we'll be covering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=408" target="_blank">00:06:48.400</a></span> | <span class="t">as much of the same territory as we can, but obviously it'll be in Swift and it'll be in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=412" target="_blank">00:06:52.060</a></span> | <span class="t">only two lessons, so it won't be everything, but we'll try to give you enough of a taste</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=417" target="_blank">00:06:57.320</a></span> | <span class="t">that you'll feel like you understand why Swift is important and how to get started with building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=423" target="_blank">00:07:03.560</a></span> | <span class="t">something similar in Swift.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=425" target="_blank">00:07:05.320</a></span> | <span class="t">And maybe building out the whole thing in Swift will take the next 12 months.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=429" target="_blank">00:07:09.560</a></span> | <span class="t">Who knows?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=430" target="_blank">00:07:10.560</a></span> | <span class="t">We'll see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=433" target="_blank">00:07:13.920</a></span> | <span class="t">So we're going to start today on zero 5A foundations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=439" target="_blank">00:07:19.880</a></span> | <span class="t">And what we're going to do is we're going to recover some of the software engineering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=443" target="_blank">00:07:23.680</a></span> | <span class="t">and math basics that we were relying on last week and going into a little bit more detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=448" target="_blank">00:07:28.760</a></span> | <span class="t">Specifically, we'll be looking at callbacks and variants and a couple of other Python concepts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=455" target="_blank">00:07:35.840</a></span> | <span class="t">like Dunder special methods.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=458" target="_blank">00:07:38.420</a></span> | <span class="t">If you're familiar with those things, feel free to skip ahead if you're watching the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=461" target="_blank">00:07:41.320</a></span> | <span class="t">video till we get to the new material.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=464" target="_blank">00:07:44.440</a></span> | <span class="t">Callbacks, as I'm sure you've seen, are super important for fast AI, and in general they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=470" target="_blank">00:07:50.520</a></span> | <span class="t">a really useful technique for software engineering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=475" target="_blank">00:07:55.040</a></span> | <span class="t">And great for researchers because they allow you to build things that you can quickly adjust</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=479" target="_blank">00:07:59.800</a></span> | <span class="t">and add things in and pull them out again, so really great for research as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=484" target="_blank">00:08:04.320</a></span> | <span class="t">So what is a callback?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=486" target="_blank">00:08:06.360</a></span> | <span class="t">Let's look at an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=490" target="_blank">00:08:10.120</a></span> | <span class="t">So here's a function called f, which prints out hi.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=494" target="_blank">00:08:14.760</a></span> | <span class="t">And I'm going to create a button, and I'm going to create this button using IPY widgets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=501" target="_blank">00:08:21.400</a></span> | <span class="t">which is a framework for creating GUI widgets in Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=506" target="_blank">00:08:26.160</a></span> | <span class="t">So if I run, if I say W, then it shows me a button, which says click B, and I can click</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=514" target="_blank">00:08:34.200</a></span> | <span class="t">on it, and nothing happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=517" target="_blank">00:08:37.720</a></span> | <span class="t">So how do I get something to happen?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=519" target="_blank">00:08:39.160</a></span> | <span class="t">Well, what I need to do is I need to pass a function to the IPY widgets framework to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=527" target="_blank">00:08:47.120</a></span> | <span class="t">say please run this function when you click on this button.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=532" target="_blank">00:08:52.360</a></span> | <span class="t">So IPY widget doc says that there's an onclick method which can register a function to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=539" target="_blank">00:08:59.040</a></span> | <span class="t">called when the button is clicked.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=541" target="_blank">00:09:01.080</a></span> | <span class="t">So let's try running that method, passing it f, my function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=546" target="_blank">00:09:06.560</a></span> | <span class="t">OK, so now nothing happened, didn't run anything, but now if I click on here-- oh, hi, hi.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=556" target="_blank">00:09:16.640</a></span> | <span class="t">So what happened is I told W that when a click occurs, you should call back to my f function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=569" target="_blank">00:09:29.080</a></span> | <span class="t">and run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=570" target="_blank">00:09:30.080</a></span> | <span class="t">So anybody who's done GUI programming will be extremely comfortable with this idea, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=574" target="_blank">00:09:34.280</a></span> | <span class="t">if you haven't, this will be kind of mind bending.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=577" target="_blank">00:09:37.800</a></span> | <span class="t">So f is a callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=580" target="_blank">00:09:40.620</a></span> | <span class="t">It's not a particular class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=582" target="_blank">00:09:42.400</a></span> | <span class="t">It doesn't have a particular signature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=584" target="_blank">00:09:44.120</a></span> | <span class="t">It's not a particular library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=585" target="_blank">00:09:45.760</a></span> | <span class="t">It's a concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=587" target="_blank">00:09:47.680</a></span> | <span class="t">It's a function that we treat as an object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=591" target="_blank">00:09:51.200</a></span> | <span class="t">So look, we're not calling the function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=593" target="_blank">00:09:53.480</a></span> | <span class="t">We don't have any parentheses after f.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=595" target="_blank">00:09:55.120</a></span> | <span class="t">We're passing the function itself to this method, and it says please call back to me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=603" target="_blank">00:10:03.120</a></span> | <span class="t">when something happens, and in this case, it's when I click.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=607" target="_blank">00:10:07.960</a></span> | <span class="t">So there's our starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=609" target="_blank">00:10:09.400</a></span> | <span class="t">And these kinds of functions, these kinds of callbacks that are used in a GUI in particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=616" target="_blank">00:10:16.520</a></span> | <span class="t">framework when some event happens are often called events.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=619" target="_blank">00:10:19.840</a></span> | <span class="t">So if you've heard of events, they're a kind of callback, and then callbacks are a kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=624" target="_blank">00:10:24.840</a></span> | <span class="t">of what we would call a function pointer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=626" target="_blank">00:10:26.800</a></span> | <span class="t">I mean, they can be much more general than that, as you'll see, but it's basically a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=630" target="_blank">00:10:30.520</a></span> | <span class="t">way of passing in something to say call back to this when something happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=634" target="_blank">00:10:34.800</a></span> | <span class="t">Now, by the way, these widgets are really worth looking at if you're interested in building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=641" target="_blank">00:10:41.720</a></span> | <span class="t">some analytical GUIs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=644" target="_blank">00:10:44.160</a></span> | <span class="t">Here's a great example from the Plotly documentation of the kinds of things you can create with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=650" target="_blank">00:10:50.960</a></span> | <span class="t">widgets, and it's not just for creating applications for others to use, but if you want to experiment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=656" target="_blank">00:10:56.000</a></span> | <span class="t">with different types of function or hyperparameters or explore some data you've collected, widgets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=664" target="_blank">00:11:04.720</a></span> | <span class="t">are a great way to do that, and as you can see, they're very, very easy to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=671" target="_blank">00:11:11.600</a></span> | <span class="t">In part one, you saw the image labeling stuff that was built with widgets like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=681" target="_blank">00:11:21.040</a></span> | <span class="t">So that's how you can use somebody else's callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=684" target="_blank">00:11:24.000</a></span> | <span class="t">Now to create our own callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=686" target="_blank">00:11:26.680</a></span> | <span class="t">So let's create a callback, and the event that it's going to call back on is after a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=692" target="_blank">00:11:32.200</a></span> | <span class="t">calculation is complete.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=694" target="_blank">00:11:34.840</a></span> | <span class="t">So let's create a function called slow_calculation, and it's going to do five calculations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=701" target="_blank">00:11:41.120</a></span> | <span class="t">It's going to add i squared to a result, and then it's going to take a second to do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=706" target="_blank">00:11:46.040</a></span> | <span class="t">because we're going to add a sleep there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=707" target="_blank">00:11:47.440</a></span> | <span class="t">So this is kind of something like an epoch of deep learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=711" target="_blank">00:11:51.160</a></span> | <span class="t">It's some calculation that takes a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=713" target="_blank">00:11:53.360</a></span> | <span class="t">So if we call slow_calculation, then it's going to take five seconds to calculate the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=719" target="_blank">00:11:59.880</a></span> | <span class="t">sum of i squared, and there it's done it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=722" target="_blank">00:12:02.200</a></span> | <span class="t">So I'd really like to know how's it going, get some progress.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=726" target="_blank">00:12:06.740</a></span> | <span class="t">So we could take that and we could add something that you pass in a callback, and we just add</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=734" target="_blank">00:12:14.080</a></span> | <span class="t">one line of code that says if there's a callback, then call it and pass in the epoch number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=741" target="_blank">00:12:21.880</a></span> | <span class="t">So then we could create a function called show_progress that prints out awesome.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=745" target="_blank">00:12:25.560</a></span> | <span class="t">We finished epoch number, epoch, and look, it takes a parameter and we're passing a parameter,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=751" target="_blank">00:12:31.840</a></span> | <span class="t">so therefore we could now call slow_calculation and pass in show_progress, and it will call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=759" target="_blank">00:12:39.920</a></span> | <span class="t">back to our function after each epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=763" target="_blank">00:12:43.680</a></span> | <span class="t">So there's our starting point for our callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=766" target="_blank">00:12:46.640</a></span> | <span class="t">Now, what will tend to happen, you'll notice with stuff that we do in fast.ai, we'll start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=772" target="_blank">00:12:52.840</a></span> | <span class="t">somewhere like this that's, for many of you, is trivially easy, and at some point during</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=778" target="_blank">00:12:58.440</a></span> | <span class="t">the next hour or two, you might reach a point where you're feeling totally lost.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=784" target="_blank">00:13:04.200</a></span> | <span class="t">And the trick is to go back, if you're watching the video, to the point where it was trivially</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=788" target="_blank">00:13:08.520</a></span> | <span class="t">easy and figure out the bit where you suddenly noticed you were totally lost, and find the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=792" target="_blank">00:13:12.200</a></span> | <span class="t">bit in the middle where you kind of missed a bit, because we're going to just keep building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=795" target="_blank">00:13:15.760</a></span> | <span class="t">up from trivially easy stuff, just like we did with that matrix multiplication, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=800" target="_blank">00:13:20.440</a></span> | <span class="t">So we're going to gradually build up from here and look at more and more interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=803" target="_blank">00:13:23.200</a></span> | <span class="t">callbacks, but we're starting with this wonderfully short and simple line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=812" target="_blank">00:13:32.560</a></span> | <span class="t">So rather than defining a function just for the purpose of using it once, we can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=818" target="_blank">00:13:38.560</a></span> | <span class="t">define the function at the point we use it using lambda notation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=823" target="_blank">00:13:43.000</a></span> | <span class="t">So lambda notation is just another way of creating a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=825" target="_blank">00:13:45.960</a></span> | <span class="t">So rather than saying def, we say lambda, and then rather than putting in parentheses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=830" target="_blank">00:13:50.640</a></span> | <span class="t">the arguments, we put them before a colon, and then we list the thing you want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=835" target="_blank">00:13:55.820</a></span> | <span class="t">So this is identical to the previous one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=839" target="_blank">00:13:59.280</a></span> | <span class="t">It's just a convenience for times where you want to define the callback at the same time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=845" target="_blank">00:14:05.080</a></span> | <span class="t">that you use it, can make your code a little bit more concise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=850" target="_blank">00:14:10.540</a></span> | <span class="t">What if you wanted to have something where you could define what exclamation to use in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=856" target="_blank">00:14:16.520</a></span> | <span class="t">the string as well?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=857" target="_blank">00:14:17.520</a></span> | <span class="t">So we've now got two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=860" target="_blank">00:14:20.060</a></span> | <span class="t">We can't pass this show progress to slow calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=866" target="_blank">00:14:26.000</a></span> | <span class="t">Let's try it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=868" target="_blank">00:14:28.700</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=871" target="_blank">00:14:31.680</a></span> | <span class="t">It tries to call back, and it calls, remember CB is now show progress, so it's passing show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=876" target="_blank">00:14:36.560</a></span> | <span class="t">progress and it's passing epoch as exclamation, and then epoch is missing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=881" target="_blank">00:14:41.480</a></span> | <span class="t">So that's an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=882" target="_blank">00:14:42.480</a></span> | <span class="t">We've called a function with two arguments with only one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=885" target="_blank">00:14:45.760</a></span> | <span class="t">So we have to convert this into a function with only one argument.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=889" target="_blank">00:14:49.960</a></span> | <span class="t">So lambda O is a function with only one argument, and this function calls show progress with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=896" target="_blank">00:14:56.500</a></span> | <span class="t">a particular exclamation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=899" target="_blank">00:14:59.720</a></span> | <span class="t">So we've converted something with two arguments into something with one argument.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=904" target="_blank">00:15:04.880</a></span> | <span class="t">We might want to make it really easy to allow people to create different progress indicators</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=908" target="_blank">00:15:08.920</a></span> | <span class="t">with different exclamations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=910" target="_blank">00:15:10.840</a></span> | <span class="t">So we could create a function called make show progress that returns that lambda.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=917" target="_blank">00:15:17.240</a></span> | <span class="t">So now we could say make show progress, so we could do that here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=926" target="_blank">00:15:26.360</a></span> | <span class="t">Make show progress.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=933" target="_blank">00:15:33.640</a></span> | <span class="t">And that's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=937" target="_blank">00:15:37.880</a></span> | <span class="t">This is a little bit awkward, so generally you might see it done like this instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=942" target="_blank">00:15:42.200</a></span> | <span class="t">You see this in fast AI all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=944" target="_blank">00:15:44.220</a></span> | <span class="t">We define the function inside it, but this is basically just the same as our lambda,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=951" target="_blank">00:15:51.080</a></span> | <span class="t">and then we return that function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=953" target="_blank">00:15:53.000</a></span> | <span class="t">So this is kind of interesting, because you might think of defining a function as being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=957" target="_blank">00:15:57.680</a></span> | <span class="t">like a declarative thing, that as soon as you define it, that now it's part of the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=962" target="_blank">00:16:02.200</a></span> | <span class="t">that's compiled, if you see your C++, that's how they work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=966" target="_blank">00:16:06.200</a></span> | <span class="t">In Python, that's not how they work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=968" target="_blank">00:16:08.020</a></span> | <span class="t">When you define a function, you're actually saying basically the same as this, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=973" target="_blank">00:16:13.800</a></span> | <span class="t">there's a variable with this name, which is a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=979" target="_blank">00:16:19.640</a></span> | <span class="t">And that's how come then we can actually take something that's passed to this function and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=985" target="_blank">00:16:25.440</a></span> | <span class="t">use it inside here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=987" target="_blank">00:16:27.480</a></span> | <span class="t">So this is actually, every time we call make show progress, it's going to create a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=992" target="_blank">00:16:32.160</a></span> | <span class="t">function, underscore inner internally, with a different exclamation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=997" target="_blank">00:16:37.440</a></span> | <span class="t">And so it'll work the same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1004" target="_blank">00:16:44.300</a></span> | <span class="t">So this thing where you create a function that actually stores some information from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1008" target="_blank">00:16:48.200</a></span> | <span class="t">the external context, and like it can be different every time, that's called a closure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1012" target="_blank">00:16:52.240</a></span> | <span class="t">So it's a concept you'll come across a lot, particularly if you're a JavaScript programmer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1017" target="_blank">00:16:57.300</a></span> | <span class="t">So we could say, f2 equals make show progress, terrific.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1029" target="_blank">00:17:09.600</a></span> | <span class="t">And so that now contains that closure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1033" target="_blank">00:17:13.640</a></span> | <span class="t">So it actually remembers what exclamation you passed it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1044" target="_blank">00:17:24.760</a></span> | <span class="t">Because it's so often that you want to take a function that takes two parameters and turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1050" target="_blank">00:17:30.360</a></span> | <span class="t">it into a function that takes one parameter, Python and most languages have a way to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1055" target="_blank">00:17:35.400</a></span> | <span class="t">that, which is called partial function application.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1059" target="_blank">00:17:39.160</a></span> | <span class="t">So the standard library functools has this thing called partial.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1062" target="_blank">00:17:42.480</a></span> | <span class="t">So if you take run call partial and you pass it a function, and then you pass in some arguments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1068" target="_blank">00:17:48.120</a></span> | <span class="t">for that function, it returns a new function, which that parameter is always a given.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1076" target="_blank">00:17:56.080</a></span> | <span class="t">So let's check it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1077" target="_blank">00:17:57.720</a></span> | <span class="t">So we could run it like that, or we could say f2 equals this partial function application.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1086" target="_blank">00:18:06.400</a></span> | <span class="t">And so if I say f2 shift tab, then you can see this is now a function that just takes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1091" target="_blank">00:18:11.920</a></span> | <span class="t">epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1092" target="_blank">00:18:12.920</a></span> | <span class="t">It just takes epoch because show progress took two parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1097" target="_blank">00:18:17.480</a></span> | <span class="t">We've already passed it one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1098" target="_blank">00:18:18.960</a></span> | <span class="t">So this now takes one parameter, which is what we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1101" target="_blank">00:18:21.760</a></span> | <span class="t">So that's why we could pass that to as our callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1106" target="_blank">00:18:26.760</a></span> | <span class="t">So we've seen a lot of those techniques already last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1113" target="_blank">00:18:33.640</a></span> | <span class="t">Most of what we saw last week, though, did not use a function as a callback, but used</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1118" target="_blank">00:18:38.000</a></span> | <span class="t">a class as a callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1120" target="_blank">00:18:40.440</a></span> | <span class="t">So we could do exactly the same thing, but pretty much any place you can use a closure,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1125" target="_blank">00:18:45.340</a></span> | <span class="t">you can also use a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1127" target="_blank">00:18:47.320</a></span> | <span class="t">Instead of storing it away inside the closure, some state, we can store our state, in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1132" target="_blank">00:18:52.520</a></span> | <span class="t">case the exclamation, inside self, passing it into init.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1137" target="_blank">00:18:57.720</a></span> | <span class="t">So here's exactly the same thing as we saw before, but as a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1142" target="_blank">00:19:02.960</a></span> | <span class="t">Dundacall is a special magic name which will be called if you take an object, so in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1152" target="_blank">00:19:12.600</a></span> | <span class="t">case a progress showing callback object, and call it with parentheses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1157" target="_blank">00:19:17.160</a></span> | <span class="t">So if I go cb high, you see I'm taking that object and I'm treating it as if it's a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1163" target="_blank">00:19:23.760</a></span> | <span class="t">And that will call dundacall.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1167" target="_blank">00:19:27.600</a></span> | <span class="t">If you've used other languages like in C++, this is called a functor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1174" target="_blank">00:19:34.400</a></span> | <span class="t">More generally it's called a callable in Python, so it's kind of something that a lot of languages</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1180" target="_blank">00:19:40.640</a></span> | <span class="t">have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1182" target="_blank">00:19:42.680</a></span> | <span class="t">All right, so now we can use that as a callback, just like before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1190" target="_blank">00:19:50.920</a></span> | <span class="t">All right, next thing to look at is, for our callback, is we're going to use star args and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1199" target="_blank">00:19:59.640</a></span> | <span class="t">star star kwargs, or otherwise known as quargs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1203" target="_blank">00:20:03.920</a></span> | <span class="t">For those of you that don't know what these mean, let's create a function that takes star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1208" target="_blank">00:20:08.200</a></span> | <span class="t">args and star star kwargs and prints out args and kwargs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1215" target="_blank">00:20:15.320</a></span> | <span class="t">So if I call that function, I could pass it 3a, thing1 equals hello, and you'll see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1222" target="_blank">00:20:22.080</a></span> | <span class="t">all the things that are passed as positional arguments end up in a tuple called args, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1228" target="_blank">00:20:28.280</a></span> | <span class="t">all the things passed as keyword arguments end up as a dictionary called quargs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1234" target="_blank">00:20:34.200</a></span> | <span class="t">That's literally all these things do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1238" target="_blank">00:20:38.000</a></span> | <span class="t">And so PyTorch uses that, for example, when you create an nn.sequential, it takes what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1244" target="_blank">00:20:44.360</a></span> | <span class="t">you pass in as a star args, right, you just pass them directly and it turns it into a tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1250" target="_blank">00:20:50.560</a></span> | <span class="t">So why do we use this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1253" target="_blank">00:20:53.080</a></span> | <span class="t">There's a few reasons we use it, but one of the common ways to use it is if you kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1258" target="_blank">00:20:58.200</a></span> | <span class="t">want to wrap some other class or object, then you can take a bunch of stuff as star star</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1264" target="_blank">00:21:04.760</a></span> | <span class="t">kwargs and pass it off to some other functional object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1270" target="_blank">00:21:10.480</a></span> | <span class="t">We're getting better at this, and we're removing a lot of the usages, but in the early days</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1273" target="_blank">00:21:13.980</a></span> | <span class="t">of fast AI version 1, we actually were overusing quargs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1278" target="_blank">00:21:18.240</a></span> | <span class="t">So quite often, we would kind of -- there would be a lot of stuff that wasn't obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1284" target="_blank">00:21:24.640</a></span> | <span class="t">in the parameter list of a function that ended up in quargs, and then we would pass it down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1289" target="_blank">00:21:29.600</a></span> | <span class="t">to, I don't know, the PyTorch data loader initializer or something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1293" target="_blank">00:21:33.880</a></span> | <span class="t">And so we've been gradually removing those usages, because, like, it's mainly most helpful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1299" target="_blank">00:21:39.440</a></span> | <span class="t">for kind of quick and dirty throwing things together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1305" target="_blank">00:21:45.120</a></span> | <span class="t">In R, they actually use an ellipsis for the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1307" target="_blank">00:21:47.780</a></span> | <span class="t">They kind of overuse it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1309" target="_blank">00:21:49.040</a></span> | <span class="t">Quite often, it's hard to see what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1311" target="_blank">00:21:51.000</a></span> | <span class="t">You might have noticed in Matplotlib, a lot of times the thing you're trying to pass to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1316" target="_blank">00:21:56.080</a></span> | <span class="t">Matplotlib isn't there in the shift tab when you hit shift tab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1319" target="_blank">00:21:59.040</a></span> | <span class="t">It's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1320" target="_blank">00:22:00.040</a></span> | <span class="t">They're using quargs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1321" target="_blank">00:22:01.120</a></span> | <span class="t">So there are some downsides to using it, but there are some places you really want to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1325" target="_blank">00:22:05.320</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1326" target="_blank">00:22:06.320</a></span> | <span class="t">For example, take a look at this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1328" target="_blank">00:22:08.480</a></span> | <span class="t">Let's take rewrite slow calculation, but this time we're going to allow the user to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1333" target="_blank">00:22:13.680</a></span> | <span class="t">a callback that is called before the calculation occurs and after the calculation that occurs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1341" target="_blank">00:22:21.840</a></span> | <span class="t">And the after calculation one's a bit tricky, because it's going to take two parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1344" target="_blank">00:22:24.960</a></span> | <span class="t">now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1345" target="_blank">00:22:25.960</a></span> | <span class="t">It's going to take both the epoch number and also what have we calculated so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1352" target="_blank">00:22:32.920</a></span> | <span class="t">So we can't just call CB parentheses I. We actually now have to assume that it's got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1359" target="_blank">00:22:39.480</a></span> | <span class="t">some particular methods.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1362" target="_blank">00:22:42.020</a></span> | <span class="t">So here is, for example, a print step callback, which before calculation just says I'm about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1369" target="_blank">00:22:49.240</a></span> | <span class="t">to start and after calculation it says I'm done and there it's running.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1375" target="_blank">00:22:55.800</a></span> | <span class="t">So in this case, this callback didn't actually care about the epoch number or about the value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1382" target="_blank">00:23:02.120</a></span> | <span class="t">And so, it just has star, star, star, quargs in both places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1387" target="_blank">00:23:07.880</a></span> | <span class="t">It doesn't have to worry about exactly what's being passed in, because it's not using them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1391" target="_blank">00:23:11.880</a></span> | <span class="t">So this is quite a good kind of use of this, is to basically create a function that's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1399" target="_blank">00:23:19.280</a></span> | <span class="t">to be used somewhere else and you don't care about one or more of the parameters or you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1403" target="_blank">00:23:23.080</a></span> | <span class="t">want to make things more flexible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1405" target="_blank">00:23:25.360</a></span> | <span class="t">So in this case, we don't get an error saying, because if we remove this, which looks like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1412" target="_blank">00:23:32.400</a></span> | <span class="t">we should be able to do because we don't use anything, but here's a problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1417" target="_blank">00:23:37.600</a></span> | <span class="t">It tried to call before calc I, and before calc doesn't take an I.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1422" target="_blank">00:23:42.960</a></span> | <span class="t">So if you put in both positional and keyword arguments, it'll always work everywhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1431" target="_blank">00:23:51.600</a></span> | <span class="t">And so here we can actually use them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1434" target="_blank">00:23:54.400</a></span> | <span class="t">So let's actually use epoch and value to print out those details.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1440" target="_blank">00:24:00.180</a></span> | <span class="t">So now you can see there it is printing them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1442" target="_blank">00:24:02.000</a></span> | <span class="t">And in this case, I've put star, star, quargs at the end, because maybe in the future, there'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1446" target="_blank">00:24:06.560</a></span> | <span class="t">be some other things that are passed in and we want to make sure this doesn't break.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1449" target="_blank">00:24:09.800</a></span> | <span class="t">So it kind of makes it more resilient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1454" target="_blank">00:24:14.680</a></span> | <span class="t">The next thing we might want to do with callbacks is to actually change something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1461" target="_blank">00:24:21.080</a></span> | <span class="t">So a couple of things that we did last week, one was we wanted to be able to cancel out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1466" target="_blank">00:24:26.440</a></span> | <span class="t">of a loop to stop early.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1469" target="_blank">00:24:29.000</a></span> | <span class="t">The other thing we might want to do is actually change the value of something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1473" target="_blank">00:24:33.320</a></span> | <span class="t">So in order to stop early, we could check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1478" target="_blank">00:24:38.280</a></span> | <span class="t">And also the other thing we might want to do is say, well, what if you don't want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1481" target="_blank">00:24:41.720</a></span> | <span class="t">define before calc or after calc?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1484" target="_blank">00:24:44.320</a></span> | <span class="t">We wouldn't want everything to break.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1486" target="_blank">00:24:46.020</a></span> | <span class="t">So we can actually check whether a callback is defined and only call it if it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1492" target="_blank">00:24:52.120</a></span> | <span class="t">And we could actually check the return value and then do something based on the return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1496" target="_blank">00:24:56.480</a></span> | <span class="t">value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1497" target="_blank">00:24:57.480</a></span> | <span class="t">So here's something which will cancel out of our loop if the value that's been calculated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1504" target="_blank">00:25:04.240</a></span> | <span class="t">so far is over 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1506" target="_blank">00:25:06.960</a></span> | <span class="t">So here we stop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1510" target="_blank">00:25:10.720</a></span> | <span class="t">Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1513" target="_blank">00:25:13.480</a></span> | <span class="t">What if you actually want to change the way the calculation is being done?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1518" target="_blank">00:25:18.960</a></span> | <span class="t">So we could even change the way the calculation is being done by taking our calculation function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1527" target="_blank">00:25:27.200</a></span> | <span class="t">putting it into a class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1529" target="_blank">00:25:29.560</a></span> | <span class="t">And so now the value that it's calculated is an attribute of the class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1536" target="_blank">00:25:36.260</a></span> | <span class="t">And so now we could actually do something, a callback that reaches back inside the calculator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1542" target="_blank">00:25:42.880</a></span> | <span class="t">and changes it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1546" target="_blank">00:25:46.600</a></span> | <span class="t">So this is going to double the result if it's less than three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1550" target="_blank">00:25:50.160</a></span> | <span class="t">So if we run this, right, we now actually have to call this because it's a class, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1556" target="_blank">00:25:56.720</a></span> | <span class="t">you can see it's giving a different value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1559" target="_blank">00:25:59.480</a></span> | <span class="t">And so we're also taking advantage of this in the callbacks that we're using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1563" target="_blank">00:26:03.520</a></span> | <span class="t">So this is kind of the ultimately flexible callback system.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1570" target="_blank">00:26:10.040</a></span> | <span class="t">And so you'll see in this case, we actually have to pass the calculator object to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1580" target="_blank">00:26:20.340</a></span> | <span class="t">callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1581" target="_blank">00:26:21.340</a></span> | <span class="t">So the way we do that is we've defined a callback method here, which checks to see whether it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1590" target="_blank">00:26:30.280</a></span> | <span class="t">defined and if it is, it grabs it and then it calls it passing in the calculator object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1596" target="_blank">00:26:36.280</a></span> | <span class="t">itself so it's now available.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1600" target="_blank">00:26:40.520</a></span> | <span class="t">And so what we actually did last week is we didn't call this callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1605" target="_blank">00:26:45.720</a></span> | <span class="t">We called this dunder call, which means we were able to do it like this, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1618" target="_blank">00:26:58.200</a></span> | <span class="t">Now you know, which do you prefer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1621" target="_blank">00:27:01.080</a></span> | <span class="t">It's kind of up to you, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1622" target="_blank">00:27:02.080</a></span> | <span class="t">I mean, we had so many callbacks being called that I felt the extra noise of giving it a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1627" target="_blank">00:27:07.640</a></span> | <span class="t">name was a bit messy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1629" target="_blank">00:27:09.880</a></span> | <span class="t">On the other hand, you might feel that calling a callback isn't something you expect dunder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1633" target="_blank">00:27:13.800</a></span> | <span class="t">call to do, in which case you can do it that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1637" target="_blank">00:27:17.480</a></span> | <span class="t">So there's pros and cons, neither is right or wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1642" target="_blank">00:27:22.080</a></span> | <span class="t">Okay, so that's callbacks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1649" target="_blank">00:27:29.760</a></span> | <span class="t">We've been using dunder thingys a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1653" target="_blank">00:27:33.800</a></span> | <span class="t">Dunder thingys look like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1656" target="_blank">00:27:36.440</a></span> | <span class="t">And in Python, a dunder thingy is special somehow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1662" target="_blank">00:27:42.480</a></span> | <span class="t">Most languages kind of let you define special behaviors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1666" target="_blank">00:27:46.520</a></span> | <span class="t">For example, in C++, there's an operator keyword where if you define a function that says operator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1672" target="_blank">00:27:52.920</a></span> | <span class="t">something like plus, you're defining the plus operator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1678" target="_blank">00:27:58.400</a></span> | <span class="t">So most languages tend to have special magic names you can give things that make something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1684" target="_blank">00:28:04.480</a></span> | <span class="t">a constructor or a destructor or an operator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1688" target="_blank">00:28:08.000</a></span> | <span class="t">I like in Python that all of the magic names actually look magic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1693" target="_blank">00:28:13.440</a></span> | <span class="t">They all look like that, which I think is actually a really good way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1699" target="_blank">00:28:19.080</a></span> | <span class="t">So the Python docs have a data model reference where they tell you about all these special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1708" target="_blank">00:28:28.760</a></span> | <span class="t">method names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1710" target="_blank">00:28:30.000</a></span> | <span class="t">And you can go through and you can see what are all the special things you can get your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1713" target="_blank">00:28:33.920</a></span> | <span class="t">method to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1714" target="_blank">00:28:34.920</a></span> | <span class="t">Like you can override how it behaves with less than or equal to or et cetera, et cetera.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1721" target="_blank">00:28:41.740</a></span> | <span class="t">There's a particular list I suggest you know, and this is the list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1725" target="_blank">00:28:45.440</a></span> | <span class="t">So you can go to those docs and see what these things do because we use all of these in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1730" target="_blank">00:28:50.600</a></span> | <span class="t">course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1731" target="_blank">00:28:51.600</a></span> | <span class="t">So here's an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1734" target="_blank">00:28:54.300</a></span> | <span class="t">Here's a sloppy adder plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1737" target="_blank">00:28:57.640</a></span> | <span class="t">You pass in some number that you're going to add up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1740" target="_blank">00:29:00.320</a></span> | <span class="t">And then when you add two things together, it will give you the result of adding them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1743" target="_blank">00:29:03.720</a></span> | <span class="t">up, but it will be wrong by 0.01.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1746" target="_blank">00:29:06.960</a></span> | <span class="t">And that is called dunder add because that's what happens when you see plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1751" target="_blank">00:29:11.480</a></span> | <span class="t">This is called dunder init because this is what happens when an object gets constructed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1755" target="_blank">00:29:15.720</a></span> | <span class="t">And this is called dunder repre because this is what gets called when you print it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1759" target="_blank">00:29:19.320</a></span> | <span class="t">So now I can create a one adder and a two adder and I can plus them together and I can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1764" target="_blank">00:29:24.200</a></span> | <span class="t">see the result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1766" target="_blank">00:29:26.120</a></span> | <span class="t">So that's kind of an example of how these special dunder methods work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1776" target="_blank">00:29:36.120</a></span> | <span class="t">So that's a bit of that Python stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1782" target="_blank">00:29:42.920</a></span> | <span class="t">There's another bit of code stuff that I wanted to show you, which you'll need to be doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1787" target="_blank">00:29:47.280</a></span> | <span class="t">a lot of, which is you need to be really good at browsing source code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1793" target="_blank">00:29:53.120</a></span> | <span class="t">If you're going to be contributing stuff to fast AI or to the fast AI for Swift for TensorFlow</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1801" target="_blank">00:30:01.640</a></span> | <span class="t">or just building your own more complex projects, you need to be able to jump around source</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1807" target="_blank">00:30:07.560</a></span> | <span class="t">code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1808" target="_blank">00:30:08.560</a></span> | <span class="t">Or even just to find out how PyTorch does something, if you're doing some research,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1812" target="_blank">00:30:12.120</a></span> | <span class="t">you need to really understand what's going on under the hood.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1816" target="_blank">00:30:16.920</a></span> | <span class="t">This is a list of things you should know how to do in your editor of choice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1822" target="_blank">00:30:22.080</a></span> | <span class="t">Any editor that can't do all of these things is worth replacing with one that can.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1826" target="_blank">00:30:26.900</a></span> | <span class="t">Most editors can do these things, emacs can, visual studio code can, sublime can, and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1835" target="_blank">00:30:35.080</a></span> | <span class="t">editor I use most of the time, vim, can as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1838" target="_blank">00:30:38.000</a></span> | <span class="t">I'll show you what these things are in vim.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1842" target="_blank">00:30:42.160</a></span> | <span class="t">On the forums there are already some topics saying how to do these things in other editors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1847" target="_blank">00:30:47.440</a></span> | <span class="t">If you don't find one that seems any good, feel free to create your own topic if you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1852" target="_blank">00:30:52.000</a></span> | <span class="t">got some tips about how to do these things or other useful things in your editor of choice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1856" target="_blank">00:30:56.400</a></span> | <span class="t">I'm going to show you in vim for no particular reason, just because I use vim.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1866" target="_blank">00:31:06.360</a></span> | <span class="t">My editor, it's called vim.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1868" target="_blank">00:31:08.640</a></span> | <span class="t">One of the things I like about vim is I can use it in a terminal, which I find super helpful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1872" target="_blank">00:31:12.860</a></span> | <span class="t">because I'm working on remote machines all the time and I like to be at least as productive</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1877" target="_blank">00:31:17.900</a></span> | <span class="t">in a terminal as I am on my local computer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1884" target="_blank">00:31:24.760</a></span> | <span class="t">The first thing you should be able to do is to jump to a symbol.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1888" target="_blank">00:31:28.320</a></span> | <span class="t">A symbol would be like a class or a function or something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1893" target="_blank">00:31:33.720</a></span> | <span class="t">For example, I might want to be able to jump straight to the definition of createCNN, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1905" target="_blank">00:31:45.960</a></span> | <span class="t">I can't quite remember the name of the function, createCNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1909" target="_blank">00:31:49.680</a></span> | <span class="t">I would go colon tag, create, I'm pretty sure it's create underscore something, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1915" target="_blank">00:31:55.360</a></span> | <span class="t">I'd press tab a few times and it would loop through, there it is, createCNN, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1920" target="_blank">00:32:00.920</a></span> | <span class="t">I'd hit enter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1922" target="_blank">00:32:02.480</a></span> | <span class="t">That's the first thing that your editor should do, is it should make it easy to jump to a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1926" target="_blank">00:32:06.680</a></span> | <span class="t">tag even if you can't remember exactly what it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1929" target="_blank">00:32:09.720</a></span> | <span class="t">The second thing it should do is that you should be able to click on something like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1933" target="_blank">00:32:13.880</a></span> | <span class="t">CNN learner and hit a button, which in vim's case is control right square bracket, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1939" target="_blank">00:32:19.320</a></span> | <span class="t">it should take you to the definition of that thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1942" target="_blank">00:32:22.060</a></span> | <span class="t">Okay, let's create this CNN learner, what's this thing called a data bunch, right square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1947" target="_blank">00:32:27.560</a></span> | <span class="t">bracket, okay, there's data bunch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1950" target="_blank">00:32:30.320</a></span> | <span class="t">You'll also see that my vim is folding things, classes, and functions to make it easier for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1958" target="_blank">00:32:38.000</a></span> | <span class="t">me to see exactly what's in this file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1960" target="_blank">00:32:40.840</a></span> | <span class="t">In some editors, this is called outlining, in some it's called folding, most editors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1965" target="_blank">00:32:45.600</a></span> | <span class="t">should do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1968" target="_blank">00:32:48.600</a></span> | <span class="t">Then there should be a way to go back to where you were before, in vim that's control T for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1974" target="_blank">00:32:54.280</a></span> | <span class="t">going back up the tag stack.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1976" target="_blank">00:32:56.280</a></span> | <span class="t">So here's my CNN learner, here's my createCNN, and so you can see in this way it makes it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1982" target="_blank">00:33:02.360</a></span> | <span class="t">nice and easy to kind of jump around a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1989" target="_blank">00:33:09.200</a></span> | <span class="t">Something I find super helpful is to also be able to jump into the source code of libraries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1993" target="_blank">00:33:13.520</a></span> | <span class="t">I'm using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=1994" target="_blank">00:33:14.520</a></span> | <span class="t">So for example, here's chiming normal, so I've got my vim configured, so if I hit control</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2000" target="_blank">00:33:20.040</a></span> | <span class="t">right square bracket on that, it takes me to the definition of chiming normal in the PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2005" target="_blank">00:33:25.400</a></span> | <span class="t">source code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2006" target="_blank">00:33:26.720</a></span> | <span class="t">And I find docstrings kind of annoying, so I have mine folded up by default, but I can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2010" target="_blank">00:33:30.360</a></span> | <span class="t">always open them up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2012" target="_blank">00:33:32.640</a></span> | <span class="t">If you use vim, the way to do that is to add additional tags for any packages that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2023" target="_blank">00:33:43.760</a></span> | <span class="t">want to be able to jump to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2025" target="_blank">00:33:45.120</a></span> | <span class="t">I'm sure most editors will do something pretty similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2028" target="_blank">00:33:48.600</a></span> | <span class="t">Now that I've seen how chiming normal works, I can use the same control T to jump back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2032" target="_blank">00:33:52.960</a></span> | <span class="t">to where I was in my fast AI source code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2039" target="_blank">00:33:59.800</a></span> | <span class="t">Then the only other thing that's particularly important to know how to do is to just do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2043" target="_blank">00:34:03.560</a></span> | <span class="t">more general searches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2045" target="_blank">00:34:05.360</a></span> | <span class="t">So let's say I wanted to find all the places that I've used Lambda, since we talked about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2050" target="_blank">00:34:10.600</a></span> | <span class="t">Lambda today, I have a particular thing I use called ACK, I can say ACK Lambda, and here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2059" target="_blank">00:34:19.360</a></span> | <span class="t">is a list of all of the places I've used Lambda, and I could click on one, and it will jump</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2067" target="_blank">00:34:27.080</a></span> | <span class="t">to the code where it's used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2070" target="_blank">00:34:30.920</a></span> | <span class="t">Again most editors should do something like that for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2073" target="_blank">00:34:33.860</a></span> | <span class="t">So I find with that basic set of stuff, you should be able to get around pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2078" target="_blank">00:34:38.380</a></span> | <span class="t">If you're a professional software engineer, I know you know all this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2081" target="_blank">00:34:41.980</a></span> | <span class="t">If you're not, hopefully you're feeling pretty excited right now to discover that editors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2085" target="_blank">00:34:45.380</a></span> | <span class="t">can do more than you realized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2087" target="_blank">00:34:47.440</a></span> | <span class="t">And so sometimes people will jump on our GitHub and say, I don't know how to find out what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2094" target="_blank">00:34:54.000</a></span> | <span class="t">a function is that you're calling because you don't list all your imports at the top</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2097" target="_blank">00:34:57.960</a></span> | <span class="t">of the screen, but this is a great place where you should be using your editor to tell you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2103" target="_blank">00:35:03.840</a></span> | <span class="t">And in fact, one place that GUI editors can be pretty good is often if you actually just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2108" target="_blank">00:35:08.560</a></span> | <span class="t">point at something, they will pop up something saying exactly where is that symbol coming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2113" target="_blank">00:35:13.080</a></span> | <span class="t">from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2114" target="_blank">00:35:14.080</a></span> | <span class="t">I don't have that set up in VIM, so I just have to hit the right square bracket to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2118" target="_blank">00:35:18.880</a></span> | <span class="t">where something's coming from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2121" target="_blank">00:35:21.280</a></span> | <span class="t">Okay, so that's some tips about stuff that you should be able to do when you're browsing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2127" target="_blank">00:35:27.680</a></span> | <span class="t">source code, and if you don't know how to do it yet, please Google or look at the forums</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2132" target="_blank">00:35:32.240</a></span> | <span class="t">and practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2135" target="_blank">00:35:35.720</a></span> | <span class="t">Something else we were looking at a lot last week and you need to know pretty well is variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2140" target="_blank">00:35:40.880</a></span> | <span class="t">So just a quick refresher on what variance is, or for those of you who haven't studied</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2144" target="_blank">00:35:44.960</a></span> | <span class="t">it before, here's what variance is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2148" target="_blank">00:35:48.720</a></span> | <span class="t">Variance is the average of how far away each data point is from the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2153" target="_blank">00:35:53.140</a></span> | <span class="t">So here's some data, right, and here's the mean of that data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2157" target="_blank">00:35:57.880</a></span> | <span class="t">And so the average distance for each data point from the mean is T, the data points,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2164" target="_blank">00:36:04.840</a></span> | <span class="t">minus M, top mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2166" target="_blank">00:36:06.840</a></span> | <span class="t">Oh, that's zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2168" target="_blank">00:36:08.880</a></span> | <span class="t">That didn't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2169" target="_blank">00:36:09.880</a></span> | <span class="t">Oh, well of course it didn't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2171" target="_blank">00:36:11.640</a></span> | <span class="t">The mean is defined as the thing which is in the middle, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2176" target="_blank">00:36:16.320</a></span> | <span class="t">So of course that's always zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2177" target="_blank">00:36:17.800</a></span> | <span class="t">So we need to do something else that doesn't have the positives and negatives cancel out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2183" target="_blank">00:36:23.380</a></span> | <span class="t">So there's two main ways we fix it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2185" target="_blank">00:36:25.680</a></span> | <span class="t">One is by squaring each thing before we take the mean, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2192" target="_blank">00:36:32.500</a></span> | <span class="t">The other is taking the absolute value of each thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2196" target="_blank">00:36:36.600</a></span> | <span class="t">So turning all the negatives and positives before we take the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2200" target="_blank">00:36:40.300</a></span> | <span class="t">So they're both common fixes for this problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2203" target="_blank">00:36:43.780</a></span> | <span class="t">You can see though the first is now on a totally different scale, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2207" target="_blank">00:36:47.240</a></span> | <span class="t">The numbers were like 1, 2, 4, 8, 8, and this is 47.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2210" target="_blank">00:36:50.640</a></span> | <span class="t">So we need to undo that squaring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2212" target="_blank">00:36:52.920</a></span> | <span class="t">So after we've squared, we then take the square root at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2217" target="_blank">00:36:57.000</a></span> | <span class="t">So here are two numbers that represent how far things are away from the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2222" target="_blank">00:37:02.260</a></span> | <span class="t">Or in other words, how much do they vary?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2224" target="_blank">00:37:04.480</a></span> | <span class="t">If everything's pretty close to similar to each other, those two numbers will be small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2228" target="_blank">00:37:08.960</a></span> | <span class="t">If they're wildly different to each other, those two numbers will be big.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2234" target="_blank">00:37:14.240</a></span> | <span class="t">This one here is called the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2237" target="_blank">00:37:17.880</a></span> | <span class="t">And it's defined as the square root of this one here which is called the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2243" target="_blank">00:37:23.000</a></span> | <span class="t">And this one here is called the mean absolute deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2247" target="_blank">00:37:27.200</a></span> | <span class="t">You could replace this M made with various other things like median, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2257" target="_blank">00:37:37.960</a></span> | <span class="t">So we have one outlier here, 18.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2262" target="_blank">00:37:42.400</a></span> | <span class="t">So in the case of the one where we took a square in the middle of it, this number is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2267" target="_blank">00:37:47.120</a></span> | <span class="t">higher because the square takes that 18 and makes it much bigger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2271" target="_blank">00:37:51.920</a></span> | <span class="t">So in other words, standard deviation is more sensitive to outliers than mean absolute deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2278" target="_blank">00:37:58.880</a></span> | <span class="t">So for that reason, the mean absolute deviation is very often the thing you want to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2287" target="_blank">00:38:07.320</a></span> | <span class="t">because in machine learning outliers are more of a problem than to help a lot of the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2293" target="_blank">00:38:13.840</a></span> | <span class="t">But mathematicians and statisticians tend to work with standard deviation rather than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2298" target="_blank">00:38:18.200</a></span> | <span class="t">mean absolute deviation because it makes their math proofs easier and that's the only reason.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2302" target="_blank">00:38:22.800</a></span> | <span class="t">They'll tell you otherwise, but that's the only reason.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2305" target="_blank">00:38:25.440</a></span> | <span class="t">So the mean absolute deviation is really underused and it actually is a really great measure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2312" target="_blank">00:38:32.720</a></span> | <span class="t">to use and you should definitely get used to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2320" target="_blank">00:38:40.360</a></span> | <span class="t">There's a lot of places where I kind of notice that replacing things involving squares with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2325" target="_blank">00:38:45.360</a></span> | <span class="t">things involving absolute values, the absolute value things just often work better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2329" target="_blank">00:38:49.920</a></span> | <span class="t">It's a good tip to remember that there's this kind of long-held assumption.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2334" target="_blank">00:38:54.920</a></span> | <span class="t">We have to use a squared thing everywhere, but it actually often doesn't work as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2342" target="_blank">00:39:02.760</a></span> | <span class="t">This is our definition of variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2346" target="_blank">00:39:06.280</a></span> | <span class="t">Notice that this is the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2350" target="_blank">00:39:10.400</a></span> | <span class="t">So this is written in math.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2355" target="_blank">00:39:15.920</a></span> | <span class="t">This written in math looks like this and it's another way of writing the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2361" target="_blank">00:39:21.960</a></span> | <span class="t">It's important because it's super handy and it's super handy because in this one here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2368" target="_blank">00:39:28.280</a></span> | <span class="t">we have to go through the whole data set once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2370" target="_blank">00:39:30.680</a></span> | <span class="t">To calculate the mean of the data and then a second time to get the squares of the differences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2379" target="_blank">00:39:39.480</a></span> | <span class="t">This is really nice because in this case, we only have to keep track of two numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2385" target="_blank">00:39:45.760</a></span> | <span class="t">the squares of the data and the sum of the data and as you'll see shortly, this kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2393" target="_blank">00:39:53.800</a></span> | <span class="t">of way of doing things is generally therefore just easier to work with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2399" target="_blank">00:39:59.360</a></span> | <span class="t">So even though this is kind of the definition of the variance that makes intuitive sense,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2408" target="_blank">00:40:08.280</a></span> | <span class="t">this is the definition of variance that you normally want to implement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2413" target="_blank">00:40:13.580</a></span> | <span class="t">And so there it is in math.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2416" target="_blank">00:40:16.360</a></span> | <span class="t">The other thing we see quite a bit is covariance and correlation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2421" target="_blank">00:40:21.480</a></span> | <span class="t">So if we take our same data set, let's now create a second data set which is double t</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2431" target="_blank">00:40:31.800</a></span> | <span class="t">times a little bit of random noise, so here's that plotted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2439" target="_blank">00:40:39.640</a></span> | <span class="t">Let's now look at the difference between each item of t and its mean and multiply it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2447" target="_blank">00:40:47.520</a></span> | <span class="t">each item of u and its mean, so there's those values and let's look at the mean of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2458" target="_blank">00:40:58.520</a></span> | <span class="t">So what's this number?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2460" target="_blank">00:41:00.440</a></span> | <span class="t">So it's the average of the difference of how far away the x value is from the mean of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2465" target="_blank">00:41:05.920</a></span> | <span class="t">x value is, the x's, multiplied by each difference between the y value and how far away from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2473" target="_blank">00:41:13.760</a></span> | <span class="t">the y mean it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2476" target="_blank">00:41:16.940</a></span> | <span class="t">Let's compare this number to the same number calculated with this data set, where this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2482" target="_blank">00:41:22.320</a></span> | <span class="t">data set is just some random numbers compared to v.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2488" target="_blank">00:41:28.840</a></span> | <span class="t">And let's now calculate the exact same product, the exact same mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2492" target="_blank">00:41:32.680</a></span> | <span class="t">This number's much smaller than this number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2496" target="_blank">00:41:36.720</a></span> | <span class="t">Why is this number much smaller?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2498" target="_blank">00:41:38.880</a></span> | <span class="t">So if you think about it, if these are kind of all lined up nicely, then every time it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2505" target="_blank">00:41:45.880</a></span> | <span class="t">higher than the average on the x-axis, it's also higher than the average on the y-axis.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2512" target="_blank">00:41:52.520</a></span> | <span class="t">So you have two big positive numbers and vice versa, two big negative numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2518" target="_blank">00:41:58.180</a></span> | <span class="t">So in either case, you end up with, when you multiply them together, a big positive number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2523" target="_blank">00:42:03.280</a></span> | <span class="t">So this is adding up a whole bunch of big positive numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2527" target="_blank">00:42:07.660</a></span> | <span class="t">So in other words, this number tells you how much these two things vary in the same way,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2537" target="_blank">00:42:17.120</a></span> | <span class="t">kind of how lined up are they on this graph.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2540" target="_blank">00:42:20.240</a></span> | <span class="t">And so this one, when one is big, the other's not necessarily big.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2544" target="_blank">00:42:24.400</a></span> | <span class="t">When one is small, the other's not necessarily very small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2549" target="_blank">00:42:29.120</a></span> | <span class="t">So this is the covariance, and you can also calculate it in this way, which might look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2559" target="_blank">00:42:39.960</a></span> | <span class="t">somewhat similar to what we saw before with our different variance calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2564" target="_blank">00:42:44.840</a></span> | <span class="t">And again, this is kind of the easier way to use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2571" target="_blank">00:42:51.160</a></span> | <span class="t">So as I say here, from now on, I don't want you to ever look at an equation or type in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2579" target="_blank">00:42:59.040</a></span> | <span class="t">an equation in LaTeX without typing it in Python, calculating some values and plotting them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2585" target="_blank">00:43:05.880</a></span> | <span class="t">Because this is the only way we get a sense in here of what these things mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2592" target="_blank">00:43:12.800</a></span> | <span class="t">And so in this case, we're going to take our covariance and we're going to divide it by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2598" target="_blank">00:43:18.040</a></span> | <span class="t">the product of the standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2601" target="_blank">00:43:21.720</a></span> | <span class="t">And this gives us a new number, and this is called correlation, or more specifically Pearson</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2607" target="_blank">00:43:27.280</a></span> | <span class="t">correlation coefficient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2610" target="_blank">00:43:30.000</a></span> | <span class="t">So we don't cover covariance and Pearson correlation coefficient too much in the course, but it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2614" target="_blank">00:43:34.720</a></span> | <span class="t">is one of these things which it's often nice to see how things vary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2618" target="_blank">00:43:38.480</a></span> | <span class="t">But remember, it's telling you really about how things vary linearly, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2622" target="_blank">00:43:42.800</a></span> | <span class="t">So if you want to know how things vary non-linearly, you have to create something called a neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2626" target="_blank">00:43:46.040</a></span> | <span class="t">network and check the loss and the metrics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2630" target="_blank">00:43:50.520</a></span> | <span class="t">But it's kind of interesting to see also how variance and covariance, you can see they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2635" target="_blank">00:43:55.200</a></span> | <span class="t">much the same thing, you know, where else one of them, in fact, you basically you can think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2640" target="_blank">00:44:00.120</a></span> | <span class="t">of it this way, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2641" target="_blank">00:44:01.120</a></span> | <span class="t">One of them is E of X squared, in other words, X and X are kind of the same thing, it's E</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2647" target="_blank">00:44:07.320</a></span> | <span class="t">of X times X, where else this is two different things, E of X times Y, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2651" target="_blank">00:44:11.960</a></span> | <span class="t">And so rather than having here, we had E of X squared here and E of X squared here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2659" target="_blank">00:44:19.960</a></span> | <span class="t">If you replace the second X with a Y, you get that and you get that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2664" target="_blank">00:44:24.920</a></span> | <span class="t">So they're like literally the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2668" target="_blank">00:44:28.760</a></span> | <span class="t">And then again here, if X and X are the same, then this is just sigma squared, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2676" target="_blank">00:44:36.040</a></span> | <span class="t">So the last thing I want to quickly talk about a little bit more is Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2683" target="_blank">00:44:43.540</a></span> | <span class="t">This was our final log Softmax definition from the other day, and this is the formula,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2692" target="_blank">00:44:52.160</a></span> | <span class="t">the same thing as an equation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2695" target="_blank">00:44:55.680</a></span> | <span class="t">And this is our cross entropy loss, remember.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2700" target="_blank">00:45:00.040</a></span> | <span class="t">So these are all important concepts we're going to be using a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2702" target="_blank">00:45:02.040</a></span> | <span class="t">So I just wanted to kind of clarify something that a lot of researchers that are published</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2706" target="_blank">00:45:06.960</a></span> | <span class="t">in big name conferences get wrong, which is when should you and shouldn't you use Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2713" target="_blank">00:45:13.040</a></span> | <span class="t">So this is our Softmax page from our entropy example spreadsheet, where we were looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2718" target="_blank">00:45:18.580</a></span> | <span class="t">at cat, dog, plane, fish, building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2721" target="_blank">00:45:21.620</a></span> | <span class="t">And so we had various outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2723" target="_blank">00:45:23.200</a></span> | <span class="t">This is just the activations that we might have gotten out of the last layer of our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2727" target="_blank">00:45:27.720</a></span> | <span class="t">And this is just E to the power of each of those activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2731" target="_blank">00:45:31.040</a></span> | <span class="t">And this is just the sum of all of those E to the power ofs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2734" target="_blank">00:45:34.360</a></span> | <span class="t">And then this is E to the power of divided by the sum, which is Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2738" target="_blank">00:45:38.600</a></span> | <span class="t">And of course, they all add up to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2743" target="_blank">00:45:43.040</a></span> | <span class="t">This is like some image number one that gave these activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2746" target="_blank">00:45:46.760</a></span> | <span class="t">Here's some other image number two, which gave these activations, which are very different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2751" target="_blank">00:45:51.640</a></span> | <span class="t">to these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2753" target="_blank">00:45:53.880</a></span> | <span class="t">But the Softmaxes are identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2757" target="_blank">00:45:57.440</a></span> | <span class="t">That and that are identical.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2759" target="_blank">00:45:59.600</a></span> | <span class="t">So that's weird.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2760" target="_blank">00:46:00.680</a></span> | <span class="t">How has that happened?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2761" target="_blank">00:46:01.680</a></span> | <span class="t">Well, it's happened because in every case, the E to the power of this divided by the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2769" target="_blank">00:46:09.060</a></span> | <span class="t">sum of the E to the power ofs ended up in the same ratio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2773" target="_blank">00:46:13.920</a></span> | <span class="t">So in other words, even though fish is only 0.63 here, but it's true here, once you take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2780" target="_blank">00:46:20.640</a></span> | <span class="t">E to the power of, it's the same percentage of the sum, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2785" target="_blank">00:46:25.160</a></span> | <span class="t">And so we end up with the same Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2788" target="_blank">00:46:28.120</a></span> | <span class="t">Why does that matter?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2790" target="_blank">00:46:30.120</a></span> | <span class="t">Well, in this model, it seems like being a fish is associated with having an activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2798" target="_blank">00:46:38.680</a></span> | <span class="t">of maybe like 2ish, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2801" target="_blank">00:46:41.920</a></span> | <span class="t">And this is only like 0.6ish.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2803" target="_blank">00:46:43.920</a></span> | <span class="t">So maybe there's no fish in this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2807" target="_blank">00:46:47.240</a></span> | <span class="t">But what's actually happened is there's no cats or dogs or planes or fishes or buildings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2814" target="_blank">00:46:54.800</a></span> | <span class="t">So in the end then, because Softmax has to add to 1, it has to pick something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2827" target="_blank">00:47:07.600</a></span> | <span class="t">So it's fish that comes through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2829" target="_blank">00:47:09.280</a></span> | <span class="t">And what's more is because we do this E to the power of, the thing that's a little bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2833" target="_blank">00:47:13.960</a></span> | <span class="t">higher, it pushes much higher because it's exponential, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2837" target="_blank">00:47:17.760</a></span> | <span class="t">So Softmax likes to pick one thing and make it big.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2842" target="_blank">00:47:22.000</a></span> | <span class="t">And they have to add up to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2844" target="_blank">00:47:24.480</a></span> | <span class="t">So the problem here is that I would guess that maybe image 2 doesn't have any of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2848" target="_blank">00:47:28.720</a></span> | <span class="t">things in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2850" target="_blank">00:47:30.280</a></span> | <span class="t">And we had to pick something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2851" target="_blank">00:47:31.560</a></span> | <span class="t">So it said, oh, I'm pretty sure there's a fish.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2854" target="_blank">00:47:34.040</a></span> | <span class="t">Or maybe the problem actually is that this image had a cat and a fish and a building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2863" target="_blank">00:47:43.840</a></span> | <span class="t">But again, because Softmax, they have to add to 1, and one of them is going to be much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2868" target="_blank">00:47:48.440</a></span> | <span class="t">bigger than the others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2869" target="_blank">00:47:49.960</a></span> | <span class="t">So I don't know exactly which of these happened, but it's definitely not true that they both</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2875" target="_blank">00:47:55.880</a></span> | <span class="t">have an equal probability of having a fish in them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2880" target="_blank">00:48:00.060</a></span> | <span class="t">So to put this another way, Softmax is a terrible idea unless you know that every one of your,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2886" target="_blank">00:48:06.840</a></span> | <span class="t">if you're doing image recognition, every one of your images, or if you're doing audio or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2891" target="_blank">00:48:11.600</a></span> | <span class="t">tabular or whatever, every one of your items has one, no more than one, and definitely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2897" target="_blank">00:48:17.920</a></span> | <span class="t">at least one example of the thing you care about in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2902" target="_blank">00:48:22.900</a></span> | <span class="t">Because if it doesn't have any of cat, dog, plane, fish, or building, it's still going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2907" target="_blank">00:48:27.160</a></span> | <span class="t">to tell you with high probability that it has one of those things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2911" target="_blank">00:48:31.600</a></span> | <span class="t">Even if it has more than just one of cat, dog, plane, fish, or building, it'll pick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2915" target="_blank">00:48:35.080</a></span> | <span class="t">one of them until you're pretty sure it's got that one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2918" target="_blank">00:48:38.160</a></span> | <span class="t">So what do you do if there could be no things or there could be more than one of these things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2925" target="_blank">00:48:45.840</a></span> | <span class="t">Well, instead you use binomial, regular old binomial, which is e to the x divided by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2934" target="_blank">00:48:54.400</a></span> | <span class="t">plus e to the x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2936" target="_blank">00:48:56.000</a></span> | <span class="t">It's exactly the same as Softmax if your two categories are, has the thing and doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2941" target="_blank">00:49:01.960</a></span> | <span class="t">have the thing because they're like p and one minus p.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2945" target="_blank">00:49:05.000</a></span> | <span class="t">So you can convince yourself of that during the week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2947" target="_blank">00:49:07.840</a></span> | <span class="t">So in this case, let's take image one and let's go 1.02 divided by one plus 1.02.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2957" target="_blank">00:49:17.880</a></span> | <span class="t">And ditto for each of our different ones.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2960" target="_blank">00:49:20.600</a></span> | <span class="t">And then let's do the same thing for image two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2963" target="_blank">00:49:23.360</a></span> | <span class="t">And you can see now the numbers are different, as we would hope.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2968" target="_blank">00:49:28.000</a></span> | <span class="t">And so for image one, it's kind of saying, oh, it looks like there might be a cat in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2973" target="_blank">00:49:33.960</a></span> | <span class="t">it if we assume 0.5 is a cut off, there's probably a fish in it, and it seems likely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2981" target="_blank">00:49:41.160</a></span> | <span class="t">that there's a building in it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2984" target="_blank">00:49:44.080</a></span> | <span class="t">Whereas for image two, it's saying, I don't think there's anything in there, but maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2988" target="_blank">00:49:48.040</a></span> | <span class="t">a fish.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2989" target="_blank">00:49:49.040</a></span> | <span class="t">And this is what we want, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2991" target="_blank">00:49:51.800</a></span> | <span class="t">And so when you think about it, like for image recognition, probably most of the time you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=2997" target="_blank">00:49:57.960</a></span> | <span class="t">don't want Softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3000" target="_blank">00:50:00.080</a></span> | <span class="t">So why do we always use Softmax?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3002" target="_blank">00:50:02.840</a></span> | <span class="t">Because we all grew up with ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3005" target="_blank">00:50:05.040</a></span> | <span class="t">And ImageNet was specifically curated, so it only has one of the classes in ImageNet in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3011" target="_blank">00:50:11.400</a></span> | <span class="t">it, and it always has one of those classes in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3017" target="_blank">00:50:17.200</a></span> | <span class="t">An alternative, if you want to be able to handle the what if none of these classes are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3022" target="_blank">00:50:22.480</a></span> | <span class="t">in it case, is you could create another category called background or doesn't exist or null</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3029" target="_blank">00:50:29.160</a></span> | <span class="t">or missing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3031" target="_blank">00:50:31.240</a></span> | <span class="t">So let's say you created this missing category.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3033" target="_blank">00:50:33.120</a></span> | <span class="t">So there's six, cat, dog, plane, fish, building or missing, nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3041" target="_blank">00:50:41.540</a></span> | <span class="t">A lot of researchers have tried that, but it's actually a terrible idea and it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3047" target="_blank">00:50:47.080</a></span> | <span class="t">work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3048" target="_blank">00:50:48.080</a></span> | <span class="t">And the reason it doesn't work is because to be able to successfully predict missing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3054" target="_blank">00:50:54.320</a></span> | <span class="t">the penultimate layer activations have to have the features in it that is what a not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3060" target="_blank">00:51:00.800</a></span> | <span class="t">cat, dog, plane, fish, fish or building looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3064" target="_blank">00:51:04.200</a></span> | <span class="t">So how do you describe a not cat, dog, plane, fish or building?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3068" target="_blank">00:51:08.480</a></span> | <span class="t">What are the things that would activate high?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3070" target="_blank">00:51:10.080</a></span> | <span class="t">Is it shininess?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3071" target="_blank">00:51:11.080</a></span> | <span class="t">Is it fur?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3072" target="_blank">00:51:12.080</a></span> | <span class="t">Is it sunshine?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3073" target="_blank">00:51:13.080</a></span> | <span class="t">Is it edges?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3074" target="_blank">00:51:14.080</a></span> | <span class="t">No.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3075" target="_blank">00:51:15.080</a></span> | <span class="t">It's none of those things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3077" target="_blank">00:51:17.360</a></span> | <span class="t">There is no set of features that when they're all high is clearly a not cat, dog, plane,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3082" target="_blank">00:51:22.240</a></span> | <span class="t">fish or building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3083" target="_blank">00:51:23.400</a></span> | <span class="t">So that's just not a kind of object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3085" target="_blank">00:51:25.840</a></span> | <span class="t">So a neural net can kind of try to hack its way around it by creating a negative model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3093" target="_blank">00:51:33.060</a></span> | <span class="t">of every other single type and create a kind of not one of any of those other things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3097" target="_blank">00:51:37.680</a></span> | <span class="t">But that's very hard for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3099" target="_blank">00:51:39.720</a></span> | <span class="t">Whereas creating simply a binomial does it or doesn't it have this for every one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3106" target="_blank">00:51:46.480</a></span> | <span class="t">classes is really easy for it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3109" target="_blank">00:51:49.320</a></span> | <span class="t">Because it just doesn't have a cat.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3110" target="_blank">00:51:50.960</a></span> | <span class="t">Yes or no.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3111" target="_blank">00:51:51.960</a></span> | <span class="t">It doesn't have a dog.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3112" target="_blank">00:51:52.960</a></span> | <span class="t">Yes or no.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3113" target="_blank">00:51:53.960</a></span> | <span class="t">And so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3114" target="_blank">00:51:54.960</a></span> | <span class="t">So lots and lots of well-regarded academic papers make this mistake.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3124" target="_blank">00:52:04.520</a></span> | <span class="t">So look out for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3126" target="_blank">00:52:06.640</a></span> | <span class="t">And if you do come across an academic paper that's using softmax and you think, does that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3131" target="_blank">00:52:11.280</a></span> | <span class="t">actually work with softmax?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3134" target="_blank">00:52:14.140</a></span> | <span class="t">And you think maybe the answer is no.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3135" target="_blank">00:52:15.800</a></span> | <span class="t">Try replicating it without softmax and you may just find you get a better result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3140" target="_blank">00:52:20.320</a></span> | <span class="t">An example of somewhere where softmax is obviously a good idea or something like softmax is obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3145" target="_blank">00:52:25.440</a></span> | <span class="t">a good idea, language modeling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3148" target="_blank">00:52:28.400</a></span> | <span class="t">What's the next word?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3150" target="_blank">00:52:30.280</a></span> | <span class="t">It's definitely at least one word.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3152" target="_blank">00:52:32.600</a></span> | <span class="t">It's definitely not more than one word, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3155" target="_blank">00:52:35.040</a></span> | <span class="t">So you want softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3156" target="_blank">00:52:36.040</a></span> | <span class="t">So I'm not saying softmax is always a dumb idea, but it's often a dumb idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3161" target="_blank">00:52:41.920</a></span> | <span class="t">So that's something to look out for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3165" target="_blank">00:52:45.240</a></span> | <span class="t">Okay. Next thing I want to do is I want to build a learning rate finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3173" target="_blank">00:52:53.000</a></span> | <span class="t">And to build a learning rate finder, we need to use this test callback kind of idea, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3181" target="_blank">00:53:01.320</a></span> | <span class="t">ability to stop somewhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3185" target="_blank">00:53:05.120</a></span> | <span class="t">Problem is, as you may have noticed, this I want to stop somewhere callback wasn't working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3192" target="_blank">00:53:12.560</a></span> | <span class="t">in our new refactoring where we created this runner class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3196" target="_blank">00:53:16.080</a></span> | <span class="t">And the reason it wasn't working is because we were turning true to mean cancel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3203" target="_blank">00:53:23.000</a></span> | <span class="t">But even after we do that, it still goes on to do the next batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3207" target="_blank">00:53:27.440</a></span> | <span class="t">And even if we set self.stop, even after we do that, it'll go on to the next epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3212" target="_blank">00:53:32.080</a></span> | <span class="t">So to like actually stop it, you would have to return false from every single callback</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3216" target="_blank">00:53:36.840</a></span> | <span class="t">that's checked to make sure it like really stops or you would have to add something that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3221" target="_blank">00:53:41.720</a></span> | <span class="t">checks for self.stop in lots of places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3224" target="_blank">00:53:44.680</a></span> | <span class="t">But it would be a real pain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3226" target="_blank">00:53:46.920</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3227" target="_blank">00:53:47.920</a></span> | <span class="t">And it's also not as flexible as we would like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3230" target="_blank">00:53:50.840</a></span> | <span class="t">So what I want to show you today is something which I think is really interesting, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3234" target="_blank">00:53:54.480</a></span> | <span class="t">is using the idea of exceptions as a kind of control flow statement.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3243" target="_blank">00:54:03.800</a></span> | <span class="t">You may have think of exceptions as just being a way of handling errors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3247" target="_blank">00:54:07.600</a></span> | <span class="t">But actually exceptions are a very versatile way of writing very neat code that will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3253" target="_blank">00:54:13.120</a></span> | <span class="t">very helpful for your users.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3255" target="_blank">00:54:15.080</a></span> | <span class="t">Let me show you what I mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3258" target="_blank">00:54:18.960</a></span> | <span class="t">So let's start by just grabbing our MNIST data set as before and creating our data bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3262" target="_blank">00:54:22.800</a></span> | <span class="t">as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3263" target="_blank">00:54:23.960</a></span> | <span class="t">And here's our callback as before and our train eval callback as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3269" target="_blank">00:54:29.080</a></span> | <span class="t">But there's a couple of things I'm going to do differently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3272" target="_blank">00:54:32.800</a></span> | <span class="t">The first is, and this is a bit unrelated, but I think it's a useful refactoring, is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3276" target="_blank">00:54:36.760</a></span> | <span class="t">previously inside runner end under call, we went through each callback in order, and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3285" target="_blank">00:54:45.840</a></span> | <span class="t">checked to see whether that particular method exists in that callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3291" target="_blank">00:54:51.480</a></span> | <span class="t">And if it was, we called it and checked whether it returns true or false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3298" target="_blank">00:54:58.720</a></span> | <span class="t">It actually makes more sense for this to be inside the callback class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3307" target="_blank">00:55:07.960</a></span> | <span class="t">Because by putting it into the callback class, the callback class is now taking a -- has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3313" target="_blank">00:55:13.320</a></span> | <span class="t">dunder call which takes a callback name, and it can do this stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3318" target="_blank">00:55:18.440</a></span> | <span class="t">And what it means is that now your users who want to create their own callbacks, let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3325" target="_blank">00:55:25.400</a></span> | <span class="t">say they wanted to create a callback that printed out the callback name for every callback every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3331" target="_blank">00:55:31.360</a></span> | <span class="t">time it was run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3332" target="_blank">00:55:32.600</a></span> | <span class="t">Or let's say they wanted to add a break point, like a set trace that happened every time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3338" target="_blank">00:55:38.700</a></span> | <span class="t">the callback was run.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3340" target="_blank">00:55:40.200</a></span> | <span class="t">They could now create their own inherit from callback and actually replace dunder call itself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3348" target="_blank">00:55:48.400</a></span> | <span class="t">with something that added this behavior they want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3352" target="_blank">00:55:52.000</a></span> | <span class="t">Or they could add something that looks at three or four different callback names and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3356" target="_blank">00:55:56.200</a></span> | <span class="t">attaches to all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3357" target="_blank">00:55:57.660</a></span> | <span class="t">So this is like a nice little extra piece of flexibility.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3362" target="_blank">00:56:02.280</a></span> | <span class="t">It's not the key thing I wanted to show you, but it's an example of a nice little refactoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3367" target="_blank">00:56:07.440</a></span> | <span class="t">The key thing I wanted to show you is that I've created three new types of exception.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3373" target="_blank">00:56:13.460</a></span> | <span class="t">So an exception in Python is just a class that inherits from exception.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3378" target="_blank">00:56:18.640</a></span> | <span class="t">And most of the time you don't have to give it any other behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3381" target="_blank">00:56:21.880</a></span> | <span class="t">So to create a class that's just like its parent, but it just has a new name and no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3385" target="_blank">00:56:25.920</a></span> | <span class="t">more behavior, you just say pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3388" target="_blank">00:56:28.600</a></span> | <span class="t">So pass means this has all the same attributes and everything as the parent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3394" target="_blank">00:56:34.940</a></span> | <span class="t">But it's got a different name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3397" target="_blank">00:56:37.220</a></span> | <span class="t">So why do we do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3398" target="_blank">00:56:38.220</a></span> | <span class="t">Well, you might get a sense from the names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3400" target="_blank">00:56:40.680</a></span> | <span class="t">Cancel train exception, cancel epoch exception, cancel batch exception.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3405" target="_blank">00:56:45.360</a></span> | <span class="t">The idea is that we're going to let people's callbacks cancel anything, you know, cancel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3410" target="_blank">00:56:50.280</a></span> | <span class="t">at one of these levels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3411" target="_blank">00:56:51.280</a></span> | <span class="t">So if they cancel a batch, it will keep going with the next batch, but not finish this one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3416" target="_blank">00:56:56.560</a></span> | <span class="t">If they cancel an epoch, it will keep going with the next epoch that will cancel this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3420" target="_blank">00:57:00.960</a></span> | <span class="t">one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3422" target="_blank">00:57:02.080</a></span> | <span class="t">Cancel train will stop the training altogether.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3426" target="_blank">00:57:06.480</a></span> | <span class="t">So how would cancel train exception work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3428" target="_blank">00:57:08.560</a></span> | <span class="t">Well, here's the same runner we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3432" target="_blank">00:57:12.000</a></span> | <span class="t">But now fit, we already had try finally to make sure that our after fit and remove learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3440" target="_blank">00:57:20.120</a></span> | <span class="t">happened, even if there's an exception, I've added one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3444" target="_blank">00:57:24.680</a></span> | <span class="t">Accept cancel train exception.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3447" target="_blank">00:57:27.320</a></span> | <span class="t">And if that happens, then optionally it could call some after cancel train callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3452" target="_blank">00:57:32.240</a></span> | <span class="t">But most importantly, no error occurs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3455" target="_blank">00:57:35.920</a></span> | <span class="t">It just keeps on going to the finally block and will elegantly and happily finish up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3465" target="_blank">00:57:45.280</a></span> | <span class="t">So we can cancel training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3466" target="_blank">00:57:46.680</a></span> | <span class="t">So now our test callback can after step, we'll just print out what step we're up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3473" target="_blank">00:57:53.840</a></span> | <span class="t">And if it's greater than or equal to 10, we will raise cancel train exception.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3478" target="_blank">00:57:58.640</a></span> | <span class="t">And so now when we say run dot fit, it just prints out up to 10 and stops.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3484" target="_blank">00:58:04.760</a></span> | <span class="t">There's no stack trace, there's no error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3487" target="_blank">00:58:07.180</a></span> | <span class="t">This is using exception as a control flow technique, not as an error handling technique.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3493" target="_blank">00:58:13.280</a></span> | <span class="t">So another example, inside all batches, I go through all my batches in a try block,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3503" target="_blank">00:58:23.000</a></span> | <span class="t">except if there's a cancel epoch exception, in which case I optionally call an after cancel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3508" target="_blank">00:58:28.040</a></span> | <span class="t">epoch callback and then continue to the next epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3514" target="_blank">00:58:34.080</a></span> | <span class="t">Or inside one batch, I try to do all this stuff for a batch, except if there's a cancel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3519" target="_blank">00:58:39.360</a></span> | <span class="t">batch exception, I will optionally call the after cancel batch callback, and then continue</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3525" target="_blank">00:58:45.440</a></span> | <span class="t">to the next batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3527" target="_blank">00:58:47.520</a></span> | <span class="t">So this is like a super neat way that we've allowed any callback writer to stop any one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3534" target="_blank">00:58:54.640</a></span> | <span class="t">of these three levels of things happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3539" target="_blank">00:58:59.800</a></span> | <span class="t">So in this case, we're using cancel train exception to stop training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3545" target="_blank">00:59:05.580</a></span> | <span class="t">So we can now use that to create a learning rate finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3550" target="_blank">00:59:10.320</a></span> | <span class="t">So the basic approach of the learning rate finder is that there's something in begin</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3554" target="_blank">00:59:14.500</a></span> | <span class="t">batch which, just like our parameter scheduler, is using exponential curve to set the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3563" target="_blank">00:59:23.880</a></span> | <span class="t">rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3564" target="_blank">00:59:24.880</a></span> | <span class="t">So this is identical to parameter scheduler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3568" target="_blank">00:59:28.000</a></span> | <span class="t">And then after each step, it checks to see whether we've done more than the maximum number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3572" target="_blank">00:59:32.920</a></span> | <span class="t">of iterations, which is defaulting to 100, or whether the loss is much worse than the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3580" target="_blank">00:59:40.200</a></span> | <span class="t">best we've had so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3582" target="_blank">00:59:42.240</a></span> | <span class="t">And if either of those happens, we will raise cancel train exception.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3586" target="_blank">00:59:46.600</a></span> | <span class="t">So to be clear, this neat exception-based approach to control flow isn't being used in the fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3592" target="_blank">00:59:52.160</a></span> | <span class="t">AI version one at the moment, but it's very likely that fast AI 1.1 or 2 will switch to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3598" target="_blank">00:59:58.440</a></span> | <span class="t">this approach because it's just so much more convenient and flexible.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3602" target="_blank">01:00:02.880</a></span> | <span class="t">And then assuming we haven't canceled, just see if the loss is better than our best loss,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3606" target="_blank">01:00:06.520</a></span> | <span class="t">and if it is, then set best loss to the loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3613" target="_blank">01:00:13.280</a></span> | <span class="t">So now we can create a learner, we can add the LR find, we can fit, and you can see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3621" target="_blank">01:00:21.600</a></span> | <span class="t">it only does less than 100 epochs before it stops because the loss got a lot worse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3629" target="_blank">01:00:29.720</a></span> | <span class="t">And so now we know that we want something about there for our learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3634" target="_blank">01:00:34.880</a></span> | <span class="t">Okay, so now we have a learning rate finder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3642" target="_blank">01:00:42.080</a></span> | <span class="t">So let's go ahead and create a CNN, and specifically a scooter CNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3650" target="_blank">01:00:50.900</a></span> | <span class="t">So we'll keep doing the same stuff we've been doing, get our MNIST data, normalize it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3657" target="_blank">01:00:57.680</a></span> | <span class="t">Here's a nice little refactoring because we very often want to normalize with this dataset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3664" target="_blank">01:01:04.280</a></span> | <span class="t">and normalize both datasets using this dataset's mean and standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3668" target="_blank">01:01:08.180</a></span> | <span class="t">Let's create a function called normalize2, which does that and returns the normalized</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3672" target="_blank">01:01:12.440</a></span> | <span class="t">training set and the normalized validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3675" target="_blank">01:01:15.640</a></span> | <span class="t">So we can now use that, make sure that it's behaved properly, that looks good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3682" target="_blank">01:01:22.800</a></span> | <span class="t">Create our data bunch, and so now we're going to create a CNN model, and the CNN is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3689" target="_blank">01:01:29.280</a></span> | <span class="t">a sequential model that contains a bunch of stride two convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3695" target="_blank">01:01:35.920</a></span> | <span class="t">And remember the input's 28 by 28, so after the first it'll be 14 by 14, then 7 by 7,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3701" target="_blank">01:01:41.520</a></span> | <span class="t">then 4 by 4, then 2 by 2, then we'll do our average pooling, flatten it, and a linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3707" target="_blank">01:01:47.520</a></span> | <span class="t">layer, and then we're done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3711" target="_blank">01:01:51.540</a></span> | <span class="t">Now remember our original data is vectors of length 768, they're not 28 by 28, so we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3718" target="_blank">01:01:58.000</a></span> | <span class="t">need to do a Bax.view one channel by 28 by 28 because that's what nn.com2d expects, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3728" target="_blank">01:02:08.720</a></span> | <span class="t">then minus one, the batch size remains whatever it was before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3732" target="_blank">01:02:12.720</a></span> | <span class="t">So we need to somehow include this function in our nn.sequential, PyTorch doesn't support</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3739" target="_blank">01:02:19.280</a></span> | <span class="t">that by default, we could write our own class with a forward function, but nn.sequential</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3745" target="_blank">01:02:25.080</a></span> | <span class="t">is convenient for lots of ways, it has a nice representation, you can do all kinds of customizations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3750" target="_blank">01:02:30.100</a></span> | <span class="t">with it, so instead we create a layer called lambda, an nn.module called lambda, it just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3758" target="_blank">01:02:38.400</a></span> | <span class="t">pasted a function, and the forward is simply to call that function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3764" target="_blank">01:02:44.720</a></span> | <span class="t">And so now we can say lambda, MNIST resize, and that will cause that function to be called.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3771" target="_blank">01:02:51.840</a></span> | <span class="t">And here lambda flatten simply calls this function to be called, which removes that one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3778" target="_blank">01:02:58.400</a></span> | <span class="t">comma one axis at the end after the adaptive average pooling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3783" target="_blank">01:03:03.020</a></span> | <span class="t">So now we've got a CNN model, we can grab our callback functions and our optimizer and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3790" target="_blank">01:03:10.120</a></span> | <span class="t">our runner and we can run it, and six seconds later we get back one epochs result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3798" target="_blank">01:03:18.880</a></span> | <span class="t">So that's at this point now getting a bit slow, so let's make it faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3804" target="_blank">01:03:24.300</a></span> | <span class="t">So let's use CUDA, let's pop it on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3807" target="_blank">01:03:27.940</a></span> | <span class="t">So we need to do two things, we need to put the model on the GPU, which specifically means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3813" target="_blank">01:03:33.800</a></span> | <span class="t">the model's parameters on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3818" target="_blank">01:03:38.840</a></span> | <span class="t">So remember a model contains two kinds of numbers, parameters, they're the things that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3822" target="_blank">01:03:42.240</a></span> | <span class="t">you're updating, the things that it stores, and there's the activations, there's the things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3826" target="_blank">01:03:46.720</a></span> | <span class="t">that it's calculating.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3828" target="_blank">01:03:48.000</a></span> | <span class="t">So it's the parameters that we need to actually put on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3831" target="_blank">01:03:51.900</a></span> | <span class="t">And the inputs to the model and the loss function, so in other words the things that come out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3836" target="_blank">01:03:56.240</a></span> | <span class="t">of the data loader we need to put those on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3838" target="_blank">01:03:58.960</a></span> | <span class="t">How do we do that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3839" target="_blank">01:03:59.960</a></span> | <span class="t">With a callback of course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3842" target="_blank">01:04:02.800</a></span> | <span class="t">So here's a CUDA callback, when you initialize it you pass it a device and then when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3849" target="_blank">01:04:09.240</a></span> | <span class="t">begin fitting you move the model to that device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3853" target="_blank">01:04:13.920</a></span> | <span class="t">So model.2.2 is part of PyTorch, it moves something with parameters or a tensor to a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3862" target="_blank">01:04:22.760</a></span> | <span class="t">device and you can create a device by calling torch.device, pass it the string CUDA, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3869" target="_blank">01:04:29.240</a></span> | <span class="t">whatever GPU number you want to use, if you only have one GPU, it's device0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3875" target="_blank">01:04:35.600</a></span> | <span class="t">Then when we begin a batch, let's go back and look at our runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3883" target="_blank">01:04:43.160</a></span> | <span class="t">When we begin a batch, we've put xbatch and ybatch inside self.xb and self.yb.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3892" target="_blank">01:04:52.080</a></span> | <span class="t">So that means we can change them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3894" target="_blank">01:04:54.520</a></span> | <span class="t">So let's set the runner's xb and the runner's yb to whatever they were before, but move</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3900" target="_blank">01:05:00.400</a></span> | <span class="t">to the device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3903" target="_blank">01:05:03.580</a></span> | <span class="t">So that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3905" target="_blank">01:05:05.120</a></span> | <span class="t">That's going to run everything on CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3907" target="_blank">01:05:07.400</a></span> | <span class="t">That's all we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3909" target="_blank">01:05:09.360</a></span> | <span class="t">This is kind of flexible because we can put things on any device we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3914" target="_blank">01:05:14.000</a></span> | <span class="t">Maybe more easily is just to call this once, which is torch.cuda.setdevice, and you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3919" target="_blank">01:05:19.560</a></span> | <span class="t">even need to do this if you've only got one GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3922" target="_blank">01:05:22.200</a></span> | <span class="t">And then everything by default will now be sent to that device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3925" target="_blank">01:05:25.280</a></span> | <span class="t">And then instead of saying .2device, we can just say .cuda.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3929" target="_blank">01:05:29.800</a></span> | <span class="t">And so since we're doing pretty much everything with just one GPU for this course, this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3933" target="_blank">01:05:33.880</a></span> | <span class="t">the one we're going to export.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3935" target="_blank">01:05:35.720</a></span> | <span class="t">So just model.cuda, xb.cuda, yb.cuda.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3940" target="_blank">01:05:40.580</a></span> | <span class="t">So that's our CUDA callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3942" target="_blank">01:05:42.240</a></span> | <span class="t">So let's add that to our callback functions, grab our model and our runner and fit, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3947" target="_blank">01:05:47.480</a></span> | <span class="t">now we can do three epochs in five seconds versus one epoch in six seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3952" target="_blank">01:05:52.000</a></span> | <span class="t">So that's a lot better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3953" target="_blank">01:05:53.600</a></span> | <span class="t">And for a much deeper model, it'll be dozens of times faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3957" target="_blank">01:05:57.920</a></span> | <span class="t">So this is literally all we need to use CUDA.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3961" target="_blank">01:06:01.360</a></span> | <span class="t">So that was nice and easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3964" target="_blank">01:06:04.520</a></span> | <span class="t">Now we want to make it easier to create different kinds of architectures, make things a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3969" target="_blank">01:06:09.280</a></span> | <span class="t">easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3970" target="_blank">01:06:10.280</a></span> | <span class="t">So the first thing we should do is recognize that we go conv.value a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3974" target="_blank">01:06:14.800</a></span> | <span class="t">So let's pop that into a function called conv2d that just goes conv.value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3979" target="_blank">01:06:19.220</a></span> | <span class="t">Since we use a kernel size of three and a stride of two in this MNIST model a lot, let's make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3983" target="_blank">01:06:23.560</a></span> | <span class="t">those defaults.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3986" target="_blank">01:06:26.080</a></span> | <span class="t">Also this model we can't reuse for anything except MNIST because it has a MNIST resize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3994" target="_blank">01:06:34.840</a></span> | <span class="t">at the start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3996" target="_blank">01:06:36.100</a></span> | <span class="t">So we need to remove that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=3997" target="_blank">01:06:37.960</a></span> | <span class="t">So if we're going to remove that, something else is going to have to do the resizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4001" target="_blank">01:06:41.880</a></span> | <span class="t">And of course the answer to that is a callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4005" target="_blank">01:06:45.600</a></span> | <span class="t">So here's a callback which transforms the independent variable, the x, for a batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4015" target="_blank">01:06:55.000</a></span> | <span class="t">And so you pass it some transformation function, which it stores away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4020" target="_blank">01:07:00.000</a></span> | <span class="t">And then begin batch simply replaces the batch with the result of that transformation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4024" target="_blank">01:07:04.960</a></span> | <span class="t">So now we can simply append another callback, which is the partial function application</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4029" target="_blank">01:07:09.840</a></span> | <span class="t">of that callback with this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4036" target="_blank">01:07:16.160</a></span> | <span class="t">And this function is just to view something at one by 28 by 28.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4043" target="_blank">01:07:23.040</a></span> | <span class="t">And you can see here we've used the trick we saw earlier of using underscore inner to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4049" target="_blank">01:07:29.520</a></span> | <span class="t">define a function and then return it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4051" target="_blank">01:07:31.560</a></span> | <span class="t">So this is something which creates a new view function that views it in this size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4057" target="_blank">01:07:37.620</a></span> | <span class="t">So for those of you that aren't that comfortable with closures and partial function application,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4064" target="_blank">01:07:44.200</a></span> | <span class="t">this is a great piece of code to study, experiment, make sure that you feel comfortable with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4072" target="_blank">01:07:52.160</a></span> | <span class="t">So using this approach, we now have the MNIST view resizing as a callback, which means we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4080" target="_blank">01:08:00.600</a></span> | <span class="t">can remove it from the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4082" target="_blank">01:08:02.580</a></span> | <span class="t">So now we can create a generic getCNN model function that returns a sequential model containing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4090" target="_blank">01:08:10.160</a></span> | <span class="t">some arbitrary set of layers, containing some arbitrary set of filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4096" target="_blank">01:08:16.500</a></span> | <span class="t">So we're going to say, OK, this is the number of filters I have per layer, 8, 16, 32, 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4104" target="_blank">01:08:24.200</a></span> | <span class="t">And so here is my getCNN layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4108" target="_blank">01:08:28.080</a></span> | <span class="t">And the last few layers is the average pooling, flattening, and the linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4114" target="_blank">01:08:34.680</a></span> | <span class="t">The first few layers is for every one of those filters, length of the filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4118" target="_blank">01:08:38.800</a></span> | <span class="t">It's a conv2D from that filter to the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4123" target="_blank">01:08:43.800</a></span> | <span class="t">And then what's the kernel size?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4128" target="_blank">01:08:48.440</a></span> | <span class="t">The kernel size depends.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4131" target="_blank">01:08:51.160</a></span> | <span class="t">It's a kernel size of 5 for the first layer, or 3 otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4138" target="_blank">01:08:58.600</a></span> | <span class="t">Why is that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4140" target="_blank">01:09:00.800</a></span> | <span class="t">Well, the number of filters we had for the first layer was 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4149" target="_blank">01:09:09.480</a></span> | <span class="t">And that's a pretty reasonable starting point for a small model to start with 8 filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4153" target="_blank">01:09:13.680</a></span> | <span class="t">And remember, our image had a single channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4158" target="_blank">01:09:18.560</a></span> | <span class="t">And imagine if we had a single channel, and we were using 3 by 3 filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4164" target="_blank">01:09:24.040</a></span> | <span class="t">So as that convolution kernel scrolls through the image, at each point in time, it's looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4169" target="_blank">01:09:29.760</a></span> | <span class="t">at a 3 by 3 window.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4173" target="_blank">01:09:33.280</a></span> | <span class="t">And it's just one channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4177" target="_blank">01:09:37.240</a></span> | <span class="t">So in total, there's 9 input activations that it's looking at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4185" target="_blank">01:09:45.100</a></span> | <span class="t">And then it spits those into a dot product with-- sorry, it spits those into 8 dot products,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4195" target="_blank">01:09:55.480</a></span> | <span class="t">so a matrix multiplication, I should say, 8 by 9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4204" target="_blank">01:10:04.840</a></span> | <span class="t">And out of that will come a vector of length 8.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4213" target="_blank">01:10:13.360</a></span> | <span class="t">Because we said we wanted 8 filters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4215" target="_blank">01:10:15.800</a></span> | <span class="t">So that's what a convolution does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4219" target="_blank">01:10:19.480</a></span> | <span class="t">And this seems pretty pointless.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4221" target="_blank">01:10:21.680</a></span> | <span class="t">Because we started with 9 numbers, and we ended it with 8 numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4226" target="_blank">01:10:26.800</a></span> | <span class="t">So all we're really doing is just reordering them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4229" target="_blank">01:10:29.980</a></span> | <span class="t">It's not really doing any useful computation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4232" target="_blank">01:10:32.560</a></span> | <span class="t">So there's no point making your first layer basically just shuffle the numbers into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4239" target="_blank">01:10:39.760</a></span> | <span class="t">different order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4242" target="_blank">01:10:42.120</a></span> | <span class="t">So what you'll find happens in, for example, most ImageNet models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4246" target="_blank">01:10:46.760</a></span> | <span class="t">Most ImageNet models are a little bit different, because they have three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4250" target="_blank">01:10:50.640</a></span> | <span class="t">So it's actually 3 by 3 by 3, which is 27.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4259" target="_blank">01:10:59.080</a></span> | <span class="t">But it's still kind of like-- quite often with ImageNet models, the first layer will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4264" target="_blank">01:11:04.240</a></span> | <span class="t">be like 32 channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4267" target="_blank">01:11:07.240</a></span> | <span class="t">So going from 27 to 32 is literally losing information.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4271" target="_blank">01:11:11.320</a></span> | <span class="t">So most ImageNet models, they actually make the first layer 7 by 7, not 3 by 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4279" target="_blank">01:11:19.560</a></span> | <span class="t">And so for a similar reason, we're going to make our first layer 5 by 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4284" target="_blank">01:11:24.400</a></span> | <span class="t">So we'll have 25 inputs for our 8 outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4288" target="_blank">01:11:28.840</a></span> | <span class="t">So this is the kind of things that you want to be thinking about when you're designing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4293" target="_blank">01:11:33.400</a></span> | <span class="t">or reviewing an architecture, is like how many numbers are actually going into that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4297" target="_blank">01:11:37.760</a></span> | <span class="t">little dot product that happens inside your CNN kernel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4304" target="_blank">01:11:44.600</a></span> | <span class="t">So that's something which can give us a CNN model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4308" target="_blank">01:11:48.560</a></span> | <span class="t">So let's pop it all together into a little function that just grabs an optimization function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4312" target="_blank">01:11:52.760</a></span> | <span class="t">grabs an optimizer, grabs a learner, grabs a runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4316" target="_blank">01:11:56.560</a></span> | <span class="t">And at this point, if you can't remember what any of these things does, remember, we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4319" target="_blank">01:11:59.840</a></span> | <span class="t">built them all by hand from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4322" target="_blank">01:12:02.160</a></span> | <span class="t">So go back and see what we wrote.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4325" target="_blank">01:12:05.400</a></span> | <span class="t">There's no magic here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4328" target="_blank">01:12:08.400</a></span> | <span class="t">And so let's look if we say getCNNModel, passing in 8, 16, 32, 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4334" target="_blank">01:12:14.680</a></span> | <span class="t">Here you can see 8, 16, 32, 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4338" target="_blank">01:12:18.240</a></span> | <span class="t">Here's our 5 by 5, the rest are 3 by 3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4341" target="_blank">01:12:21.120</a></span> | <span class="t">They all have a stride of 2, and then a linear layer, and then train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4346" target="_blank">01:12:26.200</a></span> | <span class="t">So at this point, we've got a fairly general simple CNN creator that we can fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4353" target="_blank">01:12:33.800</a></span> | <span class="t">And so let's try to find out what's going on inside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4357" target="_blank">01:12:37.120</a></span> | <span class="t">How do we make this number higher?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4359" target="_blank">01:12:39.200</a></span> | <span class="t">How do we make it train more stably?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4361" target="_blank">01:12:41.720</a></span> | <span class="t">How do we make it train more quickly?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4363" target="_blank">01:12:43.800</a></span> | <span class="t">Well, we really want to see what's going on inside.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4366" target="_blank">01:12:46.880</a></span> | <span class="t">We know already that different ways of initializing changes the variance of different layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4373" target="_blank">01:12:53.600</a></span> | <span class="t">How do we find out if it's saturating somewhere, if it's too small, if it's too big, what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4378" target="_blank">01:12:58.680</a></span> | <span class="t">going on?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4380" target="_blank">01:13:00.580</a></span> | <span class="t">So what if we replace nn.Sequential with our own sequential model class?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4387" target="_blank">01:13:07.960</a></span> | <span class="t">And if you remember back, we've already built our own sequential model class before, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4391" target="_blank">01:13:11.800</a></span> | <span class="t">it just had these two lines of code, plus return.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4394" target="_blank">01:13:14.860</a></span> | <span class="t">So let's keep the same two lines of code, but also add two more lines of code that grabs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4399" target="_blank">01:13:19.880</a></span> | <span class="t">the mean of the outputs and the standard deviation of the outputs, and saves them away inside</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4407" target="_blank">01:13:27.000</a></span> | <span class="t">a bunch of lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4408" target="_blank">01:13:28.920</a></span> | <span class="t">So here's a list for every layer, for means, and a list for every layer for standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4417" target="_blank">01:13:37.280</a></span> | <span class="t">So let's calculate the mean of standard deviations, pop them inside those two lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4422" target="_blank">01:13:42.580</a></span> | <span class="t">And so now it's a sequential model that also keeps track of what's going on, the telemetry</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4428" target="_blank">01:13:48.160</a></span> | <span class="t">of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4430" target="_blank">01:13:50.100</a></span> | <span class="t">So we can now create it in the same way as usual, fit it in the same way as usual, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4434" target="_blank">01:13:54.080</a></span> | <span class="t">now our model has two extra things in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4436" target="_blank">01:13:56.060</a></span> | <span class="t">It has an act means, and it acts standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4439" target="_blank">01:13:59.900</a></span> | <span class="t">So let's plot the act means for every one of those lists that we had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4446" target="_blank">01:14:06.840</a></span> | <span class="t">And here it is, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4448" target="_blank">01:14:08.080</a></span> | <span class="t">Here's all of the different means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4450" target="_blank">01:14:10.920</a></span> | <span class="t">And you can see it looks absolutely awful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4455" target="_blank">01:14:15.520</a></span> | <span class="t">What happens early in training is every layer, the means get exponentially bigger until they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4463" target="_blank">01:14:23.520</a></span> | <span class="t">suddenly collapse, and then it happens again, and it suddenly collapses, and it happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4468" target="_blank">01:14:28.260</a></span> | <span class="t">again, and it suddenly collapses until eventually, it kind of starts training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4476" target="_blank">01:14:36.440</a></span> | <span class="t">So you might think, well, it's eventually training, so isn't this okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4484" target="_blank">01:14:44.320</a></span> | <span class="t">But my concern would be this thing where it kind of falls off a cliff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4490" target="_blank">01:14:50.040</a></span> | <span class="t">There's lots of parameters in our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4494" target="_blank">01:14:54.520</a></span> | <span class="t">Are we sure that all of them are getting back into reasonable places, or is it just that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4499" target="_blank">01:14:59.480</a></span> | <span class="t">a few of them have got back into a reasonable place?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4501" target="_blank">01:15:01.960</a></span> | <span class="t">Maybe the vast majority of them have zero gradients at this point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4505" target="_blank">01:15:05.840</a></span> | <span class="t">I don't know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4507" target="_blank">01:15:07.060</a></span> | <span class="t">It seems very likely that this awful training profile early in training is leaving our model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4514" target="_blank">01:15:14.000</a></span> | <span class="t">in a really sad state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4516" target="_blank">01:15:16.120</a></span> | <span class="t">That's my guess, and we're going to check it to see later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4518" target="_blank">01:15:18.520</a></span> | <span class="t">But for now, we're just going to say, let's try to make this not happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4523" target="_blank">01:15:23.680</a></span> | <span class="t">And let's also look at the standard deviations, and you see exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4529" target="_blank">01:15:29.060</a></span> | <span class="t">This just looks really bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4532" target="_blank">01:15:32.440</a></span> | <span class="t">So let's look at just the first 10 means, and they all look okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4537" target="_blank">01:15:37.640</a></span> | <span class="t">They're all pretty close-ish to zero, which is about what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4541" target="_blank">01:15:41.840</a></span> | <span class="t">But more importantly, let's look at the standard deviations for the first 10 batches, and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4546" target="_blank">01:15:46.560</a></span> | <span class="t">is a problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4547" target="_blank">01:15:47.960</a></span> | <span class="t">The first layer has a standard deviation not too far away from one, but then, not surprisingly,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4556" target="_blank">01:15:56.680</a></span> | <span class="t">the next layer is lower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4559" target="_blank">01:15:59.160</a></span> | <span class="t">The next layer is lower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4560" target="_blank">01:16:00.760</a></span> | <span class="t">As we would expect, because the first layer is less than one, the following layers are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4565" target="_blank">01:16:05.240</a></span> | <span class="t">getting exponentially further away from one, until the last layer is really close to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4574" target="_blank">01:16:14.600</a></span> | <span class="t">So now we can kind of see what was going on here, is that our final layers were getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4581" target="_blank">01:16:21.720</a></span> | <span class="t">basically no activations, they were basically getting no gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4585" target="_blank">01:16:25.240</a></span> | <span class="t">So gradually, it was moving into spaces where they actually at least had some gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4590" target="_blank">01:16:30.340</a></span> | <span class="t">But by the time they kind of got there, the gradient was so fast that they were kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4596" target="_blank">01:16:36.760</a></span> | <span class="t">falling off a cliff and having to start again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4600" target="_blank">01:16:40.760</a></span> | <span class="t">So this is the thing we're going to try and fix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4603" target="_blank">01:16:43.360</a></span> | <span class="t">And we think we already know how to, we can use some initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4606" target="_blank">01:16:46.800</a></span> | <span class="t">Yes, Rachel?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4611" target="_blank">01:16:51.120</a></span> | <span class="t">Did you say that if we went from 27 numbers to 32, that we were losing information?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4615" target="_blank">01:16:55.280</a></span> | <span class="t">And could you say more about what that means?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4618" target="_blank">01:16:58.320</a></span> | <span class="t">Yeah, I guess we're not losing information where, that was poorly said, where we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4627" target="_blank">01:17:07.280</a></span> | <span class="t">wasting information, I guess, where like that, if you start with 27 numbers and you do some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4632" target="_blank">01:17:12.640</a></span> | <span class="t">matrix multiplication and end up with 32 numbers, you are now taking more space for the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4640" target="_blank">01:17:20.400</a></span> | <span class="t">information you started with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4642" target="_blank">01:17:22.280</a></span> | <span class="t">And the whole point of a neural network layer is to pull out some interesting features.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4648" target="_blank">01:17:28.360</a></span> | <span class="t">So you would expect to have less total activations going on because you're trying to say, oh,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4657" target="_blank">01:17:37.480</a></span> | <span class="t">in this area, I've kind of pulled this set of pixels down into something that says how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4663" target="_blank">01:17:43.920</a></span> | <span class="t">fairy this is or how much of a diagonal line does this have or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4668" target="_blank">01:17:48.800</a></span> | <span class="t">So increasing the actual number of activations we have for a particular position is a total</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4680" target="_blank">01:18:00.200</a></span> | <span class="t">waste of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4681" target="_blank">01:18:01.200</a></span> | <span class="t">We're not doing any useful, we're wasting a lot of calculation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4689" target="_blank">01:18:09.400</a></span> | <span class="t">We can talk more about that on the forum if that's still not clear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4699" target="_blank">01:18:19.900</a></span> | <span class="t">So this idea of creating telemetry for your model is really vital.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4704" target="_blank">01:18:24.560</a></span> | <span class="t">This approach to doing it, where you actually write a whole new class that only can do one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4708" target="_blank">01:18:28.960</a></span> | <span class="t">kind of telemetry is clearly stupid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4713" target="_blank">01:18:33.100</a></span> | <span class="t">And so we clearly need a better way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4715" target="_blank">01:18:35.160</a></span> | <span class="t">And what's the better way to do it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4717" target="_blank">01:18:37.040</a></span> | <span class="t">It's callbacks, of course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4719" target="_blank">01:18:39.680</a></span> | <span class="t">Except we can't use our callbacks because we don't have a callback that says when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4724" target="_blank">01:18:44.040</a></span> | <span class="t">calculate this layer, call back to our code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4728" target="_blank">01:18:48.080</a></span> | <span class="t">We have no way to do that, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4730" target="_blank">01:18:50.620</a></span> | <span class="t">So we actually need to use a feature inside PyTorch that can call back into our code when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4738" target="_blank">01:18:58.880</a></span> | <span class="t">a layer is calculated, either the forward pass or the backward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4743" target="_blank">01:19:03.280</a></span> | <span class="t">And for reasons I can't begin to imagine PyTorch doesn't call them callbacks, they're called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4748" target="_blank">01:19:08.440</a></span> | <span class="t">hooks, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4749" target="_blank">01:19:09.440</a></span> | <span class="t">But it's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4750" target="_blank">01:19:10.520</a></span> | <span class="t">It's a callback, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4752" target="_blank">01:19:12.120</a></span> | <span class="t">And so we can say for any module, we can say register forward hook and pass in a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4761" target="_blank">01:19:21.680</a></span> | <span class="t">This is a callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4762" target="_blank">01:19:22.680</a></span> | <span class="t">It's a callback that will be called when this module's forward pass is calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4768" target="_blank">01:19:28.960</a></span> | <span class="t">Or you could say register backward hook and that will call this function when this module's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4774" target="_blank">01:19:34.680</a></span> | <span class="t">backward pass is calculated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4777" target="_blank">01:19:37.600</a></span> | <span class="t">So to replace that previous thing with hooks, we can simply create a couple of global variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4784" target="_blank">01:19:44.200</a></span> | <span class="t">to store our means and standard deviations for every layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4787" target="_blank">01:19:47.480</a></span> | <span class="t">We can create a function to call back to to calculate the mean and standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4793" target="_blank">01:19:53.960</a></span> | <span class="t">And if you Google for the documentation for register forward hook, you will find that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4800" target="_blank">01:20:00.120</a></span> | <span class="t">it will tell you that the callback will be called with three things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4806" target="_blank">01:20:06.040</a></span> | <span class="t">The module that's doing the callback, the input to the module, and the output of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4811" target="_blank">01:20:11.680</a></span> | <span class="t">module, either the forward or the backward pass is appropriate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4815" target="_blank">01:20:15.680</a></span> | <span class="t">In our case, it's the output we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4818" target="_blank">01:20:18.120</a></span> | <span class="t">And then we've got a fourth thing here because this is the layer number we're looking at,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4822" target="_blank">01:20:22.280</a></span> | <span class="t">and we used partial to connect the appropriate closure with each layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4828" target="_blank">01:20:28.880</a></span> | <span class="t">So once we've done that, we can call fit, and we can do exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4833" target="_blank">01:20:33.080</a></span> | <span class="t">So this is the same thing, just much more convenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4836" target="_blank">01:20:36.280</a></span> | <span class="t">And because this is such a handy thing to be able to do, fast.ai has a hook class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4841" target="_blank">01:20:41.600</a></span> | <span class="t">So we can create our own hook class now, which allows us to, rather than having this kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4846" target="_blank">01:20:46.560</a></span> | <span class="t">of messy global state, we can instead put the state inside the hook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4852" target="_blank">01:20:52.720</a></span> | <span class="t">So let's create a class called hook that when you initialize it, it registers a forward</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4856" target="_blank">01:20:56.560</a></span> | <span class="t">hook on some function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4861" target="_blank">01:21:01.320</a></span> | <span class="t">And what it's going to do is it's going to recall back to this object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4867" target="_blank">01:21:07.480</a></span> | <span class="t">So we pass in self with the partial.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4870" target="_blank">01:21:10.220</a></span> | <span class="t">And so that way, we can get access to the hook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4873" target="_blank">01:21:13.660</a></span> | <span class="t">We can pop inside it our two empty lists when we first call this to store away our means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4880" target="_blank">01:21:20.160</a></span> | <span class="t">and standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4882" target="_blank">01:21:22.040</a></span> | <span class="t">And then we can just append our means and standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4884" target="_blank">01:21:24.360</a></span> | <span class="t">So now, we just go hooks equals hook for layer in children of my model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4892" target="_blank">01:21:32.680</a></span> | <span class="t">And we'll just grab the first two layers because I don't care so much about the linear layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4896" target="_blank">01:21:36.640</a></span> | <span class="t">It's really the conf layers that are most interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4899" target="_blank">01:21:39.340</a></span> | <span class="t">And so now, this does exactly the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4904" target="_blank">01:21:44.380</a></span> | <span class="t">Since we do this a lot, let's put that into a class two called hooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4911" target="_blank">01:21:51.000</a></span> | <span class="t">So here's our hooks class, which simply calls hook for every module in some list of modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4921" target="_blank">01:22:01.480</a></span> | <span class="t">Now something to notice is that when you're done using a hooked module, you should call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4928" target="_blank">01:22:08.440</a></span> | <span class="t">hook.remove.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4931" target="_blank">01:22:11.200</a></span> | <span class="t">Because otherwise, if you keep registering more hooks on the same module, they're all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4935" target="_blank">01:22:15.640</a></span> | <span class="t">going to get called.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4936" target="_blank">01:22:16.640</a></span> | <span class="t">And eventually, you're going to run out of memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4939" target="_blank">01:22:19.040</a></span> | <span class="t">So one thing I did in our hook class was I created a dunder dell.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4943" target="_blank">01:22:23.720</a></span> | <span class="t">This is called automatically when Python cleans up some memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4948" target="_blank">01:22:28.400</a></span> | <span class="t">So when it's done with your hook, it will automatically call remove, which in turn will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4955" target="_blank">01:22:35.080</a></span> | <span class="t">remove the hook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4957" target="_blank">01:22:37.080</a></span> | <span class="t">So I then have a similar thing in hooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4961" target="_blank">01:22:41.620</a></span> | <span class="t">So when hooks is done, it calls self.remove, which in turn goes through every one of my</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4970" target="_blank">01:22:50.000</a></span> | <span class="t">registered hooks and removes them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4977" target="_blank">01:22:57.640</a></span> | <span class="t">You'll see that somehow I'm able to go for H in self, but I haven't registered any kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4986" target="_blank">01:23:06.880</a></span> | <span class="t">of iterator here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4988" target="_blank">01:23:08.360</a></span> | <span class="t">And the trick is I've created something called a list container just above, which is super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4993" target="_blank">01:23:13.880</a></span> | <span class="t">handy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=4994" target="_blank">01:23:14.880</a></span> | <span class="t">It basically defines all the things you would expect to see in a list using all of the various</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5002" target="_blank">01:23:22.600</a></span> | <span class="t">special dunder methods and then some.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5005" target="_blank">01:23:25.880</a></span> | <span class="t">It actually has some of the behavior of numpy as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5010" target="_blank">01:23:30.000</a></span> | <span class="t">We're not allowed to use numpy in our foundations, so we use this instead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5013" target="_blank">01:23:33.440</a></span> | <span class="t">And this actually also works a bit better than numpy for this stuff because numpy does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5017" target="_blank">01:23:37.200</a></span> | <span class="t">some weird casting and weird edge cases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5021" target="_blank">01:23:41.200</a></span> | <span class="t">So for example, with this list container, it's got dunder get item.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5025" target="_blank">01:23:45.960</a></span> | <span class="t">So that's the thing that gets called when you call something with square brackets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5031" target="_blank">01:23:51.000</a></span> | <span class="t">So if you index into it with an int, then we just pass it off to the enclosed list because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5039" target="_blank">01:23:59.680</a></span> | <span class="t">we gave it a list to enclose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5042" target="_blank">01:24:02.220</a></span> | <span class="t">If you send it a list of balls, like false, false, false, false, false, false, false,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5050" target="_blank">01:24:10.200</a></span> | <span class="t">then it will return all of the things where that's true, or you can index it into it with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5056" target="_blank">01:24:16.760</a></span> | <span class="t">a list, in which case it will return all of the index, the things that are indexed by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5062" target="_blank">01:24:22.360</a></span> | <span class="t">that list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5063" target="_blank">01:24:23.360</a></span> | <span class="t">For instance, it's got a length which just passes off to length and an iterator that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5066" target="_blank">01:24:26.760</a></span> | <span class="t">passes off to iterator and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5071" target="_blank">01:24:31.400</a></span> | <span class="t">And then we've also defined the representation for it such that if you print it out, it just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5076" target="_blank">01:24:36.960</a></span> | <span class="t">prints out the contents unless there's more than 10 things in it, in which case it shows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5081" target="_blank">01:24:41.480</a></span> | <span class="t">dot, dot, dot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5083" target="_blank">01:24:43.680</a></span> | <span class="t">So with a nice little base class like this, so you can create really useful little base</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5089" target="_blank">01:24:49.160</a></span> | <span class="t">classes in much less than a screen full of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5093" target="_blank">01:24:53.120</a></span> | <span class="t">And then we can use them, and we will use them everywhere from now on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5096" target="_blank">01:24:56.280</a></span> | <span class="t">So now we've created our own listy class that has hooks in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5104" target="_blank">01:25:04.160</a></span> | <span class="t">And so now we can just use it like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5105" target="_blank">01:25:05.480</a></span> | <span class="t">We can just say hooks equals hooks, everything in our model with that function we had before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5111" target="_blank">01:25:11.960</a></span> | <span class="t">to pen stats, we can print it out to see all the hooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5115" target="_blank">01:25:15.920</a></span> | <span class="t">We can grab a batch of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5119" target="_blank">01:25:19.400</a></span> | <span class="t">So now we've got one batch of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5122" target="_blank">01:25:22.040</a></span> | <span class="t">And check its mean and standard deviation is about zero one, as you would expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5126" target="_blank">01:25:26.060</a></span> | <span class="t">We can pass it through the first layer of our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5129" target="_blank">01:25:29.000</a></span> | <span class="t">Model zero is the first layer of our model, which is the first convolution.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5132" target="_blank">01:25:32.880</a></span> | <span class="t">And our mean is not quite zero, and our standard deviation is quite a lot less than one, as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5138" target="_blank">01:25:38.240</a></span> | <span class="t">we kind of know what's going to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5141" target="_blank">01:25:41.080</a></span> | <span class="t">So now we'll just go ahead and initialize it with timing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5144" target="_blank">01:25:44.280</a></span> | <span class="t">And after that, our variance is quite close to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5148" target="_blank">01:25:48.120</a></span> | <span class="t">And our mean, as expected, is quite close to 0.5 because of the value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5157" target="_blank">01:25:57.280</a></span> | <span class="t">So now we can go ahead and create our hooks and do a fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5163" target="_blank">01:26:03.440</a></span> | <span class="t">And we can plot the first 10 means and standard deviations, and then we can plot all the means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5168" target="_blank">01:26:08.080</a></span> | <span class="t">and standard deviations, and there it all is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5171" target="_blank">01:26:11.800</a></span> | <span class="t">And this time we're doing it after we've initialized all the layers of our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5178" target="_blank">01:26:18.000</a></span> | <span class="t">And as you can see, we don't have that awful exponential crash, exponential crash, exponential</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5184" target="_blank">01:26:24.520</a></span> | <span class="t">crash.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5185" target="_blank">01:26:25.520</a></span> | <span class="t">So this is looking much better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5187" target="_blank">01:26:27.440</a></span> | <span class="t">And you can see early on in training, our variances all look, our standard deviations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5192" target="_blank">01:26:32.400</a></span> | <span class="t">all look much closer to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5194" target="_blank">01:26:34.800</a></span> | <span class="t">So this is looking super hopeful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5198" target="_blank">01:26:38.360</a></span> | <span class="t">I've used a with block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5200" target="_blank">01:26:40.440</a></span> | <span class="t">A with block is something that will create this object, give it this name, and when it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5208" target="_blank">01:26:48.040</a></span> | <span class="t">finished, it will do something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5211" target="_blank">01:26:51.040</a></span> | <span class="t">The something it does is to call your dunder exit method here, which will not remove.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5219" target="_blank">01:26:59.080</a></span> | <span class="t">So here's a nice way to ensure that things are cleaned up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5222" target="_blank">01:27:02.680</a></span> | <span class="t">For example, your hooks are removed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5226" target="_blank">01:27:06.880</a></span> | <span class="t">So that's why we have a dunder enter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5228" target="_blank">01:27:08.520</a></span> | <span class="t">That's what happens when you start the with block, dunder exit when you finish the with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5231" target="_blank">01:27:11.800</a></span> | <span class="t">block.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5235" target="_blank">01:27:15.520</a></span> | <span class="t">So this is looking very hopeful, but it's not quite what we wanted to know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5240" target="_blank">01:27:20.720</a></span> | <span class="t">Really the concern was, does this actually do something bad?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5246" target="_blank">01:27:26.120</a></span> | <span class="t">Is it actually, or does it just train fine afterwards?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5249" target="_blank">01:27:29.520</a></span> | <span class="t">So something bad really is more about how many of the activations are really, really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5255" target="_blank">01:27:35.080</a></span> | <span class="t">small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5256" target="_blank">01:27:36.080</a></span> | <span class="t">How well is it actually getting everything activated nicely?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5260" target="_blank">01:27:40.280</a></span> | <span class="t">So what we could do is we could adjust our append stats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5263" target="_blank">01:27:43.400</a></span> | <span class="t">So not only does it have a mean and a standard deviation, but it's also got a histogram.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5269" target="_blank">01:27:49.600</a></span> | <span class="t">So we could create a histogram of the activations, pop them into 40 bins between 0 and 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5278" target="_blank">01:27:58.040</a></span> | <span class="t">We don't need to go underneath 0 because we have a value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5280" target="_blank">01:28:00.840</a></span> | <span class="t">So we know that there's none underneath 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5283" target="_blank">01:28:03.600</a></span> | <span class="t">So let's again run this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5287" target="_blank">01:28:07.040</a></span> | <span class="t">We will use our timing initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5294" target="_blank">01:28:14.040</a></span> | <span class="t">And what we find is that even with that, if we make our learning rate really high, 0.9,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5306" target="_blank">01:28:26.640</a></span> | <span class="t">we can still get this same behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5308" target="_blank">01:28:28.600</a></span> | <span class="t">And so here's plotting the entire histogram.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5310" target="_blank">01:28:30.560</a></span> | <span class="t">And I should say thank you to Stefano for the original code here from our San Francisco</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5315" target="_blank">01:28:35.840</a></span> | <span class="t">study group to plot these nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5318" target="_blank">01:28:38.760</a></span> | <span class="t">So you can see this kind of grow, collapse, grow, collapse, grow, collapse thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5325" target="_blank">01:28:45.520</a></span> | <span class="t">The biggest concern for me though is this yellow line at the bottom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5331" target="_blank">01:28:51.000</a></span> | <span class="t">The yellow line, yellow is where most of the histogram is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5334" target="_blank">01:28:54.640</a></span> | <span class="t">Actually, what I really care about is how much yellow is there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5339" target="_blank">01:28:59.440</a></span> | <span class="t">So let's say the first two histogram bins are 0 or nearly 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5347" target="_blank">01:29:07.180</a></span> | <span class="t">So let's get the sum of how much is in those two bins and divide by the sum of all of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5352" target="_blank">01:29:12.480</a></span> | <span class="t">bins.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5353" target="_blank">01:29:13.600</a></span> | <span class="t">And so that's going to tell us what percentage of the activations are 0 or nearly 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5361" target="_blank">01:29:21.800</a></span> | <span class="t">Let's plot that for each of the first four layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5365" target="_blank">01:29:25.320</a></span> | <span class="t">And you can see that in the last layer, it's just as we suspected, over 90% of the activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5373" target="_blank">01:29:33.800</a></span> | <span class="t">are actually 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5375" target="_blank">01:29:35.560</a></span> | <span class="t">So if you were training your model like this, it could eventually look like it's training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5380" target="_blank">01:29:40.120</a></span> | <span class="t">nicely without you realizing that 90% of your activations were totally wasted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5385" target="_blank">01:29:45.760</a></span> | <span class="t">And so you're never going to get great results by wasting 90% of your activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5390" target="_blank">01:29:50.600</a></span> | <span class="t">So let's try and fix it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5392" target="_blank">01:29:52.800</a></span> | <span class="t">Let's try and be able to train at a nice high learning rate and not have this happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5397" target="_blank">01:29:57.340</a></span> | <span class="t">And so the trick is, is we're going to try a few things, but the main one is we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5401" target="_blank">01:30:01.160</a></span> | <span class="t">to use our better ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5404" target="_blank">01:30:04.840</a></span> | <span class="t">And so we've created a generalized ReLU class where now we can pass in things like an amount</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5411" target="_blank">01:30:11.200</a></span> | <span class="t">to subtract from the ReLU because remember we thought subtracting half from the ReLU</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5414" target="_blank">01:30:14.920</a></span> | <span class="t">might be a good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5416" target="_blank">01:30:16.280</a></span> | <span class="t">We can also use leaky ReLU and maybe things that are too big are also a problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5420" target="_blank">01:30:20.840</a></span> | <span class="t">So let's also optionally have a maximum value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5423" target="_blank">01:30:23.960</a></span> | <span class="t">So in this generalized ReLU, if you passed a leakiness, then we'll use leaky ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5430" target="_blank">01:30:30.560</a></span> | <span class="t">Otherwise we'll use normal ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5432" target="_blank">01:30:32.560</a></span> | <span class="t">You could very easily write these leaky ReLU by hand, but I'm just trying to make it run</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5438" target="_blank">01:30:38.680</a></span> | <span class="t">a little faster by taking advantage of PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5441" target="_blank">01:30:41.560</a></span> | <span class="t">If you said I want to subtract something from it, then go ahead and subtract that from it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5446" target="_blank">01:30:46.620</a></span> | <span class="t">If I said there's some maximum value, go ahead and clamp it at that maximum value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5451" target="_blank">01:30:51.440</a></span> | <span class="t">So here's our generalized ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5454" target="_blank">01:30:54.040</a></span> | <span class="t">And so now let's have our conv layer and getCNN layers both take a * * quags and just pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5460" target="_blank">01:31:00.800</a></span> | <span class="t">them on through so that eventually they end up passed to our generalized ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5467" target="_blank">01:31:07.360</a></span> | <span class="t">And so that way we're going to be able to create a CNN and say what ReLU characteristics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5472" target="_blank">01:31:12.600</a></span> | <span class="t">do we want nice and easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5476" target="_blank">01:31:16.280</a></span> | <span class="t">And even getCNN model will pass down quags as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5481" target="_blank">01:31:21.440</a></span> | <span class="t">So now that our ReLU can go negative because it's leaky and because it's subtracting stuff,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5486" target="_blank">01:31:26.120</a></span> | <span class="t">we'll need to change our histogram so it goes from -7 to 7 rather than from 0 to 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5492" target="_blank">01:31:32.900</a></span> | <span class="t">So we'll also need to change our definition of getMin so that the middle few bits of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5504" target="_blank">01:31:44.720</a></span> | <span class="t">histogram are 0 rather than the first two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5509" target="_blank">01:31:49.060</a></span> | <span class="t">And now we can just go ahead and train this model just like before and plot just like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5512" target="_blank">01:31:52.840</a></span> | <span class="t">before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5515" target="_blank">01:31:55.320</a></span> | <span class="t">And this is looking pretty hopeful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5518" target="_blank">01:31:58.940</a></span> | <span class="t">Let's keep looking at the rest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5520" target="_blank">01:32:00.280</a></span> | <span class="t">So here's the first one, two, three, four layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5522" target="_blank">01:32:02.880</a></span> | <span class="t">So compared to that, which was expand, does die, expand, die, expand, die, we're now seeing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5533" target="_blank">01:32:13.880</a></span> | <span class="t">this is looking much better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5534" target="_blank">01:32:14.880</a></span> | <span class="t">It's straight away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5536" target="_blank">01:32:16.200</a></span> | <span class="t">It's using the full richness of the possible activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5539" target="_blank">01:32:19.520</a></span> | <span class="t">There's no death going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5541" target="_blank">01:32:21.080</a></span> | <span class="t">But our real question is how much is in this yellow line?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5545" target="_blank">01:32:25.880</a></span> | <span class="t">There's a question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5548" target="_blank">01:32:28.800</a></span> | <span class="t">And let's see, in the final layer, look at that, less than 20%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5555" target="_blank">01:32:35.560</a></span> | <span class="t">So we're now using nearly all of our activations by being careful about our initialization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5564" target="_blank">01:32:44.440</a></span> | <span class="t">and our ReLU, but we're still training at a nice high learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5570" target="_blank">01:32:50.720</a></span> | <span class="t">So this is looking great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5574" target="_blank">01:32:54.360</a></span> | <span class="t">Could you explain again how to read the histograms?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5578" target="_blank">01:32:58.680</a></span> | <span class="t">Sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5580" target="_blank">01:33:00.120</a></span> | <span class="t">So the four histogram, let's go back to the earlier one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5583" target="_blank">01:33:03.180</a></span> | <span class="t">So the four histograms are simply the four layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5585" target="_blank">01:33:05.440</a></span> | <span class="t">So after the first, second, third, fourth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5590" target="_blank">01:33:10.920</a></span> | <span class="t">And the x-axis is the iteration.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5596" target="_blank">01:33:16.100</a></span> | <span class="t">So each one is just one more iteration as most of our plots show.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5601" target="_blank">01:33:21.240</a></span> | <span class="t">The y-axis is how many activations are the highest they can be or the lowest they can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5612" target="_blank">01:33:32.440</a></span> | <span class="t">be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5613" target="_blank">01:33:33.700</a></span> | <span class="t">So what this one here is showing us, for example, is that there are some activations that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5620" target="_blank">01:33:40.120</a></span> | <span class="t">at the max and some activations are in the middle and some activations at the bottom,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5624" target="_blank">01:33:44.680</a></span> | <span class="t">whereas this one here is showing us that all of the activations are basically zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5631" target="_blank">01:33:51.920</a></span> | <span class="t">So what this shows us in this histogram is that now we're going all the way from plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5638" target="_blank">01:33:58.800</a></span> | <span class="t">seven to minus seven because we can have negatives.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5641" target="_blank">01:34:01.800</a></span> | <span class="t">This is zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5642" target="_blank">01:34:02.800</a></span> | <span class="t">It's showing us that most of them are zero because yellow is the most energy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5651" target="_blank">01:34:11.160</a></span> | <span class="t">There are activations throughout everything from the bottom to the top.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5656" target="_blank">01:34:16.440</a></span> | <span class="t">And a few less than zero, as we would expect, because we have a leaky value and we also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5661" target="_blank">01:34:21.960</a></span> | <span class="t">have that minus, we're not doing minus 0.5, we're doing minus 0.4, because leaky value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5667" target="_blank">01:34:27.840</a></span> | <span class="t">means that we don't need to subtract half anymore, we subtract a bit less than half.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5674" target="_blank">01:34:34.560</a></span> | <span class="t">And so then this line is telling us what percentage of them are zero or nearly zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5685" target="_blank">01:34:45.520</a></span> | <span class="t">And so this is one of those things which is good to run lots of experiments in the notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5690" target="_blank">01:34:50.680</a></span> | <span class="t">yourself to get a sense of what's actually in these histograms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5694" target="_blank">01:34:54.640</a></span> | <span class="t">So you can just go ahead and have a look at each hook's stats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5698" target="_blank">01:34:58.720</a></span> | <span class="t">And the third thing in it will be the histograms, so you can see what shape is it and how is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5703" target="_blank">01:35:03.320</a></span> | <span class="t">it calculated and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5707" target="_blank">01:35:07.880</a></span> | <span class="t">So now that we've done that, this is looking really good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5712" target="_blank">01:35:12.760</a></span> | <span class="t">So what actually happens if we train like this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5716" target="_blank">01:35:16.440</a></span> | <span class="t">So let's do a one cycle training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5720" target="_blank">01:35:20.320</a></span> | <span class="t">So use that combined sheds we built last week, 50/50 two phases, cosine scheduling, cosine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5727" target="_blank">01:35:27.560</a></span> | <span class="t">annealing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5728" target="_blank">01:35:28.560</a></span> | <span class="t">So gradual warm up, gradual cool down, and then run it for eight epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5733" target="_blank">01:35:33.940</a></span> | <span class="t">And there we go, we're doing really well, we're getting up to 98%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5737" target="_blank">01:35:37.760</a></span> | <span class="t">So this kind of, we hardly were really training in a thing, we were just trying to get something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5743" target="_blank">01:35:43.080</a></span> | <span class="t">that looked good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5746" target="_blank">01:35:46.680</a></span> | <span class="t">And once we had something that looked good in terms of the telemetry, it's really training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5751" target="_blank">01:35:51.320</a></span> | <span class="t">really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5754" target="_blank">01:35:54.320</a></span> | <span class="t">One option I added by the way in at CNN was I added a uniform Boolean, which will set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5762" target="_blank">01:36:02.920</a></span> | <span class="t">the initialization function to chiming normal, if it's false, which is what we've been using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5769" target="_blank">01:36:09.200</a></span> | <span class="t">so far, or chiming uniform, if it's true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5773" target="_blank">01:36:13.160</a></span> | <span class="t">Timing uniform, so now I've just trained the same model with uniform equals true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5779" target="_blank">01:36:19.000</a></span> | <span class="t">A lot of people think that uniform is better than normal, because a uniform random number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5785" target="_blank">01:36:25.640</a></span> | <span class="t">is less often close to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5787" target="_blank">01:36:27.960</a></span> | <span class="t">And so the thinking is that maybe uniform random, uniform initialization might cause</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5794" target="_blank">01:36:34.520</a></span> | <span class="t">it to kind of have a better richness of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5797" target="_blank">01:36:37.800</a></span> | <span class="t">I haven't studied this closely, I'm not sure I've seen a careful analysis in a paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5803" target="_blank">01:36:43.160</a></span> | <span class="t">In this case, 9822 versus 9826, they're looking pretty similar, but that's just something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5808" target="_blank">01:36:48.800</a></span> | <span class="t">else that it's there to play with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5811" target="_blank">01:36:51.380</a></span> | <span class="t">So at this point, we've got a pretty nice bunch of things you can look at now, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5817" target="_blank">01:36:57.800</a></span> | <span class="t">you can see as your problem to play with during the week is how accurate can you make a model?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5826" target="_blank">01:37:06.640</a></span> | <span class="t">Just using the layers we've created so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5830" target="_blank">01:37:10.320</a></span> | <span class="t">And for the ones that are great accuracy, what does the telemetry look like?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5834" target="_blank">01:37:14.720</a></span> | <span class="t">How can you tell whether it's going to be good?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5837" target="_blank">01:37:17.040</a></span> | <span class="t">And then what insights can you gain from that to make it even better?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5840" target="_blank">01:37:20.300</a></span> | <span class="t">So in the end, try to beat me, try to beat 98%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5846" target="_blank">01:37:26.200</a></span> | <span class="t">You'll find you can beat it pretty easily with some playing around, but do some experiments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5853" target="_blank">01:37:33.320</a></span> | <span class="t">All right, so that's kind of about what we can do with initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5867" target="_blank">01:37:47.480</a></span> | <span class="t">You can go further, as we discussed with Selu or with Fixup, like there are these really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5874" target="_blank">01:37:54.880</a></span> | <span class="t">finely tuned initialization methods that you can do 1,000 layers deep, but they're super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5879" target="_blank">01:37:59.440</a></span> | <span class="t">fiddly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5880" target="_blank">01:38:00.820</a></span> | <span class="t">So generally, I would use something like the layer-wise sequential unit variance, LSUV</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5887" target="_blank">01:38:07.760</a></span> | <span class="t">thing that we saw earlier in ... Oh, sorry, we haven't done that one yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5895" target="_blank">01:38:15.120</a></span> | <span class="t">Okay, we're going to do that next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5897" target="_blank">01:38:17.520</a></span> | <span class="t">Okay, so, forget I said that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5902" target="_blank">01:38:22.080</a></span> | <span class="t">So that's kind of about as far as we can get with basic initialization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5909" target="_blank">01:38:29.560</a></span> | <span class="t">To go further, we really need to use normalization, of which the most commonly known approach</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5916" target="_blank">01:38:36.000</a></span> | <span class="t">to normalization in the model is batch normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5921" target="_blank">01:38:41.040</a></span> | <span class="t">So let's look at batch normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5923" target="_blank">01:38:43.280</a></span> | <span class="t">So batch normalization has been around since, I think, about 2005.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5930" target="_blank">01:38:50.520</a></span> | <span class="t">This is the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5933" target="_blank">01:38:53.080</a></span> | <span class="t">And they first of all describe a bit about why they thought batch normalization was a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5937" target="_blank">01:38:57.320</a></span> | <span class="t">good idea, and by about page 3, they provide the algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5945" target="_blank">01:39:05.560</a></span> | <span class="t">So it's one of those things that if you don't read a lot of math, it might look a bit scary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5950" target="_blank">01:39:10.760</a></span> | <span class="t">But then when you look at it for a little bit longer, you suddenly notice that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5954" target="_blank">01:39:14.760</a></span> | <span class="t">is literally just the mean, sum divided by the count.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5958" target="_blank">01:39:18.840</a></span> | <span class="t">And this is the mean of the difference to the mean squared, and it's the mean of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5966" target="_blank">01:39:26.760</a></span> | <span class="t">Oh, that's just what we looked at, that's variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5969" target="_blank">01:39:29.440</a></span> | <span class="t">And this is just subtract the mean, divide by the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5972" target="_blank">01:39:32.720</a></span> | <span class="t">Oh, that's just normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5974" target="_blank">01:39:34.720</a></span> | <span class="t">So once you look at it a second time, you realize we've done all this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5977" target="_blank">01:39:37.360</a></span> | <span class="t">We've just done it with code, not with math.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5981" target="_blank">01:39:41.520</a></span> | <span class="t">And so then, the only thing they do is after they've normalized it in the usual way, is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5986" target="_blank">01:39:46.360</a></span> | <span class="t">that they then multiply it by gamma, and they add beta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5990" target="_blank">01:39:50.400</a></span> | <span class="t">What are gamma and beta?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5991" target="_blank">01:39:51.960</a></span> | <span class="t">They are parameters to be learned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5995" target="_blank">01:39:55.320</a></span> | <span class="t">What does that mean?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5996" target="_blank">01:39:56.320</a></span> | <span class="t">That's the most important line here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=5999" target="_blank">01:39:59.280</a></span> | <span class="t">Remember that there are two types of numbers in a neural network, parameters and activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6006" target="_blank">01:40:06.200</a></span> | <span class="t">Activations are things we calculate, parameters are things we learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6009" target="_blank">01:40:09.960</a></span> | <span class="t">So these are just numbers that we learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6013" target="_blank">01:40:13.640</a></span> | <span class="t">So that's all the information we need to implement batch norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6017" target="_blank">01:40:17.300</a></span> | <span class="t">So let's go ahead and do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6019" target="_blank">01:40:19.360</a></span> | <span class="t">So first of all, we'll grab our data as before, create our callbacks as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6024" target="_blank">01:40:24.200</a></span> | <span class="t">Here's our pre-batch norm version, 96.5%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6029" target="_blank">01:40:29.480</a></span> | <span class="t">And the highest I could get was a 0.4 learning rate this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6039" target="_blank">01:40:39.680</a></span> | <span class="t">And so now let's try batch norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6040" target="_blank">01:40:40.920</a></span> | <span class="t">So here's batch norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6043" target="_blank">01:40:43.160</a></span> | <span class="t">So let's look at the forward first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6047" target="_blank">01:40:47.240</a></span> | <span class="t">We're going to get the mean and the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6051" target="_blank">01:40:51.400</a></span> | <span class="t">And the way we do that is we call update stats, and the mean is just the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6057" target="_blank">01:40:57.880</a></span> | <span class="t">And the variance is just the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6060" target="_blank">01:41:00.960</a></span> | <span class="t">And then we subtract the mean, and we divide by the square root of the variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6066" target="_blank">01:41:06.320</a></span> | <span class="t">And then we multiply by, and then I didn't call them gamma and beta, because why use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6071" target="_blank">01:41:11.320</a></span> | <span class="t">Greek letters when, because who remembers which one's gamma and which one's beta?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6074" target="_blank">01:41:14.660</a></span> | <span class="t">Let's use English.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6075" target="_blank">01:41:15.660</a></span> | <span class="t">The thing we multiply, we'll call the malts, and the things we add, we'll call the ads.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6081" target="_blank">01:41:21.280</a></span> | <span class="t">And so malts and ads are parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6086" target="_blank">01:41:26.080</a></span> | <span class="t">We multiply by a parameter that initially is just a bunch of ones, so it does nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6091" target="_blank">01:41:31.420</a></span> | <span class="t">And we add a parameter which is initially just a bunch of zeros, so it does nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6097" target="_blank">01:41:37.000</a></span> | <span class="t">But they're parameters, so they can learn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6099" target="_blank">01:41:39.400</a></span> | <span class="t">Just like our, remember our original linear layer we created by hand just looked like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6104" target="_blank">01:41:44.480</a></span> | <span class="t">this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6105" target="_blank">01:41:45.480</a></span> | <span class="t">In fact, if you think about it, ads is just bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6109" target="_blank">01:41:49.760</a></span> | <span class="t">It's identical to the bias we created earlier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6114" target="_blank">01:41:54.600</a></span> | <span class="t">So then there's a few extra little things we have to think about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6118" target="_blank">01:41:58.120</a></span> | <span class="t">One is what happens at inference time, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6122" target="_blank">01:42:02.040</a></span> | <span class="t">So during training, we normalize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6125" target="_blank">01:42:05.360</a></span> | <span class="t">But the problem is that if we normalize in the same way at inference time, if we get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6129" target="_blank">01:42:09.320</a></span> | <span class="t">like a totally different kind of image, we might kind of remove all of the things that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6137" target="_blank">01:42:17.560</a></span> | <span class="t">are interesting about it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6139" target="_blank">01:42:19.320</a></span> | <span class="t">So what we do is while we're training, we keep an exponentially weighted moving average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6147" target="_blank">01:42:27.080</a></span> | <span class="t">of the means and the variances.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6149" target="_blank">01:42:29.360</a></span> | <span class="t">I'll talk more about what that means in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6151" target="_blank">01:42:31.400</a></span> | <span class="t">But basically we've got a running average of the last few batches means and a running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6156" target="_blank">01:42:36.560</a></span> | <span class="t">average of the last few batches variances.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6159" target="_blank">01:42:39.120</a></span> | <span class="t">And so then when we're not training, in other words at inference time, we don't use the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6164" target="_blank">01:42:44.800</a></span> | <span class="t">mean and variance of this mini-batch, we use that running average mean and variance that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6170" target="_blank">01:42:50.600</a></span> | <span class="t">we've been keeping track of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6175" target="_blank">01:42:55.120</a></span> | <span class="t">So how do we calculate that running average?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6178" target="_blank">01:42:58.480</a></span> | <span class="t">Well, we don't just create something called self.vars.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6184" target="_blank">01:43:04.520</a></span> | <span class="t">We go self.register buffer vars.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6187" target="_blank">01:43:07.400</a></span> | <span class="t">Now that creates something called self.vars.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6191" target="_blank">01:43:11.960</a></span> | <span class="t">So why didn't we just say self.vars=torch.ones?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6195" target="_blank">01:43:15.960</a></span> | <span class="t">Why do we say self.register buffer?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6198" target="_blank">01:43:18.840</a></span> | <span class="t">It's almost exactly the same as saying self.vars=torch.ones, but it does a couple of nice things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6205" target="_blank">01:43:25.840</a></span> | <span class="t">The first is that if we move the model to the GPU, anything that's registered as a buffer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6212" target="_blank">01:43:32.560</a></span> | <span class="t">will be moved to the GPU as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6215" target="_blank">01:43:35.400</a></span> | <span class="t">And if we didn't do that, then it's going to try and do this calculation down here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6219" target="_blank">01:43:39.680</a></span> | <span class="t">And if the vars and means aren't on the GPU, but everything else is on the GPU, we'll get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6223" target="_blank">01:43:43.840</a></span> | <span class="t">an error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6224" target="_blank">01:43:44.840</a></span> | <span class="t">It'll say, "Oh, you're trying to add this thing on the CPU to this thing on the GPU,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6228" target="_blank">01:43:48.000</a></span> | <span class="t">and it'll fail."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6229" target="_blank">01:43:49.280</a></span> | <span class="t">So that's one nice thing about register buffer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6231" target="_blank">01:43:51.380</a></span> | <span class="t">The other nice thing is that the variances and the means, these running averages, they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6236" target="_blank">01:43:56.400</a></span> | <span class="t">part of the model, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6239" target="_blank">01:43:59.080</a></span> | <span class="t">When we do inference, in order to calculate our predictions, we actually need to know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6244" target="_blank">01:44:04.600</a></span> | <span class="t">what those numbers are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6246" target="_blank">01:44:06.000</a></span> | <span class="t">So if we save the model, we have to save those variances and means.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6251" target="_blank">01:44:11.240</a></span> | <span class="t">So register buffer also causes them to be saved along with everything else in the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6257" target="_blank">01:44:17.040</a></span> | <span class="t">So that's what register buffer does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6259" target="_blank">01:44:19.600</a></span> | <span class="t">So the variances, we start them out at ones, the means we start them out at zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6265" target="_blank">01:44:25.160</a></span> | <span class="t">We then calculate the mean and variance of the minibatch, and we average out the axes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6271" target="_blank">01:44:31.960</a></span> | <span class="t">zero, two, and three. So in other words, we average over all the batches, and we average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6277" target="_blank">01:44:37.080</a></span> | <span class="t">over all of the x and y coordinates.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6281" target="_blank">01:44:41.940</a></span> | <span class="t">So all we're left with is a mean for each channel, or a mean for each filter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6290" target="_blank">01:44:50.880</a></span> | <span class="t">Keepgame equals true means that it's going to leave an empty unit access in positions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6297" target="_blank">01:44:57.640</a></span> | <span class="t">zero, two, and three, so it'll still broadcast nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6302" target="_blank">01:45:02.560</a></span> | <span class="t">So now, we want to take a running average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6308" target="_blank">01:45:08.140</a></span> | <span class="t">So normally, if we want to take a moving average, if we've got a bunch of data points, we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6316" target="_blank">01:45:16.680</a></span> | <span class="t">a moving average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6317" target="_blank">01:45:17.680</a></span> | <span class="t">We would grab five at a time, and we would take the average of those five, and they would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6324" target="_blank">01:45:24.880</a></span> | <span class="t">take the next five, and we'd take their average, and we keep doing that a few at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6332" target="_blank">01:45:32.200</a></span> | <span class="t">We don't want to do that here, though, because these batch norm statistics, every single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6339" target="_blank">01:45:39.040</a></span> | <span class="t">activation has one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6340" target="_blank">01:45:40.920</a></span> | <span class="t">So it's giant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6343" target="_blank">01:45:43.600</a></span> | <span class="t">Models can have hundreds of millions of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6347" target="_blank">01:45:47.800</a></span> | <span class="t">We don't want to have to save a whole history of every single one of those, just so that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6352" target="_blank">01:45:52.160</a></span> | <span class="t">we can calculate an average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6354" target="_blank">01:45:54.840</a></span> | <span class="t">So there's a handy trick for this, which is instead to use an exponentially weighted moving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6361" target="_blank">01:46:01.380</a></span> | <span class="t">average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6362" target="_blank">01:46:02.380</a></span> | <span class="t">And basically, what we do is we start out with this first point, and we say, okay, our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6369" target="_blank">01:46:09.920</a></span> | <span class="t">first average is just the first point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6372" target="_blank">01:46:12.280</a></span> | <span class="t">So let's say, I don't know, that's three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6376" target="_blank">01:46:16.080</a></span> | <span class="t">And then the second point is five.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6379" target="_blank">01:46:19.160</a></span> | <span class="t">And what we do is to take an exponentially weighted moving average, we first of all need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6384" target="_blank">01:46:24.320</a></span> | <span class="t">some number, which we call momentum, let's say it's 0.9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6390" target="_blank">01:46:30.200</a></span> | <span class="t">So for the second value, so for the first value, our exponentially weighted moving average,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6395" target="_blank">01:46:35.680</a></span> | <span class="t">which we'll call mu, equals three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6398" target="_blank">01:46:38.840</a></span> | <span class="t">And then for the second one, we take mu one, we multiply it by our momentum, and then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6410" target="_blank">01:46:50.480</a></span> | <span class="t">add our second value, five, and we multiply it by one minus our momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6419" target="_blank">01:46:59.320</a></span> | <span class="t">So in other words, it's mainly whatever it used to be before, plus a little bit of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6424" target="_blank">01:47:04.040</a></span> | <span class="t">new thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6425" target="_blank">01:47:05.780</a></span> | <span class="t">And then mu two, sorry, mu three equals mu two times 0.9 plus, and maybe this one here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6435" target="_blank">01:47:15.440</a></span> | <span class="t">is four, the new one times 0.1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6441" target="_blank">01:47:21.120</a></span> | <span class="t">So we're basically continuing to say, oh, it's mainly the thing before plus a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6446" target="_blank">01:47:26.500</a></span> | <span class="t">bit of the new one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6448" target="_blank">01:47:28.000</a></span> | <span class="t">And so what you end up with is something where, like by the time we get to here, the amount</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6456" target="_blank">01:47:36.460</a></span> | <span class="t">of influence of each of the previous data points, once you calculate it out, it turns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6463" target="_blank">01:47:43.340</a></span> | <span class="t">out to be exponentially decayed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6466" target="_blank">01:47:46.060</a></span> | <span class="t">So it's a moving average with an exponential decay, with the benefit that we only ever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6471" target="_blank">01:47:51.040</a></span> | <span class="t">have to keep track of one value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6475" target="_blank">01:47:55.660</a></span> | <span class="t">So that's what an exponentially weighted moving average is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6482" target="_blank">01:48:02.140</a></span> | <span class="t">This thing we do here, where we basically say we've got some function where we say it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6488" target="_blank">01:48:08.980</a></span> | <span class="t">some previous value times 0.9, say, plus some other value times one minus that thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6505" target="_blank">01:48:25.320</a></span> | <span class="t">This is called a linear interpolation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6508" target="_blank">01:48:28.080</a></span> | <span class="t">It's a bit of this and a bit of this other thing, and the two together make one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6512" target="_blank">01:48:32.760</a></span> | <span class="t">Linear interpolation in PyTorch is spelt lerp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6518" target="_blank">01:48:38.120</a></span> | <span class="t">So we take the means, and then we lerp with our new mean using this amount of momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6529" target="_blank">01:48:49.320</a></span> | <span class="t">Unfortunately, lerp uses the exact opposite of the normal sense of momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6538" target="_blank">01:48:58.080</a></span> | <span class="t">So momentum of 0.1 in batch norm actually means momentum of 0.9 in normal person speak.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6547" target="_blank">01:49:07.440</a></span> | <span class="t">So this is actually how nn.batchnorm works as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6554" target="_blank">01:49:14.560</a></span> | <span class="t">So batch norm momentum is the opposite of what you would expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6558" target="_blank">01:49:18.920</a></span> | <span class="t">I wish they'd given it a different name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6560" target="_blank">01:49:20.680</a></span> | <span class="t">They didn't, sadly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6561" target="_blank">01:49:21.840</a></span> | <span class="t">So this is what we're stuck with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6564" target="_blank">01:49:24.120</a></span> | <span class="t">So this is the running average means instead of deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6568" target="_blank">01:49:28.280</a></span> | <span class="t">So now we can go ahead and use that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6572" target="_blank">01:49:32.200</a></span> | <span class="t">So now we can create a new conv layer, which you can optionally say whether you want batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6576" target="_blank">01:49:36.480</a></span> | <span class="t">norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6577" target="_blank">01:49:37.640</a></span> | <span class="t">If you do, we append a batch norm layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6580" target="_blank">01:49:40.760</a></span> | <span class="t">If we do append a batch norm layer, we remove the bias layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6584" target="_blank">01:49:44.400</a></span> | <span class="t">Because remember I said that the ads in batch norm just is a bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6589" target="_blank">01:49:49.160</a></span> | <span class="t">So there's no point having a bias layer anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6593" target="_blank">01:49:53.160</a></span> | <span class="t">So we'll remove the unnecessary bias layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6596" target="_blank">01:49:56.360</a></span> | <span class="t">And so now we can go ahead and initialize our CNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6601" target="_blank">01:50:01.240</a></span> | <span class="t">This is a slightly more convenient initialization now that's actually going to go in and recursively</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6608" target="_blank">01:50:08.480</a></span> | <span class="t">initialize every module inside our module, the weights in the standard deviations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6620" target="_blank">01:50:20.680</a></span> | <span class="t">And then we will train it with our hooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6625" target="_blank">01:50:25.280</a></span> | <span class="t">And you can see our mean starts at 0 exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6629" target="_blank">01:50:29.400</a></span> | <span class="t">And our standard deviation starts at 1 exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6635" target="_blank">01:50:35.400</a></span> | <span class="t">So our training has entirely gotten rid of all of the exponential growth and sudden crash</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6644" target="_blank">01:50:44.200</a></span> | <span class="t">stuff that we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6646" target="_blank">01:50:46.840</a></span> | <span class="t">There's something interesting going on at the very end of training, which I don't quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6651" target="_blank">01:50:51.040</a></span> | <span class="t">know what that is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6652" target="_blank">01:50:52.040</a></span> | <span class="t">I mean, when I say the end of training, we've only done one epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6656" target="_blank">01:50:56.240</a></span> | <span class="t">But this is looking a lot better than anything we've seen before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6661" target="_blank">01:51:01.680</a></span> | <span class="t">I mean, that's just a very nice-looking curve.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6664" target="_blank">01:51:04.720</a></span> | <span class="t">And so we're now able to get up to learning rates up to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6672" target="_blank">01:51:12.680</a></span> | <span class="t">We've got 97% accuracy after just three epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6677" target="_blank">01:51:17.320</a></span> | <span class="t">This is looking very encouraging.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6679" target="_blank">01:51:19.720</a></span> | <span class="t">So now that we've built our own batch norm, we're allowed to use PyTorch's batch norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6684" target="_blank">01:51:24.840</a></span> | <span class="t">And we get pretty much the same results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6687" target="_blank">01:51:27.200</a></span> | <span class="t">Sometimes it's 97, sometimes it's 98.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6688" target="_blank">01:51:28.880</a></span> | <span class="t">This is just random variation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6692" target="_blank">01:51:32.320</a></span> | <span class="t">So now that we've got that, let's try going crazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6694" target="_blank">01:51:34.800</a></span> | <span class="t">Let's try using our little one-cycle learning scheduler we had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6699" target="_blank">01:51:39.880</a></span> | <span class="t">And let's try and go all the way up to a learning rate of 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6707" target="_blank">01:51:47.760</a></span> | <span class="t">And look at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6708" target="_blank">01:51:48.760</a></span> | <span class="t">We totally can, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6710" target="_blank">01:51:50.560</a></span> | <span class="t">And we're now up towards nearly 99% accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6715" target="_blank">01:51:55.080</a></span> | <span class="t">So batch norm really is quite fantastic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6720" target="_blank">01:52:00.360</a></span> | <span class="t">Batch norm has a bit of a problem, though, which is that you can't apply it to what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6728" target="_blank">01:52:08.520</a></span> | <span class="t">call online learning tasks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6730" target="_blank">01:52:10.360</a></span> | <span class="t">In other words, if you have a batch size of 1, right, so you're getting a single item</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6736" target="_blank">01:52:16.400</a></span> | <span class="t">at a time and learning from that item, what's the variance of that batch?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6741" target="_blank">01:52:21.760</a></span> | <span class="t">The variance of a batch of 1 is infinite, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6745" target="_blank">01:52:25.780</a></span> | <span class="t">So we can't use batch norm in that case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6748" target="_blank">01:52:28.280</a></span> | <span class="t">Well, what if we're doing like a segmentation task where we can only have a batch size of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6752" target="_blank">01:52:32.800</a></span> | <span class="t">2 or 4, which we've seen plenty of times in part 1?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6756" target="_blank">01:52:36.840</a></span> | <span class="t">That's going to be a problem, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6757" target="_blank">01:52:37.960</a></span> | <span class="t">Because across all of our layers, across all of our training, across all of the channels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6762" target="_blank">01:52:42.480</a></span> | <span class="t">the batch size of 2, at some point, those two values are going to be the same or nearly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6768" target="_blank">01:52:48.760</a></span> | <span class="t">the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6769" target="_blank">01:52:49.840</a></span> | <span class="t">And so we then divide by that variance, which is about 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6773" target="_blank">01:52:53.480</a></span> | <span class="t">We have infinity, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6775" target="_blank">01:52:55.800</a></span> | <span class="t">So we have this problem where any time you have a small batch size, you're going to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6781" target="_blank">01:53:01.680</a></span> | <span class="t">unstable or impossible training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6784" target="_blank">01:53:04.880</a></span> | <span class="t">It's also going to be really hard for RNNs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6787" target="_blank">01:53:07.720</a></span> | <span class="t">Because for RNNs, remember, it looks something like this, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6792" target="_blank">01:53:12.440</a></span> | <span class="t">We have this hidden state, and we use the same weight matrix again and again and again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6798" target="_blank">01:53:18.360</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6799" target="_blank">01:53:19.360</a></span> | <span class="t">Remember, we can unroll it, and it looks like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6803" target="_blank">01:53:23.760</a></span> | <span class="t">If you've forgotten, go back to lesson 7.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6806" target="_blank">01:53:26.720</a></span> | <span class="t">And then we can even stack them together into two RNNs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6810" target="_blank">01:53:30.040</a></span> | <span class="t">One RNN fits to another RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6811" target="_blank">01:53:31.920</a></span> | <span class="t">And if we unroll that, it looks like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6815" target="_blank">01:53:35.360</a></span> | <span class="t">And remember, these state, you know, time step to time step transitions, if we're doing IMDB</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6822" target="_blank">01:53:42.400</a></span> | <span class="t">with a movie review with 2,000 words, there's 2,000 of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6828" target="_blank">01:53:48.160</a></span> | <span class="t">And this is the same weight matrix each time, and the number of these circles will vary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6833" target="_blank">01:53:53.560</a></span> | <span class="t">It's the number of time steps will vary from document to document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6837" target="_blank">01:53:57.280</a></span> | <span class="t">So how would you do batch norm, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6840" target="_blank">01:54:00.200</a></span> | <span class="t">How would you say what's the running average of means and variances?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6847" target="_blank">01:54:07.440</a></span> | <span class="t">Because you can't put a different one between each of these unrolled layers, because, like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6852" target="_blank">01:54:12.360</a></span> | <span class="t">this is a for loop, remember?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6853" target="_blank">01:54:13.820</a></span> | <span class="t">So we can't have different values every time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6857" target="_blank">01:54:17.240</a></span> | <span class="t">So it's not at all clear how you would insert batch norm into an RNN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6862" target="_blank">01:54:22.880</a></span> | <span class="t">So batch norm has these two deficiencies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6865" target="_blank">01:54:25.680</a></span> | <span class="t">How do we handle very small batch sizes all the way down to a batch size of one?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6869" target="_blank">01:54:29.260</a></span> | <span class="t">How do we handle RNNs?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6872" target="_blank">01:54:32.520</a></span> | <span class="t">So this paper called layer normalization suggests a solution to this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6880" target="_blank">01:54:40.920</a></span> | <span class="t">And the layer normalization paper from Jimmy Barr and Kyros and Jeffrey Hinton, who just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6889" target="_blank">01:54:49.880</a></span> | <span class="t">won the Turing Award with Yoshua, Benjio, and Yann LeCun, which is kind of the Nobel</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6897" target="_blank">01:54:57.240</a></span> | <span class="t">prize of computer science, they created this paper, which, like many papers, when you read</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6903" target="_blank">01:55:03.800</a></span> | <span class="t">it, it looks reasonably terrifying, particularly once you start looking at all this stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6911" target="_blank">01:55:11.920</a></span> | <span class="t">But actually, when we take this paper and we convert it to code, it's this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6918" target="_blank">01:55:18.440</a></span> | <span class="t">Now, which is not to say the paper's garbage, it's just that the paper has lots of explanation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6924" target="_blank">01:55:24.080</a></span> | <span class="t">about what's going on and what do we find out and what does that mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6927" target="_blank">01:55:27.840</a></span> | <span class="t">But the actual, what's layer norm?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6929" target="_blank">01:55:29.760</a></span> | <span class="t">It's the same as batch norm, but rather than saying x dot means 0, 2, 3, you say x dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6935" target="_blank">01:55:35.680</a></span> | <span class="t">mean 1, 2, 3, and you remove all the running averages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6941" target="_blank">01:55:41.620</a></span> | <span class="t">So this is layer norm with none of that running average stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6948" target="_blank">01:55:48.680</a></span> | <span class="t">And the reason we don't need the running averages anymore is because we're not taking the mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6954" target="_blank">01:55:54.040</a></span> | <span class="t">across all the items in the batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6957" target="_blank">01:55:57.460</a></span> | <span class="t">Every image has its own mean, every image has its own standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6962" target="_blank">01:56:02.520</a></span> | <span class="t">So there's no concept of having to average across things in a batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6967" target="_blank">01:56:07.720</a></span> | <span class="t">And so that's all layer norm is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6972" target="_blank">01:56:12.240</a></span> | <span class="t">We also average over the channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6974" target="_blank">01:56:14.580</a></span> | <span class="t">So we average over the channels and the x and the y for each image individually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6980" target="_blank">01:56:20.080</a></span> | <span class="t">So we don't have to keep track of any running averages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6983" target="_blank">01:56:23.280</a></span> | <span class="t">The problem is that when we do that and we train, even at a lower learning rate of 0.8,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6988" target="_blank">01:56:28.680</a></span> | <span class="t">it doesn't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6990" target="_blank">01:56:30.760</a></span> | <span class="t">Layer norm's not as good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=6993" target="_blank">01:56:33.560</a></span> | <span class="t">So it's a workaround we can use, but because we don't have the running averages at inference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7000" target="_blank">01:56:40.000</a></span> | <span class="t">time and more importantly, because we don't have a different normalization for each channel,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7008" target="_blank">01:56:48.640</a></span> | <span class="t">we're just throwing them all together and pretending they're the same and they're not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7012" target="_blank">01:56:52.800</a></span> | <span class="t">So layer norm helps, but it's nowhere near as good as batch norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7018" target="_blank">01:56:58.000</a></span> | <span class="t">But for RNNs, what you have to use is something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7024" target="_blank">01:57:04.360</a></span> | <span class="t">So here's a thought experiment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7026" target="_blank">01:57:06.880</a></span> | <span class="t">What if you're using layer norm on the actual input data and you're trying to distinguish</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7033" target="_blank">01:57:13.640</a></span> | <span class="t">between foggy days and sunny days?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7036" target="_blank">01:57:16.920</a></span> | <span class="t">So foggy days will have less activations on average because they're less bright and they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7045" target="_blank">01:57:25.080</a></span> | <span class="t">will have less contrast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7046" target="_blank">01:57:26.880</a></span> | <span class="t">In other words, they have lower variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7049" target="_blank">01:57:29.320</a></span> | <span class="t">So layer norm would cause the variances to be normalized to be the same and the means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7056" target="_blank">01:57:36.800</a></span> | <span class="t">to be normalized to be the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7059" target="_blank">01:57:39.580</a></span> | <span class="t">So now the sunny day picture and the hazy day picture would have the same overall kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7066" target="_blank">01:57:46.560</a></span> | <span class="t">of activations and amount of contrast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7068" target="_blank">01:57:48.560</a></span> | <span class="t">And so the answer to this question is, no, you couldn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7072" target="_blank">01:57:52.160</a></span> | <span class="t">With layer norm, you would literally not be able to tell the difference between pictures</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7075" target="_blank">01:57:55.520</a></span> | <span class="t">of sunny days and pictures of foggy days.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7077" target="_blank">01:57:57.840</a></span> | <span class="t">Now, it's not only if you put the layer norm on the input data, which you wouldn't do,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7083" target="_blank">01:58:03.400</a></span> | <span class="t">but everywhere in the middle layers, it's the same, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7087" target="_blank">01:58:07.200</a></span> | <span class="t">Anywhere where the overall level of activation or the amount of difference of activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7091" target="_blank">01:58:11.580</a></span> | <span class="t">is something that is part of what you care about, it throws it away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7097" target="_blank">01:58:17.320</a></span> | <span class="t">It's designed to throw it away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7099" target="_blank">01:58:19.480</a></span> | <span class="t">Furthermore, if your inference time is using things from kind of a different distribution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7104" target="_blank">01:58:24.820</a></span> | <span class="t">where that different distribution is important, it throws that away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7108" target="_blank">01:58:28.960</a></span> | <span class="t">So layer norm's a partial hacky workaround for some very genuine problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7115" target="_blank">01:58:35.480</a></span> | <span class="t">There's also something called instance norm, and instance norm is basically the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7122" target="_blank">01:58:42.960</a></span> | <span class="t">as layer norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7123" target="_blank">01:58:43.960</a></span> | <span class="t">It's a bit easier to read in the paper because they actually lay out all the indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7128" target="_blank">01:58:48.140</a></span> | <span class="t">So a particular output for a particular batch for a particular channel for a particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7131" target="_blank">01:58:51.960</a></span> | <span class="t">x for a particular y is equal to the input for that batch and channel in x and y minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7137" target="_blank">01:58:57.240</a></span> | <span class="t">the mean for the batch and the channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7141" target="_blank">01:59:01.960</a></span> | <span class="t">So in other words, it's the same as layer norm, but now it's mean 2,3 rather than mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7146" target="_blank">01:59:06.800</a></span> | <span class="t">1,2,3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7147" target="_blank">01:59:07.800</a></span> | <span class="t">So you can see how all these different papers, when you turn them into code, they're tiny</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7152" target="_blank">01:59:12.600</a></span> | <span class="t">variations, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7156" target="_blank">01:59:16.400</a></span> | <span class="t">Instance norm, even at a learning rate of 0.1, doesn't learn anything at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7161" target="_blank">01:59:21.280</a></span> | <span class="t">Why can't it classify anything?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7164" target="_blank">01:59:24.280</a></span> | <span class="t">Because we're now taking the mean, removing the difference in means and the difference</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7169" target="_blank">01:59:29.960</a></span> | <span class="t">in activations for every channel and for every image, which means we've literally thrown</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7175" target="_blank">01:59:35.920</a></span> | <span class="t">away all the things that allow us to classify.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7178" target="_blank">01:59:38.840</a></span> | <span class="t">Does that mean that instance norm is stupid?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7181" target="_blank">01:59:41.040</a></span> | <span class="t">No, certainly not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7182" target="_blank">01:59:42.680</a></span> | <span class="t">It wasn't designed for classification.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7185" target="_blank">01:59:45.800</a></span> | <span class="t">It was designed for style transfer, where the authors guessed that these differences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7192" target="_blank">01:59:52.360</a></span> | <span class="t">in contrast and overall amount were not important, or something they should remove from trying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7198" target="_blank">01:59:58.600</a></span> | <span class="t">to create things that looked like different types of pictures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7202" target="_blank">02:00:02.280</a></span> | <span class="t">It turned out to work really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7203" target="_blank">02:00:03.640</a></span> | <span class="t">But you've got to be careful, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7205" target="_blank">02:00:05.440</a></span> | <span class="t">You can't just go in and say, "Oh, here's another normalization thing, I'll try it."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7209" target="_blank">02:00:09.200</a></span> | <span class="t">You've got to actually know what it's for to know whether it's going to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7213" target="_blank">02:00:13.400</a></span> | <span class="t">So then finally, there's a paper called Group Norm, which has this wonderful picture, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7218" target="_blank">02:00:18.600</a></span> | <span class="t">it shows the differences.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7220" target="_blank">02:00:20.080</a></span> | <span class="t">Batch Norm is averaging over the batch, and the height, and the width, and is different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7231" target="_blank">02:00:31.040</a></span> | <span class="t">for each channel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7233" target="_blank">02:00:33.320</a></span> | <span class="t">Layer Norm is averaging for each channel, for each height, for each width, and is different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7238" target="_blank">02:00:38.600</a></span> | <span class="t">for each element of the batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7240" target="_blank">02:00:40.960</a></span> | <span class="t">Instance Norm is averaging over height and width, and is different for each channel and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7249" target="_blank">02:00:49.400</a></span> | <span class="t">each batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7251" target="_blank">02:00:51.000</a></span> | <span class="t">And then Group Norm is the same as Instance Norm, but they arbitrarily group a few channels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7256" target="_blank">02:00:56.560</a></span> | <span class="t">together and do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7259" target="_blank">02:00:59.320</a></span> | <span class="t">So Group Norm is a more general way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7265" target="_blank">02:01:05.280</a></span> | <span class="t">In the PyTorch docs, they point out that you can actually turn Group Norm into Instance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7269" target="_blank">02:01:09.580</a></span> | <span class="t">Norm, or Group Norm into Layer Norm, depending on how you group things up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7277" target="_blank">02:01:17.920</a></span> | <span class="t">So there's all kinds of attempts to work around the problem that we can't use small batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7286" target="_blank">02:01:26.080</a></span> | <span class="t">sizes, and we can't use RNNs with Batch Norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7292" target="_blank">02:01:32.360</a></span> | <span class="t">But none of them are as good as Batch Norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7295" target="_blank">02:01:35.920</a></span> | <span class="t">So what do we do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7297" target="_blank">02:01:37.360</a></span> | <span class="t">Well, I don't know how to fix the RNN problem, but I think I know how to fix the batch size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7303" target="_blank">02:01:43.880</a></span> | <span class="t">problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7306" target="_blank">02:01:46.320</a></span> | <span class="t">So let's start by taking a look at the batch size problem in practice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7309" target="_blank">02:01:49.240</a></span> | <span class="t">Let's create a new data bunch with a batch size of 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7315" target="_blank">02:01:55.120</a></span> | <span class="t">And so here's our Conf layer, as before, with our Batch Norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7319" target="_blank">02:01:59.580</a></span> | <span class="t">And let's use a learning rate of 0.4 and fit that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7324" target="_blank">02:02:04.960</a></span> | <span class="t">And the first thing you'll notice is that it takes a long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7329" target="_blank">02:02:09.720</a></span> | <span class="t">Small batch sizes take a long time, because it's just lots and lots of kernel launches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7334" target="_blank">02:02:14.640</a></span> | <span class="t">on the GPU, it's just a lot of overhead.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7337" target="_blank">02:02:17.400</a></span> | <span class="t">Something like this might even run faster on the CPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7340" target="_blank">02:02:20.760</a></span> | <span class="t">And then you'll notice that it's only 26% accurate, which is awful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7345" target="_blank">02:02:25.920</a></span> | <span class="t">Why is it awful?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7347" target="_blank">02:02:27.520</a></span> | <span class="t">Because of what I said, the small batch size is causing a huge problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7353" target="_blank">02:02:33.660</a></span> | <span class="t">Because quite often, there's one channel in one layer where the variance is really small,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7359" target="_blank">02:02:39.840</a></span> | <span class="t">because those two numbers just happen to be really close, and so it blows out the activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7363" target="_blank">02:02:43.800</a></span> | <span class="t">out to a billion, and everything falls apart.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7369" target="_blank">02:02:49.400</a></span> | <span class="t">There is one thing we could try to do to fix this really easily, which is to use Epsilon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7377" target="_blank">02:02:57.120</a></span> | <span class="t">What's Epsilon?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7378" target="_blank">02:02:58.520</a></span> | <span class="t">Let's go take a look at our code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7384" target="_blank">02:03:04.840</a></span> | <span class="t">Here's our Batch Norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7386" target="_blank">02:03:06.480</a></span> | <span class="t">Look, we don't divide by the square root of variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7392" target="_blank">02:03:12.240</a></span> | <span class="t">We divide by the square root of variance plus Epsilon, where Epsilon is 1e neg 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7399" target="_blank">02:03:19.660</a></span> | <span class="t">Epsilon's a number that computer scientists and mathematicians, they use this Greek letter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7405" target="_blank">02:03:25.600</a></span> | <span class="t">very frequently to mean some very small number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7409" target="_blank">02:03:29.560</a></span> | <span class="t">And in computer science, it's normally a small number that you add to avoid floating point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7416" target="_blank">02:03:36.400</a></span> | <span class="t">rounding problems and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7419" target="_blank">02:03:39.100</a></span> | <span class="t">So it's very common to see it on the bottom of a division to avoid dividing by such small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7426" target="_blank">02:03:46.320</a></span> | <span class="t">numbers that you can't calculate things in floating point properly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7431" target="_blank">02:03:51.880</a></span> | <span class="t">But our view is that Epsilon is actually a fantastic hyperparameter that you should be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7439" target="_blank">02:03:59.700</a></span> | <span class="t">using to train things better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7442" target="_blank">02:04:02.280</a></span> | <span class="t">And here's a great example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7443" target="_blank">02:04:03.720</a></span> | <span class="t">With Batch Norm, what if we didn't set Epsilon to 1e neg 5?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7448" target="_blank">02:04:08.160</a></span> | <span class="t">But what if we set it to 0.1?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7451" target="_blank">02:04:11.340</a></span> | <span class="t">If we set Epsilon to 0.1, then that basically would cause this to never make the overall</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7460" target="_blank">02:04:20.240</a></span> | <span class="t">activations be multiplied by anything more than 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7463" target="_blank">02:04:23.760</a></span> | <span class="t">Sorry, that would be 0.01 because we're taking the square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7467" target="_blank">02:04:27.800</a></span> | <span class="t">So if you set it to 0.01, let's say the variance was 0, it would be 0 plus 0.01 square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7477" target="_blank">02:04:37.400</a></span> | <span class="t">So it ends up dividing by 0.1, which ends up multiplying by 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7481" target="_blank">02:04:41.300</a></span> | <span class="t">So even in the worst case, it's not going to blow out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7485" target="_blank">02:04:45.280</a></span> | <span class="t">I mean, it's still not great because there actually are huge differences in variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7492" target="_blank">02:04:52.520</a></span> | <span class="t">between different channels and different layers, but at least this would cause it to not fall</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7496" target="_blank">02:04:56.240</a></span> | <span class="t">apart.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7497" target="_blank">02:04:57.240</a></span> | <span class="t">So option number one would be use a much higher Epsilon value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7502" target="_blank">02:05:02.920</a></span> | <span class="t">And we'll keep coming back to this idea that Epsilon appears in lots of places in deep learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7506" target="_blank">02:05:06.640</a></span> | <span class="t">and we should use it as a hyper parameter we control and take advantage of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7515" target="_blank">02:05:15.040</a></span> | <span class="t">But we have a better idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7517" target="_blank">02:05:17.900</a></span> | <span class="t">We think we have a better idea, which is we've built a new algorithm called running batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7522" target="_blank">02:05:22.720</a></span> | <span class="t">norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7524" target="_blank">02:05:24.000</a></span> | <span class="t">And running batch norm, I think, is the first true solution to the small batch size batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7533" target="_blank">02:05:33.780</a></span> | <span class="t">norm problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7536" target="_blank">02:05:36.120</a></span> | <span class="t">And like everything we do at fast AI, it's ridiculously simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7540" target="_blank">02:05:40.240</a></span> | <span class="t">And I don't know why no one's done it before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7542" target="_blank">02:05:42.300</a></span> | <span class="t">Maybe they have and I've missed it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7545" target="_blank">02:05:45.160</a></span> | <span class="t">And the ridiculously simple thing is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7549" target="_blank">02:05:49.500</a></span> | <span class="t">In the forward function for running batch norm, don't divide by the batch standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7559" target="_blank">02:05:59.320</a></span> | <span class="t">Don't subtract the batch mean, but instead use the moving average statistics at training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7565" target="_blank">02:06:05.840</a></span> | <span class="t">time as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7568" target="_blank">02:06:08.920</a></span> | <span class="t">Not just at inference time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7572" target="_blank">02:06:12.920</a></span> | <span class="t">Why does this help?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7574" target="_blank">02:06:14.840</a></span> | <span class="t">Because let's say you're using a batch size of two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7580" target="_blank">02:06:20.200</a></span> | <span class="t">Then from time to time, in this particular layer, in this particular channel, you happen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7584" target="_blank">02:06:24.760</a></span> | <span class="t">to get two values that are really close together and they have a variance really close to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7590" target="_blank">02:06:30.000</a></span> | <span class="t">But that's fine because you're only taking point one of that and point nine of whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7595" target="_blank">02:06:35.240</a></span> | <span class="t">you had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7596" target="_blank">02:06:36.240</a></span> | <span class="t">Like that's how running averages work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7598" target="_blank">02:06:38.720</a></span> | <span class="t">So if previously the variance was one, now it's not 1e neg five, it's just point nine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7607" target="_blank">02:06:47.400</a></span> | <span class="t">So in this way, as long as you don't get really unlucky and have the very first batch be dreadful,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7616" target="_blank">02:06:56.440</a></span> | <span class="t">because you're using this moving average, you never have this problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7621" target="_blank">02:07:01.960</a></span> | <span class="t">So let's take a look.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7622" target="_blank">02:07:02.960</a></span> | <span class="t">We'll look at the code in a moment, but let's do the same thing, 0.4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7627" target="_blank">02:07:07.720</a></span> | <span class="t">We're going to use our running batch norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7630" target="_blank">02:07:10.600</a></span> | <span class="t">We train it for one epoch, and instead of 26% accuracy, it's 91% accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7639" target="_blank">02:07:19.380</a></span> | <span class="t">So it totally nails it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7642" target="_blank">02:07:22.680</a></span> | <span class="t">In one epoch, just a two batch size and a pretty high learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7648" target="_blank">02:07:28.920</a></span> | <span class="t">There's quite a few details we have to get right to make this work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7656" target="_blank">02:07:36.380</a></span> | <span class="t">But they're all details that we're going to see in lots of other places in this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7661" target="_blank">02:07:41.080</a></span> | <span class="t">We're just kind of seeing them here for the first time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7664" target="_blank">02:07:44.720</a></span> | <span class="t">So I'm going to show you all of the details, but don't get overwhelmed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7667" target="_blank">02:07:47.520</a></span> | <span class="t">We'll keep coming back to them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7670" target="_blank">02:07:50.760</a></span> | <span class="t">The first detail is something very simple, which is in normal batch norm, we take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7677" target="_blank">02:07:57.600</a></span> | <span class="t">running average of variance, but you can't take the running average of variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7683" target="_blank">02:08:03.140</a></span> | <span class="t">It doesn't make sense to take the running average of variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7685" target="_blank">02:08:05.400</a></span> | <span class="t">It's a variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7686" target="_blank">02:08:06.800</a></span> | <span class="t">You can't just average a bunch of variances, particularly because they might even be different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7692" target="_blank">02:08:12.760</a></span> | <span class="t">batch sizes, because batch size isn't necessarily constant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7696" target="_blank">02:08:16.600</a></span> | <span class="t">Instead, as we learned earlier in the class, the way that we want to calculate variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7705" target="_blank">02:08:25.600</a></span> | <span class="t">is like this, sum of expected value of mean of X squared minus mean of X squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7713" target="_blank">02:08:33.960</a></span> | <span class="t">So let's do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7714" target="_blank">02:08:34.960</a></span> | <span class="t">Let's just, as I mentioned, we can do, let's keep track of the squares and the sums.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7722" target="_blank">02:08:42.920</a></span> | <span class="t">So we register a buffer called sums and we register a buffer called squares and we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7730" target="_blank">02:08:50.000</a></span> | <span class="t">go X dot sum over 023 dimensions and X times X dot sum, so squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7741" target="_blank">02:09:01.040</a></span> | <span class="t">And then we'll take the lerp, the exponentially weighted moving average of the sums and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7747" target="_blank">02:09:07.080</a></span> | <span class="t">squares.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7748" target="_blank">02:09:08.080</a></span> | <span class="t">And then for the variance, we will do squares divided by count minus squared mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7756" target="_blank">02:09:16.840</a></span> | <span class="t">So it's that formula.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7763" target="_blank">02:09:23.260</a></span> | <span class="t">So that's detail number one that we have to be careful of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7769" target="_blank">02:09:29.400</a></span> | <span class="t">Detail number two is that the batch size could vary from many batch to many batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7776" target="_blank">02:09:36.080</a></span> | <span class="t">So we should also register a buffer for count and take an exponentially weighted moving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7782" target="_blank">02:09:42.400</a></span> | <span class="t">average of the counts, of the batch sizes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7787" target="_blank">02:09:47.180</a></span> | <span class="t">So that basically tells us, so what do we need to divide by each time?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7793" target="_blank">02:09:53.000</a></span> | <span class="t">The amount we need to divide by each time is the total number of elements in the mini-batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7799" target="_blank">02:09:59.920</a></span> | <span class="t">divided by the number of channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7801" target="_blank">02:10:01.960</a></span> | <span class="t">That's basically grid X times grid Y times batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7806" target="_blank">02:10:06.940</a></span> | <span class="t">So let's take an exponentially weighted moving average of the count and then that's what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7812" target="_blank">02:10:12.840</a></span> | <span class="t">we will divide by for both our means and variances.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7818" target="_blank">02:10:18.200</a></span> | <span class="t">That's detail number two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7822" target="_blank">02:10:22.040</a></span> | <span class="t">Detail number three is that we need to do something called debiasing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7827" target="_blank">02:10:27.760</a></span> | <span class="t">So debiasing is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7832" target="_blank">02:10:32.280</a></span> | <span class="t">We want to make sure that at every point, and we're going to look at this in more detail</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7838" target="_blank">02:10:38.400</a></span> | <span class="t">when we look at optimizers, we want to make sure that every point that no observation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7844" target="_blank">02:10:44.740</a></span> | <span class="t">is weighted too highly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7847" target="_blank">02:10:47.160</a></span> | <span class="t">And the problem is that the normal way of doing moving averages, the very first point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7854" target="_blank">02:10:54.020</a></span> | <span class="t">gets far too much weight because it appears in the first moving average and the second</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7858" target="_blank">02:10:58.020</a></span> | <span class="t">and the third and the fourth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7860" target="_blank">02:11:00.380</a></span> | <span class="t">So there's a really simple way to fix this, which is that you initialize both sums and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7865" target="_blank">02:11:05.440</a></span> | <span class="t">squares to zeros and then you do a lerp in the usual way and let's see what happens when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7877" target="_blank">02:11:17.060</a></span> | <span class="t">we do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7881" target="_blank">02:11:21.080</a></span> | <span class="t">So let's say our values are 10 and then 20.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7892" target="_blank">02:11:32.180</a></span> | <span class="t">These are the first two values we get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7895" target="_blank">02:11:35.000</a></span> | <span class="t">So actually we only need to look at the first value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7898" target="_blank">02:11:38.540</a></span> | <span class="t">So the value, so actually let's say the value is 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7902" target="_blank">02:11:42.940</a></span> | <span class="t">So we initialize our mean to zero at the very start of training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7910" target="_blank">02:11:50.660</a></span> | <span class="t">And then the value that comes in is 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7913" target="_blank">02:11:53.740</a></span> | <span class="t">So we would expect the moving average to be 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7916" target="_blank">02:11:56.460</a></span> | <span class="t">But our lerp formula says it's equal to our previous value, which is 0, times 0.9 plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7925" target="_blank">02:12:05.820</a></span> | <span class="t">our new value times 0.1 equals 0 plus 1, equals 1, it's 10 times too small.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7937" target="_blank">02:12:17.820</a></span> | <span class="t">So that's very easy to correct for because we know it's always going to be wrong by that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7943" target="_blank">02:12:23.540</a></span> | <span class="t">amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7944" target="_blank">02:12:24.620</a></span> | <span class="t">So we then divide it by 0.1 and that fixes it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7951" target="_blank">02:12:31.540</a></span> | <span class="t">And then the second value has exactly the same problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7955" target="_blank">02:12:35.140</a></span> | <span class="t">It's got too much zero in it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7957" target="_blank">02:12:37.780</a></span> | <span class="t">But this time it's actually going to be divided by, let's not call it 0.1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7964" target="_blank">02:12:44.620</a></span> | <span class="t">Let's call it 1 minus 0.9.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7968" target="_blank">02:12:48.240</a></span> | <span class="t">Because when you work through the math, you'll see the second one, it's going to be divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7971" target="_blank">02:12:51.620</a></span> | <span class="t">by 1 minus 0.9 squared and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7979" target="_blank">02:12:59.980</a></span> | <span class="t">So this thing here where we divide by that, that's called debiasing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7983" target="_blank">02:13:03.620</a></span> | <span class="t">It's going to appear again when we look at optimization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7988" target="_blank">02:13:08.700</a></span> | <span class="t">So you can see what we do is we have a exponentially weighted debiasing amount where we simply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=7996" target="_blank">02:13:16.380</a></span> | <span class="t">keep multiplying momentum times the previous debiasing amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8002" target="_blank">02:13:22.560</a></span> | <span class="t">So initially it's just equal to momentum and then momentum squared and then momentum cubed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8008" target="_blank">02:13:28.220</a></span> | <span class="t">and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8012" target="_blank">02:13:32.300</a></span> | <span class="t">So then we do what I just said, we divide by the debiasing amount.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8022" target="_blank">02:13:42.540</a></span> | <span class="t">And then there's just one more thing we do, which is remember how I said you might get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8028" target="_blank">02:13:48.060</a></span> | <span class="t">really unlucky that your first mini-batch is just really close to zero and we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8033" target="_blank">02:13:53.460</a></span> | <span class="t">want that to destroy everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8035" target="_blank">02:13:55.420</a></span> | <span class="t">So I just say if you haven't seen more than a total of 20 items yet, just clamp the variance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8041" target="_blank">02:14:01.780</a></span> | <span class="t">to be no smaller than 0.01, just to avoid blowing out of the water.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8048" target="_blank">02:14:08.080</a></span> | <span class="t">And then the last two lines are the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8051" target="_blank">02:14:11.700</a></span> | <span class="t">So that's it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8055" target="_blank">02:14:15.140</a></span> | <span class="t">It's all pretty straightforward arithmetic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8058" target="_blank">02:14:18.940</a></span> | <span class="t">It's a very straightforward idea, but when we put it all together, it's shockingly effective.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8069" target="_blank">02:14:29.120</a></span> | <span class="t">And so then we can try an interesting thought experiment, so here's another thing to try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8073" target="_blank">02:14:33.060</a></span> | <span class="t">during the week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8075" target="_blank">02:14:35.460</a></span> | <span class="t">What's the best accuracy you can get in a single epoch?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8081" target="_blank">02:14:41.300</a></span> | <span class="t">So say run.fit 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8085" target="_blank">02:14:45.380</a></span> | <span class="t">And with this convolutional with running batch norm layer and a batch size of 32 and a linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8096" target="_blank">02:14:56.620</a></span> | <span class="t">schedule from one to 0.2, I got 97.5%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8101" target="_blank">02:15:01.380</a></span> | <span class="t">I only tried a couple of things, so this is definitely something that I hope you can beat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8106" target="_blank">02:15:06.240</a></span> | <span class="t">me at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8107" target="_blank">02:15:07.500</a></span> | <span class="t">But it's really good to create interesting little games to play.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8114" target="_blank">02:15:14.060</a></span> | <span class="t">In research, we call them toy problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8116" target="_blank">02:15:16.980</a></span> | <span class="t">Almost everything in research is basically toy problems.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8119" target="_blank">02:15:19.260</a></span> | <span class="t">Come up with toy problems and try to find good solutions to them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8123" target="_blank">02:15:23.540</a></span> | <span class="t">So another toy problem for this week is what's the best you can get using whatever kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8131" target="_blank">02:15:31.300</a></span> | <span class="t">normalization you like, whatever kind of architecture you like, as long as it only uses concepts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8136" target="_blank">02:15:36.980</a></span> | <span class="t">we've used up to lesson 7 to get the best accuracy you can in one epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8144" target="_blank">02:15:44.340</a></span> | <span class="t">So yeah, that's basically it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8150" target="_blank">02:15:50.140</a></span> | <span class="t">So what's the future of running batch norm?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8153" target="_blank">02:15:53.100</a></span> | <span class="t">I mean, it's kind of early days.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8156" target="_blank">02:15:56.620</a></span> | <span class="t">We haven't published this research yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8158" target="_blank">02:15:58.620</a></span> | <span class="t">We haven't done all the kind of ablation studies and stuff we need to do yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8162" target="_blank">02:16:02.940</a></span> | <span class="t">At this stage, though, I'm really excited about this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8165" target="_blank">02:16:05.020</a></span> | <span class="t">Every time I've tried it on something, it's been working really well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8170" target="_blank">02:16:10.220</a></span> | <span class="t">The last time that we had something in a lesson that we said, this is unpublished research</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8175" target="_blank">02:16:15.100</a></span> | <span class="t">that we're excited about, it turned into ULM fit, which is now a really widely used algorithm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8182" target="_blank">02:16:22.380</a></span> | <span class="t">and was published at the ACL.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8188" target="_blank">02:16:28.700</a></span> | <span class="t">So fingers crossed that this turns out to be something really terrific as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8192" target="_blank">02:16:32.420</a></span> | <span class="t">But either way, you've kind of got to see the process, because literally building these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8198" target="_blank">02:16:38.220</a></span> | <span class="t">notebooks was the process I used to create this algorithm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8201" target="_blank">02:16:41.500</a></span> | <span class="t">So you've seen the exact process that I used to build up this idea and do some initial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8209" target="_blank">02:16:49.180</a></span> | <span class="t">testing of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8210" target="_blank">02:16:50.380</a></span> | <span class="t">So hopefully that's been fun for you, and see you next week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=HR0lt1hlR6U&t=8213" target="_blank">02:16:53.660</a></span> | <span class="t">(audience applauds)</span></div></div></body></html>