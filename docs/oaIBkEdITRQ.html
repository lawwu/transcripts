<html><head><title>Mistral AI Agents | Full Walkthrough</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Mistral AI Agents | Full Walkthrough</h2><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ"><img src="https://i.ytimg.com/vi/oaIBkEdITRQ/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=0">0:0</a> Mistral AI Agent<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=47">0:47</a> Python Setup<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=104">1:44</a> Video Transcription<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=205">3:25</a> Agent Overview<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=423">7:3</a> Using Mistral<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=566">9:26</a> Adding Agent Chat History<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=683">11:23</a> Async and Streaming<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1073">17:53</a> Agent Token Usage<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1157">19:17</a> Building a Retrieval Agent<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1552">25:52</a> Creating a Tool for Mistral<br><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2020">33:40</a> Tool Execution Logic<br><br><div style="text-align: left;"><a href="./oaIBkEdITRQ.html">Whisper Transcript</a> | <a href="./transcript_oaIBkEdITRQ.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today, we're going to be building an AI agent that allows us to chat with videos.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=6" target="_blank">00:00:06.200</a></span> | <span class="t">This AI agent will be fully conversational.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=8" target="_blank">00:00:08.960</a></span> | <span class="t">We'll be using Mistral's embed and LEM endpoints to build it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=14" target="_blank">00:00:14.500</a></span> | <span class="t">We'll also be using the Aurelio platform's video processing and chunking endpoints to prepare our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=22" target="_blank">00:00:22.660</a></span> | <span class="t">Our agent will also use async and streaming so that we get a more scalable application that also has a nice user-friendly design of seeing streaming of tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=34" target="_blank">00:00:34.640</a></span> | <span class="t">And towards the end of the video, we're going to be bringing all this together and seeing how we can build a significantly optimized agent that will allow us to reduce our costs pretty dramatically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=47" target="_blank">00:00:47.400</a></span> | <span class="t">So let's jump straight into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=49" target="_blank">00:00:49.920</a></span> | <span class="t">When we're working through this example notebook, we first install our prerequisites.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=55" target="_blank">00:00:55.060</a></span> | <span class="t">We have the Aurelio SDK for the video transcriptions and chunking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=60" target="_blank">00:01:00.780</a></span> | <span class="t">We have YouTube DLP here, which is going to download a YouTube video for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=65" target="_blank">00:01:05.420</a></span> | <span class="t">And Mr. AI, of course, for the LEM and embed endpoints.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=70" target="_blank">00:01:10.100</a></span> | <span class="t">So the first thing we're going to do is download a YouTube video here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=74" target="_blank">00:01:14.380</a></span> | <span class="t">This YouTube video is one that I did before, and it's essentially a video version of this article here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=85" target="_blank">00:01:25.260</a></span> | <span class="t">So going through this, we see that I'm talking about AI agents as neuro-symbolic systems and talking about the neuro side of AI versus the symbolic side of AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=96" target="_blank">00:01:36.940</a></span> | <span class="t">A little bit of history there, what they both mean, so on and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=100" target="_blank">00:01:40.780</a></span> | <span class="t">So we'll be able to ask a few questions around all of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=104" target="_blank">00:01:44.020</a></span> | <span class="t">Now, we're going to go ahead, and first thing we need to do is actually get the Aurelio API key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=109" target="_blank">00:01:49.240</a></span> | <span class="t">So for that, we need to go to platform.aurelio.ai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=114" target="_blank">00:01:54.540</a></span> | <span class="t">We log in at the top here, and I'm going to use Google.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=120" target="_blank">00:02:00.880</a></span> | <span class="t">Okay, and because it's my first time logging with this account, it's going to take me through this little guide.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=127" target="_blank">00:02:07.100</a></span> | <span class="t">We can, you can go through it, or you can skip it by pressing the X here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=131" target="_blank">00:02:11.800</a></span> | <span class="t">So I'm going to come over to here, and we do need to add credits before using the API, but you can also use coupon codes to get free credits, essentially.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=142" target="_blank">00:02:22.720</a></span> | <span class="t">So, I'm going to show you how to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=145" target="_blank">00:02:25.160</a></span> | <span class="t">The coupon code is for $5, so you'd go to here, click purchase, and what you need to do is come over to here where it says add promotion code and type in JB video agent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=159" target="_blank">00:02:39.000</a></span> | <span class="t">Okay, and you can apply that, and you'll get $5 in credits.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=164" target="_blank">00:02:44.820</a></span> | <span class="t">Okay, so now we can go over to API keys, we create a new API key, you can call it whatever you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=170" target="_blank">00:02:50.680</a></span> | <span class="t">I'm going to call it video agent, and I'm just going to copy that, bring it over into my notebook here, and there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=179" target="_blank">00:02:59.640</a></span> | <span class="t">So I've now authenticated with the Aurelio client here, and then what I'm going to do is send the video to the platform for processing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=189" target="_blank">00:03:09.600</a></span> | <span class="t">So I'm just going to process it as a single video right now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=193" target="_blank">00:03:13.360</a></span> | <span class="t">I'm not going to chunk anything yet, we're going to do chunking a little bit later, because I want to show you how we use chunking to optimize our costs, which are, we'll see, it's very significant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=204" target="_blank">00:03:24.740</a></span> | <span class="t">So, that will take a little while to process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=208" target="_blank">00:03:28.760</a></span> | <span class="t">So while that's processing, let me talk you through what the first pipeline is that we're building.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=215" target="_blank">00:03:35.940</a></span> | <span class="t">Now, to begin with, our pipeline is going to be pretty simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=219" target="_blank">00:03:39.540</a></span> | <span class="t">So we're going to have our video coming in from YouTube, we're going to be passing that into the system prompt of the agent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=229" target="_blank">00:03:49.300</a></span> | <span class="t">Now, the system prompt is going to include some additional context.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=233" target="_blank">00:03:53.440</a></span> | <span class="t">So it's going to include some instructions on how it should be used initially, but then we're going to insert the additional context, which is our transcribed video, into the system prompt here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=248" target="_blank">00:04:08.200</a></span> | <span class="t">Then, this is going to come down here, and it's going to be fed into an LLM alongside a user query, which is going to bring that in from over here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=259" target="_blank">00:04:19.220</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=260" target="_blank">00:04:20.000</a></span> | <span class="t">So our user will probably ask the question, and that will feed in just here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=263" target="_blank">00:04:23.900</a></span> | <span class="t">Now, our LLM will then produce an answer based on both the context that we provided up here, and our user query, and it will return it back to us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=274" target="_blank">00:04:34.040</a></span> | <span class="t">So it's pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=276" target="_blank">00:04:36.760</a></span> | <span class="t">This is the initial pipeline we're going to be building, but we are going to make this slightly more sophisticated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=281" target="_blank">00:04:41.120</a></span> | <span class="t">So what we will be doing is removing this context from over here, and also this video component.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=288" target="_blank">00:04:48.560</a></span> | <span class="t">So those will now exist over here in a separate part, which is actually our tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=294" target="_blank">00:04:54.680</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=295" target="_blank">00:04:55.300</a></span> | <span class="t">So this is our tool here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=296" target="_blank">00:04:56.460</a></span> | <span class="t">Now, what that tool is going to do is given a LLM generated query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=302" target="_blank">00:05:02.340</a></span> | <span class="t">So the LLM will generate a query, like, okay, I need to search based on the user's query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=307" target="_blank">00:05:07.000</a></span> | <span class="t">I need to search for this, and it might even do this multiple times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=310" target="_blank">00:05:10.580</a></span> | <span class="t">It might try and answer multiple questions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=312" target="_blank">00:05:12.280</a></span> | <span class="t">So based on that, it's going to come over to here, and an embedding model, again, from Mistral, is going to convert that into what we'd call a query vector, which I would usually write as XQ.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=326" target="_blank">00:05:26.460</a></span> | <span class="t">All right, so that embed endpoint takes that query and turns it into XQ.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=331" target="_blank">00:05:31.320</a></span> | <span class="t">Now, what we've also done in the middle of all this is we've taken our article here, and we've actually chunked it into many smaller parts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=342" target="_blank">00:05:42.720</a></span> | <span class="t">Now, by chunking these into many smaller parts, we allow ourselves to perform what is essentially RAG across them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=351" target="_blank">00:05:51.420</a></span> | <span class="t">So retrieval augments generation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=353" target="_blank">00:05:53.280</a></span> | <span class="t">And the way that we do that, again, this is before we come to the LLM inference time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=358" target="_blank">00:05:58.500</a></span> | <span class="t">The way that we will have done that, or set that up, is that all of these chunks here will have actually been passed through our embed endpoint, and been used to generate a Numpy array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=371" target="_blank">00:06:11.860</a></span> | <span class="t">Now, once we have that Numpy array over here, and then we have our query vector, all we need to do is perform a simple NP dot across both our query vector and that array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=386" target="_blank">00:06:26.260</a></span> | <span class="t">And what we'll get from that is a similarity rate that tells us which of those values are the most relevant or the most similar to our query vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=397" target="_blank">00:06:37.480</a></span> | <span class="t">So we can essentially cancel out a few of those records and only return the ones that are the most relevant.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=404" target="_blank">00:06:44.680</a></span> | <span class="t">So in that whole process, although it seems like a more complicated system, and it is, to some degree, a more complicated system, we actually massively reduce the number of tokens that we're sending to our LLM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=417" target="_blank">00:06:57.060</a></span> | <span class="t">And this is with just one transcribed video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=419" target="_blank">00:06:59.960</a></span> | <span class="t">With more, that would be even greater.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=423" target="_blank">00:07:03.680</a></span> | <span class="t">Now, once that has finished processing, we can come down to here and check the content.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=428" target="_blank">00:07:08.900</a></span> | <span class="t">So you see there is essentially the full transcribed video in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=433" target="_blank">00:07:13.100</a></span> | <span class="t">We can also count the number of words from that transcribed video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=437" target="_blank">00:07:17.000</a></span> | <span class="t">So it's just over 4,000 words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=439" target="_blank">00:07:19.360</a></span> | <span class="t">Now we can move on to connecting that to our LLM for that first version of a simple video plus LLM pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=447" target="_blank">00:07:27.120</a></span> | <span class="t">To do that, we will need a Mistral API key.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=450" target="_blank">00:07:30.300</a></span> | <span class="t">We get those from console.mistral.ai API keys.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=454" target="_blank">00:07:34.380</a></span> | <span class="t">So you'd come over here, create new key, and I'm going to call this video agent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=459" target="_blank">00:07:39.560</a></span> | <span class="t">You then just copy your key and throw it into your notebook here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=463" target="_blank">00:07:43.880</a></span> | <span class="t">Now, if you run this straight away, occasionally, you might see this error, unauthorized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=469" target="_blank">00:07:49.500</a></span> | <span class="t">Now, if we go back to the API key created box here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=475" target="_blank">00:07:55.140</a></span> | <span class="t">It does note that sometimes it can take a few minutes to be usable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=478" target="_blank">00:07:58.260</a></span> | <span class="t">So we can just try again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=481" target="_blank">00:08:01.360</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=482" target="_blank">00:08:02.820</a></span> | <span class="t">So it seems like we're good now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=484" target="_blank">00:08:04.600</a></span> | <span class="t">And there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=485" target="_blank">00:08:05.900</a></span> | <span class="t">So now we need to get our message content.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=488" target="_blank">00:08:08.940</a></span> | <span class="t">So this is what it was returned based on this chat complete from Mistral here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=494" target="_blank">00:08:14.640</a></span> | <span class="t">So first things first, we are using the Mistral large latest model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=499" target="_blank">00:08:19.600</a></span> | <span class="t">And I just want to point out for the system message here is a pretty generic system message.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=506" target="_blank">00:08:26.160</a></span> | <span class="t">But then we're adding in the transcription and the content of that transcription, which we got earlier on from the video file content there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=517" target="_blank">00:08:37.940</a></span> | <span class="t">And then as a user message, I said, hi, can you summarize this for me?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=522" target="_blank">00:08:42.300</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=523" target="_blank">00:08:43.080</a></span> | <span class="t">So pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=524" target="_blank">00:08:44.580</a></span> | <span class="t">And you can see here that we have the assistant message with some content.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=528" target="_blank">00:08:48.400</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=528" target="_blank">00:08:48.940</a></span> | <span class="t">So that's cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=530" target="_blank">00:08:50.220</a></span> | <span class="t">One thing that we can also see in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=533" target="_blank">00:08:53.520</a></span> | <span class="t">So if we go to response usage, we can see how many tokens we used, which would be pretty useful later on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=540" target="_blank">00:09:00.860</a></span> | <span class="t">Now, already looking at this, see that we use a ton of prompt tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=545" target="_blank">00:09:05.440</a></span> | <span class="t">So prompt tokens are the input tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=547" target="_blank">00:09:07.280</a></span> | <span class="t">Completion tokens are what the LLM generates back to us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=551" target="_blank">00:09:11.940</a></span> | <span class="t">So feeding the whole transcription in with every single query, that is just naturally going to lead to a lot of prompt tokens being used, which of course does add up to the cost.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=564" target="_blank">00:09:24.000</a></span> | <span class="t">And we'll see the cost for that relatively soon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=566" target="_blank">00:09:26.200</a></span> | <span class="t">But for now, let's just work on making this pipeline that we have a little more conversational.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=574" target="_blank">00:09:34.800</a></span> | <span class="t">So to do that, we're going to define this agent class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=578" target="_blank">00:09:38.840</a></span> | <span class="t">Now, I wouldn't necessarily define this as an agent just yet, but later this class will become our agent class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=585" target="_blank">00:09:45.940</a></span> | <span class="t">So right now, I'm just wrapping what we did already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=589" target="_blank">00:09:49.880</a></span> | <span class="t">So we have our prompt and then we'll be feeding in our user query when we hit the chat method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=595" target="_blank">00:09:55.880</a></span> | <span class="t">Then we are hitting client chat complete with those messages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=601" target="_blank">00:10:01.220</a></span> | <span class="t">And all I'm doing here is keeping these self.messages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=606" target="_blank">00:10:06.880</a></span> | <span class="t">So self.messages is a simple list where we're storing the messages as we create more and more interactions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=615" target="_blank">00:10:15.180</a></span> | <span class="t">So let's see how that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=616" target="_blank">00:10:16.840</a></span> | <span class="t">I'm going to display everything in Markdown, by the way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=619" target="_blank">00:10:19.580</a></span> | <span class="t">As we saw just up here, the agent is using Markdown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=622" target="_blank">00:10:22.520</a></span> | <span class="t">So it's always nicer to see the responses in Markdown.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=626" target="_blank">00:10:26.580</a></span> | <span class="t">So we have our response.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=630" target="_blank">00:10:30.380</a></span> | <span class="t">You can see that the query here is, can you summarize the meaning of symbolic in this article?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=635" target="_blank">00:10:35.040</a></span> | <span class="t">And in the context of this article, symbolic refers to the traditional approach to artificial intelligence that involves using handwritten rules, anthologies, and logical functions, so on and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=647" target="_blank">00:10:47.740</a></span> | <span class="t">Okay, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=649" target="_blank">00:10:49.820</a></span> | <span class="t">Now let's check that our conversational features, i.e. the self.messages attribute is working by asking a follow-up question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=660" target="_blank">00:11:00.040</a></span> | <span class="t">Can you give me that, but in short bullet points?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=662" target="_blank">00:11:02.860</a></span> | <span class="t">If the chat history is not being stored and being sent to our LLM, the LLM will have no idea how to answer this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=671" target="_blank">00:11:11.080</a></span> | <span class="t">It will just see that we're asking, can you give me that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=674" target="_blank">00:11:14.860</a></span> | <span class="t">It has no idea what that is, but in short bullet points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=679" target="_blank">00:11:19.220</a></span> | <span class="t">Okay, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=679" target="_blank">00:11:19.880</a></span> | <span class="t">And we get some nice bullet points.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=682" target="_blank">00:11:22.400</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=683" target="_blank">00:11:23.280</a></span> | <span class="t">So we have that built a LLM pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=687" target="_blank">00:11:27.380</a></span> | <span class="t">It is conversational and it has that input for video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=690" target="_blank">00:11:30.920</a></span> | <span class="t">And we're able to ask it questions about video and speak with it in a conversational way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=695" target="_blank">00:11:35.420</a></span> | <span class="t">Now, what I want to talk about next is using asynchronous code and implementing streaming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=702" target="_blank">00:11:42.860</a></span> | <span class="t">Now, why do those two things matter?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=705" target="_blank">00:11:45.740</a></span> | <span class="t">Well, async code is actually incredibly important, especially for AI applications.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=714" target="_blank">00:11:54.080</a></span> | <span class="t">The reason I say that is because with AI applications, we tend to use a lot of API calls,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=719" target="_blank">00:11:59.960</a></span> | <span class="t">more so than many other applications.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=722" target="_blank">00:12:02.460</a></span> | <span class="t">And those API calls, not only do we have a lot of them, but they also take a long time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=730" target="_blank">00:12:10.660</a></span> | <span class="t">because they're waiting for an LLM to respond.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=732" target="_blank">00:12:12.740</a></span> | <span class="t">Now, if we're writing synchronous code, whilst we are waiting for a response from our LLM API,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=740" target="_blank">00:12:20.180</a></span> | <span class="t">our Python code is doing nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=743" target="_blank">00:12:23.560</a></span> | <span class="t">It is just waiting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=745" target="_blank">00:12:25.500</a></span> | <span class="t">It's doing nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=746" target="_blank">00:12:26.300</a></span> | <span class="t">If we write asynchronous code, our Python code can be going and doing other things whilst it is waiting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=753" target="_blank">00:12:33.460</a></span> | <span class="t">And then once the response is received from the API, our Python code will see that and it can then jump back into that task and continue processing from there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=764" target="_blank">00:12:44.900</a></span> | <span class="t">Okay, so it frees up a ton of compute time if we write our code asynchronously, especially for AI applications.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=773" target="_blank">00:12:53.380</a></span> | <span class="t">Then we have streaming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=774" target="_blank">00:12:54.600</a></span> | <span class="t">Now, streaming is more of a preference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=779" target="_blank">00:12:59.180</a></span> | <span class="t">So, with streaming, let's say we get quite a long response from our LLM.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=786" target="_blank">00:13:06.280</a></span> | <span class="t">Without streaming, that can feel quite painful to a user.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=790" target="_blank">00:13:10.300</a></span> | <span class="t">The user experience is that you're just waiting and waiting and waiting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=796" target="_blank">00:13:16.680</a></span> | <span class="t">And then you just get this massive chunk of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=799" target="_blank">00:13:19.180</a></span> | <span class="t">And that's okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=802" target="_blank">00:13:22.340</a></span> | <span class="t">But it's not a great experience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=806" target="_blank">00:13:26.460</a></span> | <span class="t">And there are so many applications out there that use streaming that most users of AI systems now kind of expect streaming as a standard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=817" target="_blank">00:13:37.320</a></span> | <span class="t">So, it's almost an essential feature for most, particularly chat, interfaces.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=822" target="_blank">00:13:42.900</a></span> | <span class="t">And another thing that we can do really nicely, which I'll use Perplexity as an example here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=829" target="_blank">00:13:49.200</a></span> | <span class="t">When we use the Perplexity interface and Perplexity goes and searches for something, the LLM is generating that search query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=839" target="_blank">00:13:59.400</a></span> | <span class="t">And it's deciding what tool to use, which is, in that case, a web search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=842" target="_blank">00:14:02.900</a></span> | <span class="t">If we stream our tokens, we can actually implement that in our own applications as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=848" target="_blank">00:14:08.420</a></span> | <span class="t">So, whilst, in this case, as we'll see later, whilst our agent is going and looking at our video transcription and performing a search,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=860" target="_blank">00:14:20.480</a></span> | <span class="t">we can actually see that our agent is doing that and can see how it's doing that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=864" target="_blank">00:14:24.700</a></span> | <span class="t">We can see the search queries that are happening, which allows us to build far more interesting experiences for users, in my opinion.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=873" target="_blank">00:14:33.660</a></span> | <span class="t">Okay, so, let's go ahead and see how we can rewrite this agent class to use async and also implement streaming.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=883" target="_blank">00:14:43.740</a></span> | <span class="t">So, we're not changing anything about how we're initializing our agent here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=887" target="_blank">00:14:47.980</a></span> | <span class="t">The only thing we're really changing is we're now defining our chat method here with async.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=895" target="_blank">00:14:55.340</a></span> | <span class="t">So, this makes it an asynchronous method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=897" target="_blank">00:14:57.700</a></span> | <span class="t">And we're switching from Mr. All's synchronous chat method to Mr. All's streaming and async chat method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=907" target="_blank">00:15:07.760</a></span> | <span class="t">Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=908" target="_blank">00:15:08.660</a></span> | <span class="t">So, async, because of this, this means we will now need to await the response.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=914" target="_blank">00:15:14.320</a></span> | <span class="t">And because we're streaming, that means that we will see just here, we're actually iterating through our response and getting the tokens out from there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=926" target="_blank">00:15:26.040</a></span> | <span class="t">Okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=926" target="_blank">00:15:26.820</a></span> | <span class="t">So, the chunks are coming through from our streaming response description in a slightly different way to what they were before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=932" target="_blank">00:15:32.940</a></span> | <span class="t">which was the, we just got a single assistant message block and that just had everything inside it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=938" target="_blank">00:15:38.280</a></span> | <span class="t">Instead, now, we're getting messages, but for each chunk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=943" target="_blank">00:15:43.060</a></span> | <span class="t">So, we still need to go through, we need to go through into the chunks of data, we need to extract from the choices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=949" target="_blank">00:15:49.040</a></span> | <span class="t">And we're now looking at the delta, which contains any changes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=952" target="_blank">00:15:52.840</a></span> | <span class="t">And inside the delta, we have our content.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=955" target="_blank">00:15:55.980</a></span> | <span class="t">So, we're saying if that content is not none, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=960" target="_blank">00:16:00.020</a></span> | <span class="t">If that content is not none, we are going to go into this if statement here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=965" target="_blank">00:16:05.320</a></span> | <span class="t">And we're also just using the walrus operator here to pipe this information into the token variable here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=973" target="_blank">00:16:13.320</a></span> | <span class="t">Because that means we don't have to, well, we don't have to take this and put it into here, which would be just not as clean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=982" target="_blank">00:16:22.720</a></span> | <span class="t">So, we do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=983" target="_blank">00:16:23.420</a></span> | <span class="t">Then, the final thing that we do is we also create a list of all of our tokens that we're receiving.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=991" target="_blank">00:16:31.720</a></span> | <span class="t">So, what that allows us to do is, on the next line down here, it allows us to take all of those tokens, join them together,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=999" target="_blank">00:16:39.380</a></span> | <span class="t">and then use them to actually output a final assistant message object, which contains everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1006" target="_blank">00:16:46.260</a></span> | <span class="t">So, we do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1008" target="_blank">00:16:48.220</a></span> | <span class="t">There's also a slight difference to our usage attribute here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1011" target="_blank">00:16:51.460</a></span> | <span class="t">So, we have to go chunk data usage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1015" target="_blank">00:16:55.080</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1016" target="_blank">00:16:56.820</a></span> | <span class="t">So, that is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1017" target="_blank">00:16:57.960</a></span> | <span class="t">We extract our assistant message from the messages that we added here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1022" target="_blank">00:17:02.880</a></span> | <span class="t">And let's go ahead and try that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1025" target="_blank">00:17:05.240</a></span> | <span class="t">So, I'm going to use the same query again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1028" target="_blank">00:17:08.080</a></span> | <span class="t">Can you summarize the meaning of symbolic in this article?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1031" target="_blank">00:17:11.640</a></span> | <span class="t">And we should see a streamed output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1034" target="_blank">00:17:14.900</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1040" target="_blank">00:17:20.420</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1041" target="_blank">00:17:21.700</a></span> | <span class="t">So, we're now seeing a streamed output there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1043" target="_blank">00:17:23.720</a></span> | <span class="t">And one other thing that I should point out is that we have to await our agent.chat method now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1050" target="_blank">00:17:30.960</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1051" target="_blank">00:17:31.280</a></span> | <span class="t">So, that all looks pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1053" target="_blank">00:17:33.020</a></span> | <span class="t">We can continue our conversation a little bit here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1055" target="_blank">00:17:35.800</a></span> | <span class="t">And I want to do this so that we can see the, essentially, the usage of our conversation over time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1065" target="_blank">00:17:45.020</a></span> | <span class="t">Great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1067" target="_blank">00:17:47.340</a></span> | <span class="t">So, plenty of tokens output there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1069" target="_blank">00:17:49.440</a></span> | <span class="t">But then, of course, also plenty of tokens input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1072" target="_blank">00:17:52.480</a></span> | <span class="t">So, we can see that even though we output a ton of text here, now, they're pretty lengthy responses, that output is still not even comparable to the inputs that we have, which are huge.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1087" target="_blank">00:18:07.040</a></span> | <span class="t">So, the number of inputs here is, of course, all made up by us feeding that article in every single time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1093" target="_blank">00:18:13.340</a></span> | <span class="t">So, the question now is, one, how much does that cost?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1097" target="_blank">00:18:17.620</a></span> | <span class="t">And then, two, can we optimize it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1100" target="_blank">00:18:20.060</a></span> | <span class="t">So, we define a cost calculator here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1105" target="_blank">00:18:25.140</a></span> | <span class="t">And we need to calculate based on these prices here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1110" target="_blank">00:18:30.700</a></span> | <span class="t">So, input tokens, which is our prompt tokens, and output tokens, which is our completion tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1115" target="_blank">00:18:35.980</a></span> | <span class="t">So, I'm going to run that, and let's just see how much that costs us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1119" target="_blank">00:18:39.440</a></span> | <span class="t">So, looking at this, we're paying, these seem like pretty small numbers, but this is for, each one of these is for a single interaction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1130" target="_blank">00:18:50.160</a></span> | <span class="t">So, that actually will add up quite quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1133" target="_blank">00:18:53.600</a></span> | <span class="t">After just 100 interactions, you're paying a dollar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1136" target="_blank">00:18:56.660</a></span> | <span class="t">Or even, sorry, even more than a dollar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1139" target="_blank">00:18:59.680</a></span> | <span class="t">Probably, you're hitting a dollar within maybe 70 interactions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1144" target="_blank">00:19:04.240</a></span> | <span class="t">So, depending on if this is a single conversation that's just getting bigger and bigger, or whether it's multiple conversations over time with a small number of interactions in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1154" target="_blank">00:19:14.080</a></span> | <span class="t">But you can see how that would add up very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1157" target="_blank">00:19:17.240</a></span> | <span class="t">Now, to optimize this, what we're going to do is what I described here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1164" target="_blank">00:19:24.080</a></span> | <span class="t">So, this component here, where we're breaking up our transcribed document into smaller pieces, and then only using what we need from those chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1174" target="_blank">00:19:34.740</a></span> | <span class="t">So, how do we implement that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1177" target="_blank">00:19:37.740</a></span> | <span class="t">There are a few steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1179" target="_blank">00:19:39.600</a></span> | <span class="t">Like I said, it's not necessarily a simpler system, although it's not complicated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1184" target="_blank">00:19:44.840</a></span> | <span class="t">But it is a far more efficient, and scalable, and cost-effective system.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1189" target="_blank">00:19:49.920</a></span> | <span class="t">So, what will we do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1191" target="_blank">00:19:51.660</a></span> | <span class="t">We're going to break our transcribed documents into smaller chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1194" target="_blank">00:19:54.940</a></span> | <span class="t">Embed those chunks into vector embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1197" target="_blank">00:19:57.960</a></span> | <span class="t">Sore those vector embeddings in a numpy array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1200" target="_blank">00:20:00.720</a></span> | <span class="t">Then, when querying, our LLM will transform our question into a small query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1207" target="_blank">00:20:07.440</a></span> | <span class="t">We embed that query into a vector embedding that creates the XQ query vector that I mentioned earlier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1213" target="_blank">00:20:13.340</a></span> | <span class="t">Then, we compare the semantic similarity between our query vector and chunk vectors to find the most similar chunks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1220" target="_blank">00:20:20.940</a></span> | <span class="t">and return only those most relevant chunks to our LLM for the final response.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1226" target="_blank">00:20:26.180</a></span> | <span class="t">So, let's start by chunking our document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1230" target="_blank">00:20:30.260</a></span> | <span class="t">Now that we're using async everything, we can go ahead and use the async Aurelio chunking endpoint as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1238" target="_blank">00:20:38.440</a></span> | <span class="t">Although, given that this is preprocessing, we don't necessarily need to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1243" target="_blank">00:20:43.120</a></span> | <span class="t">But in any case, then we'll come down to here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1245" target="_blank">00:20:45.280</a></span> | <span class="t">And we first want to set up our chunking options for our semantic chunker.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1251" target="_blank">00:20:51.800</a></span> | <span class="t">So, we're using a semantic chunker, which means that our chunks are going to be produced by looking at the semantic similarities between parallel components in the text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1261" target="_blank">00:21:01.720</a></span> | <span class="t">Next, we say that we want a maximum chunk length of up to 500 tokens, which is quite big to be honest.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1267" target="_blank">00:21:07.700</a></span> | <span class="t">I might even suggest going lower, but it's okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1271" target="_blank">00:21:11.600</a></span> | <span class="t">And we use a window size of 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1273" target="_blank">00:21:13.560</a></span> | <span class="t">That is essentially what is the rolling window in which we are comparing the similarities between our parallel components within the text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1283" target="_blank">00:21:23.540</a></span> | <span class="t">So, then we get our chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1285" target="_blank">00:21:25.000</a></span> | <span class="t">You can see in the first chunk, I'm talking about the Apple Remote program and the Front Row program.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1290" target="_blank">00:21:30.540</a></span> | <span class="t">And then there's a couple of chunks in the middle here that are a little bit disjointed from the other parts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1296" target="_blank">00:21:36.380</a></span> | <span class="t">It's mostly spoken audio, so I'm rambling a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1300" target="_blank">00:21:40.340</a></span> | <span class="t">And then we can see down here that this final chunk here is focusing on the React agent and how it relates to a broader definition of agents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1313" target="_blank">00:21:53.200</a></span> | <span class="t">So, we have those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1315" target="_blank">00:21:55.300</a></span> | <span class="t">And what we can do now is actually take those chunks and we're going to embed them using Mistral again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1323" target="_blank">00:22:03.200</a></span> | <span class="t">Again, to keep everything in line with the async approach, we're using the async method for embeddings here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1329" target="_blank">00:22:09.940</a></span> | <span class="t">And we do actually need to use this async method later on when we're producing our query embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1334" target="_blank">00:22:14.800</a></span> | <span class="t">And we use the Mistral embed model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1336" target="_blank">00:22:16.900</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1337" target="_blank">00:22:17.640</a></span> | <span class="t">So, we're just taking the content of our chunks out here and inputting them to create our embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1344" target="_blank">00:22:24.420</a></span> | <span class="t">And if we look in our embeddings response data, we'll see that we have 35 chunks there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1352" target="_blank">00:22:32.240</a></span> | <span class="t">We can also go in and see the length of each one of those embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1357" target="_blank">00:22:37.340</a></span> | <span class="t">So, the embedding dimensionality of this Mistral embed model is 1024, which is a very typical dimensionality for most embedding models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1371" target="_blank">00:22:51.040</a></span> | <span class="t">Now, we take all those and we're just going to combine them all into a single NumPy array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1375" target="_blank">00:22:55.680</a></span> | <span class="t">This will allow us to perform the dot product comparison later against it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1380" target="_blank">00:23:00.160</a></span> | <span class="t">And let's see how we would do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1382" target="_blank">00:23:02.360</a></span> | <span class="t">So, I'm going to ask the first question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1384" target="_blank">00:23:04.840</a></span> | <span class="t">Of course, later on, I'm going to want to embed all of this within our search tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1390" target="_blank">00:23:10.220</a></span> | <span class="t">But first, I want to ask this first question of, what is the relationship between AI agents and good old-fashioned AI?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1397" target="_blank">00:23:17.020</a></span> | <span class="t">I'm going to embed that query using Mistral embed again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1401" target="_blank">00:23:21.720</a></span> | <span class="t">And I'm going to convert it into an array and create my query vector.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1407" target="_blank">00:23:27.840</a></span> | <span class="t">The query vector shape gives us the dimensionality of the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1413" target="_blank">00:23:33.000</a></span> | <span class="t">And with that, we're actually ready to calculate the similarity, specifically dot product similarity, between our query vector, XQ, and the pre-computed document chunk vectors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1424" target="_blank">00:23:44.300</a></span> | <span class="t">And you can see in here, these are all of the similarity scores.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1429" target="_blank">00:23:49.420</a></span> | <span class="t">So, if we're looking through this, we would see, okay, these values here, these ones, these are all kind of higher ones around there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1438" target="_blank">00:23:58.180</a></span> | <span class="t">And they all tend to correlate into a certain segment of the transcribed document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1445" target="_blank">00:24:05.120</a></span> | <span class="t">And that is generally expected because when you're talking through something, you're going to be switching from one topic to another topic to another topic over time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1455" target="_blank">00:24:15.360</a></span> | <span class="t">And those topics that share the highest proximity within your, you know, your story or your video, they're probably going to be more related than a random chunk from, you know, let's say the end of the video or the start of the video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1471" target="_blank">00:24:31.620</a></span> | <span class="t">Okay, so we can use np.org.sort with a top K value of three to return the top three most similar chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1482" target="_blank">00:24:42.100</a></span> | <span class="t">Okay, so we see that that is 10, 12, and 13, which is probably, if we look at these, I think it is this value, 10, 12, and 13, so the ones we pointed out earlier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1495" target="_blank">00:24:55.800</a></span> | <span class="t">Great, so we have those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1498" target="_blank">00:24:58.640</a></span> | <span class="t">And then what we're going to do is get those index values, and we're going to use them to get our most relevant chunks or the chunk content from those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1510" target="_blank">00:25:10.860</a></span> | <span class="t">Like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1511" target="_blank">00:25:11.680</a></span> | <span class="t">So looking at these, we can see in here, I'm talking about the symbolic AI stuff in the middle here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1522" target="_blank">00:25:22.880</a></span> | <span class="t">We're talking about rules, ontologies, and other logical functions, okay, which is the good old-fashioned AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1530" target="_blank">00:25:30.140</a></span> | <span class="t">Then here, I actually mentioned good old-fashioned AI directly at the end now, but I think I'm generally talking about the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1536" target="_blank">00:25:36.920</a></span> | <span class="t">And then here, I think, oh, go-fi, probably I'm saying good old-fashioned AI, i.e. go-fi there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1545" target="_blank">00:25:45.420</a></span> | <span class="t">And, yeah, I'm talking about how that compares to connectionism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1548" target="_blank">00:25:48.600</a></span> | <span class="t">So all those seem relevant to the question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1551" target="_blank">00:25:51.960</a></span> | <span class="t">Now, what we want to do is take what we've just done and compress all that into a single function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1560" target="_blank">00:26:00.240</a></span> | <span class="t">Okay, that function, again, will be async.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1562" target="_blank">00:26:02.640</a></span> | <span class="t">So, in this function, we are providing a .string, which we're going to use this .string in order to understand how it should use this function and when it should use this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1575" target="_blank">00:26:15.100</a></span> | <span class="t">So, I want to give it as much information as possible here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1577" target="_blank">00:26:17.460</a></span> | <span class="t">That's why I'm saying use this tool to search a relevant chunk of information from the provided video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1582" target="_blank">00:26:22.280</a></span> | <span class="t">And I'm saying how the LM should use this tool as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1586" target="_blank">00:26:26.800</a></span> | <span class="t">So, I'm saying provide as much context as possible to the query parameter, ensuring to write your search query in natural language.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1593" target="_blank">00:26:33.220</a></span> | <span class="t">That's how you would get the best results here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1595" target="_blank">00:26:35.160</a></span> | <span class="t">Then, I also want to say, okay, if there are multiple questions being asked, to just use this tool for one of those questions at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1605" target="_blank">00:26:45.500</a></span> | <span class="t">And the reason we do that is it can improve the retrieval quality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1609" target="_blank">00:26:49.880</a></span> | <span class="t">Because if you imagine asking five questions all at once and your LM sends all that to your embedding model, your embedding model is essentially taking a query and it's placing it at one point in vector space.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1624" target="_blank">00:27:04.060</a></span> | <span class="t">And if you have five different meanings to your query and you're trying to compress those five different meanings into one point in vector space, you are essentially diluting the quality of your embedding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1637" target="_blank">00:27:17.920</a></span> | <span class="t">You're almost averaging out your embedding between those five different meanings that your query actually has.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1646" target="_blank">00:27:26.760</a></span> | <span class="t">So, although it can still give you the results you need, it's generally better to try and separate out your query that can be more concise when you're doing a vector search like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1658" target="_blank">00:27:38.760</a></span> | <span class="t">So, all we're doing here is what we just did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1662" target="_blank">00:27:42.680</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1663" target="_blank">00:27:43.080</a></span> | <span class="t">We're creating our query vector, using it to search across our chunks, getting the highest scoring similarity scores from that, and then using that to retrieve the most relevant chunks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1674" target="_blank">00:27:54.480</a></span> | <span class="t">And then I also merge those into a single string for our LM to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1678" target="_blank">00:27:58.860</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1679" target="_blank">00:27:59.220</a></span> | <span class="t">So let's try that quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1680" target="_blank">00:28:00.960</a></span> | <span class="t">Our query here is, I think it's still what we asked before, which is what is the relationship between AI agents and GoFi?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1688" target="_blank">00:28:08.000</a></span> | <span class="t">So we should see similar results, well, the same results, even, and yes, that is what we can see there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1694" target="_blank">00:28:14.180</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1695" target="_blank">00:28:15.320</a></span> | <span class="t">So we now need to redefine our agent and plug that new function or tool into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1704" target="_blank">00:28:24.020</a></span> | <span class="t">Now, to do that with the Mr API, we actually need to create a function schema object, which is what we're doing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1714" target="_blank">00:28:34.180</a></span> | <span class="t">So I am getting the doc string with this from our search function, which we can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1720" target="_blank">00:28:40.120</a></span> | <span class="t">I'm placing that doc string into the description here of our function schema.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1725" target="_blank">00:28:45.340</a></span> | <span class="t">Then I'm taking the name of our, let me even just copy this, just the name of our search function, which is obviously search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1734" target="_blank">00:28:54.940</a></span> | <span class="t">Then I'm also just initializing these parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1738" target="_blank">00:28:58.000</a></span> | <span class="t">Now the reason I initialize these and don't fill them out directly is because we're going to iterate through all of the parameters of our function dynamically and set those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1747" target="_blank">00:29:07.660</a></span> | <span class="t">To do that, we also need to be able to map from Python types to the data types that Mistral understands and uses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1758" target="_blank">00:29:18.400</a></span> | <span class="t">And these are, as far as I'm aware, exactly the same as the OpenAI mappings as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1763" target="_blank">00:29:23.220</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1764" target="_blank">00:29:24.160</a></span> | <span class="t">So we get the signature here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1767" target="_blank">00:29:27.120</a></span> | <span class="t">Let me just show you what that looks like.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1769" target="_blank">00:29:29.320</a></span> | <span class="t">So we get the signature.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1771" target="_blank">00:29:31.040</a></span> | <span class="t">And then we're just going to go through those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1774" target="_blank">00:29:34.440</a></span> | <span class="t">And let me, again, just show you what those look like very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1777" target="_blank">00:29:37.360</a></span> | <span class="t">I'll show you the name and D type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1781" target="_blank">00:29:41.460</a></span> | <span class="t">So what do we have here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1783" target="_blank">00:29:43.080</a></span> | <span class="t">We have even, let me print D type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1786" target="_blank">00:29:46.960</a></span> | <span class="t">There we are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1788" target="_blank">00:29:48.000</a></span> | <span class="t">So we have the name, which is query, and then we have D type, which actually contains both the name and also what type it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1797" target="_blank">00:29:57.220</a></span> | <span class="t">The way that we would get the type only from that is we actually do D type annotation, which you can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1808" target="_blank">00:30:08.700</a></span> | <span class="t">Okay, cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1809" target="_blank">00:30:09.320</a></span> | <span class="t">So that is what we're processing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1810" target="_blank">00:30:10.660</a></span> | <span class="t">And we just do that quickly with this loop, which is pretty straightforward.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1815" target="_blank">00:30:15.880</a></span> | <span class="t">And that creates our function schema that we can, you know, we can apply this to any function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1821" target="_blank">00:30:21.380</a></span> | <span class="t">And then Mistral will be able to use this function schema and use that when it's defining the tools.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1827" target="_blank">00:30:27.280</a></span> | <span class="t">And then all we need to do is transform that into a MistralAI function object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1832" target="_blank">00:30:32.460</a></span> | <span class="t">We could have done this before, but this is, this is a general format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1837" target="_blank">00:30:37.580</a></span> | <span class="t">So I do like to show this, but you can view this function as being the same as this function schema that we defined up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1845" target="_blank">00:30:45.320</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1846" target="_blank">00:30:46.320</a></span> | <span class="t">So now what do we want to work through here?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1849" target="_blank">00:30:49.640</a></span> | <span class="t">We can actually remove this callable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1852" target="_blank">00:30:52.840</a></span> | <span class="t">We don't use that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1854" target="_blank">00:30:54.020</a></span> | <span class="t">And we can go ahead and just work through, okay, what are we, what are we doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1858" target="_blank">00:30:58.900</a></span> | <span class="t">So first we're adding in our tool signatures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1861" target="_blank">00:31:01.460</a></span> | <span class="t">So why do we add tool signatures?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1864" target="_blank">00:31:04.580</a></span> | <span class="t">Well, that is so our LLM knows what tools it has access to and also how to use them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1870" target="_blank">00:31:10.220</a></span> | <span class="t">So we pass those in for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1871" target="_blank">00:31:11.900</a></span> | <span class="t">You can see that we also remove from here our transcribed content.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1877" target="_blank">00:31:17.500</a></span> | <span class="t">We don't need any more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1878" target="_blank">00:31:18.580</a></span> | <span class="t">We're going to use that or we're going to provide that via our search tool and then make some modifications to our chat method as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1886" target="_blank">00:31:26.140</a></span> | <span class="t">So we're still using stream async, but now we've added the tool signatures to the tools parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1893" target="_blank">00:31:33.260</a></span> | <span class="t">And we're also, we don't need to do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1895" target="_blank">00:31:35.080</a></span> | <span class="t">This is the default value, but we set tool choice equal to auto.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1899" target="_blank">00:31:39.340</a></span> | <span class="t">So we, yeah, we could just comment that out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1903" target="_blank">00:31:43.300</a></span> | <span class="t">It doesn't matter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1903" target="_blank">00:31:43.880</a></span> | <span class="t">We'll do the same thing, but I like to be explicit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1906" target="_blank">00:31:46.040</a></span> | <span class="t">What you can do if you want to force tool calling is you can set any, and that will essentially tell Mr.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1912" target="_blank">00:31:52.680</a></span> | <span class="t">All you have to use a tool call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1914" target="_blank">00:31:54.740</a></span> | <span class="t">We're not doing that here because we don't want to force that all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1918" target="_blank">00:31:58.540</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1919" target="_blank">00:31:59.540</a></span> | <span class="t">Then this bit here is kind of the same, but also slightly different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1924" target="_blank">00:32:04.580</a></span> | <span class="t">So we have two conditions here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1928" target="_blank">00:32:08.260</a></span> | <span class="t">Whereas before we just had one, which was essentially this bit here, which is saying, okay, if there's some content, we're going to stream that content directly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1937" target="_blank">00:32:17.400</a></span> | <span class="t">But now we also are getting tool calls and tool calls are sent to a different part of our chunk objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1947" target="_blank">00:32:27.000</a></span> | <span class="t">As you can see here, we're going Delta content for the content that we stream, and we're doing Delta tool calls for tool calls.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1954" target="_blank">00:32:34.920</a></span> | <span class="t">So slightly different, you know, we're seeing those being returned in slightly different ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1959" target="_blank">00:32:39.840</a></span> | <span class="t">So let's run this and see what happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1963" target="_blank">00:32:43.400</a></span> | <span class="t">I am removing these for now because we're, we're not quite done with cleaning up our agent function yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1971" target="_blank">00:32:51.840</a></span> | <span class="t">So I'm just removing those for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1973" target="_blank">00:32:53.940</a></span> | <span class="t">And instead, I want to return that tool call so we can just have a deeper look at it in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1980" target="_blank">00:33:00.220</a></span> | <span class="t">So tool call, what do we have?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1983" target="_blank">00:33:03.420</a></span> | <span class="t">This is a tool call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1984" target="_blank">00:33:04.420</a></span> | <span class="t">It's a tool call object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1986" target="_blank">00:33:06.080</a></span> | <span class="t">Inside there, we have a function attribute, which contains the function call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1989" target="_blank">00:33:09.960</a></span> | <span class="t">Inside that function call is the actual instructions from the LM on what tool or function to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=1997" target="_blank">00:33:17.680</a></span> | <span class="t">So it's saying we need to use search tool and these are the arguments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2001" target="_blank">00:33:21.260</a></span> | <span class="t">So I want you to provide this string into the query parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2005" target="_blank">00:33:25.440</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2006" target="_blank">00:33:26.340</a></span> | <span class="t">We also importantly need to pull out the tool call ID later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2010" target="_blank">00:33:30.140</a></span> | <span class="t">So just be aware of that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2011" target="_blank">00:33:31.860</a></span> | <span class="t">So what we've done here is our LLM is now able to generate the instructions for what tool to use, but it can't use them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2019" target="_blank">00:33:39.460</a></span> | <span class="t">And that is because we haven't written the code that allows the execution of our tools.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2025" target="_blank">00:33:45.720</a></span> | <span class="t">So we need to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2028" target="_blank">00:33:48.220</a></span> | <span class="t">To do so, we're going to create a tool execution function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2031" target="_blank">00:33:51.580</a></span> | <span class="t">That tool execution function is going to take our tool call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2034" target="_blank">00:33:54.960</a></span> | <span class="t">So that is this object here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2036" target="_blank">00:33:56.920</a></span> | <span class="t">So you're going to take that tool call.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2038" target="_blank">00:33:58.640</a></span> | <span class="t">We're going to get the tool name out from it, which is search.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2042" target="_blank">00:34:02.820</a></span> | <span class="t">Then we're going to load the tool parameters, which are from here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2049" target="_blank">00:34:09.180</a></span> | <span class="t">So it's just a query and that string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2051" target="_blank">00:34:11.600</a></span> | <span class="t">And we're also going to get the tool call ID, which is exactly what we saw here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2057" target="_blank">00:34:17.840</a></span> | <span class="t">So pulling all of that information out, then what we're doing is we're using this tool map dictionary here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2064" target="_blank">00:34:24.200</a></span> | <span class="t">So what is tool map?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2065" target="_blank">00:34:25.840</a></span> | <span class="t">Let me run this and I will just show you very quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2069" target="_blank">00:34:29.000</a></span> | <span class="t">So tool map is just mapping us from a string, which is our tool name to the actual function that it refers to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2078" target="_blank">00:34:38.900</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2079" target="_blank">00:34:39.800</a></span> | <span class="t">That's all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2080" target="_blank">00:34:40.320</a></span> | <span class="t">That's what we've done here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2081" target="_blank">00:34:41.360</a></span> | <span class="t">So that means that we can access our tool map as a dictionary and actually use it to execute the chosen tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2089" target="_blank">00:34:49.440</a></span> | <span class="t">In this case, we just have one chosen tool, but you could imagine if we had multiple tools here, we could have like calculator, code execution, so on and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2102" target="_blank">00:35:02.440</a></span> | <span class="t">This execute tool function would work also for the multi-tool use scenario.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2109" target="_blank">00:35:09.460</a></span> | <span class="t">And from that, we're going to return tool message containing all of that useful information, including the output from us executing our function or tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2120" target="_blank">00:35:20.100</a></span> | <span class="t">Great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2121" target="_blank">00:35:21.960</a></span> | <span class="t">So we're going to take that tool call and we're going to just plug it into the execute tool and see what happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2130" target="_blank">00:35:30.260</a></span> | <span class="t">And you see that we get this, so we get this tool message and we get all this content, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2134" target="_blank">00:35:34.760</a></span> | <span class="t">So this content is exactly what we wrote before, where we are providing the most relevant chunks based on our user query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2143" target="_blank">00:35:43.220</a></span> | <span class="t">So that's what we're getting in the content there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2145" target="_blank">00:35:45.620</a></span> | <span class="t">We're also getting, okay, what tool was that?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2147" target="_blank">00:35:47.920</a></span> | <span class="t">And we're also getting the tool call ID.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2149" target="_blank">00:35:49.700</a></span> | <span class="t">Cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2150" target="_blank">00:35:50.500</a></span> | <span class="t">So we've done that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2151" target="_blank">00:35:51.420</a></span> | <span class="t">Now what I want to do is I want to extend the agent messages.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2156" target="_blank">00:35:56.220</a></span> | <span class="t">I'm doing this like from outside the agent class for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2159" target="_blank">00:35:59.760</a></span> | <span class="t">In a moment, we're going to implement this all within the agent class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2163" target="_blank">00:36:03.320</a></span> | <span class="t">But for now, outside, I'm going to go to agent, send those messages and add an assistant message, which is essentially the LLM saying, I want to use this tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2173" target="_blank">00:36:13.420</a></span> | <span class="t">And this is how we're going to use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2174" target="_blank">00:36:14.600</a></span> | <span class="t">Followed by the tool output here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2179" target="_blank">00:36:19.860</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2180" target="_blank">00:36:20.260</a></span> | <span class="t">And then if we look at our agent messages after this, we see that we have a system message.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2187" target="_blank">00:36:27.460</a></span> | <span class="t">That's the first one that we've predefined.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2190" target="_blank">00:36:30.160</a></span> | <span class="t">We have the user message, which is, can you summarize the meaning of symbolic in this article?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2194" target="_blank">00:36:34.660</a></span> | <span class="t">Then we have our assistant message, which is the LLM saying, hey, I want you to use this query for this tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2201" target="_blank">00:36:41.900</a></span> | <span class="t">And then we get the response from that tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2204" target="_blank">00:36:44.520</a></span> | <span class="t">With all that information, our LLM now has everything it needs in order to answer our original question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2212" target="_blank">00:36:52.060</a></span> | <span class="t">So let's take what we would usually have in that agent chat method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2217" target="_blank">00:36:57.580</a></span> | <span class="t">Let's extract that out and just run it against our new agent messages that we have, which include the assistant message and tool response.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2230" target="_blank">00:37:10.040</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2230" target="_blank">00:37:10.600</a></span> | <span class="t">So we can see that it's streaming everything here and saying, okay, symbolic AI refers to those written rules, intelligence, logical functions, so on and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2244" target="_blank">00:37:24.280</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2244" target="_blank">00:37:24.700</a></span> | <span class="t">So definitely stuff that is coming from that transcribed document.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2248" target="_blank">00:37:28.500</a></span> | <span class="t">Now, how do we take all that and refactor our agent class for the final time to include all that additional tool execution logic?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2259" target="_blank">00:37:39.640</a></span> | <span class="t">Well, we add one more attribute, which is max steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2264" target="_blank">00:37:44.400</a></span> | <span class="t">This is more of a precaution than anything else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2267" target="_blank">00:37:47.660</a></span> | <span class="t">So if our agent gets stuck in this loop of iterating again and again, and we're hitting the LLM APIs again and again, that can, of course, drive up costs pretty quickly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2280" target="_blank">00:38:00.200</a></span> | <span class="t">So to put a limit on that, we say, I don't want to go above three iterations of the agent saying, I want to use this tool and this tool and then this tool and then respond, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2292" target="_blank">00:38:12.480</a></span> | <span class="t">It will just have three opportunities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2294" target="_blank">00:38:14.020</a></span> | <span class="t">And that should be all it needs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2297" target="_blank">00:38:17.240</a></span> | <span class="t">So let's go through our new logic.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2300" target="_blank">00:38:20.380</a></span> | <span class="t">We have a while loop here, which says, okay, we're going to go through a maximum of those max steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2306" target="_blank">00:38:26.040</a></span> | <span class="t">We, this bit is pretty similar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2308" target="_blank">00:38:28.200</a></span> | <span class="t">So we generate our response asynchronously.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2311" target="_blank">00:38:31.260</a></span> | <span class="t">We say, okay, if the tool calls object is a list, we are going to print sort of clean this up a little bit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2317" target="_blank">00:38:37.460</a></span> | <span class="t">So it's a bit nicer to read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2318" target="_blank">00:38:38.480</a></span> | <span class="t">We're going to print.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2320" target="_blank">00:38:40.020</a></span> | <span class="t">The function name or the name of the tool that we are calling and the arguments being passed that, then we're going to execute that tool here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2329" target="_blank">00:38:49.500</a></span> | <span class="t">That will give us our tool message.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2332" target="_blank">00:38:52.040</a></span> | <span class="t">And then as we did before, we're just extending our chat history with the assistant message that told us what tools to use, how to use it and the tool response.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2342" target="_blank">00:39:02.700</a></span> | <span class="t">And that is if we have a tool call, otherwise the logic is exactly the same for if we have just normal tokens being streamed back to us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2350" target="_blank">00:39:10.200</a></span> | <span class="t">Finally, if we see that the length after going through this async for loop here, if we see that we have all tokens here, that means that our agent has responded to us directly using that content field.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2365" target="_blank">00:39:25.620</a></span> | <span class="t">And we should break out of the loop and which is exactly what we do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2370" target="_blank">00:39:30.440</a></span> | <span class="t">So let's run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2372" target="_blank">00:39:32.320</a></span> | <span class="t">And now let's try again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2374" target="_blank">00:39:34.240</a></span> | <span class="t">So one thing that we're doing here, just to try or test this out, is I'm actually asking two questions or I'm asking the two questions that should require the LM to search or use the search tool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2389" target="_blank">00:39:49.820</a></span> | <span class="t">And then I'm asking a final question, which is saying, okay, bring those both together and explain them to me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2396" target="_blank">00:39:56.560</a></span> | <span class="t">Now also throwing in a little bit of a spanner here by asking about DeepSeq, the transcribed document doesn't mention anything about DeepSeq.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2405" target="_blank">00:40:05.380</a></span> | <span class="t">So let's just see how our agent tackles this problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2409" target="_blank">00:40:09.900</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2411" target="_blank">00:40:11.240</a></span> | <span class="t">So we have our outputs here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2414" target="_blank">00:40:14.120</a></span> | <span class="t">And you'll see it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2416" target="_blank">00:40:16.460</a></span> | <span class="t">Sometimes this will work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2418" target="_blank">00:40:18.140</a></span> | <span class="t">Sometimes it will hallucinate, particularly with the DeepSeq part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2421" target="_blank">00:40:21.380</a></span> | <span class="t">And you see here that the search tool was used twice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2425" target="_blank">00:40:25.220</a></span> | <span class="t">Once to look for good old fashioned AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2429" target="_blank">00:40:29.380</a></span> | <span class="t">And another time search for DeepSeq.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2431" target="_blank">00:40:31.780</a></span> | <span class="t">Then it just explained, okay, yes, the document mentions good old fashioned AI.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2436" target="_blank">00:40:36.620</a></span> | <span class="t">It does not explicitly mention DeepSeq.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2438" target="_blank">00:40:38.680</a></span> | <span class="t">And then, yeah, it just continues answering our questions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2442" target="_blank">00:40:42.600</a></span> | <span class="t">So we can see that, yeah, that agentic flow does work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2447" target="_blank">00:40:47.460</a></span> | <span class="t">Now let's look at the usage for our query.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2450" target="_blank">00:40:50.800</a></span> | <span class="t">Now we can see that despite us having two tools being used, right, which is probably the worst case scenario for this sort of question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2460" target="_blank">00:41:00.180</a></span> | <span class="t">Despite that, which we can see with the usage info for these first two components here, it didn't necessarily add that many tokens, especially when compared to our original costs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2473" target="_blank">00:41:13.580</a></span> | <span class="t">So if we look at the original costs from here, so this is from the earlier execution that we performed, we spent this much across this is across three interactions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2485" target="_blank">00:41:25.580</a></span> | <span class="t">So we could say, okay, it was only this much for that one single interaction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2490" target="_blank">00:41:30.200</a></span> | <span class="t">Now, if we look at the cost for each one of these queries, that is pretty significantly lower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2500" target="_blank">00:41:40.260</a></span> | <span class="t">Looking at roughly half the price for that first query, despite asking a far more complicated question as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2507" target="_blank">00:41:47.440</a></span> | <span class="t">Now, I think this message, this note was from my previous testing, and I probably got lucky one time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2512" target="_blank">00:41:52.980</a></span> | <span class="t">But this gives you a good idea of just how cheap it can get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2516" target="_blank">00:41:56.840</a></span> | <span class="t">So I think the, in this scenario, the completion tokens were probably quite low for my final response.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2524" target="_blank">00:42:04.040</a></span> | <span class="t">But, yeah, that is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2524" target="_blank">00:42:04.980</a></span> | <span class="t">So we've been through, we've built a fully functional conversational agent with async and streaming using Mistral.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2535" target="_blank">00:42:15.360</a></span> | <span class="t">We've implemented video with that using the Aurelio SDK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2542" target="_blank">00:42:22.760</a></span> | <span class="t">And we've also seen how we can then optimize further using chunking to essentially just reduce our costs pretty significantly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2550" target="_blank">00:42:30.640</a></span> | <span class="t">And I believe probably if we optimize this further, we can definitely get that down even further.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2558" target="_blank">00:42:38.580</a></span> | <span class="t">So that's it for this video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2560" target="_blank">00:42:40.540</a></span> | <span class="t">I hope all this has been useful and interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2562" target="_blank">00:42:42.820</a></span> | <span class="t">For now, I'll leave it there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2564" target="_blank">00:42:44.460</a></span> | <span class="t">So thank you very much for watching, and I will see you again in the next one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2568" target="_blank">00:42:48.020</a></span> | <span class="t">Bye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=oaIBkEdITRQ&t=2568" target="_blank">00:42:48.620</a></span> | <span class="t">I'll see you again in the next one.</span></div></div></body></html>