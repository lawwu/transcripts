<html><head><title>NER Powered Semantic Search in Python</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>NER Powered Semantic Search in Python</h2><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q"><img src="https://i.ytimg.com/vi_webp/3K94GRjDG2Q/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=0">0:0</a> NER Powered Semantic Search<br><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=79">1:19</a> Dependencies and Hugging Face Datasets Prep<br><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=258">4:18</a> Creating NER Entities with Transformers<br><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=420">7:0</a> Creating Embeddings with Sentence Transformers<br><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=468">7:48</a> Using Pinecone Vector Database<br><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=693">11:33</a> Indexing the Full Medium Articles Dataset<br><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=909">15:9</a> Making Queries to Pinecone<br><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1021">17:1</a> Final Thoughts<br><br><div style="text-align: left;"><a href="./3K94GRjDG2Q.html">Whisper Transcript</a> | <a href="./transcript_3K94GRjDG2Q.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we're going to go through an example of using named entity recognition alongside a vector</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=8" target="_blank">00:00:08.080</a></span> | <span class="t">search and this is a really interesting way of just making sure our search is very much focused</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=16" target="_blank">00:00:16.240</a></span> | <span class="t">on exactly whatever it is we're looking for. So for example if we are going to search through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=22" target="_blank">00:00:22.240</a></span> | <span class="t">articles and we are searching for something to do with Tesla we can use this to restrict the search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=32" target="_blank">00:00:32.080</a></span> | <span class="t">whatever it is we're looking for maybe we're looking for some news about Tesla for self-driving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=38" target="_blank">00:00:38.640</a></span> | <span class="t">and using this we're going to restrict search scope for full self-driving to specifically articles or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=46" target="_blank">00:00:46.800</a></span> | <span class="t">parts of articles that contain the named entity Tesla. Now I think this is a really interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=53" target="_blank">00:00:53.840</a></span> | <span class="t">use case and can definitely help making search more specific. So let's jump in to the example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=61" target="_blank">00:01:01.680</a></span> | <span class="t">So we're working from this example page on Pinecone so pinecone.io/examples/nersearch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=69" target="_blank">00:01:09.280</a></span> | <span class="t">and Ashok thought of this and put all this together. Yeah I think it's a really cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=75" target="_blank">00:01:15.120</a></span> | <span class="t">example. So we'll work through the code. So to get started I'm going to come over to Colab here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=80" target="_blank">00:01:20.880</a></span> | <span class="t">and I'm just going to install a few dependencies. So sentence transformers, pinecone client and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=86" target="_blank">00:01:26.160</a></span> | <span class="t">datasets. Okay so that will just install everything. Okay great and then we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=94" target="_blank">00:01:34.000</a></span> | <span class="t">download the dataset that we're going to be using. So we're going to go from datasets,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=100" target="_blank">00:01:40.320</a></span> | <span class="t">import load dataset. We are going to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=104" target="_blank">00:01:44.640</a></span> | <span class="t">this dataset here. So it's a medium articles dataset. I'll go search right here. Okay and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=115" target="_blank">00:01:55.920</a></span> | <span class="t">it's just it contains a ton of articles straight from medium. So to use that we use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=124" target="_blank">00:02:04.000</a></span> | <span class="t">the name of the dataset from here and we're going to load it into a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=130" target="_blank">00:02:10.400</a></span> | <span class="t">hooking face data frame. So data files, medium articles, csv</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=139" target="_blank">00:02:19.360</a></span> | <span class="t">and we want to train split. Okay if we have a look at that or we have a look at the head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=148" target="_blank">00:02:28.800</a></span> | <span class="t">after converting it to a pandas data frame. So to pandas. I'll just take a moment to download.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=157" target="_blank">00:02:37.120</a></span> | <span class="t">Okay and then zoom out a little bit so you can see what we have here. So title, text, url and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=164" target="_blank">00:02:44.880</a></span> | <span class="t">a few other things in here. Okay so obviously the text is going to be the main part for us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=170" target="_blank">00:02:50.720</a></span> | <span class="t">and what we will also do is just drop a few of these. So drop any where we have just empty rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=179" target="_blank">00:02:59.040</a></span> | <span class="t">So that's this the drop na here and then we're going to sample at random 50,000 of these articles</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=186" target="_blank">00:03:06.400</a></span> | <span class="t">and we'll do that with a random state of 32. Essentially this is so you can get the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=192" target="_blank">00:03:12.880</a></span> | <span class="t">50,000 articles that I will get here as well. Okay cool now for each article I mean there's a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=201" target="_blank">00:03:21.040</a></span> | <span class="t">few things we could do in putting the embeddings together. So we're going to have to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=206" target="_blank">00:03:26.800</a></span> | <span class="t">embeddings for every single article here. What we could do is split the article into parts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=213" target="_blank">00:03:33.200</a></span> | <span class="t">because our embedding models can only handle so many words at one time. So we could split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=218" target="_blank">00:03:38.000</a></span> | <span class="t">the article into parts and embed all those different parts but in this case we can usually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=223" target="_blank">00:03:43.280</a></span> | <span class="t">get an idea of what the article will talk about based on the title and usually the introduction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=228" target="_blank">00:03:48.560</a></span> | <span class="t">So what we'll do is actually take the first 1,000 characters. So what you can see here there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=236" target="_blank">00:03:56.080</a></span> | <span class="t">and then we're just going to join the article title and the text and we'll keep all that within</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=242" target="_blank">00:04:02.240</a></span> | <span class="t">the title text feature. So we'll go df head again maybe we can just have a look at title text so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=249" target="_blank">00:04:09.680</a></span> | <span class="t">let's do that. Okay so we have this now the next thing to do or that we want to do is initialize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=262" target="_blank">00:04:22.480</a></span> | <span class="t">our NER model. So initialize NER model. Now how do we do that? So we're going to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=272" target="_blank">00:04:32.080</a></span> | <span class="t">a hugging face for this. So I'll just copy the code in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=275" target="_blank">00:04:35.680</a></span> | <span class="t">We have all of this so this is a NER pipeline with an NER model. So we have this DSLIM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=284" target="_blank">00:04:44.800</a></span> | <span class="t">database for NER named entity recognition. We have our tokenizer the model itself and then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=292" target="_blank">00:04:52.000</a></span> | <span class="t">just load all that into our pipeline. We need to select our device so if we have a GPU running</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=298" target="_blank">00:04:58.160</a></span> | <span class="t">we will want to use a GPU it will be much faster. So I'm going to import torch and what we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=305" target="_blank">00:05:05.840</a></span> | <span class="t">to do is say device equals CUDA if a CUDA device is available. So torch dot CUDA is available</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=319" target="_blank">00:05:19.040</a></span> | <span class="t">otherwise we're just going to use CPU. Now if you are on colab what you can do to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=328" target="_blank">00:05:28.160</a></span> | <span class="t">sure you are going to be using GPU is go to runtime change runtime type and here change this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=336" target="_blank">00:05:36.720</a></span> | <span class="t">to GPU. Okay so mine wasn't set to GPU so now I need to change it save and actually rerun everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=344" target="_blank">00:05:44.560</a></span> | <span class="t">So I'll go ahead and do that. Okay so that all just reran and what I'm going to do is just print</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=351" target="_blank">00:05:51.440</a></span> | <span class="t">the device here so that we can see that we are in fact using CUDA hopefully. Okay cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=358" target="_blank">00:05:58.880</a></span> | <span class="t">and then here we will run all this and that will just download and initialize the model as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=366" target="_blank">00:06:06.400</a></span> | <span class="t">so it may take a moment. Okay so after that let's try it on a quick example. So we have London,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=374" target="_blank">00:06:14.320</a></span> | <span class="t">Qatar, England and the United Kingdom. So we would expect a few named entities to be within this so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=380" target="_blank">00:06:20.960</a></span> | <span class="t">let's run that and see what we return. Okay with this maybe I need to here maybe we write torch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=390" target="_blank">00:06:30.320</a></span> | <span class="t">device this. Okay cool so here we have a few things so we have a location this is the entity type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=404" target="_blank">00:06:44.880</a></span> | <span class="t">London. Okay cool that is definitely true location again England and location again United Kingdom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=412" target="_blank">00:06:52.880</a></span> | <span class="t">Okay all great so that's definitely working so let's move on to creating our embeddings.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=420" target="_blank">00:07:00.080</a></span> | <span class="t">So to create those embeddings we will need a retrieve model. So to initialize that we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=426" target="_blank">00:07:06.640</a></span> | <span class="t">going to be using the sentence transformers library that will look something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=432" target="_blank">00:07:12.160</a></span> | <span class="t">So from sentence transformers import sentence transformer and then we initialize this model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=438" target="_blank">00:07:18.400</a></span> | <span class="t">here. So this is just a it's a pretty good sentence transformer model that's been trained on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=443" target="_blank">00:07:23.200</a></span> | <span class="t">a lot of examples so the performance is generally really good. Okay now we can see the model format</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=451" target="_blank">00:07:31.680</a></span> | <span class="t">here so we have match sequence 128 tokens word embedding dimension here 768 so that's how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=460" target="_blank">00:07:40.560</a></span> | <span class="t">big the sentence embeddings will be sentence vectors and we can use this model to create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=468" target="_blank">00:07:48.080</a></span> | <span class="t">our embeddings but we need something to store our embeddings and for that we're going to be using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=471" target="_blank">00:07:51.760</a></span> | <span class="t">Pinecone so we will initialize that so for that we will need to do this. So import Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=480" target="_blank">00:08:00.160</a></span> | <span class="t">initialize our connection to Pinecone and for that we need an API key which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=485" target="_blank">00:08:05.280</a></span> | <span class="t">free and we can get it from here so app.pinecone.io</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=493" target="_blank">00:08:13.920</a></span> | <span class="t">we need to log in here now you probably just have one project in here which would probably be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=499" target="_blank">00:08:19.600</a></span> | <span class="t">your name default project so go into that you go to API keys and you just press copy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=506" target="_blank">00:08:26.960</a></span> | <span class="t">on your API key here and then you just paste it into here now I put my API key into a variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=514" target="_blank">00:08:34.400</a></span> | <span class="t">called API key and with that we can initialize that connection now we'll create a new index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=526" target="_blank">00:08:46.160</a></span> | <span class="t">called NER search and we do that with Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=531" target="_blank">00:08:51.360</a></span> | <span class="t">create index and this index there's a few things that we need here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=541" target="_blank">00:09:01.680</a></span> | <span class="t">create index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=542" target="_blank">00:09:02.400</a></span> | <span class="t">we need the index name the dimensionality so dimension now this is going to be equal to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=553" target="_blank">00:09:13.200</a></span> | <span class="t">retriever model that we just created that includes a embedding dimension and we actually have that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=560" target="_blank">00:09:20.240</a></span> | <span class="t">up here it's 768 but we're going to we're not going to hard code it we're just going to get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=567" target="_blank">00:09:27.280</a></span> | <span class="t">from here so get sentence embedding dimension let me see yeah this here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=574" target="_blank">00:09:34.000</a></span> | <span class="t">okay so if we just have a look at what that will give us should be 768 yeah and then we also want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=584" target="_blank">00:09:44.240</a></span> | <span class="t">to use the cosine similarity metric and then that will go ahead and create our index after it's been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=591" target="_blank">00:09:51.280</a></span> | <span class="t">created we'll connect to it so we do Pinecone index and we just use the index name again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=597" target="_blank">00:09:57.440</a></span> | <span class="t">and then we can describe the index just to see what is in there which should be nothing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=604" target="_blank">00:10:04.960</a></span> | <span class="t">okay cool so we have dimensionality you can see that the index is empty as we haven't added</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=617" target="_blank">00:10:17.120</a></span> | <span class="t">anything into it yet so the next thing is actually preparing all of our data to be added to Pinecone</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=624" target="_blank">00:10:24.480</a></span> | <span class="t">and allowing us to do this search so what we're going to do first is initialize this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=629" target="_blank">00:10:29.920</a></span> | <span class="t">extract named entities function which is going to extract for a batch of text it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=636" target="_blank">00:10:36.560</a></span> | <span class="t">extract named entities for each one those text records so let's initialize that and then what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=644" target="_blank">00:10:44.640</a></span> | <span class="t">we're going to do is just have a look at how it will work so extract named entities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=650" target="_blank">00:10:50.320</a></span> | <span class="t">and in there we're just going to pass the data that we have is called df title text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=660" target="_blank">00:11:00.480</a></span> | <span class="t">what we'll do is maybe turn this into a list yeah let's do that so df title text i want to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=672" target="_blank">00:11:12.080</a></span> | <span class="t">for the first let's say the first three items okay and we'll turn into a list isn't already a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=678" target="_blank">00:11:18.800</a></span> | <span class="t">there okay cool so the first one we get data christmas anonymous america light switch so on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=685" target="_blank">00:11:25.440</a></span> | <span class="t">and so on and yeah you can you can see we're getting those entities that are being extracted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=690" target="_blank">00:11:30.240</a></span> | <span class="t">from there so that is working and what we can do now is actually loop through the full data set or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=697" target="_blank">00:11:37.200</a></span> | <span class="t">the full 50 000 that we have extracted and we're just going to we're going to do this so let me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=705" target="_blank">00:11:45.120</a></span> | <span class="t">walk walk you through all this so we're going to be doing everything in batches of 64 that's to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=710" target="_blank">00:11:50.480</a></span> | <span class="t">avoid overwhelming our gpu which is going to be encoding everything in batches of 64 and also when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=716" target="_blank">00:11:56.880</a></span> | <span class="t">we're sending these requests to pinecone we can't send too many or too large requests at any one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=722" target="_blank">00:12:02.880</a></span> | <span class="t">time so with 64 we're pretty safe here we're going to find the end of the batch so we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=729" target="_blank">00:12:09.760</a></span> | <span class="t">in batches 64 from i to i end obviously when you get to the ended data set the batch size will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=735" target="_blank">00:12:15.760</a></span> | <span class="t">probably be smaller because we probably don't have the data set fitting into perfect 64 batch sizes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=742" target="_blank">00:12:22.400</a></span> | <span class="t">okay and then we extract the batch generate those embeddings extract the name entities using our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=749" target="_blank">00:12:29.520</a></span> | <span class="t">function if there are any duplicates so we might have the same name entity a few times and in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=755" target="_blank">00:12:35.680</a></span> | <span class="t">single sentence of course or single paragraph in that case we don't need to do that because we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=761" target="_blank">00:12:41.920</a></span> | <span class="t">just going to be filtering so we actually only need one instance of the named entity so to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=768" target="_blank">00:12:48.960</a></span> | <span class="t">that we just deduplicate our entities here and convert it back into a list and then what we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=776" target="_blank">00:12:56.400</a></span> | <span class="t">doing here is we're dropping the title text from our batch because we actually don't need that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=783" target="_blank">00:13:03.440</a></span> | <span class="t">right here because we've just extracted our named entities and that's all we care about at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=788" target="_blank">00:13:08.080</a></span> | <span class="t">moment and then from there we create our metadata so this is going to be some metadata that we saw</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=794" target="_blank">00:13:14.720</a></span> | <span class="t">in the dictionary like format in pinecone create our unique ids which is count and we upset</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=802" target="_blank">00:13:22.320</a></span> | <span class="t">everything or add everything to upset list and upset so we can run that it will possibly take</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=809" target="_blank">00:13:29.120</a></span> | <span class="t">a little while to run may have to just deal with this quickly so entities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=816" target="_blank">00:13:36.240</a></span> | <span class="t">can contain a list so probably the best way to deal with that is within the function here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=826" target="_blank">00:13:46.000</a></span> | <span class="t">let's come up here and what we'll do is just convert into a or remove the duplicates here so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=832" target="_blank">00:13:52.720</a></span> | <span class="t">any equals list set any okay and then we don't have to do it here so I can remove that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=841" target="_blank">00:14:01.680</a></span> | <span class="t">and we'll just call this suppose batch named entities</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=852" target="_blank">00:14:12.640</a></span> | <span class="t">okay cool so let's try and run that again great so that looks like it will work it will take a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=858" target="_blank">00:14:18.560</a></span> | <span class="t">little bit of time so I will leave that to run and when it's complete we'll go through the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=866" target="_blank">00:14:26.080</a></span> | <span class="t">making queries and see how that works okay so that is done I've just run it on a another fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=875" target="_blank">00:14:35.360</a></span> | <span class="t">computer so we should be able to describe the index stats here and we should see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=879" target="_blank">00:14:39.920</a></span> | <span class="t">50,000 items the one thing here is I need to just refresh the connection so let me do that quickly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=890" target="_blank">00:14:50.080</a></span> | <span class="t">so we'll come here I am going to run this again and I'm also going to run this without the create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=896" target="_blank">00:14:56.320</a></span> | <span class="t">index come down here run this here we go so we have 50,000 vectors in there now and what we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=906" target="_blank">00:15:06.960</a></span> | <span class="t">to do is use this here so this is going to search through pine cone so we're going to have our query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=915" target="_blank">00:15:15.200</a></span> | <span class="t">here we're going to extract the named entities from our query embed our query and what we do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=922" target="_blank">00:15:22.320</a></span> | <span class="t">query with our embedded query with our query vector which is this xq we're going to return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=929" target="_blank">00:15:29.120</a></span> | <span class="t">the top 10 most similar matches we're going to include metadata for those matches and importantly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=936" target="_blank">00:15:36.720</a></span> | <span class="t">for the named entity part of this or named entity filtering what we do is we filter for named</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=944" target="_blank">00:15:44.560</a></span> | <span class="t">entities that are within the list that we have here so let's run that this will just return all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=956" target="_blank">00:15:56.560</a></span> | <span class="t">the metadata that we have there so the the titles that we that we might want from that and what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=963" target="_blank">00:16:03.360</a></span> | <span class="t">do is simply make a few queries so what are the best places to visit in greece will be our first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=969" target="_blank">00:16:09.680</a></span> | <span class="t">growth and we get these titles here so budget-friendly holidays was the best summer destination</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=978" target="_blank">00:16:18.720</a></span> | <span class="t">greece exploring greece santorini island yeah all i think pretty seem like pretty relevant articles</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=985" target="_blank">00:16:25.600</a></span> | <span class="t">to me ask a few more questions what the best places to visit in london run this and then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=996" target="_blank">00:16:36.320</a></span> | <span class="t">get a few more so oh i think pretty relevant again and then let's try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1003" target="_blank">00:16:43.360</a></span> | <span class="t">one slightly different query why spacex wants to build a city on mars</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1007" target="_blank">00:16:47.840</a></span> | <span class="t">and here we go so for sure i think all these are definitely very relevant articles to be returned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1021" target="_blank">00:17:01.840</a></span> | <span class="t">okay so that's it for this example covering vector search with this sort of named entity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1028" target="_blank">00:17:08.800</a></span> | <span class="t">filtering component just to try and improve our results and make sure we are searching within a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1035" target="_blank">00:17:15.840</a></span> | <span class="t">space that contains whatever it is we are looking for or just making our search scope more specific</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1044" target="_blank">00:17:24.240</a></span> | <span class="t">so i hope this has been interesting and useful thank you very much for watching and i will see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=3K94GRjDG2Q&t=1050" target="_blank">00:17:30.880</a></span> | <span class="t">you again in the next one bye</span></div></div></body></html>