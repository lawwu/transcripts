<html><head><title>fastai v2 walk-thru #8</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>fastai v2 walk-thru #8</h2><a href="https://www.youtube.com/watch?v=yL1un5SH63k"><img src="https://i.ytimg.com/vi/yL1un5SH63k/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1961">32:41</a> split the training set and the validation<br><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2441">40:41</a> create a categorical column in pandas<br><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2791">46:31</a> set up your processes<br><br><div style="text-align: left;"><a href="./yL1un5SH63k.html">Whisper Transcript</a> | <a href="./transcript_yL1un5SH63k.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Okay. There we go. Hi, everybody. Can you see me? Can you hear me? Okay. So, I'm going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=29" target="_blank">00:00:29.920</a></span> | <span class="t">turn it off. Okay. Great. Hi. Hope you're ready for Tabular. Oh, and we have Andrew</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=51" target="_blank">00:00:51.320</a></span> | <span class="t">Shaw here today as well. Andrew just joined WAMRI, Medical Research Institute as Research</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=59" target="_blank">00:00:59.280</a></span> | <span class="t">Director, and he is the person you may be familiar with from Music Auto, but if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=69" target="_blank">00:01:09.620</a></span> | <span class="t">haven't checked it out, you should, because it's super, super cool. Now he's moving from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=75" target="_blank">00:01:15.520</a></span> | <span class="t">the Jackson 5 to Medical AI Research. All right. So, Tabular is a cool notebook, I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=99" target="_blank">00:01:39.960</a></span> | <span class="t">It's a bit of fun. And the basic idea, well, let's start at the end to see how it's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=111" target="_blank">00:01:51.160</a></span> | <span class="t">to look. So, we're going to look at the adult dataset, which is the one that we use in most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=117" target="_blank">00:01:57.840</a></span> | <span class="t">of the docs in version one, and we used in some of the lessons, I think. It's a pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=122" target="_blank">00:02:02.840</a></span> | <span class="t">simple, small dataset. It's got 32,000 rows in it, and 15 columns in it. And we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=152" target="_blank">00:02:32.320</a></span> | <span class="t">32,000. And here's what it looks like when we grab it straight from Dandas. So, basically,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=165" target="_blank">00:02:45.280</a></span> | <span class="t">in order to create models from this, we need to take the categorical variables and convert</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=174" target="_blank">00:02:54.720</a></span> | <span class="t">them into ints, possibly with missing category, the continuous variables, if there's anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=186" target="_blank">00:03:06.800</a></span> | <span class="t">with a missing value in a continuous variable, we need to replace it with something, so normally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=193" target="_blank">00:03:13.960</a></span> | <span class="t">we replace it with something like the median, and then normally we add an additional column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=199" target="_blank">00:03:19.720</a></span> | <span class="t">for each thing that has a missing value, for each column that has a missing value, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=203" target="_blank">00:03:23.720</a></span> | <span class="t">that column will be binary, which is, is it missing or not. So, we need to know which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=209" target="_blank">00:03:29.320</a></span> | <span class="t">things are going to be the categorical variables, which column names are going to be the continuous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=215" target="_blank">00:03:35.000</a></span> | <span class="t">variables, so we know how to process each one, we're going to need to know how to split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=222" target="_blank">00:03:42.920</a></span> | <span class="t">our validation and training set, and we need to know what's our dependent variable. So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=230" target="_blank">00:03:50.560</a></span> | <span class="t">we've created a class called Tabular. Basically, Tabular contains a data frame, and it also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=244" target="_blank">00:04:04.240</a></span> | <span class="t">contains a list of which things are categorical, which things are continuous, and what's your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=250" target="_blank">00:04:10.800</a></span> | <span class="t">dependent variable, and also some processes, which we'll look at in a moment, where they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=258" target="_blank">00:04:18.320</a></span> | <span class="t">do things like turning strings into ints for categories, and filling the missing data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=264" target="_blank">00:04:24.160</a></span> | <span class="t">and doing normalization of continuous. So that creates a Tabular object, and from a Tabular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=272" target="_blank">00:04:32.640</a></span> | <span class="t">object you can get a data source if you pass in a list of split indexes. So, feel free to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=279" target="_blank">00:04:39.560</a></span> | <span class="t">ask also Andrew if you have any questions as we go. Oh, what's that David? Do you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=287" target="_blank">00:04:47.840</a></span> | <span class="t">a jagged competition? What's a jagged competition? Tell us more. Oh, Kaggle, which one? So now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=299" target="_blank">00:04:59.440</a></span> | <span class="t">that we've got a data source, we created data loader from it, and so we have a little wrapper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=305" target="_blank">00:05:05.760</a></span> | <span class="t">for that to make it easier for Tabular. And so then we can go show batch. Oh, it's broken</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=313" target="_blank">00:05:13.760</a></span> | <span class="t">somehow. Nice one, Jeremy. Damn it. This was all working a moment ago. And then Andrew and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=324" target="_blank">00:05:24.800</a></span> | <span class="t">I were just changing things at the last minute, so what did we break? Okay, I am going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=340" target="_blank">00:05:40.800</a></span> | <span class="t">ignore that. Alright, so we just broke something apparently before we started recording, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=350" target="_blank">00:05:50.640</a></span> | <span class="t">anyway show batch would then show the data. And then you can take a test set that's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=358" target="_blank">00:05:58.320</a></span> | <span class="t">processed. And basically what you want to be able to do with a test set is say I have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=363" target="_blank">00:06:03.200</a></span> | <span class="t">the same categorical names and continuous names and the same dependent variable and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=366" target="_blank">00:06:06.800</a></span> | <span class="t">the same processes, and you should then be able to apply the same pre-processing to the test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=373" target="_blank">00:06:13.120</a></span> | <span class="t">And so to.new creates a new Tabular object with all that metadata, and then process will do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=380" target="_blank">00:06:20.000</a></span> | <span class="t">same processing. And so then you can see here, here's the normalized age, normalized education,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=387" target="_blank">00:06:27.680</a></span> | <span class="t">all these things have been turned into ints. Oh, and so forth. Excuse me. So that's basically what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=397" target="_blank">00:06:37.120</a></span> | <span class="t">this looks like. You'll see I've used a subclass of Tabular called Tabular Pandas. I don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=406" target="_blank">00:06:46.080</a></span> | <span class="t">if it's always going to stay this way or not, but currently, well we want to be able to support</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=411" target="_blank">00:06:51.040</a></span> | <span class="t">multiple different backends. So currently we have a Pandas backend for Tabular and we're also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=417" target="_blank">00:06:57.520</a></span> | <span class="t">working on a RAPIDS backend. For those of you that haven't seen it, RAPIDS is a really great project</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=423" target="_blank">00:07:03.520</a></span> | <span class="t">coming out of NVIDIA, which allows you to do, so they've got some encoder, QDF, which basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=429" target="_blank">00:07:09.440</a></span> | <span class="t">gives you GPU-accelerated data frames. So that's why we have different subclasses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=440" target="_blank">00:07:20.320</a></span> | <span class="t">I don't know if this will always be a subclass of Tabular. We may end up instead of having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=443" target="_blank">00:07:23.680</a></span> | <span class="t">subclasses of data source, but for now we've got subclasses of Tabular. So that's where we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=449" target="_blank">00:07:29.360</a></span> | <span class="t">heading. All right. Do you have any advice to speed up inference on a tabular learn of predictions?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=460" target="_blank">00:07:40.240</a></span> | <span class="t">Well, hopefully there'll be fast, particularly if you use RAPIDS. I mean, yeah,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=465" target="_blank">00:07:45.600</a></span> | <span class="t">basically, if you use RAPIDS. In fact, if you look at RAPIDS, NVIDIA, fast.ai, hopefully,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=474" target="_blank">00:07:54.880</a></span> | <span class="t">yeah, here we go. So even, a lot of you will remember from the forums, he's at NVIDIA now,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=484" target="_blank">00:08:04.480</a></span> | <span class="t">which is pretty awesome, and he's working on the RAPIDS team and he recently posted how he got a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=490" target="_blank">00:08:10.960</a></span> | <span class="t">15x acceleration and got in the top 20 of a competition, a very popular competition on Kaggle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=498" target="_blank">00:08:18.800</a></span> | <span class="t">by combining RAPIDS by Torch and fast.ai. So that would be a good place to start, but hopefully by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=504" target="_blank">00:08:24.480</a></span> | <span class="t">the time fast.ai version 2 comes out this would be super simple, and we're working with Even on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=510" target="_blank">00:08:30.000</a></span> | <span class="t">making that happen. So thank you, Even and NVIDIA for that help.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=517" target="_blank">00:08:37.360</a></span> | <span class="t">All right. So let's start at tabular. So basically, the idea of tabular is that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=530" target="_blank">00:08:50.560</a></span> | <span class="t">have a URL. Oh, yes. I just googled for NVIDIA AI RAPIDS, fast.ai. And here it is, accelerating,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=549" target="_blank">00:09:09.200</a></span> | <span class="t">keep learning recommendation systems. I'm sure we can, somebody will hopefully add it to the notes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=552" target="_blank">00:09:12.800</a></span> | <span class="t">as well. Okay. So the basic idea with tabular was I kind of wanted to, I kind of like to have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=568" target="_blank">00:09:28.160</a></span> | <span class="t">class which kind of has all the information it needs to do what we want it to do. So in this case,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=576" target="_blank">00:09:36.400</a></span> | <span class="t">you know, a data frame doesn't have enough information to actually build models because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=585" target="_blank">00:09:45.520</a></span> | <span class="t">until you know what the categorical variables are, the continuous variables are and what pre-processing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=590" target="_blank">00:09:50.480</a></span> | <span class="t">to do and what the dependent variable is, you know, you can't really do much. So that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=595" target="_blank">00:09:55.920</a></span> | <span class="t">basic kind of idea of this design was to have something with that information. So categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=603" target="_blank">00:10:03.600</a></span> | <span class="t">names, continuous names, line names, normally it's just one dependent variable, so one line name,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=610" target="_blank">00:10:10.560</a></span> | <span class="t">but you could have more and processes. So those are basically the four things that we want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=616" target="_blank">00:10:16.960</a></span> | <span class="t">put in our tabular. So -- oh, that was crazy. There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=644" target="_blank">00:10:44.560</a></span> | <span class="t">All right. So that's why we're passing in those four things. And then the other thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=657" target="_blank">00:10:57.120</a></span> | <span class="t">we need to know about why is why categorical or continuous, so you can just pass that into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=663" target="_blank">00:11:03.440</a></span> | <span class="t">some boolean. So Aman wants to know why might we need more than one y-name. So a few examples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=671" target="_blank">00:11:11.040</a></span> | <span class="t">you could be doing a regression problem where you're trying to predict the x and y coordinates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=675" target="_blank">00:11:15.920</a></span> | <span class="t">of the destination of a taxi ride, or perhaps you're just doing a multi-label classification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=682" target="_blank">00:11:22.320</a></span> | <span class="t">where you can have multiple things being true, would be a couple examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=686" target="_blank">00:11:26.560</a></span> | <span class="t">And maybe it's already one-hot encoded or something in that case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=689" target="_blank">00:11:29.840</a></span> | <span class="t">Okay. So that's the theory behind the design of tabular. So when we initialize it, we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=700" target="_blank">00:11:40.160</a></span> | <span class="t">pass in that stuff. The processes that we pass in are just going to be transforms,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=706" target="_blank">00:11:46.320</a></span> | <span class="t">so we can dump in a pipeline. And so this stuff kind of you'll see that we just keep reusing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=711" target="_blank">00:11:51.280</a></span> | <span class="t">same foundational concepts throughout fast.ai version 2, which is a good sign that they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=715" target="_blank">00:11:55.760</a></span> | <span class="t">strong foundations. So the processes are, you know, things that we want to run a bunch of them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=723" target="_blank">00:12:03.360</a></span> | <span class="t">we want to depend on what type something is, whether we run it or not, you know, stuff like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=727" target="_blank">00:12:07.520</a></span> | <span class="t">that. So it's got all that kind of behavior we want in the pipeline. Unlike TifemDS, TifemDL,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=736" target="_blank">00:12:16.560</a></span> | <span class="t">TifemList, all of those things apply transformations lazily. On tabular data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=743" target="_blank">00:12:23.680</a></span> | <span class="t">we don't generally do that. There's a number of reasons why. The first is that unlike kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=749" target="_blank">00:12:29.600</a></span> | <span class="t">opening an image or something, it doesn't take a long time to grab a row of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=756" target="_blank">00:12:36.640</a></span> | <span class="t">So like it's fine to read the whole lot of rows normally, except in some cases of really,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=762" target="_blank">00:12:42.720</a></span> | <span class="t">really big datasets. The second reason is that most kind of tabular stuff is designed to work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=769" target="_blank">00:12:49.520</a></span> | <span class="t">quickly on lots of rows at a time. So it's going to be much, much faster if you do it ahead of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=773" target="_blank">00:12:53.920</a></span> | <span class="t">The third is that most preprocessing is going to be not data augmentation kind of stuff, but more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=780" target="_blank">00:13:00.640</a></span> | <span class="t">just once off cleaning up labels and things like that. So for all these kinds of reasons,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=786" target="_blank">00:13:06.800</a></span> | <span class="t">our processing in tabular is generally done ahead of time rather than lazily,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=791" target="_blank">00:13:11.120</a></span> | <span class="t">but it's still a pipeline of transforms. Okay, so then we're going to store something called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=797" target="_blank">00:13:17.680</a></span> | <span class="t">catY, which will be our Y variable if it's a categorical, otherwise none, and vice versa,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=804" target="_blank">00:13:24.160</a></span> | <span class="t">the convoy. So that's our initializer, and let's take a look at it in use. So basically we create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=813" target="_blank">00:13:33.440</a></span> | <span class="t">a data frame containing two columns, and from that we can create a tabular object passing in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=821" target="_blank">00:13:41.120</a></span> | <span class="t">that data frame and saying our cat names, con names, y names, whatever. So in this case we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=826" target="_blank">00:13:46.400</a></span> | <span class="t">just have cat names. One thing that's always a good idea is to make sure that things pickle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=831" target="_blank">00:13:51.760</a></span> | <span class="t">okay because for inference and stuff all this metadata has to be pickleable. So dumping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=836" target="_blank">00:13:56.800</a></span> | <span class="t">something to a string and then loading that string up again is always a good idea to make sure it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=840" target="_blank">00:14:00.720</a></span> | <span class="t">works and make sure it's the same as what you started with. So we're inheriting from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=847" target="_blank">00:14:07.280</a></span> | <span class="t">co-base, and co-base is just a small little thing in core which defines the basic things you would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=856" target="_blank">00:14:16.480</a></span> | <span class="t">expect to have in a collection, and it implements them by composition. So you pass in some list or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=864" target="_blank">00:14:24.880</a></span> | <span class="t">whatever, and so the length of your co-base will be the length of that list. So like you can often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=871" target="_blank">00:14:31.040</a></span> | <span class="t">just inherit from something to do this, but composition often can give you some more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=877" target="_blank">00:14:37.520</a></span> | <span class="t">flexibility. So this basically gives you the very quick, you know, getItem is defined by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=883" target="_blank">00:14:43.520</a></span> | <span class="t">calling the self.items getItem, and length is defined by calling the self.items length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=887" target="_blank">00:14:47.600</a></span> | <span class="t">and so forth. So by inheriting from co-base we can then in the init simply say super.initdf,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=897" target="_blank">00:14:57.840</a></span> | <span class="t">and so that means we're going to now going to have something called self.items,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=901" target="_blank">00:15:01.760</a></span> | <span class="t">which is going to be that data frame. And so here we check that, you know, the pickled version of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=910" target="_blank">00:15:10.080</a></span> | <span class="t">items is the same as the TabularObjects version of items. Okay, so let me just press this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=939" target="_blank">00:15:39.600</a></span> | <span class="t">Okay, so the next thing to notice is that there are various useful little attributes like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=948" target="_blank">00:15:48.320</a></span> | <span class="t">all columns, all cats for all categorical columns, all const for all continuous columns,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=958" target="_blank">00:15:58.560</a></span> | <span class="t">and then there's also the same with names at the end, all count names, all cat names,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=964" target="_blank">00:16:04.080</a></span> | <span class="t">all call names. So you can say all count names is just the continuous names plus the continuous y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=970" target="_blank">00:16:10.880</a></span> | <span class="t">if there is one. This would not work except for the fact that we use the capital L plus, so if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=979" target="_blank">00:16:19.360</a></span> | <span class="t">add a none to a capital L plus it doesn't change it, which is exactly what we want most of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=984" target="_blank">00:16:24.800</a></span> | <span class="t">time. So some of the things in capital L are a bit more convenient than this. I think that's right,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=992" target="_blank">00:16:32.000</a></span> | <span class="t">anyway. Maybe I should double check before I say things that might not be true. Yeah, so you can't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=999" target="_blank">00:16:39.440</a></span> | <span class="t">do that, or else you can do that and get exactly the expected behavior. And Ls, by the way, always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1008" target="_blank">00:16:48.960</a></span> | <span class="t">show you how big they are before they print out their contents. You'll see that all calls does not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1023" target="_blank">00:17:03.040</a></span> | <span class="t">actually appear anywhere here, and that's because we just created a little thing called add property</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1028" target="_blank">00:17:08.080</a></span> | <span class="t">that just adds cats or cats, consts or consts or calls. And so for each one it creates a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1035" target="_blank">00:17:15.200</a></span> | <span class="t">read version of the property, which is to just grab whatever cat names or cat names,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1040" target="_blank">00:17:20.720</a></span> | <span class="t">cont names, etc., which are all defined in here, and then indexes into our data frame with that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1048" target="_blank">00:17:28.160</a></span> | <span class="t">list of columns. And then it creates a a setter, which simply sets that list of names to whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1060" target="_blank">00:17:40.560</a></span> | <span class="t">value you provide. So that's just a quick way to create the setter and get a version of all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1065" target="_blank">00:17:45.920</a></span> | <span class="t">those. So that's where all calls come from. So in this case, because the TabularObject</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1073" target="_blank">00:17:53.600</a></span> | <span class="t">only has this one column mentioned as being part of what we're modeling,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1079" target="_blank">00:17:59.360</a></span> | <span class="t">even though the data frame had an a and a b, TabularObject.all_holes only has the a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1088" target="_blank">00:18:08.160</a></span> | <span class="t">con in it, because by all calls it means all of the columns we're using in modeling, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1093" target="_blank">00:18:13.440</a></span> | <span class="t">continuous and categorical and dependent variables. And so one of the nice things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1100" target="_blank">00:18:20.080</a></span> | <span class="t">is that, you know, because everything is super consistent in the API, we can now just say .show,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1108" target="_blank">00:18:28.240</a></span> | <span class="t">just like everything else, we can say .show, and in this case we see the all calls data frame.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1116" target="_blank">00:18:36.080</a></span> | <span class="t">Okay, so then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1121" target="_blank">00:18:41.600</a></span> | <span class="t">processes, TabularProcesses, are just transforms. Now specifically they're in-place transforms,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1133" target="_blank">00:18:53.360</a></span> | <span class="t">but don't let that bother you because in-place transform is simply a transform where when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1140" target="_blank">00:19:00.800</a></span> | <span class="t">we call it and then we return the original thing. So like all the transforms we've seen so far</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1147" target="_blank">00:19:07.600</a></span> | <span class="t">return something different to what you passed in, like that's the whole point of them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1152" target="_blank">00:19:12.160</a></span> | <span class="t">but processes, the whole point of them is that they change the actual stored data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1158" target="_blank">00:19:18.800</a></span> | <span class="t">so that's why they just return whatever you started with. So that's all in-place transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1167" target="_blank">00:19:27.040</a></span> | <span class="t">means. And so a TabularProcessor is just a transform that returns itself when you call it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1174" target="_blank">00:19:34.240</a></span> | <span class="t">and when you set it up, it just does the normal set up, but it also calls dundercall, in other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1186" target="_blank">00:19:46.000</a></span> | <span class="t">words, self-roundbackers. Why does it do that? Well, let's take a look at an example,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1192" target="_blank">00:19:52.400</a></span> | <span class="t">Categorify. So Categorify is a TabularProc where the setup is going to create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1201" target="_blank">00:20:01.760</a></span> | <span class="t">category map, so this is just a mapping from int-numbered bits of vocab to string vocab,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1209" target="_blank">00:20:09.760</a></span> | <span class="t">that's all a category map is. And so it's going to go through all of the categorical columns,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1221" target="_blank">00:20:21.840</a></span> | <span class="t">and it's going to go .iloc into the data frame for each of those columns,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1226" target="_blank">00:20:26.080</a></span> | <span class="t">and it's going to create a category map for that column. So this is just creating, so self.classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1234" target="_blank">00:20:34.480</a></span> | <span class="t">then is going to be a dictionary that goes from the column names to the vocab for that categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1241" target="_blank">00:20:41.600</a></span> | <span class="t">column. So that's what setup does, right? So setup kind of sets up the metadata, it's the vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1249" target="_blank">00:20:49.440</a></span> | <span class="t">Encodes, on the other hand, is the thing that actually takes a categorical column and converts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1257" target="_blank">00:20:57.120</a></span> | <span class="t">it into ints using the vocab that we created earlier. And so we need them to be two separate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1264" target="_blank">00:21:04.480</a></span> | <span class="t">things because if you think about inference, at inference time you don't want to run setup,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1272" target="_blank">00:21:12.400</a></span> | <span class="t">at inference time you just want to run encodes. But at training time you want to do both, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1281" target="_blank">00:21:21.680</a></span> | <span class="t">Any time you don't do setup, you're definitely also going to want to process. So that's why setup,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1287" target="_blank">00:21:27.520</a></span> | <span class="t">after it sets up, immediately does the encoding because that's in practice always what you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1297" target="_blank">00:21:37.280</a></span> | <span class="t">So that's why we override setup in TabularProc. That's all TabularProc is, it's just a transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1303" target="_blank">00:21:43.280</a></span> | <span class="t">that when you set it up it also calls it straight away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1305" target="_blank">00:21:45.840</a></span> | <span class="t">Okay, so that, so Categorify is pretty similar to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1314" target="_blank">00:21:54.960</a></span> | <span class="t">categorized transform we've seen for dependent variables for like image classification,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1324" target="_blank">00:22:04.560</a></span> | <span class="t">but it's a little bit different because it's for TabularObjects. So you can see an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1330" target="_blank">00:22:10.880</a></span> | <span class="t">Here's a data frame 01202 in just a single column. So again we can create a TabularObject</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1339" target="_blank">00:22:19.680</a></span> | <span class="t">passing in the data frame, passing in any processes we want to run, and passing in,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1345" target="_blank">00:22:25.600</a></span> | <span class="t">so the first thing that we pass in after that will be the category names, the categorical names,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1351" target="_blank">00:22:31.920</a></span> | <span class="t">so we're just going to have one. So once you have created your TabularObject, the next thing you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1360" target="_blank">00:22:40.640</a></span> | <span class="t">want to do is to call setup, and remember that setup's going to do two things. It's going to call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1365" target="_blank">00:22:45.280</a></span> | <span class="t">your setups and it's going to call your encodes. Are there any object or textures? We haven't done</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1378" target="_blank">00:22:58.080</a></span> | <span class="t">any models yet, David. We're only really working through the transformation pipeline, but we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1382" target="_blank">00:23:02.800</a></span> | <span class="t">certainly looked at a version to object detectors in previous lessons for like, well, not in detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1389" target="_blank">00:23:09.600</a></span> | <span class="t">We've touched on the places where the object detection data is defined, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1397" target="_blank">00:23:17.120</a></span> | <span class="t">yeah, hopefully it's clear enough that you can figure that out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1406" target="_blank">00:23:26.880</a></span> | <span class="t">Yeah, so patch property does not call, I mean you can check the code easily enough yourself,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1414" target="_blank">00:23:34.000</a></span> | <span class="t">right? So patch property, let's see, okay, so no, it doesn't, it calls patch2,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1422" target="_blank">00:23:42.240</a></span> | <span class="t">patch2, no, it doesn't. So there's no way to create a setup using that decorator yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1436" target="_blank">00:23:56.240</a></span> | <span class="t">If you can think of a good syntax for that that you think would work well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1439" target="_blank">00:23:59.680</a></span> | <span class="t">feel free to suggest it or even implement it in a PR.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1442" target="_blank">00:24:02.400</a></span> | <span class="t">Okay, so, all right, so we've created our TabularObject. As we told it to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1453" target="_blank">00:24:13.760</a></span> | <span class="t">categorify, we said this is our only categorical variable. Then we call setup, which is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1459" target="_blank">00:24:19.680</a></span> | <span class="t">go ahead and let's have a look. Setup is going to, in our processor, create classes and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1472" target="_blank">00:24:32.640</a></span> | <span class="t">it's going to change our items to call apply cats, which will map the data in that column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1489" target="_blank">00:24:49.680</a></span> | <span class="t">using this dictionary. So map is an interesting pandas method. You can pass it a function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1497" target="_blank">00:24:57.760</a></span> | <span class="t">which is going to be super slow, so don't do that, but you can also pass it a dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1502" target="_blank">00:25:02.240</a></span> | <span class="t">and that will just map from keys to values in the dictionary. So if we have a look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1511" target="_blank">00:25:11.520</a></span> | <span class="t">at this case, we can see that 2.a starts out as 0.1.2.0.2 and ends up as 1.2.3.1.3 and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1524" target="_blank">00:25:24.640</a></span> | <span class="t">reason for that is that the vocab that it created is #na 0.1.2. So whenever we create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1534" target="_blank">00:25:34.960</a></span> | <span class="t">categorized column for the vocab, we always put a #na at the start, which is similar to what we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1542" target="_blank">00:25:42.480</a></span> | <span class="t">done in version 1. So that way if you in the future get a value outside of your vocab,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1551" target="_blank">00:25:51.280</a></span> | <span class="t">then that's what we're going to set it to. We're going to set it to #na and so therefore 1, if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1557" target="_blank">00:25:57.520</a></span> | <span class="t">index that into the vocab, that maps to 0. So that's why this is 0 became 1, for example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1564" target="_blank">00:26:04.800</a></span> | <span class="t">One of the things that I recently added to pipeline, because remember that 2.prox</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1574" target="_blank">00:26:14.080</a></span> | <span class="t">is a pipeline, right? And one of the things I added to pipeline is a getatra, which will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1585" target="_blank">00:26:25.360</a></span> | <span class="t">try to, so this is not an attribute in pipeline, not surprisingly, so if it finds an attribute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1593" target="_blank">00:26:33.280</a></span> | <span class="t">it doesn't understand, it will try and find that attribute in any transforms inside that pipeline,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1599" target="_blank">00:26:39.440</a></span> | <span class="t">which is exactly what we want, you know? So in this case, it's going to look for a transform</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1611" target="_blank">00:26:51.040</a></span> | <span class="t">with a type category of 5 and it converts it to snake case. So this is very similar if you've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1618" target="_blank">00:26:58.320</a></span> | <span class="t">watched the part 2, the most recent part 2 videos, we did the same thing for callbacks. Callbacks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1624" target="_blank">00:27:04.160</a></span> | <span class="t">got automatically inserted, and I think version 1 does this too, getting automatically added as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1628" target="_blank">00:27:08.160</a></span> | <span class="t">attributes. So pipeline does something very similar, but it doesn't actually add them as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1633" target="_blank">00:27:13.600</a></span> | <span class="t">attributes, it uses getatra to do the same thing. So in this case we added a categoryify transform,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1641" target="_blank">00:27:21.280</a></span> | <span class="t">so we haven't instantiated it, we just passed in the type, so it's going to instantiate it for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1645" target="_blank">00:27:25.840</a></span> | <span class="t">Pipeline will always instantiate your types for you if you don't instantiate them, and so later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1650" target="_blank">00:27:30.720</a></span> | <span class="t">on we want to say, okay, let's find out what the vocab was, which means we need to grab the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1656" target="_blank">00:27:36.160</a></span> | <span class="t">processes out of our transform object and ask for the categoryify transform. So now that we've got</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1663" target="_blank">00:27:43.120</a></span> | <span class="t">that, categoryify transform, categoryify defines getItem and it will return the vocab for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1674" target="_blank">00:27:54.640</a></span> | <span class="t">column. So here is the vocab for that column, and so we can have a look, cat a,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1691" target="_blank">00:28:11.600</a></span> | <span class="t">okay, as you can see there it is, and that is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1694" target="_blank">00:28:14.800</a></span> | <span class="t">actually a type category map, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1700" target="_blank">00:28:20.480</a></span> | <span class="t">as well as having the items that we just saw, it also has the reverse mapping,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1708" target="_blank">00:28:28.000</a></span> | <span class="t">so this is, as you can see, goes the opposite direction. So to answer Aman's question,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1716" target="_blank">00:28:36.160</a></span> | <span class="t">yes, this should take care of the mapping in the test set, because if it comes across,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1723" target="_blank">00:28:43.760</a></span> | <span class="t">so it's going to look at o2i when it tries to call apply cats, it's going to try to find in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1732" target="_blank">00:28:52.000</a></span> | <span class="t">categories, it's going to try and find that column, it's going to grab o2i, which is this dictionary,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1740" target="_blank">00:29:00.960</a></span> | <span class="t">that's then going to use that to map everything in the column, but because it's a default dict,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1745" target="_blank">00:29:05.440</a></span> | <span class="t">if there's anything it doesn't recognize, it will become zero, which is the na</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1751" target="_blank">00:29:11.040</a></span> | <span class="t">category. So yeah, that should all work nicely. You have to figure out how to model it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1758" target="_blank">00:29:18.480</a></span> | <span class="t">of course, but the data processing will handle it for you. Okay, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1767" target="_blank">00:29:27.360</a></span> | <span class="t">what else? So now, imagine it's inference time,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1776" target="_blank">00:29:36.720</a></span> | <span class="t">and so we come along with some new data frame that we want to run inference on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1785" target="_blank">00:29:45.120</a></span> | <span class="t">or it's a test set or whatever, so here's our data frame. So we now have to say, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1790" target="_blank">00:29:50.960</a></span> | <span class="t">I want to create a new tabular object for the same metadata that we had before, so the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1796" target="_blank">00:29:56.880</a></span> | <span class="t">processes, the same vocab, the same categorical continuous variables. The way to do that is to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1803" target="_blank">00:30:03.200</a></span> | <span class="t">start with an existing tabular object which has that metadata and call new and pass in a new data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1808" target="_blank">00:30:08.720</a></span> | <span class="t">frame that you have, and that's going to give you a new tabular object with the same metadata and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1813" target="_blank">00:30:13.280</a></span> | <span class="t">processes and stuff that we had before, but with this different data in it. Now of course, we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1820" target="_blank">00:30:20.640</a></span> | <span class="t">want to call setup on that because setup would replace the vocab, and the whole point is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1825" target="_blank">00:30:25.680</a></span> | <span class="t">we want to actually use the same vocab for inference on this new data set. So instead you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1834" target="_blank">00:30:34.000</a></span> | <span class="t">call process, and so all process does in tabular is it just calls the processes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1841" target="_blank">00:30:41.760</a></span> | <span class="t">which is a pipeline, so you can just treat it as a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1850" target="_blank">00:30:50.480</a></span> | <span class="t">So in this case, our vocab was 0, 1, 2 and an a, and here there's a couple of things that are not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1860" target="_blank">00:31:00.000</a></span> | <span class="t">in that list of 0, 1, 2, specifically this one is 3 and this one is -1. So 1, 0 and 2 will get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1870" target="_blank">00:31:10.640</a></span> | <span class="t">replaced by their 1, 0 and 2, so 2, 1, 3, 2, 1, 3, so there's our new a column, and then as we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1883" target="_blank">00:31:23.840</a></span> | <span class="t">discussed the two things that don't map are going to be 0. So then if you call decode on our processor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1896" target="_blank">00:31:36.960</a></span> | <span class="t">then as you would expect you end up with the same data you started with, but of course this is now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1904" target="_blank">00:31:44.240</a></span> | <span class="t">going to be Na, because we said we don't know what those are. So like decoding in general in fastai</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1913" target="_blank">00:31:53.840</a></span> | <span class="t">doesn't mean you always get back exactly what you started with, right? It's kind of it's trying to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1920" target="_blank">00:32:00.400</a></span> | <span class="t">display the kind of transformed version of the data. In some cases like normalization, it should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1931" target="_blank">00:32:11.280</a></span> | <span class="t">pretty much be exactly what you started with, but for some things like categorify the missing values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1936" target="_blank">00:32:16.640</a></span> | <span class="t">it won't be exactly what you started with. You don't have to pass in just a type name,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1944" target="_blank">00:32:24.400</a></span> | <span class="t">you can instantiate a processor yourself and then pass that in, so then that means you don't have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1952" target="_blank">00:32:32.800</a></span> | <span class="t">dig it out again like this, so sometimes that's more convenient, so this is just another way of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1959" target="_blank">00:32:39.120</a></span> | <span class="t">doing the same thing. But in this case we're also going to split the training set and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1964" target="_blank">00:32:44.160</a></span> | <span class="t">validation set, and this is particularly important for things like categorify, because if our training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1969" target="_blank">00:32:49.680</a></span> | <span class="t">set is the first three elements and our validation set is the last two, then this thing here three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1977" target="_blank">00:32:57.040</a></span> | <span class="t">is not in the training set, and so therefore it should not be part of the vocab. So let's make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1982" target="_blank">00:33:02.320</a></span> | <span class="t">sure that that's the case. So here we are, categorical variable, yep it doesn't have three in it,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1988" target="_blank">00:33:08.160</a></span> | <span class="t">the vocab doesn't have three in it. So the way we pass in these split indexes is by calling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1994" target="_blank">00:33:14.640</a></span> | <span class="t">tabular object dot data source, and that converts the tabular object to a data source, the only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=1999" target="_blank">00:33:19.760</a></span> | <span class="t">thing you pass it is the list of splits. And so that gives you a standard data source object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2010" target="_blank">00:33:30.480</a></span> | <span class="t">just like the one that we saw in our last walkthrough. So that's what you get, and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2017" target="_blank">00:33:37.840</a></span> | <span class="t">that data source, let's take it out, right, so that data source object will have a train,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2024" target="_blank">00:33:44.240</a></span> | <span class="t">for example, and a valid. And those are just other ways of saying subset zero and subset one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2039" target="_blank">00:33:59.680</a></span> | <span class="t">Should test set be three comma two? No, these are the indexes of what's the indexes and things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2054" target="_blank">00:34:14.000</a></span> | <span class="t">in the training set, these are the indexes in the validation set, so these are indexes three and four</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2063" target="_blank">00:34:23.360</a></span> | <span class="t">in the validation set. Yes, they're ID indexes. So data source, so like in terms of looking at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2076" target="_blank">00:34:36.240</a></span> | <span class="t">the code of tabular, it's super tiny, which is nice, in terms of the things that are more than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2085" target="_blank">00:34:45.280</a></span> | <span class="t">one line in it, because there's a bunch of things in store, and data source. And the only reason data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2091" target="_blank">00:34:51.440</a></span> | <span class="t">source is more than a couple of lines is because in rapids on the GPU, trying to index into a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2102" target="_blank">00:35:02.720</a></span> | <span class="t">frame with like arbitrary indexes is really, really, really, really slow. So you have to pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2112" target="_blank">00:35:12.080</a></span> | <span class="t">in a contiguous list of indexes to make rapids fast. So what we do is when you pass in splits,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2120" target="_blank">00:35:20.720</a></span> | <span class="t">we actually concatenate all of those splits together into a single list and we index into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2131" target="_blank">00:35:31.360</a></span> | <span class="t">the data frame with that list. So that's going to shuffle the list so that all the stuff that's in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2136" target="_blank">00:35:36.640</a></span> | <span class="t">the same validation or training set is all together. And so that way, now when we create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2144" target="_blank">00:35:44.080</a></span> | <span class="t">our data source rather than passing in the actual splits, we just pass in a range of all the numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2149" target="_blank">00:35:49.760</a></span> | <span class="t">from nought to the length of the first split, and then all of the numbers from the length of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2155" target="_blank">00:35:55.840</a></span> | <span class="t">first split to the length of the whole thing. And so our data source is then able to always use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2164" target="_blank">00:36:04.640</a></span> | <span class="t">contiguous indexes. So that's why that bit of code is there. Other than that, one thing I don't like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2177" target="_blank">00:36:17.840</a></span> | <span class="t">about Python is that any time you want to create a property, you have to put it on another row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2186" target="_blank">00:36:26.480</a></span> | <span class="t">like this, like in a lot of programming languages you can kind of do that kind of thing on the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2191" target="_blank">00:36:31.520</a></span> | <span class="t">line but not in Python for some reason. And so I find it takes up a lot of room just for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2197" target="_blank">00:36:37.040</a></span> | <span class="t">process of saying these are properties. So I just added an alternative syntax which is to create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2202" target="_blank">00:36:42.160</a></span> | <span class="t">list of all the things that are properties. So that's all that is. Like most of these things,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2208" target="_blank">00:36:48.800</a></span> | <span class="t">it's super tiny. So that's just one line of code. Just goes through and calls property on them to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2215" target="_blank">00:36:55.840</a></span> | <span class="t">make them properties. Oh, okay. So then another thing about this is I kind of tried to make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2230" target="_blank">00:37:10.240</a></span> | <span class="t">tabular look a lot like DataFrame. And one way that happens is we've inherited from getatra</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2236" target="_blank">00:37:16.480</a></span> | <span class="t">which means that any unknown attributes it's going to pass down to whatever is the default</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2244" target="_blank">00:37:24.560</a></span> | <span class="t">property which is soft.items which is a DataFrame. So in other words, it behaves a lot like a DataFrame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2251" target="_blank">00:37:31.440</a></span> | <span class="t">because anything unknown it will actually pass it along to the DataFrame. But one thing I did want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2257" target="_blank">00:37:37.520</a></span> | <span class="t">to change is in DataFrames it's not convenient to index into a row by row number and a column by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2268" target="_blank">00:37:48.880</a></span> | <span class="t">name. You can use Ilock to get row by number, column by number. You can do lock to say row by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2276" target="_blank">00:37:56.400</a></span> | <span class="t">name or index and column by name or index. But most of the time I want to use row numbers and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2283" target="_blank">00:38:03.600</a></span> | <span class="t">column names. So we redefine Ilock to use this tabular Ilock indexer which is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2293" target="_blank">00:38:13.360</a></span> | <span class="t">And as you can see if you have a row and a column then the columns I actually replace with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2306" target="_blank">00:38:26.160</a></span> | <span class="t">the integer index of the column. So that way we can use column names and row numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2313" target="_blank">00:38:33.520</a></span> | <span class="t">And also it will wrap it back up in a tabular object as well. So we end up with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2323" target="_blank">00:38:43.360</a></span> | <span class="t">if you index into a tabular object with Ilock you'll get back a tabular object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2333" target="_blank">00:38:53.280</a></span> | <span class="t">So then the way Categorify is implemented as you see in encodes is it calls transform,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2342" target="_blank">00:39:02.800</a></span> | <span class="t">passing in a bunch of column names and a function. The function apply cats is the thing we saw before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2352" target="_blank">00:39:12.000</a></span> | <span class="t">which is the thing that calls map unless you have a pandas categorical column in which case you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2359" target="_blank">00:39:19.200</a></span> | <span class="t">actually already have the pandas has done the coding for you. So you just return it which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2364" target="_blank">00:39:24.560</a></span> | <span class="t">cat.codes+1. And so how does this function get applied to each of these columns? That's because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2376" target="_blank">00:39:36.960</a></span> | <span class="t">we have a thing called tabular object.transform and that's the thing that at the moment is defined</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2384" target="_blank">00:39:44.080</a></span> | <span class="t">explicitly for pandas. And as you can see for pandas it just is this column equals the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2391" target="_blank">00:39:51.840</a></span> | <span class="t">transform version of this column because pandas has a dot transform method for series.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2398" target="_blank">00:39:58.720</a></span> | <span class="t">So that's all we needed to do there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2411" target="_blank">00:40:11.440</a></span> | <span class="t">Okay, so Juvian your question there about numerical versus continuous you should watch the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2417" target="_blank">00:40:17.040</a></span> | <span class="t">introduction to machine learning for coders course where we talk about that in a lot of detail.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2423" target="_blank">00:40:23.520</a></span> | <span class="t">That's something you probably have time to cover here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2426" target="_blank">00:40:26.880</a></span> | <span class="t">All right, so that's Categorify. So here's the other way to use Categorify as I was kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2440" target="_blank">00:40:40.800</a></span> | <span class="t">beginning to mention is you can actually create a categorical column in pandas. And one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2446" target="_blank">00:40:46.080</a></span> | <span class="t">reasons to do that is so that you can say these are the categories I want to use and they have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2450" target="_blank">00:40:50.480</a></span> | <span class="t">an order and so that way high, medium, low will now be ordered correctly which is super</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2456" target="_blank">00:40:56.960</a></span> | <span class="t">useful. Also pandas is just nice and efficient at dealing with categories. So now if we go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2466" target="_blank">00:41:06.320</a></span> | <span class="t">Categorify just like before, it's going to give us exactly the same kind of results except that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2472" target="_blank">00:41:12.720</a></span> | <span class="t">when we look at the categorical processor, these will be in the right order. So we're going to end</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2481" target="_blank">00:41:21.120</a></span> | <span class="t">up with things that have been mapped in that way and it will also be done potentially more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2486" target="_blank">00:41:26.160</a></span> | <span class="t">efficiently because it's using the internal pandas cat code stuff. Thank you David, that is very kind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2498" target="_blank">00:41:38.240</a></span> | <span class="t">I'm so thrilled. I would love to know where you are working as a computer vision data scientist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2503" target="_blank">00:41:43.440</a></span> | <span class="t">It's a very cool job.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2504" target="_blank">00:41:44.880</a></span> | <span class="t">Andrew was studying his job as the in-house research director and data scientist here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2515" target="_blank">00:41:55.840</a></span> | <span class="t">in 10 days time and also working very, very, very, very hard on being amazing which also helps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2525" target="_blank">00:42:05.600</a></span> | <span class="t">Lots of people do the course and don't end up doing jobs because they don't work as hard.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2534" target="_blank">00:42:14.960</a></span> | <span class="t">Although I think everybody listening to this by definition is going to an extra level of effort.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2542" target="_blank">00:42:22.160</a></span> | <span class="t">So I'm sure you will all do great. Normalize is you know just something where we're going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2551" target="_blank">00:42:31.760</a></span> | <span class="t">subtract the means and divide by the state of deviations and for decodes we're going to do the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2557" target="_blank">00:42:37.920</a></span> | <span class="t">opposite. And you'll see what we generally do in these setup things, we use it do this in lots of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2564" target="_blank">00:42:44.880</a></span> | <span class="t">places, is we say get atra data source comma train comma data source. What this means is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2575" target="_blank">00:42:55.200</a></span> | <span class="t">it's the same as if we'd written this df equals dsrc dot train if has atra dsrc comma train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2591" target="_blank">00:43:11.600</a></span> | <span class="t">else dsrc. It's the same as writing that, right? And so the reason we're doing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2600" target="_blank">00:43:20.800</a></span> | <span class="t">is because we want you to be able to either pass in a an actual data source object which has a train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2608" target="_blank">00:43:28.960</a></span> | <span class="t">and a valid or not. You know if you aren't doing separate things to train and valid then that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2616" target="_blank">00:43:36.000</a></span> | <span class="t">should be fine as well, right? And so as long as the thing you pass in, if it does have a train,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2622" target="_blank">00:43:42.320</a></span> | <span class="t">then it should you know it should give you back some kind of object that has the right methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2628" target="_blank">00:43:48.320</a></span> | <span class="t">that you need. So in the case of you know data source and tabular it will, data source has a train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2637" target="_blank">00:43:57.440</a></span> | <span class="t">attribute that will return a tabular object or if you just pass in a tabular object directly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2645" target="_blank">00:44:05.600</a></span> | <span class="t">then it won't have a train so it'll just stay so dsrc will just be a tabular object which has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2652" target="_blank">00:44:12.480</a></span> | <span class="t">continuous variables const attribute. Okay so now we have this this data frame containing just the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2662" target="_blank">00:44:22.720</a></span> | <span class="t">continuous variables and optionally just for our training set if we have one so then we can set up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2669" target="_blank">00:44:29.440</a></span> | <span class="t">our means and standard deviations you know that's the metadata we need. So here we can create our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2677" target="_blank">00:44:37.360</a></span> | <span class="t">normalize, create a data frame to test it out on, pass in that processor this time we just got to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2683" target="_blank">00:44:43.840</a></span> | <span class="t">say these are continuous variables this is one which is a make sure we call setup and so now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2691" target="_blank">00:44:51.280</a></span> | <span class="t">we should find here is the same data that we had before but let's make it into an array for testing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2699" target="_blank">00:44:59.600</a></span> | <span class="t">and calculate being a standard deviation so we should find if we go norm.means a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2705" target="_blank">00:45:05.600</a></span> | <span class="t">so self.means was df.mean this is quite nice right in pandas if you call .mean on a data frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2714" target="_blank">00:45:14.320</a></span> | <span class="t">you will get back a I think it's a series object which you can index into with column names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2721" target="_blank">00:45:21.600</a></span> | <span class="t">So this is quite neat right that we were able to get all the means and standard deviations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2726" target="_blank">00:45:26.320</a></span> | <span class="t">all at once for all the columns and even apply them to all the columns at once. This is kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2731" target="_blank">00:45:31.200</a></span> | <span class="t">the magic of Python indexes so I think that's that's actually pretty nice. So yeah make sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2739" target="_blank">00:45:39.120</a></span> | <span class="t">that the main is m, standard deviation should be around s and the values after processing should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2747" target="_blank">00:45:47.120</a></span> | <span class="t">be around x minus m over s. One thing to notice is that this here setup we didn't call here why</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2763" target="_blank">00:46:03.760</a></span> | <span class="t">didn't we call setup and the reason why is that if you look at data source it calls setup. Why?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2776" target="_blank">00:46:16.000</a></span> | <span class="t">Because we now definitely have all the information we need to set it up right. We know the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2780" target="_blank">00:46:20.640</a></span> | <span class="t">because that was a data frame you passed in and now we know what the training set is because that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2785" target="_blank">00:46:25.200</a></span> | <span class="t">was passed in so there's no reason there's no reason to ask you to manually call setup.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2790" target="_blank">00:46:30.080</a></span> | <span class="t">So you've got two ways to set up your processes. One is to call setup on your tabular object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2800" target="_blank">00:46:40.560</a></span> | <span class="t">or the other is just to create a data source right and it's kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2805" target="_blank">00:46:45.840</a></span> | <span class="t">it's something you kind of have to be aware of right because calling data source is not just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2812" target="_blank">00:46:52.400</a></span> | <span class="t">returning a data source it is also modifying your tabular object data to process it and so it's kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2819" target="_blank">00:46:59.600</a></span> | <span class="t">of like it's a very non-pure non-functional kind of approach coming on here. We're not changing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2827" target="_blank">00:47:07.600</a></span> | <span class="t">things and returning them we're like changing things in place and the reason for that is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2832" target="_blank">00:47:12.240</a></span> | <span class="t">you know with with tabular data you know you you don't want to be creating lots of copies of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2838" target="_blank">00:47:18.240</a></span> | <span class="t">you really want to be doing stuff in place it's got a lot of you know performance important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2842" target="_blank">00:47:22.560</a></span> | <span class="t">performance issues so we try to do things just once and do it where it is. So normalize in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2850" target="_blank">00:47:30.000</a></span> | <span class="t">case we're calling setup and so again for inference you know here's some new data set we want to call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2857" target="_blank">00:47:37.920</a></span> | <span class="t">inference on we go tabular object.new on the new data frame we process it we don't call setup</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2865" target="_blank">00:47:45.520</a></span> | <span class="t">because we don't want to create new meaning standard deviation and to use the same standard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2869" target="_blank">00:47:49.280</a></span> | <span class="t">deviation and mean that we use for our training. And then here's the version where we use instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2878" target="_blank">00:47:58.960</a></span> | <span class="t">data source so you'll find that the mean and standard deviation now the mean standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2887" target="_blank">00:48:07.600</a></span> | <span class="t">is 0 1 2 because that's the only stuff in the training set and again normalization and stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2892" target="_blank">00:48:12.480</a></span> | <span class="t">should only be done with the training set. So you know all this stuff of kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2897" target="_blank">00:48:17.360</a></span> | <span class="t">using this stuff makes it much harder to screw things up in terms of modeling and accidentally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2905" target="_blank">00:48:25.280</a></span> | <span class="t">do things on the whole data set you know get leakage and stuff like that because you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2910" target="_blank">00:48:30.240</a></span> | <span class="t">we try to automatically do the right thing for you. Okay so then fill missing is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2920" target="_blank">00:48:40.720</a></span> | <span class="t">go through each continuous column and it will see if there are any missing values in the column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2934" target="_blank">00:48:54.640</a></span> | <span class="t">And if there are missing values then it's going to create a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2946" target="_blank">00:49:06.960</a></span> | <span class="t">nA dictionary so if there's any nAs or any missing or any nulls or the same idea in pandas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2954" target="_blank">00:49:14.640</a></span> | <span class="t">then that column will appear as a column name in this dictionary and the value of it will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2963" target="_blank">00:49:23.040</a></span> | <span class="t">dependent on what fill strategy you ask for. So fill strategy is a class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2973" target="_blank">00:49:33.200</a></span> | <span class="t">that contains three different methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2978" target="_blank">00:49:38.720</a></span> | <span class="t">and you can say which of those methods you want to use. Do you want to fill things with the median</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2989" target="_blank">00:49:49.360</a></span> | <span class="t">or with some constant or with the mode, right? And so we assume by default that it's the median.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=2997" target="_blank">00:49:57.760</a></span> | <span class="t">So this here is actually going to call fill strategy.median passing in the column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3004" target="_blank">00:50:04.160</a></span> | <span class="t">and so it's going to return the median.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3006" target="_blank">00:50:06.640</a></span> | <span class="t">So that's the dictionary we create. So then later on when you're calling codes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3016" target="_blank">00:50:16.080</a></span> | <span class="t">we actually need to go through and do two things. The first thing is to use the pandas fill in A</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3031" target="_blank">00:50:31.680</a></span> | <span class="t">to fill missing values with whatever value we put into the dictionary for that column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3038" target="_blank">00:50:38.320</a></span> | <span class="t">and again we do it in place. Then the second thing is if you're asked to add an extra column to say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3048" target="_blank">00:50:48.320</a></span> | <span class="t">which ones we feel are missing in, which by default is true, then we're going to add a column with the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3053" target="_blank">00:50:53.920</a></span> | <span class="t">same name that underscore nA at the end which is going to be a boolean of true if that was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3062" target="_blank">00:51:02.000</a></span> | <span class="t">originally missing and false otherwise. So here you can see we're creating three different processes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3070" target="_blank">00:51:10.960</a></span> | <span class="t">which are just processes, a fill missing processor with each of the possible</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3075" target="_blank">00:51:15.520</a></span> | <span class="t">strategies. And so then we create a data frame with a missing value and then we just go through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3083" target="_blank">00:51:23.360</a></span> | <span class="t">and create three tabular objects with those three different processes and make sure that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3091" target="_blank">00:51:31.680</a></span> | <span class="t">nA dict for our A column has the appropriate median or constant or load as requested.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3099" target="_blank">00:51:39.760</a></span> | <span class="t">And then remember setup also processes so then we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3106" target="_blank">00:51:46.800</a></span> | <span class="t">go through and make sure that they have been replaced correctly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3115" target="_blank">00:51:55.680</a></span> | <span class="t">And also make sure that the tabular object now has a categorical name which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3122" target="_blank">00:52:02.400</a></span> | <span class="t">in this case a nA. So it's not enough just to add it to the data frame, it also has to be added to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3130" target="_blank">00:52:10.160</a></span> | <span class="t">cat names in the tabular object because this is something a categorical column we want to use for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3136" target="_blank">00:52:16.000</a></span> | <span class="t">modeling. So Madhavan asks shouldn't setups be called in the constructor and no it shouldn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3143" target="_blank">00:52:23.680</a></span> | <span class="t">Setups is what transforms call when you call setup using the type dispatch stuff we talked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3151" target="_blank">00:52:31.600</a></span> | <span class="t">about in the transforms walkthrough and so and then setup is something which should be called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3158" target="_blank">00:52:38.880</a></span> | <span class="t">automatically only when we have enough information to know what to set up with and that information</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3163" target="_blank">00:52:43.760</a></span> | <span class="t">is only available once you've told us what your training set is so that's why it's called by data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3169" target="_blank">00:52:49.280</a></span> | <span class="t">source not called by the constructor but if you're not going to use a data source then you can call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3176" target="_blank">00:52:56.960</a></span> | <span class="t">it yourself. Okay. Great. So this section is mainly kind of a few more examples of putting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3195" target="_blank">00:53:15.600</a></span> | <span class="t">that all together. All right. So here's a bunch of processes normalize, categorify, film missing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3201" target="_blank">00:53:21.600</a></span> | <span class="t">do nothing at all. Obviously you don't need this one it's just to show you. And here's a data frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3207" target="_blank">00:53:27.040</a></span> | <span class="t">with a couple of columns. A is the categorical, B is the continuous because remember that was the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3212" target="_blank">00:53:32.960</a></span> | <span class="t">order that we use. It would be probably better if we actually wrote those here at least the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3219" target="_blank">00:53:39.200</a></span> | <span class="t">time so you didn't have to remember. There we go. So recall setup because we're not using a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3227" target="_blank">00:53:47.760</a></span> | <span class="t">source on this one. And so the processes you'll have noticed explicitly only work on the columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3239" target="_blank">00:53:59.200</a></span> | <span class="t">of the right type so these work just on the continuous columns for normalize, for get a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3244" target="_blank">00:54:04.480</a></span> | <span class="t">categorify, it goes through the categorical columns. You might have noticed that was all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3255" target="_blank">00:54:15.600</a></span> | <span class="t">cat names and that's because you also want to categorize categorical dependent variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3261" target="_blank">00:54:21.600</a></span> | <span class="t">but normalize we don't normalize continuous dependent variables. Normally for that you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3267" target="_blank">00:54:27.040</a></span> | <span class="t">do like a sigmoid in the model or something like that. So yeah so you can throw them all in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3276" target="_blank">00:54:36.320</a></span> | <span class="t">and it'll do the right thing for the right columns automatically. So it just goes through and makes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3280" target="_blank">00:54:40.080</a></span> | <span class="t">sure that that all works fine. So these are really just a bunch of tests and examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3286" target="_blank">00:54:46.160</a></span> | <span class="t">Okay so last section which is okay so now we have a tabular object which has got some cats</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3296" target="_blank">00:54:56.320</a></span> | <span class="t">and some cons and dependent variable wise. If we want to use this for modeling we need tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3304" target="_blank">00:55:04.960</a></span> | <span class="t">We actually need three tensors, one tensor for the continuous, one for the categorical and one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3311" target="_blank">00:55:11.920</a></span> | <span class="t">for the dependent. And the reason for that is that they're continuous in the categorical of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3316" target="_blank">00:55:16.720</a></span> | <span class="t">different data types so we can't put them all on the same tensor because tensors have to be all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3321" target="_blank">00:55:21.440</a></span> | <span class="t">of the same data type. So if you look at the version one tabular stuff it's the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3328" target="_blank">00:55:28.240</a></span> | <span class="t">right we have those three different tensors. So now we create some one normal transform so a lazy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3337" target="_blank">00:55:37.360</a></span> | <span class="t">transform that's you know it's applied as we're getting our batches and all we do is we say okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3345" target="_blank">00:55:45.200</a></span> | <span class="t">this is the tabular object which we're going to be transforming and we just grab the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3352" target="_blank">00:55:52.400</a></span> | <span class="t">and in codes we don't actually need we don't need that state at all. For end codes we're just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3361" target="_blank">00:56:01.920</a></span> | <span class="t">to grab all of the categorical variables turn them into a tensor and make it a long. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3367" target="_blank">00:56:07.120</a></span> | <span class="t">we'll grab all the continuous turn it into a tensor make it a float. And so then the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3372" target="_blank">00:56:12.240</a></span> | <span class="t">thing our tuple is itself a tuple with those two things so that's our independent variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3377" target="_blank">00:56:17.920</a></span> | <span class="t">and then our dependent variable is the target turned into a long. This is actually a mistake</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3385" target="_blank">00:56:25.120</a></span> | <span class="t">it shouldn't always turn it into a long it should only turn it into a long if it's continuous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3390" target="_blank">00:56:30.400</a></span> | <span class="t">sorry categorical why otherwise it should be continuous I think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3399" target="_blank">00:56:39.760</a></span> | <span class="t">No let's wait until we get to modeling I can't quite remember it's if it's categorical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3404" target="_blank">00:56:44.800</a></span> | <span class="t">where they're going to want to encode it. No we're going to use it as yeah that's right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3411" target="_blank">00:56:51.200</a></span> | <span class="t">so it's that's right so it's a long if it's categorical but for continuous it has to be float</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3415" target="_blank">00:56:55.760</a></span> | <span class="t">that's right. So to use float for continuous target okay so that's a little mistake</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3427" target="_blank">00:57:07.280</a></span> | <span class="t">we haven't done any tabular regression yet in version one version two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3430" target="_blank">00:57:10.960</a></span> | <span class="t">So that's all encodes is going to do so then we'll come back to decodes later right. So in our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3441" target="_blank">00:57:21.040</a></span> | <span class="t">example here we grabbed our path to the adult sample we read the CSV we split it into a test</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3448" target="_blank">00:57:28.000</a></span> | <span class="t">set and the main bit made a list of our categorical and continuous a list of the processes we wanted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3457" target="_blank">00:57:37.920</a></span> | <span class="t">to use the indexes of the splits that we wanted so then we can create that tabular as we discussed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3468" target="_blank">00:57:48.000</a></span> | <span class="t">we can turn it into a data source with the splits now you'll see here it never mentioned read tab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3478" target="_blank">00:57:58.240</a></span> | <span class="t">batch and the reason for that is that we don't want to force you to do things that we can do for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3484" target="_blank">00:58:04.080</a></span> | <span class="t">you so if you just say give me a tabular data loader rather than a normal data loader and tabular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3490" target="_blank">00:58:10.000</a></span> | <span class="t">data that loader is a transform data loader where we know that any after batch that you asked for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3498" target="_blank">00:58:18.480</a></span> | <span class="t">we have to also add in read tab batch so that's that's how that's automatically added to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3507" target="_blank">00:58:27.280</a></span> | <span class="t">transforms for you the other thing about tabular data loader is we want to do everything a batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3519" target="_blank">00:58:39.920</a></span> | <span class="t">at a time so particularly for the rapids on GPU stuff we don't want to pull out individual rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3527" target="_blank">00:58:47.440</a></span> | <span class="t">and then collect them later everything's done by grabbing a whole batch at a time so we replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3532" target="_blank">00:58:52.720</a></span> | <span class="t">do item which is the thing that normally grabs a single item for collation we replace it with do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3538" target="_blank">00:58:58.560</a></span> | <span class="t">nothing replace it with no up right and then we replace create batch which is the thing that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3544" target="_blank">00:59:04.800</a></span> | <span class="t">normally collects things to say don't collate things but instead actually grab all of the samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3551" target="_blank">00:59:11.040</a></span> | <span class="t">directly from the tabular object using my lock so this is if you look at that blog post I mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3561" target="_blank">00:59:21.040</a></span> | <span class="t">from even at Nvidia about how they got the 16x speed up by using rapids a key piece of that was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3569" target="_blank">00:59:29.040</a></span> | <span class="t">that they wrote their own version of this kind of stuff to kind of do everything batch at a time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3575" target="_blank">00:59:35.280</a></span> | <span class="t">and this is one of the key reasons we replaced the PyTorch data loader is to make this kind of thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3580" target="_blank">00:59:40.960</a></span> | <span class="t">super easy so as you can see creating a kind of a batch a batch at a time data loader is seven lines</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3586" target="_blank">00:59:46.800</a></span> | <span class="t">of code super nice and easy so yeah I was pretty excited when this came out so quick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3594" target="_blank">00:59:54.240</a></span> | <span class="t">okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3602" target="_blank">01:00:02.240</a></span> | <span class="t">so that's what happens when we create the tabular data loader</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3614" target="_blank">01:00:14.480</a></span> | <span class="t">we could of course also create a data bunch we should probably add this to the example</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3621" target="_blank">01:00:21.040</a></span> | <span class="t">and uh yeah that's basically it so then at inference time as we discussed you can now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3635" target="_blank">01:00:35.920</a></span> | <span class="t">do the same dot new trick we saw before in the dot process and then you can grab whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3641" target="_blank">01:00:41.600</a></span> | <span class="t">here's all coals which is going to give us a data frame with all the modeling columns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3646" target="_blank">01:00:46.080</a></span> | <span class="t">and since this is not so show batch will be the decoded version but this is not the decoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3651" target="_blank">01:00:51.280</a></span> | <span class="t">version this is the encoded version that you can pass to your modeling all right any questions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3659" target="_blank">01:00:59.760</a></span> | <span class="t">Andrea no okay cool all right thanks so that is it and uh it's Friday right yeah so I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3670" target="_blank">01:01:10.000</a></span> | <span class="t">I think we're on for Monday I'll double check and I'll let you all know um right away I will see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3675" target="_blank">01:01:15.440</a></span> | <span class="t">you later bye</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=yL1un5SH63k&t=3678" target="_blank">01:01:18.720</a></span> | <span class="t">[BLANK_AUDIO]</span></div></div></body></html>