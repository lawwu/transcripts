<html><head><title>Lesson 11 (2019) - Data Block API, and generic optimizer</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 11 (2019) - Data Block API, and generic optimizer</h2><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ"><img src="https://i.ytimg.com/vi_webp/hPQKzsjTyyQ/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=0">0:0</a> Introduction<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=80">1:20</a> Batch norm<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=230">3:50</a> LSUV<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=600">10:0</a> ImageNet<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=735">12:15</a> New Data Sets<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=955">15:55</a> Question<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1095">18:15</a> Importing data<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1520">25:20</a> The purpose of deep learning<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1780">29:40</a> Getting the files<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2160">36:0</a> Split validation set<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2370">39:30</a> Labeling<br><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3230">53:50</a> Data Bunch<br><br><div style="text-align: left;"><a href="./hPQKzsjTyyQ.html">Whisper Transcript</a> | <a href="./transcript_hPQKzsjTyyQ.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Well, welcome back, welcome to lesson 11, where we're going to be talking mainly about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=10" target="_blank">00:00:10.320</a></span> | <span class="t">data loading and optimizers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=13" target="_blank">00:00:13.200</a></span> | <span class="t">I said we would be talking about fastai.audio, but that's going to be a little bit later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=18" target="_blank">00:00:18.460</a></span> | <span class="t">in the course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=19" target="_blank">00:00:19.460</a></span> | <span class="t">We haven't quite got to where I wanted to get to yet, so everything I said we'd talk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=23" target="_blank">00:00:23.200</a></span> | <span class="t">about last week, we will talk about, but it might take a few more lessons to get there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=28" target="_blank">00:00:28.200</a></span> | <span class="t">than I said.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=31" target="_blank">00:00:31.600</a></span> | <span class="t">So this is kind of where we're up to, is the last little bit of our CNN, and specifically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=39" target="_blank">00:00:39.440</a></span> | <span class="t">these were the things we were going to dive into when we've done the first four of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=45" target="_blank">00:00:45.720</a></span> | <span class="t">CUDA, convolutions, hooks, normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=51" target="_blank">00:00:51.040</a></span> | <span class="t">So we're going to keep going through this process to try to create our state-of-the-art</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=57" target="_blank">00:00:57.320</a></span> | <span class="t">image net model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=60" target="_blank">00:01:00.000</a></span> | <span class="t">The specific items that we're working with are images, but everything we've covered so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=67" target="_blank">00:01:07.960</a></span> | <span class="t">far is equally valid, equally used for tabular, collaborative filtering, and text, and pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=75" target="_blank">00:01:15.440</a></span> | <span class="t">much everything else as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=80" target="_blank">00:01:20.340</a></span> | <span class="t">Last week we talked about BatchNorm, and I just wanted to mention that at the end of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=86" target="_blank">00:01:26.760</a></span> | <span class="t">the BatchNorm notebook there's another bit called simplified running BatchNorm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=92" target="_blank">00:01:32.200</a></span> | <span class="t">We talked a little bit about de-biasing last week, we'll talk about it more today, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=97" target="_blank">00:01:37.400</a></span> | <span class="t">Stas Begman pointed out something which is kind of obvious in hindsight, but I didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=101" target="_blank">00:01:41.600</a></span> | <span class="t">notice at the time, which is that we had sums divided by de-bias, and we had count divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=109" target="_blank">00:01:49.040</a></span> | <span class="t">by de-bias, and then we go sum divided by count, and sum divided by de-bias divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=114" target="_blank">00:01:54.800</a></span> | <span class="t">by count divided by de-bias, the two de-bias cancel each other out, so we can remove all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=120" target="_blank">00:02:00.680</a></span> | <span class="t">of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=121" target="_blank">00:02:01.680</a></span> | <span class="t">We're still going to cover de-biasing today for a different purpose, but actually we didn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=126" target="_blank">00:02:06.360</a></span> | <span class="t">really need it for last week, so we can remove all the de-biasing and end up with something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=132" target="_blank">00:02:12.520</a></span> | <span class="t">much simpler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=136" target="_blank">00:02:16.320</a></span> | <span class="t">That's the version that we're going to go with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=141" target="_blank">00:02:21.080</a></span> | <span class="t">Also thanks to Tom Veman, who pointed out that the last step where we went subtract</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=150" target="_blank">00:02:30.440</a></span> | <span class="t">mean divided by standard deviation multiplied by molts add adds, you can just rearrange</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=156" target="_blank">00:02:36.120</a></span> | <span class="t">that into this form, molts divided by variances and adds minus means times that factor, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=166" target="_blank">00:02:46.200</a></span> | <span class="t">if you do it this way, then you don't actually have to touch X until you've done all of those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=174" target="_blank">00:02:54.200</a></span> | <span class="t">things, and so that's going to end up being faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=176" target="_blank">00:02:56.160</a></span> | <span class="t">If you think through the broadcasting operations there, then you're doing a lot less computation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=181" target="_blank">00:03:01.840</a></span> | <span class="t">this way, so that was a good idea as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=187" target="_blank">00:03:07.720</a></span> | <span class="t">And I should mention Tom has been helping us out quite a bit with some of this batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=192" target="_blank">00:03:12.640</a></span> | <span class="t">norm stuff, one of the few people involved in the PyTorch community who's been amazingly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=197" target="_blank">00:03:17.480</a></span> | <span class="t">helpful who I'd like to call out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=200" target="_blank">00:03:20.400</a></span> | <span class="t">So thanks also to Sumith Chintala, who was one of the original founders of PyTorch, who's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=207" target="_blank">00:03:27.600</a></span> | <span class="t">been super helpful in sorting some things out for this course, and also Francisco Massa,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=214" target="_blank">00:03:34.640</a></span> | <span class="t">also super helpful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=216" target="_blank">00:03:36.240</a></span> | <span class="t">They're both part of the official Facebook engineering team, and Tom's not, but he does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=222" target="_blank">00:03:42.040</a></span> | <span class="t">so much work for PyTorch, he kind of seems like he must be sometimes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=226" target="_blank">00:03:46.160</a></span> | <span class="t">So thanks to all of you for your great help.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=230" target="_blank">00:03:50.040</a></span> | <span class="t">Okay, before we moved on to data blocks, I wanted to mention one other approach to making</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=239" target="_blank">00:03:59.120</a></span> | <span class="t">sure that your model trains nicely, and to me this is the most fast AI-ish method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=246" target="_blank">00:04:06.800</a></span> | <span class="t">I wish I had come up with it, but I didn't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=252" target="_blank">00:04:12.280</a></span> | <span class="t">Wonderful researcher named Dimitro came up with it in a paper called All You Need Is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=256" target="_blank">00:04:16.560</a></span> | <span class="t">a Good In It, Dimitro Mishkin, and this is the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=264" target="_blank">00:04:24.600</a></span> | <span class="t">And he came up with this technique called LSUV, Layer-wise Sequential Unit Variance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=268" target="_blank">00:04:28.800</a></span> | <span class="t">So the basic idea is this, you've seen now how fiddly it is to get your unit variances</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=276" target="_blank">00:04:36.400</a></span> | <span class="t">all the way through your network, and little things can change that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=282" target="_blank">00:04:42.120</a></span> | <span class="t">So if you change your activation function, or something we haven't mentioned, if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=286" target="_blank">00:04:46.280</a></span> | <span class="t">add dropout, or change the amount of dropout, these are all going to impact the variances</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=293" target="_blank">00:04:53.560</a></span> | <span class="t">of your layer outputs, and if they're just a little bit different to one, you'll get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=298" target="_blank">00:04:58.900</a></span> | <span class="t">exponentially worse as we saw through the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=303" target="_blank">00:05:03.360</a></span> | <span class="t">So the normal approach to fixing this is to think really carefully about your architecture,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=308" target="_blank">00:05:08.240</a></span> | <span class="t">and exactly, analytically, figure out how to initialize everything so it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=312" target="_blank">00:05:12.720</a></span> | <span class="t">And Dimitro's idea, which I like a lot better, is let the computer figure it out, and here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=319" target="_blank">00:05:19.480</a></span> | <span class="t">how you let the computer figure it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=320" target="_blank">00:05:20.960</a></span> | <span class="t">We create our MNIST data set in the same way as before, we create a bunch of layers with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=325" target="_blank">00:05:25.040</a></span> | <span class="t">these number of filters like before, and what I'm going to do is I'm going to create a conf</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=329" target="_blank">00:05:29.680</a></span> | <span class="t">layer class which contains our convolution and our relu, and the idea is that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=336" target="_blank">00:05:36.240</a></span> | <span class="t">to use this because now we can basically say this whole kind of combined conv plus relu</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=341" target="_blank">00:05:41.400</a></span> | <span class="t">has kind of a, I'm calling it bias, but actually I'm taking that general relu and just saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=348" target="_blank">00:05:48.280</a></span> | <span class="t">like, how much are we subtracting from it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=351" target="_blank">00:05:51.480</a></span> | <span class="t">So this is kind of like something we can add or remove.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=356" target="_blank">00:05:56.720</a></span> | <span class="t">And then the weight is just the conv weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=358" target="_blank">00:05:58.960</a></span> | <span class="t">And you'll see why we're doing this in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=361" target="_blank">00:06:01.220</a></span> | <span class="t">Basically what we'll do is we'll create our learner in the usual way, and however it initializes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=367" target="_blank">00:06:07.720</a></span> | <span class="t">is fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=369" target="_blank">00:06:09.380</a></span> | <span class="t">And so we can train it, that's fine, but let's try and now train it in a better way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=376" target="_blank">00:06:16.920</a></span> | <span class="t">So let's recreate our learner, and let's grab a single minibatch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=385" target="_blank">00:06:25.000</a></span> | <span class="t">And here's a function that will let us grab a single minibatch, making sure we're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=388" target="_blank">00:06:28.160</a></span> | <span class="t">all our callbacks that the minibatch does all the things we needed to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=391" target="_blank">00:06:31.120</a></span> | <span class="t">So here's one minibatch of X and Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=397" target="_blank">00:06:37.680</a></span> | <span class="t">And what we're going to do is we're going to find all of the modules that are, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=405" target="_blank">00:06:45.120</a></span> | <span class="t">going to find all of the modules which are of type conv layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=411" target="_blank">00:06:51.460</a></span> | <span class="t">And so it's just a little function that does that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=415" target="_blank">00:06:55.360</a></span> | <span class="t">And generally speaking, when you're working with PyTorch modules or with neural nets more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=420" target="_blank">00:07:00.800</a></span> | <span class="t">generally, you need to use recursion a lot because modules can contain modules, can contain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=425" target="_blank">00:07:05.000</a></span> | <span class="t">modules, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=426" target="_blank">00:07:06.000</a></span> | <span class="t">So you can see here, find modules, calls find modules to find out all the modules throughout</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=431" target="_blank">00:07:11.400</a></span> | <span class="t">your kind of tree, because really a module is like a tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=434" target="_blank">00:07:14.640</a></span> | <span class="t">Modules have modules have modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=437" target="_blank">00:07:17.960</a></span> | <span class="t">And so here's our list of all of our conv layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=440" target="_blank">00:07:20.820</a></span> | <span class="t">And then what we do is we create a hook, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=445" target="_blank">00:07:25.680</a></span> | <span class="t">And the hook is just going to grab the mean and standard deviation of a particular module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=451" target="_blank">00:07:31.200</a></span> | <span class="t">And so we can first of all just print those out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=453" target="_blank">00:07:33.640</a></span> | <span class="t">And we can see that the means and standard deviations are not zero one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=458" target="_blank">00:07:38.840</a></span> | <span class="t">The means are too high, as we know, because we've got the relues.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=464" target="_blank">00:07:44.480</a></span> | <span class="t">And the standard deviations are too low.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=469" target="_blank">00:07:49.460</a></span> | <span class="t">So rather than coming up with our perfect init, instead, we just create a loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=477" target="_blank">00:07:57.740</a></span> | <span class="t">And the loop calls the model, passing in that mini-batch we have, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=483" target="_blank">00:08:03.360</a></span> | <span class="t">And remember, this is -- so first of all, we hook it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=488" target="_blank">00:08:08.760</a></span> | <span class="t">And then we call the model in a while loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=492" target="_blank">00:08:12.800</a></span> | <span class="t">We check whether the mean, the absolute value of the mean is close to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=497" target="_blank">00:08:17.800</a></span> | <span class="t">And if it's not, we subtract the mean from the bias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=501" target="_blank">00:08:21.840</a></span> | <span class="t">And so it just keeps looping through, calling the model again with the hook, subtracting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=506" target="_blank">00:08:26.120</a></span> | <span class="t">from the bias until we get about zero mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=510" target="_blank">00:08:30.160</a></span> | <span class="t">And then we do the same thing for the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=512" target="_blank">00:08:32.960</a></span> | <span class="t">Keep checking whether standard deviation minus one is nearly zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=517" target="_blank">00:08:37.240</a></span> | <span class="t">And as long as it isn't, we'll keep dividing by the standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=522" target="_blank">00:08:42.100</a></span> | <span class="t">And so those two loops, if we run this function, then it's going to eventually give us what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=532" target="_blank">00:08:52.640</a></span> | <span class="t">we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=533" target="_blank">00:08:53.640</a></span> | <span class="t">Now, it's not perfect, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=535" target="_blank">00:08:55.240</a></span> | <span class="t">The means are still not quite zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=537" target="_blank">00:08:57.760</a></span> | <span class="t">Because we do the means first and then the standard deviations, and the standard deviation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=541" target="_blank">00:09:01.520</a></span> | <span class="t">changes will slightly change the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=543" target="_blank">00:09:03.640</a></span> | <span class="t">But you can see our standard deviations are perfectly one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=547" target="_blank">00:09:07.640</a></span> | <span class="t">And our means are pretty close.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=550" target="_blank">00:09:10.560</a></span> | <span class="t">And that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=551" target="_blank">00:09:11.560</a></span> | <span class="t">This is called LSUV.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=553" target="_blank">00:09:13.040</a></span> | <span class="t">And this is how, without thinking at all, you can initialize any neural network pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=560" target="_blank">00:09:20.440</a></span> | <span class="t">much to get the unit variance all the way through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=564" target="_blank">00:09:24.440</a></span> | <span class="t">And this is much easier than having to think about whether you've got ReLU or ELU or whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=570" target="_blank">00:09:30.920</a></span> | <span class="t">you've got dropout or whatever else.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=575" target="_blank">00:09:35.060</a></span> | <span class="t">So here's a super cool trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=576" target="_blank">00:09:36.720</a></span> | <span class="t">Yeah, and then we can train it, and it trains very nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=580" target="_blank">00:09:40.680</a></span> | <span class="t">Particularly useful for complex and deeper architectures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=584" target="_blank">00:09:44.400</a></span> | <span class="t">So there's kind of, for me, the fast AI approach to initializing your neural nets, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=592" target="_blank">00:09:52.040</a></span> | <span class="t">no math, no thinking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=594" target="_blank">00:09:54.920</a></span> | <span class="t">Just a simple little for loop, or in this case, a while loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=598" target="_blank">00:09:58.600</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=599" target="_blank">00:09:59.600</a></span> | <span class="t">So I think we've done enough with MNIST because we're getting really good results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=606" target="_blank">00:10:06.360</a></span> | <span class="t">It's running fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=607" target="_blank">00:10:07.360</a></span> | <span class="t">It's looking good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=608" target="_blank">00:10:08.360</a></span> | <span class="t">It's doing something harder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=612" target="_blank">00:10:12.260</a></span> | <span class="t">So what are we going to try?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=613" target="_blank">00:10:13.960</a></span> | <span class="t">Well, we're not quite ready to try ImageNet because ImageNet takes quite a lot of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=618" target="_blank">00:10:18.880</a></span> | <span class="t">You know, a few days if you've got just one GPU to train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=622" target="_blank">00:10:22.460</a></span> | <span class="t">And that's really frustrating and an expensive way to try to practice things or learn things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=628" target="_blank">00:10:28.060</a></span> | <span class="t">or try things out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=630" target="_blank">00:10:30.640</a></span> | <span class="t">I kept finding this problem of not knowing what data set I should try for my research</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=636" target="_blank">00:10:36.120</a></span> | <span class="t">or for my practice or for my learning.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=638" target="_blank">00:10:38.960</a></span> | <span class="t">You know, it seemed like at one end there was MNIST, which is kind of too easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=641" target="_blank">00:10:41.920</a></span> | <span class="t">There was sci-fi tan that a lot of people use, but these are 32 by 32 pixel images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=647" target="_blank">00:10:47.760</a></span> | <span class="t">And it turns out, and this is something I haven't seen really well written about, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=651" target="_blank">00:10:51.960</a></span> | <span class="t">our research clearly shows, it turns out that small images, 32 by 32, have very different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=657" target="_blank">00:10:57.800</a></span> | <span class="t">characteristics to larger images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=660" target="_blank">00:11:00.920</a></span> | <span class="t">And specifically, it seems like once you get beneath about 96 by 96, things behave really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=665" target="_blank">00:11:05.600</a></span> | <span class="t">differently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=666" target="_blank">00:11:06.600</a></span> | <span class="t">So stuff that works well on sci-fi tan tends not to work well on normal sized images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=671" target="_blank">00:11:11.640</a></span> | <span class="t">Because 32 by 32 is tiny, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=674" target="_blank">00:11:14.840</a></span> | <span class="t">And stuff that tends to work well on sci-fi tan doesn't necessarily work well on ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=680" target="_blank">00:11:20.440</a></span> | <span class="t">There's this kind of gap of like something with normal sized images, which I can train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=687" target="_blank">00:11:27.520</a></span> | <span class="t">in a sane amount of time, but also gives me a good sense of whether something's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=692" target="_blank">00:11:32.880</a></span> | <span class="t">to work well or not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=693" target="_blank">00:11:33.880</a></span> | <span class="t">And actually, Dimitro, who wrote that LSUV paper we just looked at, also had a fantastic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=700" target="_blank">00:11:40.960</a></span> | <span class="t">paper called systematic evaluation, something like systematic evaluation of convolutional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=706" target="_blank">00:11:46.800</a></span> | <span class="t">neural networks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=708" target="_blank">00:11:48.120</a></span> | <span class="t">And he noticed that if you use 128 by 128 images with ImageNet, then the kind of things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=715" target="_blank">00:11:55.680</a></span> | <span class="t">that he found works well or doesn't work well, all of those discoveries applied equally well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=721" target="_blank">00:12:01.240</a></span> | <span class="t">to the full sized ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=724" target="_blank">00:12:04.120</a></span> | <span class="t">Still takes too long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=725" target="_blank">00:12:05.120</a></span> | <span class="t">128 by 128 for 1.3 million images, still too long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=729" target="_blank">00:12:09.760</a></span> | <span class="t">So I thought that was a good step, but I wanted to go even further.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=732" target="_blank">00:12:12.840</a></span> | <span class="t">So I tried creating two new data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=737" target="_blank">00:12:17.120</a></span> | <span class="t">And my two new data sets are subsets of ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=741" target="_blank">00:12:21.760</a></span> | <span class="t">And there's kind of like multiple versions in here, it really is, but they're both subsets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=745" target="_blank">00:12:25.880</a></span> | <span class="t">of ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=747" target="_blank">00:12:27.200</a></span> | <span class="t">They both contain just 10 classes out of 1,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=750" target="_blank">00:12:30.160</a></span> | <span class="t">So they're 1/100 of the number of images of ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=754" target="_blank">00:12:34.160</a></span> | <span class="t">And I create a number of versions, full size, 320 pixel size, and 160 pixel size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=761" target="_blank">00:12:41.160</a></span> | <span class="t">One data set is specifically designed to be easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=764" target="_blank">00:12:44.360</a></span> | <span class="t">It contains 10 classes that are all very different to each other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=770" target="_blank">00:12:50.360</a></span> | <span class="t">So this is like my starting point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=771" target="_blank">00:12:51.720</a></span> | <span class="t">I thought, well, what if I create this data set, then maybe I could train it for like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=775" target="_blank">00:12:55.480</a></span> | <span class="t">just an epoch or two, like just a couple of minutes and see whether something was going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=780" target="_blank">00:13:00.120</a></span> | <span class="t">to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=781" target="_blank">00:13:01.720</a></span> | <span class="t">And then the second one I created was one designed to be hard, which is 10 categories</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=788" target="_blank">00:13:08.280</a></span> | <span class="t">that are designed to be very similar to each other, so they're all dog breeds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=792" target="_blank">00:13:12.100</a></span> | <span class="t">So the first data set is called ImageNet, which is very French, as you can hear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=799" target="_blank">00:13:19.080</a></span> | <span class="t">And there's some helpful pronunciation tips here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=802" target="_blank">00:13:22.280</a></span> | <span class="t">And the second is called ImageWolf.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=806" target="_blank">00:13:26.200</a></span> | <span class="t">And you can see here I've created a leaderboard for ImageNet and for ImageWolf.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=814" target="_blank">00:13:34.600</a></span> | <span class="t">And I've discovered that in my very quick experiments with this, the exact observations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=820" target="_blank">00:13:40.440</a></span> | <span class="t">I find about what works well for the full ImageNet, also I see the same results here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=826" target="_blank">00:13:46.800</a></span> | <span class="t">And it's also fascinating to see how some things are the same between the two data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=834" target="_blank">00:13:54.240</a></span> | <span class="t">and some are different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=835" target="_blank">00:13:55.940</a></span> | <span class="t">And I found working with these two data sets has given me more insight into computer vision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=843" target="_blank">00:14:03.200</a></span> | <span class="t">model training than anything else that I've done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=847" target="_blank">00:14:07.680</a></span> | <span class="t">So check them out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=849" target="_blank">00:14:09.600</a></span> | <span class="t">And I really wanted to mention this to say, a big part of getting good at using deep learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=855" target="_blank">00:14:15.840</a></span> | <span class="t">in your domain is knowing how to create like small, workable, useful data sets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=863" target="_blank">00:14:23.280</a></span> | <span class="t">So once I decided to make this, it took me about three hours.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=866" target="_blank">00:14:26.120</a></span> | <span class="t">Like, it's not at all hard to create a data set, it's a quick little Python script to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=871" target="_blank">00:14:31.200</a></span> | <span class="t">grab the things I wanted.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=873" target="_blank">00:14:33.080</a></span> | <span class="t">How did I decide which 10 things, I just looked at a list of categories and picked 10 things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=878" target="_blank">00:14:38.920</a></span> | <span class="t">that I knew are different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=879" target="_blank">00:14:39.920</a></span> | <span class="t">How did I decide to pick these things, I just looked at 10 things that I knew are dogs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=886" target="_blank">00:14:46.440</a></span> | <span class="t">So it's like just a case of like, throw something together, get it working, and then on your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=892" target="_blank">00:14:52.200</a></span> | <span class="t">domain area, whether it's audio or Sanskrit texts or whatever, or genomic sequences, try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=899" target="_blank">00:14:59.920</a></span> | <span class="t">to come up with your version of a toy problem or two which you hope might give insight into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=906" target="_blank">00:15:06.000</a></span> | <span class="t">your full problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=907" target="_blank">00:15:07.160</a></span> | <span class="t">So this has been super helpful for me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=909" target="_blank">00:15:09.640</a></span> | <span class="t">And if you're interested in computer vision, I would strongly recommend trying this out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=913" target="_blank">00:15:13.720</a></span> | <span class="t">And specifically, try to beat me, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=915" target="_blank">00:15:15.600</a></span> | <span class="t">Because trying to beat me, and these are not great, they're just okay, but trying to beat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=919" target="_blank">00:15:19.800</a></span> | <span class="t">me will give you a sense of whether the things you're thinking about are in the ballpark</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=926" target="_blank">00:15:26.480</a></span> | <span class="t">of what a moderately competent practitioner is able to do in a small amount of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=932" target="_blank">00:15:32.920</a></span> | <span class="t">It's also interesting to see that with like a 1/100th the size of ImageNet, like a tiny</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=939" target="_blank">00:15:39.600</a></span> | <span class="t">data set, I was able to create a 90% accurate dog breed classifier from random weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=945" target="_blank">00:15:45.980</a></span> | <span class="t">So like you can do a lot pretty quickly without much data, even if you don't have transfer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=951" target="_blank">00:15:51.160</a></span> | <span class="t">learning, which is kind of amazing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=953" target="_blank">00:15:53.960</a></span> | <span class="t">So we're going to use this data set now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=955" target="_blank">00:15:55.760</a></span> | <span class="t">Oh, sorry, you had a question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=958" target="_blank">00:15:58.080</a></span> | <span class="t">So before we look at the data set, let's do the question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=961" target="_blank">00:16:01.160</a></span> | <span class="t">Sorry, Rachel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=963" target="_blank">00:16:03.000</a></span> | <span class="t">>> So just to confirm, LSUV is something you run on all the layers once at the beginning,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=970" target="_blank">00:16:10.040</a></span> | <span class="t">not during training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=971" target="_blank">00:16:11.480</a></span> | <span class="t">What if your batch size is small?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=973" target="_blank">00:16:13.000</a></span> | <span class="t">Would you overfit to that batch?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=976" target="_blank">00:16:16.560</a></span> | <span class="t">>> Yeah, that's right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=979" target="_blank">00:16:19.760</a></span> | <span class="t">So you'd run it once at the start of training to initialize your weights, just so that that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=985" target="_blank">00:16:25.120</a></span> | <span class="t">initial set of steps gives you sensible gradients, because it's those first few mini batches</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=991" target="_blank">00:16:31.200</a></span> | <span class="t">that are everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=992" target="_blank">00:16:32.200</a></span> | <span class="t">Remember how we saw that if we didn't have a very good first few mini batches that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=997" target="_blank">00:16:37.080</a></span> | <span class="t">ended up with 90% of the weights being, 90% of the activations being inactive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1003" target="_blank">00:16:43.320</a></span> | <span class="t">So that's why we want to make sure we start well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1007" target="_blank">00:16:47.200</a></span> | <span class="t">And yeah, if you've got a small mini batch, just run five mini batches and take the mean.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1011" target="_blank">00:16:51.960</a></span> | <span class="t">There's nothing special about the one mini batch, it's just a fast way to do the computation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1016" target="_blank">00:16:56.280</a></span> | <span class="t">It's not like we're doing any gradient descent or anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1018" target="_blank">00:16:58.840</a></span> | <span class="t">It's just a forward pass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1020" target="_blank">00:17:00.520</a></span> | <span class="t">Thanks, that was a good question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1025" target="_blank">00:17:05.160</a></span> | <span class="t">So ImageNet is too big to read it all into RAM at once.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1036" target="_blank">00:17:16.280</a></span> | <span class="t">It's not huge, but it's too big to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1038" target="_blank">00:17:18.240</a></span> | <span class="t">So we're going to need to be able to read it in one image at a time, which is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1042" target="_blank">00:17:22.120</a></span> | <span class="t">to be true of most of our deep learning projects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1044" target="_blank">00:17:24.800</a></span> | <span class="t">So we need some way to do that from scratch, because that's the rules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1051" target="_blank">00:17:31.040</a></span> | <span class="t">So let's start working through that process.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1053" target="_blank">00:17:33.360</a></span> | <span class="t">And in the process, we're going to end up building a data block API, which you're all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1058" target="_blank">00:17:38.000</a></span> | <span class="t">familiar with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1059" target="_blank">00:17:39.160</a></span> | <span class="t">But most people using the data block API feel familiar enough with it to do small tweaks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1065" target="_blank">00:17:45.880</a></span> | <span class="t">for things that they kind of know they can do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1068" target="_blank">00:17:48.160</a></span> | <span class="t">But most people I speak to don't know how to really change what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1074" target="_blank">00:17:54.080</a></span> | <span class="t">So by the end of this notebook, you'll see how incredibly simple the data block API is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1079" target="_blank">00:17:59.680</a></span> | <span class="t">And you'll be able to either write your own, maybe based on this one, or modify the one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1084" target="_blank">00:18:04.320</a></span> | <span class="t">in fast.ai, because this is a very direct translation of the one that's in fast.ai.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1092" target="_blank">00:18:12.480</a></span> | <span class="t">So you should be able to get going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1095" target="_blank">00:18:15.720</a></span> | <span class="t">So the first thing to do is to read in our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1099" target="_blank">00:18:19.760</a></span> | <span class="t">And we'll see a similar thing when we build fastai.audio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1104" target="_blank">00:18:24.320</a></span> | <span class="t">But whatever process you use, you're going to have to find some library that can read</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1108" target="_blank">00:18:28.480</a></span> | <span class="t">the kind of data that you want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1110" target="_blank">00:18:30.120</a></span> | <span class="t">So in our case, we have images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1112" target="_blank">00:18:32.320</a></span> | <span class="t">And there's a library called PIL, or Pillow, Python Imaging Library, which can read images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1117" target="_blank">00:18:37.520</a></span> | <span class="t">So let's import it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1119" target="_blank">00:18:39.680</a></span> | <span class="t">We'll grab the data set and untie it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1122" target="_blank">00:18:42.320</a></span> | <span class="t">Import pillow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1124" target="_blank">00:18:44.000</a></span> | <span class="t">And we want to see what's inside our ImageNet data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1131" target="_blank">00:18:51.160</a></span> | <span class="t">Typing list x.editor is far too complicated for me.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1134" target="_blank">00:18:54.600</a></span> | <span class="t">I just want to type ls.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1136" target="_blank">00:18:56.240</a></span> | <span class="t">So be lazy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1137" target="_blank">00:18:57.320</a></span> | <span class="t">This is how easy it is to add stuff to the standard library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1140" target="_blank">00:19:00.640</a></span> | <span class="t">You can just take the class and add a function to it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1144" target="_blank">00:19:04.040</a></span> | <span class="t">So now we have ls.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1146" target="_blank">00:19:06.920</a></span> | <span class="t">So here's ls.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1147" target="_blank">00:19:07.920</a></span> | <span class="t">So we've got a training and a validation directory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1151" target="_blank">00:19:11.840</a></span> | <span class="t">Within validation, we have one directory for each category.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1157" target="_blank">00:19:17.600</a></span> | <span class="t">And then if we look at one category, we could grab one file name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1162" target="_blank">00:19:22.560</a></span> | <span class="t">And if we look at one file name, we have a TENCH.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1167" target="_blank">00:19:27.120</a></span> | <span class="t">So if you want to know whether somebody is actually a deep learning practitioner, show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1171" target="_blank">00:19:31.360</a></span> | <span class="t">them this photo.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1172" target="_blank">00:19:32.680</a></span> | <span class="t">If they don't know it's a TENCH, they're lying to you, because this is the first category</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1176" target="_blank">00:19:36.240</a></span> | <span class="t">in ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1177" target="_blank">00:19:37.240</a></span> | <span class="t">So if you're ever using ImageNet, you know your TENCHs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1181" target="_blank">00:19:41.640</a></span> | <span class="t">They're generally being held up by middle-aged men, or sometimes they're in nets.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1188" target="_blank">00:19:48.520</a></span> | <span class="t">That's pretty much how it always looks in ImageNet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1192" target="_blank">00:19:52.860</a></span> | <span class="t">So that's why we have them in ImageNet too, because it's such a classic computer vision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1197" target="_blank">00:19:57.680</a></span> | <span class="t">fish.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1200" target="_blank">00:20:00.480</a></span> | <span class="t">We're cheating and importing NumPy for a moment, just so I can show you what an image contains,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1205" target="_blank">00:20:05.640</a></span> | <span class="t">just to turn it into an array so I can print it for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1208" target="_blank">00:20:08.940</a></span> | <span class="t">This is really important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1210" target="_blank">00:20:10.340</a></span> | <span class="t">It contains bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1211" target="_blank">00:20:11.840</a></span> | <span class="t">It contains numbers between 0 and 255 for the integer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1216" target="_blank">00:20:16.480</a></span> | <span class="t">They're not float.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1218" target="_blank">00:20:18.360</a></span> | <span class="t">So this is what we get when we load up an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1224" target="_blank">00:20:24.360</a></span> | <span class="t">And it's got a geometry, and it's got a number of channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1229" target="_blank">00:20:29.800</a></span> | <span class="t">And in this case, it's RGB, three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1234" target="_blank">00:20:34.120</a></span> | <span class="t">So we want to have some way to read in lots of images, which means we need to know what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1240" target="_blank">00:20:40.520</a></span> | <span class="t">images there are in this directory structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1244" target="_blank">00:20:44.240</a></span> | <span class="t">And in the full ImageNet, there's going to be 1.3 million of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1247" target="_blank">00:20:47.320</a></span> | <span class="t">So I need to be able to do that fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1249" target="_blank">00:20:49.120</a></span> | <span class="t">So the first thing we need to know is which things are images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1252" target="_blank">00:20:52.480</a></span> | <span class="t">So I need a list of image extensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1254" target="_blank">00:20:54.720</a></span> | <span class="t">Your computer already has a list of image extensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1257" target="_blank">00:20:57.000</a></span> | <span class="t">It's your MIME types database.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1260" target="_blank">00:21:00.160</a></span> | <span class="t">So you can query Python for your MIME types database for all of the images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1265" target="_blank">00:21:05.120</a></span> | <span class="t">So here's a list of the image extensions that my computer knows about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1269" target="_blank">00:21:09.960</a></span> | <span class="t">So now what I want to do is I want to loop through all the files in a directory and find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1275" target="_blank">00:21:15.840</a></span> | <span class="t">out which ones are one of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1278" target="_blank">00:21:18.560</a></span> | <span class="t">The fastest way to check whether something's in a list is to first of all turn it into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1282" target="_blank">00:21:22.200</a></span> | <span class="t">a set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1283" target="_blank">00:21:23.480</a></span> | <span class="t">And of course, therefore, we need Setify.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1286" target="_blank">00:21:26.600</a></span> | <span class="t">So Setify simply checks if it is a set, and if it is, it makes it one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1290" target="_blank">00:21:30.440</a></span> | <span class="t">Otherwise, it first turns it into a list, and then turns it into a set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1294" target="_blank">00:21:34.720</a></span> | <span class="t">So that's how we can setify things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1297" target="_blank">00:21:37.000</a></span> | <span class="t">And here's what I do when I build a little bit of functionality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1299" target="_blank">00:21:39.720</a></span> | <span class="t">I just throw together a quick bunch of tests to make sure it seems to be roughly doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1304" target="_blank">00:21:44.320</a></span> | <span class="t">the right thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1305" target="_blank">00:21:45.320</a></span> | <span class="t">And do you remember, in lesson one, we created our own test framework.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1309" target="_blank">00:21:49.480</a></span> | <span class="t">So we can now run any notebook as a test suite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1313" target="_blank">00:21:53.700</a></span> | <span class="t">So it will automatically check if we break this at some point.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1317" target="_blank">00:21:57.160</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1318" target="_blank">00:21:58.160</a></span> | <span class="t">So now we need a way to go through a single directory and grab all of the images in that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1325" target="_blank">00:22:05.920</a></span> | <span class="t">So here we can say get files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1329" target="_blank">00:22:09.320</a></span> | <span class="t">I always like to make sure that you can pass any of these things, either a path, lib path,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1333" target="_blank">00:22:13.720</a></span> | <span class="t">or a string, to make it convenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1336" target="_blank">00:22:16.280</a></span> | <span class="t">So if you just say p equals path p, if it's already a path, lib object, that doesn't do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1341" target="_blank">00:22:21.840</a></span> | <span class="t">anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1342" target="_blank">00:22:22.840</a></span> | <span class="t">So this is a nice, easy way to make sure that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1345" target="_blank">00:22:25.620</a></span> | <span class="t">So we just go through-- here's our path, lib object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1353" target="_blank">00:22:33.640</a></span> | <span class="t">And so you'll see in a moment how we actually grab the list of files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1356" target="_blank">00:22:36.240</a></span> | <span class="t">But this is our parent directory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1357" target="_blank">00:22:37.800</a></span> | <span class="t">This is going to be our list of files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1359" target="_blank">00:22:39.680</a></span> | <span class="t">We go through the list of files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1361" target="_blank">00:22:41.120</a></span> | <span class="t">We check that it doesn't start with dot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1362" target="_blank">00:22:42.560</a></span> | <span class="t">If it does, that's a Unix hidden file, or a Mac hidden file.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1367" target="_blank">00:22:47.680</a></span> | <span class="t">And we also check either they didn't ask for some particular extensions, or that the extension</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1372" target="_blank">00:22:52.320</a></span> | <span class="t">is in the list of extensions we asked for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1375" target="_blank">00:22:55.320</a></span> | <span class="t">So that will allow us to grab just the image files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1380" target="_blank">00:23:00.480</a></span> | <span class="t">Python has something called Skander, which will grab a path and list all of the files</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1384" target="_blank">00:23:04.880</a></span> | <span class="t">in that path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1386" target="_blank">00:23:06.160</a></span> | <span class="t">So here is how we can call get files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1388" target="_blank">00:23:08.600</a></span> | <span class="t">We go Skander, and then we go get files, and it looks something like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1393" target="_blank">00:23:13.720</a></span> | <span class="t">So that's just for one directory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1396" target="_blank">00:23:16.580</a></span> | <span class="t">So we can put all this together like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1400" target="_blank">00:23:20.560</a></span> | <span class="t">And so this is something where we say, for some path, give me things with these extensions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1406" target="_blank">00:23:26.000</a></span> | <span class="t">optionally recurse, optionally only include these folder names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1410" target="_blank">00:23:30.520</a></span> | <span class="t">And this is it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1411" target="_blank">00:23:31.520</a></span> | <span class="t">OK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1412" target="_blank">00:23:32.520</a></span> | <span class="t">I will go through it in detail, but I'll just point out a couple of things, because being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1414" target="_blank">00:23:34.880</a></span> | <span class="t">able to rapidly look through files is important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1418" target="_blank">00:23:38.640</a></span> | <span class="t">The first is that Skander is super, super fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1421" target="_blank">00:23:41.920</a></span> | <span class="t">This is Python's thin wrapper over a C API.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1426" target="_blank">00:23:46.720</a></span> | <span class="t">So this is a really great way to quickly grab stuff for a single directory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1433" target="_blank">00:23:53.520</a></span> | <span class="t">If you need to recurse, check out os.walk.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1437" target="_blank">00:23:57.580</a></span> | <span class="t">This is the thing that uses Skander internally to walk recursively through a folder tree.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1444" target="_blank">00:24:04.560</a></span> | <span class="t">And you can do cool stuff like change the list of directories that it's going to look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1448" target="_blank">00:24:08.580</a></span> | <span class="t">at.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1451" target="_blank">00:24:11.340</a></span> | <span class="t">And it basically returns all the information that you need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1454" target="_blank">00:24:14.160</a></span> | <span class="t">It's super great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1455" target="_blank">00:24:15.160</a></span> | <span class="t">So os.walk and os.skander are the things that you want to be using if you're playing with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1459" target="_blank">00:24:19.880</a></span> | <span class="t">directories and files in Python, and you need it to be fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1466" target="_blank">00:24:26.060</a></span> | <span class="t">We do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1467" target="_blank">00:24:27.060</a></span> | <span class="t">So here's get files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1468" target="_blank">00:24:28.180</a></span> | <span class="t">And so now we can say get files, path, tench, just the image extensions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1473" target="_blank">00:24:33.640</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1475" target="_blank">00:24:35.540</a></span> | <span class="t">And then we're going to need recurse, because we've got a few levels of directory structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1480" target="_blank">00:24:40.200</a></span> | <span class="t">So here's recurse.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1482" target="_blank">00:24:42.480</a></span> | <span class="t">So if we try to get all of the file names, we have 13,000.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1487" target="_blank">00:24:47.620</a></span> | <span class="t">And specifically, it takes 70 milliseconds to get 13,000 file names.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1495" target="_blank">00:24:55.800</a></span> | <span class="t">For me to look at 13,000 files in Windows Explorer seems to take about four minutes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1503" target="_blank">00:25:03.080</a></span> | <span class="t">So this is unbelievably fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1506" target="_blank">00:25:06.120</a></span> | <span class="t">So the full image net, which is 100 times bigger, it's going to be literally just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1510" target="_blank">00:25:10.300</a></span> | <span class="t">few seconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1511" target="_blank">00:25:11.620</a></span> | <span class="t">So this gives you a sense of how incredibly fast these os.walk and skander functions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1517" target="_blank">00:25:17.240</a></span> | <span class="t">are.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1518" target="_blank">00:25:18.400</a></span> | <span class="t">Yes, questions are good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1523" target="_blank">00:25:23.720</a></span> | <span class="t">I've often been confused as to whether the code Jeremy is writing in the notebooks or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1527" target="_blank">00:25:27.600</a></span> | <span class="t">functionality that will be integrated into the fast AI library, or whether the functions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1532" target="_blank">00:25:32.520</a></span> | <span class="t">and classes are meant to be written and used by the user interactively and on the fly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1541" target="_blank">00:25:41.600</a></span> | <span class="t">Well I guess that's really a question about what's the purpose of this deep learning from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1545" target="_blank">00:25:45.920</a></span> | <span class="t">the foundations course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1549" target="_blank">00:25:49.040</a></span> | <span class="t">And different people will get different things out of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1551" target="_blank">00:25:51.080</a></span> | <span class="t">But for me, it's about demystifying what's going on so that you can take what's in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1558" target="_blank">00:25:58.600</a></span> | <span class="t">head and turn it into something real.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1561" target="_blank">00:26:01.980</a></span> | <span class="t">And to do that would be always some combination of using things that are in existing libraries,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1566" target="_blank">00:26:06.080</a></span> | <span class="t">which might be fast AI or PyTorch or TensorFlow or whatever, and partly will be things that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1571" target="_blank">00:26:11.400</a></span> | <span class="t">aren't in existing libraries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1572" target="_blank">00:26:12.400</a></span> | <span class="t">And I don't want you to be in a situation where you say, well, that's not in fast AI,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1577" target="_blank">00:26:17.440</a></span> | <span class="t">therefore I don't know how to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1579" target="_blank">00:26:19.880</a></span> | <span class="t">So really the goal is, this is why it's also called impractical deep learning for coders,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1585" target="_blank">00:26:25.640</a></span> | <span class="t">is to give you the underlying expertise and tools that you need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1591" target="_blank">00:26:31.880</a></span> | <span class="t">In practice, I would expect a lot of the stuff I'm showing you to end up in the fast AI library</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1598" target="_blank">00:26:38.560</a></span> | <span class="t">because that's like literally I'm showing you my research, basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1603" target="_blank">00:26:43.440</a></span> | <span class="t">This is like my research journal of the last six months.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1606" target="_blank">00:26:46.720</a></span> | <span class="t">And that's what happens is fast AI library is silver and I take our research and turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1611" target="_blank">00:26:51.360</a></span> | <span class="t">it into a library.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1613" target="_blank">00:26:53.580</a></span> | <span class="t">And some of it, like this function, is pretty much copied and pasted from the existing fast</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1618" target="_blank">00:26:58.800</a></span> | <span class="t">AI V1 code base because I spent at least a week figuring out how to make this fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1626" target="_blank">00:27:06.520</a></span> | <span class="t">I'm sure most people can do it faster, but I'm slow and it took me a long time, and this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1630" target="_blank">00:27:10.200</a></span> | <span class="t">is what I came up with.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1632" target="_blank">00:27:12.200</a></span> | <span class="t">So yeah, I mean, it's going to map pretty closely to what's in fast AI already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1640" target="_blank">00:27:20.840</a></span> | <span class="t">Where things are new, we're telling you, like running batch norm is new, today we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1644" target="_blank">00:27:24.440</a></span> | <span class="t">to be seeing a whole new kind of optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1647" target="_blank">00:27:27.560</a></span> | <span class="t">But otherwise things are going to be pretty similar to what's in fast AI, so it'll make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1651" target="_blank">00:27:31.320</a></span> | <span class="t">you be able to quickly hack it fast AI V1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1655" target="_blank">00:27:35.400</a></span> | <span class="t">And as fast AI changes, it's not going to surprise you because you'll know what's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1660" target="_blank">00:27:40.280</a></span> | <span class="t">on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1661" target="_blank">00:27:41.280</a></span> | <span class="t">Sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1662" target="_blank">00:27:42.280</a></span> | <span class="t">>> How does Skander compare to glob?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1671" target="_blank">00:27:51.080</a></span> | <span class="t">>> Skander should be much faster than glob.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1673" target="_blank">00:27:53.920</a></span> | <span class="t">It's a little more awkward to work with because it doesn't try to do so much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1680" target="_blank">00:28:00.500</a></span> | <span class="t">It's the lowest level thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1681" target="_blank">00:28:01.880</a></span> | <span class="t">I suspect glob probably uses it behind the scenes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1687" target="_blank">00:28:07.080</a></span> | <span class="t">You should try.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1688" target="_blank">00:28:08.080</a></span> | <span class="t">Time it with glob, time it with Skander, probably depends how you use glob exactly.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1692" target="_blank">00:28:12.720</a></span> | <span class="t">But I remember I used to use glob and it was quite a bit slower.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1696" target="_blank">00:28:16.520</a></span> | <span class="t">And when I say quite a bit, you know, for those of you that have been using fast AI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1702" target="_blank">00:28:22.040</a></span> | <span class="t">for a while, you might have noticed that the speed at which you can grab the image net</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1707" target="_blank">00:28:27.340</a></span> | <span class="t">folder is some orders of magnitude faster than it used to be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1711" target="_blank">00:28:31.200</a></span> | <span class="t">So it's quite a big difference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1714" target="_blank">00:28:34.080</a></span> | <span class="t">Okay. So the reason that fast AI has a data blocks API and nobody else does is because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1724" target="_blank">00:28:44.400</a></span> | <span class="t">I got so frustrated in the last course at having to create every possible combination</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1729" target="_blank">00:28:49.200</a></span> | <span class="t">of independent and dependent variable that I actually sat back for a while and did some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1735" target="_blank">00:28:55.000</a></span> | <span class="t">thinking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1736" target="_blank">00:28:56.480</a></span> | <span class="t">And specifically, this is what I did when I thought was I wrote this down, it's like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1740" target="_blank">00:29:00.240</a></span> | <span class="t">what do you actually need to do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1743" target="_blank">00:29:03.160</a></span> | <span class="t">So let's go ahead and do these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1744" target="_blank">00:29:04.600</a></span> | <span class="t">So we've already got files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1746" target="_blank">00:29:06.480</a></span> | <span class="t">We need some way to split the validation set or multiple validation sets out, some way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1751" target="_blank">00:29:11.640</a></span> | <span class="t">to do labeling, optionally some augmentation, transform it to a tensor, make it into data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1758" target="_blank">00:29:18.440</a></span> | <span class="t">into batches, optionally transform the batches, and then combine the data loaders together</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1765" target="_blank">00:29:25.520</a></span> | <span class="t">into a data bunch and optionally add a test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1769" target="_blank">00:29:29.080</a></span> | <span class="t">And so when I wrote it down like that, I just went ahead and implemented an API for each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1773" target="_blank">00:29:33.940</a></span> | <span class="t">of those things to say like, okay, you can plug in anything you like to that part of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1777" target="_blank">00:29:37.920</a></span> | <span class="t">the API.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1778" target="_blank">00:29:38.920</a></span> | <span class="t">So let's do it, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1781" target="_blank">00:29:41.320</a></span> | <span class="t">So we've already got the basic functionality to get the files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1785" target="_blank">00:29:45.240</a></span> | <span class="t">So now we have to put them somewhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1788" target="_blank">00:29:48.120</a></span> | <span class="t">We already created that list container, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1791" target="_blank">00:29:51.560</a></span> | <span class="t">So we basically can just dump our files into a list container.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1795" target="_blank">00:29:55.680</a></span> | <span class="t">But in the end, what we actually want is an image list for this one, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1801" target="_blank">00:30:01.480</a></span> | <span class="t">And an image list, when you call, so we're going to have this get method and when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1805" target="_blank">00:30:05.720</a></span> | <span class="t">get something from the image list, it should open the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1810" target="_blank">00:30:10.120</a></span> | <span class="t">So pil.image.open is how you open an image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1813" target="_blank">00:30:13.600</a></span> | <span class="t">But we could get all kinds of different objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1816" target="_blank">00:30:16.800</a></span> | <span class="t">So therefore, we have this superclass, which has a get method that you override.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1822" target="_blank">00:30:22.640</a></span> | <span class="t">And by default, it just returns whatever you put in there, which in this case would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1826" target="_blank">00:30:26.280</a></span> | <span class="t">the file name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1829" target="_blank">00:30:29.320</a></span> | <span class="t">So this is basically all item list does, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1832" target="_blank">00:30:32.200</a></span> | <span class="t">It's got a list of items, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1834" target="_blank">00:30:34.880</a></span> | <span class="t">So in this case, it's going to be our file names, the path that they came from.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1840" target="_blank">00:30:40.160</a></span> | <span class="t">And then optionally also, there could be a list of transforms, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1844" target="_blank">00:30:44.040</a></span> | <span class="t">And transforms are some kind of functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1846" target="_blank">00:30:46.960</a></span> | <span class="t">And we'll look at this in more detail in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1848" target="_blank">00:30:48.800</a></span> | <span class="t">But basically, what will happen is, when you index into your item list, remember, done_to_get_item</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1855" target="_blank">00:30:55.200</a></span> | <span class="t">does that, we'll pass that back up to list container, get_item, and that will return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1861" target="_blank">00:31:01.200</a></span> | <span class="t">either a single item or a list of items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1865" target="_blank">00:31:05.400</a></span> | <span class="t">And if it's a single item, we'll just call self._get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1869" target="_blank">00:31:09.320</a></span> | <span class="t">If it's a list of items, we'll call self._get on all of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1873" target="_blank">00:31:13.440</a></span> | <span class="t">And what that's going to do is it's going to call the get method, which in the case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1878" target="_blank">00:31:18.960</a></span> | <span class="t">of an image list will open the image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1881" target="_blank">00:31:21.680</a></span> | <span class="t">And then it will compose the transforms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1885" target="_blank">00:31:25.120</a></span> | <span class="t">So for those of you that haven't done any kind of more functional-style programming,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1889" target="_blank">00:31:29.720</a></span> | <span class="t">compose is just a concept that says, go through a list of functions and call the function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1900" target="_blank">00:31:40.720</a></span> | <span class="t">and replace myself with a result of that, and then call the next function and replace</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1905" target="_blank">00:31:45.760</a></span> | <span class="t">myself with a result of that, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1908" target="_blank">00:31:48.400</a></span> | <span class="t">So in other words, a deep neural network is just a composition of functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1913" target="_blank">00:31:53.480</a></span> | <span class="t">Each layer is a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1915" target="_blank">00:31:55.080</a></span> | <span class="t">We compose them all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1916" target="_blank">00:31:56.840</a></span> | <span class="t">This compose does a little bit more than most composers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1920" target="_blank">00:32:00.040</a></span> | <span class="t">Specifically, you can optionally say, I want to order them in some way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1925" target="_blank">00:32:05.800</a></span> | <span class="t">And it checks to see whether the things have an underscore order key and sorts them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1932" target="_blank">00:32:12.040</a></span> | <span class="t">And also, you could pass in some keyword arguments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1934" target="_blank">00:32:14.560</a></span> | <span class="t">And if you do, it'll just keep passing in those keyword arguments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1937" target="_blank">00:32:17.480</a></span> | <span class="t">But it's basically other than that, it's a pretty standard function composition function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1942" target="_blank">00:32:22.760</a></span> | <span class="t">If you haven't seen compose used elsewhere in programming before, Google that because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1949" target="_blank">00:32:29.200</a></span> | <span class="t">it's a super useful concept.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1951" target="_blank">00:32:31.800</a></span> | <span class="t">Comes up all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1952" target="_blank">00:32:32.800</a></span> | <span class="t">We use it all the time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1953" target="_blank">00:32:33.800</a></span> | <span class="t">And as you can see in this case, it means I can just pass in a list of transforms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1957" target="_blank">00:32:37.840</a></span> | <span class="t">And this will simply call each of those transforms in turn modifying, in this case, the image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1965" target="_blank">00:32:45.160</a></span> | <span class="t">that I had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1966" target="_blank">00:32:46.200</a></span> | <span class="t">So here's how you create an image list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1969" target="_blank">00:32:49.120</a></span> | <span class="t">And then here's a method to create an image list from a path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1975" target="_blank">00:32:55.760</a></span> | <span class="t">And it's just going to call that get files.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1978" target="_blank">00:32:58.060</a></span> | <span class="t">And then that's going to give us a list of files, which we will then pass to the class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1982" target="_blank">00:33:02.800</a></span> | <span class="t">constructor which expects a list of files or a list of something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1987" target="_blank">00:33:07.720</a></span> | <span class="t">So this is basically the same as item list in fast.io version 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1993" target="_blank">00:33:13.140</a></span> | <span class="t">It's just a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=1997" target="_blank">00:33:17.240</a></span> | <span class="t">It's just a list where when you try to index into it, it will call something which subclasses</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2003" target="_blank">00:33:23.040</a></span> | <span class="t">override.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2005" target="_blank">00:33:25.440</a></span> | <span class="t">So now we've got an image list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2010" target="_blank">00:33:30.800</a></span> | <span class="t">We can use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2013" target="_blank">00:33:33.160</a></span> | <span class="t">Now one thing that happens all the time is you try to create a mini batch of images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2019" target="_blank">00:33:39.920</a></span> | <span class="t">But one of your images was black and white.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2022" target="_blank">00:33:42.860</a></span> | <span class="t">And when pillow opens up a black and white image, it gives you back by default a reg2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2030" target="_blank">00:33:50.720</a></span> | <span class="t">tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2031" target="_blank">00:33:51.720</a></span> | <span class="t">Just the X and Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2032" target="_blank">00:33:52.720</a></span> | <span class="t">No channel access.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2035" target="_blank">00:33:55.140</a></span> | <span class="t">And then you can't stack them into a mini batch because they're not all the same shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2041" target="_blank">00:34:01.000</a></span> | <span class="t">So what you can do is you can call the pillow.convert and RGB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2047" target="_blank">00:34:07.680</a></span> | <span class="t">And if something's not RGB, it'll turn it into RGB.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2051" target="_blank">00:34:11.920</a></span> | <span class="t">So here's our first transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2055" target="_blank">00:34:15.600</a></span> | <span class="t">So a transform is just a class with an underscore order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2059" target="_blank">00:34:19.120</a></span> | <span class="t">And then make RGB is a transform that when you call it will call convert.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2063" target="_blank">00:34:23.960</a></span> | <span class="t">Or you can just do it this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2065" target="_blank">00:34:25.560</a></span> | <span class="t">Make it a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2067" target="_blank">00:34:27.000</a></span> | <span class="t">Both is fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2068" target="_blank">00:34:28.320</a></span> | <span class="t">These are both going to do the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2070" target="_blank">00:34:30.640</a></span> | <span class="t">And this is often the case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2072" target="_blank">00:34:32.560</a></span> | <span class="t">We've seen it a bunch of times before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2073" target="_blank">00:34:33.720</a></span> | <span class="t">You can have done to call or you can have a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2077" target="_blank">00:34:37.280</a></span> | <span class="t">So here's our first transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2081" target="_blank">00:34:41.200</a></span> | <span class="t">And so here's the simplest version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2082" target="_blank">00:34:42.200</a></span> | <span class="t">It's just a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2083" target="_blank">00:34:43.840</a></span> | <span class="t">And so if we create a image list from files using our path and pass in that transform,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2091" target="_blank">00:34:51.560</a></span> | <span class="t">and now we have an item list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2094" target="_blank">00:34:54.320</a></span> | <span class="t">And remember that item list inherits from list container, which we gave a dunder rep</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2100" target="_blank">00:35:00.360</a></span> | <span class="t">or two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2101" target="_blank">00:35:01.360</a></span> | <span class="t">So it's going to give us nice printing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2103" target="_blank">00:35:03.920</a></span> | <span class="t">This is why we create these little convenient things to subclass from because we get all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2109" target="_blank">00:35:09.120</a></span> | <span class="t">this behavior for free.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2110" target="_blank">00:35:10.840</a></span> | <span class="t">So we can now see that we've got 13,000 items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2113" target="_blank">00:35:13.720</a></span> | <span class="t">And here's a few of them is the path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2117" target="_blank">00:35:17.720</a></span> | <span class="t">And we can index into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2119" target="_blank">00:35:19.520</a></span> | <span class="t">And when we index into it, it calls get and get calls image dot open and pillow automatically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2127" target="_blank">00:35:27.440</a></span> | <span class="t">displays images in Jupiter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2129" target="_blank">00:35:29.240</a></span> | <span class="t">And so there it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2130" target="_blank">00:35:30.640</a></span> | <span class="t">And this, of course, is a man with a -- yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2135" target="_blank">00:35:35.600</a></span> | <span class="t">Thank you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2136" target="_blank">00:35:36.600</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2137" target="_blank">00:35:37.600</a></span> | <span class="t">He looks very happy with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2138" target="_blank">00:35:38.600</a></span> | <span class="t">We're going to be seeing him a lot.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2142" target="_blank">00:35:42.720</a></span> | <span class="t">And because we're using the functionality that we wrote last time for list container,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2147" target="_blank">00:35:47.640</a></span> | <span class="t">we can also index with a list of booleans, with a slice, with a list of ints and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2155" target="_blank">00:35:55.120</a></span> | <span class="t">So here's a slice containing one item, for instance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2159" target="_blank">00:35:59.560</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2160" target="_blank">00:36:00.720</a></span> | <span class="t">So that's step one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2162" target="_blank">00:36:02.860</a></span> | <span class="t">Step two, split validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2166" target="_blank">00:36:06.600</a></span> | <span class="t">So to do that, we look and we see here's a path.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2171" target="_blank">00:36:11.360</a></span> | <span class="t">Here's the file name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2173" target="_blank">00:36:13.240</a></span> | <span class="t">Here's the parent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2174" target="_blank">00:36:14.840</a></span> | <span class="t">Here's the grandparent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2176" target="_blank">00:36:16.840</a></span> | <span class="t">So here's the grandparent's name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2179" target="_blank">00:36:19.560</a></span> | <span class="t">That's the thing we use to split.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2181" target="_blank">00:36:21.960</a></span> | <span class="t">So let's create a function called grandparent splitter that grabs the grandparent's name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2187" target="_blank">00:36:27.540</a></span> | <span class="t">And you call it, telling it the name of your validation set and the name of your training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2190" target="_blank">00:36:30.960</a></span> | <span class="t">set, and it returns true if it's the validation set or false if it's the training set or none</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2199" target="_blank">00:36:39.480</a></span> | <span class="t">if it's neither.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2201" target="_blank">00:36:41.720</a></span> | <span class="t">And so here's something that will create a mask containing you pass it some function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2209" target="_blank">00:36:49.080</a></span> | <span class="t">So we're going to be using grandparent splitter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2211" target="_blank">00:36:51.440</a></span> | <span class="t">And it will just grab all the things where that mask is false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2214" target="_blank">00:36:54.880</a></span> | <span class="t">That's the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2215" target="_blank">00:36:55.880</a></span> | <span class="t">All the things where the mask is true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2217" target="_blank">00:36:57.440</a></span> | <span class="t">That's the validation set and will return them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2220" target="_blank">00:37:00.000</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2221" target="_blank">00:37:01.000</a></span> | <span class="t">So there's our splitter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2222" target="_blank">00:37:02.800</a></span> | <span class="t">Remember we used partial.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2224" target="_blank">00:37:04.940</a></span> | <span class="t">So here's a splitter that splits on grandparents.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2228" target="_blank">00:37:08.080</a></span> | <span class="t">And where the validation name is val because that's what it is for image net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2234" target="_blank">00:37:14.400</a></span> | <span class="t">And let's check that that seems to work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2236" target="_blank">00:37:16.800</a></span> | <span class="t">Yes, it does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2237" target="_blank">00:37:17.800</a></span> | <span class="t">We've now got a validation set with 500 things and a training set with 12,800 things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2244" target="_blank">00:37:24.040</a></span> | <span class="t">So that's looking good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2246" target="_blank">00:37:26.640</a></span> | <span class="t">So let's use it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2248" target="_blank">00:37:28.360</a></span> | <span class="t">So split data object is just something with a training set and a validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2253" target="_blank">00:37:33.240</a></span> | <span class="t">You pass it in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2254" target="_blank">00:37:34.240</a></span> | <span class="t">You save them away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2257" target="_blank">00:37:37.120</a></span> | <span class="t">And then that's basically it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2261" target="_blank">00:37:41.240</a></span> | <span class="t">Everything else from here is just convenience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2264" target="_blank">00:37:44.160</a></span> | <span class="t">So we'll give it a representation so that you can print it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2268" target="_blank">00:37:48.480</a></span> | <span class="t">We'll define done to get attribute so that if you pass it some attribute that it doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2272" target="_blank">00:37:52.320</a></span> | <span class="t">know about, it will grab it from the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2276" target="_blank">00:37:56.860</a></span> | <span class="t">And then let's add a split by func method that just calls that split by func thing we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2285" target="_blank">00:38:05.760</a></span> | <span class="t">just had.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2286" target="_blank">00:38:06.760</a></span> | <span class="t">There's one trick here, though, which is we want split by func to return item lists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2293" target="_blank">00:38:13.720</a></span> | <span class="t">of the same type that we gave it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2297" target="_blank">00:38:17.240</a></span> | <span class="t">In this case, it would be an image list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2300" target="_blank">00:38:20.240</a></span> | <span class="t">So we call item list dot new.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2303" target="_blank">00:38:23.560</a></span> | <span class="t">And that's why in our item list, we defined something called new.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2313" target="_blank">00:38:33.080</a></span> | <span class="t">And this is a really handy trick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2315" target="_blank">00:38:35.480</a></span> | <span class="t">PyTorch has the concept of a new method as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2319" target="_blank">00:38:39.400</a></span> | <span class="t">It says, all right, let's look at this object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2322" target="_blank">00:38:42.240</a></span> | <span class="t">Let's see what class it is, because it might not be item list, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2325" target="_blank">00:38:45.200</a></span> | <span class="t">It might be image list or some other subclass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2327" target="_blank">00:38:47.720</a></span> | <span class="t">It doesn't exist yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2329" target="_blank">00:38:49.880</a></span> | <span class="t">And this is now the constructor for that class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2333" target="_blank">00:38:53.000</a></span> | <span class="t">And let's just pass it in the items that we asked for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2336" target="_blank">00:38:56.720</a></span> | <span class="t">And then pass in our path and our transforms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2339" target="_blank">00:38:59.680</a></span> | <span class="t">So new is going to create a new item list of the same type with the same path and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2345" target="_blank">00:39:05.240</a></span> | <span class="t">same transforms, but with these new items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2348" target="_blank">00:39:08.360</a></span> | <span class="t">And so that's why this is now going to give us a training set and a validation set with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2357" target="_blank">00:39:17.680</a></span> | <span class="t">the same path, the same transforms, and the same type.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2360" target="_blank">00:39:20.640</a></span> | <span class="t">And so if we call split data split by func, now you can see we've got our training set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2365" target="_blank">00:39:25.880</a></span> | <span class="t">and our validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2368" target="_blank">00:39:28.520</a></span> | <span class="t">Easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2370" target="_blank">00:39:30.480</a></span> | <span class="t">So next in our list of things to do is labeling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2377" target="_blank">00:39:37.080</a></span> | <span class="t">Labeling is a little more tricky.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2381" target="_blank">00:39:41.120</a></span> | <span class="t">And the reason it's tricky is because we need processes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2385" target="_blank">00:39:45.720</a></span> | <span class="t">Processes are things which are first applied to the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2389" target="_blank">00:39:49.760</a></span> | <span class="t">They get some state and then they get applied to the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2394" target="_blank">00:39:54.720</a></span> | <span class="t">For example, our labels should not be tench and French horn.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2402" target="_blank">00:40:02.440</a></span> | <span class="t">They should be like zero and two because when we go to do a cross entropy loss, we expect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2408" target="_blank">00:40:08.840</a></span> | <span class="t">to see a long there, not a string there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2412" target="_blank">00:40:12.680</a></span> | <span class="t">So we need to be able to map tench to zero or French horn to two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2418" target="_blank">00:40:18.480</a></span> | <span class="t">We need the training set to have the same mapping as the validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2422" target="_blank">00:40:22.960</a></span> | <span class="t">And for any inference we do in the future, it's going to have the same mapping as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2426" target="_blank">00:40:26.860</a></span> | <span class="t">Because otherwise, the different data sets are going to be talking about completely different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2432" target="_blank">00:40:32.160</a></span> | <span class="t">things when they see the number zero, for instance.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2435" target="_blank">00:40:35.680</a></span> | <span class="t">So we're going to create something called a vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2438" target="_blank">00:40:38.700</a></span> | <span class="t">And a vocab is just the list saying these are our classes and this is the order they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2443" target="_blank">00:40:43.560</a></span> | <span class="t">in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2444" target="_blank">00:40:44.560</a></span> | <span class="t">Zero is tench, one is golf ball, two is French horn, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2450" target="_blank">00:40:50.500</a></span> | <span class="t">So we're going to create the vocab from the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2454" target="_blank">00:40:54.400</a></span> | <span class="t">And then we're going to convert all those strings into ints using the vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2459" target="_blank">00:40:59.880</a></span> | <span class="t">And then we're going to do the same thing for the validation set, but we'll use the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2463" target="_blank">00:41:03.240</a></span> | <span class="t">training set's vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2466" target="_blank">00:41:06.040</a></span> | <span class="t">So that's an example of a processor that converts label strings to numbers in a consistent and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2472" target="_blank">00:41:12.240</a></span> | <span class="t">reproducible ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2474" target="_blank">00:41:14.520</a></span> | <span class="t">Other things we could do would be processing texts to tokenize them and then numericalize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2480" target="_blank">00:41:20.040</a></span> | <span class="t">them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2481" target="_blank">00:41:21.040</a></span> | <span class="t">Numericalizing them is a lot like converting the label strings to numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2484" target="_blank">00:41:24.560</a></span> | <span class="t">Or taking tabular data and filling the missing values with the median computed on the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2489" target="_blank">00:41:29.720</a></span> | <span class="t">set or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2491" target="_blank">00:41:31.680</a></span> | <span class="t">So most things we do in this labeling process is going to require some kind of processor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2500" target="_blank">00:41:40.680</a></span> | <span class="t">So in our case, we want a processor that can convert label strings to numbers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2504" target="_blank">00:41:44.960</a></span> | <span class="t">So the first thing we need to know is what are all of the possible labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2508" target="_blank">00:41:48.880</a></span> | <span class="t">And so therefore we need to know all the possible unique things in a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2513" target="_blank">00:41:53.020</a></span> | <span class="t">So here's some list, here's something that uniquifies them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2517" target="_blank">00:41:57.000</a></span> | <span class="t">So that's how we can get all the unique values of something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2523" target="_blank">00:42:03.040</a></span> | <span class="t">So now that we've got that, we can create a processor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2526" target="_blank">00:42:06.400</a></span> | <span class="t">And a processor is just something that can process some items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2531" target="_blank">00:42:11.200</a></span> | <span class="t">And so let's create a category processor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2534" target="_blank">00:42:14.240</a></span> | <span class="t">And this is the thing that's going to create our list of all of the possible categories.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2539" target="_blank">00:42:19.880</a></span> | <span class="t">So basically when you say process, we're going to see if there's a vocab yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2545" target="_blank">00:42:25.640</a></span> | <span class="t">And if there's not, this must be the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2548" target="_blank">00:42:28.700</a></span> | <span class="t">So we'll create a vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2550" target="_blank">00:42:30.200</a></span> | <span class="t">And it's just the unique values of all the items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2554" target="_blank">00:42:34.200</a></span> | <span class="t">And then we'll create the thing that goes not from int to object, but goes from object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2558" target="_blank">00:42:38.320</a></span> | <span class="t">to int.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2559" target="_blank">00:42:39.320</a></span> | <span class="t">So it's the reverse mapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2560" target="_blank">00:42:40.320</a></span> | <span class="t">So we just enumerate the vocabulary and create a dictionary with the reverse mapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2566" target="_blank">00:42:46.120</a></span> | <span class="t">So now that we have a vocab, we can then go through all the items and process one of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2572" target="_blank">00:42:52.600</a></span> | <span class="t">at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2574" target="_blank">00:42:54.200</a></span> | <span class="t">And process one of them simply means look in that reverse mapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2579" target="_blank">00:42:59.840</a></span> | <span class="t">We could also deprocess, which would take a bunch of indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2583" target="_blank">00:43:03.040</a></span> | <span class="t">We would use this, for example, to print out the inferences that we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2589" target="_blank">00:43:09.060</a></span> | <span class="t">So we better make sure we get a vocab by now, otherwise we can't do anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2593" target="_blank">00:43:13.080</a></span> | <span class="t">And then we just deprocess one for each index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2597" target="_blank">00:43:17.240</a></span> | <span class="t">And deprocess one just looks it up in the vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2601" target="_blank">00:43:21.060</a></span> | <span class="t">So that's all we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2603" target="_blank">00:43:23.800</a></span> | <span class="t">And so with this, we can now combine it all together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2606" target="_blank">00:43:26.520</a></span> | <span class="t">And let's create a processed item list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2609" target="_blank">00:43:29.560</a></span> | <span class="t">And it's just a list container that contains a processor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2614" target="_blank">00:43:34.600</a></span> | <span class="t">And the items in it, whatever we were given after being processed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2621" target="_blank">00:43:41.200</a></span> | <span class="t">And so then, as well as being able to index in it to grab those processed items, we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2626" target="_blank">00:43:46.840</a></span> | <span class="t">also define something called object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2629" target="_blank">00:43:49.120</a></span> | <span class="t">And that's just the thing that's going to deprocess the items again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2634" target="_blank">00:43:54.720</a></span> | <span class="t">So that's all the stuff we need to label things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2641" target="_blank">00:44:01.200</a></span> | <span class="t">So we already know that for splitting, we needed the grandparent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2647" target="_blank">00:44:07.440</a></span> | <span class="t">For labeling, we need the parent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2651" target="_blank">00:44:11.200</a></span> | <span class="t">So here's a parent labeler.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2656" target="_blank">00:44:16.240</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2658" target="_blank">00:44:18.240</a></span> | <span class="t">And here is something which labels things using a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2661" target="_blank">00:44:21.880</a></span> | <span class="t">It just calls a function for each thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2666" target="_blank">00:44:26.880</a></span> | <span class="t">And so here is our class, and we're going to have to pass it some independent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2672" target="_blank">00:44:32.800</a></span> | <span class="t">and some dependent variable and store them away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2676" target="_blank">00:44:36.920</a></span> | <span class="t">And then we need a indexer to grab the x and grab the y at those indexes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2683" target="_blank">00:44:43.420</a></span> | <span class="t">We need a length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2685" target="_blank">00:44:45.640</a></span> | <span class="t">We may as well make it print out nicely.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2688" target="_blank">00:44:48.960</a></span> | <span class="t">And then we'll just add something just like we did before, which does the labeling.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2694" target="_blank">00:44:54.840</a></span> | <span class="t">And passes those to a processed item list to grab the labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2700" target="_blank">00:45:00.880</a></span> | <span class="t">And then passes the inputs and outputs to our constructor to give us our label data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2709" target="_blank">00:45:09.280</a></span> | <span class="t">So that's basically it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2711" target="_blank">00:45:11.360</a></span> | <span class="t">So with that, we have a label by function where we can create our category processor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2717" target="_blank">00:45:17.520</a></span> | <span class="t">We can label the training set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2719" target="_blank">00:45:19.900</a></span> | <span class="t">We can label the validation set, and we can return the result, the split data result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2725" target="_blank">00:45:25.760</a></span> | <span class="t">So the main thing to notice here is that when we say train equals labeled data dot label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2733" target="_blank">00:45:33.240</a></span> | <span class="t">passing in this processor, this processor has no vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2737" target="_blank">00:45:37.480</a></span> | <span class="t">So it goes to that bit we saw that says, oh, there's no vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2740" target="_blank">00:45:40.560</a></span> | <span class="t">So let's create a list of all the unique possibilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2743" target="_blank">00:45:43.920</a></span> | <span class="t">On the other hand, when it goes to the validation set, proc now does have a vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2749" target="_blank">00:45:49.320</a></span> | <span class="t">So it will skip that step and use the training sets vocab.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2753" target="_blank">00:45:53.960</a></span> | <span class="t">So this is really important, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2755" target="_blank">00:45:55.680</a></span> | <span class="t">People get mixed up by this all the time in machine learning and deep learning is like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2760" target="_blank">00:46:00.440</a></span> | <span class="t">very often when somebody says, my model's no better than random.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2765" target="_blank">00:46:05.200</a></span> | <span class="t">The most common reason is that they're using some kind of different mapping between their</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2770" target="_blank">00:46:10.600</a></span> | <span class="t">training set and their validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2773" target="_blank">00:46:13.300</a></span> | <span class="t">So if you use a process like this, that's never going to happen because you're ensuring</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2777" target="_blank">00:46:17.880</a></span> | <span class="t">that you're always using the same mapping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2784" target="_blank">00:46:24.000</a></span> | <span class="t">So the details of the code are particularly important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2788" target="_blank">00:46:28.800</a></span> | <span class="t">The important idea is that your labeling process needs to include some kind of processor idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2798" target="_blank">00:46:38.360</a></span> | <span class="t">And if you're doing this stuff manually, which basically every other machine learning and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2804" target="_blank">00:46:44.600</a></span> | <span class="t">deep learning framework does, you're asking for difficult to fix bugs because anytime</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2811" target="_blank">00:46:51.460</a></span> | <span class="t">your computer's not doing something for you, it means you have to remember to do it yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2815" target="_blank">00:46:55.400</a></span> | <span class="t">So whatever framework you're using, I don't think, I don't know if any other frameworks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2822" target="_blank">00:47:02.200</a></span> | <span class="t">have something quite like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2823" target="_blank">00:47:03.600</a></span> | <span class="t">So like create something like this for yourself so that you don't have that problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2828" target="_blank">00:47:08.960</a></span> | <span class="t">All right, let's go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2834" target="_blank">00:47:14.280</a></span> | <span class="t">In the case of online streaming data, how do you deal with having new categories in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2838" target="_blank">00:47:18.520</a></span> | <span class="t">the test set that you don't see in training?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2841" target="_blank">00:47:21.280</a></span> | <span class="t">Yeah, I mean, great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2843" target="_blank">00:47:23.000</a></span> | <span class="t">It's not just online streaming data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2844" target="_blank">00:47:24.480</a></span> | <span class="t">I mean, it happens all the time is you do inference either on your validation set or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2849" target="_blank">00:47:29.760</a></span> | <span class="t">test set or in production where you see something you haven't seen before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2859" target="_blank">00:47:39.320</a></span> | <span class="t">For labels, it's less of a problem in inference because for inference, you don't have labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2864" target="_blank">00:47:44.240</a></span> | <span class="t">By definition, but you could certainly have that problem in your validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2870" target="_blank">00:47:50.360</a></span> | <span class="t">So what I tend to like to do is if I have like some kind of, if I have something where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2874" target="_blank">00:47:54.920</a></span> | <span class="t">there's lots and lots of categories and some of them don't occur very often and I know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2879" target="_blank">00:47:59.240</a></span> | <span class="t">that in the future there might be new categories appearing, I'll take the few least common</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2886" target="_blank">00:48:06.280</a></span> | <span class="t">and I'll group them together into a group called like other.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2890" target="_blank">00:48:10.680</a></span> | <span class="t">And that way I now have some way to ensure that my model can handle all these rare other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2894" target="_blank">00:48:14.880</a></span> | <span class="t">cases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2897" target="_blank">00:48:17.080</a></span> | <span class="t">Something like that tends to work pretty well, but you do have to think of it ahead of time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2902" target="_blank">00:48:22.600</a></span> | <span class="t">For many kinds of problems, you know that there's a fixed set of possibilities.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2909" target="_blank">00:48:29.240</a></span> | <span class="t">And if you know that it's not a fixed set, yeah, I would generally try to create an other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2914" target="_blank">00:48:34.400</a></span> | <span class="t">category with a few examples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2916" target="_blank">00:48:36.320</a></span> | <span class="t">So make sure you train with some things in that other category, all right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2924" target="_blank">00:48:44.240</a></span> | <span class="t">>> In the label data class, what is the class method decorator doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2930" target="_blank">00:48:50.400</a></span> | <span class="t">>> Sure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2933" target="_blank">00:48:53.520</a></span> | <span class="t">So I'll be quick because you can Google it, but basically this is the difference between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2937" target="_blank">00:48:57.440</a></span> | <span class="t">an instance method and a class method.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2939" target="_blank">00:48:59.760</a></span> | <span class="t">So you'll see it's not getting past self.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2942" target="_blank">00:49:02.880</a></span> | <span class="t">So you'll see that I'm not going to call this on an object of type label data, but I'm calling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2953" target="_blank">00:49:13.240</a></span> | <span class="t">it on the label data class itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2957" target="_blank">00:49:17.000</a></span> | <span class="t">So it's just a convenience, really, class methods.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2959" target="_blank">00:49:19.880</a></span> | <span class="t">The thing that they get passed in is the actual class that was requested.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2963" target="_blank">00:49:23.980</a></span> | <span class="t">So I could create a subclass of this and then ask for that subclass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2968" target="_blank">00:49:28.640</a></span> | <span class="t">So anyway, they're called class methods.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2970" target="_blank">00:49:30.920</a></span> | <span class="t">You should Google them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2972" target="_blank">00:49:32.180</a></span> | <span class="t">Pretty much every language supports class methods or something like it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2977" target="_blank">00:49:37.960</a></span> | <span class="t">They're pretty convenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2978" target="_blank">00:49:38.960</a></span> | <span class="t">You can get away without them, but they're pretty convenient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2983" target="_blank">00:49:43.800</a></span> | <span class="t">Great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2986" target="_blank">00:49:46.080</a></span> | <span class="t">So now we've got our labeled list, and if we print it out, it's got a training set and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2992" target="_blank">00:49:52.920</a></span> | <span class="t">a validation set, and each one has an X and a Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=2998" target="_blank">00:49:58.160</a></span> | <span class="t">Our category items are a little less convenient than the FastAI version ones because the FastAI</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3004" target="_blank">00:50:04.760</a></span> | <span class="t">ones will actually print out the name of each category.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3008" target="_blank">00:50:08.600</a></span> | <span class="t">We haven't done anything to make that happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3010" target="_blank">00:50:10.200</a></span> | <span class="t">So if we want the name of each category, we would actually have to refer to the .obj, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3017" target="_blank">00:50:17.040</a></span> | <span class="t">you can see we're doing here, Y.obj or Y.obj with a slice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3024" target="_blank">00:50:24.240</a></span> | <span class="t">So in FastAI version one, there's one extra thing we have, which is this concept of an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3030" target="_blank">00:50:30.560</a></span> | <span class="t">item base, and you can actually define things like category items that know how to print</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3034" target="_blank">00:50:34.960</a></span> | <span class="t">themselves out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3037" target="_blank">00:50:37.400</a></span> | <span class="t">Whether that convenience is worth the extra complexity is up to you if you're designing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3043" target="_blank">00:50:43.360</a></span> | <span class="t">something similar yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3046" target="_blank">00:50:46.880</a></span> | <span class="t">So we still can't train a model with these because we have pillow objects.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3051" target="_blank">00:50:51.800</a></span> | <span class="t">We need tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3054" target="_blank">00:50:54.800</a></span> | <span class="t">So here's our labeled list, training set, zeroth object, and that has an X and a Y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3065" target="_blank">00:51:05.060</a></span> | <span class="t">So the zeroth thing in that tuple is the X.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3069" target="_blank">00:51:09.600</a></span> | <span class="t">If they're all going to be in the batch together, they have to be the same size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3072" target="_blank">00:51:12.680</a></span> | <span class="t">So we can just go .resize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3073" target="_blank">00:51:13.680</a></span> | <span class="t">No problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3074" target="_blank">00:51:14.680</a></span> | <span class="t">I mean, that's not a great way to do it, but it's a start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3081" target="_blank">00:51:21.880</a></span> | <span class="t">So here's a transform that resizes things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3086" target="_blank">00:51:26.560</a></span> | <span class="t">And it has to be after all the other transforms we've seen so far because we want conversion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3092" target="_blank">00:51:32.720</a></span> | <span class="t">to RGB to happen beforehand, probably, stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3095" target="_blank">00:51:35.880</a></span> | <span class="t">So we'll give this an order of 10.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3099" target="_blank">00:51:39.560</a></span> | <span class="t">And this is something you pass in a size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3101" target="_blank">00:51:41.480</a></span> | <span class="t">If you pass in an integer, we'll turn it into a tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3104" target="_blank">00:51:44.360</a></span> | <span class="t">And when you call it, it'll call resize, and it'll do bilinear resizing for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3111" target="_blank">00:51:51.220</a></span> | <span class="t">So there's a transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3113" target="_blank">00:51:53.600</a></span> | <span class="t">Once you've turned them all into the same size, then we can turn them into tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3119" target="_blank">00:51:59.760</a></span> | <span class="t">I stole this from TorchVision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3122" target="_blank">00:52:02.860</a></span> | <span class="t">This is how TorchVision turns pillow objects into tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3129" target="_blank">00:52:09.400</a></span> | <span class="t">And this has to happen after the resizing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3131" target="_blank">00:52:11.880</a></span> | <span class="t">So we'll give this a lesser order.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3134" target="_blank">00:52:14.920</a></span> | <span class="t">And you see, there's two ways here of adding kind of class-level state or transform-level</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3140" target="_blank">00:52:20.800</a></span> | <span class="t">state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3141" target="_blank">00:52:21.800</a></span> | <span class="t">I can actually attach state to a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3143" target="_blank">00:52:23.440</a></span> | <span class="t">This is really underused in Python, but it's super handy, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3146" target="_blank">00:52:26.320</a></span> | <span class="t">We've got a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3147" target="_blank">00:52:27.320</a></span> | <span class="t">We just want to say, like, what's the order of the function?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3149" target="_blank">00:52:29.680</a></span> | <span class="t">Or we can put it in the plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3152" target="_blank">00:52:32.400</a></span> | <span class="t">And then that's turned it into a byte tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3154" target="_blank">00:52:34.800</a></span> | <span class="t">We actually need a float tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3156" target="_blank">00:52:36.480</a></span> | <span class="t">So here's how you turn it into a float.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3158" target="_blank">00:52:38.440</a></span> | <span class="t">And we don't want it to be between 0 and 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3160" target="_blank">00:52:40.960</a></span> | <span class="t">We want it between 0 and 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3162" target="_blank">00:52:42.480</a></span> | <span class="t">So we divide it in place by 255.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3165" target="_blank">00:52:45.240</a></span> | <span class="t">And that has to happen after it's a byte.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3167" target="_blank">00:52:47.360</a></span> | <span class="t">So we'll give that a higher order again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3170" target="_blank">00:52:50.320</a></span> | <span class="t">So now here's our list of transforms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3172" target="_blank">00:52:52.040</a></span> | <span class="t">It doesn't matter what order they're in the array, because they're going to order them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3174" target="_blank">00:52:54.980</a></span> | <span class="t">by the underscore order attribute.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3178" target="_blank">00:52:58.300</a></span> | <span class="t">So we can pass that to our image list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3180" target="_blank">00:53:00.800</a></span> | <span class="t">We can split it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3182" target="_blank">00:53:02.080</a></span> | <span class="t">We can label it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3183" target="_blank">00:53:03.440</a></span> | <span class="t">Here's a little convenience to permute the order back again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3188" target="_blank">00:53:08.680</a></span> | <span class="t">I don't know if you noticed this, but in to byte tensor, I had to permute 201, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3195" target="_blank">00:53:15.880</a></span> | <span class="t">Pillow has the channel last, or else PyTorch assumes the channel comes first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3202" target="_blank">00:53:22.200</a></span> | <span class="t">So this is just going to pop the channel first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3204" target="_blank">00:53:24.560</a></span> | <span class="t">So to print them out, we have to put the channel last again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3208" target="_blank">00:53:28.580</a></span> | <span class="t">So now we can grab something from that list and show image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3213" target="_blank">00:53:33.760</a></span> | <span class="t">Here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3214" target="_blank">00:53:34.760</a></span> | <span class="t">And you can see that it is something of a torch thing of this size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3219" target="_blank">00:53:39.400</a></span> | <span class="t">So that's looking good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3220" target="_blank">00:53:40.520</a></span> | <span class="t">So we now have tensors that are floats and all the same size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3225" target="_blank">00:53:45.280</a></span> | <span class="t">So we can train a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3227" target="_blank">00:53:47.960</a></span> | <span class="t">So we've got a batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3229" target="_blank">00:53:49.640</a></span> | <span class="t">We'll use the get data load as we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3232" target="_blank">00:53:52.040</a></span> | <span class="t">We can just pass in train invalid directly from our labeled list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3238" target="_blank">00:53:58.320</a></span> | <span class="t">Let's grab a mini batch, and here it is, 64 by 3 by 128 by 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3243" target="_blank">00:54:03.560</a></span> | <span class="t">And we can have a look at it, and we can see the vocab for it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3248" target="_blank">00:54:08.860</a></span> | <span class="t">We can see the whole mini batch of y values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3253" target="_blank">00:54:13.280</a></span> | <span class="t">So now we can create a data bunch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3257" target="_blank">00:54:17.840</a></span> | <span class="t">That's going to have our data loaders.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3260" target="_blank">00:54:20.480</a></span> | <span class="t">And to make life even easier for the future, let's add two optional things, channels in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3266" target="_blank">00:54:26.520</a></span> | <span class="t">and channels out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3268" target="_blank">00:54:28.280</a></span> | <span class="t">And that way any models that want to be automatically created can automatically create themselves</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3273" target="_blank">00:54:33.560</a></span> | <span class="t">with the correct number of inputs and the correct number of outputs for our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3280" target="_blank">00:54:40.160</a></span> | <span class="t">And let's create add to our split data, something called to data bunch, which is just this function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3290" target="_blank">00:54:50.760</a></span> | <span class="t">It just calls that get DLs we saw before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3294" target="_blank">00:54:54.880</a></span> | <span class="t">So like in practice, in your actual module, you would go back and you would paste the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3302" target="_blank">00:55:02.120</a></span> | <span class="t">contents of this back into your split data definition.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3305" target="_blank">00:55:05.880</a></span> | <span class="t">But this is kind of a nice way when you're just iteratively building stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3310" target="_blank">00:55:10.880</a></span> | <span class="t">You can't only monkey patch PyTorch things or standard library things, you can monkey</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3317" target="_blank">00:55:17.160</a></span> | <span class="t">patch your own things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3318" target="_blank">00:55:18.440</a></span> | <span class="t">So here's how you can add something to a previous class when you realize later that you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3322" target="_blank">00:55:22.640</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3323" target="_blank">00:55:23.640</a></span> | <span class="t">Okay, so let's go through and see what happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3330" target="_blank">00:55:30.960</a></span> | <span class="t">So here are all the steps, literally all the steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3335" target="_blank">00:55:35.400</a></span> | <span class="t">Grab the path, untie the data, grab the transforms, grab the item list, pass in the transforms,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3343" target="_blank">00:55:43.360</a></span> | <span class="t">split the data using the grandparent, using this validation name, label it using parent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3350" target="_blank">00:55:50.320</a></span> | <span class="t">labeler, and then turn it into a data bunch with this batch size, three channels in, ten</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3357" target="_blank">00:55:57.280</a></span> | <span class="t">channels out, and we'll use four processes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3362" target="_blank">00:56:02.600</a></span> | <span class="t">Here's our callback functions from last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3367" target="_blank">00:56:07.500</a></span> | <span class="t">Let's make sure that we normalize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3369" target="_blank">00:56:09.420</a></span> | <span class="t">In the past, we've normalized things that have had only one channel, being MNIST.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3374" target="_blank">00:56:14.480</a></span> | <span class="t">Now we've got three channels, so we need to make sure that we take the mean over the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3378" target="_blank">00:56:18.600</a></span> | <span class="t">channels so that we get a three-channel mean and a three-channel standard deviation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3385" target="_blank">00:56:25.320</a></span> | <span class="t">So let's define a function that normalizes things that are three channels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3390" target="_blank">00:56:30.560</a></span> | <span class="t">So we're just broadcasting here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3393" target="_blank">00:56:33.360</a></span> | <span class="t">So here's the mean and standard deviation of this Imagenet batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3398" target="_blank">00:56:38.560</a></span> | <span class="t">So here's a function called normImagenet, which we can use from now on to normalize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3404" target="_blank">00:56:44.140</a></span> | <span class="t">anything with this dataset.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3407" target="_blank">00:56:47.160</a></span> | <span class="t">So let's add that as a callback using the batch transform we built earlier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3414" target="_blank">00:56:54.360</a></span> | <span class="t">We will create a ConvNet with this number of layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3421" target="_blank">00:57:01.880</a></span> | <span class="t">And here's the ConvNet, we're going to come back to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3425" target="_blank">00:57:05.920</a></span> | <span class="t">And then we will do our one-cycle scheduling using COSYCLE, one-cycle annealing, COSIGN,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3431" target="_blank">00:57:11.720</a></span> | <span class="t">one-cycle annealing, pass that into our getLearn run, and train.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3440" target="_blank">00:57:20.720</a></span> | <span class="t">And that's going to give us 72.6%, which if we look at the Imagenet leaderboard for 128</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3453" target="_blank">00:57:33.600</a></span> | <span class="t">pixels for i5 epochs, the best is 84.6 so far.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3458" target="_blank">00:57:38.280</a></span> | <span class="t">So this is looking pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3461" target="_blank">00:57:41.640</a></span> | <span class="t">We're very much on the right track.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3464" target="_blank">00:57:44.120</a></span> | <span class="t">So let's take a look and see what model we built, because it's kind of interesting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3468" target="_blank">00:57:48.360</a></span> | <span class="t">It's a few interesting features of this model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3470" target="_blank">00:57:50.680</a></span> | <span class="t">And we're going to be looking at these features quite a lot in the next two lessons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3476" target="_blank">00:57:56.760</a></span> | <span class="t">The model knows how big its first layer has to start out because we pass in data, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3484" target="_blank">00:58:04.760</a></span> | <span class="t">data has the channels in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3486" target="_blank">00:58:06.680</a></span> | <span class="t">So this is nice.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3487" target="_blank">00:58:07.680</a></span> | <span class="t">Already this is a model which you don't have to change its definition if you have hyperspectral</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3493" target="_blank">00:58:13.800</a></span> | <span class="t">imaging with four channels, or you have black and white with one channel, or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3498" target="_blank">00:58:18.640</a></span> | <span class="t">So this is going to change itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3501" target="_blank">00:58:21.580</a></span> | <span class="t">Now what's the second layer going to be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3504" target="_blank">00:58:24.720</a></span> | <span class="t">Or I should say, what's the output of the first layer going to be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3507" target="_blank">00:58:27.080</a></span> | <span class="t">The input's going to be CIN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3508" target="_blank">00:58:28.600</a></span> | <span class="t">What's the output going to be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3509" target="_blank">00:58:29.600</a></span> | <span class="t">Is it going to be 16, 32, 64?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3514" target="_blank">00:58:34.300</a></span> | <span class="t">Well, what we're going to do is we're going to say, well, our input has, we don't know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3524" target="_blank">00:58:44.560</a></span> | <span class="t">some number of channels, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3526" target="_blank">00:58:46.280</a></span> | <span class="t">But we do know that the first layer is going to be a three by three kernel, and then there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3530" target="_blank">00:58:50.600</a></span> | <span class="t">going to be some number of channels, CIN channels, which in our case is three.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3538" target="_blank">00:58:58.160</a></span> | <span class="t">So as the convolution kernel kind of scrolls over the input image, at each time, the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3544" target="_blank">00:59:04.140</a></span> | <span class="t">of things that it's multiplying together is going to be three by three by CN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3550" target="_blank">00:59:10.480</a></span> | <span class="t">So nine by CN.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3553" target="_blank">00:59:13.800</a></span> | <span class="t">So remember we talked about this last week, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3556" target="_blank">00:59:16.280</a></span> | <span class="t">We basically want to put that, we basically want to make sure that our first convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3566" target="_blank">00:59:26.880</a></span> | <span class="t">actually has something useful to do, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3571" target="_blank">00:59:31.760</a></span> | <span class="t">So if we're getting nine by CN coming in, you wouldn't want more than that going out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3578" target="_blank">00:59:38.280</a></span> | <span class="t">because it's basically a wasted time, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3581" target="_blank">00:59:41.000</a></span> | <span class="t">So we discussed that briefly last week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3582" target="_blank">00:59:42.900</a></span> | <span class="t">So what I'm going to do is I'm going to say, okay, let's take that value, CN by three by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3589" target="_blank">00:59:49.800</a></span> | <span class="t">three, and let's just look for the next largest number that's a power of two, and we'll use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3596" target="_blank">00:59:56.640</a></span> | <span class="t">that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3598" target="_blank">00:59:58.660</a></span> | <span class="t">So then that's how I do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3601" target="_blank">01:00:01.200</a></span> | <span class="t">And then I'll just go ahead and multiply by two for each of the next two layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3605" target="_blank">01:00:05.380</a></span> | <span class="t">So this way, we've got these vital first three layers are going to work out pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3611" target="_blank">01:00:11.640</a></span> | <span class="t">So back in the old days, we used to use five by seven kernels, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3619" target="_blank">01:00:19.040</a></span> | <span class="t">We'd have the first layer, would be one of those, but we know now that's not a good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3625" target="_blank">01:00:25.720</a></span> | <span class="t">Still most people do it because people stick with what they know, but when you look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3630" target="_blank">01:00:30.680</a></span> | <span class="t">the bag of tricks for image classification paper, which in turn refers to many previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3639" target="_blank">01:00:39.360</a></span> | <span class="t">citations, many of which are state of the art and competition winning models, the message</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3645" target="_blank">01:00:45.280</a></span> | <span class="t">is always clear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3647" target="_blank">01:00:47.040</a></span> | <span class="t">Three by three kernels give you more bang for your buck.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3650" target="_blank">01:00:50.960</a></span> | <span class="t">You get deeper, you end up with the same receptive field.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3654" target="_blank">01:00:54.120</a></span> | <span class="t">It's faster because you've got less work going on, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3658" target="_blank">01:00:58.180</a></span> | <span class="t">And really, this goes all the way back to the classic Zeiler and Fergus paper that we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3663" target="_blank">01:01:03.540</a></span> | <span class="t">looked at so many times over the years that we've been doing this course.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3668" target="_blank">01:01:08.100</a></span> | <span class="t">And even before that to the VGG paper, it really is three by three kernels everywhere.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3676" target="_blank">01:01:16.000</a></span> | <span class="t">So any place you see something that's not a three by three kernel, have a big think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3682" target="_blank">01:01:22.720</a></span> | <span class="t">about whether that makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3685" target="_blank">01:01:25.680</a></span> | <span class="t">Okay, so that's basically what we have for those critical first three layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3692" target="_blank">01:01:32.520</a></span> | <span class="t">That's where that initial feature representation is happening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3696" target="_blank">01:01:36.440</a></span> | <span class="t">And then the rest of the layers is whatever we've asked for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3703" target="_blank">01:01:43.120</a></span> | <span class="t">And so then we can build those layers up, just saying number of filters in to number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3706" target="_blank">01:01:46.440</a></span> | <span class="t">of filters out for each filter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3708" target="_blank">01:01:48.960</a></span> | <span class="t">And then as usual, average pooling, Latin, and a linear layer to however many classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3714" target="_blank">01:01:54.720</a></span> | <span class="t">is in our data, okay, that's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3723" target="_blank">01:02:03.200</a></span> | <span class="t">It's very hard to, every time I write something like this, I break it the first 12 times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3730" target="_blank">01:02:10.960</a></span> | <span class="t">And the only way to debug it is to see exactly what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3734" target="_blank">01:02:14.840</a></span> | <span class="t">To see exactly what's going on, you need to see that what module is there at each point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3740" target="_blank">01:02:20.200</a></span> | <span class="t">and what is the output shape at each module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3745" target="_blank">01:02:25.000</a></span> | <span class="t">So that's why we've created this model summary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3748" target="_blank">01:02:28.360</a></span> | <span class="t">So model summary's gonna use that get batch that we added in the LSUV notebook to grab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3753" target="_blank">01:02:33.520</a></span> | <span class="t">one batch of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3757" target="_blank">01:02:37.480</a></span> | <span class="t">We will make sure that that batch is on the correct device.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3762" target="_blank">01:02:42.960</a></span> | <span class="t">We will use the find module thing that we used in the LSUV to find all of the places</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3767" target="_blank">01:02:47.960</a></span> | <span class="t">that there's a linear layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3772" target="_blank">01:02:52.440</a></span> | <span class="t">If you said find all, otherwise we will grab just the immediate children.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3780" target="_blank">01:03:00.680</a></span> | <span class="t">We will grab a hook for every layer using the hooks that we made.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3786" target="_blank">01:03:06.280</a></span> | <span class="t">And so now we can pass that model through.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3789" target="_blank">01:03:09.360</a></span> | <span class="t">And the function that we've used for hooking simply prints out the module and the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3797" target="_blank">01:03:17.400</a></span> | <span class="t">shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3798" target="_blank">01:03:18.400</a></span> | <span class="t">So that's how easy it is to create this wonderfully useful model summary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3803" target="_blank">01:03:23.320</a></span> | <span class="t">So to answer your question of earlier, another reason why are we doing this or what are you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3809" target="_blank">01:03:29.880</a></span> | <span class="t">meant to be getting out of it is to say you don't have to write much code to create really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3817" target="_blank">01:03:37.280</a></span> | <span class="t">useful tools and telemetry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3820" target="_blank">01:03:40.400</a></span> | <span class="t">So we've seen how to create like per-layer histogram viewers, how to create model summaries.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3827" target="_blank">01:03:47.520</a></span> | <span class="t">With the tools that you have at your disposal now, I really hope that you can dig inside</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3832" target="_blank">01:03:52.120</a></span> | <span class="t">your models what they are and what they're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3836" target="_blank">01:03:56.640</a></span> | <span class="t">And you see that it's all about hooks.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3839" target="_blank">01:03:59.080</a></span> | <span class="t">So this hooks thing we have is just like super, super useful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3844" target="_blank">01:04:04.120</a></span> | <span class="t">Now very grateful to the PyTorch team for adding this fantastic functionality.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3848" target="_blank">01:04:08.560</a></span> | <span class="t">So you can see here we start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3851" target="_blank">01:04:11.160</a></span> | <span class="t">The input is 128 because that's a batch size, 128 by 3 by 128 by 128.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3859" target="_blank">01:04:19.120</a></span> | <span class="t">And then we gradually go through these convolutions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3862" target="_blank">01:04:22.800</a></span> | <span class="t">The first one has a stride of one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3867" target="_blank">01:04:27.960</a></span> | <span class="t">The next two you have a stride of two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3869" target="_blank">01:04:29.680</a></span> | <span class="t">So that goes 64, 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3872" target="_blank">01:04:32.880</a></span> | <span class="t">And you can see after each one they have a stride of two, get smaller and smaller.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3876" target="_blank">01:04:36.900</a></span> | <span class="t">And then an average pull that to a one by one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3880" target="_blank">01:04:40.040</a></span> | <span class="t">And then we flatten it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3881" target="_blank">01:04:41.820</a></span> | <span class="t">And then we have a linear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3883" target="_blank">01:04:43.460</a></span> | <span class="t">So it's a really, it's like as basic a ConvNet as you could get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3889" target="_blank">01:04:49.480</a></span> | <span class="t">It really is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3890" target="_blank">01:04:50.480</a></span> | <span class="t">It's just a bunch of three by three conv-related batch norms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3894" target="_blank">01:04:54.460</a></span> | <span class="t">But it does terrifically well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3897" target="_blank">01:04:57.600</a></span> | <span class="t">It's deep enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3900" target="_blank">01:05:00.760</a></span> | <span class="t">So I think that's a good start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3907" target="_blank">01:05:07.960</a></span> | <span class="t">I think that's a good time to take a break.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3910" target="_blank">01:05:10.620</a></span> | <span class="t">So let's come back at 7.45.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3918" target="_blank">01:05:18.440</a></span> | <span class="t">This is one of the bits I'm most excited about in this course actually.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3923" target="_blank">01:05:23.320</a></span> | <span class="t">But hopefully it's going to be like totally unexciting to you because it's just going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3926" target="_blank">01:05:26.640</a></span> | <span class="t">to be so obvious that you should do it this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3928" target="_blank">01:05:28.880</a></span> | <span class="t">But the reason I'm excited is that we're going to be talking about optimizers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3932" target="_blank">01:05:32.960</a></span> | <span class="t">And anybody who's done work with kind of optimizers in deep learning in the past will know that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3938" target="_blank">01:05:38.960</a></span> | <span class="t">every library treats every optimizer as a totally different thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3943" target="_blank">01:05:43.520</a></span> | <span class="t">So there's an atom optimizer, like in PyTorch there's an atom optimizer and a SGD optimizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3949" target="_blank">01:05:49.520</a></span> | <span class="t">and a RMS prop optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3952" target="_blank">01:05:52.520</a></span> | <span class="t">And somebody comes along and says, hey, we've invented this thing called decoupled weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3957" target="_blank">01:05:57.800</a></span> | <span class="t">decay, also known as Adam W. And the PyTorch folks go, oh, damn, what are we going to do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3964" target="_blank">01:06:04.400</a></span> | <span class="t">And they have to add a parameter to every one of their optimizers and they have to change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3967" target="_blank">01:06:07.640</a></span> | <span class="t">every one of their optimizers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3968" target="_blank">01:06:08.640</a></span> | <span class="t">And then somebody else comes along and says, oh, we've invented a thing called AMS grad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3973" target="_blank">01:06:13.680</a></span> | <span class="t">There's another parameter we have to put into any one of those optimizers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3976" target="_blank">01:06:16.240</a></span> | <span class="t">And it's not just like inefficient and frustrating, but it holds back research because it starts</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3985" target="_blank">01:06:25.520</a></span> | <span class="t">feeling like there are all these things called different kinds of optimizers, but there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3990" target="_blank">01:06:30.720</a></span> | <span class="t">not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3991" target="_blank">01:06:31.720</a></span> | <span class="t">I'm going to show you there's not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3993" target="_blank">01:06:33.000</a></span> | <span class="t">There's one optimizer and there's one optimizer in which you can inject different pieces of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=3999" target="_blank">01:06:39.120</a></span> | <span class="t">behavior in a very, very small number of ways.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4002" target="_blank">01:06:42.560</a></span> | <span class="t">And what we're going to do is we're going to start with this generic optimizer and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4006" target="_blank">01:06:46.640</a></span> | <span class="t">going to end up with this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4009" target="_blank">01:06:49.400</a></span> | <span class="t">This came out last week and it's a massive improvement as you see in what we can do with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4015" target="_blank">01:06:55.840</a></span> | <span class="t">natural language processing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4019" target="_blank">01:06:59.320</a></span> | <span class="t">This is the equation set that we're going to end up implementing from the paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4027" target="_blank">01:07:07.880</a></span> | <span class="t">And what if I told you that not only I think are we the first library to have this implemented,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4035" target="_blank">01:07:15.800</a></span> | <span class="t">but this is the total amount of code that we're going to write to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4041" target="_blank">01:07:21.240</a></span> | <span class="t">So that's where we're going.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4046" target="_blank">01:07:26.240</a></span> | <span class="t">So we're going to continue with the image net and we're going to continue with the basic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4050" target="_blank">01:07:30.920</a></span> | <span class="t">set of transforms we had before and the basic set of stuff to create our data bunch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4058" target="_blank">01:07:38.760</a></span> | <span class="t">This is our model and this is something to pop it on CUDA to get our statistics written</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4066" target="_blank">01:07:46.120</a></span> | <span class="t">out to do our batch transform with the normalization.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4070" target="_blank">01:07:50.000</a></span> | <span class="t">And so we're going to start here 52% after an epoch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4076" target="_blank">01:07:56.680</a></span> | <span class="t">And so let's try to create an optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4079" target="_blank">01:07:59.800</a></span> | <span class="t">Now in PyTorch, the base thing called optimizer is just a dictionary that stores away some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4088" target="_blank">01:08:08.600</a></span> | <span class="t">hyperparameters and we've actually already used it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4093" target="_blank">01:08:13.200</a></span> | <span class="t">And I deeply apologize for this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4095" target="_blank">01:08:15.880</a></span> | <span class="t">We cheated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4097" target="_blank">01:08:17.680</a></span> | <span class="t">We used something that is not part of our approved set of foundations without building</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4103" target="_blank">01:08:23.320</a></span> | <span class="t">it ourselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4105" target="_blank">01:08:25.320</a></span> | <span class="t">And we did it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4109" target="_blank">01:08:29.680</a></span> | <span class="t">We never wrote param groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4111" target="_blank">01:08:31.920</a></span> | <span class="t">We never wrote param groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4113" target="_blank">01:08:33.920</a></span> | <span class="t">So we're going to go back and do it now, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4117" target="_blank">01:08:37.000</a></span> | <span class="t">Because the reason we did this is because we were using torture's optim.optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4122" target="_blank">01:08:42.240</a></span> | <span class="t">We've already built the kind of the main part of that, which is the thing that multiplies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4126" target="_blank">01:08:46.960</a></span> | <span class="t">by the learning rate and subtracts from the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4132" target="_blank">01:08:52.520</a></span> | <span class="t">But we didn't build param groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4134" target="_blank">01:08:54.480</a></span> | <span class="t">So let's do it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4136" target="_blank">01:08:56.640</a></span> | <span class="t">So here's what's going to happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4139" target="_blank">01:08:59.920</a></span> | <span class="t">As always, we need something called zero grad, which is going to go through some parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4144" target="_blank">01:09:04.640</a></span> | <span class="t">and zero them out and also remove any gradient computation history.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4150" target="_blank">01:09:10.020</a></span> | <span class="t">And we're going to have a step function that does some kind of step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4153" target="_blank">01:09:13.720</a></span> | <span class="t">The main difference here, though, is our step function isn't actually going to do anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4160" target="_blank">01:09:20.460</a></span> | <span class="t">It's going to use composition on some things that we pass on and ask them to do something.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4166" target="_blank">01:09:26.440</a></span> | <span class="t">So this optimizer is going to do nothing at all until we build on top of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4173" target="_blank">01:09:33.400</a></span> | <span class="t">But we're going to set it up to be able to handle things like discriminative learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4177" target="_blank">01:09:37.420</a></span> | <span class="t">rates and one cycle of kneeling and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4182" target="_blank">01:09:42.320</a></span> | <span class="t">And so to be able to do that, we need some way to create parameter groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4188" target="_blank">01:09:48.160</a></span> | <span class="t">This is what we call in fast AI layer groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4192" target="_blank">01:09:52.840</a></span> | <span class="t">And I kind of wish I hadn't called them layer groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4196" target="_blank">01:09:56.400</a></span> | <span class="t">I should call them parameter groups because we have a perfectly good name for them already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4200" target="_blank">01:10:00.480</a></span> | <span class="t">in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4201" target="_blank">01:10:01.720</a></span> | <span class="t">So I'm not going to call them layer groups anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4203" target="_blank">01:10:03.880</a></span> | <span class="t">I'm just going to call them parameter groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4206" target="_blank">01:10:06.280</a></span> | <span class="t">But it's the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4207" target="_blank">01:10:07.280</a></span> | <span class="t">OK, parameter groups and layer groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4208" target="_blank">01:10:08.920</a></span> | <span class="t">So a parameter group-- so remember when we say parameters in PyTorch, remember right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4216" target="_blank">01:10:16.920</a></span> | <span class="t">back to when we've created our first linear layer, we had a weight tensor and we had a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4220" target="_blank">01:10:20.840</a></span> | <span class="t">bias tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4222" target="_blank">01:10:22.400</a></span> | <span class="t">And each one of those is a parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4224" target="_blank">01:10:24.760</a></span> | <span class="t">It's a parameter tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4227" target="_blank">01:10:27.700</a></span> | <span class="t">So in order to optimize something, we need to know what all the parameter tensors are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4232" target="_blank">01:10:32.000</a></span> | <span class="t">in a model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4233" target="_blank">01:10:33.000</a></span> | <span class="t">And you can just say model.parameters to grab them all in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4239" target="_blank">01:10:39.960</a></span> | <span class="t">And that's going to give us-- it gives us a generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4243" target="_blank">01:10:43.160</a></span> | <span class="t">But as soon as you call list on a generator, it turns it into an actual list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4246" target="_blank">01:10:46.880</a></span> | <span class="t">So that's going to give us a list of all of the tensors, all of the weights and all of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4253" target="_blank">01:10:53.280</a></span> | <span class="t">the biases, basically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4258" target="_blank">01:10:58.880</a></span> | <span class="t">But we might want to be able to say the last two layers should have a different learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4266" target="_blank">01:11:06.580</a></span> | <span class="t">rate to all the other layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4269" target="_blank">01:11:09.000</a></span> | <span class="t">And so the way we can do that is rather than just passing in a list of parameters, we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4274" target="_blank">01:11:14.120</a></span> | <span class="t">pass in a list of lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4276" target="_blank">01:11:16.560</a></span> | <span class="t">And so let's say our list of lists has two items.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4279" target="_blank">01:11:19.320</a></span> | <span class="t">The first item contains all the parameters in the main body of the architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4284" target="_blank">01:11:24.440</a></span> | <span class="t">And the last item contains just the parameters from the last two layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4290" target="_blank">01:11:30.200</a></span> | <span class="t">So if we make this-- decide that this is a list of lists, then that lets us do parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4298" target="_blank">01:11:38.240</a></span> | <span class="t">groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4299" target="_blank">01:11:39.240</a></span> | <span class="t">Now, that's how we tell the optimizer these sets of parameters should be handled differently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4304" target="_blank">01:11:44.760</a></span> | <span class="t">with discriminative learning rates and stuff.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4307" target="_blank">01:11:47.960</a></span> | <span class="t">And so that's what we're going to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4309" target="_blank">01:11:49.280</a></span> | <span class="t">We're going to assume that this thing being passed in is a list of lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4313" target="_blank">01:11:53.120</a></span> | <span class="t">Well, we won't quite assume.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4315" target="_blank">01:11:55.200</a></span> | <span class="t">We'll check.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4316" target="_blank">01:11:56.200</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4317" target="_blank">01:11:57.200</a></span> | <span class="t">If it's not, then we'll turn it into a list of lists by just wrapping it in a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4322" target="_blank">01:12:02.580</a></span> | <span class="t">So if it only has one thing in it, we'll just make it a list of-- with one item containing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4327" target="_blank">01:12:07.400</a></span> | <span class="t">a list.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4329" target="_blank">01:12:09.120</a></span> | <span class="t">So now, param groups is a list of lists of parameter tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4335" target="_blank">01:12:15.880</a></span> | <span class="t">And so you could either pass in, so you could decide how you want to split them up into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4340" target="_blank">01:12:20.520</a></span> | <span class="t">different parameter groups, or you could just have them turn into a single parameter group</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4346" target="_blank">01:12:26.280</a></span> | <span class="t">for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4348" target="_blank">01:12:28.280</a></span> | <span class="t">So that's the first thing we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4350" target="_blank">01:12:30.140</a></span> | <span class="t">So now, we have-- our optimizer object has a param groups attribute containing our parameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4357" target="_blank">01:12:37.920</a></span> | <span class="t">groups.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4358" target="_blank">01:12:38.920</a></span> | <span class="t">So just keep remembering that's a list of lists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4360" target="_blank">01:12:40.800</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4362" target="_blank">01:12:42.080</a></span> | <span class="t">Each parameter group can have its own set of hyperparameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4367" target="_blank">01:12:47.580</a></span> | <span class="t">So hyperparameters could be learning rate, momentum, beta in atom, epsilon in atom, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4374" target="_blank">01:12:54.840</a></span> | <span class="t">so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4376" target="_blank">01:12:56.320</a></span> | <span class="t">So those hyperparameters are going to be stored as a dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4380" target="_blank">01:13:00.560</a></span> | <span class="t">And so there's going to be one dictionary for each parameter group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4384" target="_blank">01:13:04.880</a></span> | <span class="t">So here's where we created.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4387" target="_blank">01:13:07.240</a></span> | <span class="t">self.hypers contains, for each parameter group, a dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4394" target="_blank">01:13:14.560</a></span> | <span class="t">And what's in the dictionary?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4396" target="_blank">01:13:16.440</a></span> | <span class="t">What's in the dictionary is whatever you pass to the constructor, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4400" target="_blank">01:13:20.980</a></span> | <span class="t">So this is how you just pass a single bunch of keyword arguments to the constructor, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4406" target="_blank">01:13:26.440</a></span> | <span class="t">it's going to construct a dictionary for every one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4409" target="_blank">01:13:29.120</a></span> | <span class="t">And this is just a way of cloning a dictionary so that they're not all referring to the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4414" target="_blank">01:13:34.280</a></span> | <span class="t">reference, but they all have their own reference.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4417" target="_blank">01:13:37.240</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4419" target="_blank">01:13:39.240</a></span> | <span class="t">So that's doing much the same stuff as torture's optim.optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4426" target="_blank">01:13:46.400</a></span> | <span class="t">And here's the new bit, stepper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4429" target="_blank">01:13:49.360</a></span> | <span class="t">In order to see what a stepper is, let's write one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4432" target="_blank">01:13:52.040</a></span> | <span class="t">Here's a stepper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4433" target="_blank">01:13:53.600</a></span> | <span class="t">It's a function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4435" target="_blank">01:13:55.200</a></span> | <span class="t">It's called SGD step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4437" target="_blank">01:13:57.080</a></span> | <span class="t">What does it do?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4438" target="_blank">01:13:58.720</a></span> | <span class="t">It does the SGD step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4440" target="_blank">01:14:00.280</a></span> | <span class="t">We've seen it before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4443" target="_blank">01:14:03.520</a></span> | <span class="t">So in other words, to create an SGD optimizer, we create a partial with our optimizer with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4451" target="_blank">01:14:11.960</a></span> | <span class="t">the steppers being SGD step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4455" target="_blank">01:14:15.220</a></span> | <span class="t">So now when we call step, it goes through our parameters, composes together our steppers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4463" target="_blank">01:14:23.280</a></span> | <span class="t">which is just one thing, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4465" target="_blank">01:14:25.880</a></span> | <span class="t">And calls the parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4469" target="_blank">01:14:29.040</a></span> | <span class="t">So the parameter is going to go p.data.add minus learning rate p.grad.data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4475" target="_blank">01:14:35.280</a></span> | <span class="t">So that's how we can create SGD.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4480" target="_blank">01:14:40.120</a></span> | <span class="t">So with that optimization function, we can fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4485" target="_blank">01:14:45.640</a></span> | <span class="t">It's not doing anything different at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4489" target="_blank">01:14:49.360</a></span> | <span class="t">But what we have done is we've done the same thing we've done 1,000 times without ever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4493" target="_blank">01:14:53.960</a></span> | <span class="t">creating an SGD optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4499" target="_blank">01:14:59.080</a></span> | <span class="t">It's an optimizer with an SGD step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4505" target="_blank">01:15:05.280</a></span> | <span class="t">I've created this thing called grad params, which is just a little convenience.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4508" target="_blank">01:15:08.980</a></span> | <span class="t">Basically when we zero the gradients, we have to go through every parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4514" target="_blank">01:15:14.080</a></span> | <span class="t">To go through every parameter, we have to go through every parameter group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4518" target="_blank">01:15:18.440</a></span> | <span class="t">And then within each parameter group, we have to go through every parameter in that group</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4522" target="_blank">01:15:22.360</a></span> | <span class="t">where the gradient exists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4525" target="_blank">01:15:25.000</a></span> | <span class="t">They're the ones that we have to zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4526" target="_blank">01:15:26.880</a></span> | <span class="t">And ditto for when we do a step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4529" target="_blank">01:15:29.720</a></span> | <span class="t">That's why I just refashioned it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4531" target="_blank">01:15:31.920</a></span> | <span class="t">And also, when we call the stepper, we want to pass to it all of our hyperparameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4541" target="_blank">01:15:41.040</a></span> | <span class="t">Because the stepper might want them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4544" target="_blank">01:15:44.800</a></span> | <span class="t">Like it'll probably want learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4546" target="_blank">01:15:46.400</a></span> | <span class="t">And learning rate is just one of the things that we've listed in our hyperparameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4552" target="_blank">01:15:52.000</a></span> | <span class="t">So remember how I said that our compose is a bit special, that it passes along any keyword</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4556" target="_blank">01:15:56.940</a></span> | <span class="t">arguments it got to everything that it composes?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4560" target="_blank">01:16:00.160</a></span> | <span class="t">Here's a nice way to use that, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4561" target="_blank">01:16:01.820</a></span> | <span class="t">So that's how calm SGD step can say, oh, I need the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4566" target="_blank">01:16:06.400</a></span> | <span class="t">And so as long as hyper has a learning rate in it, it's going to end up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4571" target="_blank">01:16:11.040</a></span> | <span class="t">And it'll be here as long as you pass it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4574" target="_blank">01:16:14.760</a></span> | <span class="t">And then you can change it for each different layer group.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4576" target="_blank">01:16:16.840</a></span> | <span class="t">You can anneal it and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4580" target="_blank">01:16:20.320</a></span> | <span class="t">So we're going to need to change our parameter scheduler to use our new generic optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4589" target="_blank">01:16:29.840</a></span> | <span class="t">It's simply now that we have to say, go through each hyperparameter in self.opt.hypers and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4597" target="_blank">01:16:37.720</a></span> | <span class="t">schedule it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4599" target="_blank">01:16:39.220</a></span> | <span class="t">So that's basically the same as what we had in parameter scheduler before, but for our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4602" target="_blank">01:16:42.400</a></span> | <span class="t">new thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4603" target="_blank">01:16:43.560</a></span> | <span class="t">And ditto for recorder.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4605" target="_blank">01:16:45.500</a></span> | <span class="t">This used to use param groups, now it uses hypers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4610" target="_blank">01:16:50.080</a></span> | <span class="t">So a minor change to make these keep working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4612" target="_blank">01:16:52.960</a></span> | <span class="t">So now I was super excited when we first got this working, so it's like, wow, we've just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4618" target="_blank">01:16:58.680</a></span> | <span class="t">built an SGD optimizer that works without ever writing an SGD optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4624" target="_blank">01:17:04.340</a></span> | <span class="t">So now when we want to add weight decay, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4626" target="_blank">01:17:06.780</a></span> | <span class="t">So weight decay, remember, is the thing where we don't want something that fits this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4630" target="_blank">01:17:10.900</a></span> | <span class="t">We want something that fits this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4633" target="_blank">01:17:13.080</a></span> | <span class="t">And the reason we, the way we do it is we use ultra regularization, which just as we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4637" target="_blank">01:17:17.580</a></span> | <span class="t">add the sum of squared weights times some parameter we choose.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4644" target="_blank">01:17:24.440</a></span> | <span class="t">And remember that the derivative of that is actually just WTD times weight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4649" target="_blank">01:17:29.680</a></span> | <span class="t">So you could either add an L2 regularization to the loss, or you can add WD times weight</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4658" target="_blank">01:17:38.280</a></span> | <span class="t">to the gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4659" target="_blank">01:17:39.520</a></span> | <span class="t">If you've forgotten this, go back and look at weight decay in part one to remind yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4666" target="_blank">01:17:46.560</a></span> | <span class="t">And so if we want to add either this or this, we can do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4671" target="_blank">01:17:51.840</a></span> | <span class="t">We can add a stepper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4673" target="_blank">01:17:53.360</a></span> | <span class="t">So weight decay is going to get an LR and a WD, and it's going to simply do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4680" target="_blank">01:18:00.480</a></span> | <span class="t">There it is, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4684" target="_blank">01:18:04.620</a></span> | <span class="t">Or L2 regularization is going to just do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4690" target="_blank">01:18:10.120</a></span> | <span class="t">By the way, if you haven't seen this before, add in PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4695" target="_blank">01:18:15.960</a></span> | <span class="t">Normally it just adds this tensor to this tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4699" target="_blank">01:18:19.240</a></span> | <span class="t">But if you add a scalar here, it multiplies these together first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4704" target="_blank">01:18:24.040</a></span> | <span class="t">This is a nice, fast way to go WD times parameter and add that to the gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4711" target="_blank">01:18:31.680</a></span> | <span class="t">So there's that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4717" target="_blank">01:18:37.760</a></span> | <span class="t">Okay, so we've got our L2 regularization, we've got our weight decay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4733" target="_blank">01:18:53.160</a></span> | <span class="t">What we need to be able to do now is to be able to somehow have the idea of defaults.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4740" target="_blank">01:19:00.860</a></span> | <span class="t">Because we don't want to have to say weight decay equals zero every time we want to turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4746" target="_blank">01:19:06.000</a></span> | <span class="t">it off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4747" target="_blank">01:19:07.120</a></span> | <span class="t">So see how we've attached some state here to our function object?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4752" target="_blank">01:19:12.020</a></span> | <span class="t">So the function now has something called defaults that says it's a dictionary with WD equals</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4757" target="_blank">01:19:17.000</a></span> | <span class="t">zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4759" target="_blank">01:19:19.040</a></span> | <span class="t">So let's just grab exactly the same optimizer we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4763" target="_blank">01:19:23.080</a></span> | <span class="t">But what we're going to do is we're going to maybe update our defaults with whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4770" target="_blank">01:19:30.880</a></span> | <span class="t">self.steppers has in their defaults.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4774" target="_blank">01:19:34.200</a></span> | <span class="t">And the reason it's maybe update is that it's not going to replace -- if you explicitly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4778" target="_blank">01:19:38.480</a></span> | <span class="t">say I want this weight decay, it's not going to update it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4781" target="_blank">01:19:41.680</a></span> | <span class="t">It will only update it if it's missing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4784" target="_blank">01:19:44.280</a></span> | <span class="t">And so that's just what this little loop does, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4786" target="_blank">01:19:46.360</a></span> | <span class="t">Just goes through each of the things, and then goes through each of the things in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4791" target="_blank">01:19:51.000</a></span> | <span class="t">dictionary, and it just checks if it's not there, then it updates it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4795" target="_blank">01:19:55.600</a></span> | <span class="t">So this is now -- everything else here is exactly the same as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4800" target="_blank">01:20:00.920</a></span> | <span class="t">So now we can say let's create an SGD optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4808" target="_blank">01:20:08.560</a></span> | <span class="t">It's just an optimizer with a SGD step and weight decay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4814" target="_blank">01:20:14.240</a></span> | <span class="t">And so let's create a learner, and let's try creating an optimizer, which is an SGD optimizer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4824" target="_blank">01:20:24.160</a></span> | <span class="t">with our model's parameters, with some learning rate, and make sure that the hyperparameter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4830" target="_blank">01:20:30.600</a></span> | <span class="t">for weight decay should be zero, the hyperparameter for LR should be .1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4834" target="_blank">01:20:34.880</a></span> | <span class="t">Yep, it passes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4836" target="_blank">01:20:36.920</a></span> | <span class="t">Let's try giving it a different weight decay, make sure it's there, okay, it passes as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4841" target="_blank">01:20:41.120</a></span> | <span class="t">So we've now got an ability to basically add any step functions we want, and those step</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4848" target="_blank">01:20:48.760</a></span> | <span class="t">functions can have their own state that gets added automatically to our optimization object,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4856" target="_blank">01:20:56.320</a></span> | <span class="t">and we can go ahead and fit, so that's fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4861" target="_blank">01:21:01.080</a></span> | <span class="t">So now we've got an SGD optimizer with weight decay is one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4871" target="_blank">01:21:11.520</a></span> | <span class="t">Let's now add momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4874" target="_blank">01:21:14.660</a></span> | <span class="t">So momentum is going to require a slightly better optimizer, or a slightly different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4878" target="_blank">01:21:18.960</a></span> | <span class="t">optimizer, because momentum needs some more state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4883" target="_blank">01:21:23.200</a></span> | <span class="t">It doesn't just have parameters and hyperparameters, but also momentum knows that for every set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4890" target="_blank">01:21:30.320</a></span> | <span class="t">of activations, it knows what were they updated by last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4895" target="_blank">01:21:35.640</a></span> | <span class="t">Because remember the momentum equation is, if momentum is .9, then it would be .9 times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4902" target="_blank">01:21:42.560</a></span> | <span class="t">whatever you did last time, plus this step, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4907" target="_blank">01:21:47.960</a></span> | <span class="t">So we actually need to track for every single parameter what happened last time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4914" target="_blank">01:21:54.320</a></span> | <span class="t">And that's actually quite a bit of state, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4916" target="_blank">01:21:56.520</a></span> | <span class="t">If you've got 10 million activations in your network, you've now got 10 million more floats</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4922" target="_blank">01:22:02.960</a></span> | <span class="t">that you have to store, because that's your momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4926" target="_blank">01:22:06.680</a></span> | <span class="t">So we're going to store that in a dictionary called state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4931" target="_blank">01:22:11.760</a></span> | <span class="t">So a stateful optimizer is just an optimizer that has state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4939" target="_blank">01:22:19.080</a></span> | <span class="t">And then we're going to have to have some stats.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4945" target="_blank">01:22:25.400</a></span> | <span class="t">And stats are a lot like steppers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4949" target="_blank">01:22:29.880</a></span> | <span class="t">They're objects that we're going to pass in to say, when we create this state, how do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4955" target="_blank">01:22:35.120</a></span> | <span class="t">you create it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4956" target="_blank">01:22:36.880</a></span> | <span class="t">So when you're doing momentum, what's the function that you run to calculate momentum?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4962" target="_blank">01:22:42.160</a></span> | <span class="t">So that's going to be called something of a stat class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4965" target="_blank">01:22:45.860</a></span> | <span class="t">So for example, momentum is calculated by simply averaging the gradient, like so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4973" target="_blank">01:22:53.960</a></span> | <span class="t">We take whatever the gradient averaged before, we multiply it by momentum, and we add the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4980" target="_blank">01:23:00.320</a></span> | <span class="t">current gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4981" target="_blank">01:23:01.700</a></span> | <span class="t">That's the definition of momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4986" target="_blank">01:23:06.160</a></span> | <span class="t">So this is an example of a stat class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4990" target="_blank">01:23:10.480</a></span> | <span class="t">So it's not enough just to have update, because we actually need this to be something at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4995" target="_blank">01:23:15.800</a></span> | <span class="t">start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4996" target="_blank">01:23:16.800</a></span> | <span class="t">We can't multiply by something that doesn't exist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=4998" target="_blank">01:23:18.680</a></span> | <span class="t">So we're also going to define something called init state that will create a dictionary containing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5004" target="_blank">01:23:24.640</a></span> | <span class="t">the initial state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5006" target="_blank">01:23:26.540</a></span> | <span class="t">So that's all that stateful optimizer is going to do, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5011" target="_blank">01:23:31.000</a></span> | <span class="t">It's going to look at each of our parameters, and it's going to check to see whether that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5018" target="_blank">01:23:38.480</a></span> | <span class="t">parameter already exists in the state dictionary, and if it doesn't, it hasn't been initialized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5023" target="_blank">01:23:43.780</a></span> | <span class="t">So we'll initialize it with an empty dictionary, and then we'll update it with the results</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5028" target="_blank">01:23:48.740</a></span> | <span class="t">of that init state call we just saw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5031" target="_blank">01:23:51.580</a></span> | <span class="t">So now that we have every parameter can now be looked up in this state dictionary to find</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5037" target="_blank">01:23:57.160</a></span> | <span class="t">out its state, and we can now, therefore, grab it, and then we can call update, like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5045" target="_blank">01:24:05.040</a></span> | <span class="t">so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5046" target="_blank">01:24:06.040</a></span> | <span class="t">Oh, this one's not opening, like so, to do, for example, average gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5051" target="_blank">01:24:11.080</a></span> | <span class="t">And then we can call compose with our parameter and our steppers, and now we don't just pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5058" target="_blank">01:24:18.900</a></span> | <span class="t">in our hyperparameters, but we also pass in our state.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5063" target="_blank">01:24:23.480</a></span> | <span class="t">So now that we have average gradients, which is sticking into this thing called grad average,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5072" target="_blank">01:24:32.040</a></span> | <span class="t">and it's going to be passed into our steppers, we can now do a momentum step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5077" target="_blank">01:24:37.860</a></span> | <span class="t">And the momentum step takes not just LR, but it's now going to be getting this grad average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5082" target="_blank">01:24:42.480</a></span> | <span class="t">And here is the momentum step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5086" target="_blank">01:24:46.180</a></span> | <span class="t">It's just this grad average times the learning rate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5091" target="_blank">01:24:51.440</a></span> | <span class="t">That's all you do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5093" target="_blank">01:24:53.160</a></span> | <span class="t">So now we can create an SGD with momentum optimizer with a line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5099" target="_blank">01:24:59.920</a></span> | <span class="t">It can have a momentum step, it can have a weight decay step, it can have an average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5104" target="_blank">01:25:04.560</a></span> | <span class="t">grad stat, we can even give it some default weight decay, and away we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5114" target="_blank">01:25:14.840</a></span> | <span class="t">So here's something that might just blow your mind.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5125" target="_blank">01:25:25.520</a></span> | <span class="t">Let me read it to you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5129" target="_blank">01:25:29.600</a></span> | <span class="t">Here is a paper, L2 regularization versus batch and weight norm.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5138" target="_blank">01:25:38.040</a></span> | <span class="t">Batch normalization is a commonly used trick to improve training of deep neural networks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5142" target="_blank">01:25:42.760</a></span> | <span class="t">and they also use L2 regularization ostensibly to prevent overfitting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5148" target="_blank">01:25:48.280</a></span> | <span class="t">However, we show that L2 regularization has no regularizing effect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5155" target="_blank">01:25:55.920</a></span> | <span class="t">What?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5158" target="_blank">01:25:58.320</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5161" target="_blank">01:26:01.320</a></span> | <span class="t">It's true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5162" target="_blank">01:26:02.900</a></span> | <span class="t">Watch this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5166" target="_blank">01:26:06.680</a></span> | <span class="t">I realized this when I was chatting to Sylvain at NeurIPS, and like we were walking around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5172" target="_blank">01:26:12.440</a></span> | <span class="t">the poster session, and I suddenly said to him, "Wait, Sylvain, if there's batch norm,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5181" target="_blank">01:26:21.440</a></span> | <span class="t">how can L2 regularization possibly work?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5184" target="_blank">01:26:24.660</a></span> | <span class="t">And I'll tell you what I laid out to him.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5186" target="_blank">01:26:26.880</a></span> | <span class="t">This is before I discovered this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5191" target="_blank">01:26:31.160</a></span> | <span class="t">We've got some layer of activations, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5195" target="_blank">01:26:35.920</a></span> | <span class="t">And some layer, and we've got some weights that was used to create that layer of activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5203" target="_blank">01:26:43.520</a></span> | <span class="t">So these are our weights, and these are our activations, and then we pass it through some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5209" target="_blank">01:26:49.080</a></span> | <span class="t">batch norm layer, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5210" target="_blank">01:26:50.780</a></span> | <span class="t">The batch norm layer does two things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5212" target="_blank">01:26:52.640</a></span> | <span class="t">It's got a bunch of adds, and it's got a bunch of multiplies, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5219" target="_blank">01:26:59.360</a></span> | <span class="t">It also normalizes, but these are the learned parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5222" target="_blank">01:27:02.720</a></span> | <span class="t">Okay, so we come along and we say, "Okay, weight decay time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5228" target="_blank">01:27:08.360</a></span> | <span class="t">Your weight decay is a million," and it goes, "Uh-oh, what do I do?"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5237" target="_blank">01:27:17.440</a></span> | <span class="t">Because now the squared of these, the sum of the squares of these gets multiplied by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5244" target="_blank">01:27:24.120</a></span> | <span class="t">1e6.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5246" target="_blank">01:27:26.200</a></span> | <span class="t">My loss function's destroyed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5248" target="_blank">01:27:28.520</a></span> | <span class="t">I can't possibly learn anything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5250" target="_blank">01:27:30.640</a></span> | <span class="t">But then the batch norm layer goes, "Oh, no, don't worry, friends," and it fills every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5257" target="_blank">01:27:37.120</a></span> | <span class="t">single one of these with 1 divided by a million, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5265" target="_blank">01:27:45.480</a></span> | <span class="t">So what just happened?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5268" target="_blank">01:27:48.760</a></span> | <span class="t">Well, no, sorry, it multiplies by positive, sorry, it multiplies them all by a million.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5278" target="_blank">01:27:58.880</a></span> | <span class="t">So what now happens, oh, these now have to get the same activations we had before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5284" target="_blank">01:28:04.880</a></span> | <span class="t">All of our weights, so like w1, now have to get divided by a million to get the same result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5293" target="_blank">01:28:13.600</a></span> | <span class="t">And so now our weight decay basically is nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5299" target="_blank">01:28:19.840</a></span> | <span class="t">So the two, so in other words, we could just, we can decide exactly how much weight decay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5306" target="_blank">01:28:26.680</a></span> | <span class="t">loss there is by simply using the batch norm molts, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5311" target="_blank">01:28:31.560</a></span> | <span class="t">Now the batch norm molts get a tiny bit of weight decay applied to them, unless you turn</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5316" target="_blank">01:28:36.200</a></span> | <span class="t">it off, which people often do, but it's tiny, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5318" target="_blank">01:28:38.760</a></span> | <span class="t">Because there's very few parameters here, and there's lots of parameters here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5324" target="_blank">01:28:44.520</a></span> | <span class="t">So it's true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5326" target="_blank">01:28:46.320</a></span> | <span class="t">It's true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5327" target="_blank">01:28:47.320</a></span> | <span class="t">L2 regularization has no regularizing effect, which is not what I've been telling people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5334" target="_blank">01:28:54.480</a></span> | <span class="t">who have been listening to these lessons the last three years, for which I apologize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5338" target="_blank">01:28:58.720</a></span> | <span class="t">I was wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5340" target="_blank">01:29:00.280</a></span> | <span class="t">I feel a little bit better in knowing that pretty much everybody in the community is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5344" target="_blank">01:29:04.400</a></span> | <span class="t">wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5345" target="_blank">01:29:05.400</a></span> | <span class="t">We've all been doing it wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5348" target="_blank">01:29:08.360</a></span> | <span class="t">So Twan Van Lahoven mentioned this in the middle of 2017.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5354" target="_blank">01:29:14.400</a></span> | <span class="t">Basically nobody noticed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5357" target="_blank">01:29:17.040</a></span> | <span class="t">There's a couple more papers I've mentioned in today's lesson notes from the last few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5363" target="_blank">01:29:23.160</a></span> | <span class="t">months where people are finally starting to really think about this, but I'm not aware</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5369" target="_blank">01:29:29.240</a></span> | <span class="t">of any other course, which is actually pointed out we're all doing it wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5374" target="_blank">01:29:34.160</a></span> | <span class="t">So you know how I keep mentioning how none of us know what we're doing?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5378" target="_blank">01:29:38.960</a></span> | <span class="t">We don't even know what L2 regularization does because it doesn't even do anything,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5386" target="_blank">01:29:46.680</a></span> | <span class="t">but it does do something because if you change it, something happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5393" target="_blank">01:29:53.200</a></span> | <span class="t">So this guy's wrong too.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5396" target="_blank">01:29:56.720</a></span> | <span class="t">It doesn't do nothing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5398" target="_blank">01:29:58.120</a></span> | <span class="t">So a more recent paper by a team led by Roger Gross has found three kind of ways in which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5406" target="_blank">01:30:06.000</a></span> | <span class="t">maybe regularization happens, but it's not the way you think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5410" target="_blank">01:30:10.560</a></span> | <span class="t">This is one of the papers in the lesson notes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5413" target="_blank">01:30:13.520</a></span> | <span class="t">But even in his paper, which is just a few months old, the abstract says basically, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5420" target="_blank">01:30:20.480</a></span> | <span class="t">the introduction says basically no one really understands what L2 regularization does.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5426" target="_blank">01:30:26.240</a></span> | <span class="t">So we have no idea what we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5428" target="_blank">01:30:28.880</a></span> | <span class="t">There's this thing that every model ever always has, and it totally doesn't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5435" target="_blank">01:30:35.520</a></span> | <span class="t">At least it doesn't work in the way we thought it did.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5438" target="_blank">01:30:38.440</a></span> | <span class="t">So that should make you feel better about, can I contribute to deep learning?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5444" target="_blank">01:30:44.960</a></span> | <span class="t">Obviously you can, because none of us have any idea what we're doing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5448" target="_blank">01:30:48.480</a></span> | <span class="t">And this is a great place to contribute, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5451" target="_blank">01:30:51.880</a></span> | <span class="t">Is like use all this telemetry that I'm showing you, activations of different layers, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5456" target="_blank">01:30:56.560</a></span> | <span class="t">see what happens experimentally, because the people who study this stuff, like what actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5462" target="_blank">01:31:02.240</a></span> | <span class="t">happens with batch norm and weight decay, most of them don't know how to train models,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5466" target="_blank">01:31:06.520</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5467" target="_blank">01:31:07.520</a></span> | <span class="t">The theory people, and then there's like the practitioners who forget about actually thinking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5472" target="_blank">01:31:12.840</a></span> | <span class="t">about the foundations at all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5474" target="_blank">01:31:14.760</a></span> | <span class="t">But if you can combine the two and say like, oh, let's actually try some experiments.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5479" target="_blank">01:31:19.080</a></span> | <span class="t">Let's see what happens really when we change weight decay, now that I've assumed we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5483" target="_blank">01:31:23.240</a></span> | <span class="t">know what we're doing, I'm sure you can find some really interesting results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5489" target="_blank">01:31:29.060</a></span> | <span class="t">So momentum is also interesting, and we really don't understand much about how things like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5494" target="_blank">01:31:34.640</a></span> | <span class="t">momentum work, but here's some nice pictures for you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5498" target="_blank">01:31:38.760</a></span> | <span class="t">And hopefully it'll give you a bit of a sense of momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5502" target="_blank">01:31:42.000</a></span> | <span class="t">Let's create 200 numbers equally spaced between minus four and four, and then let's create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5507" target="_blank">01:31:47.620</a></span> | <span class="t">another 200 random numbers that average 0.3.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5512" target="_blank">01:31:52.840</a></span> | <span class="t">And then let's create something that plots some function for these numbers, and we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5523" target="_blank">01:32:03.320</a></span> | <span class="t">going to look at this function for each value of something called beta.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5527" target="_blank">01:32:07.880</a></span> | <span class="t">And this is the function we're going to try plotting, and this is the momentum function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5533" target="_blank">01:32:13.720</a></span> | <span class="t">Okay, so what happens if we plot this function for each value of beta, for our data where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5544" target="_blank">01:32:24.120</a></span> | <span class="t">the y is random and averages 0.3?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5548" target="_blank">01:32:28.680</a></span> | <span class="t">So beta here is going to be our different values of momentum, and you can see what happens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5553" target="_blank">01:32:33.160</a></span> | <span class="t">is, with very little momentum, you just get very bumpy, very bumpy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5558" target="_blank">01:32:38.400</a></span> | <span class="t">Once you get up to a high momentum, you get a totally wrong answer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5563" target="_blank">01:32:43.400</a></span> | <span class="t">Why is this?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5564" target="_blank">01:32:44.400</a></span> | <span class="t">Because if you think about it, right, we're constantly saying 0.9 times whatever we had</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5570" target="_blank">01:32:50.520</a></span> | <span class="t">before, plus the new thing, then basically you're continuing to say like, oh, the thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5577" target="_blank">01:32:57.320</a></span> | <span class="t">I had before times 0.9 plus the new thing, and the things are all above zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5582" target="_blank">01:33:02.720</a></span> | <span class="t">So you end up with a number that's too high.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5585" target="_blank">01:33:05.960</a></span> | <span class="t">And this is why, if your momentum is too high, and basically you're way away from where you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5592" target="_blank">01:33:12.400</a></span> | <span class="t">need to be in weight space, so it keeps on saying go that way, go that way, go that way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5596" target="_blank">01:33:16.600</a></span> | <span class="t">If you get that enough with a high momentum, it will literally shoot off far faster than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5602" target="_blank">01:33:22.720</a></span> | <span class="t">is reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5603" target="_blank">01:33:23.720</a></span> | <span class="t">Okay, so this will give you a sense of why you've got to be really careful with high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5607" target="_blank">01:33:27.400</a></span> | <span class="t">momentum, it's literally biased to end up being a higher gradient than the actual gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5616" target="_blank">01:33:36.880</a></span> | <span class="t">So we can fix that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5619" target="_blank">01:33:39.600</a></span> | <span class="t">Like when you think about it, this is kind of dumb, right, because we shouldn't be saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5624" target="_blank">01:33:44.080</a></span> | <span class="t">beta times average plus yi, we should be saying beta times average plus 1 minus beta times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5633" target="_blank">01:33:53.680</a></span> | <span class="t">the other thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5634" target="_blank">01:33:54.680</a></span> | <span class="t">Like dampen the thing that we're adding in, and that's called an exponentially weighted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5639" target="_blank">01:33:59.760</a></span> | <span class="t">moving average, as we know, or lerp in PyTorch speak.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5646" target="_blank">01:34:06.920</a></span> | <span class="t">So let's plot the same thing as before but this time with exponentially weighted moving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5650" target="_blank">01:34:10.120</a></span> | <span class="t">average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5651" target="_blank">01:34:11.120</a></span> | <span class="t">Ah, perfect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5652" target="_blank">01:34:12.120</a></span> | <span class="t">Okay, so we're done, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5658" target="_blank">01:34:18.120</a></span> | <span class="t">Not quite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5659" target="_blank">01:34:19.260</a></span> | <span class="t">What if the thing that we're trying to match isn't just random but is some function?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5666" target="_blank">01:34:26.520</a></span> | <span class="t">So it looks something like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5669" target="_blank">01:34:29.940</a></span> | <span class="t">Well if we use a very small momentum with exponentially weighted moving averages, we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5674" target="_blank">01:34:34.040</a></span> | <span class="t">fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5675" target="_blank">01:34:35.040</a></span> | <span class="t">And I've added an outlier at the start just to show you what happens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5680" target="_blank">01:34:40.040</a></span> | <span class="t">Even with beta 0.7 we're fine, but uh-oh, now we've got trouble.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5686" target="_blank">01:34:46.280</a></span> | <span class="t">And the reason we've got trouble is that the second, third, fourth, fifth observations all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5695" target="_blank">01:34:55.560</a></span> | <span class="t">have a whole lot of this item number one in, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5698" target="_blank">01:34:58.840</a></span> | <span class="t">Because remember item number two is 0.99 times item number one plus 0.01 times item number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5706" target="_blank">01:35:06.640</a></span> | <span class="t">two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5707" target="_blank">01:35:07.640</a></span> | <span class="t">Right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5708" target="_blank">01:35:08.640</a></span> | <span class="t">And so item number one is massively biasing the start.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5713" target="_blank">01:35:13.680</a></span> | <span class="t">Even here, it takes a very long time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5716" target="_blank">01:35:16.960</a></span> | <span class="t">And the second thing that goes wrong is with this momentum is that you see how we're a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5720" target="_blank">01:35:20.400</a></span> | <span class="t">bit to the right of where we should be?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5722" target="_blank">01:35:22.560</a></span> | <span class="t">We're always running a bit behind where we should be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5725" target="_blank">01:35:25.240</a></span> | <span class="t">Which makes perfect sense, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5726" target="_blank">01:35:26.640</a></span> | <span class="t">Because we're always only taking 0.1 times the new thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5731" target="_blank">01:35:31.280</a></span> | <span class="t">So we can use de-biasing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5734" target="_blank">01:35:34.000</a></span> | <span class="t">De-biasing is what we saw last week and it turned out, thanks to Staz Beckman's discovery,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5739" target="_blank">01:35:39.520</a></span> | <span class="t">we didn't really need it, but we do need it now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5742" target="_blank">01:35:42.400</a></span> | <span class="t">And de-biasing is to divide by one minus beta to the power of whatever batch number we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5748" target="_blank">01:35:48.860</a></span> | <span class="t">up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5750" target="_blank">01:35:50.580</a></span> | <span class="t">So you can kind of tell, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5752" target="_blank">01:35:52.460</a></span> | <span class="t">If your initial starting point is zero, and that's what we use always when we're de-biasing,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5758" target="_blank">01:35:58.300</a></span> | <span class="t">we always start at zero, and beta is 0.9, then your first step is going to be 0.9 times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5765" target="_blank">01:36:05.800</a></span> | <span class="t">zero plus 0.1 times your item.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5770" target="_blank">01:36:10.520</a></span> | <span class="t">So in other words, you'll end up at 0.1 times your item, so you're going to end up 10 times</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5774" target="_blank">01:36:14.240</a></span> | <span class="t">lower than you should be.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5775" target="_blank">01:36:15.900</a></span> | <span class="t">So you need to divide by 0.1, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5778" target="_blank">01:36:18.740</a></span> | <span class="t">And if you kind of work through it, you'll see that each step is simply 0.1 to the power</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5790" target="_blank">01:36:30.280</a></span> | <span class="t">of one, two, three, four, five, and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5794" target="_blank">01:36:34.440</a></span> | <span class="t">And in fact, we have, of course, a spreadsheet showing you this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5800" target="_blank">01:36:40.760</a></span> | <span class="t">So if you have a look at the momentum bias spreadsheet, there we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5807" target="_blank">01:36:47.320</a></span> | <span class="t">So basically, here's our batch number, and let's say these are the values that are coming</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5812" target="_blank">01:36:52.220</a></span> | <span class="t">in, our gradients, five, one, one, one, one, one, five, one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5816" target="_blank">01:36:56.360</a></span> | <span class="t">Then basically, this is our exponentially weighted moving average, and here is our de-biasing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5823" target="_blank">01:37:03.300</a></span> | <span class="t">correction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5826" target="_blank">01:37:06.320</a></span> | <span class="t">And then here is our resulting de-biased exponentially weighted moving average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5831" target="_blank">01:37:11.280</a></span> | <span class="t">And then you can compare it to an actual moving average of the last few.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5837" target="_blank">01:37:17.640</a></span> | <span class="t">So that's basically how this works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5841" target="_blank">01:37:21.040</a></span> | <span class="t">And Silva loves writing LaTeX, so he wrote all this LaTeX that basically points out that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5846" target="_blank">01:37:26.840</a></span> | <span class="t">if you say what I just said, which is beta times this plus one minus beta times that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5853" target="_blank">01:37:33.520</a></span> | <span class="t">and you keep doing it to itself lots and lots of times, you end up with something that they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5857" target="_blank">01:37:37.680</a></span> | <span class="t">all cancel out to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5860" target="_blank">01:37:40.040</a></span> | <span class="t">So this is all we need to do to take our exponentially weighted moving average, divide it by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5865" target="_blank">01:37:45.320</a></span> | <span class="t">minus beta to the power of i plus one, and look at that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5870" target="_blank">01:37:50.260</a></span> | <span class="t">It's pretty good, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5871" target="_blank">01:37:51.680</a></span> | <span class="t">It de-biases very quickly, even if you have a bad starting point, and it looks pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5875" target="_blank">01:37:55.640</a></span> | <span class="t">good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5876" target="_blank">01:37:56.640</a></span> | <span class="t">It's not magic, but you can see why a beta of .9 is popular.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5883" target="_blank">01:38:03.040</a></span> | <span class="t">It's kind of got a pretty nice behavior.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5886" target="_blank">01:38:06.320</a></span> | <span class="t">So let's use all that to create atom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5890" target="_blank">01:38:10.360</a></span> | <span class="t">So what's atom?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5892" target="_blank">01:38:12.120</a></span> | <span class="t">Atom is dampened de-biased momentum, that's the numerator, divided by dampened de-biased</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5906" target="_blank">01:38:26.200</a></span> | <span class="t">average sum of squared gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5909" target="_blank">01:38:29.380</a></span> | <span class="t">And so we talked about why atom does that before, we won't go into the details.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5914" target="_blank">01:38:34.320</a></span> | <span class="t">But here's our average gradient again, but this time we've added optional dampening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5920" target="_blank">01:38:40.440</a></span> | <span class="t">So if you say I want dampening, then we'll set momentum dampening to that, otherwise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5926" target="_blank">01:38:46.960</a></span> | <span class="t">we'll set it to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5929" target="_blank">01:38:49.440</a></span> | <span class="t">And so this is exactly the same as before, but with dampening.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5934" target="_blank">01:38:54.660</a></span> | <span class="t">Average squared gradients is exactly the same as average gradients, we could definitely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5938" target="_blank">01:38:58.480</a></span> | <span class="t">refactor these a lot, so this is all exactly the same as before, except we'll call them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5943" target="_blank">01:39:03.640</a></span> | <span class="t">different things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5944" target="_blank">01:39:04.640</a></span> | <span class="t">We'll call it squared dampening, we'll call it squared averages, and this time, rather</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5948" target="_blank">01:39:08.160</a></span> | <span class="t">than just adding in the p-grad data, we will multiply p-grad data by itself, in other words,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5956" target="_blank">01:39:16.720</a></span> | <span class="t">we get the squareds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5957" target="_blank">01:39:17.720</a></span> | <span class="t">This is the only difference, and we store it in a different name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5961" target="_blank">01:39:21.920</a></span> | <span class="t">So with those, we're also going to need to de-bias, which means we need to know what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5966" target="_blank">01:39:26.800</a></span> | <span class="t">step we're up to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5968" target="_blank">01:39:28.280</a></span> | <span class="t">So here's a stat, which just literally counts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5974" target="_blank">01:39:34.500</a></span> | <span class="t">So here's our de-bias function, the one we just saw.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5978" target="_blank">01:39:38.680</a></span> | <span class="t">And so here's atom.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5980" target="_blank">01:39:40.240</a></span> | <span class="t">Once that's in place, atom is just the de-bias momentum with momentum dampening, the de-bias</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5984" target="_blank">01:39:44.960</a></span> | <span class="t">squared momentum with squared momentum dampening, and then we just take the parameter, and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5992" target="_blank">01:39:52.480</a></span> | <span class="t">our learning rate, and we've got the de-bias in here, our gradient average, and divided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=5999" target="_blank">01:39:59.760</a></span> | <span class="t">by the squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6003" target="_blank">01:40:03.400</a></span> | <span class="t">And we also have our epsilon, oh, this is in the wrong spot, be careful, epsilon should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6009" target="_blank">01:40:09.680</a></span> | <span class="t">always go inside the square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6015" target="_blank">01:40:15.240</a></span> | <span class="t">So that's an atom step, so now we can create an atom optimizer in one line of code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6023" target="_blank">01:40:23.120</a></span> | <span class="t">And so there's our atom optimizer, it has average grads, it's got average squared grads,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6027" target="_blank">01:40:27.760</a></span> | <span class="t">it's got a step, and we can now try it out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6037" target="_blank">01:40:37.500</a></span> | <span class="t">So here's lamb.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6041" target="_blank">01:40:41.880</a></span> | <span class="t">By the way, these equations are a little nicer than these equations, and I want to point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6047" target="_blank">01:40:47.480</a></span> | <span class="t">something out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6049" target="_blank">01:40:49.640</a></span> | <span class="t">Mathematicians hate refactoring.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6051" target="_blank">01:40:51.980</a></span> | <span class="t">Don't be like them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6053" target="_blank">01:40:53.740</a></span> | <span class="t">Look at this, m over v plus epsilon root, lambda, da-da-da, it's the same as this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6060" target="_blank">01:41:00.960</a></span> | <span class="t">So like, it's just so complicated when things appear the same way in multiple places, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6065" target="_blank">01:41:05.980</a></span> | <span class="t">So when we did this equation, we gave that a new name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6070" target="_blank">01:41:10.180</a></span> | <span class="t">And so now we can just look at r2, goes from all that to just that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6076" target="_blank">01:41:16.320</a></span> | <span class="t">And wt goes from all that to just that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6080" target="_blank">01:41:20.560</a></span> | <span class="t">And so when you pull these things out, when you refactor your math, it's much easier to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6085" target="_blank">01:41:25.520</a></span> | <span class="t">see what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6088" target="_blank">01:41:28.040</a></span> | <span class="t">So here's the cool thing, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6090" target="_blank">01:41:30.600</a></span> | <span class="t">When we look at this, even if you're a terrible mathematician like me, you're going to start</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6095" target="_blank">01:41:35.040</a></span> | <span class="t">to recognize some patterns, and that's the trick to being a less terrible mathematician</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6098" target="_blank">01:41:38.560</a></span> | <span class="t">is recognizing patterns.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6100" target="_blank">01:41:40.560</a></span> | <span class="t">Beta times something plus one minus beta times another thing is exponentially weighted moving</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6105" target="_blank">01:41:45.880</a></span> | <span class="t">average, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6108" target="_blank">01:41:48.360</a></span> | <span class="t">So here's one exponentially weighted moving average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6110" target="_blank">01:41:50.160</a></span> | <span class="t">Here's another exponentially weighted moving average.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6112" target="_blank">01:41:52.040</a></span> | <span class="t">This one has a gradient.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6113" target="_blank">01:41:53.640</a></span> | <span class="t">This one has gradient squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6115" target="_blank">01:41:55.280</a></span> | <span class="t">This means element-wise multiplication.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6118" target="_blank">01:41:58.960</a></span> | <span class="t">So these are the exponentially weighted moving average of the gradient and the gradient squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6123" target="_blank">01:42:03.360</a></span> | <span class="t">Oh, beta to the t, debiasing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6127" target="_blank">01:42:07.280</a></span> | <span class="t">So that's the debiased version of m.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6129" target="_blank">01:42:09.280</a></span> | <span class="t">There's the debiased version of v.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6136" target="_blank">01:42:16.520</a></span> | <span class="t">Not to move the epsilon?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6138" target="_blank">01:42:18.280</a></span> | <span class="t">Really?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6139" target="_blank">01:42:19.280</a></span> | <span class="t">Sylvain has a message, don't move the epsilon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6145" target="_blank">01:42:25.540</a></span> | <span class="t">Don't listen to Jeremy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6146" target="_blank">01:42:26.540</a></span> | <span class="t">Don't listen to Jeremy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6148" target="_blank">01:42:28.040</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6149" target="_blank">01:42:29.040</a></span> | <span class="t">Sylvain's an actual math guy, so- In Adam, the epsilon goes outside the square</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6153" target="_blank">01:42:33.240</a></span> | <span class="t">root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6154" target="_blank">01:42:34.240</a></span> | <span class="t">No way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6155" target="_blank">01:42:35.240</a></span> | <span class="t">I always thought epsilon should always go inside the square root.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6159" target="_blank">01:42:39.320</a></span> | <span class="t">Jeremy just did a fix I pushed a week ago where our Adam wasn't working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6165" target="_blank">01:42:45.600</a></span> | <span class="t">Let's press Control-Z a few times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6167" target="_blank">01:42:47.040</a></span> | <span class="t">There we go.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6168" target="_blank">01:42:48.680</a></span> | <span class="t">That's great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6169" target="_blank">01:42:49.680</a></span> | <span class="t">So to explain why this matters and why there is no right answer, here's the difference,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6176" target="_blank">01:42:56.240</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6177" target="_blank">01:42:57.240</a></span> | <span class="t">If this is 1e next 7, then having it here versus having it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6184" target="_blank">01:43:04.640</a></span> | <span class="t">So like the square root of 1e next 7 is very different to 1e next 7.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6194" target="_blank">01:43:14.360</a></span> | <span class="t">And in batch norm, they do put it inside the square root and according to Sylvain and Adam,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6201" target="_blank">01:43:21.040</a></span> | <span class="t">they don't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6202" target="_blank">01:43:22.040</a></span> | <span class="t">Neither is like the right place to put it or the wrong place to put it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6206" target="_blank">01:43:26.980</a></span> | <span class="t">If you don't put it in the same place as they do in paper, it's just a totally different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6211" target="_blank">01:43:31.240</a></span> | <span class="t">number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6212" target="_blank">01:43:32.240</a></span> | <span class="t">And this is a good time to talk about epsilon and Adam because I love epsilon and Adam because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6219" target="_blank">01:43:39.280</a></span> | <span class="t">like what if we put, made epsilon equal to 1, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6225" target="_blank">01:43:45.980</a></span> | <span class="t">Then we've got the kind of momentumized, the kind of momentum term on the numerator and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6234" target="_blank">01:43:54.280</a></span> | <span class="t">the denominator, we've got the root sum of squares of the root of the exponentially weighted</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6242" target="_blank">01:44:02.560</a></span> | <span class="t">average squared gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6244" target="_blank">01:44:04.960</a></span> | <span class="t">So we're dividing by that plus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6248" target="_blank">01:44:08.240</a></span> | <span class="t">And most of the time, the gradients are going to be smaller than 1 and the squared version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6253" target="_blank">01:44:13.320</a></span> | <span class="t">is going to be much smaller than 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6255" target="_blank">01:44:15.200</a></span> | <span class="t">So basically then, the 1 is going to be much bigger than this, so it basically makes this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6263" target="_blank">01:44:23.160</a></span> | <span class="t">go away.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6264" target="_blank">01:44:24.600</a></span> | <span class="t">So if epsilon is 1, it's pretty close to being standard SGD with momentum or at least debiased</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6272" target="_blank">01:44:32.720</a></span> | <span class="t">dampened momentum.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6275" target="_blank">01:44:35.560</a></span> | <span class="t">Whereas if epsilon is 1e next 7, then we're basically saying, oh, we want to really use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6284" target="_blank">01:44:44.240</a></span> | <span class="t">these different exponentially weighted moving average squared gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6290" target="_blank">01:44:50.800</a></span> | <span class="t">And this is really important because if you have some activation that has had a very small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6301" target="_blank">01:45:01.680</a></span> | <span class="t">squared gradients for a while, this could well be like 1e next 6, which means when you divide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6308" target="_blank">01:45:08.400</a></span> | <span class="t">by it, you're multiplying by a million.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6311" target="_blank">01:45:11.520</a></span> | <span class="t">And that could absolutely kill your optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6314" target="_blank">01:45:14.700</a></span> | <span class="t">So the trick to making atom and atom-like things work well is to make this about 0.1, somewhere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6323" target="_blank">01:45:23.240</a></span> | <span class="t">between 1e next 3 and 1e next 1 tends to work pretty well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6327" target="_blank">01:45:27.080</a></span> | <span class="t">Most people use 1e next 7, which it just makes no sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6332" target="_blank">01:45:32.320</a></span> | <span class="t">There's no way that you want to be able to multiply your step by 10 million times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6338" target="_blank">01:45:38.800</a></span> | <span class="t">That's just never going to be a good idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6340" target="_blank">01:45:40.520</a></span> | <span class="t">So there's another place that epsilon is a super important thing to think about.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6347" target="_blank">01:45:47.200</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6349" target="_blank">01:45:49.680</a></span> | <span class="t">So LAM then is stuff that we've all seen before, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6356" target="_blank">01:45:56.000</a></span> | <span class="t">So it's debiased, this is atom, right, debiased exponentially weighted moving averages of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6362" target="_blank">01:46:02.860</a></span> | <span class="t">gradients and gradient squared.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6365" target="_blank">01:46:05.760</a></span> | <span class="t">This here is the norm of the weights.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6369" target="_blank">01:46:09.840</a></span> | <span class="t">The norm is just the sum of the roots and the squares.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6373" target="_blank">01:46:13.520</a></span> | <span class="t">So this is just weight decay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6375" target="_blank">01:46:15.000</a></span> | <span class="t">So LAM has weight decay built in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6379" target="_blank">01:46:19.040</a></span> | <span class="t">This one here, hopefully you recognize as being the atom step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6385" target="_blank">01:46:25.020</a></span> | <span class="t">And so this is the norm of the atom step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6391" target="_blank">01:46:31.060</a></span> | <span class="t">So basically what LAM is doing is it's atom, but what we do is we average all the steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6401" target="_blank">01:46:41.520</a></span> | <span class="t">over a whole layer, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6404" target="_blank">01:46:44.440</a></span> | <span class="t">That's why these L's are really important, right, because these things are happening</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6407" target="_blank">01:46:47.420</a></span> | <span class="t">over a layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6408" target="_blank">01:46:48.980</a></span> | <span class="t">And so basically we're taking, so here's our debiased momentum, debiased squared momentum,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6416" target="_blank">01:46:56.320</a></span> | <span class="t">right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6417" target="_blank">01:46:57.560</a></span> | <span class="t">And then here's our one, and look, here's this mean, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6422" target="_blank">01:47:02.000</a></span> | <span class="t">So it's for a layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6423" target="_blank">01:47:03.000</a></span> | <span class="t">Because remember, each stepper is created for a layer, for a parameter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6427" target="_blank">01:47:07.680</a></span> | <span class="t">I shouldn't say a layer, for a parameter, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6431" target="_blank">01:47:11.140</a></span> | <span class="t">So this is kind of like both exciting and annoying because I'd been working on this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6437" target="_blank">01:47:17.600</a></span> | <span class="t">exact idea, which is basically atom but averaged out over a layer for the previous week.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6445" target="_blank">01:47:25.400</a></span> | <span class="t">And then this LAM paper came out, and I was like, "Oh, that's cool.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6448" target="_blank">01:47:28.760</a></span> | <span class="t">Some paper about BERT training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6450" target="_blank">01:47:30.120</a></span> | <span class="t">I'll check it out."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6451" target="_blank">01:47:31.120</a></span> | <span class="t">And it's like, "Oh, we do it with a new optimizer."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6452" target="_blank">01:47:32.440</a></span> | <span class="t">And I looked at the new optimizer and was like, "It's just the optimizer I wrote a week</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6457" target="_blank">01:47:37.400</a></span> | <span class="t">before we were going to present it."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6459" target="_blank">01:47:39.320</a></span> | <span class="t">So I'm thrilled that this thing exists.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6462" target="_blank">01:47:42.360</a></span> | <span class="t">I think it's exactly what we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6465" target="_blank">01:47:45.320</a></span> | <span class="t">And you should definitely check out LAM because it makes so much sense to use the average</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6473" target="_blank">01:47:53.440</a></span> | <span class="t">over the layer of that step as a kind of a, you can see here, it's kind of got this normalization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6480" target="_blank">01:48:00.240</a></span> | <span class="t">going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6482" target="_blank">01:48:02.520</a></span> | <span class="t">Because it's just really unlikely that every individual parameter in that tensor, you don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6489" target="_blank">01:48:09.480</a></span> | <span class="t">want to divide it by its squared gradients because it's going to vary too much.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6494" target="_blank">01:48:14.120</a></span> | <span class="t">There's just too much chance that there's going to be a 1e neg 7 in there somewhere</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6497" target="_blank">01:48:17.920</a></span> | <span class="t">or something, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6499" target="_blank">01:48:19.880</a></span> | <span class="t">So this to me is exactly the right way to do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6502" target="_blank">01:48:22.800</a></span> | <span class="t">And this is kind of like the first optimizer I've seen where I just kind of think like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6508" target="_blank">01:48:28.440</a></span> | <span class="t">"Oh, finally I feel like people are heading in the right direction."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6511" target="_blank">01:48:31.760</a></span> | <span class="t">But when you really study this optimizer, you realize that everything we thought about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6515" target="_blank">01:48:35.240</a></span> | <span class="t">optimizers kind of doesn't make sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6517" target="_blank">01:48:37.920</a></span> | <span class="t">The way optimizers are going with things like LAM is the whole idea of what is the magnitude</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6527" target="_blank">01:48:47.560</a></span> | <span class="t">of our step, it just looks very different to everything we kind of thought of before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6533" target="_blank">01:48:53.320</a></span> | <span class="t">So check out this paper.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6535" target="_blank">01:48:55.160</a></span> | <span class="t">You know, this bath might look slightly intimidating at first, but now you know all of these things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6541" target="_blank">01:49:01.240</a></span> | <span class="t">You know, what all they all are and you know why they exist.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6544" target="_blank">01:49:04.880</a></span> | <span class="t">So I think you'll be fine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6548" target="_blank">01:49:08.020</a></span> | <span class="t">So here's how we create a LAM optimizer and here's how we fit with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6554" target="_blank">01:49:14.280</a></span> | <span class="t">Okay, that is that, unless Silvass says otherwise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6563" target="_blank">01:49:23.520</a></span> | <span class="t">All right.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6568" target="_blank">01:49:28.560</a></span> | <span class="t">So as I was building this, I got so sick of runner because I kept on wondering when do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6574" target="_blank">01:49:34.800</a></span> | <span class="t">I pass a runner?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6575" target="_blank">01:49:35.800</a></span> | <span class="t">When do I pass a learner?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6578" target="_blank">01:49:38.520</a></span> | <span class="t">And then I kind of suddenly thought, like, again, like, once every month or two, I actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6586" target="_blank">01:49:46.480</a></span> | <span class="t">sit and think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6588" target="_blank">01:49:48.680</a></span> | <span class="t">And it's only when I get really frustrated, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6591" target="_blank">01:49:51.620</a></span> | <span class="t">So like I was getting really frustrated with runners and I actually decided to sit and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6595" target="_blank">01:49:55.000</a></span> | <span class="t">think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6596" target="_blank">01:49:56.400</a></span> | <span class="t">And I looked at the definition of learner and I thought, wait, it doesn't do anything at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6602" target="_blank">01:50:02.720</a></span> | <span class="t">all.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6604" target="_blank">01:50:04.160</a></span> | <span class="t">It stores three things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6606" target="_blank">01:50:06.200</a></span> | <span class="t">What kind of class just stores three things?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6608" target="_blank">01:50:08.580</a></span> | <span class="t">And then a runner has a learner in it that stores three things, like, why don't we store</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6615" target="_blank">01:50:15.720</a></span> | <span class="t">the three things in the runner?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6618" target="_blank">01:50:18.920</a></span> | <span class="t">So I took the runner, I took that line of code, I copied it and I pasted it just here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6626" target="_blank">01:50:26.280</a></span> | <span class="t">I then renamed runner to learner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6629" target="_blank">01:50:29.160</a></span> | <span class="t">I then found everything that said self.learn and removed the .learn and I was done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6635" target="_blank">01:50:35.840</a></span> | <span class="t">And now there's no more runner.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6637" target="_blank">01:50:37.720</a></span> | <span class="t">And it's like, oh, it's just one of those obvious refactorings that as soon as I did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6642" target="_blank">01:50:42.420</a></span> | <span class="t">it, Sylvain was like, why didn't you do it that way in the first place?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6647" target="_blank">01:50:47.500</a></span> | <span class="t">And I was like, why didn't you fix it that way in the first place?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6649" target="_blank">01:50:49.680</a></span> | <span class="t">But now that we've done it, like, this is so much easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6652" target="_blank">01:50:52.920</a></span> | <span class="t">There's no more get learn run, there's no more having to match these things together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6656" target="_blank">01:50:56.840</a></span> | <span class="t">It's just super simple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6658" target="_blank">01:50:58.920</a></span> | <span class="t">So one of the nice things I like about this kind of Jupyter style of development is I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6664" target="_blank">01:51:04.200</a></span> | <span class="t">spend a month or two just, like, immersing myself in the code in this very experimental</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6671" target="_blank">01:51:11.120</a></span> | <span class="t">way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6672" target="_blank">01:51:12.120</a></span> | <span class="t">And I feel totally fine throwing it all away and changing everything because, like, everything's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6676" target="_blank">01:51:16.120</a></span> | <span class="t">small and I can, like, fiddle around with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6679" target="_blank">01:51:19.200</a></span> | <span class="t">And then after a couple of months, you know, Sylvain and I will just kind of go like, okay,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6684" target="_blank">01:51:24.760</a></span> | <span class="t">there's a bunch of things here that work nicely together and we turn it into some modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6689" target="_blank">01:51:29.440</a></span> | <span class="t">And so that's how fast.ai version one happened.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6693" target="_blank">01:51:33.840</a></span> | <span class="t">People often say to us, like, turning it into modules, what a nightmare that must have been.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6699" target="_blank">01:51:39.120</a></span> | <span class="t">So here's what was required for me to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6703" target="_blank">01:51:43.720</a></span> | <span class="t">I typed into Skype, Sylvain, please turn this into a module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6708" target="_blank">01:51:48.000</a></span> | <span class="t">So that was pretty easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6710" target="_blank">01:51:50.040</a></span> | <span class="t">And then three hours later, Sylvain typed back and he said, done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6714" target="_blank">01:51:54.040</a></span> | <span class="t">It was three hours of work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6715" target="_blank">01:51:55.560</a></span> | <span class="t">You know, it took, you know, it was four, five, six months of development in notebooks,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6721" target="_blank">01:52:01.680</a></span> | <span class="t">three hours to convert it into modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6723" target="_blank">01:52:03.800</a></span> | <span class="t">So it's really -- it's not a hassle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6727" target="_blank">01:52:07.120</a></span> | <span class="t">And I think this -- I find this quite delightful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6728" target="_blank">01:52:08.920</a></span> | <span class="t">It works super well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6731" target="_blank">01:52:11.680</a></span> | <span class="t">So no more runner, thank God.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6734" target="_blank">01:52:14.840</a></span> | <span class="t">Runner is now Cordelona.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6735" target="_blank">01:52:15.840</a></span> | <span class="t">We're kind of back to where we were.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6739" target="_blank">01:52:19.280</a></span> | <span class="t">We want progress bars.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6744" target="_blank">01:52:24.760</a></span> | <span class="t">Sylvain wrote this fantastic package called Fast Progress, which you should totally check</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6749" target="_blank">01:52:29.200</a></span> | <span class="t">out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6750" target="_blank">01:52:30.680</a></span> | <span class="t">And we're allowed to import it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6752" target="_blank">01:52:32.760</a></span> | <span class="t">Because remember, we're allowed to import modules that are not data science modules.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6757" target="_blank">01:52:37.000</a></span> | <span class="t">Progress bar is not a data science module.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6759" target="_blank">01:52:39.200</a></span> | <span class="t">But now we need to attach this progress bar to our callback system.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6764" target="_blank">01:52:44.240</a></span> | <span class="t">So let's grab our ImageNet data as before, create a little thing with, I don't know,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6769" target="_blank">01:52:49.560</a></span> | <span class="t">four, 32 filled layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6772" target="_blank">01:52:52.040</a></span> | <span class="t">Let's rewrite our stats callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6776" target="_blank">01:52:56.720</a></span> | <span class="t">It's basically exactly the same as it was before, except now we're storing our stats</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6781" target="_blank">01:53:01.440</a></span> | <span class="t">in an array, okay?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6784" target="_blank">01:53:04.240</a></span> | <span class="t">And we're just passing off the array to logger.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6787" target="_blank">01:53:07.560</a></span> | <span class="t">Remember logger is just a print statement at this stage.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6792" target="_blank">01:53:12.240</a></span> | <span class="t">And then we will create our progress bar callback.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6798" target="_blank">01:53:18.600</a></span> | <span class="t">And that is actually the entirety of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6800" target="_blank">01:53:20.920</a></span> | <span class="t">That's all we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6802" target="_blank">01:53:22.120</a></span> | <span class="t">So with that, we can now add progress callback to our callback functions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6808" target="_blank">01:53:28.000</a></span> | <span class="t">And grab our learner, no runner, fit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6813" target="_blank">01:53:33.480</a></span> | <span class="t">Now that's kind of magic, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6815" target="_blank">01:53:35.320</a></span> | <span class="t">That's all the code we needed to make this happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6819" target="_blank">01:53:39.200</a></span> | <span class="t">And look at the end.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6820" target="_blank">01:53:40.200</a></span> | <span class="t">Oh, creates a nice little table.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6822" target="_blank">01:53:42.720</a></span> | <span class="t">Pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6823" target="_blank">01:53:43.720</a></span> | <span class="t">So this is, you know, thanks to just careful, simple, decoupled software engineering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6830" target="_blank">01:53:50.080</a></span> | <span class="t">We just said, okay, when you start fitting, you've got to create the master bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6834" target="_blank">01:53:54.200</a></span> | <span class="t">So that's the thing that tracks the epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6838" target="_blank">01:53:58.320</a></span> | <span class="t">And then tell the master bar we're starting.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6840" target="_blank">01:54:00.920</a></span> | <span class="t">And then replace the logger function, not with print, but with master bar.write.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6845" target="_blank">01:54:05.400</a></span> | <span class="t">So it's going to print the HTML into there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6849" target="_blank">01:54:09.160</a></span> | <span class="t">And then after we've done a batch, update our progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6855" target="_blank">01:54:15.320</a></span> | <span class="t">When we begin an epoch or begin validating, we'll have to create a new progress bar.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6859" target="_blank">01:54:19.800</a></span> | <span class="t">And when we're done fitting, tell the master bar we're finished.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6863" target="_blank">01:54:23.120</a></span> | <span class="t">That's it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6864" target="_blank">01:54:24.520</a></span> | <span class="t">So it's very easy to, once you have a system like this, to integrate with other libraries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6869" target="_blank">01:54:29.360</a></span> | <span class="t">if you want to use TensorBoard or VisDum or send yourself a Twilio message or whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6879" target="_blank">01:54:39.080</a></span> | <span class="t">It's super easy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6882" target="_blank">01:54:42.600</a></span> | <span class="t">Okay, so we're going to finish, I think we're going to finish, unless this goes faster than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6889" target="_blank">01:54:49.480</a></span> | <span class="t">I expect, with data augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6892" target="_blank">01:54:52.000</a></span> | <span class="t">So so far, we've seen how to create our optimizers, we've seen how to create our data blocks API.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6898" target="_blank">01:54:58.160</a></span> | <span class="t">And we can use all that to train a reasonably good image net model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6903" target="_blank">01:55:03.240</a></span> | <span class="t">But to make a better image net model, it's a bit short of data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6907" target="_blank">01:55:07.360</a></span> | <span class="t">So we should use data augmentation as we all know.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6911" target="_blank">01:55:11.360</a></span> | <span class="t">Now, so let's load it in as before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6917" target="_blank">01:55:17.080</a></span> | <span class="t">And let's just grab an image list for now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6920" target="_blank">01:55:20.360</a></span> | <span class="t">The only transforms, we're going to use resize fixed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6924" target="_blank">01:55:24.140</a></span> | <span class="t">And here's our chap with a tench.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6927" target="_blank">01:55:27.040</a></span> | <span class="t">And let's just actually open the original pillow image without resizing it to see what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6931" target="_blank">01:55:31.200</a></span> | <span class="t">he looks like full size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6932" target="_blank">01:55:32.520</a></span> | <span class="t">So here he is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6935" target="_blank">01:55:35.240</a></span> | <span class="t">And I want to point something out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6938" target="_blank">01:55:38.360</a></span> | <span class="t">When you resize, there are various resampling methods you can use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6943" target="_blank">01:55:43.320</a></span> | <span class="t">So basically, when you go from one size image to another size image, do you like take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6947" target="_blank">01:55:47.720</a></span> | <span class="t">pixels and take the average of them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6950" target="_blank">01:55:50.200</a></span> | <span class="t">Or do you put a little cubic spline through them?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6953" target="_blank">01:55:53.880</a></span> | <span class="t">Or what?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6954" target="_blank">01:55:54.920</a></span> | <span class="t">And so these are called resampling methods, and pillow has a few.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6958" target="_blank">01:55:58.720</a></span> | <span class="t">They suggest when downsampling, so going from big to small, you should use anti alias.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6964" target="_blank">01:56:04.200</a></span> | <span class="t">So here's what you do, when you're augmenting your data, and this is like nothing I'm going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6969" target="_blank">01:56:09.680</a></span> | <span class="t">to say today is really focused on vision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6972" target="_blank">01:56:12.340</a></span> | <span class="t">If you're doing audio, if you're doing text, if you're doing music, whatever, augment your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6978" target="_blank">01:56:18.360</a></span> | <span class="t">data and look at or listen to or understand your augmented data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6983" target="_blank">01:56:23.600</a></span> | <span class="t">So don't like just chuck this into a model, but like look at what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6988" target="_blank">01:56:28.680</a></span> | <span class="t">So if I want to know what's going on here, I need to be able to see the texture of this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6994" target="_blank">01:56:34.840</a></span> | <span class="t">tension.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6995" target="_blank">01:56:35.840</a></span> | <span class="t">Now, I'm not very good at tensions, but I do know a bit about clothes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=6999" target="_blank">01:56:39.420</a></span> | <span class="t">So let's say if we were trying to see what this guy's wearing, it's a checkered shirt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7004" target="_blank">01:56:44.080</a></span> | <span class="t">So let's zoom in and see what this guy's wearing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7007" target="_blank">01:56:47.680</a></span> | <span class="t">I have no idea.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7008" target="_blank">01:56:48.680</a></span> | <span class="t">The checkered shirt's gone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7011" target="_blank">01:56:51.680</a></span> | <span class="t">So like, I can tell that this is going to totally break my model if we use this kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7018" target="_blank">01:56:58.840</a></span> | <span class="t">of image augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7021" target="_blank">01:57:01.360</a></span> | <span class="t">So let's try a few more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7022" target="_blank">01:57:02.780</a></span> | <span class="t">What if instead of anti aliasing, we use bilinear, which is the most common?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7026" target="_blank">01:57:06.480</a></span> | <span class="t">No, I still don't know what he's wearing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7030" target="_blank">01:57:10.680</a></span> | <span class="t">Okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7031" target="_blank">01:57:11.880</a></span> | <span class="t">What if we use nearest neighbors, which nobody uses because everybody knows it's terrible?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7036" target="_blank">01:57:16.880</a></span> | <span class="t">Oh, it totally works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7040" target="_blank">01:57:20.560</a></span> | <span class="t">So yeah, just look at stuff and try and find something that you can study to see whether</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7048" target="_blank">01:57:28.880</a></span> | <span class="t">it works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7049" target="_blank">01:57:29.880</a></span> | <span class="t">Here's something interesting, though.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7053" target="_blank">01:57:33.820</a></span> | <span class="t">This looks better still, don't you think?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7056" target="_blank">01:57:36.720</a></span> | <span class="t">And this is interesting because what I did here was I did two steps.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7059" target="_blank">01:57:39.580</a></span> | <span class="t">I first of all resized to 256 by 256 with bicubic, and then I resized to my final 128</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7067" target="_blank">01:57:47.800</a></span> | <span class="t">by 128 with nearest neighbors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7070" target="_blank">01:57:50.080</a></span> | <span class="t">And so sometimes you can combine things together in steps to get really good results.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7075" target="_blank">01:57:55.360</a></span> | <span class="t">Anyway, I didn't want to go into the details here, I'm just saying that when we talk about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7080" target="_blank">01:58:00.440</a></span> | <span class="t">image augmentation, your test is to look at or listen to or whatever your augmented data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7088" target="_blank">01:58:08.080</a></span> | <span class="t">So resizing is very important for vision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7092" target="_blank">01:58:12.620</a></span> | <span class="t">Flipping is a great data augmentation for vision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7096" target="_blank">01:58:16.480</a></span> | <span class="t">I don't particularly care about flipping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7098" target="_blank">01:58:18.000</a></span> | <span class="t">The main thing I want to point out is this, at this point, our tensors contain bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7104" target="_blank">01:58:24.600</a></span> | <span class="t">Calculating with bytes and moving bytes around is very, very fast.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7108" target="_blank">01:58:28.440</a></span> | <span class="t">And we really care about this because when we were doing the Dawnbench competition, one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7113" target="_blank">01:58:33.100</a></span> | <span class="t">of our biggest issues for speed was getting our data augmentation running fast enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7117" target="_blank">01:58:37.840</a></span> | <span class="t">and doing stuff on floats is slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7121" target="_blank">01:58:41.300</a></span> | <span class="t">If you're flipping something, flipping bytes is identical to flipping floats in terms of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7126" target="_blank">01:58:46.280</a></span> | <span class="t">the outcome, so you should definitely do your flip while it's still a byte.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7131" target="_blank">01:58:51.920</a></span> | <span class="t">So image augmentation isn't just about throwing some transformation functions in there, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7138" target="_blank">01:58:58.480</a></span> | <span class="t">think about when you're going to do it because you've got this pipeline where you start with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7142" target="_blank">01:59:02.000</a></span> | <span class="t">bytes and you start with bytes in a pillow thing and then they become bytes in a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7148" target="_blank">01:59:08.000</a></span> | <span class="t">and then they become floats and then they get turned into a batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7151" target="_blank">01:59:11.520</a></span> | <span class="t">Where are you going to do the work?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7153" target="_blank">01:59:13.060</a></span> | <span class="t">And so you should do whatever you can while they're still bytes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7156" target="_blank">01:59:16.000</a></span> | <span class="t">But be careful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7157" target="_blank">01:59:17.400</a></span> | <span class="t">Don't do things that are going to cause rounding errors or saturation problems, whatever.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7162" target="_blank">01:59:22.440</a></span> | <span class="t">But flips, definitely good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7164" target="_blank">01:59:24.960</a></span> | <span class="t">So let's do our flips.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7167" target="_blank">01:59:27.780</a></span> | <span class="t">So there's a thing called PILX.TransposePILImageFlipLeftRight.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7172" target="_blank">01:59:32.360</a></span> | <span class="t">Let's check it for random numbers less than 0.5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7175" target="_blank">01:59:35.600</a></span> | <span class="t">Let's create an item list and let's replace that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7178" target="_blank">01:59:38.800</a></span> | <span class="t">We built this ourselves, so we know how to do this stuff now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7181" target="_blank">01:59:41.240</a></span> | <span class="t">Let's replace the items with just the first item with 64 copies of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7186" target="_blank">01:59:46.920</a></span> | <span class="t">And so that way we can now use this to create the same picture lots of times.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7193" target="_blank">01:59:53.640</a></span> | <span class="t">So show batch is just something that's just going to go through our batch and show all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7197" target="_blank">01:59:57.080</a></span> | <span class="t">the images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7199" target="_blank">01:59:59.320</a></span> | <span class="t">Everything we're using we've built ourselves, so you never have to wonder what's going on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7204" target="_blank">02:00:04.000</a></span> | <span class="t">So we can show batch with no augmentation or remember how we created our transforms.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7209" target="_blank">02:00:09.240</a></span> | <span class="t">We can add PIL random flip and now some of them are backwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7215" target="_blank">02:00:15.240</a></span> | <span class="t">It might be nice to turn this into a class that you actually pass a P into to decide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7219" target="_blank">02:00:19.540</a></span> | <span class="t">what the probability of a flip is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7223" target="_blank">02:00:23.320</a></span> | <span class="t">You probably want to give it an order because we need to make sure it happens after we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7227" target="_blank">02:00:27.720</a></span> | <span class="t">got the image and after we've converted it to RGB but before we've turned it into a tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7233" target="_blank">02:00:33.240</a></span> | <span class="t">Since all of our PIL transforms are going to want to be that order, we may as well create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7237" target="_blank">02:00:37.920</a></span> | <span class="t">a PIL transform class and give it that order and then we can just inherit from that class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7242" target="_blank">02:00:42.600</a></span> | <span class="t">every time we want a PIL transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7245" target="_blank">02:00:45.600</a></span> | <span class="t">So now we've got a PIL transform class, we've got a PIL random flip, it's got this state,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7250" target="_blank">02:00:50.980</a></span> | <span class="t">it's going to be random, we can try it out giving it P of 0.8 and so now most of them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7258" target="_blank">02:00:58.400</a></span> | <span class="t">are flipped.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7262" target="_blank">02:01:02.680</a></span> | <span class="t">Or maybe we want to be able to do all these other flips.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7267" target="_blank">02:01:07.220</a></span> | <span class="t">So actually PIL transpose, you can pass it all kinds of different things and they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7272" target="_blank">02:01:12.620</a></span> | <span class="t">basically just numbers between 0 and 6.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7277" target="_blank">02:01:17.060</a></span> | <span class="t">So here are all the options.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7281" target="_blank">02:01:21.240</a></span> | <span class="t">So let's turn that into another transform where we just pick any one of those at random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7289" target="_blank">02:01:29.920</a></span> | <span class="t">and there it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7291" target="_blank">02:01:31.420</a></span> | <span class="t">So this is how we can do data augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7293" target="_blank">02:01:33.240</a></span> | <span class="t">All right, now's a good time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7298" target="_blank">02:01:38.680</a></span> | <span class="t">>> It's easy to evaluate data augmentation for images, how would you handle tabular text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7303" target="_blank">02:01:43.940</a></span> | <span class="t">or time series?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7308" target="_blank">02:01:48.920</a></span> | <span class="t">>> For text you read it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7314" target="_blank">02:01:54.000</a></span> | <span class="t">>> How would you handle the data augmentation?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7316" target="_blank">02:01:56.040</a></span> | <span class="t">>> You would read the augmented text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7318" target="_blank">02:01:58.560</a></span> | <span class="t">So if you're augmenting text then you read the augmented text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7323" target="_blank">02:02:03.520</a></span> | <span class="t">For time series you would look at the signal of the time series.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7329" target="_blank">02:02:09.400</a></span> | <span class="t">For tabular you would graph or however you normally visualize that kind of tabular data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7335" target="_blank">02:02:15.680</a></span> | <span class="t">you would visualize that tabular data in the same way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7338" target="_blank">02:02:18.320</a></span> | <span class="t">So you just kind of come and try and as a domain expert hopefully you understand your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7343" target="_blank">02:02:23.040</a></span> | <span class="t">data and you have to come up with a way, what are the ways you normally visualize that kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7349" target="_blank">02:02:29.120</a></span> | <span class="t">of data and use the same thing for your augmented data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7352" target="_blank">02:02:32.400</a></span> | <span class="t">Make sure it makes sense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7353" target="_blank">02:02:33.400</a></span> | <span class="t">Yeah, make sure it seems reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7355" target="_blank">02:02:35.400</a></span> | <span class="t">>> Sorry, I think I misread.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7360" target="_blank">02:02:40.120</a></span> | <span class="t">How would you do the augmentation for tabular data text or time series?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7363" target="_blank">02:02:43.840</a></span> | <span class="t">>> How would you do the augmentation?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7365" target="_blank">02:02:45.880</a></span> | <span class="t">I mean, again, it kind of requires your domain expertise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7373" target="_blank">02:02:53.400</a></span> | <span class="t">Just before class today actually one of our alumni, Christine Payne came in, she's at open</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7379" target="_blank">02:02:59.840</a></span> | <span class="t">AI now working on music analysis and music generation and she was talking about her data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7386" target="_blank">02:03:06.600</a></span> | <span class="t">augmentation saying she's pitch shifting and volume changing and slicing bits off the front</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7392" target="_blank">02:03:12.120</a></span> | <span class="t">and the end and stuff like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7394" target="_blank">02:03:14.200</a></span> | <span class="t">So there isn't an answer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7398" target="_blank">02:03:18.560</a></span> | <span class="t">It's just a case of thinking about what kinds of things could change in your data that would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7404" target="_blank">02:03:24.600</a></span> | <span class="t">almost certainly cause the label to not change but would still be a reasonable data item</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7411" target="_blank">02:03:31.480</a></span> | <span class="t">and that just requires your domain expertise.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7413" target="_blank">02:03:33.440</a></span> | <span class="t">Oh, except for the thing I'm going to show you next which is going to be a magic trick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7416" target="_blank">02:03:36.320</a></span> | <span class="t">that works for everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7417" target="_blank">02:03:37.560</a></span> | <span class="t">So we'll come to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7423" target="_blank">02:03:43.560</a></span> | <span class="t">We can do random cropping and this is, again, something to be very careful of.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7430" target="_blank">02:03:50.280</a></span> | <span class="t">We very often want to grab a small piece of an image and zoom into that piece.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7435" target="_blank">02:03:55.480</a></span> | <span class="t">It's a great way to do data augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7437" target="_blank">02:03:57.600</a></span> | <span class="t">One way would be to crop and then resize.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7441" target="_blank">02:04:01.720</a></span> | <span class="t">And if we do crop and resize, oh, we've lost his checked shirt.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7447" target="_blank">02:04:07.080</a></span> | <span class="t">But very often you can do both in one step.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7449" target="_blank">02:04:09.560</a></span> | <span class="t">So for example, with pillow, there's a transform called extent where you tell it what crop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7457" target="_blank">02:04:17.440</a></span> | <span class="t">and what resize and it does it in one step and now it's much more clear.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7464" target="_blank">02:04:24.200</a></span> | <span class="t">So generally speaking, you've got to be super careful, particularly when your data is still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7468" target="_blank">02:04:28.720</a></span> | <span class="t">bytes, not to do destructive transformations, particularly multiple destructive transformations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7476" target="_blank">02:04:36.000</a></span> | <span class="t">Do them all in one go or wait until they're floats because bytes round off and disappear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7484" target="_blank">02:04:44.120</a></span> | <span class="t">or saturate whereas floats don't.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7487" target="_blank">02:04:47.160</a></span> | <span class="t">And the cropping one takes 193 microseconds, the better one takes 500 microseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7497" target="_blank">02:04:57.400</a></span> | <span class="t">So one approach would be to say, oh, crap, it's more than twice as long, we're screwed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7502" target="_blank">02:05:02.720</a></span> | <span class="t">But that's not how to think.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7504" target="_blank">02:05:04.240</a></span> | <span class="t">How to think is what's your time budget?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7507" target="_blank">02:05:07.000</a></span> | <span class="t">Does it matter?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7508" target="_blank">02:05:08.360</a></span> | <span class="t">So here's how I thought through our time budget for this little augmentation project.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7512" target="_blank">02:05:12.600</a></span> | <span class="t">I know that for Dawnbench, kind of the best we could get down to is five minutes per batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7519" target="_blank">02:05:19.760</a></span> | <span class="t">of ImageNet on eight GPUs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7525" target="_blank">02:05:25.880</a></span> | <span class="t">And so that's 1.25 million images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7531" target="_blank">02:05:31.960</a></span> | <span class="t">So that's on one GPU per minute, that's 31,000 or 500 per second.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7544" target="_blank">02:05:44.880</a></span> | <span class="t">Assuming four cores per GPU, that's 125 per second.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7549" target="_blank">02:05:49.200</a></span> | <span class="t">So we're going to try to stay under 10 milliseconds, I said 10 milliseconds per image.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7554" target="_blank">02:05:54.160</a></span> | <span class="t">I think I mean 10 milliseconds per batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7558" target="_blank">02:05:58.440</a></span> | <span class="t">So it's actually still a pretty small number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7565" target="_blank">02:06:05.000</a></span> | <span class="t">So we're not too worried at this point about 500 microseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7571" target="_blank">02:06:11.240</a></span> | <span class="t">But this is always kind of the thing to think about is like how much time have you got?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7580" target="_blank">02:06:20.480</a></span> | <span class="t">And sometimes these times really add up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7583" target="_blank">02:06:23.400</a></span> | <span class="t">But yeah, 520 per second, we've got some time, especially since we've got normally a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7589" target="_blank">02:06:29.400</a></span> | <span class="t">cores per GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7592" target="_blank">02:06:32.880</a></span> | <span class="t">So we can just write some code to do kind of a general crop transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7599" target="_blank">02:06:39.560</a></span> | <span class="t">For ImageNet and things like that, for the validation set, what we normally do is we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7608" target="_blank">02:06:48.040</a></span> | <span class="t">grab the center of the image, we remove 14% from each side and grab the center.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7616" target="_blank">02:06:56.360</a></span> | <span class="t">So we can zoom in a little bit, so we have a center crop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7620" target="_blank">02:07:00.240</a></span> | <span class="t">So here we show all that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7623" target="_blank">02:07:03.840</a></span> | <span class="t">That's what we do for the validation set, and obviously they're all the same because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7626" target="_blank">02:07:06.440</a></span> | <span class="t">validation set doesn't have the randomness.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7629" target="_blank">02:07:09.360</a></span> | <span class="t">But for the training set, the most useful transformation by far, like all the competition</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7636" target="_blank">02:07:16.440</a></span> | <span class="t">winners, grab a small piece of the image and zoom into it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7642" target="_blank">02:07:22.480</a></span> | <span class="t">This is called a random resize crop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7644" target="_blank">02:07:24.600</a></span> | <span class="t">And this is going to be really useful to know about for any domain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7649" target="_blank">02:07:29.840</a></span> | <span class="t">So for example, in NLP, really useful thing to do is to grab different sized chunks of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7655" target="_blank">02:07:35.680</a></span> | <span class="t">contiguous text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7657" target="_blank">02:07:37.840</a></span> | <span class="t">With audio, if you're doing speech recognition, grab different sized pieces of the utterances</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7663" target="_blank">02:07:43.160</a></span> | <span class="t">and so forth.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7664" target="_blank">02:07:44.160</a></span> | <span class="t">If you can find a way to get different slices of your data, it's a fantastically useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7671" target="_blank">02:07:51.360</a></span> | <span class="t">data augmentation approach.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7673" target="_blank">02:07:53.760</a></span> | <span class="t">And so this is like by far the main, most important augmentation used in every ImageNet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7679" target="_blank">02:07:59.800</a></span> | <span class="t">winner for the last six years or so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7685" target="_blank">02:08:05.880</a></span> | <span class="t">It's a bit weird though because what they do in this approach is this little ratio here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7691" target="_blank">02:08:11.840</a></span> | <span class="t">says squish it by between three over four aspect ratio to a four over three aspect ratio.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7699" target="_blank">02:08:19.560</a></span> | <span class="t">And so it literally makes the person, see here, he's looking quite thin.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7704" target="_blank">02:08:24.680</a></span> | <span class="t">And see here, he's looking quite wide.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7708" target="_blank">02:08:28.120</a></span> | <span class="t">It doesn't actually make any sense, this transformation, because optically speaking, there's no way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7713" target="_blank">02:08:33.800</a></span> | <span class="t">of looking at something in normal day-to-day life that causes them to expand outwards or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7720" target="_blank">02:08:40.160</a></span> | <span class="t">contract inwards.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7723" target="_blank">02:08:43.160</a></span> | <span class="t">So when we looked at this, we thought, I think what happened here is that they were, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7728" target="_blank">02:08:48.240</a></span> | <span class="t">is the best they could do with the tools they had, but probably what they really want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7732" target="_blank">02:08:52.080</a></span> | <span class="t">do is to do the thing that's kind of like physically reasonable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7737" target="_blank">02:08:57.200</a></span> | <span class="t">And so the physically reasonable thing is like you might be a bit above somebody or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7740" target="_blank">02:09:00.960</a></span> | <span class="t">a bit below somebody or left of somebody or right of somebody, causing your perspective</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7745" target="_blank">02:09:05.000</a></span> | <span class="t">to change.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7746" target="_blank">02:09:06.760</a></span> | <span class="t">So our guess is that what we actually want is not this, but this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7752" target="_blank">02:09:12.740</a></span> | <span class="t">So perspective warping is basically something that looks like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7759" target="_blank">02:09:19.480</a></span> | <span class="t">You basically have four points, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7762" target="_blank">02:09:22.200</a></span> | <span class="t">And you think about how would those four points map to four other points if they were going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7766" target="_blank">02:09:26.960</a></span> | <span class="t">through some angle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7767" target="_blank">02:09:27.960</a></span> | <span class="t">So it's like as you look from different directions, roughly speaking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7772" target="_blank">02:09:32.880</a></span> | <span class="t">And the reason that I really like this idea is because when you're doing data augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7779" target="_blank">02:09:39.120</a></span> | <span class="t">at any domain, as I mentioned, the idea is to try and create like physically reasonable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7786" target="_blank">02:09:46.840</a></span> | <span class="t">in your domain inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7789" target="_blank">02:09:49.400</a></span> | <span class="t">And these just aren't like you can't make somebody squishier in real world, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7796" target="_blank">02:09:56.620</a></span> | <span class="t">But you can shift their perspective.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7798" target="_blank">02:09:58.760</a></span> | <span class="t">So if we do a perspective transform, then they look like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7805" target="_blank">02:10:05.280</a></span> | <span class="t">This is true, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7806" target="_blank">02:10:06.280</a></span> | <span class="t">If you're a bit underneath them, the fish will look a bit closer, or if you're a bit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7810" target="_blank">02:10:10.720</a></span> | <span class="t">over here, then the hat's a bit closer from that side.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7813" target="_blank">02:10:13.720</a></span> | <span class="t">So these perspective transforms make a lot more sense, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7819" target="_blank">02:10:19.680</a></span> | <span class="t">So if you're interested in perspective transforms, we have some details here on how you actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7823" target="_blank">02:10:23.620</a></span> | <span class="t">do them mathematically.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7825" target="_blank">02:10:25.760</a></span> | <span class="t">The details aren't important, but what are interesting is the transform actually requires</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7830" target="_blank">02:10:30.600</a></span> | <span class="t">solving a system of linear equations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7833" target="_blank">02:10:33.240</a></span> | <span class="t">And did you know that PyTorch has a function for solving systems of linear equations?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7837" target="_blank">02:10:37.440</a></span> | <span class="t">It's amazing how much stuff is in PyTorch, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7841" target="_blank">02:10:41.240</a></span> | <span class="t">So for like lots of the things you'll need in your domain, you might be surprised to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7844" target="_blank">02:10:44.880</a></span> | <span class="t">find what's already there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7847" target="_blank">02:10:47.240</a></span> | <span class="t">Question?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7848" target="_blank">02:10:48.680</a></span> | <span class="t">>> And with the cropping and resizing, what happens when you lose the object of interest,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7855" target="_blank">02:10:55.840</a></span> | <span class="t">so when the fish has been cropped out?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7858" target="_blank">02:10:58.800</a></span> | <span class="t">>> That's a great question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7860" target="_blank">02:11:00.480</a></span> | <span class="t">It's not just a fish, it's a tench, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7864" target="_blank">02:11:04.500</a></span> | <span class="t">So there's no tench here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7866" target="_blank">02:11:06.920</a></span> | <span class="t">And so these are noisy labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7869" target="_blank">02:11:09.600</a></span> | <span class="t">And interestingly, the kind of ImageNet winning strategy is to randomly pick between 8% and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7877" target="_blank">02:11:17.600</a></span> | <span class="t">100% of the pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7879" target="_blank">02:11:19.800</a></span> | <span class="t">So literally, they are very often picking 8% of the pixels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7885" target="_blank">02:11:25.480</a></span> | <span class="t">And that's the ImageNet winning strategy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7887" target="_blank">02:11:27.660</a></span> | <span class="t">So they very often have no tench.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7890" target="_blank">02:11:30.380</a></span> | <span class="t">So very often they'll have just the fin or just the eye.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7896" target="_blank">02:11:36.720</a></span> | <span class="t">So this tells us that if we want to use this really effective augmentation strategy really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7900" target="_blank">02:11:40.900</a></span> | <span class="t">well, we have to be very good at handling noisy labels, which we're going to learn about in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7904" target="_blank">02:11:44.840</a></span> | <span class="t">the next lesson, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7907" target="_blank">02:11:47.620</a></span> | <span class="t">And it also hopefully tells you that if you already have noisy labels, don't worry about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7913" target="_blank">02:11:53.560</a></span> | <span class="t">it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7914" target="_blank">02:11:54.560</a></span> | <span class="t">All of the research we have tells us that we can handle labels where the thing's totally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7920" target="_blank">02:12:00.880</a></span> | <span class="t">missing or sometimes it's wrong, as long as it's not biased.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7925" target="_blank">02:12:05.600</a></span> | <span class="t">So yeah, it's okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7926" target="_blank">02:12:06.600</a></span> | <span class="t">And one of the things it'll do is it'll learn to find things associated with a tench.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7932" target="_blank">02:12:12.760</a></span> | <span class="t">So if there's a middle-aged man looking very happy outside, could well be a tench.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7939" target="_blank">02:12:19.720</a></span> | <span class="t">Okay, so this is a bit of research that we're currently working on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7945" target="_blank">02:12:25.440</a></span> | <span class="t">And hopefully I'll have some results to show you soon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7948" target="_blank">02:12:28.600</a></span> | <span class="t">But our view is that this image warping approach is probably going to give us better results</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7953" target="_blank">02:12:33.960</a></span> | <span class="t">than the traditional ImageNet style augmentations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7959" target="_blank">02:12:39.880</a></span> | <span class="t">So here's our final transform for tilting in arbitrary directions, and here's the result.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7967" target="_blank">02:12:47.440</a></span> | <span class="t">Not bad.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7968" target="_blank">02:12:48.600</a></span> | <span class="t">So a couple of things to finish on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7972" target="_blank">02:12:52.360</a></span> | <span class="t">The first is that it's really important to measure everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7977" target="_blank">02:12:57.960</a></span> | <span class="t">And I and many people have been shocked to discover that actually the time it takes to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7983" target="_blank">02:13:03.500</a></span> | <span class="t">convert an image into a float tensor is significantly longer than the amount of time it takes to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7993" target="_blank">02:13:13.240</a></span> | <span class="t">do something as complicated as a warp.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=7998" target="_blank">02:13:18.600</a></span> | <span class="t">So you may be thinking this image warping thing sounds really hard and slow, but be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8005" target="_blank">02:13:25.280</a></span> | <span class="t">careful, just converting bytes to floats is really hard and slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8010" target="_blank">02:13:30.780</a></span> | <span class="t">And then this is the one, as I mentioned, this one we're using here is the one that comes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8013" target="_blank">02:13:33.640</a></span> | <span class="t">from Torch Vision.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8016" target="_blank">02:13:36.120</a></span> | <span class="t">We found another version that's like twice as fast, which goes directly to float.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8022" target="_blank">02:13:42.460</a></span> | <span class="t">So this is the one that we're going to be using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8025" target="_blank">02:13:45.400</a></span> | <span class="t">So time everything if you're running, you know, if things are running not fast enough.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8029" target="_blank">02:13:49.880</a></span> | <span class="t">Okay, here's the thing I'm really excited about for augmentation, is this stuff's all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8037" target="_blank">02:13:57.480</a></span> | <span class="t">still too slow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8039" target="_blank">02:13:59.840</a></span> | <span class="t">What if I told you, you could do arbitrary affine transformations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8046" target="_blank">02:14:06.880</a></span> | <span class="t">So warping, zooming, rotating, shifting at a speed which would compare.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8058" target="_blank">02:14:18.560</a></span> | <span class="t">This is the normal speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8063" target="_blank">02:14:23.240</a></span> | <span class="t">This is our speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8065" target="_blank">02:14:25.100</a></span> | <span class="t">So up to like, you know, an order of magnitude or more faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8069" target="_blank">02:14:29.280</a></span> | <span class="t">How do we do it?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8071" target="_blank">02:14:31.020</a></span> | <span class="t">We figured out how to do it on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8074" target="_blank">02:14:34.180</a></span> | <span class="t">So we can actually do augmentation on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8076" target="_blank">02:14:36.880</a></span> | <span class="t">And the trick is that PyTorch gives us all the functionality to make it happen.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8082" target="_blank">02:14:42.440</a></span> | <span class="t">So the key thing we have to do is to actually realize that our transforms, our augmentation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8088" target="_blank">02:14:48.280</a></span> | <span class="t">should happen after you create a batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8092" target="_blank">02:14:52.200</a></span> | <span class="t">So here's what we do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8093" target="_blank">02:14:53.200</a></span> | <span class="t">For our augmentation, we don't create one random number.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8096" target="_blank">02:14:56.540</a></span> | <span class="t">We create a mini batch of random numbers, which is fine because PyTorch has the ability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8101" target="_blank">02:15:01.260</a></span> | <span class="t">to generate batches of random numbers on the GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8104" target="_blank">02:15:04.880</a></span> | <span class="t">And so then once we've got a mini batch of random numbers, then we just have to use that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8110" target="_blank">02:15:10.200</a></span> | <span class="t">to generate a mini batch of augmented images.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8114" target="_blank">02:15:14.400</a></span> | <span class="t">I won't kind of bore you with the details.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8117" target="_blank">02:15:17.040</a></span> | <span class="t">I find them very interesting details.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8118" target="_blank">02:15:18.760</a></span> | <span class="t">But if you're not a computer vision person, maybe not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8121" target="_blank">02:15:21.480</a></span> | <span class="t">But basically, we create something called an affine grid, which is just the coordinates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8126" target="_blank">02:15:26.800</a></span> | <span class="t">of where is every pixel, so like literally is coordinates from minus one to one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8133" target="_blank">02:15:33.720</a></span> | <span class="t">And then what we do is we multiply it by this matrix, which is called an affine transform.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8141" target="_blank">02:15:41.840</a></span> | <span class="t">And there are various kinds of affine transforms you can do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8144" target="_blank">02:15:44.440</a></span> | <span class="t">For example, you can do a rotation transform by using this particular matrix, but these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8148" target="_blank">02:15:48.600</a></span> | <span class="t">are all just matrix multiplications.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8152" target="_blank">02:15:52.320</a></span> | <span class="t">And then you just, as you see here, you just do the matrix multiplication and this is how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8156" target="_blank">02:15:56.320</a></span> | <span class="t">you can rotate.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8158" target="_blank">02:15:58.240</a></span> | <span class="t">So a rotation, believe it or not, is just a matrix multiplication by this untimely matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8166" target="_blank">02:16:06.320</a></span> | <span class="t">If you do that, normally it's going to take you about 17 milliseconds because speed it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8172" target="_blank">02:16:12.880</a></span> | <span class="t">up a bit with own sum, or we could speed it up a little bit more with batch matrix multiply,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8180" target="_blank">02:16:20.760</a></span> | <span class="t">or we could stick the whole thing on the GPU and do it there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8186" target="_blank">02:16:26.000</a></span> | <span class="t">And that's going to go from 11 milliseconds to 81 microseconds.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8192" target="_blank">02:16:32.520</a></span> | <span class="t">So if we can put things on the GPU, it's totally different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8197" target="_blank">02:16:37.120</a></span> | <span class="t">And suddenly we don't have to worry about how long our augmentation is taking.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8201" target="_blank">02:16:41.760</a></span> | <span class="t">So this is the thing that actually rotates the coordinates, to say where the coordinates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8204" target="_blank">02:16:44.880</a></span> | <span class="t">are now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8205" target="_blank">02:16:45.880</a></span> | <span class="t">Then we have to do the interpolation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8208" target="_blank">02:16:48.080</a></span> | <span class="t">And believe it or not, PyTorch has an optimized batch-wise interpolation function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8214" target="_blank">02:16:54.680</a></span> | <span class="t">It's called grid sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8216" target="_blank">02:16:56.600</a></span> | <span class="t">And so here it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8217" target="_blank">02:16:57.600</a></span> | <span class="t">We run it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8218" target="_blank">02:16:58.600</a></span> | <span class="t">There it is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8219" target="_blank">02:16:59.600</a></span> | <span class="t">And not only do they have a grid sample, but this is actually even better than Pillows because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8223" target="_blank">02:17:03.360</a></span> | <span class="t">you don't have to have these black edges.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8225" target="_blank">02:17:05.520</a></span> | <span class="t">You can say padding mode equals reflection, and the black edges are gone.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8230" target="_blank">02:17:10.360</a></span> | <span class="t">It just reflects what was there, which most of the time is better.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8234" target="_blank">02:17:14.920</a></span> | <span class="t">And so reflection padding is one of these little things we find definitely helps models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8240" target="_blank">02:17:20.160</a></span> | <span class="t">So now we can put this all together into a rotate batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8244" target="_blank">02:17:24.920</a></span> | <span class="t">We can do any kind of coordinate transform here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8247" target="_blank">02:17:27.280</a></span> | <span class="t">One of them is rotate batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8249" target="_blank">02:17:29.600</a></span> | <span class="t">To do it a batch at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8252" target="_blank">02:17:32.160</a></span> | <span class="t">And yeah, as I say, it's dramatically faster.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8258" target="_blank">02:17:38.720</a></span> | <span class="t">Or in fact, we can do it all in one step because PyTorch has a thing called affine grid that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8264" target="_blank">02:17:44.760</a></span> | <span class="t">will actually do the multiplication as it creates a coordinate grid.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8269" target="_blank">02:17:49.260</a></span> | <span class="t">And this is where we get down to this incredibly fast speed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8273" target="_blank">02:17:53.040</a></span> | <span class="t">So I feel like there's a whole, you know, big opportunity here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8280" target="_blank">02:18:00.440</a></span> | <span class="t">There are currently no kind of hackable, anybody can write their own augmentation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8288" target="_blank">02:18:08.760</a></span> | <span class="t">Run on the GPU libraries out there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8291" target="_blank">02:18:11.440</a></span> | <span class="t">The entire fastai.vision library is written using PyTorch Tensor operations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8297" target="_blank">02:18:17.480</a></span> | <span class="t">We did it so that we could eventually do it this way.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8300" target="_blank">02:18:20.040</a></span> | <span class="t">But currently they all run on the CPU, one image at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8304" target="_blank">02:18:24.680</a></span> | <span class="t">But this is our template now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8307" target="_blank">02:18:27.280</a></span> | <span class="t">So now you can do them a batch at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8310" target="_blank">02:18:30.760</a></span> | <span class="t">And so whatever domain you're working in, you can hopefully start to try out these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8317" target="_blank">02:18:37.720</a></span> | <span class="t">you know, randomized GPU batch wise augmentations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8324" target="_blank">02:18:44.240</a></span> | <span class="t">And next week we're going to show you this magic data augmentation called mixup that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8331" target="_blank">02:18:51.280</a></span> | <span class="t">going to work on the GPU, it's going to work on every kind of domain that you can think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8335" target="_blank">02:18:55.560</a></span> | <span class="t">of and will possibly make most of these irrelevant because it's so good you possibly don't need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8342" target="_blank">02:19:02.920</a></span> | <span class="t">any others.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8344" target="_blank">02:19:04.400</a></span> | <span class="t">So that and much more next week, we'll see you then.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8347" target="_blank">02:19:07.880</a></span> | <span class="t">(audience applauds)</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=hPQKzsjTyyQ&t=8350" target="_blank">02:19:10.880</a></span> | <span class="t">(audience applauds)</span></div></div></body></html>