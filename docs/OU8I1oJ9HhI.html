<html><head><title>Theano Tutorial (Pascal Lamblin, MILA)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }
        .container {
            width: 80%;
            margin: auto;
            overflow: hidden;
        }
        h2, h3 {
            color: #333;
            text-align: center;
        }
        a {
            color: #0000FF;  /* Traditional blue color for links */
            text-decoration: none;
        }
        a:hover {
            text-decoration: underline;
        }
        img {
            display: block;
            margin: auto;
            max-width: 100%;
        }
        .c {
            margin: 10px 0;
        }
        .s, .t {
            display: inline-block;
            margin-right: 5px;
        }
        .max-width {
            max-width: 800px;
            margin: auto;
        }
    </style>
    
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Theano Tutorial (Pascal Lamblin, MILA)</h2><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI"><img src="https://i.ytimg.com/vi_webp/OU8I1oJ9HhI/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=36">0:36</a> Objectives<br><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=546">9:6</a> The back-propagation algorithm<br><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=814">13:34</a> Computing values<br><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=983">16:23</a> Graph optimizations<br><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1661">27:41</a> Visualization, debugging and diagnostic tools<br><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1912">31:52</a> Examples<br><br><div style="text-align: left;"><a href="./OU8I1oJ9HhI.html">Whisper Transcript</a> | <a href="./transcript_OU8I1oJ9HhI.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">>> Thank you. [ Applause ].</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2" target="_blank">00:00:02.000</a></span> | <span class="t">>> Okay. So today I'm going to briefly introduce you to TNO,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=9" target="_blank">00:00:09.000</a></span> | <span class="t">how to use it, and go over the basic principles behind the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=13" target="_blank">00:00:13.000</a></span> | <span class="t">libraries, and if you paid attention during yesterday's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=17" target="_blank">00:00:17.000</a></span> | <span class="t">presentation of TensorFlow, some concepts will be familiar to you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=21" target="_blank">00:00:21.000</a></span> | <span class="t">as well. And if you paid attention to Hugo La Rochelle's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=28" target="_blank">00:00:28.000</a></span> | <span class="t">talk, you will have heard of it. And I will talk about some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=34" target="_blank">00:00:34.000</a></span> | <span class="t">similar concepts as well. So there's going to be four main</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=38" target="_blank">00:00:38.000</a></span> | <span class="t">parts. So the first one is, well, these slides and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=42" target="_blank">00:00:42.000</a></span> | <span class="t">introduction about what the concepts of TNO are. There is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=47" target="_blank">00:00:47.000</a></span> | <span class="t">companion iPython notebook that's on GitHub. So if you go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=52" target="_blank">00:00:52.000</a></span> | <span class="t">on that page or clone that GitHub repository, there is an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=57" target="_blank">00:00:57.000</a></span> | <span class="t">example of how to use it. And you can download code snippets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=63" target="_blank">00:01:03.000</a></span> | <span class="t">from the slides so that you can run them at the same time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=67" target="_blank">00:01:07.000</a></span> | <span class="t">Then we're going to have a more hands-on example, basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=72" target="_blank">00:01:12.000</a></span> | <span class="t">applying logistic regression on the MNIST data set. And then if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=78" target="_blank">00:01:18.000</a></span> | <span class="t">we have time, we'll go quickly over two more examples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=84" target="_blank">00:01:24.000</a></span> | <span class="t">and then we'll talk about the concept of TNO and how to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=90" target="_blank">00:01:30.000</a></span> | <span class="t">them for character-level generation of text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=96" target="_blank">00:01:36.000</a></span> | <span class="t">So TNO is, we can say, a mathematical symbolic expression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=101" target="_blank">00:01:41.000</a></span> | <span class="t">compiler. So what does that mean? It means that it makes it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=105" target="_blank">00:01:45.000</a></span> | <span class="t">possible to define expressions that represent mathematical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=111" target="_blank">00:01:51.000</a></span> | <span class="t">expressions. So it's a very simple expression, easy to use,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=117" target="_blank">00:01:57.000</a></span> | <span class="t">and it supports all the kind of basic mathematical operations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=123" target="_blank">00:02:03.000</a></span> | <span class="t">like min, max, addition, subtraction, all the kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=130" target="_blank">00:02:10.000</a></span> | <span class="t">basic things, not only larger blocks like layers of neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=136" target="_blank">00:02:16.000</a></span> | <span class="t">networks, but also things like that. So it's basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=142" target="_blank">00:02:22.000</a></span> | <span class="t">making those expressions, doing graph substitutions, cloning and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=148" target="_blank">00:02:28.000</a></span> | <span class="t">replacement, things like that, and also making possible to go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=153" target="_blank">00:02:33.000</a></span> | <span class="t">through that graph and perform things like automatic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=158" target="_blank">00:02:38.000</a></span> | <span class="t">differentiation, symbolic differentiation, actually, or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=163" target="_blank">00:02:43.000</a></span> | <span class="t">kind of things that we call the TNO-like function. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=169" target="_blank">00:02:49.000</a></span> | <span class="t">it's possible to use that optimized graph and TNO's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=176" target="_blank">00:02:56.000</a></span> | <span class="t">runtime to actually compute some values, some output values</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=180" target="_blank">00:03:00.000</a></span> | <span class="t">given inputs. We also have a couple of tools that help debug</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=187" target="_blank">00:03:07.000</a></span> | <span class="t">both TNO's code and the user's code and try to inspect and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=192" target="_blank">00:03:12.000</a></span> | <span class="t">see if there's any errors in the code. So let's talk about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=197" target="_blank">00:03:17.000</a></span> | <span class="t">TNO. So TNO is currently more than eight years old. It</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=202" target="_blank">00:03:22.000</a></span> | <span class="t">started small with only a couple of contributors from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=209" target="_blank">00:03:29.000</a></span> | <span class="t">ancestor of Mila, which was called Lizat at the time, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=214" target="_blank">00:03:34.000</a></span> | <span class="t">it grew a lot. We now have contributors from all over the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=219" target="_blank">00:03:39.000</a></span> | <span class="t">world. We have a lot of TNO's, prototypes for industrial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=225" target="_blank">00:03:45.000</a></span> | <span class="t">applications in startups and in larger companies.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=231" target="_blank">00:03:51.000</a></span> | <span class="t">TNO has also been the base of other software projects that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=237" target="_blank">00:03:57.000</a></span> | <span class="t">built on top of TNO. So, for instance, blocks, Keras,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=244" target="_blank">00:04:04.000</a></span> | <span class="t">and so on. TNO is more the backend and provides user</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=252" target="_blank">00:04:12.000</a></span> | <span class="t">interface that is a higher level. So that has concepts of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=258" target="_blank">00:04:18.000</a></span> | <span class="t">layers, of training algorithms, of those kind of things.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=263" target="_blank">00:04:23.000</a></span> | <span class="t">Whereas TNO is more the backend. It's scale on TNO as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=267" target="_blank">00:04:27.000</a></span> | <span class="t">well, which is nice because it has a converter to load cafe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=272" target="_blank">00:04:32.000</a></span> | <span class="t">and it's a lot of fun. And it's a lot of fun to use.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=278" target="_blank">00:04:38.000</a></span> | <span class="t">And it's a lot of fun to use. And it uses TNO not to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=285" target="_blank">00:04:45.000</a></span> | <span class="t">machine learning, but programming. And we have two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=290" target="_blank">00:04:50.000</a></span> | <span class="t">other libraries, Platoon, and TNO MPI, which are layers on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=297" target="_blank">00:04:57.000</a></span> | <span class="t">TNO. And they are more the backend and more the backend</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=303" target="_blank">00:05:03.000</a></span> | <span class="t">level of model parallelism and data parallelism.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=309" target="_blank">00:05:09.000</a></span> | <span class="t">So, how to use TNO? Well, first of all, we are working</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=316" target="_blank">00:05:16.000</a></span> | <span class="t">with symbolic expression, symbolic variables. So that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=322" target="_blank">00:05:22.000</a></span> | <span class="t">is a function that is used to define the expression. So to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=328" target="_blank">00:05:28.000</a></span> | <span class="t">define the symbolic expression, so we define the expression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=332" target="_blank">00:05:32.000</a></span> | <span class="t">first, then we want to compile a function, and then execute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=336" target="_blank">00:05:36.000</a></span> | <span class="t">that function on values. So to define the expression, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=340" target="_blank">00:05:40.000</a></span> | <span class="t">start by defining inputs. So the inputs are symbolic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=344" target="_blank">00:05:44.000</a></span> | <span class="t">variables that have some type. So you have to define in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=349" target="_blank">00:05:49.000</a></span> | <span class="t">the matrix what its data type is, floating point, integers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=355" target="_blank">00:05:55.000</a></span> | <span class="t">and so on. So things like the number of dimensions have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=360" target="_blank">00:06:00.000</a></span> | <span class="t">be known in advance. But the shape is not fixed. The memory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=365" target="_blank">00:06:05.000</a></span> | <span class="t">layout is not fixed. So you could have shapes that change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=370" target="_blank">00:06:10.000</a></span> | <span class="t">between like one mini-batch and the next, or different calls</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=374" target="_blank">00:06:14.000</a></span> | <span class="t">that are made. So you have to define the symbolic expression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=378" target="_blank">00:06:18.000</a></span> | <span class="t">in general. So X and Y are purely symbolic variables here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=384" target="_blank">00:06:24.000</a></span> | <span class="t">We will give them values later, but for now, that's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=389" target="_blank">00:06:29.000</a></span> | <span class="t">empty. There's another kind of input variables that is shared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=394" target="_blank">00:06:34.000</a></span> | <span class="t">variables, and they are symbolic, but they also hold a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=398" target="_blank">00:06:38.000</a></span> | <span class="t">value, and that value is persistent across function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=402" target="_blank">00:06:42.000</a></span> | <span class="t">types. So we have a function that has two dimensions. It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=407" target="_blank">00:06:47.000</a></span> | <span class="t">usually used, for instance, for storing parameters of the model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=411" target="_blank">00:06:51.000</a></span> | <span class="t">that you want to learn, and yet these values can be updated as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=416" target="_blank">00:06:56.000</a></span> | <span class="t">well. So here we create two other variables from -- so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=421" target="_blank">00:07:01.000</a></span> | <span class="t">shared variables from values. This one has two dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=425" target="_blank">00:07:05.000</a></span> | <span class="t">because its initial values have two dimensions, and this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=429" target="_blank">00:07:09.000</a></span> | <span class="t">has two dimensions. So we can define a variable that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=433" target="_blank">00:07:13.000</a></span> | <span class="t">represent the bias. We can name variables by assigning to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=438" target="_blank">00:07:18.000</a></span> | <span class="t">name attributes. Shared variables do not have a fixed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=442" target="_blank">00:07:22.000</a></span> | <span class="t">side either. They are usually kept fixed in most models, but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=446" target="_blank">00:07:26.000</a></span> | <span class="t">it's not a requirement. Then from these inputs, we can define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=451" target="_blank">00:07:31.000</a></span> | <span class="t">expressions that will build new variables, intermediate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=455" target="_blank">00:07:35.000</a></span> | <span class="t">variables, and so on. And so, for instance, here we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=461" target="_blank">00:07:41.000</a></span> | <span class="t">define, well, the product of X and W, add the bias, apply a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=469" target="_blank">00:07:49.000</a></span> | <span class="t">function on that, and let's say this is our output variable, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=473" target="_blank">00:07:53.000</a></span> | <span class="t">from the output variable and Y, we can define just, say, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=479" target="_blank">00:07:59.000</a></span> | <span class="t">bias. So those new variables are connected to the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=485" target="_blank">00:08:05.000</a></span> | <span class="t">ones through the operations that we define, and we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=489" target="_blank">00:08:09.000</a></span> | <span class="t">visualize the graph structure like that by using, for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=493" target="_blank">00:08:13.000</a></span> | <span class="t">instance, the pilot print, which is a helper function. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=497" target="_blank">00:08:17.000</a></span> | <span class="t">variables are those squared boxes, and we have other nodes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=501" target="_blank">00:08:21.000</a></span> | <span class="t">here, we call apply nodes that represent the mathematical</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=506" target="_blank">00:08:26.000</a></span> | <span class="t">function, and we can visualize the graph structure.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=510" target="_blank">00:08:30.000</a></span> | <span class="t">So input variables and shared variables do not have any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=516" target="_blank">00:08:36.000</a></span> | <span class="t">ancestors. They don't have any connecting from them, but then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=520" target="_blank">00:08:40.000</a></span> | <span class="t">you see that intermediate result and more of them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=526" target="_blank">00:08:46.000</a></span> | <span class="t">Usually, when we visualize, we don't necessarily care about all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=530" target="_blank">00:08:50.000</a></span> | <span class="t">the intermediate variables unless they have a name or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=534" target="_blank">00:08:54.000</a></span> | <span class="t">something. So here, we have exactly the same graph where we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=538" target="_blank">00:08:58.000</a></span> | <span class="t">hide the unnamed intermediate variables, but you can still see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=542" target="_blank">00:09:02.000</a></span> | <span class="t">all the operations. And actually, you see the type on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=548" target="_blank">00:09:08.000</a></span> | <span class="t">the edges. So once you have defined some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=552" target="_blank">00:09:12.000</a></span> | <span class="t">graphs, say your forward computation for your model, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=556" target="_blank">00:09:16.000</a></span> | <span class="t">want to be able to use back propagation to get gradients.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=563" target="_blank">00:09:23.000</a></span> | <span class="t">So here, we have just the basic concept of the chain rule. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=569" target="_blank">00:09:29.000</a></span> | <span class="t">have a scalar cost, we have intermediate variables that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=575" target="_blank">00:09:35.000</a></span> | <span class="t">vectors. Here is just the chain rule starting from the cost.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=582" target="_blank">00:09:42.000</a></span> | <span class="t">And so the whole derivative of, say, that function G is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=590" target="_blank">00:09:50.000</a></span> | <span class="t">the cost of the output. And the cost of the output is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=596" target="_blank">00:09:56.000</a></span> | <span class="t">that M by N if the intermediate variables are vectors of size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=602" target="_blank">00:10:02.000</a></span> | <span class="t">N and M. And usually, you don't need that. And it's usually a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=606" target="_blank">00:10:06.000</a></span> | <span class="t">bad idea to compute it explicitly unless you need it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=610" target="_blank">00:10:10.000</a></span> | <span class="t">for some other purposes. The only thing you need is an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=614" target="_blank">00:10:14.000</a></span> | <span class="t">expression that's given any vector representing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=618" target="_blank">00:10:18.000</a></span> | <span class="t">gradient of the cost with respect to the input. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=622" target="_blank">00:10:22.000</a></span> | <span class="t">basically, the dot product between that vector and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=626" target="_blank">00:10:26.000</a></span> | <span class="t">whole Jacobian matrix. So that's also called the L</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=630" target="_blank">00:10:30.000</a></span> | <span class="t">operator sometimes. And so almost all operations in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=636" target="_blank">00:10:36.000</a></span> | <span class="t">Tiano implement a function that returns that. And it actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=643" target="_blank">00:10:43.000</a></span> | <span class="t">returns not numbers, not a numerical expression for that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=649" target="_blank">00:10:49.000</a></span> | <span class="t">but it returns a symbolic expression that represents that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=655" target="_blank">00:10:55.000</a></span> | <span class="t">computation. Again, usually without having to explicitly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=660" target="_blank">00:11:00.000</a></span> | <span class="t">represent or define that whole Jacobian matrix.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=665" target="_blank">00:11:05.000</a></span> | <span class="t">So you can call Tiano dot grad, which will back propagate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=671" target="_blank">00:11:11.000</a></span> | <span class="t">the cost of the input. And it will start from the cost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=677" target="_blank">00:11:17.000</a></span> | <span class="t">towards the inputs that you give. And along the way, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=681" target="_blank">00:11:21.000</a></span> | <span class="t">will call that grad method of each operation, back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=685" target="_blank">00:11:25.000</a></span> | <span class="t">propagating -- starting from one for the cost and back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=689" target="_blank">00:11:29.000</a></span> | <span class="t">propagating through the whole graph, accumulating when you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=693" target="_blank">00:11:33.000</a></span> | <span class="t">have the same variables that use more than once and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=698" target="_blank">00:11:38.000</a></span> | <span class="t">So that's basically what Tiano does. The same way as if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=704" target="_blank">00:11:44.000</a></span> | <span class="t">had manually defined the gradient expression using Tiano</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=708" target="_blank">00:11:48.000</a></span> | <span class="t">operations like the dot product, the sigmoid and so on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=712" target="_blank">00:11:52.000</a></span> | <span class="t">that we've seen earlier. So we have non-numerical values at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=716" target="_blank">00:11:56.000</a></span> | <span class="t">that point. And they are part of the computation graph. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=721" target="_blank">00:12:01.000</a></span> | <span class="t">the computation graph was extended to add these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=727" target="_blank">00:12:07.000</a></span> | <span class="t">variables. So we can use Tiano to compute the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=731" target="_blank">00:12:11.000</a></span> | <span class="t">gradient descent, extending the graph from these variables,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=735" target="_blank">00:12:15.000</a></span> | <span class="t">for instance, to compute the expressions corresponding to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=739" target="_blank">00:12:19.000</a></span> | <span class="t">gradient descent, something like that, like we do here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=743" target="_blank">00:12:23.000</a></span> | <span class="t">So, for instance, this is what the extended graph for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=747" target="_blank">00:12:27.000</a></span> | <span class="t">gradients looks like. So you see there's a lot of small</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=751" target="_blank">00:12:31.000</a></span> | <span class="t">operations that have been inserted. And the output you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=755" target="_blank">00:12:35.000</a></span> | <span class="t">can see here is the gradient descent, the gradient output,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=759" target="_blank">00:12:39.000</a></span> | <span class="t">and an intermediate result that will help compute the gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=763" target="_blank">00:12:43.000</a></span> | <span class="t">with respect to the weights. And here's the graph for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=769" target="_blank">00:12:49.000</a></span> | <span class="t">expressions. So you have as intermediate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=774" target="_blank">00:12:54.000</a></span> | <span class="t">variables, the gradients that we had on the previous slide,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=779" target="_blank">00:12:59.000</a></span> | <span class="t">and then basically just the scale version with the constant</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=784" target="_blank">00:13:04.000</a></span> | <span class="t">weight. So once we have defined the whole graph, the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=790" target="_blank">00:13:10.000</a></span> | <span class="t">expression that we actually care about, from the inputs and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=796" target="_blank">00:13:16.000</a></span> | <span class="t">initial weights to the weight updates for our training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=801" target="_blank">00:13:21.000</a></span> | <span class="t">algorithm, we want to compile a function that will be able to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=805" target="_blank">00:13:25.000</a></span> | <span class="t">actually compute those numbers, given inputs, and perform the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=809" target="_blank">00:13:29.000</a></span> | <span class="t">computation. So to do that, we have a function that has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=815" target="_blank">00:13:35.000</a></span> | <span class="t">values. What we do is call TNO.function, and you provide it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=819" target="_blank">00:13:39.000</a></span> | <span class="t">with the input variables that you want to feed, and the output</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=823" target="_blank">00:13:43.000</a></span> | <span class="t">variables that you want to get. And you don't have necessarily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=826" target="_blank">00:13:46.000</a></span> | <span class="t">to provide values for all of the inputs that you might have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=831" target="_blank">00:13:51.000</a></span> | <span class="t">declared, especially if you don't want to go all the way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=835" target="_blank">00:13:55.000</a></span> | <span class="t">back to the beginning. So we can actually compute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=840" target="_blank">00:14:00.000</a></span> | <span class="t">expression for a subset of the graph. For instance, we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=844" target="_blank">00:14:04.000</a></span> | <span class="t">have a predict function here that goes only from X to out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=848" target="_blank">00:14:08.000</a></span> | <span class="t">We don't need values from Y. We don't need -- and so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=853" target="_blank">00:14:13.000</a></span> | <span class="t">gradient and so on will not be computed. It's just going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=857" target="_blank">00:14:17.000</a></span> | <span class="t">take a small part of the graph and make a function out of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=864" target="_blank">00:14:24.000</a></span> | <span class="t">So to do that, you have to provide a value and call it. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=868" target="_blank">00:14:28.000</a></span> | <span class="t">you have to provide values for all of the input variables that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=872" target="_blank">00:14:32.000</a></span> | <span class="t">you define. You don't have to provide values for shared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=876" target="_blank">00:14:36.000</a></span> | <span class="t">variables, the W and B that we declared earlier. They are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=880" target="_blank">00:14:40.000</a></span> | <span class="t">implicit inputs to all of the functions, and their value will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=885" target="_blank">00:14:45.000</a></span> | <span class="t">automatically be fetched when it's needed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=889" target="_blank">00:14:49.000</a></span> | <span class="t">You can declare other functions, like a monitoring function that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=893" target="_blank">00:14:53.000</a></span> | <span class="t">is a function that is not a prediction. So you have two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=897" target="_blank">00:14:57.000</a></span> | <span class="t">outputs, you also need the second input, Y. You can compute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=902" target="_blank">00:15:02.000</a></span> | <span class="t">the function that does not start from the beginning. Like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=906" target="_blank">00:15:06.000</a></span> | <span class="t">for instance, if I want an error function that only computes the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=911" target="_blank">00:15:11.000</a></span> | <span class="t">mismatch between the prediction and the actual target, then I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=915" target="_blank">00:15:15.000</a></span> | <span class="t">don't have to start from the input. I can just start from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=919" target="_blank">00:15:19.000</a></span> | <span class="t">the input. So that's the first thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=923" target="_blank">00:15:23.000</a></span> | <span class="t">Then the next thing that we want to do is update shared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=928" target="_blank">00:15:28.000</a></span> | <span class="t">variables for training. It's necessary. And, again, you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=932" target="_blank">00:15:32.000</a></span> | <span class="t">pass to TNO functions updates, a list of updates. And updates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=937" target="_blank">00:15:37.000</a></span> | <span class="t">are pairs of a shared variable and a symbolic expression that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=942" target="_blank">00:15:42.000</a></span> | <span class="t">will compute the new value for that shared variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=946" target="_blank">00:15:46.000</a></span> | <span class="t">So, for example, if we want to update Y, we can update B here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=952" target="_blank">00:15:52.000</a></span> | <span class="t">as implicit outputs of the function, like W and B were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=956" target="_blank">00:15:56.000</a></span> | <span class="t">implicit inputs. Update W and B are implicit outputs that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=960" target="_blank">00:16:00.000</a></span> | <span class="t">be computed at the same time as C. And then, after all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=965" target="_blank">00:16:05.000</a></span> | <span class="t">outputs are computed, the updates are actually effective</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=970" target="_blank">00:16:10.000</a></span> | <span class="t">and the train function is actually running.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=975" target="_blank">00:16:15.000</a></span> | <span class="t">Here, if we print the value of B before and after having</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=981" target="_blank">00:16:21.000</a></span> | <span class="t">calling -- after having called the train function, then we see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=985" target="_blank">00:16:25.000</a></span> | <span class="t">the value has changed. What happens also during graph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=991" target="_blank">00:16:31.000</a></span> | <span class="t">compilation is that the subgraph that we selected for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=996" target="_blank">00:16:36.000</a></span> | <span class="t">function, the subgraph that we selected for that function, what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1001" target="_blank">00:16:41.000</a></span> | <span class="t">we mean by that is that it's going to be rewritten in parts.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1005" target="_blank">00:16:45.000</a></span> | <span class="t">There are some expressions that will be substituted and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1010" target="_blank">00:16:50.000</a></span> | <span class="t">And there are different goals for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1013" target="_blank">00:16:53.000</a></span> | <span class="t">Some are quite simple. For instance, if we have the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1019" target="_blank">00:16:59.000</a></span> | <span class="t">computation being defined twice, we only want it to be executed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1023" target="_blank">00:17:03.000</a></span> | <span class="t">twice. And there are some other things that are not necessary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1027" target="_blank">00:17:07.000</a></span> | <span class="t">You don't want to compute them at all. For instance, if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1032" target="_blank">00:17:12.000</a></span> | <span class="t">have X divided by X, and X is not used anywhere else, we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1037" target="_blank">00:17:17.000</a></span> | <span class="t">want to replace that by one. There are numerical stability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1042" target="_blank">00:17:22.000</a></span> | <span class="t">optimizations. For instance, log of 1 plus X can underflow if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1048" target="_blank">00:17:28.000</a></span> | <span class="t">you have a large number of operations, and you can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1053" target="_blank">00:17:33.000</a></span> | <span class="t">replace it by 1 plus X. Things like log of soft max get</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1058" target="_blank">00:17:38.000</a></span> | <span class="t">optimized into a more stable operation. It's also the time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1062" target="_blank">00:17:42.000</a></span> | <span class="t">where in place and destructive operations are inserted. For</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1066" target="_blank">00:17:46.000</a></span> | <span class="t">instance, if an operation is the last to be executed on some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1070" target="_blank">00:17:50.000</a></span> | <span class="t">numbers, it can, instead of allocating output memory, it can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1074" target="_blank">00:17:54.000</a></span> | <span class="t">allocate the output memory. And the transfer of the graph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1080" target="_blank">00:18:00.000</a></span> | <span class="t">expression to the GPU is done during the optimization phase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1086" target="_blank">00:18:06.000</a></span> | <span class="t">So, by default, TNO tries to apply most of the optimization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1092" target="_blank">00:18:12.000</a></span> | <span class="t">so that you have a run time that's almost as fast as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1095" target="_blank">00:18:15.000</a></span> | <span class="t">possible, except for a couple of checks and assertions. But if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1099" target="_blank">00:18:19.000</a></span> | <span class="t">you're not a big fan of fast feedback and don't care that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1105" target="_blank">00:18:25.000</a></span> | <span class="t">much about the run time speed, then you have a couple of ways</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1111" target="_blank">00:18:31.000</a></span> | <span class="t">of enabling and disabling some sets of optimizations, and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1117" target="_blank">00:18:37.000</a></span> | <span class="t">can do that either globally or function by function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1121" target="_blank">00:18:41.000</a></span> | <span class="t">So, to have a look at, for instance, what happens during</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1127" target="_blank">00:18:47.000</a></span> | <span class="t">the optimization phase, here's the original unoptimized graph</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1133" target="_blank">00:18:53.000</a></span> | <span class="t">going from the inputs X and W going to the output prediction.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1139" target="_blank">00:18:59.000</a></span> | <span class="t">It's the same one that we've seen before. And if we compare</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1143" target="_blank">00:19:03.000</a></span> | <span class="t">that with the function, the compiled function that goes from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1149" target="_blank">00:19:09.000</a></span> | <span class="t">these input variables to out, which was called predict, this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1153" target="_blank">00:19:13.000</a></span> | <span class="t">is the graph that we saw before. So, I won't go into details</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1159" target="_blank">00:19:19.000</a></span> | <span class="t">about what's happening in there, but here you have a GMV</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1165" target="_blank">00:19:25.000</a></span> | <span class="t">operation, which basically calls an optimized BLAS routine that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1169" target="_blank">00:19:29.000</a></span> | <span class="t">can also do multiplication and accumulation at the same time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1175" target="_blank">00:19:35.000</a></span> | <span class="t">We have a sigmoid operation here that will work in place</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1181" target="_blank">00:19:41.000</a></span> | <span class="t">operations. If you have a look at, for instance, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1187" target="_blank">00:19:47.000</a></span> | <span class="t">optimized graph computing the expression for the updated WNB,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1193" target="_blank">00:19:53.000</a></span> | <span class="t">this was the original one. And the optimized one is much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1199" target="_blank">00:19:59.000</a></span> | <span class="t">smaller. It has also in place operations. It has fused</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1205" target="_blank">00:20:05.000</a></span> | <span class="t">operations. Like, for instance, if you have a whole tensor and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1209" target="_blank">00:20:09.000</a></span> | <span class="t">you want to do addition with a constant and then a sigmoid and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1215" target="_blank">00:20:15.000</a></span> | <span class="t">then something else and so on, you want to only loop once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1219" target="_blank">00:20:19.000</a></span> | <span class="t">through the array and apply all the scalar operations on each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1223" target="_blank">00:20:23.000</a></span> | <span class="t">element and then go to the next and so on and not iterate each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1227" target="_blank">00:20:27.000</a></span> | <span class="t">time that you want to apply a new operation. And those kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1231" target="_blank">00:20:31.000</a></span> | <span class="t">of things happen often when you have automatically generated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1235" target="_blank">00:20:35.000</a></span> | <span class="t">a new operation. And here you see the update for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1241" target="_blank">00:20:41.000</a></span> | <span class="t">variables, which are inputs. So you see the cost and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1247" target="_blank">00:20:47.000</a></span> | <span class="t">implicit outputs for the updated WNB here and here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1252" target="_blank">00:20:52.000</a></span> | <span class="t">Another graph visualization tool that exists is the back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1257" target="_blank">00:20:57.000</a></span> | <span class="t">print, which basically prints text-based structure of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1261" target="_blank">00:21:01.000</a></span> | <span class="t">graph. So you can see the input of the array IDs and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1267" target="_blank">00:21:07.000</a></span> | <span class="t">variable names and so on. So here you can see more in detail</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1273" target="_blank">00:21:13.000</a></span> | <span class="t">what the structure is and you see the input of the scaling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1279" target="_blank">00:21:19.000</a></span> | <span class="t">parameters and so on. So when the function is compiled, then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1283" target="_blank">00:21:23.000</a></span> | <span class="t">we can actually run it. So the function is a callable Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1290" target="_blank">00:21:30.000</a></span> | <span class="t">function that we can call. And we've seen those examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1298" target="_blank">00:21:38.000</a></span> | <span class="t">here, for instance, where we call train and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1304" target="_blank">00:21:44.000</a></span> | <span class="t">But what happens to have, say, an optimized run time, it's not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1314" target="_blank">00:21:54.000</a></span> | <span class="t">just the function that is running. So we have on-the-fly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1320" target="_blank">00:22:00.000</a></span> | <span class="t">code generations, but we also generate C++ or CUDA code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1326" target="_blank">00:22:06.000</a></span> | <span class="t">For instance, for the LMYs loop fusion that I mentioned, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1330" target="_blank">00:22:10.000</a></span> | <span class="t">can't know in advance which element was operation will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1335" target="_blank">00:22:15.000</a></span> | <span class="t">-- will occur in which order in any graph that the user might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1339" target="_blank">00:22:19.000</a></span> | <span class="t">be running. So we have a bunch of generations for that. We</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1345" target="_blank">00:22:25.000</a></span> | <span class="t">generate Python module written in C++ or CUDA that gets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1349" target="_blank">00:22:29.000</a></span> | <span class="t">compiled and imported back so we can use it from Python.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1354" target="_blank">00:22:34.000</a></span> | <span class="t">The run time environment then calls in the right order the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1360" target="_blank">00:22:40.000</a></span> | <span class="t">different operations that have to be executed from the inputs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1364" target="_blank">00:22:44.000</a></span> | <span class="t">that we get. So we can use the same code to get the desired</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1369" target="_blank">00:22:49.000</a></span> | <span class="t">results. We have a couple of different ones, and in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1373" target="_blank">00:22:53.000</a></span> | <span class="t">particular, there's one which was written in C++ which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1377" target="_blank">00:22:57.000</a></span> | <span class="t">avoids having to switch context between the Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1381" target="_blank">00:23:01.000</a></span> | <span class="t">interpreter and the C++ execution engine.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1385" target="_blank">00:23:05.000</a></span> | <span class="t">Something else that's really crucial for speed and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1389" target="_blank">00:23:09.000</a></span> | <span class="t">accuracy is the GPU. We wanted to make it as simple as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1395" target="_blank">00:23:15.000</a></span> | <span class="t">possible in usual cases. So now it supports a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1403" target="_blank">00:23:23.000</a></span> | <span class="t">different data types, not only float 32, but double precision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1408" target="_blank">00:23:28.000</a></span> | <span class="t">if you really need that, integers as well. And we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1414" target="_blank">00:23:34.000</a></span> | <span class="t">a lot of GPUs that are running on the GPU. We have a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1420" target="_blank">00:23:40.000</a></span> | <span class="t">GPUs that are running with GPU arrays from Python itself. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1424" target="_blank">00:23:44.000</a></span> | <span class="t">you can just use Python code to handle GPU arrays outside of a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1429" target="_blank">00:23:49.000</a></span> | <span class="t">function if you like. All of that will be in the future 0.9</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1433" target="_blank">00:23:53.000</a></span> | <span class="t">release that we hope to get out soon.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1436" target="_blank">00:23:56.000</a></span> | <span class="t">And to use it, well, you select the device that you want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1440" target="_blank">00:24:00.000</a></span> | <span class="t">use, and you can use it with just a configuration flag. For</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1446" target="_blank">00:24:06.000</a></span> | <span class="t">instance, use CUDA to get the first GPU that's available, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1452" target="_blank">00:24:12.000</a></span> | <span class="t">one specific one. And if you specify that in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1456" target="_blank">00:24:16.000</a></span> | <span class="t">configuration, then all shared variables will by default be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1461" target="_blank">00:24:21.000</a></span> | <span class="t">created in GPU memory. And the optimizations that move the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1466" target="_blank">00:24:26.000</a></span> | <span class="t">CPU operation by GPU operations are going to be applied.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1472" target="_blank">00:24:32.000</a></span> | <span class="t">Usually, you want to make sure you use float 32 or even float</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1478" target="_blank">00:24:38.000</a></span> | <span class="t">16 for storage, which is experimental, but because most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1483" target="_blank">00:24:43.000</a></span> | <span class="t">GPUs don't have a good performance for the bulk</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1488" target="_blank">00:24:48.000</a></span> | <span class="t">precision. So how you set those configuration flags? You have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1494" target="_blank">00:24:54.000</a></span> | <span class="t">to set them in the configuration file. So if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1498" target="_blank">00:24:58.000</a></span> | <span class="t">remember the configuration file that you can -- it's just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1503" target="_blank">00:25:03.000</a></span> | <span class="t">configuration file for Python. You have an environment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1507" target="_blank">00:25:07.000</a></span> | <span class="t">variable where you can define those, and the environment</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1511" target="_blank">00:25:11.000</a></span> | <span class="t">variable overrides the config file, and you can also set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1515" target="_blank">00:25:15.000</a></span> | <span class="t">things directly from Python. But some flags have to be known in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1519" target="_blank">00:25:19.000</a></span> | <span class="t">the configuration file. So if you want to set the device</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1524" target="_blank">00:25:24.000</a></span> | <span class="t">itself, you have to set it either in the configuration file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1530" target="_blank">00:25:30.000</a></span> | <span class="t">or through flags.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1536" target="_blank">00:25:36.000</a></span> | <span class="t">So I'm going to quickly go over more advanced topics, and if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1541" target="_blank">00:25:41.000</a></span> | <span class="t">you want to learn more about that, there's other tutorials</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1546" target="_blank">00:25:46.000</a></span> | <span class="t">on the web, and there's a lot of documentation on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1551" target="_blank">00:25:51.000</a></span> | <span class="t">deeplearning.net. So to have loops in the graph, we've seen</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1555" target="_blank">00:25:55.000</a></span> | <span class="t">that the expression graph is basically a directed acyclic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1560" target="_blank">00:26:00.000</a></span> | <span class="t">graph, and we cannot have loops in there. One way, if you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1565" target="_blank">00:26:05.000</a></span> | <span class="t">in advance the number of iterations, is just to unroll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1569" target="_blank">00:26:09.000</a></span> | <span class="t">the loop, use for loop in Python that builds all the nodes for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1573" target="_blank">00:26:13.000</a></span> | <span class="t">the loop. So it doesn't work if you want, for instance, to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1580" target="_blank">00:26:20.000</a></span> | <span class="t">have dynamic size for the loop. For models that generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1586" target="_blank">00:26:26.000</a></span> | <span class="t">sequences, for instance, it can be an issue.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1590" target="_blank">00:26:30.000</a></span> | <span class="t">So what we have for that in TNO is called scan, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1596" target="_blank">00:26:36.000</a></span> | <span class="t">basically, it's one node that encapsulates another whole TNO</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1602" target="_blank">00:26:42.000</a></span> | <span class="t">function, and it's going to compute the -- it's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1608" target="_blank">00:26:48.000</a></span> | <span class="t">represent the computation that has to be done at each time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1612" target="_blank">00:26:52.000</a></span> | <span class="t">step. So you have a TNO function that performs the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1616" target="_blank">00:26:56.000</a></span> | <span class="t">computation for one time step, and you have the scan node that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1620" target="_blank">00:27:00.000</a></span> | <span class="t">calls it in the loop, taking care of the bookkeeping of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1624" target="_blank">00:27:04.000</a></span> | <span class="t">indices and sequences and feeding the right slice at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1628" target="_blank">00:27:08.000</a></span> | <span class="t">right time. And having that structure makes it also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1633" target="_blank">00:27:13.000</a></span> | <span class="t">possible to define a gradient for that node, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1637" target="_blank">00:27:17.000</a></span> | <span class="t">basically another scan node, another loop that goes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1641" target="_blank">00:27:21.000</a></span> | <span class="t">backwards and applies backprops with time. And it can be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1645" target="_blank">00:27:25.000</a></span> | <span class="t">transferred to GPU as well, in which case the internal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1649" target="_blank">00:27:29.000</a></span> | <span class="t">function is going to be transferred and recompiled on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1654" target="_blank">00:27:34.000</a></span> | <span class="t">the GPU. And we will talk about the LSTM example later.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1660" target="_blank">00:27:40.000</a></span> | <span class="t">This is just a small example, but we don't really have time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1664" target="_blank">00:27:44.000</a></span> | <span class="t">for that. We also have visualization, debugging, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1670" target="_blank">00:27:50.000</a></span> | <span class="t">diagnostic tools. One of the reasons it's important is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1674" target="_blank">00:27:54.000</a></span> | <span class="t">in TNO, like in TensorFlow, the definition of a function is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1679" target="_blank">00:27:59.000</a></span> | <span class="t">defined in the expression. So if something doesn't work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1685" target="_blank">00:28:05.000</a></span> | <span class="t">during the execution, if you encounter errors and so on,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1689" target="_blank">00:28:09.000</a></span> | <span class="t">then it's not obvious how to connect that from where the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1693" target="_blank">00:28:13.000</a></span> | <span class="t">expression was actually defined. So we try to have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1700" target="_blank">00:28:20.000</a></span> | <span class="t">informative error messages, and we have some completion</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1705" target="_blank">00:28:25.000</a></span> | <span class="t">methods, like the test value, which is not a number, for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1710" target="_blank">00:28:30.000</a></span> | <span class="t">large values. You can assign test values to the symbolic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1715" target="_blank">00:28:35.000</a></span> | <span class="t">variables so that each time you create a new symbolic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1720" target="_blank">00:28:40.000</a></span> | <span class="t">intermediate variable, each time you define a new expression,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1725" target="_blank">00:28:45.000</a></span> | <span class="t">then the test value gets computed, and so you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1729" target="_blank">00:28:49.000</a></span> | <span class="t">evaluate on one piece of data at the same time as you build</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1733" target="_blank">00:28:53.000</a></span> | <span class="t">the new expression. So you can avoid mistakes,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1737" target="_blank">00:28:57.000</a></span> | <span class="t">mistakes, errors, and things like that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1740" target="_blank">00:29:00.000</a></span> | <span class="t">It's possible to extend TNO in a couple of ways. You can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1745" target="_blank">00:29:05.000</a></span> | <span class="t">create an op just from Python by calling Python wrappers for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1752" target="_blank">00:29:12.000</a></span> | <span class="t">existing efficient libraries. You can extend TNO by writing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1758" target="_blank">00:29:18.000</a></span> | <span class="t">new functions, either for increased numerical stability,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1763" target="_blank">00:29:23.000</a></span> | <span class="t">for instance, or for more efficient computation, or for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1768" target="_blank">00:29:28.000</a></span> | <span class="t">introducing your new ops instead of the naive versions that a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1775" target="_blank">00:29:35.000</a></span> | <span class="t">user might have used.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1779" target="_blank">00:29:39.000</a></span> | <span class="t">We have a couple of new features that have been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1783" target="_blank">00:29:43.000</a></span> | <span class="t">added to TNO. I mentioned the new GPU backend, with support</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1789" target="_blank">00:29:49.000</a></span> | <span class="t">for many data types, and we've had some performance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1794" target="_blank">00:29:54.000</a></span> | <span class="t">improvements, especially for convolution, 2D and 3D, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1799" target="_blank">00:29:59.000</a></span> | <span class="t">especially on GPU. We've made some progress on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1805" target="_blank">00:30:05.000</a></span> | <span class="t">time of the graph optimization phase, and also have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1810" target="_blank">00:30:10.000</a></span> | <span class="t">improved the performance of the graph. We have new ways of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1815" target="_blank">00:30:15.000</a></span> | <span class="t">avoiding recompiling the same graph over and over again, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1819" target="_blank">00:30:19.000</a></span> | <span class="t">we have new diagnostic tools that are quite useful, an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1824" target="_blank">00:30:24.000</a></span> | <span class="t">interactive graph visualization tool, and PDB breakpoints that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1828" target="_blank">00:30:28.000</a></span> | <span class="t">enables you to monitor a couple of variables and only break if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1833" target="_blank">00:30:33.000</a></span> | <span class="t">some condition is met, rather than monitoring something every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1837" target="_blank">00:30:37.000</a></span> | <span class="t">time. In the future, while we're still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1842" target="_blank">00:30:42.000</a></span> | <span class="t">working on new operations on GPU, we still want to wrap more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1849" target="_blank">00:30:49.000</a></span> | <span class="t">operations for better performance, in particular, the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1855" target="_blank">00:30:55.000</a></span> | <span class="t">basic RNNs should be completed in the following days,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1859" target="_blank">00:30:59.000</a></span> | <span class="t">hopefully. Someone has been working on that a lot recently.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1864" target="_blank">00:31:04.000</a></span> | <span class="t">And, of course, we have support for 3D convolutions, still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1870" target="_blank">00:31:10.000</a></span> | <span class="t">faster optimisation, and more work on data parallelism as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1875" target="_blank">00:31:15.000</a></span> | <span class="t">well. So, yes, I want to thank</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1880" target="_blank">00:31:20.000</a></span> | <span class="t">most of my colleagues and main TNO developers, and people who</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1886" target="_blank">00:31:26.000</a></span> | <span class="t">contributed one way or another to our lab and the software</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1891" target="_blank">00:31:31.000</a></span> | <span class="t">development team, and the team that is working on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1897" target="_blank">00:31:37.000</a></span> | <span class="t">organisers for this call. Now, yes, so the slides are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1903" target="_blank">00:31:43.000</a></span> | <span class="t">available online. As I mentioned, there is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1909" target="_blank">00:31:49.000</a></span> | <span class="t">companion notebook, and now we can start to - and more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1913" target="_blank">00:31:53.000</a></span> | <span class="t">resources if you want to go further. And now I think it is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1917" target="_blank">00:31:57.000</a></span> | <span class="t">time to move on to the demo. So, for those who have not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1926" target="_blank">00:32:06.000</a></span> | <span class="t">cloned the repository yet, then this is the command line you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1931" target="_blank">00:32:11.000</a></span> | <span class="t">want to launch. For those who have cloned it, you might want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1936" target="_blank">00:32:16.000</a></span> | <span class="t">to do a Git pull, just to get the latest - to make sure we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1941" target="_blank">00:32:21.000</a></span> | <span class="t">have the latest version of the Jupyter notebook on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1949" target="_blank">00:32:29.000</a></span> | <span class="t">repository itself. So we have three examples that we are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1953" target="_blank">00:32:33.000</a></span> | <span class="t">going to go over. Logistic regression,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1959" target="_blank">00:32:39.000</a></span> | <span class="t">ConvNet, and LSTM. So I've launched the Jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1965" target="_blank">00:32:45.000</a></span> | <span class="t">notebook here. So, intro TNO was the companion notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1970" target="_blank">00:32:50.000</a></span> | <span class="t">So, we have the logistic regression, and we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1976" target="_blank">00:32:56.000</a></span> | <span class="t">logistic regression. So let's go with the logistic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1980" target="_blank">00:33:00.000</a></span> | <span class="t">regression. Is that big enough, or do I need to increase the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1986" target="_blank">00:33:06.000</a></span> | <span class="t">font size? Okay. So I'm going to skip over the text, because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1993" target="_blank">00:33:13.000</a></span> | <span class="t">you probably know already about the model. We have some - we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=1999" target="_blank">00:33:19.000</a></span> | <span class="t">have some data that we want to load. So let's load the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2008" target="_blank">00:33:28.000</a></span> | <span class="t">with the - on GitHub, with the repository. So let's load the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2015" target="_blank">00:33:35.000</a></span> | <span class="t">data. And here, let's see how we define the model. So it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2020" target="_blank">00:33:40.000</a></span> | <span class="t">basically the same way that we did in the slides. We define</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2026" target="_blank">00:33:46.000</a></span> | <span class="t">an input variable. Here it's a matrix, because we want to use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2032" target="_blank">00:33:52.000</a></span> | <span class="t">many batches. And we have shared variables initialised from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2039" target="_blank">00:33:59.000</a></span> | <span class="t">zeros. Then we define the - our model. So, here's our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2050" target="_blank">00:34:10.000</a></span> | <span class="t">predictor. So the probability of the class given the input,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2057" target="_blank">00:34:17.000</a></span> | <span class="t">and we're going to use, well, so here, the fine model, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2065" target="_blank">00:34:25.000</a></span> | <span class="t">then the softmax on top of it, and the prediction, if you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2071" target="_blank">00:34:31.000</a></span> | <span class="t">to have a prediction, it's going to be the class of maximum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2077" target="_blank">00:34:37.000</a></span> | <span class="t">probability. So, max over that axis, because we still want one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2083" target="_blank">00:34:43.000</a></span> | <span class="t">prediction for each element of the mini-batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2089" target="_blank">00:34:49.000</a></span> | <span class="t">Then we define the last function. So here is going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2093" target="_blank">00:34:53.000</a></span> | <span class="t">the log likelihood of the label given the input, or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2099" target="_blank">00:34:59.000</a></span> | <span class="t">cross-entropy, and we define it simply, we don't have, like, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2103" target="_blank">00:35:03.000</a></span> | <span class="t">don't need to have one cross-entropy or log likelihood</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2109" target="_blank">00:35:09.000</a></span> | <span class="t">operation by itself. You can just build it from the basic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2112" target="_blank">00:35:12.000</a></span> | <span class="t">building blocks. So you take the log of the probability, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2117" target="_blank">00:35:17.000</a></span> | <span class="t">take the index of the actual target, and then you take the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2124" target="_blank">00:35:24.000</a></span> | <span class="t">mean of that to have the mean prediction over the mini-batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2129" target="_blank">00:35:29.000</a></span> | <span class="t">And then you have the gradient. Derive the update rules. So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2136" target="_blank">00:35:36.000</a></span> | <span class="t">again, we don't have, like, one gradient descent object or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2141" target="_blank">00:35:41.000</a></span> | <span class="t">something like that. We just build whatever rule we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2148" target="_blank">00:35:48.000</a></span> | <span class="t">So, yeah, we could use momentum by defining other shared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2154" target="_blank">00:35:54.000</a></span> | <span class="t">variables, like the gradient, and then we have the gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2159" target="_blank">00:35:59.000</a></span> | <span class="t">for the velocity, and then the expressions for both the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2164" target="_blank">00:36:04.000</a></span> | <span class="t">velocity and the shared variable itself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2169" target="_blank">00:36:09.000</a></span> | <span class="t">And then we compile a train function going from X and Y,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2174" target="_blank">00:36:14.000</a></span> | <span class="t">outputting the loss, and updating W and B.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2179" target="_blank">00:36:19.000</a></span> | <span class="t">So, yeah, we have the train function, and then we have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2184" target="_blank">00:36:24.000</a></span> | <span class="t">train function, and then the train is getting optimized.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2187" target="_blank">00:36:27.000</a></span> | <span class="t">Let's see the next step. Well, we also want to monitor not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2192" target="_blank">00:36:32.000</a></span> | <span class="t">only the log likelihood, but actually the misclassification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2199" target="_blank">00:36:39.000</a></span> | <span class="t">rate on validation and test set. So it's simply the different,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2205" target="_blank">00:36:45.000</a></span> | <span class="t">like, the rate, and the rate is the mean or the mini-batch, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2211" target="_blank">00:36:51.000</a></span> | <span class="t">we create another -- we compile another function, and not doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2217" target="_blank">00:36:57.000</a></span> | <span class="t">any updates, of course. So, to train the model, well, first,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2222" target="_blank">00:37:02.000</a></span> | <span class="t">we need to process the data a little bit. So we want to feed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2227" target="_blank">00:37:07.000</a></span> | <span class="t">the model one mini-batch of data at a time. So here we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2232" target="_blank">00:37:12.000</a></span> | <span class="t">the train function, and then we have the mini-batch, and it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2238" target="_blank">00:37:18.000</a></span> | <span class="t">not a Python generator, but a helper function that gives us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2243" target="_blank">00:37:23.000</a></span> | <span class="t">the mini-batch number I, and it's going to be the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2247" target="_blank">00:37:27.000</a></span> | <span class="t">function used for the training and validation and test set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2252" target="_blank">00:37:32.000</a></span> | <span class="t">We define a couple of parameters for early stopping in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2256" target="_blank">00:37:36.000</a></span> | <span class="t">training loop. It's not necessary. It's just, like, a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2261" target="_blank">00:37:41.000</a></span> | <span class="t">little bit more complex than the model that was encountered</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2266" target="_blank">00:37:46.000</a></span> | <span class="t">during the optimization. So let's define that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2271" target="_blank">00:37:51.000</a></span> | <span class="t">And this is the main training loop. It's a bit more complex</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2276" target="_blank">00:37:56.000</a></span> | <span class="t">than it might be, but it's because we use this early</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2281" target="_blank">00:38:01.000</a></span> | <span class="t">stopping, and we want to only validate when we are confident</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2286" target="_blank">00:38:06.000</a></span> | <span class="t">that the model is running. So, we have a couple of parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2291" target="_blank">00:38:11.000</a></span> | <span class="t">that we can run down enough, but basically, the most important</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2296" target="_blank">00:38:16.000</a></span> | <span class="t">part is you loop over the epochs unless you encounter the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2303" target="_blank">00:38:23.000</a></span> | <span class="t">early stopping conditions, and then, during each epoch, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2308" target="_blank">00:38:28.000</a></span> | <span class="t">want to loop over the mini-batches and call train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2313" target="_blank">00:38:33.000</a></span> | <span class="t">loop. And then, we want to get some result of the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2318" target="_blank">00:38:38.000</a></span> | <span class="t">error, so here we call test model on the validation set for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2323" target="_blank">00:38:43.000</a></span> | <span class="t">that, and then keep track of what the best model currently</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2330" target="_blank">00:38:50.000</a></span> | <span class="t">is, and get the test error as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2337" target="_blank">00:38:57.000</a></span> | <span class="t">And save the best one. So, to save the best one, to save</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2342" target="_blank">00:39:02.000</a></span> | <span class="t">the best one, we need to save the values of all parameters,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2347" target="_blank">00:39:07.000</a></span> | <span class="t">which is more robust than trying to pickle the whole Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2354" target="_blank">00:39:14.000</a></span> | <span class="t">object, and it also enables more easily transfer to other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2359" target="_blank">00:39:19.000</a></span> | <span class="t">frameworks, to visualization frameworks, and so on. So let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2362" target="_blank">00:39:22.000</a></span> | <span class="t">try to execute that. So, of course, it's a simple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2367" target="_blank">00:39:27.000</a></span> | <span class="t">model, and it's running on the same time, so it should not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2374" target="_blank">00:39:34.000</a></span> | <span class="t">take that long. So, you see that at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2382" target="_blank">00:39:42.000</a></span> | <span class="t">beginning, well, almost at each iteration, we are better on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2386" target="_blank">00:39:46.000</a></span> | <span class="t">training set, and then, after a while, the progress is slower,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2396" target="_blank">00:39:56.000</a></span> | <span class="t">and then, we are better on the training set. So, wait a little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2400" target="_blank">00:40:00.000</a></span> | <span class="t">bit more. Seems to stall more and more.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2408" target="_blank">00:40:08.000</a></span> | <span class="t">Okay. And here is the end after 96 epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2415" target="_blank">00:40:15.000</a></span> | <span class="t">So, now, if we want to visualize what filters were learned, or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2422" target="_blank">00:40:22.000</a></span> | <span class="t">what we learned, we are using a helper function here to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2428" target="_blank">00:40:28.000</a></span> | <span class="t">visualize the filters. It's not really important. But here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2432" target="_blank">00:40:32.000</a></span> | <span class="t">what we use is we call get value on the weights to access the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2440" target="_blank">00:40:40.000</a></span> | <span class="t">internal value of the shared variable, and then we use that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2446" target="_blank">00:40:46.000</a></span> | <span class="t">to visualize the filter. So, we have the training set, and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2450" target="_blank">00:40:50.000</a></span> | <span class="t">have the filters, and we can see it's kind of reasonable, like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2454" target="_blank">00:40:54.000</a></span> | <span class="t">this is the filter for class 0, and you can see kind of like a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2459" target="_blank">00:40:59.000</a></span> | <span class="t">0, 1, what's important for the two is to have an opening here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2465" target="_blank">00:41:05.000</a></span> | <span class="t">and so on. So, yeah, if we have a look at the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2473" target="_blank">00:41:13.000</a></span> | <span class="t">training error, is - well, do we see the training error? No,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2479" target="_blank">00:41:19.000</a></span> | <span class="t">I'm not plotting it. But the validation and the test error are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2484" target="_blank">00:41:24.000</a></span> | <span class="t">quite high, and we know that the human level performance is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2489" target="_blank">00:41:29.000</a></span> | <span class="t">quite low, and the performance of other models is quite low, so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2493" target="_blank">00:41:33.000</a></span> | <span class="t">it really means that the model is too simple, and we should use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2497" target="_blank">00:41:37.000</a></span> | <span class="t">something more advanced. So, to use something more advanced, if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2504" target="_blank">00:41:44.000</a></span> | <span class="t">you go back to the home of the Jupyter notebook, you can have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2511" target="_blank">00:41:51.000</a></span> | <span class="t">look at the conf net, and run the net.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2520" target="_blank">00:42:00.000</a></span> | <span class="t">So, this new example is basically - it's the same data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2524" target="_blank">00:42:04.000</a></span> | <span class="t">but it's a bit more advanced, and it's a bit more optimized,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2529" target="_blank">00:42:09.000</a></span> | <span class="t">because it has the advantage of training fast even on an older</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2534" target="_blank">00:42:14.000</a></span> | <span class="t">laptop, but this time, we're going to use a convolutional net</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2539" target="_blank">00:42:19.000</a></span> | <span class="t">with a couple of convolution layers, and fully connected</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2544" target="_blank">00:42:24.000</a></span> | <span class="t">layers, and the final classifier. So I'm going to make sure that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2549" target="_blank">00:42:29.000</a></span> | <span class="t">I'm not over-composing the data. So, let's see how we could use</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2555" target="_blank">00:42:35.000</a></span> | <span class="t">TNO to define helper classes that are layers that can make it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2561" target="_blank">00:42:41.000</a></span> | <span class="t">easier for a user to compose them if they want to replicate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2567" target="_blank">00:42:47.000</a></span> | <span class="t">some results, or use some classical architectures.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2573" target="_blank">00:42:53.000</a></span> | <span class="t">This is done usually in frameworks built on top of TNO</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2578" target="_blank">00:42:58.000</a></span> | <span class="t">and TNO, and they develop their own mini-framework with their</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2584" target="_blank">00:43:04.000</a></span> | <span class="t">own versions of layers and so on that they find useful and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2590" target="_blank">00:43:10.000</a></span> | <span class="t">intuitive. So, this logistic regression layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2597" target="_blank">00:43:17.000</a></span> | <span class="t">basically holds, well, parameters, weight, and bias, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2606" target="_blank">00:43:26.000</a></span> | <span class="t">it's a very simple classifier. It's a set of a variety of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2612" target="_blank">00:43:32.000</a></span> | <span class="t">classes, prediction holds the params, and have expressions for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2618" target="_blank">00:43:38.000</a></span> | <span class="t">the negative log likelihood and the errors. So, if you were to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2624" target="_blank">00:43:44.000</a></span> | <span class="t">use only that class, then it's doing essentially the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2630" target="_blank">00:43:50.000</a></span> | <span class="t">the previous one. And, in the same way, we can define a layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2637" target="_blank">00:43:57.000</a></span> | <span class="t">that has convolution and pooling. So, again, in the init</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2643" target="_blank">00:44:03.000</a></span> | <span class="t">method, we pass it, well, filter shape, image shape, the size of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2649" target="_blank">00:44:09.000</a></span> | <span class="t">pooling, and so on. We initialise the weights using the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2655" target="_blank">00:44:15.000</a></span> | <span class="t">same classifier, and we compute the bias from the input, well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2663" target="_blank">00:44:23.000</a></span> | <span class="t">we compute to the convolution with the filters. We then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2671" target="_blank">00:44:31.000</a></span> | <span class="t">compute max pooling, and output, well, tan h of the pooling plus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2679" target="_blank">00:44:39.000</a></span> | <span class="t">the bias. So, we have a bias, and here, the bias is only like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2685" target="_blank">00:44:45.000</a></span> | <span class="t">one number for each channel, so which means that you don't have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2689" target="_blank">00:44:49.000</a></span> | <span class="t">a different bias for each location in the image. So, you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2694" target="_blank">00:44:54.000</a></span> | <span class="t">could actually apply such a layer on images of various size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2700" target="_blank">00:45:00.000</a></span> | <span class="t">without having to initialise new parameters or retrain that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2706" target="_blank">00:45:06.000</a></span> | <span class="t">So, we have a layer, and we have a hidden layer, which is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2712" target="_blank">00:45:12.000</a></span> | <span class="t">a fully connected layer. Again, initialising weights and bias,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2717" target="_blank">00:45:17.000</a></span> | <span class="t">and expression going from the symbolic expression going from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2722" target="_blank">00:45:22.000</a></span> | <span class="t">the input, and the shared variables to the output after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2727" target="_blank">00:45:27.000</a></span> | <span class="t">activation. And, again, we want to collect the parameters so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2731" target="_blank">00:45:31.000</a></span> | <span class="t">that we can actually apply the same thing to the output.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2737" target="_blank">00:45:37.000</a></span> | <span class="t">And then, here's a function that has the main loop, and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2743" target="_blank">00:45:43.000</a></span> | <span class="t">main training loop. So we have a mini-batch generator, again,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2748" target="_blank">00:45:48.000</a></span> | <span class="t">the same code as before, and here, we are building the whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2752" target="_blank">00:45:52.000</a></span> | <span class="t">graph. So, always the same process. We define input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2760" target="_blank">00:46:00.000</a></span> | <span class="t">vectors, and we define the input vectors. So, L vector is a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2766" target="_blank">00:46:06.000</a></span> | <span class="t">vector of long, because the targets here are indices, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2772" target="_blank">00:46:12.000</a></span> | <span class="t">not one-hot vectors or masks or something like that. And we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2777" target="_blank">00:46:17.000</a></span> | <span class="t">create the first layer, which is a layer with size. We want to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2784" target="_blank">00:46:24.000</a></span> | <span class="t">have a size of one, and we want to have a size of two. So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2791" target="_blank">00:46:31.000</a></span> | <span class="t">here, the image size changes. This is mostly for efficiency,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2796" target="_blank">00:46:36.000</a></span> | <span class="t">actually. You don't really have to pass that for those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2800" target="_blank">00:46:40.000</a></span> | <span class="t">particular models. But you still need the shape of filters. I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2805" target="_blank">00:46:45.000</a></span> | <span class="t">mean, you have the filters anyway. And then, it's useful to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2810" target="_blank">00:46:50.000</a></span> | <span class="t">have a layer that is fully connected. So, the convolution</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2815" target="_blank">00:46:55.000</a></span> | <span class="t">layers can handle arbitrary-sized images. And then,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2819" target="_blank">00:46:59.000</a></span> | <span class="t">after that, we want to flatten the whole feature maps and feed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2824" target="_blank">00:47:04.000</a></span> | <span class="t">that into a fully connected layer and into the prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2827" target="_blank">00:47:07.000</a></span> | <span class="t">layer. So this one has to be fixed, so we have to know what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2834" target="_blank">00:47:14.000</a></span> | <span class="t">the output layer is. So, we have four dimensions. And here we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2841" target="_blank">00:47:21.000</a></span> | <span class="t">go. A fully connected layer, and the output layer, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2846" target="_blank">00:47:26.000</a></span> | <span class="t">just the class, the same as before. We want the final cost</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2852" target="_blank">00:47:32.000</a></span> | <span class="t">to be the log likelihood of that. We have, again, the errors,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2859" target="_blank">00:47:39.000</a></span> | <span class="t">the parameters, or the concatenation of the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2864" target="_blank">00:47:44.000</a></span> | <span class="t">of all layers. And once we have that, we can build the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2869" target="_blank">00:47:49.000</a></span> | <span class="t">gradient. So, just one call of grad of cost with respect to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2874" target="_blank">00:47:54.000</a></span> | <span class="t">params. Get the updates. So, again, just regular SGD, but we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2880" target="_blank">00:48:00.000</a></span> | <span class="t">could have a class or something that performs like momentum,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2886" target="_blank">00:48:06.000</a></span> | <span class="t">whatever you need. Compile the function. And here we have,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2892" target="_blank">00:48:12.000</a></span> | <span class="t">again, the early stopping routine with the same main loop</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2897" target="_blank">00:48:17.000</a></span> | <span class="t">for all epochs until we're done. Then loop over the mini</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2901" target="_blank">00:48:21.000</a></span> | <span class="t">batches and validate every once in a while and stop when it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2905" target="_blank">00:48:25.000</a></span> | <span class="t">finished. So, let's just declare that. Loading the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2911" target="_blank">00:48:31.000</a></span> | <span class="t">So, we have the same output, exactly the same as before. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2918" target="_blank">00:48:38.000</a></span> | <span class="t">here we can actually run that. So, this was the result of a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2926" target="_blank">00:48:46.000</a></span> | <span class="t">previous run. That took five minutes. So, I will probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2933" target="_blank">00:48:53.000</a></span> | <span class="t">not have time to do that, but here you can see basically what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2938" target="_blank">00:48:58.000</a></span> | <span class="t">the result looks like. So, if you want to try that or try that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2944" target="_blank">00:49:04.000</a></span> | <span class="t">during the lunch break or later, you're welcome to play with it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2952" target="_blank">00:49:12.000</a></span> | <span class="t">And after that, yeah, you can visualize the run filters as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2959" target="_blank">00:49:19.000</a></span> | <span class="t">well. So, here you have the first layer. And for the -- and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2969" target="_blank">00:49:29.000</a></span> | <span class="t">here you have the -- an example of the activations of the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2974" target="_blank">00:49:34.000</a></span> | <span class="t">layer for one example. So, we have just a little bit more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2983" target="_blank">00:49:43.000</a></span> | <span class="t">information. So, let's just go back to the tutorial. I mean,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2990" target="_blank">00:49:50.000</a></span> | <span class="t">example. So, if you go back to the home of the Jupyter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=2999" target="_blank">00:49:59.000</a></span> | <span class="t">notebook and go to LSTM, then -- so, this model is an LSTM</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3012" target="_blank">00:50:12.000</a></span> | <span class="t">model. So, it's a model of a sentence given the previous</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3018" target="_blank">00:50:18.000</a></span> | <span class="t">ones. So, not going to go into details, but here you can see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3026" target="_blank">00:50:26.000</a></span> | <span class="t">that the LSTM layer is defined here with variables for all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3036" target="_blank">00:50:36.000</a></span> | <span class="t">matrices that you need and the different biases for the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3039" target="_blank">00:50:39.000</a></span> | <span class="t">parameters. So, you have a lot of parameters. It would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3045" target="_blank">00:50:45.000</a></span> | <span class="t">possible and sometimes more efficient to actually define,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3051" target="_blank">00:50:51.000</a></span> | <span class="t">say, only one variable that contains the concatenation of a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3057" target="_blank">00:50:57.000</a></span> | <span class="t">couple of matrices, and that way you can do more efficient,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3063" target="_blank">00:51:03.000</a></span> | <span class="t">more efficient, and more efficient implementation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3069" target="_blank">00:51:09.000</a></span> | <span class="t">And here's an example of how to use a scan for the loop. So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3075" target="_blank">00:51:15.000</a></span> | <span class="t">here we define a step function that takes, well, a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3086" target="_blank">00:51:26.000</a></span> | <span class="t">different inputs, so you have, like, the different activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3090" target="_blank">00:51:30.000</a></span> | <span class="t">steps, you have the current sequence input and so on, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3096" target="_blank">00:51:36.000</a></span> | <span class="t">from them, here's basically the LSTM formula where you have the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3103" target="_blank">00:51:43.000</a></span> | <span class="t">dot product and sigma or tan H of the different connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3109" target="_blank">00:51:49.000</a></span> | <span class="t">inside the cell, and in the end, you have the hidden and that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3119" target="_blank">00:51:59.000</a></span> | <span class="t">is the function that you need to use. So, once you have that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3125" target="_blank">00:52:05.000</a></span> | <span class="t">that step function is going to be passed to TNO dot scan, where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3133" target="_blank">00:52:13.000</a></span> | <span class="t">the sequences are the mask and the input. So, the mask is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3139" target="_blank">00:52:19.000</a></span> | <span class="t">useful because we are using many batches of sequences and not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3143" target="_blank">00:52:23.000</a></span> | <span class="t">all the sequences in the same batch have the same length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3148" target="_blank">00:52:28.000</a></span> | <span class="t">So, we can use the same step function to group examples of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3154" target="_blank">00:52:34.000</a></span> | <span class="t">similar lengths together, but they may not always be exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3158" target="_blank">00:52:38.000</a></span> | <span class="t">the same length. So, in that case, we pad that to only the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3162" target="_blank">00:52:42.000</a></span> | <span class="t">longest sequence in the mini-batch, not the longest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3166" target="_blank">00:52:46.000</a></span> | <span class="t">sequence in the whole set, just for the mini-batch, but we have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3170" target="_blank">00:52:50.000</a></span> | <span class="t">to pad and remember what the length of the different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3174" target="_blank">00:52:54.000</a></span> | <span class="t">sequences are. So, let's define that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3181" target="_blank">00:53:01.000</a></span> | <span class="t">Here, we define the cost function, that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3187" target="_blank">00:53:07.000</a></span> | <span class="t">cross-entropy of the sequence, and here, again, you see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3190" target="_blank">00:53:10.000</a></span> | <span class="t">the mask is used so that we don't consider the predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3194" target="_blank">00:53:14.000</a></span> | <span class="t">after the end of the sequence. Logistic regression, the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3199" target="_blank">00:53:19.000</a></span> | <span class="t">the cost function, but we are using the same cost.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3206" target="_blank">00:53:26.000</a></span> | <span class="t">Here, for processing the data, we are using fuel, which is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3210" target="_blank">00:53:30.000</a></span> | <span class="t">another tool being developed by a couple of students at Mila,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3214" target="_blank">00:53:34.000</a></span> | <span class="t">and it's nice because it can read from just plain text data,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3220" target="_blank">00:53:40.000</a></span> | <span class="t">do some preprocessing on the fly, including things that I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3225" target="_blank">00:53:45.000</a></span> | <span class="t">will show you in a second. So, we are doing sequences by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3231" target="_blank">00:53:51.000</a></span> | <span class="t">similar length, and then shuffling them, and padding, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3235" target="_blank">00:53:55.000</a></span> | <span class="t">doing all of that. And so, that puts a generator that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3243" target="_blank">00:54:03.000</a></span> | <span class="t">can then feed in your main loop through a TNO function. So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3247" target="_blank">00:54:07.000</a></span> | <span class="t">that whole preprocessing happens outside of TNO, and then the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3252" target="_blank">00:54:12.000</a></span> | <span class="t">rest of the data is fed into the main loop.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3258" target="_blank">00:54:18.000</a></span> | <span class="t">So, yes, here we build our final TNO graph. We have symbolic</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3264" target="_blank">00:54:24.000</a></span> | <span class="t">inputs for, well, the input and the mask. We create a layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3273" target="_blank">00:54:33.000</a></span> | <span class="t">the layer, define our cost, parameters, all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3278" target="_blank">00:54:38.000</a></span> | <span class="t">parameters, and the recurrent layer. Take the gradients, of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3283" target="_blank">00:54:43.000</a></span> | <span class="t">course, with respect to all parameters. So, as I mentioned,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3287" target="_blank">00:54:47.000</a></span> | <span class="t">it's going to use backprop through time to get the gradient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3291" target="_blank">00:54:51.000</a></span> | <span class="t">through the scan operation. The update rule, again, simple,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3301" target="_blank">00:55:01.000</a></span> | <span class="t">SGD, no momentum, nothing. It's something you can add if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3305" target="_blank">00:55:05.000</a></span> | <span class="t">want to. And then, we have a function to evaluate the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3312" target="_blank">00:55:12.000</a></span> | <span class="t">So, here, the main loop is training, and we also have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3319" target="_blank">00:55:19.000</a></span> | <span class="t">another function that generates one character at a time, given</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3323" target="_blank">00:55:23.000</a></span> | <span class="t">the previous ones. That's why we declare inputs here. And so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3329" target="_blank">00:55:29.000</a></span> | <span class="t">we have a function that gets predictions, we normalize them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3336" target="_blank">00:55:36.000</a></span> | <span class="t">because we are working in float 32, and sometimes, if you divide</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3340" target="_blank">00:55:40.000</a></span> | <span class="t">by the sum, and the sum, it doesn't add up to one. So we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3345" target="_blank">00:55:45.000</a></span> | <span class="t">want the higher precision for just that operation. And then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3351" target="_blank">00:55:51.000</a></span> | <span class="t">try to generate a sequence every once in a while.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3358" target="_blank">00:55:58.000</a></span> | <span class="t">So, we have a function that generates a sequence every once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3361" target="_blank">00:56:01.000</a></span> | <span class="t">in a while. So, we have a function that generates a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3364" target="_blank">00:56:04.000</a></span> | <span class="t">sequence in the previous run. So, we see the -- so, for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3370" target="_blank">00:56:10.000</a></span> | <span class="t">monitoring, we see that prediction with the meaning of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3375" target="_blank">00:56:15.000</a></span> | <span class="t">life is, and then we let the network generate. So, if I try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3379" target="_blank">00:56:19.000</a></span> | <span class="t">to run it now, it's going to be long, but here's some examples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3384" target="_blank">00:56:24.000</a></span> | <span class="t">of how it works. So, the first one is a model that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3389" target="_blank">00:56:29.000</a></span> | <span class="t">developed with not that much, and it has, like, a couple of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3394" target="_blank">00:56:34.000</a></span> | <span class="t">unusual characters. I mean, it's usually -- it's not usual to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3399" target="_blank">00:56:39.000</a></span> | <span class="t">have, like, one Chinese character in the middle of words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3404" target="_blank">00:56:44.000</a></span> | <span class="t">You have, like, punctuation in the middle of words, and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3410" target="_blank">00:56:50.000</a></span> | <span class="t">And so, we have a function that generates a sequence every once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3415" target="_blank">00:56:55.000</a></span> | <span class="t">in a while. And we see that it's getting slowly better and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3422" target="_blank">00:57:02.000</a></span> | <span class="t">better. And the meaning of life is the that, and so on.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3429" target="_blank">00:57:09.000</a></span> | <span class="t">So, of course, this is not what's going to give you the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3435" target="_blank">00:57:15.000</a></span> | <span class="t">meaning of life. And this is this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3442" target="_blank">00:57:22.000</a></span> | <span class="t">So, yeah, so I interrupted the training at some point, but you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3449" target="_blank">00:57:29.000</a></span> | <span class="t">can play with it a little bit, and here are some suggestions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3454" target="_blank">00:57:34.000</a></span> | <span class="t">of things you might want to do, like better training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3460" target="_blank">00:57:40.000</a></span> | <span class="t">strategies, different linearities inside the LSTM cell,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3466" target="_blank">00:57:46.000</a></span> | <span class="t">different initialization of weights, try to generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3470" target="_blank">00:57:50.000</a></span> | <span class="t">something else that the meaning of life is, and, yeah.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3476" target="_blank">00:57:56.000</a></span> | <span class="t">So, I hope I could give you a good introduction of what TNO</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3482" target="_blank">00:58:02.000</a></span> | <span class="t">is, what it can be used for, and what you can build on top of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3487" target="_blank">00:58:07.000</a></span> | <span class="t">it. So, if you have any questions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3494" target="_blank">00:58:14.000</a></span> | <span class="t">later, then we have TNO users mailing lists. We are answering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3500" target="_blank">00:58:20.000</a></span> | <span class="t">questions on Stack Overflow as well. And we would be happy to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3506" target="_blank">00:58:26.000</a></span> | <span class="t">have your feedback. [ Applause ]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3513" target="_blank">00:58:33.000</a></span> | <span class="t">>> We have time for a few quick questions. There's one here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3519" target="_blank">00:58:39.000</a></span> | <span class="t">Could you go to the mic? >> Can you just give a quick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3527" target="_blank">00:58:47.000</a></span> | <span class="t">example of what debugging might look like in TNO? Could you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3531" target="_blank">00:58:51.000</a></span> | <span class="t">break something in there and show us what happens and how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3535" target="_blank">00:58:55.000</a></span> | <span class="t">you figure out what it was? >> Sure. Actually, yeah, I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3539" target="_blank">00:58:59.000</a></span> | <span class="t">can show you a few examples. Okay. So, let's go to, say, a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3546" target="_blank">00:59:06.000</a></span> | <span class="t">simple example. Okay. So, I'm just going to go to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3553" target="_blank">00:59:13.000</a></span> | <span class="t">logistic regression one, and say, for instance, that when I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3563" target="_blank">00:59:23.000</a></span> | <span class="t">execute this, I don't have the right shape. So, you can still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3575" target="_blank">00:59:35.000</a></span> | <span class="t">build the whole symbolic graph, and at the time where you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3584" target="_blank">00:59:44.000</a></span> | <span class="t">to actually execute it, then you have an error message that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3590" target="_blank">00:59:50.000</a></span> | <span class="t">says, "Why does this not have the right shape?" So, let's say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3596" target="_blank">00:59:56.000</a></span> | <span class="t">that X has columns and rows, but Y has only that number of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3602" target="_blank">01:00:02.000</a></span> | <span class="t">rows. And the apply node that caused the error is that dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3608" target="_blank">01:00:08.000</a></span> | <span class="t">product, and gives the input again, and in that case, it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3612" target="_blank">01:00:12.000</a></span> | <span class="t">tells you -- it's not really able to tell you where it was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3617" target="_blank">01:00:17.000</a></span> | <span class="t">defined. So, we can do that, and we can go back to where the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3626" target="_blank">01:00:26.000</a></span> | <span class="t">train operation was defined, train model, TNO function, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3633" target="_blank">01:00:33.000</a></span> | <span class="t">we can say, "Mode optimizer equals none." Sorry. I have to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3649" target="_blank">01:00:49.000</a></span> | <span class="t">do -- mode equals TNO.mode, optimizer, none. Is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3657" target="_blank">01:00:57.000</a></span> | <span class="t">right? So, let's do that. Let's reconfigure everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3671" target="_blank">01:01:11.000</a></span> | <span class="t">And then, the updated error message says, "Backtrace when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3677" target="_blank">01:01:17.000</a></span> | <span class="t">the node was created," and it's somewhere in my kernel, and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3683" target="_blank">01:01:23.000</a></span> | <span class="t">it's not there. So, we can go back to that. So, of course, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3689" target="_blank">01:01:29.000</a></span> | <span class="t">have a lot of things in there, but you know that there's a dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3693" target="_blank">01:01:33.000</a></span> | <span class="t">product, and it's probably a mismatch between those. So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3697" target="_blank">01:01:37.000</a></span> | <span class="t">that's one example. Then, the other techniques that we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3701" target="_blank">01:01:41.000</a></span> | <span class="t">use, we can have the break points, as I said, and so on. I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3705" target="_blank">01:01:45.000</a></span> | <span class="t">don't have right now a tutorial about that, but I have some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3709" target="_blank">01:01:49.000</a></span> | <span class="t">examples. So, I'm going to go back to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3715" target="_blank">01:01:55.000</a></span> | <span class="t">>> One last question. >> I have some models I would like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3718" target="_blank">01:01:58.000</a></span> | <span class="t">to distribute, and I don't want to require people to install</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3722" target="_blank">01:02:02.000</a></span> | <span class="t">Python and a bunch of compilers and stuff. Do you have any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3728" target="_blank">01:02:08.000</a></span> | <span class="t">support for compiling models into a binary?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3731" target="_blank">01:02:11.000</a></span> | <span class="t">>> Okay. So, unfortunately, at the time, we're pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3735" target="_blank">01:02:15.000</a></span> | <span class="t">limited in the number of models that we can do. So, most of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3739" target="_blank">01:02:19.000</a></span> | <span class="t">the work is done by Python, and we use an empire and DRAs for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3744" target="_blank">01:02:24.000</a></span> | <span class="t">our intermediate values on the CPU and the similar structure on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3748" target="_blank">01:02:28.000</a></span> | <span class="t">the GPU, even though that one might be easier to convert. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3752" target="_blank">01:02:32.000</a></span> | <span class="t">yes, all our C code deals with Python and does the ink ref and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3756" target="_blank">01:02:36.000</a></span> | <span class="t">the graph and so on, so that Python manages the memory. So,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3760" target="_blank">01:02:40.000</a></span> | <span class="t">we're not able to do that. We have a lot of work to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3765" target="_blank">01:02:45.000</a></span> | <span class="t">>> So, how about something like a Docker container?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3769" target="_blank">01:02:49.000</a></span> | <span class="t">>> Something like that. Recently, even for GPU, NVIDIA</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3773" target="_blank">01:02:53.000</a></span> | <span class="t">Docker is quite efficient, and we don't have any model slowdowns</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3777" target="_blank">01:02:57.000</a></span> | <span class="t">that we had seen earlier. So, it's not ideal, and if, like,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3783" target="_blank">01:03:03.000</a></span> | <span class="t">someone has some time and the will to help us disentangle</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3789" target="_blank">01:03:09.000</a></span> | <span class="t">that, we can do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3793" target="_blank">01:03:13.000</a></span> | <span class="t">>> Okay. Let's thank Pascal again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3799" target="_blank">01:03:19.000</a></span> | <span class="t">[Applause]</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3800" target="_blank">01:03:20.000</a></span> | <span class="t">>> We convene in 55 minutes for the next talk. Have a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3803" target="_blank">01:03:23.000</a></span> | <span class="t">lunch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=OU8I1oJ9HhI&t=3804" target="_blank">01:03:24.000</a></span> | <span class="t">Lynch.</span></div></div></body></html>