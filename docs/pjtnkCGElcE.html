<html><head><title>Multi-Class Language Classification With BERT in TensorFlow</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Multi-Class Language Classification With BERT in TensorFlow</h2><a href="https://www.youtube.com/watch?v=pjtnkCGElcE"><img src="https://i.ytimg.com/vi_webp/pjtnkCGElcE/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=81">1:21</a> Pulling Data<br><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=107">1:47</a> Preprocessing<br><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=873">14:33</a> Data Input Pipeline<br><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1454">24:14</a> Defining Model<br><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2009">33:29</a> Model Training<br><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2136">35:36</a> Saving and Loading Models<br><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2257">37:37</a> Making Predictions<br><br><div style="text-align: left;"><a href="./pjtnkCGElcE.html">Whisper Transcript</a> | <a href="./transcript_pjtnkCGElcE.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">I welcome to this video on mid-class classification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=3" target="_blank">00:00:03.080</a></span> | <span class="t">using Transformers and TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=6" target="_blank">00:00:06.200</a></span> | <span class="t">So I've done a video very similar to this before,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=9" target="_blank">00:00:09.720</a></span> | <span class="t">but I missed a few of the final steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=12" target="_blank">00:00:12.560</a></span> | <span class="t">at the end, which were saving and loading models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=15" target="_blank">00:00:15.920</a></span> | <span class="t">and actually making predictions with those models.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=18" target="_blank">00:00:18.560</a></span> | <span class="t">So I've made this video to cover those points, as a lot of you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=23" target="_blank">00:00:23.880</a></span> | <span class="t">were asking for how to actually do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=28" target="_blank">00:00:28.080</a></span> | <span class="t">So we're going to cover those, and we're also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=31" target="_blank">00:00:31.640</a></span> | <span class="t">going to cover all the other steps that lead up to that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=34" target="_blank">00:00:34.080</a></span> | <span class="t">So if this is the first video on this that you've seen,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=38" target="_blank">00:00:38.000</a></span> | <span class="t">then I'm going to take you through everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=39" target="_blank">00:00:39.920</a></span> | <span class="t">So I'm going to take you through sourcing data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=42" target="_blank">00:00:42.040</a></span> | <span class="t">from Kaggle that we'll be using, pre-processing that data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=45" target="_blank">00:00:45.160</a></span> | <span class="t">So that's tokenization and encoding the label data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=50" target="_blank">00:00:50.980</a></span> | <span class="t">Then we're also going to be looking at setting up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=53" target="_blank">00:00:53.020</a></span> | <span class="t">a TensorFlow input pipeline, building and training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=57" target="_blank">00:00:57.340</a></span> | <span class="t">the model, and then we go on to the few extra things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=62" target="_blank">00:01:02.260</a></span> | <span class="t">I missed before-- so the saving and loading the model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=64" target="_blank">00:01:04.940</a></span> | <span class="t">and also making those predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=68" target="_blank">00:01:08.540</a></span> | <span class="t">So that's everything that we'll be covering.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=71" target="_blank">00:01:11.260</a></span> | <span class="t">And what I've done is left chapters in the timeline,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=75" target="_blank">00:01:15.340</a></span> | <span class="t">so you can skip ahead to whatever you need to see.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=78" target="_blank">00:01:18.740</a></span> | <span class="t">So we'll jump straight into the code.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=81" target="_blank">00:01:21.660</a></span> | <span class="t">So here we're just going to download the data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=84" target="_blank">00:01:24.340</a></span> | <span class="t">We're going to be using the sentiment analysis on the movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=87" target="_blank">00:01:27.140</a></span> | <span class="t">reviews data set, which you can see over here on Kaggle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=90" target="_blank">00:01:30.260</a></span> | <span class="t">You can download it from here if you just click on train.tsv.zip,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=94" target="_blank">00:01:34.140</a></span> | <span class="t">download it, and unzip it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=95" target="_blank">00:01:35.460</a></span> | <span class="t">I'm just going to do it through the Kaggle API</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=97" target="_blank">00:01:37.820</a></span> | <span class="t">here, and then unzip it with zip file here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=101" target="_blank">00:01:41.100</a></span> | <span class="t">It's just a little bit easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=102" target="_blank">00:01:42.420</a></span> | <span class="t">So I'll run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=105" target="_blank">00:01:45.420</a></span> | <span class="t">And I do have a video on the Kaggle API,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=107" target="_blank">00:01:47.980</a></span> | <span class="t">so I'll put a link to that in the description.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=110" target="_blank">00:01:50.780</a></span> | <span class="t">So we've got our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=112" target="_blank">00:01:52.700</a></span> | <span class="t">You can see it in the left here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=114" target="_blank">00:01:54.980</a></span> | <span class="t">And I'm just going to import pandas and view what we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=117" target="_blank">00:01:57.980</a></span> | <span class="t">And just read from CSV.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=123" target="_blank">00:02:03.140</a></span> | <span class="t">And we're using a tab-limited file here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=137" target="_blank">00:02:17.980</a></span> | <span class="t">so we need to use the tab separator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=142" target="_blank">00:02:22.260</a></span> | <span class="t">And let's just see what we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=146" target="_blank">00:02:26.180</a></span> | <span class="t">OK, we have the sentiment here, and we have the phrase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=148" target="_blank">00:02:28.780</a></span> | <span class="t">And that's all we really need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=151" target="_blank">00:02:31.180</a></span> | <span class="t">So on the phrase here, we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=153" target="_blank">00:02:33.860</a></span> | <span class="t">to be tokenizing this text to create two input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=157" target="_blank">00:02:37.100</a></span> | <span class="t">tensors, our input IDs and the attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=161" target="_blank">00:02:41.940</a></span> | <span class="t">Now, at the moment, we're going to contain these two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=165" target="_blank">00:02:45.140</a></span> | <span class="t">tensors within two NumPy arrays, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=167" target="_blank">00:02:47.660</a></span> | <span class="t">will be of dimensions the length of the data frame by 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=172" target="_blank">00:02:52.780</a></span> | <span class="t">512 is the sequence length of our tokenized sequences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=177" target="_blank">00:02:57.660</a></span> | <span class="t">when we're putting them into BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=179" target="_blank">00:02:59.580</a></span> | <span class="t">So when tokenizing, all we're going to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=181" target="_blank">00:03:01.980</a></span> | <span class="t">is iterate through each sample one by one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=184" target="_blank">00:03:04.940</a></span> | <span class="t">and assign each sample or each tokenized sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=189" target="_blank">00:03:09.460</a></span> | <span class="t">to its own row in the respective NumPy array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=193" target="_blank">00:03:13.620</a></span> | <span class="t">And we'll just first initialize those as empty zero rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=198" target="_blank">00:03:18.180</a></span> | <span class="t">So we'll do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=200" target="_blank">00:03:20.180</a></span> | <span class="t">So first, we need to import NumPy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=201" target="_blank">00:03:21.740</a></span> | <span class="t">And then, like I said before, the sequence length is 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=211" target="_blank">00:03:31.620</a></span> | <span class="t">And then our number of samples is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=215" target="_blank">00:03:35.020</a></span> | <span class="t">equal to the length of our data frame.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=218" target="_blank">00:03:38.140</a></span> | <span class="t">And with that, we can initialize those empty zero rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=223" target="_blank">00:03:43.420</a></span> | <span class="t">So one will be xids, which will be our token IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=228" target="_blank">00:03:48.820</a></span> | <span class="t">And that is initialized with empty zeroes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=234" target="_blank">00:03:54.060</a></span> | <span class="t">And then we pass the size of that array here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=238" target="_blank">00:03:58.980</a></span> | <span class="t">So number of samples or the length of the data frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=242" target="_blank">00:04:02.340</a></span> | <span class="t">by the sequence length, which is 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=245" target="_blank">00:04:05.340</a></span> | <span class="t">And then we can copy that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=247" target="_blank">00:04:07.500</a></span> | <span class="t">And we do the same thing for xmask,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=252" target="_blank">00:04:12.420</a></span> | <span class="t">which is our attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=253" target="_blank">00:04:13.940</a></span> | <span class="t">And then let's just confirm we have the right shape as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=261" target="_blank">00:04:21.140</a></span> | <span class="t">We'll do that like this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=263" target="_blank">00:04:23.660</a></span> | <span class="t">So we have 156,000 samples and 512 tokens within each sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=271" target="_blank">00:04:31.420</a></span> | <span class="t">So now that we have initialized those two arrays,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=274" target="_blank">00:04:34.140</a></span> | <span class="t">we can begin populating them with the actual tokenized text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=278" target="_blank">00:04:38.980</a></span> | <span class="t">So we're going to be using transformers for that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=283" target="_blank">00:04:43.660</a></span> | <span class="t">And we are using BERT, so we'll import BERT tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=287" target="_blank">00:04:47.020</a></span> | <span class="t">And then we just want to initialize the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=295" target="_blank">00:04:55.060</a></span> | <span class="t">And what we'll do here is just load it from pre-trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=302" target="_blank">00:05:02.940</a></span> | <span class="t">And so I'm using BERT base case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=305" target="_blank">00:05:05.460</a></span> | <span class="t">And then what we can do here is we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=309" target="_blank">00:05:09.940</a></span> | <span class="t">just loop through every phrase within the phrase column.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=315" target="_blank">00:05:15.140</a></span> | <span class="t">And we'll just enumerate that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=319" target="_blank">00:05:19.700</a></span> | <span class="t">So we've got the row number in i and the actual phrase</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=324" target="_blank">00:05:24.580</a></span> | <span class="t">in the phrase variable.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=327" target="_blank">00:05:27.380</a></span> | <span class="t">So here, phrase.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=333" target="_blank">00:05:33.140</a></span> | <span class="t">And then we want to pull out our tokens using the tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=337" target="_blank">00:05:37.980</a></span> | <span class="t">So we do ENCODE plus.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=339" target="_blank">00:05:39.140</a></span> | <span class="t">And then we have our phrase, the max length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=347" target="_blank">00:05:47.220</a></span> | <span class="t">which is sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=348" target="_blank">00:05:48.980</a></span> | <span class="t">So that's 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=352" target="_blank">00:05:52.060</a></span> | <span class="t">We're going to set truncation to true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=355" target="_blank">00:05:55.260</a></span> | <span class="t">So here, if we have any text which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=357" target="_blank">00:05:57.820</a></span> | <span class="t">is longer than 512 tokens, it will just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=361" target="_blank">00:06:01.260</a></span> | <span class="t">truncate and cut it off at that point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=363" target="_blank">00:06:03.500</a></span> | <span class="t">because we can't feed in arrays of--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=366" target="_blank">00:06:06.300</a></span> | <span class="t">or tensors of different shapes into our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=368" target="_blank">00:06:08.700</a></span> | <span class="t">It needs to be consistent.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=370" target="_blank">00:06:10.900</a></span> | <span class="t">Likewise, if we have something that is too short,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=375" target="_blank">00:06:15.620</a></span> | <span class="t">we want to pad it up to 512 tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=378" target="_blank">00:06:18.580</a></span> | <span class="t">And for that, we need to use padding equal to max length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=383" target="_blank">00:06:23.220</a></span> | <span class="t">which will just pad up to whatever number we pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=385" target="_blank">00:06:25.980</a></span> | <span class="t">into this max length variable here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=389" target="_blank">00:06:29.220</a></span> | <span class="t">And then I want to add special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=392" target="_blank">00:06:32.300</a></span> | <span class="t">So in BERT, we have a few tokens like this, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=400" target="_blank">00:06:40.620</a></span> | <span class="t">means the start of a sequence, this, which means separator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=406" target="_blank">00:06:46.420</a></span> | <span class="t">And that is either separating different sequences</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=409" target="_blank">00:06:49.820</a></span> | <span class="t">or marking the end of a sequence,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=413" target="_blank">00:06:53.780</a></span> | <span class="t">and also this, which is the padding token, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=418" target="_blank">00:06:58.900</a></span> | <span class="t">we'll be using because we set padding equal to max length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=422" target="_blank">00:07:02.620</a></span> | <span class="t">So if we have an input, which is maybe 412 tokens in length,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=429" target="_blank">00:07:09.420</a></span> | <span class="t">or let's say 410, both of these will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=432" target="_blank">00:07:12.580</a></span> | <span class="t">be added to it, which will push it up to 412.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=435" target="_blank">00:07:15.980</a></span> | <span class="t">And then we'll add 100 padding tokens</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=439" target="_blank">00:07:19.100</a></span> | <span class="t">onto the end, which pushes it up to 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=444" target="_blank">00:07:24.100</a></span> | <span class="t">So that's how that works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=445" target="_blank">00:07:25.100</a></span> | <span class="t">So obviously, we do want to add those special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=448" target="_blank">00:07:28.180</a></span> | <span class="t">Otherwise, BERT will not understand what it is reading.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=452" target="_blank">00:07:32.500</a></span> | <span class="t">And then because we're using TensorFlow here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=455" target="_blank">00:07:35.500</a></span> | <span class="t">we're going to return tensors equals tf for TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=460" target="_blank">00:07:40.860</a></span> | <span class="t">And then what we want to do here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=462" target="_blank">00:07:42.460</a></span> | <span class="t">so we've pulled out our tokens into this dictionary here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=466" target="_blank">00:07:46.300</a></span> | <span class="t">So this will give us a dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=468" target="_blank">00:07:48.100</a></span> | <span class="t">It will have different tensors in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=471" target="_blank">00:07:51.060</a></span> | <span class="t">So it will have our input IDs and attention mass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=474" target="_blank">00:07:54.140</a></span> | <span class="t">And we want to add both of those to a row</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=478" target="_blank">00:07:58.580</a></span> | <span class="t">within each one of these zero rows.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=482" target="_blank">00:08:02.740</a></span> | <span class="t">So to do that, we want to say xids.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=485" target="_blank">00:08:05.820</a></span> | <span class="t">And then this is why we have enumerated through here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=488" target="_blank">00:08:08.460</a></span> | <span class="t">So we have this i.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=490" target="_blank">00:08:10.380</a></span> | <span class="t">So this tells us which row to put it in.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=493" target="_blank">00:08:13.860</a></span> | <span class="t">And then we want to select the whole row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=496" target="_blank">00:08:16.860</a></span> | <span class="t">And we set that equal to tokens because input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=500" target="_blank">00:08:20.840</a></span> | <span class="t">Now, as well, we do the same for the xmask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=509" target="_blank">00:08:29.180</a></span> | <span class="t">But this time, rather than input IDs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=511" target="_blank">00:08:31.500</a></span> | <span class="t">we are going to set it equal to attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=514" target="_blank">00:08:34.060</a></span> | <span class="t">So let's just have a quick look at what we have in xids now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=525" target="_blank">00:08:45.820</a></span> | <span class="t">OK, it's just 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=527" target="_blank">00:08:47.020</a></span> | <span class="t">So now let's run this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=530" target="_blank">00:08:50.460</a></span> | <span class="t">And now if we rerun this, we can see, OK, now we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=534" target="_blank">00:08:54.100</a></span> | <span class="t">have all these other values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=536" target="_blank">00:08:56.300</a></span> | <span class="t">So first, this 101 is the CLS token that I mentioned before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=542" target="_blank">00:09:02.780</a></span> | <span class="t">So the start sequence token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=544" target="_blank">00:09:04.500</a></span> | <span class="t">And these zeros here, they are all padding tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=548" target="_blank">00:09:08.340</a></span> | <span class="t">So obviously, at the end here, we almost always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=550" target="_blank">00:09:10.620</a></span> | <span class="t">have paddings unless the text is long enough</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=553" target="_blank">00:09:13.980</a></span> | <span class="t">to come up to this point or if it has been truncated.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=558" target="_blank">00:09:18.140</a></span> | <span class="t">But here, we can see the sort of structure that we would expect.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=562" target="_blank">00:09:22.420</a></span> | <span class="t">And we see some duplication here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=563" target="_blank">00:09:23.940</a></span> | <span class="t">So we have 101.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=564" target="_blank">00:09:24.700</a></span> | <span class="t">Then we have this 138, 1326.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=567" target="_blank">00:09:27.660</a></span> | <span class="t">And if we look at our data here, we can say, OK, that's why.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=570" target="_blank">00:09:30.420</a></span> | <span class="t">Because the first few examples, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=572" target="_blank">00:09:32.500</a></span> | <span class="t">have segments of the full sequence here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=577" target="_blank">00:09:37.300</a></span> | <span class="t">So there is some duplication there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=580" target="_blank">00:09:40.260</a></span> | <span class="t">So that all looks pretty good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=582" target="_blank">00:09:42.900</a></span> | <span class="t">And I think let's just have a quick look at the XMASK.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=586" target="_blank">00:09:46.780</a></span> | <span class="t">So here, you can see something different.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=588" target="_blank">00:09:48.500</a></span> | <span class="t">We have these ones and zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=590" target="_blank">00:09:50.340</a></span> | <span class="t">So XMASK is essentially like a control for the attention layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=595" target="_blank">00:09:55.740</a></span> | <span class="t">within BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=597" target="_blank">00:09:57.300</a></span> | <span class="t">Wherever there's a one, BERT will calculate the attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=603" target="_blank">00:10:03.060</a></span> | <span class="t">for that token.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=604" target="_blank">00:10:04.140</a></span> | <span class="t">Wherever there's a zero, it will not.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=606" target="_blank">00:10:06.460</a></span> | <span class="t">So this is to avoid BERT making any kind of connection</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=610" target="_blank">00:10:10.580</a></span> | <span class="t">with the padding tokens and actual words.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=612" target="_blank">00:10:12.860</a></span> | <span class="t">Because these padding tokens are, in reality, not there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=616" target="_blank">00:10:16.020</a></span> | <span class="t">We want BERT to just completely ignore them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=618" target="_blank">00:10:18.580</a></span> | <span class="t">And we do that by passing every padding token</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=622" target="_blank">00:10:22.300</a></span> | <span class="t">as a zero within the attention masquerade or tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=626" target="_blank">00:10:26.340</a></span> | <span class="t">Now, as well as that, we also want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=628" target="_blank">00:10:28.660</a></span> | <span class="t">to want to encode our label data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=632" target="_blank">00:10:32.220</a></span> | <span class="t">So at the moment, we can see here we have the sentiment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=635" target="_blank">00:10:35.460</a></span> | <span class="t">And this is a set of values from 0 to 4,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=641" target="_blank">00:10:41.860</a></span> | <span class="t">which represent each of the sentiment classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=644" target="_blank">00:10:44.380</a></span> | <span class="t">So here, we have sentiment labels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=646" target="_blank">00:10:46.980</a></span> | <span class="t">of 0, which is very negative, 1, somewhat negative, 2, neutral,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=651" target="_blank">00:10:51.460</a></span> | <span class="t">3, somewhat positive, and 4, positive.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=654" target="_blank">00:10:54.900</a></span> | <span class="t">So we're going to be keeping all those in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=656" target="_blank">00:10:56.900</a></span> | <span class="t">But we're going to be one-hot encoding them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=659" target="_blank">00:10:59.620</a></span> | <span class="t">So to do that, we will first extract that data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=665" target="_blank">00:11:05.060</a></span> | <span class="t">So we'll go put into an array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=669" target="_blank">00:11:09.100</a></span> | <span class="t">We want to put df sentiment, which is the column name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=673" target="_blank">00:11:13.420</a></span> | <span class="t">And we want to take the values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=675" target="_blank">00:11:15.180</a></span> | <span class="t">And if I just show you what that gives us,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=676" target="_blank">00:11:16.980</a></span> | <span class="t">it just gives us an array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=678" target="_blank">00:11:18.420</a></span> | <span class="t">And we have up to 4, so 0, 1, 2, 3, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=681" target="_blank">00:11:21.980</a></span> | <span class="t">And that's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=685" target="_blank">00:11:25.980</a></span> | <span class="t">And now what we need to do is initialize, again, a 0 array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=691" target="_blank">00:11:31.700</a></span> | <span class="t">So we'll do np0s.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=695" target="_blank">00:11:35.420</a></span> | <span class="t">And in here, we're going to do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=697" target="_blank">00:11:37.300</a></span> | <span class="t">the length of the number of samples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=699" target="_blank">00:11:39.020</a></span> | <span class="t">because, again, we have the same number of samples</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=701" target="_blank">00:11:41.340</a></span> | <span class="t">in our labels here, so the length of the data frame.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=706" target="_blank">00:11:46.220</a></span> | <span class="t">And I want to say the array max value plus 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=711" target="_blank">00:11:51.500</a></span> | <span class="t">Now, this works because in our array, we have 0, 1, 2, 3, 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=720" target="_blank">00:12:00.380</a></span> | <span class="t">So the max value of that is 4.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=724" target="_blank">00:12:04.860</a></span> | <span class="t">And we have five numbers here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=726" target="_blank">00:12:06.820</a></span> | <span class="t">So if we take the 4 plus 1, we get 5,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=730" target="_blank">00:12:10.420</a></span> | <span class="t">which is the total number of values that we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=733" target="_blank">00:12:13.380</a></span> | <span class="t">And this essentially gives us the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=735" target="_blank">00:12:15.020</a></span> | <span class="t">of columns in this array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=738" target="_blank">00:12:18.900</a></span> | <span class="t">And we need one column for each different class.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=742" target="_blank">00:12:22.460</a></span> | <span class="t">So that gives us what we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=745" target="_blank">00:12:25.100</a></span> | <span class="t">And we can just check that as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=746" target="_blank">00:12:26.780</a></span> | <span class="t">So we have labels.shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=748" target="_blank">00:12:28.700</a></span> | <span class="t">And here, we see we have the length of the data frame</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=751" target="_blank">00:12:31.140</a></span> | <span class="t">or number of samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=752" target="_blank">00:12:32.940</a></span> | <span class="t">And we have our five classes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=755" target="_blank">00:12:35.500</a></span> | <span class="t">Now, let's have a quick look at what we're doing here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=760" target="_blank">00:12:40.020</a></span> | <span class="t">So we'll print out labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=761" target="_blank">00:12:41.580</a></span> | <span class="t">OK, we just have zeros.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=766" target="_blank">00:12:46.620</a></span> | <span class="t">Now, what we're going to do is we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=770" target="_blank">00:12:50.060</a></span> | <span class="t">going to do some fancy indexing to select each value that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=774" target="_blank">00:12:54.860</a></span> | <span class="t">needs to be selected based on the index here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=778" target="_blank">00:12:58.740</a></span> | <span class="t">and set that equal to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=782" target="_blank">00:13:02.420</a></span> | <span class="t">So for these first three examples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=784" target="_blank">00:13:04.580</a></span> | <span class="t">we will be selecting this, making it equal to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=788" target="_blank">00:13:08.020</a></span> | <span class="t">And then this, because this is in the second.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=790" target="_blank">00:13:10.580</a></span> | <span class="t">So we've got 0, 1, 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=793" target="_blank">00:13:13.900</a></span> | <span class="t">These are the column indices.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=796" target="_blank">00:13:16.620</a></span> | <span class="t">So first one, that will be set to 1 because we have 1 here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=801" target="_blank">00:13:21.220</a></span> | <span class="t">This is number 2, so we select number 2 and 2 here as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=805" target="_blank">00:13:25.540</a></span> | <span class="t">And then for 3 down here, we'd have a 1 here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=810" target="_blank">00:13:30.300</a></span> | <span class="t">So to do that, we need to specify both the row.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=815" target="_blank">00:13:35.660</a></span> | <span class="t">So we're just going to be getting one row at a time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=818" target="_blank">00:13:38.340</a></span> | <span class="t">So all we need here is a range of numbers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=820" target="_blank">00:13:40.580</a></span> | <span class="t">which covers from 0 all the way down to 156,060,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=827" target="_blank">00:13:47.420</a></span> | <span class="t">which is our length here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=831" target="_blank">00:13:51.020</a></span> | <span class="t">So to do that, we just go np arrange.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=834" target="_blank">00:13:54.420</a></span> | <span class="t">We have a number of samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=837" target="_blank">00:13:57.900</a></span> | <span class="t">And then here, we need to select which column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=841" target="_blank">00:14:01.660</a></span> | <span class="t">we want to set each value to or select each value for.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=846" target="_blank">00:14:06.140</a></span> | <span class="t">And that's easy because we already have it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=848" target="_blank">00:14:08.340</a></span> | <span class="t">This is our array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=851" target="_blank">00:14:11.460</a></span> | <span class="t">So we just write array.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=853" target="_blank">00:14:13.900</a></span> | <span class="t">And then each one of those that we select,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=856" target="_blank">00:14:16.180</a></span> | <span class="t">we want to set equal to 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=858" target="_blank">00:14:18.300</a></span> | <span class="t">So let me just put it there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=861" target="_blank">00:14:21.780</a></span> | <span class="t">I want to put it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=863" target="_blank">00:14:23.700</a></span> | <span class="t">OK, and now let's rerun this cell as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=867" target="_blank">00:14:27.420</a></span> | <span class="t">OK, and now we can see we have those ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=869" target="_blank">00:14:29.580</a></span> | <span class="t">in the correct places.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=871" target="_blank">00:14:31.380</a></span> | <span class="t">So that's our one-hot encoding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=874" target="_blank">00:14:34.020</a></span> | <span class="t">And now what we want to do is sell our data here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=878" target="_blank">00:14:38.820</a></span> | <span class="t">and put into a format that TensorFlow will be able to read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=882" target="_blank">00:14:42.380</a></span> | <span class="t">So to do that, we want to import TensorFlow first.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=887" target="_blank">00:14:47.140</a></span> | <span class="t">And what we're going to do is use the TensorFlow data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=891" target="_blank">00:14:51.220</a></span> | <span class="t">object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=892" target="_blank">00:14:52.540</a></span> | <span class="t">So this is just a object provided</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=895" target="_blank">00:14:55.580</a></span> | <span class="t">by TensorFlow, which just allows us to transform our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=900" target="_blank">00:15:00.620</a></span> | <span class="t">and shuffle and batch it very easily.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=904" target="_blank">00:15:04.060</a></span> | <span class="t">So it just makes our life a lot easier.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=908" target="_blank">00:15:08.300</a></span> | <span class="t">So it's a data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=909" target="_blank">00:15:09.700</a></span> | <span class="t">And we're creating this data set from tensor slices,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=914" target="_blank">00:15:14.700</a></span> | <span class="t">which means arrays.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=917" target="_blank">00:15:17.820</a></span> | <span class="t">And in here, we're going to pass a tuple of XIDs, XMASK,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=923" target="_blank">00:15:23.380</a></span> | <span class="t">and labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=925" target="_blank">00:15:25.460</a></span> | <span class="t">And to actually view what we have inside that data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=928" target="_blank">00:15:28.020</a></span> | <span class="t">we have to use specific data set methods</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=932" target="_blank">00:15:32.140</a></span> | <span class="t">because we can't just print it out and view everything.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=934" target="_blank">00:15:34.660</a></span> | <span class="t">It's a generator.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=936" target="_blank">00:15:36.340</a></span> | <span class="t">So what we can do is just take one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=938" target="_blank">00:15:38.660</a></span> | <span class="t">And that will show us the very top sample</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=941" target="_blank">00:15:41.180</a></span> | <span class="t">or after we batch it, the very top batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=943" target="_blank">00:15:43.820</a></span> | <span class="t">And I'll just print that out.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=945" target="_blank">00:15:45.620</a></span> | <span class="t">We see here, OK, we have this take data set shapes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=950" target="_blank">00:15:50.460</a></span> | <span class="t">And we have this tuple here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=953" target="_blank">00:15:53.620</a></span> | <span class="t">So this is one sample.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=956" target="_blank">00:15:56.380</a></span> | <span class="t">And inside here, we have a tensor,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=958" target="_blank">00:15:58.980</a></span> | <span class="t">which is of shape 512.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=961" target="_blank">00:16:01.740</a></span> | <span class="t">So this is our very first XIDs array--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=965" target="_blank">00:16:05.260</a></span> | <span class="t">or row, sorry.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=967" target="_blank">00:16:07.420</a></span> | <span class="t">So this is like doing this and getting this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=972" target="_blank">00:16:12.620</a></span> | <span class="t">So this is what this value is here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=975" target="_blank">00:16:15.500</a></span> | <span class="t">This is the size or the shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=979" target="_blank">00:16:19.420</a></span> | <span class="t">OK, and then we have the same for the XMASK, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=984" target="_blank">00:16:24.940</a></span> | <span class="t">is the second item here in index 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=988" target="_blank">00:16:28.820</a></span> | <span class="t">And we also have four labels as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=993" target="_blank">00:16:33.780</a></span> | <span class="t">You can see here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=996" target="_blank">00:16:36.420</a></span> | <span class="t">OK, and that's all good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=999" target="_blank">00:16:39.220</a></span> | <span class="t">But what we need now is to merge both of our input tensors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1004" target="_blank">00:16:44.340</a></span> | <span class="t">into a single dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1007" target="_blank">00:16:47.420</a></span> | <span class="t">So the reason that we do that is that when TensorFlow reads data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1012" target="_blank">00:16:52.060</a></span> | <span class="t">during training, it's going to read--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1014" target="_blank">00:16:54.140</a></span> | <span class="t">or it's going to expect a tuple where it has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1016" target="_blank">00:16:56.140</a></span> | <span class="t">the input in index 0 and the output or target labels</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1021" target="_blank">00:17:01.180</a></span> | <span class="t">in index 1.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1023" target="_blank">00:17:03.300</a></span> | <span class="t">It doesn't expect a tuple with three values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1027" target="_blank">00:17:07.420</a></span> | <span class="t">So to deal with that, what we do is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1031" target="_blank">00:17:11.500</a></span> | <span class="t">we merge both of these into a dictionary, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1034" target="_blank">00:17:14.580</a></span> | <span class="t">will be contained within tuple index 0.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1039" target="_blank">00:17:19.460</a></span> | <span class="t">So first, we create a map function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1042" target="_blank">00:17:22.340</a></span> | <span class="t">And what we're going to do is just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1045" target="_blank">00:17:25.980</a></span> | <span class="t">apply whatever is inside this function to our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1049" target="_blank">00:17:29.340</a></span> | <span class="t">And it will reformat everything in our data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1052" target="_blank">00:17:32.100</a></span> | <span class="t">to this format that we set up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1055" target="_blank">00:17:35.500</a></span> | <span class="t">So our input IDs, let's just change that to input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1061" target="_blank">00:17:41.020</a></span> | <span class="t">We have the mass, and we have the labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1062" target="_blank">00:17:42.980</a></span> | <span class="t">And all we want to do is return input IDs and mass together.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1072" target="_blank">00:17:52.300</a></span> | <span class="t">And we're also going to give them these key names</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1077" target="_blank">00:17:57.580</a></span> | <span class="t">so that we can map the correct tensor to the correct input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1081" target="_blank">00:18:01.700</a></span> | <span class="t">later on in the model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1083" target="_blank">00:18:03.380</a></span> | <span class="t">So we go input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1086" target="_blank">00:18:06.220</a></span> | <span class="t">We have our attention mass, which goes to our mass.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1092" target="_blank">00:18:12.780</a></span> | <span class="t">And then that is the first part of our tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1096" target="_blank">00:18:16.460</a></span> | <span class="t">And then we also have the labels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1098" target="_blank">00:18:18.020</a></span> | <span class="t">which is the second part.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1099" target="_blank">00:18:19.900</a></span> | <span class="t">And that's all we need to do for creating that map function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1104" target="_blank">00:18:24.140</a></span> | <span class="t">And then like I said before, data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1105" target="_blank">00:18:25.540</a></span> | <span class="t">makes things very easy for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1107" target="_blank">00:18:27.260</a></span> | <span class="t">So to actually apply that mapping function,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1109" target="_blank">00:18:29.820</a></span> | <span class="t">all we need to do is data set dot map, map function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1117" target="_blank">00:18:37.100</a></span> | <span class="t">So now let's have a quick look at what we have,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1120" target="_blank">00:18:40.020</a></span> | <span class="t">see if the format has changed or the shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1125" target="_blank">00:18:45.140</a></span> | <span class="t">OK, you can see now we have--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1127" target="_blank">00:18:47.420</a></span> | <span class="t">so it's all within a tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1130" target="_blank">00:18:50.700</a></span> | <span class="t">This is the 1 index of that tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1133" target="_blank">00:18:53.860</a></span> | <span class="t">This is a 0 index of that tuple.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1136" target="_blank">00:18:56.300</a></span> | <span class="t">And in the 0 index, we have a dictionary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1139" target="_blank">00:18:59.020</a></span> | <span class="t">with input IDs, which goes to our input ID</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1142" target="_blank">00:19:02.100</a></span> | <span class="t">tensor and attention mass, which maps to our attention mass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1146" target="_blank">00:19:06.300</a></span> | <span class="t">tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1147" target="_blank">00:19:07.300</a></span> | <span class="t">OK, so that's great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1148" target="_blank">00:19:08.300</a></span> | <span class="t">And now what we want to do is actually batch this data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1152" target="_blank">00:19:12.820</a></span> | <span class="t">So I'm going to use a batch size of 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1155" target="_blank">00:19:15.980</a></span> | <span class="t">You might want to increase or decrease this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1159" target="_blank">00:19:19.780</a></span> | <span class="t">probably mostly dependent on your GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1163" target="_blank">00:19:23.220</a></span> | <span class="t">I have a very good GPU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1164" target="_blank">00:19:24.620</a></span> | <span class="t">So I would say this is at the upper end, the size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1169" target="_blank">00:19:29.420</a></span> | <span class="t">that you want to be using.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1171" target="_blank">00:19:31.660</a></span> | <span class="t">And what we do here is data set dot shuffle.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1178" target="_blank">00:19:38.620</a></span> | <span class="t">So this is going to shuffle our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1181" target="_blank">00:19:41.660</a></span> | <span class="t">And the value that you should input in here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1184" target="_blank">00:19:44.300</a></span> | <span class="t">I tend to go for this sort of value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1187" target="_blank">00:19:47.660</a></span> | <span class="t">for this type of size data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1190" target="_blank">00:19:50.540</a></span> | <span class="t">But if you notice that your data is not being shuffled,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1194" target="_blank">00:19:54.060</a></span> | <span class="t">just increase this value.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1197" target="_blank">00:19:57.460</a></span> | <span class="t">And then batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1199" target="_blank">00:19:59.340</a></span> | <span class="t">And then we have the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1202" target="_blank">00:20:02.220</a></span> | <span class="t">OK, so split into batches of 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1205" target="_blank">00:20:05.140</a></span> | <span class="t">So we first shuffle the data, and then we batch it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1208" target="_blank">00:20:08.660</a></span> | <span class="t">Otherwise, we would get batches, and we would end up</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1211" target="_blank">00:20:11.340</a></span> | <span class="t">shuffling the batches, which is not really what we want to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1215" target="_blank">00:20:15.660</a></span> | <span class="t">We just want to actually shuffle the data within those batches.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1219" target="_blank">00:20:19.820</a></span> | <span class="t">And then we want to drop the remainder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1224" target="_blank">00:20:24.060</a></span> | <span class="t">and set that equal to true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1225" target="_blank">00:20:25.260</a></span> | <span class="t">So that is dropping.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1227" target="_blank">00:20:27.500</a></span> | <span class="t">So we have batch size of 16.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1229" target="_blank">00:20:29.900</a></span> | <span class="t">If we had, for example, 33 samples,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1235" target="_blank">00:20:35.060</a></span> | <span class="t">we would get two batches out of that, 16 and 16,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1237" target="_blank">00:20:37.780</a></span> | <span class="t">and then we'd have one left over.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1239" target="_blank">00:20:39.740</a></span> | <span class="t">And that wouldn't fit cleanly into a batch,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1241" target="_blank">00:20:41.580</a></span> | <span class="t">so we would just drop it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1242" target="_blank">00:20:42.940</a></span> | <span class="t">We would get rid of it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1245" target="_blank">00:20:45.300</a></span> | <span class="t">And that is what we're doing there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1247" target="_blank">00:20:47.940</a></span> | <span class="t">And then let's just have a look at what we have now.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1253" target="_blank">00:20:53.340</a></span> | <span class="t">So now, see, this has changed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1255" target="_blank">00:20:55.300</a></span> | <span class="t">So we still have that tuple shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1258" target="_blank">00:20:58.660</a></span> | <span class="t">where we have the labels here and the inputs here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1261" target="_blank">00:21:01.980</a></span> | <span class="t">But our actual shapes, our tensor shapes, has changed.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1264" target="_blank">00:21:04.940</a></span> | <span class="t">So now we have 16 samples for every tensor.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1269" target="_blank">00:21:09.220</a></span> | <span class="t">OK, so that is what we want.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1270" target="_blank">00:21:10.820</a></span> | <span class="t">That's good.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1272" target="_blank">00:21:12.060</a></span> | <span class="t">We've got our full data set, our train data set here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1274" target="_blank">00:21:14.820</a></span> | <span class="t">And what we might want to do is split that into a training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1279" target="_blank">00:21:19.700</a></span> | <span class="t">and validation set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1281" target="_blank">00:21:21.620</a></span> | <span class="t">And we can do that by setting the split here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1285" target="_blank">00:21:25.460</a></span> | <span class="t">So we're going to use 90%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1286" target="_blank">00:21:26.860</a></span> | <span class="t">You can change this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1287" target="_blank">00:21:27.900</a></span> | <span class="t">So we're going to 90% training data, 10% validation data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1291" target="_blank">00:21:31.380</a></span> | <span class="t">And what we need to do is just calculate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1293" target="_blank">00:21:33.580</a></span> | <span class="t">the size of that split, or the size of the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1298" target="_blank">00:21:38.700</a></span> | <span class="t">data in this case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1300" target="_blank">00:21:40.340</a></span> | <span class="t">So we'll take the XIDs shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1306" target="_blank">00:21:46.460</a></span> | <span class="t">Or actually, we can just set the SQL to the value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1311" target="_blank">00:21:51.420</a></span> | <span class="t">that we defined up here, the number of samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1316" target="_blank">00:21:56.180</a></span> | <span class="t">So these are the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1319" target="_blank">00:21:59.900</a></span> | <span class="t">Let me show you.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1322" target="_blank">00:22:02.500</a></span> | <span class="t">So number of samples and the XIDs shape.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1328" target="_blank">00:22:08.540</a></span> | <span class="t">Cases are the same thing.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1330" target="_blank">00:22:10.700</a></span> | <span class="t">We've already defined that, so let's just go with that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1333" target="_blank">00:22:13.100</a></span> | <span class="t">And we're going to divide that by the batch size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1338" target="_blank">00:22:18.380</a></span> | <span class="t">And this gives us the new number of samples within our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1350" target="_blank">00:22:30.460</a></span> | <span class="t">set, because we've batched it here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1354" target="_blank">00:22:34.380</a></span> | <span class="t">Now, one, we only want 90% of these,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1359" target="_blank">00:22:39.260</a></span> | <span class="t">so we multiply it by split.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1360" target="_blank">00:22:40.980</a></span> | <span class="t">So I do need to just run that quick.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1367" target="_blank">00:22:47.820</a></span> | <span class="t">So that's our 90% mark.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1371" target="_blank">00:22:51.420</a></span> | <span class="t">And when we're saying, in a moment,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1374" target="_blank">00:22:54.300</a></span> | <span class="t">that we want this number of samples from the data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1378" target="_blank">00:22:58.660</a></span> | <span class="t">we can't give it a float, because we can't have 0.375</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1384" target="_blank">00:23:04.180</a></span> | <span class="t">of a batch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1385" target="_blank">00:23:05.500</a></span> | <span class="t">It doesn't work.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1387" target="_blank">00:23:07.140</a></span> | <span class="t">So what we need to do is set that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1389" target="_blank">00:23:09.220</a></span> | <span class="t">equal to a integer to round off.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1393" target="_blank">00:23:13.660</a></span> | <span class="t">So we do that here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1395" target="_blank">00:23:15.980</a></span> | <span class="t">Let's remove that and run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1398" target="_blank">00:23:18.900</a></span> | <span class="t">So now we have our size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1402" target="_blank">00:23:22.220</a></span> | <span class="t">We can split our data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1405" target="_blank">00:23:25.340</a></span> | <span class="t">So we're going to have the train data set, which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1407" target="_blank">00:23:27.980</a></span> | <span class="t">is just going to be data set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1409" target="_blank">00:23:29.740</a></span> | <span class="t">And as we did up here, where we do this take method</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1412" target="_blank">00:23:32.780</a></span> | <span class="t">to take a certain number of samples, we do the same.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1416" target="_blank">00:23:36.620</a></span> | <span class="t">But now we're going to take a lot more than just one.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1418" target="_blank">00:23:38.780</a></span> | <span class="t">We're going to be taking the size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1420" target="_blank">00:23:40.660</a></span> | <span class="t">that we calculated here, which is 8,700 or so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1425" target="_blank">00:23:45.300</a></span> | <span class="t">And then for the validation data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1428" target="_blank">00:23:48.020</a></span> | <span class="t">we kind of want to do the opposite.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1429" target="_blank">00:23:49.500</a></span> | <span class="t">We want to skip that many samples.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1432" target="_blank">00:23:52.380</a></span> | <span class="t">So that's exactly what we write here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1434" target="_blank">00:23:54.180</a></span> | <span class="t">We just write skip size.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1436" target="_blank">00:23:56.580</a></span> | <span class="t">So we're going to skip the first 8,700 or so.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1440" target="_blank">00:24:00.500</a></span> | <span class="t">And we're just going to take the final ones out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1444" target="_blank">00:24:04.300</a></span> | <span class="t">of that, the final 10%.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1446" target="_blank">00:24:06.460</a></span> | <span class="t">And then we're not going to be using data set anymore.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1448" target="_blank">00:24:08.860</a></span> | <span class="t">And it's quite a large object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1450" target="_blank">00:24:10.820</a></span> | <span class="t">So we can just remove that from our memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1455" target="_blank">00:24:15.100</a></span> | <span class="t">OK, so now we're on to actually building and training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1459" target="_blank">00:24:19.860</a></span> | <span class="t">our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1460" target="_blank">00:24:20.820</a></span> | <span class="t">So we're going to be using Transformers again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1462" target="_blank">00:24:22.980</a></span> | <span class="t">to load in a pre-trained BERT model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1467" target="_blank">00:24:27.380</a></span> | <span class="t">And we're going to be using the TF auto model using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1472" target="_blank">00:24:32.380</a></span> | <span class="t">the TensorFlow version.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1475" target="_blank">00:24:35.860</a></span> | <span class="t">And we'll set BERT equal to TF auto model from pre-trained.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1484" target="_blank">00:24:44.420</a></span> | <span class="t">And it is BERT base and case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1490" target="_blank">00:24:50.820</a></span> | <span class="t">And just like we would, because here we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1496" target="_blank">00:24:56.060</a></span> | <span class="t">using the TensorFlow version here, if we got rid of this,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1499" target="_blank">00:24:59.260</a></span> | <span class="t">we'd be using PyTorch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1501" target="_blank">00:25:01.620</a></span> | <span class="t">So here we're using TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1503" target="_blank">00:25:03.540</a></span> | <span class="t">Just like we would have any other TensorFlow model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1505" target="_blank">00:25:05.700</a></span> | <span class="t">we can use the summary method to print out what we have.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1509" target="_blank">00:25:09.100</a></span> | <span class="t">OK, and we see we just have this one layer,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1515" target="_blank">00:25:15.420</a></span> | <span class="t">which is a BERT layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1517" target="_blank">00:25:17.580</a></span> | <span class="t">And this is just because everything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1519" target="_blank">00:25:19.540</a></span> | <span class="t">within that BERT layer is a lot more complex than just one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1522" target="_blank">00:25:22.860</a></span> | <span class="t">layer, but it's all embedded within that single layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1526" target="_blank">00:25:26.540</a></span> | <span class="t">So we can't actually see inside of it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1528" target="_blank">00:25:28.620</a></span> | <span class="t">just by printing out the summary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1530" target="_blank">00:25:30.740</a></span> | <span class="t">Now, we have BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1532" target="_blank">00:25:32.780</a></span> | <span class="t">And that is great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1534" target="_blank">00:25:34.500</a></span> | <span class="t">But that's kind of like the core or the engine of our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1538" target="_blank">00:25:38.940</a></span> | <span class="t">But we need to build a frame around that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1541" target="_blank">00:25:41.260</a></span> | <span class="t">based on our use case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1543" target="_blank">00:25:43.900</a></span> | <span class="t">So the first thing we need to do is we have our two input layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1550" target="_blank">00:25:50.180</a></span> | <span class="t">We have that one for input IDs and one for the attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1554" target="_blank">00:25:54.100</a></span> | <span class="t">So first, we need to define those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1558" target="_blank">00:25:58.740</a></span> | <span class="t">So we've already imported TensorFlow earlier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1561" target="_blank">00:26:01.740</a></span> | <span class="t">for the data set, so we don't need to do that again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1564" target="_blank">00:26:04.500</a></span> | <span class="t">And what we do is input IDs, and we say tf.keras.layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1571" target="_blank">00:26:11.780</a></span> | <span class="t">And we're using an input layer here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1574" target="_blank">00:26:14.180</a></span> | <span class="t">And the shape of that input layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1577" target="_blank">00:26:17.140</a></span> | <span class="t">is equal to the sequence length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1580" target="_blank">00:26:20.380</a></span> | <span class="t">So sequence length, and then we just add a comma here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1583" target="_blank">00:26:23.940</a></span> | <span class="t">So that's the same shape as that we were seeing up here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1590" target="_blank">00:26:30.380</a></span> | <span class="t">Now, we need to set a name.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1596" target="_blank">00:26:36.460</a></span> | <span class="t">And we do this because, as we have seen up here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1600" target="_blank">00:26:40.700</a></span> | <span class="t">we have this dictionary.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1602" target="_blank">00:26:42.740</a></span> | <span class="t">And we need to know which input each of these input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1606" target="_blank">00:26:46.500</a></span> | <span class="t">tensors are going to go into.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1607" target="_blank">00:26:47.940</a></span> | <span class="t">And that's how we do it.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1608" target="_blank">00:26:48.940</a></span> | <span class="t">We map input IDs to this name here, input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1613" target="_blank">00:26:53.900</a></span> | <span class="t">And we'll do the same for attention mask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1615" target="_blank">00:26:55.900</a></span> | <span class="t">as well in a moment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1618" target="_blank">00:26:58.460</a></span> | <span class="t">And we set the data type equal to integer 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1623" target="_blank">00:27:03.220</a></span> | <span class="t">And we do that because these are tokens here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1628" target="_blank">00:27:08.180</a></span> | <span class="t">but expect them to be integer values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1631" target="_blank">00:27:11.780</a></span> | <span class="t">And we do the same for mask, tf.keras.layers, input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1641" target="_blank">00:27:21.020</a></span> | <span class="t">And the shape is sequence length again.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1645" target="_blank">00:27:25.180</a></span> | <span class="t">We have the name, which is where we use our attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1649" target="_blank">00:27:29.300</a></span> | <span class="t">mask to map that across.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1652" target="_blank">00:27:32.380</a></span> | <span class="t">And again, it's just the same D type, which is int 32.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1658" target="_blank">00:27:38.860</a></span> | <span class="t">So they are our input layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1661" target="_blank">00:27:41.740</a></span> | <span class="t">And then what we need is we need--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1665" target="_blank">00:27:45.820</a></span> | <span class="t">after the input, what do we have?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1667" target="_blank">00:27:47.340</a></span> | <span class="t">We want to feed this into BERT, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1669" target="_blank">00:27:49.860</a></span> | <span class="t">So what we're doing there is we're creating our embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1675" target="_blank">00:27:55.460</a></span> | <span class="t">from BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1676" target="_blank">00:27:56.980</a></span> | <span class="t">And what we need to do is access the transformer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1682" target="_blank">00:28:02.300</a></span> | <span class="t">within that BERT object.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1685" target="_blank">00:28:05.500</a></span> | <span class="t">So to do that, for BERT, we just write</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1688" target="_blank">00:28:08.180</a></span> | <span class="t">BERT dot BERT, which accesses that transformer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1692" target="_blank">00:28:12.260</a></span> | <span class="t">And in there, we want to pass out input IDs and our attention</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1698" target="_blank">00:28:18.420</a></span> | <span class="t">mask, which is going to be the mask, so these two input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1702" target="_blank">00:28:22.380</a></span> | <span class="t">layers here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1703" target="_blank">00:28:23.820</a></span> | <span class="t">And we have two options here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1705" target="_blank">00:28:25.020</a></span> | <span class="t">We can pull out the raw activations or the raw</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1710" target="_blank">00:28:30.180</a></span> | <span class="t">activation tensors from the transformer model here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1713" target="_blank">00:28:33.700</a></span> | <span class="t">And these are three-dimensional.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1716" target="_blank">00:28:36.700</a></span> | <span class="t">And as I said, just take out that raw activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1720" target="_blank">00:28:40.380</a></span> | <span class="t">from the final layer of BERT.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1724" target="_blank">00:28:44.100</a></span> | <span class="t">Or what they also include here is a pooled layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1729" target="_blank">00:28:49.020</a></span> | <span class="t">or pooled activations.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1730" target="_blank">00:28:50.740</a></span> | <span class="t">So these are those 3D tensors pooled into 2D tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1737" target="_blank">00:28:57.260</a></span> | <span class="t">Now, what we're going to be using is dense layers here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1739" target="_blank">00:28:59.900</a></span> | <span class="t">So we are expecting 2D tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1742" target="_blank">00:29:02.780</a></span> | <span class="t">And therefore, we want to be using this pooled layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1747" target="_blank">00:29:07.460</a></span> | <span class="t">We could also pool it ourselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1748" target="_blank">00:29:08.900</a></span> | <span class="t">But the pooling has already been done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1750" target="_blank">00:29:10.900</a></span> | <span class="t">So why do it again?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1753" target="_blank">00:29:13.220</a></span> | <span class="t">Now, what we want to do here for our final part of this model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1757" target="_blank">00:29:17.820</a></span> | <span class="t">is we need to convert these embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1759" target="_blank">00:29:19.980</a></span> | <span class="t">into our label predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1763" target="_blank">00:29:23.460</a></span> | <span class="t">So to do that, we want two more layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1767" target="_blank">00:29:27.620</a></span> | <span class="t">And these are going to both be densely connected layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1771" target="_blank">00:29:31.100</a></span> | <span class="t">And for the first one, I'm going to use 1,024 units or neurons.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1778" target="_blank">00:29:38.740</a></span> | <span class="t">And the activation will be ReLU.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1781" target="_blank">00:29:41.780</a></span> | <span class="t">And we're passing the embeddings into that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1786" target="_blank">00:29:46.100</a></span> | <span class="t">And then our final layer, which is our labels,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1789" target="_blank">00:29:49.900</a></span> | <span class="t">that is going to be the same thing again, so dense.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1795" target="_blank">00:29:55.780</a></span> | <span class="t">But this time, we just want a number of labels here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1799" target="_blank">00:29:59.340</a></span> | <span class="t">So we did calculate this before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1801" target="_blank">00:30:01.980</a></span> | <span class="t">It was array, max, plus 1, right?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1807" target="_blank">00:30:07.860</a></span> | <span class="t">So that is just 5.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1811" target="_blank">00:30:11.100</a></span> | <span class="t">So we have 5 output labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1813" target="_blank">00:30:13.980</a></span> | <span class="t">And what we want to do here is calculate the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1817" target="_blank">00:30:17.100</a></span> | <span class="t">across all 5 of those output labels.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1820" target="_blank">00:30:20.340</a></span> | <span class="t">So to do that, we want to use a softmax activation.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1825" target="_blank">00:30:25.580</a></span> | <span class="t">Function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1826" target="_blank">00:30:26.300</a></span> | <span class="t">And we just want to say we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1828" target="_blank">00:30:28.740</a></span> | <span class="t">to call this the outputs layer, because it is our outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1833" target="_blank">00:30:33.980</a></span> | <span class="t">Now, that is our model architecture.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1838" target="_blank">00:30:38.540</a></span> | <span class="t">They are all of our layers, but we haven't actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1841" target="_blank">00:30:41.740</a></span> | <span class="t">put those layers into a model yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1843" target="_blank">00:30:43.500</a></span> | <span class="t">They're all kind of just floating there by themselves.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1847" target="_blank">00:30:47.500</a></span> | <span class="t">Obviously, they do have these connections between them,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1849" target="_blank">00:30:49.740</a></span> | <span class="t">but they're not initialized into a model object yet.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1853" target="_blank">00:30:53.340</a></span> | <span class="t">So we need to do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1855" target="_blank">00:30:55.100</a></span> | <span class="t">And to do that, we go tf.keras, model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1860" target="_blank">00:31:00.300</a></span> | <span class="t">And we also need to do here, we need to set the input layers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1864" target="_blank">00:31:04.820</a></span> | <span class="t">so our inputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1866" target="_blank">00:31:06.940</a></span> | <span class="t">And we have two of those, so we put them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1868" target="_blank">00:31:08.580</a></span> | <span class="t">in a list here, input IDs, and the mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1873" target="_blank">00:31:13.420</a></span> | <span class="t">So this is those two.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1877" target="_blank">00:31:17.380</a></span> | <span class="t">Then we also need to set the outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1881" target="_blank">00:31:21.300</a></span> | <span class="t">And we just have one output, and that is y.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1885" target="_blank">00:31:25.020</a></span> | <span class="t">Yeah, so just setting up our boundaries of our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1890" target="_blank">00:31:30.500</a></span> | <span class="t">We have the inputs, and they lead to our outputs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1893" target="_blank">00:31:33.660</a></span> | <span class="t">Everything else within this is already handled to go to x.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1897" target="_blank">00:31:37.260</a></span> | <span class="t">We consume embeddings, and embeddings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1899" target="_blank">00:31:39.980</a></span> | <span class="t">consumes input IDs and mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1903" target="_blank">00:31:43.180</a></span> | <span class="t">So those connections are already set up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1906" target="_blank">00:31:46.780</a></span> | <span class="t">And let's just see what we have here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1911" target="_blank">00:31:51.180</a></span> | <span class="t">And I just realized that this is input.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1913" target="_blank">00:31:53.540</a></span> | <span class="t">This should be mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1916" target="_blank">00:31:56.260</a></span> | <span class="t">Let's see what this error is.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1917" target="_blank">00:31:57.660</a></span> | <span class="t">OK, so here I forgot to add this connection,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1927" target="_blank">00:32:07.020</a></span> | <span class="t">so I need to add x there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1928" target="_blank">00:32:08.420</a></span> | <span class="t">OK, so now what do we have?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1936" target="_blank">00:32:16.660</a></span> | <span class="t">It's a little bit messy, but--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1938" target="_blank">00:32:18.260</a></span> | <span class="t">so we have our input IDs, and we have the shape here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1943" target="_blank">00:32:23.580</a></span> | <span class="t">the attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1944" target="_blank">00:32:24.700</a></span> | <span class="t">So these are our two input layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1947" target="_blank">00:32:27.580</a></span> | <span class="t">They lead into our BERT layer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1950" target="_blank">00:32:30.500</a></span> | <span class="t">Then we have our pre-classifying layer here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1953" target="_blank">00:32:33.220</a></span> | <span class="t">the densely connected neural net with 1,024 units.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1958" target="_blank">00:32:38.420</a></span> | <span class="t">And we have our outputs, which is the softmax.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1962" target="_blank">00:32:42.220</a></span> | <span class="t">And we have five of those.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1965" target="_blank">00:32:45.020</a></span> | <span class="t">Now, if you would like to, what you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1968" target="_blank">00:32:48.860</a></span> | <span class="t">can do if you don't have enough compute</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1971" target="_blank">00:32:51.540</a></span> | <span class="t">to train the BERT layer as well, you can also write this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1977" target="_blank">00:32:57.060</a></span> | <span class="t">So go model layers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1978" target="_blank">00:32:58.580</a></span> | <span class="t">And we select number 2, because we have 0, 1, and 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1981" target="_blank">00:33:01.580</a></span> | <span class="t">So BERT is number 2 in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1983" target="_blank">00:33:03.460</a></span> | <span class="t">And we can set trainable equal to false.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1987" target="_blank">00:33:07.660</a></span> | <span class="t">And this would just freeze the parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1990" target="_blank">00:33:10.700</a></span> | <span class="t">within this BERT layer and just train the other two here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=1995" target="_blank">00:33:15.460</a></span> | <span class="t">But I will be keeping that so they can be trained as well,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2001" target="_blank">00:33:21.780</a></span> | <span class="t">although you don't need to.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2003" target="_blank">00:33:23.460</a></span> | <span class="t">It will probably give you a small performance increase,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2006" target="_blank">00:33:26.500</a></span> | <span class="t">but not a huge amount in most cases.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2010" target="_blank">00:33:30.460</a></span> | <span class="t">Now, I want to set up the model training parameters.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2015" target="_blank">00:33:35.060</a></span> | <span class="t">So we need a optimizer, which is optimizers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2020" target="_blank">00:33:40.820</a></span> | <span class="t">And for this, we're going to be using Adam.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2023" target="_blank">00:33:43.300</a></span> | <span class="t">We're using a pretty small learning rate of 1e to the minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2028" target="_blank">00:33:48.020</a></span> | <span class="t">5 is because we've got our BERT model in here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2030" target="_blank">00:33:50.900</a></span> | <span class="t">We also want to set a weight decay as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2037" target="_blank">00:33:57.220</a></span> | <span class="t">So this is Adam with a decay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2040" target="_blank">00:34:00.460</a></span> | <span class="t">And what we also want to add is a loss function.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2045" target="_blank">00:34:05.820</a></span> | <span class="t">So we want to do tf.keras losses.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2050" target="_blank">00:34:10.860</a></span> | <span class="t">And because we're using categorical outputs here,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2054" target="_blank">00:34:14.300</a></span> | <span class="t">we want to use categorical cross-entropy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2061" target="_blank">00:34:21.660</a></span> | <span class="t">And then we're going to set our accuracy as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2064" target="_blank">00:34:24.620</a></span> | <span class="t">And that is tf.keras metrics this time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2068" target="_blank">00:34:28.060</a></span> | <span class="t">And we're using categorical accuracy for the same reason.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2072" target="_blank">00:34:32.220</a></span> | <span class="t">We're just going to need to pass accuracy in there as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2078" target="_blank">00:34:38.660</a></span> | <span class="t">And let me change that to metrics.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2085" target="_blank">00:34:45.460</a></span> | <span class="t">And then we just want to do model compile.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2091" target="_blank">00:34:51.020</a></span> | <span class="t">Optimizer is equal to the optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2094" target="_blank">00:34:54.500</a></span> | <span class="t">Loss to loss.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2097" target="_blank">00:34:57.060</a></span> | <span class="t">And metrics is going to be equal to a list containing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2100" target="_blank">00:35:00.660</a></span> | <span class="t">our accuracy.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2102" target="_blank">00:35:02.820</a></span> | <span class="t">OK, so that's our model training parameters all set up.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2107" target="_blank">00:35:07.140</a></span> | <span class="t">So the final thing to do now is train our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2113" target="_blank">00:35:13.260</a></span> | <span class="t">So to do that, we call model fit,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2115" target="_blank">00:35:15.860</a></span> | <span class="t">like we would in any TensorFlow training.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2119" target="_blank">00:35:19.460</a></span> | <span class="t">And we have our training data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2122" target="_blank">00:35:22.740</a></span> | <span class="t">which we've built already.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2124" target="_blank">00:35:24.380</a></span> | <span class="t">The validation data we'll be using is our validation data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2130" target="_blank">00:35:30.020</a></span> | <span class="t">set.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2130" target="_blank">00:35:30.940</a></span> | <span class="t">And we'll train that for three epochs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2134" target="_blank">00:35:34.620</a></span> | <span class="t">And that will take some time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2137" target="_blank">00:35:37.620</a></span> | <span class="t">And immediately after we do train that,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2140" target="_blank">00:35:40.860</a></span> | <span class="t">I'm also going to save that model to sentiment model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2148" target="_blank">00:35:48.660</a></span> | <span class="t">OK, now we'll just create a directory here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2150" target="_blank">00:35:50.660</a></span> | <span class="t">and store all the files that we need for that model in there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2156" target="_blank">00:35:56.540</a></span> | <span class="t">So I will go ahead and run that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2159" target="_blank">00:35:59.540</a></span> | <span class="t">And I will see you when it's done.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2162" target="_blank">00:36:02.660</a></span> | <span class="t">OK, so finished training our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2165" target="_blank">00:36:05.140</a></span> | <span class="t">We got to an accuracy of 75%, still moving,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2170" target="_blank">00:36:10.060</a></span> | <span class="t">and also validation accuracy of 71% here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2175" target="_blank">00:36:15.740</a></span> | <span class="t">So inside the sentiment model directory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2179" target="_blank">00:36:19.140</a></span> | <span class="t">that we just created when we saved our model,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2182" target="_blank">00:36:22.260</a></span> | <span class="t">we have everything that we need to load our model as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2187" target="_blank">00:36:27.900</a></span> | <span class="t">So I'm just going to show you how we can do that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2191" target="_blank">00:36:31.660</a></span> | <span class="t">So what we can do is let's start a new file here, no notebook.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2202" target="_blank">00:36:42.340</a></span> | <span class="t">OK, so let's just close this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2208" target="_blank">00:36:48.500</a></span> | <span class="t">And what we'll do here is we need to first import TensorFlow.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2214" target="_blank">00:36:54.260</a></span> | <span class="t">And after we have imported TensorFlow,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2216" target="_blank">00:36:56.860</a></span> | <span class="t">we need to actually load our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2219" target="_blank">00:36:59.580</a></span> | <span class="t">So we use tf.keras.models.loadModel.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2224" target="_blank">00:37:04.980</a></span> | <span class="t">And then we're loading this from the sentiment model directory</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2228" target="_blank">00:37:08.820</a></span> | <span class="t">here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2229" target="_blank">00:37:09.620</a></span> | <span class="t">And then let's just check that what we have here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2232" target="_blank">00:37:12.900</a></span> | <span class="t">is what we built before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2236" target="_blank">00:37:16.780</a></span> | <span class="t">OK, great.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2237" target="_blank">00:37:17.700</a></span> | <span class="t">So we can see now we have our input layers, BERT,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2243" target="_blank">00:37:23.020</a></span> | <span class="t">and then we have our preclassifier and classifier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2246" target="_blank">00:37:26.700</a></span> | <span class="t">layers as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2249" target="_blank">00:37:29.260</a></span> | <span class="t">So that's exactly what we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2251" target="_blank">00:37:31.660</a></span> | <span class="t">And now we can go forwards and start making predictions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2255" target="_blank">00:37:35.700</a></span> | <span class="t">with this model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2258" target="_blank">00:37:38.220</a></span> | <span class="t">So before we make our predictions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2260" target="_blank">00:37:40.420</a></span> | <span class="t">we still need to convert our data or input strings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2264" target="_blank">00:37:44.500</a></span> | <span class="t">into tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2266" target="_blank">00:37:46.860</a></span> | <span class="t">To do that, I'm going to create a function to handle it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2270" target="_blank">00:37:50.900</a></span> | <span class="t">for us.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2272" target="_blank">00:37:52.540</a></span> | <span class="t">First, we are going to need to import the tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2276" target="_blank">00:37:56.900</a></span> | <span class="t">from Transformers.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2278" target="_blank">00:37:58.300</a></span> | <span class="t">We're using BERT tokenizer just like we did before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2285" target="_blank">00:38:05.180</a></span> | <span class="t">And we're going to use the tokenizer, BERT tokenizer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2288" target="_blank">00:38:08.980</a></span> | <span class="t">from pre-trained BERT base case.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2295" target="_blank">00:38:15.580</a></span> | <span class="t">OK, so exactly the same as what we used before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2299" target="_blank">00:38:19.780</a></span> | <span class="t">So that is our tokenizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2304" target="_blank">00:38:24.380</a></span> | <span class="t">And all we need to do is we're going to say--</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2307" target="_blank">00:38:27.900</a></span> | <span class="t">call it prep data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2309" target="_blank">00:38:29.940</a></span> | <span class="t">And here we would expect a text, which is a string.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2314" target="_blank">00:38:34.060</a></span> | <span class="t">And we'll return our tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2318" target="_blank">00:38:38.380</a></span> | <span class="t">And this is just the same as what we were doing before.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2321" target="_blank">00:38:41.540</a></span> | <span class="t">OK, so we do encode plus our text.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2326" target="_blank">00:38:46.220</a></span> | <span class="t">We set a max length, which is going to be 512, as always.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2330" target="_blank">00:38:50.740</a></span> | <span class="t">But we are going to truncate anything longer than that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2335" target="_blank">00:38:55.140</a></span> | <span class="t">And we're going to pad anything shorter than that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2343" target="_blank">00:39:03.820</a></span> | <span class="t">And we'll pad it up to the max length.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2347" target="_blank">00:39:07.540</a></span> | <span class="t">And then we want to add the special tokens.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2350" target="_blank">00:39:10.780</a></span> | <span class="t">That is true.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2353" target="_blank">00:39:13.060</a></span> | <span class="t">And then there's one other thing that we don't need,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2357" target="_blank">00:39:17.780</a></span> | <span class="t">which are the token type IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2361" target="_blank">00:39:21.500</a></span> | <span class="t">So token type IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2364" target="_blank">00:39:24.060</a></span> | <span class="t">And this is just another tensor that is returned.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2366" target="_blank">00:39:26.820</a></span> | <span class="t">And we don't need them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2368" target="_blank">00:39:28.460</a></span> | <span class="t">So we can just ignore them.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2371" target="_blank">00:39:31.860</a></span> | <span class="t">And we're going to return the TensorFlow tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2376" target="_blank">00:39:36.740</a></span> | <span class="t">OK, and that is all we need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2382" target="_blank">00:39:42.380</a></span> | <span class="t">And now we can just return our tensors in the correct format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2387" target="_blank">00:39:47.740</a></span> | <span class="t">So the format that we need is like we used before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2391" target="_blank">00:39:51.300</a></span> | <span class="t">with the input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2394" target="_blank">00:39:54.260</a></span> | <span class="t">But if you remember before, within the data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2399" target="_blank">00:39:59.020</a></span> | <span class="t">we were working with TensorFlow Float64 tensors.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2404" target="_blank">00:40:04.460</a></span> | <span class="t">So we also need to convert these, which will be integers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2409" target="_blank">00:40:09.180</a></span> | <span class="t">I believe, into that format.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2412" target="_blank">00:40:12.700</a></span> | <span class="t">So to do that, we do tf.cast tokens, input IDs.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2421" target="_blank">00:40:21.140</a></span> | <span class="t">And we say we want to cast that to tf.float64.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2423" target="_blank">00:40:23.500</a></span> | <span class="t">And we can copy that across.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2430" target="_blank">00:40:30.340</a></span> | <span class="t">And we'll repeat the same thing, but for our attention mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2435" target="_blank">00:40:35.060</a></span> | <span class="t">So attention mask, we'll just copy that across.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2440" target="_blank">00:40:40.740</a></span> | <span class="t">And that is all we need to prepare our data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2445" target="_blank">00:40:45.660</a></span> | <span class="t">And we'll just fix that.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2448" target="_blank">00:40:48.460</a></span> | <span class="t">OK, and now what we can do is we can just prep data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2455" target="_blank">00:40:55.620</a></span> | <span class="t">We'll just put something like "hello world."</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2460" target="_blank">00:41:00.060</a></span> | <span class="t">OK, and we get all these values.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2465" target="_blank">00:41:05.140</a></span> | <span class="t">And you see here, I have entered that wrong.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2468" target="_blank">00:41:08.020</a></span> | <span class="t">We don't even need this necessarily,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2470" target="_blank">00:41:10.100</a></span> | <span class="t">but just for it to be explicit.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2473" target="_blank">00:41:13.740</a></span> | <span class="t">And we just need to add the S onto IDs there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2477" target="_blank">00:41:17.060</a></span> | <span class="t">So rerun that and remove that error.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2480" target="_blank">00:41:20.100</a></span> | <span class="t">And you can see here we have our CLS token, "hello world,"</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2485" target="_blank">00:41:25.060</a></span> | <span class="t">separated token, followed by lots of padding.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2489" target="_blank">00:41:29.780</a></span> | <span class="t">OK, so our prep data works.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2495" target="_blank">00:41:35.100</a></span> | <span class="t">And let's just put that into a value there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2502" target="_blank">00:41:42.020</a></span> | <span class="t">And what I want to do now is get the probability</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2505" target="_blank">00:41:45.100</a></span> | <span class="t">by calling model predict.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2507" target="_blank">00:41:47.820</a></span> | <span class="t">And we do test here.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2511" target="_blank">00:41:51.980</a></span> | <span class="t">So we've already done prep data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2515" target="_blank">00:41:55.220</a></span> | <span class="t">And let's see what we get.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2518" target="_blank">00:41:58.620</a></span> | <span class="t">OK, so we have these predictions,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2522" target="_blank">00:42:02.100</a></span> | <span class="t">which is not that easy to read.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2525" target="_blank">00:42:05.060</a></span> | <span class="t">And we also just need to access the zero index.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2528" target="_blank">00:42:08.700</a></span> | <span class="t">So we just get a simple array there.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2532" target="_blank">00:42:12.540</a></span> | <span class="t">And what we can do to get the actual class from that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2535" target="_blank">00:42:15.660</a></span> | <span class="t">is we'll just import NumPy as NP,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2538" target="_blank">00:42:18.660</a></span> | <span class="t">because we just want to take the maximum value out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2541" target="_blank">00:42:21.580</a></span> | <span class="t">of all of these.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2543" target="_blank">00:42:23.420</a></span> | <span class="t">And to do that, we just do np argmax probs zero.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2550" target="_blank">00:42:30.700</a></span> | <span class="t">OK, so it's had a neutral sentiment.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2555" target="_blank">00:42:35.180</a></span> | <span class="t">But something like this movie is awful.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2561" target="_blank">00:42:41.100</a></span> | <span class="t">And we should get zero, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2570" target="_blank">00:42:50.020</a></span> | <span class="t">And we'll do this.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2572" target="_blank">00:42:52.460</a></span> | <span class="t">And we'll get four, OK?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2573" target="_blank">00:42:53.700</a></span> | <span class="t">So it's working.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2575" target="_blank">00:42:55.500</a></span> | <span class="t">So that, I know, is pretty long.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2578" target="_blank">00:42:58.500</a></span> | <span class="t">But that is really everything you need from start to finish.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2582" target="_blank">00:43:02.140</a></span> | <span class="t">We've preprocessed the data, set up our input data set,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2584" target="_blank">00:43:04.820</a></span> | <span class="t">pipeline.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2586" target="_blank">00:43:06.500</a></span> | <span class="t">We've built, trained our model.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2589" target="_blank">00:43:09.140</a></span> | <span class="t">We've saved it, loaded it, and made predictions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2591" target="_blank">00:43:11.580</a></span> | <span class="t">So that's really everything you need.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2595" target="_blank">00:43:15.420</a></span> | <span class="t">So I hope that has been a useful video.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2598" target="_blank">00:43:18.820</a></span> | <span class="t">And thank you very much for watching.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=pjtnkCGElcE&t=2601" target="_blank">00:43:21.420</a></span> | <span class="t">I will see you again in the next one.</span></div></div></body></html>