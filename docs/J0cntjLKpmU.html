<html><head><title>Train Sentence Transformers by Generating Queries (GenQ)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 80%;
        margin: auto;
        overflow: hidden;
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Train Sentence Transformers by Generating Queries (GenQ)</h2><a href="https://www.youtube.com/watch?v=J0cntjLKpmU"><img src="https://i.ytimg.com/vi/J0cntjLKpmU/maxresdefault.jpg" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=0">0:0</a> Intro<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=32">0:32</a> Why GenQ?<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=143">2:23</a> GenQ Overview<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=268">4:28</a> Training Data<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=408">6:48</a> Asymmetric Semantic Search<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=474">7:54</a> T5 Query Generation<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=832">13:52</a> Finetuning Bi-encoders<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=962">16:2</a> GenQ Code Walkthrough<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1300">21:40</a> Finetuning Bi-encoder Walkthrough<br><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1608">26:48</a> Final Points<br><br><div style="text-align: left;"><a href="./J0cntjLKpmU.html">Whisper Transcript</a> | <a href="./transcript_J0cntjLKpmU.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Today we're going to have a look at how to fine-tune or build a sentence</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=6" target="_blank">00:00:06.640</a></span> | <span class="t">transformer or bi-encoder model using a very limited data set. So when I say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=14" target="_blank">00:00:14.040</a></span> | <span class="t">limited data set all we actually need to fine-tune this bi-encoder model is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=21" target="_blank">00:00:21.120</a></span> | <span class="t">unstructured text data from our target domain. Okay so the domain or the area</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=28" target="_blank">00:00:28.280</a></span> | <span class="t">that we want to apply the model to. So the reason that we might want to do this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=34" target="_blank">00:00:34.720</a></span> | <span class="t">is I think quite clear for anyone who has trained sentence transformers,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=42" target="_blank">00:00:42.200</a></span> | <span class="t">bi-encoders before. We in most cases will find that we don't have that much data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=48" target="_blank">00:00:48.040</a></span> | <span class="t">and the data that we do have is usually not in the correct format for actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=53" target="_blank">00:00:53.800</a></span> | <span class="t">training a model. So we're going to look at one of the most recent methods for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=59" target="_blank">00:00:59.920</a></span> | <span class="t">actually doing this and that is called Gen-Q. At a very high level Gen-Q relies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=68" target="_blank">00:01:08.440</a></span> | <span class="t">or the main benefits of Gen-Q are these three points here or reasons for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=74" target="_blank">00:01:14.400</a></span> | <span class="t">using Gen-Q. Our training data is simply unstructured text. So when I say</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=80" target="_blank">00:01:20.560</a></span> | <span class="t">unstructured text it's if you have for example PDF documents or web pages that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=86" target="_blank">00:01:26.080</a></span> | <span class="t">you're scraping data from you can use that as your training data. It's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=92" target="_blank">00:01:32.160</a></span> | <span class="t">specifically for asymmetric semantic search e.g. where your queries that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=97" target="_blank">00:01:37.920</a></span> | <span class="t">searching with are generally smaller than the passages or context that you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=104" target="_blank">00:01:44.320</a></span> | <span class="t">searching for. We'll explain that a little bit more pretty soon. One of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=111" target="_blank">00:01:51.640</a></span> | <span class="t">very impressive things with Gen-Q is that the performance can approach the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=117" target="_blank">00:01:57.680</a></span> | <span class="t">performance of models trained using supervised methods. Now that's not going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=122" target="_blank">00:02:02.680</a></span> | <span class="t">to be the case for every single use case and I'd say you're probably going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=127" target="_blank">00:02:07.020</a></span> | <span class="t">relatively lucky if you start getting towards supervised performance but it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=132" target="_blank">00:02:12.720</a></span> | <span class="t">does happen so that's I think a pretty good indication that this is a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=139" target="_blank">00:02:19.120</a></span> | <span class="t">technique to use or at least try. So at a high level let's go through what Gen-Q</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=147" target="_blank">00:02:27.220</a></span> | <span class="t">actually does. So we start with our unstructured text over here so our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=152" target="_blank">00:02:32.360</a></span> | <span class="t">passages are text. We take a T5 model so a T5 is a model from Google and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=162" target="_blank">00:02:42.840</a></span> | <span class="t">general philosophy of T5 is that every problem in NLP is a text-to-text problem.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=169" target="_blank">00:02:49.800</a></span> | <span class="t">We'll explain that a little more in a moment but what we're doing with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=176" target="_blank">00:02:56.240</a></span> | <span class="t">this T5 model is we take our long passages, unstructured text, and use T5 to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=183" target="_blank">00:03:03.440</a></span> | <span class="t">generate queries which are these short chunks of text over here. Now these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=190" target="_blank">00:03:10.560</a></span> | <span class="t">queries are basically questions that the passage should answer. So what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=200" target="_blank">00:03:20.720</a></span> | <span class="t">end up getting are these query passage pairs. Now if you have trained a lot of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=207" target="_blank">00:03:27.200</a></span> | <span class="t">buying coder models you probably recognize that a query passage pair like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=211" target="_blank">00:03:31.040</a></span> | <span class="t">this is basically the format we need to actually train a model using multiple</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=219" target="_blank">00:03:39.920</a></span> | <span class="t">negatives ranking loss which is is actually what we do here. So we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=223" target="_blank">00:03:43.760</a></span> | <span class="t">synthetically generating these queries and then we're actually using a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=228" target="_blank">00:03:48.480</a></span> | <span class="t">supervised training method to train on those queries. So it's almost unsupervised</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=235" target="_blank">00:03:55.360</a></span> | <span class="t">because we're not needing to label data or anything here but in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=243" target="_blank">00:04:03.000</a></span> | <span class="t">reality we are actually labeling data it's just automated. So it's a bit of a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=249" target="_blank">00:04:09.640</a></span> | <span class="t">unsupervised/supervised learning technique and from that we get our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=257" target="_blank">00:04:17.440</a></span> | <span class="t">buying coder or sentence transform model at the bottom here. Now don't worry if</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=263" target="_blank">00:04:23.240</a></span> | <span class="t">none of that makes sense yet we are going to go through everything in a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=266" target="_blank">00:04:26.640</a></span> | <span class="t">more detail. So let's start at the very start with our unlabeled data. We can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=273" target="_blank">00:04:33.680</a></span> | <span class="t">describe our data as either being in domain or out of domain. So what I mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=278" target="_blank">00:04:38.640</a></span> | <span class="t">by that is for example we want to train a model that is going to allow us to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=285" target="_blank">00:04:45.480</a></span> | <span class="t">query or search through German financial documents. So in domain for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=294" target="_blank">00:04:54.080</a></span> | <span class="t">particular use case might be what we have over here. So we have German finance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=299" target="_blank">00:04:59.080</a></span> | <span class="t">news articles probably in domain and then we also have German finance</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=304" target="_blank">00:05:04.400</a></span> | <span class="t">regulation documents probably in domain. Out of domain but not too far out of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=312" target="_blank">00:05:12.000</a></span> | <span class="t">domain is English financial documents over here. So in some cases it can be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=318" target="_blank">00:05:18.800</a></span> | <span class="t">okay to train your model on some things that are slightly out of domain like in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=324" target="_blank">00:05:24.140</a></span> | <span class="t">this sort of area here if that's all you have but ideally you want things to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=329" target="_blank">00:05:29.200</a></span> | <span class="t">very specifically in your domain. And then other things like PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=334" target="_blank">00:05:34.520</a></span> | <span class="t">documentation, PyTorch whether it's in German or English it's out of domain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=339" target="_blank">00:05:39.120</a></span> | <span class="t">because it's not finance documents. Doombugs are definitely getting out of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=345" target="_blank">00:05:45.120</a></span> | <span class="t">domain here and even if we had for example something like German pirate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=349" target="_blank">00:05:49.680</a></span> | <span class="t">metal even though it's in German it's still out of domain because there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=355" target="_blank">00:05:55.080</a></span> | <span class="t">probably very little crossover between that and financial documents. So ideally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=364" target="_blank">00:06:04.160</a></span> | <span class="t">the data that we do need for training this it can be unstructured it can just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=370" target="_blank">00:06:10.760</a></span> | <span class="t">be documents or web pages but it should really be within the topic of if we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=376" target="_blank">00:06:16.960</a></span> | <span class="t">doing a German financial model we would ideally want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=383" target="_blank">00:06:23.400</a></span> | <span class="t">something like the finance news articles or the finance regulations in German.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=388" target="_blank">00:06:28.280</a></span> | <span class="t">Okay so that's in domain and out of domain and GenQ is specifically built</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=396" target="_blank">00:06:36.800</a></span> | <span class="t">for where we have a lot of in domain data but it's unstructured and like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=402" target="_blank">00:06:42.720</a></span> | <span class="t">documents or web pages as I said before. So another thing that GenQ is very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=410" target="_blank">00:06:50.720</a></span> | <span class="t">specifically built for is the what I called asymmetric semantic search. Now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=417" target="_blank">00:06:57.600</a></span> | <span class="t">asymmetric semantic search is basically where you have asymmetry between the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=424" target="_blank">00:07:04.080</a></span> | <span class="t">sizes or the length of the text between what you are querying so your search</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=428" target="_blank">00:07:08.920</a></span> | <span class="t">query and what you're searching for e.g. trying to pull from your vector database.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=434" target="_blank">00:07:14.600</a></span> | <span class="t">Okay so your queries might be very small let's say on average they are 32 words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=441" target="_blank">00:07:21.320</a></span> | <span class="t">long that's probably actually very long your queries are probably even shorter.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=444" target="_blank">00:07:24.840</a></span> | <span class="t">Imagine when you type into Google so maybe it's more like five to ten words</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=448" target="_blank">00:07:28.520</a></span> | <span class="t">at most and then what you return from Google are pretty usually little chunks of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=454" target="_blank">00:07:34.040</a></span> | <span class="t">text and web pages and so on so your passages are kind of like those chunks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=459" target="_blank">00:07:39.320</a></span> | <span class="t">of text and they're bigger. Right so there's asymmetry in the sizes between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=463" target="_blank">00:07:43.960</a></span> | <span class="t">what you are searching with and searching for. That's where you get the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=469" target="_blank">00:07:49.720</a></span> | <span class="t">asymmetric in asymmetric semantic search. Now the next point is that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=477" target="_blank">00:07:57.520</a></span> | <span class="t">we're synthetically generating queries so we have that unstructured text it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=483" target="_blank">00:08:03.040</a></span> | <span class="t">just passages but to train the model we're actually going to use a supervised</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=489" target="_blank">00:08:09.560</a></span> | <span class="t">training method and to train with an unsupervised training method we need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=496" target="_blank">00:08:16.160</a></span> | <span class="t">have queries that match up to those passages. So to generate those queries we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=504" target="_blank">00:08:24.680</a></span> | <span class="t">use a t5 model that has been fine-tuned specifically for query generation. So as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=513" target="_blank">00:08:33.360</a></span> | <span class="t">I mentioned before the philosophy of t5 is every problem is a text-to-text</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=518" target="_blank">00:08:38.320</a></span> | <span class="t">problem. So t5 is not just used for query generation we can use it we say okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=525" target="_blank">00:08:45.040</a></span> | <span class="t">translate English-German that's good and get the German translation for that. You</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=530" target="_blank">00:08:50.520</a></span> | <span class="t">can use it for scoring two sentences on how similar they are and you get like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=536" target="_blank">00:08:56.280</a></span> | <span class="t">3.8 for these two because they're relatively similar and the range there is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=540" target="_blank">00:09:00.360</a></span> | <span class="t">from 0 to 5. And then you might get a cola sentence so that is where you are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=548" target="_blank">00:09:08.320</a></span> | <span class="t">saying is this sentence correct does it make sense and the course is jumping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=554" target="_blank">00:09:14.040</a></span> | <span class="t">well it doesn't make sense so it's saying okay this is not acceptable. All</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=558" target="_blank">00:09:18.120</a></span> | <span class="t">of these although okay for example in the semantic similarity example we do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=563" target="_blank">00:09:23.680</a></span> | <span class="t">output 3.8 it's still actually text so all of this is just text-to-text and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=569" target="_blank">00:09:29.760</a></span> | <span class="t">that's a core philosophy behind t5 just an encoder decoder model everything is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=576" target="_blank">00:09:36.640</a></span> | <span class="t">handled every problem is handled text-to-text. The same applies to our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=581" target="_blank">00:09:41.440</a></span> | <span class="t">problem we have a passage and we want to generate a query for that passage okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=587" target="_blank">00:09:47.000</a></span> | <span class="t">it's just text-to-text and with t5 it might look something like this so the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=592" target="_blank">00:09:52.840</a></span> | <span class="t">passage up at the top here we have this really long you know this from Wikipedia</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=598" target="_blank">00:09:58.360</a></span> | <span class="t">and the Esper example was on GenQ just a paragraph saying the Python is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=605" target="_blank">00:10:05.360</a></span> | <span class="t">interpreted high level etc etc programming language so it's just a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=610" target="_blank">00:10:10.040</a></span> | <span class="t">little intro to Python. T5 takes this and it will say okay let's generate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=619" target="_blank">00:10:19.200</a></span> | <span class="t">three queries okay and they're randomized so it can take this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=623" target="_blank">00:10:23.100</a></span> | <span class="t">passage and apply a little bit of randomness and generate different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=626" target="_blank">00:10:26.200</a></span> | <span class="t">queries so we get this define Python program what is Python program and what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=633" target="_blank">00:10:33.960</a></span> | <span class="t">is Python useful like they're all queries that we would probably search in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=639" target="_blank">00:10:39.160</a></span> | <span class="t">Google for example and return a passive that looks like this okay now for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=646" target="_blank">00:10:46.640</a></span> | <span class="t">we do need a t5 model that has been trained to produce queries and I'll show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=653" target="_blank">00:10:53.760</a></span> | <span class="t">you later that we are going to use a specifically trained model for that and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=658" target="_blank">00:10:58.600</a></span> | <span class="t">it is worth noting that your queries or the queries that are generated can be a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=665" target="_blank">00:11:05.840</a></span> | <span class="t">little bit noisy and you might maybe we'll see an example later of this what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=669" target="_blank">00:11:09.520</a></span> | <span class="t">I mean by noisy is that sometimes they can be nonsensical or and they're just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=675" target="_blank">00:11:15.480</a></span> | <span class="t">weird queries and like not good quality queries and that is probably the main</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=682" target="_blank">00:11:22.240</a></span> | <span class="t">issue with GenQ that you need to be aware of is that because we're generating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=688" target="_blank">00:11:28.560</a></span> | <span class="t">queries using a language generation model and that's pretty much the only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=692" target="_blank">00:11:32.320</a></span> | <span class="t">step in in generating the the training data if there's any noise that will be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=700" target="_blank">00:11:40.520</a></span> | <span class="t">obviously translated into the performance of our model later on that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=704" target="_blank">00:11:44.240</a></span> | <span class="t">we are training and will obviously make it make the performance less than it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=711" target="_blank">00:11:51.340</a></span> | <span class="t">could be if the generate queries were all perfect right but that's to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=716" target="_blank">00:11:56.000</a></span> | <span class="t">expected nonetheless it's in most cases I think works pretty well so let's have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=722" target="_blank">00:12:02.200</a></span> | <span class="t">a look at a an example of this in Python so here we have the generation code for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=729" target="_blank">00:12:09.480</a></span> | <span class="t">just one example so this paragraph here okay so I'm taking this example from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=734" target="_blank">00:12:14.920</a></span> | <span class="t">spy.net web page on GenQ so all we're doing here is we're downloading a model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=742" target="_blank">00:12:22.880</a></span> | <span class="t">we're using a be a model over here that has been trained specifically for this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=747" target="_blank">00:12:27.360</a></span> | <span class="t">although as far as I know it's been trained for GPL and not GenQ but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=756" target="_blank">00:12:36.140</a></span> | <span class="t">nonetheless this works for this we initialize tokenizer and a model using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=763" target="_blank">00:12:43.720</a></span> | <span class="t">the transformers library here and we're using t5 for conditional generation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=769" target="_blank">00:12:49.920</a></span> | <span class="t">basically to generate text this is our import text and it's just the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=777" target="_blank">00:12:57.720</a></span> | <span class="t">paragraph we saw before and all we're going to do is we're going to create our input IDs by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=783" target="_blank">00:13:03.120</a></span> | <span class="t">tokenizing text and then we're going to generate three sequences here and down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=793" target="_blank">00:13:13.600</a></span> | <span class="t">here all I'm doing is decoding the sentences or sequences that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=799" target="_blank">00:13:19.320</a></span> | <span class="t">generated into text and I think this is the same example this is where I</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=807" target="_blank">00:13:27.560</a></span> | <span class="t">actually pulled the example that you saw before from so we generate these queries</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=811" target="_blank">00:13:31.320</a></span> | <span class="t">we get find Python program what is Python used for what is Python program okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=816" target="_blank">00:13:36.240</a></span> | <span class="t">that that's all there is to the query generation step okay so not really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=824" target="_blank">00:13:44.640</a></span> | <span class="t">complicated we just need to do it for a lot of queries or a lot of passages okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=829" target="_blank">00:13:49.120</a></span> | <span class="t">so that's the query generation step and what we get after query generation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=834" target="_blank">00:13:54.200</a></span> | <span class="t">obviously is a set of a query passage pairs then we can use those to fine-tune</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=841" target="_blank">00:14:01.200</a></span> | <span class="t">our model now fine-tuning our model we use multiple native ranking loss now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=847" target="_blank">00:14:07.280</a></span> | <span class="t">there's sort of relatively abstract animation going through what MNR is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=853" target="_blank">00:14:13.360</a></span> | <span class="t">actually doing so MNR at a high level works by placing all those pairs that we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=859" target="_blank">00:14:19.660</a></span> | <span class="t">created the query passage pairs into batches okay and to each one of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=866" target="_blank">00:14:26.200</a></span> | <span class="t">batches you imagine your query at position 0 should have the high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=871" target="_blank">00:14:31.720</a></span> | <span class="t">similarity score with your passage at position 0 because they're the pair</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=876" target="_blank">00:14:36.960</a></span> | <span class="t">right but then you have a batch so you're actually going to compare the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=881" target="_blank">00:14:41.040</a></span> | <span class="t">similarity between the query of session 0 and the passage of position 1 and 2</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=888" target="_blank">00:14:48.880</a></span> | <span class="t">and 3 and 4 and so on and for each batch the model weights are going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=895" target="_blank">00:14:55.520</a></span> | <span class="t">optimized so that the pair in position 0 have the highest similarity and for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=903" target="_blank">00:15:03.920</a></span> | <span class="t">example query 0 and query 3 or 4 or 5 and so on have a lowest similarity</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=910" target="_blank">00:15:10.840</a></span> | <span class="t">right and we're not going to go super in-depth on MNR here because we've covered it before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=919" target="_blank">00:15:19.000</a></span> | <span class="t">and I'll make sure there's a link to that actual article and video in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=923" target="_blank">00:15:23.400</a></span> | <span class="t">description but at a high level it's basically just a ranking optimization we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=931" target="_blank">00:15:31.760</a></span> | <span class="t">are optimizing so that the pairs that should be together those blocks that you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=937" target="_blank">00:15:37.760</a></span> | <span class="t">see that are more obvious in the you know the diagonal line in that batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=942" target="_blank">00:15:42.640</a></span> | <span class="t">those should have the highest similarity scores okay so with that we will have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=953" target="_blank">00:15:53.280</a></span> | <span class="t">buying coder that has been fine-tuned to our specific use case now let's have a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=958" target="_blank">00:15:58.440</a></span> | <span class="t">look at the actual code that we can use to do that so the very first step that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=964" target="_blank">00:16:04.960</a></span> | <span class="t">we'll need to go through is actually getting our data so to get our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=970" target="_blank">00:16:10.480</a></span> | <span class="t">we're just going to use the squad data set the reason using this is because the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=975" target="_blank">00:16:15.360</a></span> | <span class="t">test set of this has both the questions and context pairs so we can look or we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=982" target="_blank">00:16:22.960</a></span> | <span class="t">can assess the quality of our model at the end of this I'm just checking here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=990" target="_blank">00:16:30.880</a></span> | <span class="t">okay a lot of these contexts are duplicated because we have a sample of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=996" target="_blank">00:16:36.760</a></span> | <span class="t">one context we might have 30 questions so all we're doing here is removing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1001" target="_blank">00:16:41.480</a></span> | <span class="t">those duplicates so that we just have the passages so we can see that the the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1007" target="_blank">00:16:47.480</a></span> | <span class="t">final length or the final number of passages that we have is just under 19,000</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1013" target="_blank">00:16:53.160</a></span> | <span class="t">here which it's not that many for I think for a lot of use cases if you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1017" target="_blank">00:16:57.760</a></span> | <span class="t">using unstructured data you can probably get more but in this case it does work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1023" target="_blank">00:17:03.040</a></span> | <span class="t">very well with just a small amount but it's a very generic data set so for more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1031" target="_blank">00:17:11.560</a></span> | <span class="t">specific use cases you maybe you might want to have more data maybe not you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1037" target="_blank">00:17:17.280</a></span> | <span class="t">just have to sort of play around with it and see what works so to generate the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1046" target="_blank">00:17:26.080</a></span> | <span class="t">queries you already saw before what we were doing so all we're doing is loading</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1052" target="_blank">00:17:32.200</a></span> | <span class="t">this model again tokenize it and the model I was setting the model to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1057" target="_blank">00:17:37.080</a></span> | <span class="t">evaluation so for example it's only normalization layers in there they are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1063" target="_blank">00:17:43.560</a></span> | <span class="t">set to that evaluation mode ready for inference so I'm gonna shoot that and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1074" target="_blank">00:17:54.240</a></span> | <span class="t">move on to the inference set where we are going to generate the queries for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1081" target="_blank">00:18:01.480</a></span> | <span class="t">our pairs for our passages so here I'm TQDM we're just using this as a progress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1088" target="_blank">00:18:08.920</a></span> | <span class="t">bar nothing fancy going on there it's just so we can actually see the progress</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1095" target="_blank">00:18:15.400</a></span> | <span class="t">because it can take a little bit of time particularly if you have a very large</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1098" target="_blank">00:18:18.920</a></span> | <span class="t">amount of data we're setting to no grads so we're not calculating the gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1105" target="_blank">00:18:25.000</a></span> | <span class="t">of our model because it takes more time we're not updating or optimizing the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1109" target="_blank">00:18:29.640</a></span> | <span class="t">model we're just using it for inference here so yeah and then what we need to do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1116" target="_blank">00:18:36.480</a></span> | <span class="t">is get our passage so for P in TQDM passages we are doing that so if I show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1128" target="_blank">00:18:48.360</a></span> | <span class="t">you here so look at passive is zero just one example run this okay and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1147" target="_blank">00:19:07.440</a></span> | <span class="t">just our passage long chunk of text so we're going through those if there's any</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1153" target="_blank">00:19:13.640</a></span> | <span class="t">tab characters which I generally don't think there are but maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1158" target="_blank">00:19:18.160</a></span> | <span class="t">there's the odd one I'm going to replace those because later we're going to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1162" target="_blank">00:19:22.400</a></span> | <span class="t">using a tab separated values for a TSV file for storing our pairs and obviously</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1170" target="_blank">00:19:30.000</a></span> | <span class="t">if we have more than one tab in those pairs separating the query and the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1174" target="_blank">00:19:34.520</a></span> | <span class="t">passage it's going to mess up the formatting of the file so I'm just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1179" target="_blank">00:19:39.760</a></span> | <span class="t">removing those places and spaces just in case then creating the input IDs using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1185" target="_blank">00:19:45.920</a></span> | <span class="t">tokenizer encode as we did before then we're generating three queries per</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1191" target="_blank">00:19:51.440</a></span> | <span class="t">passage we decode the queries to human readable language so so we can read it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1200" target="_blank">00:20:00.760</a></span> | <span class="t">and so the next model can actually can tokenize that text and understand it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1207" target="_blank">00:20:07.840</a></span> | <span class="t">otherwise we're using token IDs from another model which can't be read by our</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1213" target="_blank">00:20:13.480</a></span> | <span class="t">next buying code a model one we're fine - so we decode them into human language</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1221" target="_blank">00:20:21.760</a></span> | <span class="t">and then we are going to add the pairs so that's our query just in case any tab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1228" target="_blank">00:20:28.640</a></span> | <span class="t">characters end up in there we're generating them we just replace any type</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1233" target="_blank">00:20:33.520</a></span> | <span class="t">of character space again and then we use a tab character to separate the query</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1237" target="_blank">00:20:37.920</a></span> | <span class="t">from our passage okay and then what I'm doing here is I'm saying every 1024</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1247" target="_blank">00:20:47.000</a></span> | <span class="t">pairs we create I want to save that I'll write that to file okay and then we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1252" target="_blank">00:20:52.880</a></span> | <span class="t">increase the file count which is because what every new file is going to save as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1260" target="_blank">00:21:00.520</a></span> | <span class="t">pairs for example first one be pairs 0 and it'll be pairs 1 and pairs 2 and so on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1265" target="_blank">00:21:05.240</a></span> | <span class="t">okay and then we just reset or refresh the pairs list finally if we because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1275" target="_blank">00:21:15.040</a></span> | <span class="t">here we're doing it in batches of 1024 maybe the final batch only has 600 pairs</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1281" target="_blank">00:21:21.960</a></span> | <span class="t">in there I'm just saying if pairs is not non-e.g. the list is not empty I want you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1287" target="_blank">00:21:27.400</a></span> | <span class="t">to save that final batch okay and with that we've generated our data so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1294" target="_blank">00:21:34.680</a></span> | <span class="t">the generative or query generation step and we can then move on to the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1302" target="_blank">00:21:42.800</a></span> | <span class="t">fine-tuning of the file encoder model so to do that obviously we're in a new</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1309" target="_blank">00:21:49.520</a></span> | <span class="t">notebook now so first thing I want to do is I get a list of all the files or the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1315" target="_blank">00:21:55.200</a></span> | <span class="t">pair files like before so so we're doing here we saved it into the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1320" target="_blank">00:22:00.960</a></span> | <span class="t">directory and they're all .tsv files</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1325" target="_blank">00:22:05.720</a></span> | <span class="t">then because we're going to use sentence transformers to train here we need to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1331" target="_blank">00:22:11.320</a></span> | <span class="t">import the input example object and this is just a specific object type used by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1337" target="_blank">00:22:17.400</a></span> | <span class="t">the sentence transformers library just a standardized format so that we can easily</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1343" target="_blank">00:22:23.400</a></span> | <span class="t">read data that we're going to train with so all we're doing here is a looping</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1349" target="_blank">00:22:29.200</a></span> | <span class="t">through all of those files we're opening all of them reading all the lines that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1354" target="_blank">00:22:34.120</a></span> | <span class="t">all the pairs and here if there's no tab character in the line we're just kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1362" target="_blank">00:22:42.480</a></span> | <span class="t">avoiding it just in case for whatever reason the tab character isn't in there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1369" target="_blank">00:22:49.160</a></span> | <span class="t">and then here we're splitting getting the query and passage and we're creating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1377" target="_blank">00:22:57.680</a></span> | <span class="t">the input example and we're appending that to pairs so we have this big list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1381" target="_blank">00:23:01.840</a></span> | <span class="t">of input examples of our queries and passages okay and then we set up the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1388" target="_blank">00:23:08.320</a></span> | <span class="t">data loader for multiple negative ranking loss we've done this before but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1394" target="_blank">00:23:14.360</a></span> | <span class="t">new to you all so we're gonna go through it so I'm using a batch size of 24 with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1399" target="_blank">00:23:19.840</a></span> | <span class="t">MNR the greater the batch size the better generally because you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1405" target="_blank">00:23:25.280</a></span> | <span class="t">basically making it harder for the model because if you have more pairs in that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1410" target="_blank">00:23:30.240</a></span> | <span class="t">batch the harder is going to be to rank that one pair that is a correct correct</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1416" target="_blank">00:23:36.680</a></span> | <span class="t">pair at number position number one all right there's only for example two in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1421" target="_blank">00:23:41.640</a></span> | <span class="t">your batch your model has like a 50/50 chance if it's just guessing of ranking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1426" target="_blank">00:23:46.820</a></span> | <span class="t">the correct pair as position one if there's a hundred in your batch it has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1432" target="_blank">00:23:52.920</a></span> | <span class="t">pretty small chance of actually guessing that correctly okay so that's why we try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1441" target="_blank">00:24:01.080</a></span> | <span class="t">and use a larger batch size but obviously it would depend on your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1445" target="_blank">00:24:05.800</a></span> | <span class="t">available compute that you have and then we are going to use this no duplicate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1452" target="_blank">00:24:12.800</a></span> | <span class="t">data loader from sentence transformers so this is a specifically built to avoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1458" target="_blank">00:24:18.280</a></span> | <span class="t">having duplicate queries or context in your queries or patches sorry in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1467" target="_blank">00:24:27.240</a></span> | <span class="t">batch because obviously if you're trying to assess or you're trying to rank your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1473" target="_blank">00:24:33.280</a></span> | <span class="t">query and passages correctly and you have duplicate passages in there your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1478" target="_blank">00:24:38.840</a></span> | <span class="t">models won't get confused and it can't actually rank them correctly so we avoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1483" target="_blank">00:24:43.520</a></span> | <span class="t">having duplicates in there using this and then we are just going to define the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1490" target="_blank">00:24:50.920</a></span> | <span class="t">bi-encoder model that we're going to be fine-tuning so I'm using NPNET model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1495" target="_blank">00:24:55.320</a></span> | <span class="t">here NPNET is generally quite good as a sentence transformer bi-encoder model so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1502" target="_blank">00:25:02.040</a></span> | <span class="t">it's a good one to use we are using the mean token or mean pooling method here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1510" target="_blank">00:25:10.080</a></span> | <span class="t">so all the word embeddings that the model outputs are being compressed into</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1515" target="_blank">00:25:15.320</a></span> | <span class="t">a single sentence embedding by taking the average across all of the dimensions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1521" target="_blank">00:25:21.720</a></span> | <span class="t">and I'm putting those both together the the actual transform model followed by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1526" target="_blank">00:25:26.040</a></span> | <span class="t">the pooling layer that's great our bi-encoder model and then after we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1532" target="_blank">00:25:32.280</a></span> | <span class="t">initialize our model we can initialize the MNR loss function super easy again</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1537" target="_blank">00:25:37.840</a></span> | <span class="t">with sentence transformers all we do is losses multiple negative ranking loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1542" target="_blank">00:25:42.440</a></span> | <span class="t">and then pass the model in there and then we train I put single epoch here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1548" target="_blank">00:25:48.240</a></span> | <span class="t">we're actually going to train you can train for a single epoch or I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1552" target="_blank">00:25:52.800</a></span> | <span class="t">that's what they do in the GenQ paper but I've also seen good results from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1561" target="_blank">00:26:01.120</a></span> | <span class="t">using 3 epochs here which is I think the default in the sentence transformers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1568" target="_blank">00:26:08.800</a></span> | <span class="t">documentation so you can go single epoch maybe try it see if it works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1574" target="_blank">00:26:14.640</a></span> | <span class="t">otherwise go with three epochs in this case I use three okay here ignore that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1582" target="_blank">00:26:22.280</a></span> | <span class="t">so we spit we pass our loader loss like typical sentence transformers training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1589" target="_blank">00:26:29.920</a></span> | <span class="t">here and then I saved a model as mpnet GenQ squad okay we warm up for 10% of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1597" target="_blank">00:26:37.160</a></span> | <span class="t">those training sets and then yep the model is saved in that directory and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1604" target="_blank">00:26:44.640</a></span> | <span class="t">can just load it as it would any other sentence transform model so I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1609" target="_blank">00:26:49.920</a></span> | <span class="t">that's it for this walkthrough what I'm going to do is in a separate video we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1616" target="_blank">00:26:56.840</a></span> | <span class="t">have a look at how we can test this model and evaluate it so that'll be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1623" target="_blank">00:27:03.440</a></span> | <span class="t">interesting I'll release it pretty soon after this so I hope that's been useful</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=J0cntjLKpmU&t=1628" target="_blank">00:27:08.640</a></span> | <span class="t">thank you very much for watching and I will see you again</span></div></div></body></html>