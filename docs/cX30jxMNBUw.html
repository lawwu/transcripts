<html><head><title>Lesson 6 - Deep Learning for Coders (2020)</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
        color: #333;
    }
    .container {
        width: 95%;  /* Increased width to use more space */
        margin: auto;
        overflow: auto;  /* Added to handle overflow by adding a scrollbar if necessary */
    }
    h2, h3 {
        color: #333;
        text-align: center;
    }
    a {
        color: #0000FF;  /* Traditional blue color for links */
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    img {
        display: block;
        margin: auto;
        max-width: 100%;
    }
    .c {
        margin: 10px 0;
    }
    .s, .t {
        display: inline-block;
        margin-right: 5px;
    }
    .max-width {
        max-width: 800px;
        margin: auto;
        padding-left: 20px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;  /* Ensure text alignment is consistent */
    }
    tr:nth-child(even) {
        background-color: #f2f2f2;
    }
    tr:nth-child(odd) {
        background-color: #e6e6e6;
    }
</style>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-69VLBMTTP0"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-69VLBMTTP0');
    </script>
    </head><body><div class='container'><a href="index.html">back to index</a><h2>Lesson 6 - Deep Learning for Coders (2020)</h2><a href="https://www.youtube.com/watch?v=cX30jxMNBUw"><img src="https://i.ytimg.com/vi_webp/cX30jxMNBUw/maxresdefault.webp" style="width:50%;"></a><div><br></div><h3>Chapters</h3><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=0">0:0</a> <Untitled Chapter 1><br><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1870">31:10</a> Multi-label classification<br><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2915">48:35</a> One hot encoding<br><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4148">69:8</a> Regression<br><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6545">109:5</a> Embedding<br><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6640">110:40</a> Collobrative filtering from scratch<br><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7300">121:40</a> Regularisation (Data augmentation for regression)<br><br><div style="text-align: left;"><a href="./cX30jxMNBUw.html">Whisper Transcript</a> | <a href="./transcript_cX30jxMNBUw.html">Transcript Only Page</a></div><br><div style="max-width: 800px;"><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=0" target="_blank">00:00:00.000</a></span> | <span class="t">Hi everybody and welcome to lesson 6 where we're going to continue looking at training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=8" target="_blank">00:00:08.400</a></span> | <span class="t">convolutional neural networks for computer vision. And so we last looked at this the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=13" target="_blank">00:00:13.640</a></span> | <span class="t">lesson before last and specifically we were looking at how to train an image classifier</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=19" target="_blank">00:00:19.360</a></span> | <span class="t">to pick out breeds of pet, one of 37 breeds of pet. And we've gotten as far as training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=26" target="_blank">00:00:26.660</a></span> | <span class="t">a model but we also had to look and figure out what loss function was actually being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=32" target="_blank">00:00:32.460</a></span> | <span class="t">used in this model. And so we talked about cross entropy loss which is actually a really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=37" target="_blank">00:00:37.660</a></span> | <span class="t">important concept and some of the things we're talking about today depend a bit on you understanding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=42" target="_blank">00:00:42.560</a></span> | <span class="t">this concept. So if you were at all unsure about where we got to with that go back and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=48" target="_blank">00:00:48.480</a></span> | <span class="t">have another look have a look at the questionnaire in particular and make sure that you're comfortable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=53" target="_blank">00:00:53.840</a></span> | <span class="t">with cross entropy loss. If you're not you may want to go back to the 04 MNIST basics</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=60" target="_blank">00:01:00.240</a></span> | <span class="t">notebook and remind yourself about MNIST loss because it's very very similar that's what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=64" target="_blank">00:01:04.640</a></span> | <span class="t">we built on to build up cross entropy loss. So having trained our model the next thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=71" target="_blank">00:01:11.840</a></span> | <span class="t">we're going to do is look at model interpretation. There's not much point having a model if you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=77" target="_blank">00:01:17.200</a></span> | <span class="t">don't see what it's doing. And one thing we can do is use a confusion matrix which in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=85" target="_blank">00:01:25.160</a></span> | <span class="t">this case is not terribly helpful. There's kind of a few too many and it's not too bad</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=89" target="_blank">00:01:29.320</a></span> | <span class="t">we can kind of see some colored areas. And so this diagonal here are all the ones that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=93" target="_blank">00:01:33.280</a></span> | <span class="t">are classified correctly. So for Persians there were 31 classified as Persians. But</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=100" target="_blank">00:01:40.440</a></span> | <span class="t">we can see there's some bigger numbers here like Siamese six were misclassified they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=105" target="_blank">00:01:45.160</a></span> | <span class="t">actually considered a Berman. But for when you've got a lot of classes like this it might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=113" target="_blank">00:01:53.440</a></span> | <span class="t">be better instead to use the most confused method and that tells you the combinations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=122" target="_blank">00:02:02.560</a></span> | <span class="t">which it got wrong the most often. In other words which numbers are the biggest so actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=126" target="_blank">00:02:06.960</a></span> | <span class="t">here's the biggest one ten and that's confusing an American pit bull terrier or a Staffordshire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=133" target="_blank">00:02:13.960</a></span> | <span class="t">bull terrier that's happened ten times. And ragdoll is getting confused with the Berman</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=139" target="_blank">00:02:19.880</a></span> | <span class="t">eight times. And so I'm not a dog or cat expert and so I don't know what this stuff means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=147" target="_blank">00:02:27.880</a></span> | <span class="t">so I looked it up on the internet and I found that American pit bull terriers and Staffordshire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=152" target="_blank">00:02:32.320</a></span> | <span class="t">bull terriers are almost identical that I think they sometimes have a slightly different</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=156" target="_blank">00:02:36.600</a></span> | <span class="t">colored nose I remember correctly. And ragdolls and Berman's are types of cats that are so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=162" target="_blank">00:02:42.920</a></span> | <span class="t">similar to each other that this whole long threads on cat lover forums about is this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=167" target="_blank">00:02:47.040</a></span> | <span class="t">a ragdoll or is this a Berman and experts disagreeing with each other. So no surprise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=172" target="_blank">00:02:52.600</a></span> | <span class="t">that these things are getting confused. So when you see your model making sensible mistakes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=179" target="_blank">00:02:59.620</a></span> | <span class="t">the kind of mistakes that humans make that's a pretty good sign that it's picking up the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=183" target="_blank">00:03:03.440</a></span> | <span class="t">right kind of stuff and that the kinds of errors you're getting also might be pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=187" target="_blank">00:03:07.600</a></span> | <span class="t">tricky to fix. But you know let's see if we can make it better. And one way to try and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=195" target="_blank">00:03:15.880</a></span> | <span class="t">make it better is to improve our learning rate. Why would we want to improve the learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=201" target="_blank">00:03:21.920</a></span> | <span class="t">rate? Well one thing we'd like to do is to try to train it faster, get more done in less</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=208" target="_blank">00:03:28.080</a></span> | <span class="t">epochs. And so one way to do that would be to call our fine-tune method with a higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=215" target="_blank">00:03:35.360</a></span> | <span class="t">learning rate. So last time we used the default which I think is, there you go, 1 in egg 2.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=229" target="_blank">00:03:49.800</a></span> | <span class="t">And so if we pump that up to 0.1 it's going to jump further each time. So remember the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=234" target="_blank">00:03:54.680</a></span> | <span class="t">learning rate and if you've forgotten this have a look again at notebook 4. That's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=239" target="_blank">00:03:59.520</a></span> | <span class="t">thing we multiply the gradients by to decide how far to step. And unfortunately when we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=245" target="_blank">00:04:05.820</a></span> | <span class="t">use this higher learning rate the error rate goes from 0.083 epochs to 0.83 so we're getting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=256" target="_blank">00:04:16.760</a></span> | <span class="t">the vast majority of them wrong now. So that's not a good sign. So why did that happen? Well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=262" target="_blank">00:04:22.400</a></span> | <span class="t">what happened is rather than this gradual move towards the minimum, we had this thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=270" target="_blank">00:04:30.840</a></span> | <span class="t">where we step too far and we get further, further away. So when you see this happening</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=278" target="_blank">00:04:38.580</a></span> | <span class="t">which looks in practice like this, your error rate getting worse right from the start, that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=284" target="_blank">00:04:44.360</a></span> | <span class="t">a sign your learning rate is too high. So we need to find something just right, not</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=289" target="_blank">00:04:49.160</a></span> | <span class="t">too small that we take tiny jumps and it takes forever and not too big that we you know either</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=295" target="_blank">00:04:55.680</a></span> | <span class="t">get worse and worse or we just jump backwards and forwards quite slowly. So to find a good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=301" target="_blank">00:05:01.840</a></span> | <span class="t">learning rate we can use something that the researcher Leslie Smith came up with called</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=306" target="_blank">00:05:06.800</a></span> | <span class="t">the learning rate finder. And the learning rate finder is pretty simple. All we do, remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=313" target="_blank">00:05:13.800</a></span> | <span class="t">when we do stochastic gradient descent, we look at one mini batch at a time or a few</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=319" target="_blank">00:05:19.080</a></span> | <span class="t">images in this case at a time, find the gradient for that set of images for the mini batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=324" target="_blank">00:05:24.800</a></span> | <span class="t">and jump, step our weights based on the learning rate and the gradient. Well what Leslie Smith</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=332" target="_blank">00:05:32.600</a></span> | <span class="t">said was okay let's do the very first mini batch at a really, really low learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=337" target="_blank">00:05:37.120</a></span> | <span class="t">like 10 to the minus 7 and then let's increase by a little bit. They're like maybe 25% higher</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=346" target="_blank">00:05:46.560</a></span> | <span class="t">and do another step and then 25% higher and do another step. So these are not epochs,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=353" target="_blank">00:05:53.880</a></span> | <span class="t">these are just a single a simple mini batch and then we can plot on this chart here. Okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=357" target="_blank">00:05:57.960</a></span> | <span class="t">at 10 to the minus 7 what was the loss and at 25% higher than that what was the loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=364" target="_blank">00:06:04.000</a></span> | <span class="t">and the 25% higher than that what was the loss. And so not surprisingly if you do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=368" target="_blank">00:06:08.080</a></span> | <span class="t">at the low learning rates the loss doesn't really come down because the learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=371" target="_blank">00:06:11.960</a></span> | <span class="t">is so small that these steps are tiny, tiny, tiny. And then gradually we get to the point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=381" target="_blank">00:06:21.320</a></span> | <span class="t">where they're big enough to make a difference and the loss starts coming down because we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=384" target="_blank">00:06:24.600</a></span> | <span class="t">plotted here the learning rate against the loss, right. So here the loss is coming down</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=391" target="_blank">00:06:31.120</a></span> | <span class="t">as we continue to increase the learning rate the loss comes down until we get to a point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=396" target="_blank">00:06:36.160</a></span> | <span class="t">where our learning rates too high and so it flattens out and then oh it's getting worse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=400" target="_blank">00:06:40.720</a></span> | <span class="t">again so here's the point above like 0.1 where we're in this territory. So what we really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=409" target="_blank">00:06:49.560</a></span> | <span class="t">want is somewhere around here where it's kind of nice and steep. So you can actually ask</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=417" target="_blank">00:06:57.540</a></span> | <span class="t">it the learning rate finder so we used LR find to get this plot we can we can get back</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=423" target="_blank">00:07:03.400</a></span> | <span class="t">from it the minimum and steep. And so steep is where was it steepest but the steepest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=428" target="_blank">00:07:08.720</a></span> | <span class="t">point was 5e neg 3 and the minimum point divided by 10 that's quite a good rule of thumb is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=437" target="_blank">00:07:17.280</a></span> | <span class="t">1e neg 2. So somewhere around this range might be pretty good. So each time you run it you'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=445" target="_blank">00:07:25.960</a></span> | <span class="t">get different values a different time we ran it we thought that maybe 3e neg 3 would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=450" target="_blank">00:07:30.080</a></span> | <span class="t">good so we picked that and you'll notice the learning rate finder is a logarithmic scale</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=455" target="_blank">00:07:35.920</a></span> | <span class="t">be careful of interpreting that. So we can now rerun the learning rate finder setting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=461" target="_blank">00:07:41.720</a></span> | <span class="t">the learning rate to a number we picked from the learning rate finder which in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=465" target="_blank">00:07:45.680</a></span> | <span class="t">was 3e neg 3. And we can see now that's looking good right we've got an 8.3% error rate after</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=473" target="_blank">00:07:53.360</a></span> | <span class="t">3 epochs. So this idea of the learning rate finder is very straightforward I can describe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=480" target="_blank">00:08:00.560</a></span> | <span class="t">it to you in a couple of sentences it doesn't require any complex math and yet it was only</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=485" target="_blank">00:08:05.200</a></span> | <span class="t">invented in 2015 which is super interesting right it just shows that there's so many interesting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=493" target="_blank">00:08:13.960</a></span> | <span class="t">things just to learn and discover. I think part of the reason perhaps for this it took</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=498" target="_blank">00:08:18.520</a></span> | <span class="t">a while is that you know engineers kind of love using lots and lots of computers. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=505" target="_blank">00:08:25.680</a></span> | <span class="t">before the learning rate finder came along people would like run lots of experiments</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=509" target="_blank">00:08:29.320</a></span> | <span class="t">on big clusters to find out which learning rate was the best rather than just doing a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=513" target="_blank">00:08:33.080</a></span> | <span class="t">batch at a time. And I think partly also the idea of having a thing where a human is in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=519" target="_blank">00:08:39.240</a></span> | <span class="t">the loop where we look at something and make a decision is also kind of unfashionable a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=523" target="_blank">00:08:43.280</a></span> | <span class="t">lot of folks in research and industry love things which are fully automated. But anyway</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=528" target="_blank">00:08:48.400</a></span> | <span class="t">it's great we now have this tool because it makes our life easier and fastai is certainly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=535" target="_blank">00:08:55.400</a></span> | <span class="t">the first library to have this and I don't know if it's still the only one to have it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=538" target="_blank">00:08:58.400</a></span> | <span class="t">built in at least to the basic the base library. So now we've got a good learning rate how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=545" target="_blank">00:09:05.760</a></span> | <span class="t">do we fine-tune the weights so so far we've just been running this fine-tune method without</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=551" target="_blank">00:09:11.360</a></span> | <span class="t">thinking much about what it's actually doing. But we did mention in chapter one lesson one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=560" target="_blank">00:09:20.600</a></span> | <span class="t">briefly basically what's happening with fine-tune what is transfer learning doing. And before</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=568" target="_blank">00:09:28.820</a></span> | <span class="t">we look at that let's take a question. Is the learning rate plot in LR find plotted against</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=577" target="_blank">00:09:37.880</a></span> | <span class="t">one single mini batch? No it's not it's just it's actually just the standard kind of walking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=589" target="_blank">00:09:49.800</a></span> | <span class="t">through the walking through the data loader so just getting the usual mini batches of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=597" target="_blank">00:09:57.400</a></span> | <span class="t">the shuffled data. And so it's kind of just normal training and the only thing that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=601" target="_blank">00:10:01.600</a></span> | <span class="t">being different is that we're increasing the learning rate a little bit after each mini</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=607" target="_blank">00:10:07.160</a></span> | <span class="t">batch and and keeping track of it. Along with that is is the network reset to the initial</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=618" target="_blank">00:10:18.720</a></span> | <span class="t">status after each trial? No certainly not we actually want to see how it learns we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=626" target="_blank">00:10:26.520</a></span> | <span class="t">to see it improving so we don't reset it to its initial state until we're done. So at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=633" target="_blank">00:10:33.640</a></span> | <span class="t">the end of it we go back to the random weights we started with or whatever the weights were</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=637" target="_blank">00:10:37.440</a></span> | <span class="t">at the time we ran this. So what we're seeing here is something that's actually the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=645" target="_blank">00:10:45.600</a></span> | <span class="t">learning that's happening as we at the same time increase the learning rate. Why would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=653" target="_blank">00:10:53.640</a></span> | <span class="t">an ideal learning rate found with a single mini batch at the start of training keep being</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=658" target="_blank">00:10:58.000</a></span> | <span class="t">a good learning rate even after several epochs and further loss reductions? Great question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=664" target="_blank">00:11:04.520</a></span> | <span class="t">it absolutely wouldn't so let's look at that too shall we? And ask one more? This is an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=674" target="_blank">00:11:14.720</a></span> | <span class="t">important point so ask is very important. For the learning rate finder why use the steepest</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=680" target="_blank">00:11:20.440</a></span> | <span class="t">and not the minimum? We certainly don't want the minimum because the minimum is the point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=686" target="_blank">00:11:26.640</a></span> | <span class="t">at which it's not learning anymore. Right so so this flat section at the bottom here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=691" target="_blank">00:11:31.800</a></span> | <span class="t">means in this mini batch it didn't get better. So we want the steepest because that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=695" target="_blank">00:11:35.920</a></span> | <span class="t">mini batch where it got the most improved and that's what we want we want the weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=700" target="_blank">00:11:40.280</a></span> | <span class="t">to be moving as fast as possible. As a rule of thumb though we do find that the minimum</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=707" target="_blank">00:11:47.000</a></span> | <span class="t">divided by 10 works pretty well that's Sylvain's favorite approach and he's generally pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=712" target="_blank">00:11:52.760</a></span> | <span class="t">spot-on with that so that's why we actually print out those two things. lr min is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=719" target="_blank">00:11:59.000</a></span> | <span class="t">the minimum divided by 10 and steepest point is suggests the steepest point. Great good</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=728" target="_blank">00:12:08.480</a></span> | <span class="t">questions all. So remind ourselves what transfer learning does. So with transfer learning remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=736" target="_blank">00:12:16.880</a></span> | <span class="t">what our neural network is. It's a bunch of linear models basically with with activation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=746" target="_blank">00:12:26.360</a></span> | <span class="t">functions between them and our activation functions are generally values rectified linear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=752" target="_blank">00:12:32.280</a></span> | <span class="t">units. If any of this is fuzzy have a look at the zero for notebook again to remind yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=761" target="_blank">00:12:41.800</a></span> | <span class="t">And so each of those linear layers has a bunch of parameters to the whole neural network has</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=767" target="_blank">00:12:47.320</a></span> | <span class="t">a bunch of parameters. And so after we train a neural network on something like ImageNet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=776" target="_blank">00:12:56.120</a></span> | <span class="t">we have a whole bunch of parameters that aren't random anymore they're actually useful for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=779" target="_blank">00:12:59.880</a></span> | <span class="t">something. And we've also seen that the early layers seem to learn about fairly general ideas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=787" target="_blank">00:13:07.080</a></span> | <span class="t">like radiance and edges and the later layers learn about more sophisticated ideas like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=792" target="_blank">00:13:12.520</a></span> | <span class="t">what are eyes look like or what is fur look like or what is text look like. So with transfer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=798" target="_blank">00:13:18.520</a></span> | <span class="t">learning we take a model so in other words a set of parameters which has already been</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=803" target="_blank">00:13:23.520</a></span> | <span class="t">trained something like ImageNet. We throw away the very last layer because the very</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=808" target="_blank">00:13:28.960</a></span> | <span class="t">last layer is the bit that specifically says which one of those in the case of ImageNet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=813" target="_blank">00:13:33.600</a></span> | <span class="t">1000 categories is this an image in. We throw that away and we replace it with random weights</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=821" target="_blank">00:13:41.240</a></span> | <span class="t">sometimes with more than one layer of random weights and then we train that. Now yes.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=831" target="_blank">00:13:51.200</a></span> | <span class="t">Oh I just wanted to make a comment and that's that I think the learning rate finder I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=838" target="_blank">00:13:58.200</a></span> | <span class="t">after you learn about it the idea almost seems kind of so simple or approximate that it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=844" target="_blank">00:14:04.200</a></span> | <span class="t">like wait this shouldn't work like or you know shouldn't you have to do something more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=849" target="_blank">00:14:09.000</a></span> | <span class="t">more complicated or more precise that it's like I just want to highlight that this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=853" target="_blank">00:14:13.160</a></span> | <span class="t">a very surprising result that some kind of a such a simple approximate method would be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=859" target="_blank">00:14:19.400</a></span> | <span class="t">so helpful. Yeah I would particularly say it's surprising to people who are not practitioners</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=865" target="_blank">00:14:25.680</a></span> | <span class="t">or have not been practitioners for long. I've noticed that a lot of my students at USF have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=876" target="_blank">00:14:36.680</a></span> | <span class="t">a tendency to kind of jump in to try to doing something very complex where they account</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=880" target="_blank">00:14:40.320</a></span> | <span class="t">for every possible imperfection from the start and it's very rare that that's necessary so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=885" target="_blank">00:14:45.560</a></span> | <span class="t">one of the cool things about this is it's good example of trying the easiest thing first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=890" target="_blank">00:14:50.440</a></span> | <span class="t">and seeing how well it works. And this was a very big innovation when it came out that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=895" target="_blank">00:14:55.920</a></span> | <span class="t">I think it's kind of easy to take for granted now but this was super super helpful when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=900" target="_blank">00:15:00.600</a></span> | <span class="t">it was it was super helpful and it was also nearly entirely ignored. None of the research</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=907" target="_blank">00:15:07.320</a></span> | <span class="t">community cared about it and it wasn't until fast AI I think in our first course talked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=911" target="_blank">00:15:11.680</a></span> | <span class="t">about it that people started noticing and we had quite a few years in fact it's still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=916" target="_blank">00:15:16.880</a></span> | <span class="t">a bit the case where super fancy researchers still don't know about the learning rate finder</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=922" target="_blank">00:15:22.200</a></span> | <span class="t">and you know get kept beaten by you know first lesson fast AI students on practical problems</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=930" target="_blank">00:15:30.160</a></span> | <span class="t">because they can pick learning rates better and they can do it without a cluster of thousands</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=935" target="_blank">00:15:35.360</a></span> | <span class="t">of computers. Okay so transfer learning so we've got our pre-trained network and so it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=944" target="_blank">00:15:44.280</a></span> | <span class="t">really important every time you hear the word pre-trained network you're thinking a bunch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=947" target="_blank">00:15:47.840</a></span> | <span class="t">of parameters which have particular numeric values and go with a particular architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=954" target="_blank">00:15:54.200</a></span> | <span class="t">like resnet 34. We've thrown away the final layer and replace them with random numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=962" target="_blank">00:16:02.600</a></span> | <span class="t">and so now we want to train to fine-tune this set of parameters for a new set of images</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=968" target="_blank">00:16:08.920</a></span> | <span class="t">in this case pets. So fine-tune is the method we call to do that and to see what it does</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=978" target="_blank">00:16:18.440</a></span> | <span class="t">we can go burn.fine-tune? and we can see the source code and here is the signature of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=987" target="_blank">00:16:27.280</a></span> | <span class="t">function and so the first thing that happens is we call freeze. So freeze is actually the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=996" target="_blank">00:16:36.560</a></span> | <span class="t">method which makes it so only the last layers weights will get stepped by the optimizer.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1005" target="_blank">00:16:45.600</a></span> | <span class="t">So the gradients are calculated just for those last layers of parameters and the step is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1009" target="_blank">00:16:49.580</a></span> | <span class="t">done just for those last layer of parameters. So then we call fit and we fit for some number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1017" target="_blank">00:16:57.720</a></span> | <span class="t">of epochs which by default is 1. We don't change that very often and what that fit is doing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1027" target="_blank">00:17:07.400</a></span> | <span class="t">is it's just fitting those randomly added weights which makes sense right they're the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1032" target="_blank">00:17:12.040</a></span> | <span class="t">ones that are going to need the most work because at the time which we add them they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1036" target="_blank">00:17:16.680</a></span> | <span class="t">doing nothing at all they're just random. So that's why we spend one epoch trying to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1042" target="_blank">00:17:22.240</a></span> | <span class="t">make them better. After you've done that you now have a model which is much better than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1050" target="_blank">00:17:30.180</a></span> | <span class="t">we started with it's not random anymore. All the layers except the last are the same as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1055" target="_blank">00:17:35.240</a></span> | <span class="t">the pre-trained network the last layer has been tuned for this new data set. So the closer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1061" target="_blank">00:17:41.040</a></span> | <span class="t">you get to the right answer as you can kind of see in this picture the smaller the steps</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1066" target="_blank">00:17:46.360</a></span> | <span class="t">you want to create sorry the smaller the steps you want to take generally speaking. The next</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1071" target="_blank">00:17:51.440</a></span> | <span class="t">thing we do is we divide our learning rate by 2 and then we unfreeze so that means we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1076" target="_blank">00:17:56.760</a></span> | <span class="t">make it so that all the parameters can now be stepped and all of them will have gradients</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1081" target="_blank">00:18:01.660</a></span> | <span class="t">calculated and then we fit for some more epochs and this is something we have to pass to the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1087" target="_blank">00:18:07.600</a></span> | <span class="t">method. And so that's now going to train the whole network. So if we want to we can kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1096" target="_blank">00:18:16.860</a></span> | <span class="t">of do this by hand right and actually CNN learner will by default freeze the model for us freeze</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1107" target="_blank">00:18:27.200</a></span> | <span class="t">the parameters for us so we actually don't have to call freeze. So if we just create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1111" target="_blank">00:18:31.900</a></span> | <span class="t">a learner and then fit for a while this is three epochs of training just the last layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1120" target="_blank">00:18:40.100</a></span> | <span class="t">and so then we can just manually do it ourselves unfreeze. And so now at this point as the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1126" target="_blank">00:18:46.480</a></span> | <span class="t">question earlier suggested maybe this is not the right learning rate anymore so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1131" target="_blank">00:18:51.280</a></span> | <span class="t">run LR find again and this time you don't see the same shape you don't see this rapid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1138" target="_blank">00:18:58.160</a></span> | <span class="t">drop because it's much harder to train a model that's already pretty good. But instead you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1143" target="_blank">00:19:03.560</a></span> | <span class="t">just see a very gentle little gradient. So generally here what we do is we kind of try</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1149" target="_blank">00:19:09.840</a></span> | <span class="t">to find the bit where it starts to get worse again and go about which is about here and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1154" target="_blank">00:19:14.320</a></span> | <span class="t">go about 10 let you know multiple of 10 less than that so about 1 a neg 5 I would guess</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1159" target="_blank">00:19:19.160</a></span> | <span class="t">which yep that's what we picked. So then after unfreezing finding our new learning rate and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1165" target="_blank">00:19:25.320</a></span> | <span class="t">then we can do a bunch more and so here we are we're getting down to 5.9 percent error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1172" target="_blank">00:19:32.360</a></span> | <span class="t">which is okay but there's there's better we can do. And the reason we can do better is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1179" target="_blank">00:19:39.200</a></span> | <span class="t">that at this point here we're training the whole model at a 1 a neg 5 so 10 to the minus</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1185" target="_blank">00:19:45.800</a></span> | <span class="t">5 learning rate which doesn't really make sense because we know that the last layer</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1192" target="_blank">00:19:52.320</a></span> | <span class="t">is still not that great it's only had three epochs of training from random so it probably</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1196" target="_blank">00:19:56.640</a></span> | <span class="t">needs more work. We know that the second last layer was probably pretty specialized to image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1202" target="_blank">00:20:02.720</a></span> | <span class="t">net and less specialized to pet breeds so that probably needs a lot of work. Whereas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1207" target="_blank">00:20:07.280</a></span> | <span class="t">the early layers but kind of gradients and edges probably don't need to be changed much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1211" target="_blank">00:20:11.880</a></span> | <span class="t">at all. But what we'd really like is to have a small learning rate for the early layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1216" target="_blank">00:20:16.760</a></span> | <span class="t">and a bigger learning rate for the later layers. And this is something that we developed at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1222" target="_blank">00:20:22.160</a></span> | <span class="t">fast AI and we call it discriminative learning rates. And Jason Yasinski actually is a guy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1230" target="_blank">00:20:30.400</a></span> | <span class="t">who wrote a great paper that some of these ideas are based on which is he actually showed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1235" target="_blank">00:20:35.080</a></span> | <span class="t">that different layers of the network really want to be trained at different rates. Although</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1239" target="_blank">00:20:39.400</a></span> | <span class="t">he didn't kind of go as far as trying that out and seeing how it goes it was more of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1244" target="_blank">00:20:44.240</a></span> | <span class="t">a theoretical thing. So in fast AI if we want to do that we can pass to our learning rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1251" target="_blank">00:20:51.040</a></span> | <span class="t">rather than just passing a single number we can pass a slice. Now a slice is a special</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1258" target="_blank">00:20:58.640</a></span> | <span class="t">built-in feature of Python. It's just an object which basically can have a few different numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1264" target="_blank">00:21:04.640</a></span> | <span class="t">in it. In this case it's been passing at two numbers. And the way we read those basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1271" target="_blank">00:21:11.160</a></span> | <span class="t">what this means in fast AI is a learning rate is the very first layer will have this learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1277" target="_blank">00:21:17.320</a></span> | <span class="t">rate 10 to the minus 6. The very last layer will be 10 to the minus 4. And the layers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1282" target="_blank">00:21:22.800</a></span> | <span class="t">between the two will be kind of equal multiples. So they'll kind of be equally spaced learning</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1288" target="_blank">00:21:28.720</a></span> | <span class="t">rates from the start to the end. So here we can see basically doing our kind of own version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1298" target="_blank">00:21:38.160</a></span> | <span class="t">of fine-tune. We create the learner, we fit with that automatically frozen version, we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1305" target="_blank">00:21:45.520</a></span> | <span class="t">unfreeze, we fit some more. And so when we do that you can see this works a lot better</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1311" target="_blank">00:21:51.200</a></span> | <span class="t">we're getting down to 5.3, 5.1, 5.4 error. So that's pretty great. One thing we'll notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1319" target="_blank">00:21:59.840</a></span> | <span class="t">here is that we did kind of overshoot a bit. It seemed like more like epoch number 8 was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1325" target="_blank">00:22:05.280</a></span> | <span class="t">better. So kind of back before you know well actually let me explain something about fit</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1332" target="_blank">00:22:12.200</a></span> | <span class="t">one cycle. So fit one cycle is a bit different to just fit. So what fit one cycle does is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1340" target="_blank">00:22:20.920</a></span> | <span class="t">it actually starts at a low learning rate. It increases it gradually for the first one-third</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1349" target="_blank">00:22:29.360</a></span> | <span class="t">or so of the batches until it gets to a high learning rate. The highest, this is why it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1355" target="_blank">00:22:35.360</a></span> | <span class="t">called LR max. It's the highest learning rate we get to. And then for the remaining two-thirds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1360" target="_blank">00:22:40.520</a></span> | <span class="t">or so of the batches it gradually decreases the learning rate. And the reason for that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1366" target="_blank">00:22:46.680</a></span> | <span class="t">is just that well actually it's kind of like empirically researchers have found that works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1371" target="_blank">00:22:51.640</a></span> | <span class="t">the best. In fact this was developed again by Leslie Smith the same guy that did the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1375" target="_blank">00:22:55.340</a></span> | <span class="t">learning rate finder. Again it was a huge step you know it really dramatically accelerated</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1381" target="_blank">00:23:01.680</a></span> | <span class="t">the speed at which we can train neural networks and also made them much more accurate. And</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1386" target="_blank">00:23:06.320</a></span> | <span class="t">again the academic community basically ignored it. In fact the key publication that developed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1393" target="_blank">00:23:13.360</a></span> | <span class="t">this idea was not even did not even pass peer review. And so the reason I mention this now</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1400" target="_blank">00:23:20.960</a></span> | <span class="t">is to say that we can't we don't really just want to go back and pick the model that was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1405" target="_blank">00:23:25.280</a></span> | <span class="t">trained back here because we could probably do better because we really want to pick a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1410" target="_blank">00:23:30.880</a></span> | <span class="t">model that's got a low learning rate. But what I would generally do here is I change</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1415" target="_blank">00:23:35.640</a></span> | <span class="t">this 12 to an 8 because this is this is looking good. And then I would retrain it from scratch.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1422" target="_blank">00:23:42.680</a></span> | <span class="t">Normally you'd find a better result. You can plot the loss and you can see how the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1429" target="_blank">00:23:49.580</a></span> | <span class="t">and validation loss moved along. And you can see here that you know the error rate was</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1439" target="_blank">00:23:59.760</a></span> | <span class="t">starting to get worse here. And what you'll often see is often the validation loss will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1447" target="_blank">00:24:07.860</a></span> | <span class="t">get worse a bit before the error rate gets worse. We're not really seeing it so much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1453" target="_blank">00:24:13.480</a></span> | <span class="t">in this case but the error rate and the validation loss don't always or they're not always kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1457" target="_blank">00:24:17.740</a></span> | <span class="t">of in lockstep. So what we're plotting here is the loss but you actually kind of want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1463" target="_blank">00:24:23.840</a></span> | <span class="t">to look to see mainly what's happening with the error rate because that's actually the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1466" target="_blank">00:24:26.920</a></span> | <span class="t">thing we care about. Remember the loss is just like an approximation of what we care</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1471" target="_blank">00:24:31.480</a></span> | <span class="t">about that just happens to have a gradient that works out nicely. So how do you make</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1482" target="_blank">00:24:42.200</a></span> | <span class="t">it better now? We're already down to just 5.4 or if we'd stopped a bit earlier maybe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1489" target="_blank">00:24:49.640</a></span> | <span class="t">we could get down to 5.1 or less error. On 37 categories that's pretty remarkable. That's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1496" target="_blank">00:24:56.080</a></span> | <span class="t">a very, very good pet breed predictor. If you want to do something even better you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1502" target="_blank">00:25:02.720</a></span> | <span class="t">try creating a deeper architecture. So a deeper architecture is just literally putting more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1511" target="_blank">00:25:11.080</a></span> | <span class="t">pairs of non-activation function also known as a non-linearity followed by these little</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1515" target="_blank">00:25:15.880</a></span> | <span class="t">linear models put more pairs onto the end. And basically the number of these sets of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1521" target="_blank">00:25:21.800</a></span> | <span class="t">layers you have is the number that you'll see at the end of an architecture. So there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1526" target="_blank">00:25:26.960</a></span> | <span class="t">ResNet 18, ResNet 34, ResNet 50, so forth. Having said that you can't really pick ResNet</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1535" target="_blank">00:25:35.760</a></span> | <span class="t">19 or ResNet 38. I mean you couldn't make one but nobody's created a pre-trained version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1545" target="_blank">00:25:45.000</a></span> | <span class="t">of that for you so you won't be able to do any fine-tuning. So like you can theoretically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1550" target="_blank">00:25:50.120</a></span> | <span class="t">create any number of layers you like but in practice most of the time you'll want to pick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1557" target="_blank">00:25:57.800</a></span> | <span class="t">a model that has a pre-trained version. So you kind of have to select from the sizes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1562" target="_blank">00:26:02.760</a></span> | <span class="t">people have pre-trained and there's nothing special about these sizes they're just ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1566" target="_blank">00:26:06.580</a></span> | <span class="t">that people happen to have picked out. For the bigger models there's more parameters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1573" target="_blank">00:26:13.520</a></span> | <span class="t">and more gradients that are going to be stored on your GPU and you will get used to the idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1579" target="_blank">00:26:19.480</a></span> | <span class="t">of seeing this error unfortunately out of memory. So that's not out of memory in your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1586" target="_blank">00:26:26.360</a></span> | <span class="t">RAM that's out of memory in your GPU. Cruder is referring to the language in the system</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1592" target="_blank">00:26:32.760</a></span> | <span class="t">used for your GPU. So if that happens unfortunately you actually have to restart your notebook</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1598" target="_blank">00:26:38.540</a></span> | <span class="t">so that's kernel restart and try again and that's a really annoying thing but such is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1605" target="_blank">00:26:45.480</a></span> | <span class="t">life. One thing you can do if you get an out-of-memory error is after you've your CNN learner call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1612" target="_blank">00:26:52.720</a></span> | <span class="t">add this magic incantation to FP16. What that does is it uses for most of the operations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1621" target="_blank">00:27:01.500</a></span> | <span class="t">numbers that use half as many bits as usual so they're less accurate this half precision</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1627" target="_blank">00:27:07.000</a></span> | <span class="t">floating point or FP16 and that will use less memory and on pretty much any NVIDIA card</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1638" target="_blank">00:27:18.400</a></span> | <span class="t">created in 2020 or later and some more expensive cards even created in 2019 that's often going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1647" target="_blank">00:27:27.080</a></span> | <span class="t">to result in a two to three times speed up in terms of how long it takes as well. So</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1653" target="_blank">00:27:33.000</a></span> | <span class="t">here if I add in to FP16 and I will be seeing often much faster training and in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1662" target="_blank">00:27:42.040</a></span> | <span class="t">what I actually did is I switched to a ResNet-50 which would normally take about twice as long</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1667" target="_blank">00:27:47.200</a></span> | <span class="t">and my per epoch time has gone from 25 seconds to 26 seconds. So the fact that we used a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1674" target="_blank">00:27:54.780</a></span> | <span class="t">much bigger network and it was no slower is thanks to to FP16. But you'll see error rate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1681" target="_blank">00:28:01.120</a></span> | <span class="t">hasn't improved it's pretty similar to what it was and so it's important to realize that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1687" target="_blank">00:28:07.260</a></span> | <span class="t">just because we increase the number of layers it doesn't always get better. So it tends</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1693" target="_blank">00:28:13.180</a></span> | <span class="t">to require a bit of experimentation to find what's going to work for you and of course</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1699" target="_blank">00:28:19.280</a></span> | <span class="t">don't forget the trick is use small models for as long as possible and to do all of your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1705" target="_blank">00:28:25.920</a></span> | <span class="t">cleaning up and testing and so forth and wait until you're all done to try some bigger models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1710" target="_blank">00:28:30.800</a></span> | <span class="t">because they're going to take a lot longer. Okay questions. How do you know or suspect</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1719" target="_blank">00:28:39.740</a></span> | <span class="t">when you can quote do better? You have to always assume you can do better because you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1728" target="_blank">00:28:48.320</a></span> | <span class="t">never know. So you just have to I mean part of it though is do you need to do better or</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1734" target="_blank">00:28:54.760</a></span> | <span class="t">do you already have a good enough result to handle the actual task you're trying to do.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1740" target="_blank">00:29:00.480</a></span> | <span class="t">When people do spend too much time fiddling around with their models rather than actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1744" target="_blank">00:29:04.440</a></span> | <span class="t">trying to see whether it's already going to be super helpful. So as soon as you can actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1749" target="_blank">00:29:09.560</a></span> | <span class="t">try to use your model to do something practical the better. But yeah how much can you improve</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1756" target="_blank">00:29:16.560</a></span> | <span class="t">it? Who knows? I you know go through the techniques that we're teaching this course and try them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1763" target="_blank">00:29:23.520</a></span> | <span class="t">and see which ones help. Unless it's a problem that somebody has already tried before and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1770" target="_blank">00:29:30.960</a></span> | <span class="t">written down their results in a paper or a capital competition or something there's no</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1774" target="_blank">00:29:34.920</a></span> | <span class="t">way to know how good can. So don't forget after you do the questionnaire to check out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1784" target="_blank">00:29:44.920</a></span> | <span class="t">the further research section. And one of the things we've asked you to do here is to read</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1789" target="_blank">00:29:49.880</a></span> | <span class="t">a paper. So find the learning rate finder paper and read it and see if you can kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1797" target="_blank">00:29:57.040</a></span> | <span class="t">of connect what you read up to the things that we've learned in this lesson. And see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1802" target="_blank">00:30:02.120</a></span> | <span class="t">if you can maybe even implement your own learning rate finder you know as manually as you need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1810" target="_blank">00:30:10.000</a></span> | <span class="t">to see if you can get something that you know based on reading the paper to work yourself.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1816" target="_blank">00:30:16.940</a></span> | <span class="t">You can even look at the source code of fastai's learning rate finder of course. And then can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1823" target="_blank">00:30:23.520</a></span> | <span class="t">you make this classifier better? And so this is further research right? So maybe you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1828" target="_blank">00:30:28.200</a></span> | <span class="t">start doing some reading to see what else could you do. Have a look on the forums see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1833" target="_blank">00:30:33.200</a></span> | <span class="t">what people are trying. Have a look on the book website or the course website to see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1837" target="_blank">00:30:37.600</a></span> | <span class="t">what other people have achieved and what they did and play around. So we've got some tools</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1843" target="_blank">00:30:43.480</a></span> | <span class="t">in our toolbox now for you to experiment with. So that is that is pet breeds that is a you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1853" target="_blank">00:30:53.760</a></span> | <span class="t">know a pretty tricky computer vision classification problem. And we kind of have seen most of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1861" target="_blank">00:31:01.960</a></span> | <span class="t">the pieces of what goes into the training of it. We haven't seen how to build the actual</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1865" target="_blank">00:31:05.360</a></span> | <span class="t">architecture but other than that we've kind of worked our way up to understanding what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1869" target="_blank">00:31:09.820</a></span> | <span class="t">going on. So let's build from there into another kind of data set one that involves multi-label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1879" target="_blank">00:31:19.800</a></span> | <span class="t">classification. So what's multi-label classification? Well maybe so maybe let's look at an example.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1891" target="_blank">00:31:31.000</a></span> | <span class="t">Here is a multi-label data set where you can see that it's not just one label on each image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1896" target="_blank">00:31:36.360</a></span> | <span class="t">but sometimes there's three, bicycle, car, person. I don't actually see the car here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1901" target="_blank">00:31:41.480</a></span> | <span class="t">I guess it's being dropped out. So a multi-label data set is one where you still got one image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1907" target="_blank">00:31:47.760</a></span> | <span class="t">per row but you can have zero one two or more labels per row. So we're going to have a think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1915" target="_blank">00:31:55.280</a></span> | <span class="t">about and look at how we handle that. But first of all let's take another question.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1921" target="_blank">00:32:01.400</a></span> | <span class="t">Is dropping floating point number precision switching from FP32 to FP16 have an impact</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1930" target="_blank">00:32:10.640</a></span> | <span class="t">on final? Yes it does. Often it makes it better believe it or not. It seems like you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1943" target="_blank">00:32:23.920</a></span> | <span class="t">the kind of it's doing a little bit of rounding off is one way to give it drop some of that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1948" target="_blank">00:32:28.200</a></span> | <span class="t">precision. And so that creates a bit more bumpiness, a bit more uncertainty, bit more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1955" target="_blank">00:32:35.280</a></span> | <span class="t">you know of a stochastic nature. And you know when you introduce more slightly random stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1961" target="_blank">00:32:41.080</a></span> | <span class="t">into training it very often makes it a bit better. And so yeah FP16 training often gives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1967" target="_blank">00:32:47.800</a></span> | <span class="t">us a slightly better result but I you know I wouldn't say it's generally a big deal either</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1973" target="_blank">00:32:53.320</a></span> | <span class="t">way and certainly it's not always better. Would you say this is a bit of a pattern in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1978" target="_blank">00:32:58.240</a></span> | <span class="t">learning less exact and stochastic way? For sure not just in deep learning but machine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1989" target="_blank">00:33:09.320</a></span> | <span class="t">learning more generally. You know there's been some interesting research looking at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1993" target="_blank">00:33:13.840</a></span> | <span class="t">like matrix factorization techniques which if you want them to go super fast you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=1997" target="_blank">00:33:17.840</a></span> | <span class="t">lots of machines, you can randomization and you often when you then use the results you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2003" target="_blank">00:33:23.920</a></span> | <span class="t">often find you actually get better outcomes. Just a brief plug for the fast AI computational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2010" target="_blank">00:33:30.600</a></span> | <span class="t">linear algebra course which talks a little bit about random. Does it really? Well that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2017" target="_blank">00:33:37.160</a></span> | <span class="t">sounds like a fascinating course and look at that it's number one hit here on Google</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2023" target="_blank">00:33:43.040</a></span> | <span class="t">so easy to find. Well by somebody called Rachel Thomas. Hey that's person's got the same name</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2029" target="_blank">00:33:49.920</a></span> | <span class="t">as you Rachel Thomas. All right so how are we going to do multi-label classification?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2038" target="_blank">00:33:58.440</a></span> | <span class="t">So let's look at a data set called Pascal which is a pretty famous data set. We'll look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2042" target="_blank">00:34:02.640</a></span> | <span class="t">at the version that goes back to 2007 been around for a long time. And it comes with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2048" target="_blank">00:34:08.400</a></span> | <span class="t">a CSV file which we will read in CSV is comma separated values and let's take a look. Each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2055" target="_blank">00:34:15.320</a></span> | <span class="t">row has a file name, one or more labels and something telling you whether it's in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2061" target="_blank">00:34:21.280</a></span> | <span class="t">validation set or not. So the list of categories in each image is a space delimited string</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2068" target="_blank">00:34:28.020</a></span> | <span class="t">but it doesn't have a horse person it has a horse and a person. PD here stands for pandas.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2076" target="_blank">00:34:36.000</a></span> | <span class="t">Pandas is a really important library for any kind of data processing and you use it all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2083" target="_blank">00:34:43.520</a></span> | <span class="t">the time in machine learning and deep learning. So let's have a quick chat about it. Not a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2087" target="_blank">00:34:47.720</a></span> | <span class="t">real panda it's the name of a library and it creates things called data frames. That's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2092" target="_blank">00:34:52.720</a></span> | <span class="t">what the DF here stands for and a data frame is a table containing rows and columns. Pandas</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2098" target="_blank">00:34:58.680</a></span> | <span class="t">can also do some slightly more sophisticated things than that but we'll treat it that way</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2102" target="_blank">00:35:02.240</a></span> | <span class="t">for now. So you can read in a data frame by saying PD for pandas. Pandas read CSV, give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2108" target="_blank">00:35:08.000</a></span> | <span class="t">it a file name, you've now got a data frame you can call head to see the first few rows</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2112" target="_blank">00:35:12.400</a></span> | <span class="t">of it for instance. A data frame has a ilock integer location property which you can index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2122" target="_blank">00:35:22.320</a></span> | <span class="t">into as if it was an array, in fact it looks just like numpy. So colon means every row remember</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2130" target="_blank">00:35:30.360</a></span> | <span class="t">it's row comma column and zero means zeroth column and so here is the first column of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2136" target="_blank">00:35:36.080</a></span> | <span class="t">the data frame. You can do the exact opposite so the zeroth row and every column is going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2143" target="_blank">00:35:43.120</a></span> | <span class="t">to give us the first row and you can see the row has column headers and values. So it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2149" target="_blank">00:35:49.040</a></span> | <span class="t">a little bit different to numpy and remember if there's a comma colon or a bunch of comma</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2154" target="_blank">00:35:54.680</a></span> | <span class="t">columns at the end of indexing in numpy or pytorch or pandas whatever you can get rid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2160" target="_blank">00:36:00.960</a></span> | <span class="t">of it and these two are exactly the same. You could do the same thing here by grabbing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2168" target="_blank">00:36:08.020</a></span> | <span class="t">the column by name the first column is fname so you can say dffname you get that first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2173" target="_blank">00:36:13.360</a></span> | <span class="t">column. You can create new columns so here's a tiny little data frame I've created from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2178" target="_blank">00:36:18.120</a></span> | <span class="t">a dictionary and I could create a new column by for example adding two columns and you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2185" target="_blank">00:36:25.340</a></span> | <span class="t">can see there it is. So it's like a lot like numpy or pytorch except you have this idea</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2191" target="_blank">00:36:31.680</a></span> | <span class="t">of kind of rows and and column named columns and so it's all about kind of tabular data.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2201" target="_blank">00:36:41.080</a></span> | <span class="t">I find its API pretty unintuitive a lot of people do but it's fast and powerful so it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2206" target="_blank">00:36:46.680</a></span> | <span class="t">takes a while to get familiar with it but it's worth taking a while and the creator</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2210" target="_blank">00:36:50.020</a></span> | <span class="t">of pandas wrote a fantastic book called Python for data analysis which I've read both versions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2217" target="_blank">00:36:57.380</a></span> | <span class="t">and I found it fantastic. It doesn't just cover pandas it covers other stuff as well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2221" target="_blank">00:37:01.680</a></span> | <span class="t">like IPython and numpy and matplotlib so highly recommend this book. This is our table so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2233" target="_blank">00:37:13.440</a></span> | <span class="t">what we want to do now is construct data loaders that we can train with and we've talked about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2242" target="_blank">00:37:22.000</a></span> | <span class="t">the data block API is being a great way to create data loaders but let's use this as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2246" target="_blank">00:37:26.600</a></span> | <span class="t">an opportunity to create a data data loaders or a data so create a data block and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2251" target="_blank">00:37:31.120</a></span> | <span class="t">data loaders for this and let's try to do it like right from square one. So let's see</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2258" target="_blank">00:37:38.720</a></span> | <span class="t">exactly what's going on with data block. So first of all let's remind ourselves about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2264" target="_blank">00:37:44.640</a></span> | <span class="t">what a data set and a data loader is. A data set is an abstract idea of a class you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2273" target="_blank">00:37:53.040</a></span> | <span class="t">create a data set. A data set is anything which you can index into it like so or and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2279" target="_blank">00:37:59.040</a></span> | <span class="t">you can take the length of it like so. So for example the list of the lowercase letters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2285" target="_blank">00:38:05.140</a></span> | <span class="t">along with a number saying which lowercase letter it is I can index into it to get 0,</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2291" target="_blank">00:38:11.080</a></span> | <span class="t">a I can get the length of it to get 26 and so therefore this qualifies as a data set</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2298" target="_blank">00:38:18.440</a></span> | <span class="t">and in particular data sets normally you would expect that when you index into it you would</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2302" target="_blank">00:38:22.600</a></span> | <span class="t">get back a tuple because you've got the independent and dependent variables not necessarily always</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2310" target="_blank">00:38:30.800</a></span> | <span class="t">just two things it could be more there could be less but two is the most common. So once</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2316" target="_blank">00:38:36.700</a></span> | <span class="t">we have a data set we can pass it to a data loader we can request a particular batch size</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2326" target="_blank">00:38:46.960</a></span> | <span class="t">we can shuffle or not and so there's our data loader from A we could grab the first value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2332" target="_blank">00:38:52.480</a></span> | <span class="t">from that iterator and here is the shuffled 7 is H 4 is E 20 is U and so forth and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2340" target="_blank">00:39:00.580</a></span> | <span class="t">remember a mini batch has a bunch of a mini batch of the independent variable and a mini</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2346" target="_blank">00:39:06.520</a></span> | <span class="t">batch of the dependent variable. If you want to see how the two correspond to each other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2352" target="_blank">00:39:12.320</a></span> | <span class="t">you can use zip so if I zip passing in this list and then this list so B0 and B1 you can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2360" target="_blank">00:39:20.480</a></span> | <span class="t">see what zip does in Python is it grabs one element from each of those in turn and gives</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2366" target="_blank">00:39:26.640</a></span> | <span class="t">you back the tuples of the corresponding elements. Since we're just passing in all of the elements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2374" target="_blank">00:39:34.240</a></span> | <span class="t">of B to this function Python has a convenient shortcut for that which is just say star B</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2382" target="_blank">00:39:42.000</a></span> | <span class="t">and so star means insert into this parameter list each element of B just like we did here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2389" target="_blank">00:39:49.760</a></span> | <span class="t">so these are the same thing. So this is a very handy idiom that we use a lot in Python zip</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2396" target="_blank">00:39:56.100</a></span> | <span class="t">star something is kind of a way of like transposing something from one orientation to another.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2407" target="_blank">00:40:07.040</a></span> | <span class="t">All right so we've got a data set we've got a data loader and then what about datasets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2412" target="_blank">00:40:12.400</a></span> | <span class="t">what datasets is an object which has a training data set and a validation set dataset so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2417" target="_blank">00:40:17.960</a></span> | <span class="t">look at one. Now normally you don't start with kind of an enumeration like this like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2426" target="_blank">00:40:26.280</a></span> | <span class="t">with an independent variable and a dependent variable normally you start with like a file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2432" target="_blank">00:40:32.400</a></span> | <span class="t">name for example and then you you kind of calculate or compute or transform your file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2440" target="_blank">00:40:40.660</a></span> | <span class="t">name into an image by opening it and a label by for example looking at the file name and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2446" target="_blank">00:40:46.520</a></span> | <span class="t">grabbing something out of it. So for example we could do something similar here this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2450" target="_blank">00:40:50.320</a></span> | <span class="t">what datasets does so we could start with just the lowercase letters so this is still</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2456" target="_blank">00:40:56.200</a></span> | <span class="t">a data set right because we can index into it and we can get the length of it although</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2460" target="_blank">00:41:00.280</a></span> | <span class="t">it's not giving us tuples yet. So if we now pass that list to the datasets class and index</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2469" target="_blank">00:41:09.000</a></span> | <span class="t">into it we get back the tuple and it's actually a tuple with just one item this is how Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2475" target="_blank">00:41:15.180</a></span> | <span class="t">shows a tuple with one item is it puts it in parentheses and a comma and then nothing okay.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2480" target="_blank">00:41:20.880</a></span> | <span class="t">So in practice what we really want to do is to say like okay we'll take this and do something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2486" target="_blank">00:41:26.780</a></span> | <span class="t">to compute an independent variable and do something to compute a dependent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2490" target="_blank">00:41:30.880</a></span> | <span class="t">but here's a function we could use to compute an independent variable which is to stick</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2494" target="_blank">00:41:34.380</a></span> | <span class="t">an A on the end and our dependent variable might just be the same thing with a B on the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2498" target="_blank">00:41:38.400</a></span> | <span class="t">end. So here's two functions so for example now we can call datasets passing in A and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2506" target="_blank">00:41:46.320</a></span> | <span class="t">then we can pass in a list of transformations to do and so in this case I've just got one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2514" target="_blank">00:41:54.000</a></span> | <span class="t">which is this function add an A on the end so now if I index into it I don't get A anymore</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2518" target="_blank">00:41:58.760</a></span> | <span class="t">I get AA. If you pass multiple functions then it's going to do multiple things so here I've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2528" target="_blank">00:42:08.640</a></span> | <span class="t">got F1 then F2 AAB that's this one then that's this one and you'll see this is a list of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2535" target="_blank">00:42:15.520</a></span> | <span class="t">lists and the reason for that is that you can also pass something like this a list containing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2541" target="_blank">00:42:21.280</a></span> | <span class="t">F1 a list containing F2 and this will actually take each element of A pass it through this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2547" target="_blank">00:42:27.920</a></span> | <span class="t">list of functions and there's just one of them to give you AA and then start again and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2554" target="_blank">00:42:34.360</a></span> | <span class="t">separately pass it through this list of functions there's just one to get A B and so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2560" target="_blank">00:42:40.360</a></span> | <span class="t">actually kind of the main way we build up independent variables and dependent variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2566" target="_blank">00:42:46.680</a></span> | <span class="t">in fast AI is we start with something like a file name and we pass it through two lists</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2571" target="_blank">00:42:51.160</a></span> | <span class="t">of functions one of them will generally kind of open up the image for example and the other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2575" target="_blank">00:42:55.460</a></span> | <span class="t">one will kind of pass the file name for example and give you a independent variable and a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2580" target="_blank">00:43:00.200</a></span> | <span class="t">dependent variable. So you can then create a data loaders object from data sets by passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2587" target="_blank">00:43:07.800</a></span> | <span class="t">in the data sets and a batch size and so here you can see I've got shuffled OAIA etc OB</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2596" target="_blank">00:43:16.640</a></span> | <span class="t">IB etc so this is worth studying to make sure you understand what data sets and data loaders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2603" target="_blank">00:43:23.480</a></span> | <span class="t">are we don't often have to create them from scratch we can create a data block to do it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2608" target="_blank">00:43:28.480</a></span> | <span class="t">for us but now we can see what the data block has to do let's see how it does it so we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2615" target="_blank">00:43:35.760</a></span> | <span class="t">start by creating an empty data block so an empty data block is going to take our data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2621" target="_blank">00:43:41.460</a></span> | <span class="t">frame we're going to go back to looking at data frame which remember was this guy and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2632" target="_blank">00:43:52.800</a></span> | <span class="t">so if we pass in our data frame we can now we'll now find that this data block has created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2641" target="_blank">00:44:01.640</a></span> | <span class="t">data sets a training and a validation data set for us and if we look at the training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2648" target="_blank">00:44:08.480</a></span> | <span class="t">set it'll give us back an independent variable and a dependent variable and we'll see that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2653" target="_blank">00:44:13.920</a></span> | <span class="t">they are both the same thing so this is the first row of the table that's actually shuffled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2660" target="_blank">00:44:20.960</a></span> | <span class="t">so it's a random row of the table repeated twice and the reason for that is by default</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2666" target="_blank">00:44:26.660</a></span> | <span class="t">the data block assumes that we have two things the independent variable and the dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2671" target="_blank">00:44:31.040</a></span> | <span class="t">or the input in the target and by default it just copies it just keeps exactly whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2676" target="_blank">00:44:36.720</a></span> | <span class="t">you gave it to create the training set and the validation set by default it just randomly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2683" target="_blank">00:44:43.000</a></span> | <span class="t">splits the data with a 20% validation set so that's what's happened here so this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2690" target="_blank">00:44:50.160</a></span> | <span class="t">not much use and what we what we actually want to do if we look at X for example is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2695" target="_blank">00:44:55.400</a></span> | <span class="t">grab the the F name the file name field because we want to open this image that's going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2700" target="_blank">00:45:00.880</a></span> | <span class="t">be our independent variable and then for the label we're gonna want this here person cat</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2712" target="_blank">00:45:12.280</a></span> | <span class="t">so we can actually pass these as parameters get X and get Y functions that return the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2720" target="_blank">00:45:20.600</a></span> | <span class="t">bit of data that we want and so you can create and use a function in the same line of code</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2727" target="_blank">00:45:27.200</a></span> | <span class="t">in Python by saying lambda so lambda R means create a function doesn't have a name it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2734" target="_blank">00:45:34.080</a></span> | <span class="t">going to take a parameter called R we don't even have to say return it's going to return</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2739" target="_blank">00:45:39.200</a></span> | <span class="t">the F name column in this case and get Y is something which is a function that takes an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2747" target="_blank">00:45:47.080</a></span> | <span class="t">R and returns the labels column so now we can do the same thing called dblock.datasets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2755" target="_blank">00:45:55.080</a></span> | <span class="t">we can grab a row from that from the training set and you can see look here it is there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2759" target="_blank">00:45:59.320</a></span> | <span class="t">is the image file name and there is the space delimited list of labels so here's exactly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2768" target="_blank">00:46:08.880</a></span> | <span class="t">the same thing again but done with functions so now the one line of code above has become</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2775" target="_blank">00:46:15.200</a></span> | <span class="t">three lines of code but it does exactly the same thing okay we don't get back the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2782" target="_blank">00:46:22.480</a></span> | <span class="t">result because the training set well wait why don't we get the same result oh I know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2792" target="_blank">00:46:32.920</a></span> | <span class="t">why because it's randomly shuffle it's randomly picking a different validation set because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2798" target="_blank">00:46:38.920</a></span> | <span class="t">the random split is done differently each time so that's why we don't get the same result</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2804" target="_blank">00:46:44.360</a></span> | <span class="t">one thing to note be careful of lambdas if you want to save this data block for use later</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2811" target="_blank">00:46:51.400</a></span> | <span class="t">you won't be able to Python doesn't like saving things that contain lambdas so most of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2816" target="_blank">00:46:56.800</a></span> | <span class="t">time in the book and the course we normally use avoid lambdas for that reason because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2821" target="_blank">00:47:01.400</a></span> | <span class="t">it's often very convenient to be able to save things we use the word here serialization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2826" target="_blank">00:47:06.280</a></span> | <span class="t">that just means basically it means saving something this is not enough to open an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2835" target="_blank">00:47:15.000</a></span> | <span class="t">because we don't have the path so to turn this into so rather than just using this function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2840" target="_blank">00:47:20.700</a></span> | <span class="t">to grab the F name column we should actually use path lib to go path slash train and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2847" target="_blank">00:47:27.660</a></span> | <span class="t">column and then for the Y again the labels is not quite enough we actually have to split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2855" target="_blank">00:47:35.440</a></span> | <span class="t">on space but this is Python we can use any function we like and so then we use the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2860" target="_blank">00:47:40.240</a></span> | <span class="t">three lines of code is here and now we've got a path and a list of labels so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2867" target="_blank">00:47:47.000</a></span> | <span class="t">looking good so we want this path to be opened as an image so the data block API that's your</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2876" target="_blank">00:47:56.600</a></span> | <span class="t">pass a blocks argument where you tell it or each of the things in your tuple so there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2883" target="_blank">00:48:03.080</a></span> | <span class="t">two of them what kind of block do you need so we need an image block to open an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2889" target="_blank">00:48:09.680</a></span> | <span class="t">and then in the past we've used a category block or categorical variables but this time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2894" target="_blank">00:48:14.920</a></span> | <span class="t">we don't have a single category we've got multiple categories so we have to use a multi</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2899" target="_blank">00:48:19.480</a></span> | <span class="t">category block so once we do that and have a look we now have an 500 by 375 image as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2907" target="_blank">00:48:27.740</a></span> | <span class="t">our independent variable and as a dependent variable we have a long lists of zeros and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2914" target="_blank">00:48:34.160</a></span> | <span class="t">ones the long list of zeros and ones is the labels as a one hot encoded vector a rank</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2927" target="_blank">00:48:47.360</a></span> | <span class="t">one tensor and specifically there will be a zero in every location where in the vocab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2937" target="_blank">00:48:57.880</a></span> | <span class="t">where there is not that kind of object in this image and a one in every location where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2944" target="_blank">00:49:04.200</a></span> | <span class="t">there is so for this one there's just a person so this must be the location in the vocab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2949" target="_blank">00:49:09.660</a></span> | <span class="t">where there's a person you have any questions so one hot encoding is a very important concept</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2957" target="_blank">00:49:17.640</a></span> | <span class="t">and we didn't have to use it before right we could just have a single integer saying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2965" target="_blank">00:49:25.800</a></span> | <span class="t">which one thing is it but when we've got lots of things lots of potential labels it's it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2972" target="_blank">00:49:32.360</a></span> | <span class="t">convenient to use this one hot encoding and it's kind of what it's actually what's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2976" target="_blank">00:49:36.600</a></span> | <span class="t">to happen with them with the actual matrices anyway when we actually compare the activations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2988" target="_blank">00:49:48.440</a></span> | <span class="t">of our neural network to the target it's actually going to be comparing each one of these okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=2997" target="_blank">00:49:57.800</a></span> | <span class="t">so the categories as I mentioned is based on the vocab so we can grab the vocab from</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3004" target="_blank">00:50:04.200</a></span> | <span class="t">our data set subject and then we can say okay let's look at the first row and let's look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3011" target="_blank">00:50:11.360</a></span> | <span class="t">at the dependent variable and let's look for where the dependent variable is one okay and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3022" target="_blank">00:50:22.200</a></span> | <span class="t">then we can have a look past those indexes with a vocab and get back a list of what actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3027" target="_blank">00:50:27.160</a></span> | <span class="t">was there and again each time I run this I'm going to get different results so each time</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3033" target="_blank">00:50:33.880</a></span> | <span class="t">we run this we're going to get different results because I called dot data sets again here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3038" target="_blank">00:50:38.120</a></span> | <span class="t">so it's going to give me different train tests split and so this time it turns out that this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3042" target="_blank">00:50:42.760</a></span> | <span class="t">actually a chair and we have a question shouldn't the tensor be of integers why is it a tensor</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3050" target="_blank">00:50:50.800</a></span> | <span class="t">of floats yeah conceptually this is a tensor of integers they can only be 0 or 1 but we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3064" target="_blank">00:51:04.880</a></span> | <span class="t">are going to be using a cross-entropy style loss function but we're going to actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3071" target="_blank">00:51:11.200</a></span> | <span class="t">need to do floating point calculations on them that's going to be faster to just store</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3077" target="_blank">00:51:17.920</a></span> | <span class="t">them as float in the first place rather than converting backwards and forwards even though</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3081" target="_blank">00:51:21.760</a></span> | <span class="t">they're conceptually an int we're not going to be doing kind of int style calculations</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3086" target="_blank">00:51:26.520</a></span> | <span class="t">with them good question I mentioned that by default the data block uses a random split</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3099" target="_blank">00:51:39.320</a></span> | <span class="t">you might have noticed in the data frame though it said here's a column saying what validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3109" target="_blank">00:51:49.120</a></span> | <span class="t">set to use and if the data set you're given tells you what validation set to use you should</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3114" target="_blank">00:51:54.160</a></span> | <span class="t">generally use it because that way you can compare your validation set results to somebody</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3118" target="_blank">00:51:58.760</a></span> | <span class="t">else's so you can pass a splitter argument which again is a function and so we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3126" target="_blank">00:52:06.040</a></span> | <span class="t">to pass it a function that's also called splitter and the function is going to return the indexes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3132" target="_blank">00:52:12.720</a></span> | <span class="t">where it's not valid and that's going to be the training set and the indexes where it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3138" target="_blank">00:52:18.520</a></span> | <span class="t">is valid that's going to be the validation set and so the splitter argument is expected</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3143" target="_blank">00:52:23.120</a></span> | <span class="t">to return two lists of integers and so if we do that we get again the same thing but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3149" target="_blank">00:52:29.680</a></span> | <span class="t">now we're using the correct train and validation sets another question sure any particular</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3160" target="_blank">00:52:40.480</a></span> | <span class="t">reason we don't use floating point eight is it just that the precision is too low yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3167" target="_blank">00:52:47.800</a></span> | <span class="t">trying to train with 8-bit precision is super difficult it's it's so flat and bumpy it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3177" target="_blank">00:52:57.320</a></span> | <span class="t">pretty difficult to get decent gradients there but you know it's an area of research the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3183" target="_blank">00:53:03.440</a></span> | <span class="t">main thing people do with 8-bit or even 1-bit data types is they take a model that's already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3190" target="_blank">00:53:10.440</a></span> | <span class="t">been trained with 16-bit or 32-bit floating point and then they kind of round it off it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3195" target="_blank">00:53:15.160</a></span> | <span class="t">called discretizing to create a kind of purely integer or even binary network which can do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3203" target="_blank">00:53:23.680</a></span> | <span class="t">inference much faster figuring out how to train with such low precision data is an</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3211" target="_blank">00:53:31.820</a></span> | <span class="t">area of active research I suspect it's possible and I suspect I mean people have fiddled around</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3222" target="_blank">00:53:42.280</a></span> | <span class="t">it and had some success I think you know it could turn out to be super interesting particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3226" target="_blank">00:53:46.960</a></span> | <span class="t">for stuff that's being done on like low-powered devices that might not even have a floating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3231" target="_blank">00:53:51.120</a></span> | <span class="t">point unit right so the last thing we need to do is to add our item transforms random</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3241" target="_blank">00:54:01.000</a></span> | <span class="t">resource crop we've talked about that enough so I won't go into it but basically that means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3245" target="_blank">00:54:05.000</a></span> | <span class="t">we now are going to ensure that everything has the same shape so that we can collate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3249" target="_blank">00:54:09.460</a></span> | <span class="t">it into a data loader they're now rather than going dot data sets go dot data loaders and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3255" target="_blank">00:54:15.480</a></span> | <span class="t">display our data and remember something goes wrong as we saw last week you can call summary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3262" target="_blank">00:54:22.120</a></span> | <span class="t">to find out exactly what's happening in your data block so now you know this is something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3267" target="_blank">00:54:27.400</a></span> | <span class="t">really worth studying this section because data blocks are super handy and if you haven't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3272" target="_blank">00:54:32.280</a></span> | <span class="t">used fastai 2 before they won't be familiar to you because no other library uses them</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3279" target="_blank">00:54:39.440</a></span> | <span class="t">and so like this is really showing you how to go right back to the start and gradually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3282" target="_blank">00:54:42.840</a></span> | <span class="t">build them up so hopefully that'll make a whole lot of sense now we're going to need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3289" target="_blank">00:54:49.520</a></span> | <span class="t">a loss function again and to do that let's start by just creating a learner it's created</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3297" target="_blank">00:54:57.200</a></span> | <span class="t">resnet 18 from the data loaders object that we just created and let's grab one batch of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3304" target="_blank">00:55:04.720</a></span> | <span class="t">data and then let's put that into our mini batch of independent independent variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3312" target="_blank">00:55:12.360</a></span> | <span class="t">and then learn dot model is the thing that actually contains the model itself in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3318" target="_blank">00:55:18.880</a></span> | <span class="t">case is CNN and you can treat it as a function and so therefore we can just pass something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3324" target="_blank">00:55:24.400</a></span> | <span class="t">to it and so if we pass a mini batch of the independent variable to learn dot model it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3331" target="_blank">00:55:31.540</a></span> | <span class="t">will return the activations from the final layer and that is shape 64 by 20 so anytime</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3340" target="_blank">00:55:40.600</a></span> | <span class="t">you get a tensor back look at its shape and in fact before you look at its shape predict</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3345" target="_blank">00:55:45.640</a></span> | <span class="t">what the shape should be and then make sure that you're all right if you're not I think</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3351" target="_blank">00:55:51.200</a></span> | <span class="t">you guessed wrong so try to understand where you made a mistake or there's a problem with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3355" target="_blank">00:55:55.680</a></span> | <span class="t">your code in this case 64 by 20 makes sense because we have a mini batch size of 64 and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3364" target="_blank">00:56:04.840</a></span> | <span class="t">for each of those we're going to make predictions about what probability is each of these 20</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3370" target="_blank">00:56:10.760</a></span> | <span class="t">possible categories and we have a question two questions questions all right is the data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3377" target="_blank">00:56:17.120</a></span> | <span class="t">block API compatible with out of core data sets like Dask yeah the data block API can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3385" target="_blank">00:56:25.400</a></span> | <span class="t">do anything you want it to do so you're passing it if we go back to the start so you can create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3397" target="_blank">00:56:37.360</a></span> | <span class="t">an empty one and then you can pass it anything that is indexable and yeah so that can be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3408" target="_blank">00:56:48.120</a></span> | <span class="t">anything you you like and pretty much anything can be made indexable in Python and that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3414" target="_blank">00:56:54.880</a></span> | <span class="t">something like Dask is certainly indexable so that works perfectly fine if it's not indexable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3423" target="_blank">00:57:03.920</a></span> | <span class="t">like it's a it's a network stream or something like that then the data loaders data sets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3430" target="_blank">00:57:10.840</a></span> | <span class="t">API's directly which we'll learn about either in this course or the next one but yeah anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3436" target="_blank">00:57:16.320</a></span> | <span class="t">that you can index into it certainly includes Dask you can use with data blocks next question</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3443" target="_blank">00:57:23.240</a></span> | <span class="t">where do you put images for multi-label with that CSV table should they be in the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3448" target="_blank">00:57:28.080</a></span> | <span class="t">directory there can be anywhere you like so in this case we used a pathlib object like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3457" target="_blank">00:57:37.120</a></span> | <span class="t">so and in this case the the by default it's going to be using I think about this so what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3477" target="_blank">00:57:57.240</a></span> | <span class="t">happening here is the path is oh it's saying dot okay the reason for that is that path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3484" target="_blank">00:58:04.760</a></span> | <span class="t">dot base path is currently set to path and so that displays things relative oh let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3489" target="_blank">00:58:09.560</a></span> | <span class="t">rid of that okay so the path we set is here right and so then when we said get X it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3499" target="_blank">00:58:19.760</a></span> | <span class="t">saying path slash change slash whatever right so this is an absolute path and so here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3507" target="_blank">00:58:27.000</a></span> | <span class="t">the exact path so you can put them anywhere you like you just have to say what the path</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3511" target="_blank">00:58:31.240</a></span> | <span class="t">is and then if you want to not get confused by having this big long prefix that we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3518" target="_blank">00:58:38.920</a></span> | <span class="t">don't want to see all the time just set base path to the path you want everything to be</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3523" target="_blank">00:58:43.360</a></span> | <span class="t">relative to and then it'll just print things out in this more convenient manner right so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3534" target="_blank">00:58:54.200</a></span> | <span class="t">this is really important that you can do this that you can create a learner you can grab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3538" target="_blank">00:58:58.640</a></span> | <span class="t">a batch of data that you can pass it to the model is this is just plain pytorch this line</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3543" target="_blank">00:59:03.480</a></span> | <span class="t">here right no fast AI you can see the shape right you can recognize why it has this shape</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3551" target="_blank">00:59:11.360</a></span> | <span class="t">and so now if you have a look here are the 20 activations now this is not a trained model</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3561" target="_blank">00:59:21.040</a></span> | <span class="t">it's a pre-trained model with a random set of final layer weights so these specific numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3566" target="_blank">00:59:26.200</a></span> | <span class="t">don't mean anything but it's just worth remembering this is what activations look like and most</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3572" target="_blank">00:59:32.800</a></span> | <span class="t">importantly they're not between 0 and 1 and if you remember from the MNIST notebook we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3578" target="_blank">00:59:38.400</a></span> | <span class="t">know how to scale things between 0 and 1 we can pop them into the sigmoid function so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3583" target="_blank">00:59:43.520</a></span> | <span class="t">the sigmoid function is something that scales everything to be between 0 and 1 so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3589" target="_blank">00:59:49.720</a></span> | <span class="t">use that you'll also hopefully remember from the MNIST notebook that the MNIST loss the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3598" target="_blank">00:59:58.760</a></span> | <span class="t">MNIST loss function first did sigmoid and then it did torch.where so and then it did</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3607" target="_blank">01:00:07.040</a></span> | <span class="t">dot mean so we're going to use exactly the same thing as the MNIST loss function and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3611" target="_blank">01:00:11.520</a></span> | <span class="t">we're just going to do one thing which is going to add dot log for the same reason that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3616" target="_blank">01:00:16.120</a></span> | <span class="t">we talked about when we were looking at softmax we talked about why log is a good idea as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3625" target="_blank">01:00:25.880</a></span> | <span class="t">a transformation we saw in the MNIST notebook we didn't need it but we're going to train</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3633" target="_blank">01:00:33.280</a></span> | <span class="t">faster and more accurately if we use it because it's just more it's going to be better behaved</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3637" target="_blank">01:00:37.520</a></span> | <span class="t">as we've seen so this particular function which is identical to MNIST loss plus dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3643" target="_blank">01:00:43.520</a></span> | <span class="t">log as a specific name and it's called binary cross entropy and we used it for the threes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3652" target="_blank">01:00:52.200</a></span> | <span class="t">versus sevens problem to decide whether that column is it a three or not but because we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3661" target="_blank">01:01:01.480</a></span> | <span class="t">can use broadcasting in high torch and element wise arithmetic this function when we pass</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3669" target="_blank">01:01:09.360</a></span> | <span class="t">it a whole matrix is going to be applied to every column so is the first column you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3677" target="_blank">01:01:17.680</a></span> | <span class="t">so it'll basically do a torch.where on on every column separately in every item separately</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3687" target="_blank">01:01:27.480</a></span> | <span class="t">so that's great it basically means that this binary cross entropy function is going to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3691" target="_blank">01:01:31.120</a></span> | <span class="t">be just like MNIST loss but rather than just being is this the number three it'll be is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3697" target="_blank">01:01:37.880</a></span> | <span class="t">this a dog is this a cat is this a car is this a person is this the bicycle and so forth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3703" target="_blank">01:01:43.240</a></span> | <span class="t">this is where it's so cool in PyTorch we can kind of run write one thing and then kind</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3708" target="_blank">01:01:48.040</a></span> | <span class="t">of have it expand to handle higher dimensional tensors without doing any extra work we don't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3715" target="_blank">01:01:55.880</a></span> | <span class="t">have to write this a cells of course because PyTorch has one and it's called f dot binary</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3724" target="_blank">01:02:04.240</a></span> | <span class="t">cross entropy so we can just use PyTorch as we've talked about there's always a equivalent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3730" target="_blank">01:02:10.520</a></span> | <span class="t">module version so this is exactly the same thing as a module and n dot BCE loss and these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3741" target="_blank">01:02:21.040</a></span> | <span class="t">ones don't include the initial sigmoid actually if you want to include this initial sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3746" target="_blank">01:02:26.700</a></span> | <span class="t">you need f dot binary cross entropy with logits or the equivalent nn dot BCE with logits loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3752" target="_blank">01:02:32.720</a></span> | <span class="t">so BCE is binary cross entropy and so those are two functions plus two equivalent classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3762" target="_blank">01:02:42.680</a></span> | <span class="t">or multilabel or binary problems and then the equivalent for single label like MNIST</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3769" target="_blank">01:02:49.360</a></span> | <span class="t">and PETS is nll loss and cross entropy so that's the equivalent of binary cross entropy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3775" target="_blank">01:02:55.880</a></span> | <span class="t">and binary cross entropy with logits so these are pretty awful names I think we can all</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3779" target="_blank">01:02:59.920</a></span> | <span class="t">agree but it is what it is so in our case we have a one-hot encoded target and we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3789" target="_blank">01:03:09.640</a></span> | <span class="t">the one with a sigmoid in so the equivalent built-in is called BCE with logits loss so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3797" target="_blank">01:03:17.120</a></span> | <span class="t">that we can make that our loss function we can compare the activations to our targets</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3802" target="_blank">01:03:22.840</a></span> | <span class="t">and we can get back a loss and then that's what we can use to train and then finally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3811" target="_blank">01:03:31.060</a></span> | <span class="t">before we take our break we also need a metric now previously we've been using as a metric</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3815" target="_blank">01:03:35.880</a></span> | <span class="t">accuracy or actually error rate error rate is one minus accuracy accuracy only works</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3822" target="_blank">01:03:42.800</a></span> | <span class="t">for single label datasets like MNIST and PETS because what it does is it takes the input</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3832" target="_blank">01:03:52.860</a></span> | <span class="t">which is the final layer activations and it does argmax what argmax does is it says what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3839" target="_blank">01:03:59.520</a></span> | <span class="t">is the index of the largest number in those activations so for example for MNIST you know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3844" target="_blank">01:04:04.400</a></span> | <span class="t">maybe the largest the highest probability is seven so this argmax would return seven</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3851" target="_blank">01:04:11.080</a></span> | <span class="t">and then it says okay there's those are my predictions and then it says okay is the prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3856" target="_blank">01:04:16.520</a></span> | <span class="t">equal to the target or not and then take the floating point mean so that's what accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3862" target="_blank">01:04:22.400</a></span> | <span class="t">is so argmax only makes sense when there's a single maximum thing you're looking for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3870" target="_blank">01:04:30.040</a></span> | <span class="t">in this case we've got multilabel so instead we have to compare each activation to some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3878" target="_blank">01:04:38.260</a></span> | <span class="t">threshold by default it's 0.5 and so we basically say if the sigmoid of the activation is greater</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3885" target="_blank">01:04:45.980</a></span> | <span class="t">than 0.5 let's assume that means that category is there and if it's not let's assume it means</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3893" target="_blank">01:04:53.040</a></span> | <span class="t">it's not there and so this is going to give us a list of trues and falses for the ones</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3898" target="_blank">01:04:58.280</a></span> | <span class="t">that the based on the activations it thinks are there and we can compare that to the target</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3904" target="_blank">01:05:04.920</a></span> | <span class="t">and then again take the floating point mean so we can use the default threshold of 0.5</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3913" target="_blank">01:05:13.080</a></span> | <span class="t">but we don't necessarily want to use 0.5 we might want to use a different threshold and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3918" target="_blank">01:05:18.480</a></span> | <span class="t">remember we have to pass when we create our learner we have to pass to the metric the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3923" target="_blank">01:05:23.760</a></span> | <span class="t">metrics argument a function so what if we want to use a threshold other than 0.5 well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3929" target="_blank">01:05:29.960</a></span> | <span class="t">we'd like to create a special function which is accuracy multi with some different threshold</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3936" target="_blank">01:05:36.680</a></span> | <span class="t">and the way we do that is we use a special built-in in Python called partial let me show</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3944" target="_blank">01:05:44.040</a></span> | <span class="t">you how partial works here's a function called say hello say hello to somebody with something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3954" target="_blank">01:05:54.120</a></span> | <span class="t">so say hello Jeremy well the default is hello so it says hello Jeremy say hello Jeremy comma</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3960" target="_blank">01:06:00.240</a></span> | <span class="t">ahoy gonna be ahoy Jeremy let's create a special version of this function that will be more</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3966" target="_blank">01:06:06.660</a></span> | <span class="t">suitable for a silver it's going to use French so we can say partial create a new function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3974" target="_blank">01:06:14.000</a></span> | <span class="t">that's based on the say hello function but it's always going to set say what to bonjour</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3979" target="_blank">01:06:19.440</a></span> | <span class="t">and we'll call that f but now f Jeremy is bonjour Jeremy and f sylvain is bonjour sylvain</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3988" target="_blank">01:06:28.360</a></span> | <span class="t">so you see we've created a new function from an existing function by fixing one of its</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=3993" target="_blank">01:06:33.560</a></span> | <span class="t">parameters so we can do the same thing for accuracy multi say let's use a threshold of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4000" target="_blank">01:06:40.600</a></span> | <span class="t">0.2 and we can pass that to metrics and so let's create a CNN learner and you'll notice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4007" target="_blank">01:06:47.880</a></span> | <span class="t">here we don't actually pass a loss function and that's because fast AI is not enough to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4012" target="_blank">01:06:52.880</a></span> | <span class="t">realize hey you're doing a classification model with a a multi label dependent variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4021" target="_blank">01:07:01.840</a></span> | <span class="t">so I know what loss function you probably want so it does it for us and we can call</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4025" target="_blank">01:07:05.760</a></span> | <span class="t">fine-tune and here we have an accuracy of 94.5 after the first view and eventually 95.1</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4034" target="_blank">01:07:14.060</a></span> | <span class="t">that's pretty good we've got an accuracy of over 95 percent was 0.2 a good threshold to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4039" target="_blank">01:07:19.520</a></span> | <span class="t">pick who knows let's try 0.1 oh that's a worse accuracy so I guess in this case we could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4048" target="_blank">01:07:28.080</a></span> | <span class="t">buy a higher threshold 94 hmm also not good so what's the best threshold well what we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4054" target="_blank">01:07:34.520</a></span> | <span class="t">could do is call get preds to get all of the predictions and all of the targets and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4060" target="_blank">01:07:40.000</a></span> | <span class="t">we could calculate the accuracy at some threshold and then we could say okay let's grab lots</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4068" target="_blank">01:07:48.680</a></span> | <span class="t">of numbers between 0.05 and 0.95 and you with a list comprehension calculate the accuracy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4074" target="_blank">01:07:54.880</a></span> | <span class="t">for all of those different thresholds and plot them ah looks like we want a threshold</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4083" target="_blank">01:08:03.040</a></span> | <span class="t">somewhere a bit above 0.5 so cool we can just use that and it's going to give us 96 in a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4089" target="_blank">01:08:09.200</a></span> | <span class="t">bit which is going to give us a better accuracy um this is a you know something that a lot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4097" target="_blank">01:08:17.640</a></span> | <span class="t">of theoreticians would be uncomfortable about I've used the validation set to pick a hyper</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4103" target="_blank">01:08:23.520</a></span> | <span class="t">parameter threshold right and so people might be like oh you're overfitting using the validation</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4110" target="_blank">01:08:30.160</a></span> | <span class="t">set to pick a hyper parameter but if you think about it this is a very smooth curve right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4114" target="_blank">01:08:34.560</a></span> | <span class="t">it's not some bumpy thing where we've accidentally kind of randomly grabbed some unexpectedly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4120" target="_blank">01:08:40.120</a></span> | <span class="t">good value when you're picking a single number from a smooth curve you know this is where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4126" target="_blank">01:08:46.040</a></span> | <span class="t">the theory of like don't use a validation set for for hyper parameter tuning doesn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4131" target="_blank">01:08:51.320</a></span> | <span class="t">really apply so it's always good to be practical right don't treat these things as rules but</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4137" target="_blank">01:08:57.320</a></span> | <span class="t">as rules of um okay so let's take a break for five minutes and we'll see you back here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4145" target="_blank">01:09:05.640</a></span> | <span class="t">in five minutes time all right welcome back so I want to show you something really cool</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4154" target="_blank">01:09:14.560</a></span> | <span class="t">image regression so we are not going to learn how to use a fast AI image regression application</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4163" target="_blank">01:09:23.680</a></span> | <span class="t">because we don't need one now that we know how to build stuff up with boss functions</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4170" target="_blank">01:09:30.880</a></span> | <span class="t">and the data block API ourselves we can invent our own applications so there is no image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4177" target="_blank">01:09:37.800</a></span> | <span class="t">regression application per se but we can do image regression really easily what do we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4186" target="_blank">01:09:46.600</a></span> | <span class="t">mean by image regression well remember back to lesson I think it's lesson one we talked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4191" target="_blank">01:09:51.400</a></span> | <span class="t">about the two basic types of machine learning or supervised machine learning regression</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4199" target="_blank">01:09:59.720</a></span> | <span class="t">and classification classification is when our dependent variable is a discrete category</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4204" target="_blank">01:10:04.920</a></span> | <span class="t">or set of categories and regression is when our dependent variable is a continuous number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4213" target="_blank">01:10:13.520</a></span> | <span class="t">like an age or x y coordinate or something like that so image regression means our independent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4220" target="_blank">01:10:20.720</a></span> | <span class="t">variable is an image and our dependent variable is a continue one or more continuous value</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4228" target="_blank">01:10:28.440</a></span> | <span class="t">values and so here's what that can look like which is the b we had posed data set has a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4238" target="_blank">01:10:38.120</a></span> | <span class="t">number of things in it but one of the things we can do is find the midpoint of a person's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4242" target="_blank">01:10:42.640</a></span> | <span class="t">face see so the b we had posed data set so the b we had posed data set comes from this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4261" target="_blank">01:11:01.440</a></span> | <span class="t">paper random forests real-time 3d face analysis so thank you to those authors and we can grab</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4271" target="_blank">01:11:11.440</a></span> | <span class="t">it in the usual way untied data and we can have a look at what's in there and we can</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4276" target="_blank">01:11:16.600</a></span> | <span class="t">see there's 24 directories numbered from one to 24 there's one two three and each one also</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4283" target="_blank">01:11:23.080</a></span> | <span class="t">has a .obj file we're not going to be using the .obj file I'm just the directories so let's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4288" target="_blank">01:11:28.080</a></span> | <span class="t">look at one of the directories and as you can see there's a thousand things in the first</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4291" target="_blank">01:11:31.840</a></span> | <span class="t">directory so each one of these 24 directories is one different person that they've photographed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4298" target="_blank">01:11:38.520</a></span> | <span class="t">and you can see for each person there's frame three pose frame three RGB frame for pose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4306" target="_blank">01:11:46.440</a></span> | <span class="t">frame for RGB and so forth so in each case we've got the image which is the RGB and we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4312" target="_blank">01:11:52.880</a></span> | <span class="t">got the pose is the pose.txt so as we've seen we can grab use get image files to get a list</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4320" target="_blank">01:12:00.920</a></span> | <span class="t">of all of the files image files recursively in a path and so once we have an image file</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4326" target="_blank">01:12:06.680</a></span> | <span class="t">name like this one sorry like this one we can turn it into a pose file name by removing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4336" target="_blank">01:12:16.320</a></span> | <span class="t">the last one two three five six seven letters and adding back on pose.txt and so here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4344" target="_blank">01:12:24.540</a></span> | <span class="t">a function that does that and so you can see I can pass in an image file to image to pose</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4350" target="_blank">01:12:30.720</a></span> | <span class="t">and get back a pose file right so pyo image.create is the fast AI way to create an image at least</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4361" target="_blank">01:12:41.400</a></span> | <span class="t">a pyo image it has a shape in computer vision they're normally backwards they normally do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4368" target="_blank">01:12:48.080</a></span> | <span class="t">columns by rows so that's why it's this way around whereas pytorch and numpy tensors and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4374" target="_blank">01:12:54.680</a></span> | <span class="t">arrays are rows by columns so that's confusing but that's just how things are I'm afraid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4380" target="_blank">01:13:00.400</a></span> | <span class="t">and so here's an example of an image when you look at the readme from the dataset website</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4388" target="_blank">01:13:08.100</a></span> | <span class="t">they tell you how to get the center point from from one of the text files and it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4394" target="_blank">01:13:14.680</a></span> | <span class="t">this function so it doesn't matter it just it is what it is we call it get center and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4399" target="_blank">01:13:19.560</a></span> | <span class="t">it will return the XY coordinate of the center of the person's head face so we can pass this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4407" target="_blank">01:13:27.840</a></span> | <span class="t">as get Y because get Y remember is the thing that gives us back the label okay so so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4418" target="_blank">01:13:38.720</a></span> | <span class="t">the thing right we can create a data block and we can pass in as the independent variables</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4424" target="_blank">01:13:44.480</a></span> | <span class="t">block image block as usual and then the dependent variables block we can say point block which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4430" target="_blank">01:13:50.160</a></span> | <span class="t">is a tensor with two values in and now by combining these two things this says we want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4435" target="_blank">01:13:55.680</a></span> | <span class="t">to do image regression with a dependent variable with two continuous values to get the items</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4444" target="_blank">01:14:04.020</a></span> | <span class="t">you call get image files to get the Y we'll call the get center function to split it so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4451" target="_blank">01:14:11.840</a></span> | <span class="t">this is important we should make sure that the validation set contains one or more people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4461" target="_blank">01:14:21.140</a></span> | <span class="t">that don't appear in the training set so I'm just going to grab person number 13 just grabbed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4466" target="_blank">01:14:26.440</a></span> | <span class="t">it randomly and I'll use all of those images as the validation set because I think they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4472" target="_blank">01:14:32.200</a></span> | <span class="t">did this with a Xbox connect you know video thing so there's a lot of images that look</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4479" target="_blank">01:14:39.160</a></span> | <span class="t">almost identical so if you randomly assigned them then you would be massively overestimating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4484" target="_blank">01:14:44.960</a></span> | <span class="t">how effective you are you want to make sure that you're actually doing a good job with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4489" target="_blank">01:14:49.880</a></span> | <span class="t">a random with a new set of people not just a new set of frames that's why we use this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4495" target="_blank">01:14:55.840</a></span> | <span class="t">and so a func splitter is a splitter that takes a function and in this case we're using</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4500" target="_blank">01:15:00.400</a></span> | <span class="t">lambda to create the function we will use data augmentation and we will also normalize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4509" target="_blank">01:15:09.720</a></span> | <span class="t">so this is actually done automatically now but this case we're doing it manually so this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4515" target="_blank">01:15:15.080</a></span> | <span class="t">is going to subtract the mean and divide by the standard deviation of the original data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4522" target="_blank">01:15:22.920</a></span> | <span class="t">set that the pre-trained model used which is imageNet so that's our data block and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4532" target="_blank">01:15:32.400</a></span> | <span class="t">we can call data loaders to get our data loaders passing in the path and show batch and we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4537" target="_blank">01:15:37.960</a></span> | <span class="t">can see that looks good right here's our faces and the points and so let's like particularly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4544" target="_blank">01:15:44.760</a></span> | <span class="t">for as a student don't just look at the pictures look at the actual data so grab a batch put</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4551" target="_blank">01:15:51.160</a></span> | <span class="t">it into an xB and a yB expansion y batch and have a look at the shapes and make sure they</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4556" target="_blank">01:15:56.680</a></span> | <span class="t">make sense the ys is 64 by 1 by 2 so it's 64 in the mini batch 64 rows and then a coordinates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4571" target="_blank">01:16:11.520</a></span> | <span class="t">is a 1 by 2 tensor so this is a single point with two things in it it's like you could</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4581" target="_blank">01:16:21.120</a></span> | <span class="t">have like hands face and armpits or whatever or nose and ears and mouth so in this case</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4587" target="_blank">01:16:27.720</a></span> | <span class="t">we're just using one point and the point is represented by two values the x and the y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4594" target="_blank">01:16:34.320</a></span> | <span class="t">and then y is this 64 by 3 by 240 by 320 well there's 240 rows by 320 columns that's the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4600" target="_blank">01:16:40.920</a></span> | <span class="t">pixels that's the size of the images that we're using mini batches 64 items and what's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4608" target="_blank">01:16:48.440</a></span> | <span class="t">the three the three is the number of channels which in this case means the number of colors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4614" target="_blank">01:16:54.840</a></span> | <span class="t">if we open up some random grizzly bear image and then we go through each of the elements</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4627" target="_blank">01:17:07.720</a></span> | <span class="t">of the first axis and do a show image you can see that it's got the red the green and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4637" target="_blank">01:17:17.040</a></span> | <span class="t">the blue as the three channels so that's how we store a three-channel image is it stored</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4644" target="_blank">01:17:24.560</a></span> | <span class="t">as a three by number of rows by number of columns rank three tensor and so a mini batch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4651" target="_blank">01:17:31.940</a></span> | <span class="t">of those is a rank four tensor that's why this is that shape but here's a row from the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4659" target="_blank">01:17:39.600</a></span> | <span class="t">dependent variable okay there's that XY location we talked about so we can now go ahead and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4667" target="_blank">01:17:47.720</a></span> | <span class="t">create a learner passing in our data loaders as usual passing in a pre-trained architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4673" target="_blank">01:17:53.160</a></span> | <span class="t">as usual and if you think back you may just remember in lesson one we learned about y</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4680" target="_blank">01:18:00.400</a></span> | <span class="t">range y range is where we tell fastai what range of data we expect to see in the dependent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4690" target="_blank">01:18:10.040</a></span> | <span class="t">variable so we want to use this generally when we're doing regression though the range</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4695" target="_blank">01:18:15.320</a></span> | <span class="t">of our coordinates is between minus one and one that's how fastai and pytorch treats coordinates</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4702" target="_blank">01:18:22.800</a></span> | <span class="t">the left hand side is minus one or the top is minus one and the bottom and the right</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4708" target="_blank">01:18:28.040</a></span> | <span class="t">one so there's no point predicting something that's smaller than minus one or bigger than</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4713" target="_blank">01:18:33.520</a></span> | <span class="t">one because that is not in the area that we use for our coordinates if a question sure</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4719" target="_blank">01:18:39.460</a></span> | <span class="t">just a moment so how is y range work well it actually uses this function called sigmoid</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4727" target="_blank">01:18:47.320</a></span> | <span class="t">range which takes the sigmoid of X multiplies by high minus low and adds low and here is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4734" target="_blank">01:18:54.200</a></span> | <span class="t">what sigmoid range looks like or minus one to one it's just a sigmoid where the bottom</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4742" target="_blank">01:19:02.680</a></span> | <span class="t">is the low and the top is the high and so that way all of our activations are going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4748" target="_blank">01:19:08.840</a></span> | <span class="t">to be mapped to the range from minus one to one yes rachel can you provide images with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4757" target="_blank">01:19:17.240</a></span> | <span class="t">an arbitrary number of channels as inputs specifically more than three channels yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4763" target="_blank">01:19:23.360</a></span> | <span class="t">you can have as many channels as you like we certainly seen images with less than three</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4768" target="_blank">01:19:28.760</a></span> | <span class="t">because we've been grayscale more than three is common as well you could have like an infrared</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4774" target="_blank">01:19:34.920</a></span> | <span class="t">band or like satellite images often have multispectral there's some kinds of medical images where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4781" target="_blank">01:19:41.520</a></span> | <span class="t">there are bands that are kind of outside the visible range your pre-trained model will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4787" target="_blank">01:19:47.800</a></span> | <span class="t">generally have three channels the fast AI does some tricks to use three channel pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4795" target="_blank">01:19:55.800</a></span> | <span class="t">models for non three channel data but that's the only tricky bit other than that it's just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4802" target="_blank">01:20:02.640</a></span> | <span class="t">just a you know it's just an axis that happens to have four things or two things or one thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4808" target="_blank">01:20:08.120</a></span> | <span class="t">instead of three things there's nothing special about it okay we didn't specify a loss function</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4818" target="_blank">01:20:18.440</a></span> | <span class="t">here so we get whatever it gave us which is a MSE loss so MSE losses mean squared error</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4824" target="_blank">01:20:24.800</a></span> | <span class="t">and that makes perfect sense right you would expect mean squared error to be a reasonable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4830" target="_blank">01:20:30.160</a></span> | <span class="t">thing to use for regression we're just testing how close we are through the target and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4835" target="_blank">01:20:35.880</a></span> | <span class="t">taking the square taking the mean we didn't specify any metrics and that's because mean</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4842" target="_blank">01:20:42.840</a></span> | <span class="t">squared error is already a good metric like it's not it's it's it has nice gradients it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4850" target="_blank">01:20:50.760</a></span> | <span class="t">behaves well but and it's also the thing that we care about so we don't need a separate</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4854" target="_blank">01:20:54.760</a></span> | <span class="t">metric to track so let's go ahead and use LR find and we can pick a learning rate so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4862" target="_blank">01:21:02.880</a></span> | <span class="t">maybe about 10 to the minus 2 we can call fine-tune and we get a valid loss of 0.0001</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4871" target="_blank">01:21:11.920</a></span> | <span class="t">and so that's the mean squared error so we should take the square root on average we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4875" target="_blank">01:21:15.920</a></span> | <span class="t">about 0.01 off in a coordinate space that goes between minus 1 and 1 so that sounds</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4881" target="_blank">01:21:21.280</a></span> | <span class="t">super accurate took about three in a bit minutes to run so we can always call in fastai and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4888" target="_blank">01:21:28.920</a></span> | <span class="t">we always should go results see what our results look like and as you can see fastai has automatically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4894" target="_blank">01:21:34.280</a></span> | <span class="t">figured out how to display the combination of an image independent variable and a point</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4900" target="_blank">01:21:40.160</a></span> | <span class="t">dependent variable on the left is the is the target and on the right is the prediction</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4906" target="_blank">01:21:46.400</a></span> | <span class="t">and as you can see it is pretty close to perfect you know one of the really interesting things</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4912" target="_blank">01:21:52.280</a></span> | <span class="t">here is we used fine-tune even although think about it the thing we're fine-tuning image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4918" target="_blank">01:21:58.880</a></span> | <span class="t">net isn't even an image regression model so we're actually fine-tuning an image classification</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4927" target="_blank">01:22:07.340</a></span> | <span class="t">model to become something totally different an image regression model why does that work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4932" target="_blank">01:22:12.840</a></span> | <span class="t">so well well because and image net classification model must have learnt a lot about kind of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4945" target="_blank">01:22:25.000</a></span> | <span class="t">how images look what things look like and where the pieces of them are to kind of know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4949" target="_blank">01:22:29.560</a></span> | <span class="t">how to figure out what breed of animal something is even if it's partly obscured by a horse</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4955" target="_blank">01:22:35.800</a></span> | <span class="t">shorts in the shade or it's turned in different angles you know these pre-trained image models</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4961" target="_blank">01:22:41.760</a></span> | <span class="t">are incredibly powerful you know computing algorithms so built into every image net pre-trained</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4971" target="_blank">01:22:51.680</a></span> | <span class="t">model is all this capability that it had to learn for itself so asking it to use that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4977" target="_blank">01:22:57.000</a></span> | <span class="t">capability to figure out where something is just actually not that hard for it and so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4983" target="_blank">01:23:03.000</a></span> | <span class="t">that's why we can actually fine-tune an image net classification model to create something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4989" target="_blank">01:23:09.360</a></span> | <span class="t">completely different which is a point image regression model so I find that incredibly</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=4998" target="_blank">01:23:18.840</a></span> | <span class="t">cool I got to say so again look at the further research after you've done the questionnaire</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5006" target="_blank">01:23:26.840</a></span> | <span class="t">and particularly if you haven't used data frames before please play with them because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5010" target="_blank">01:23:30.320</a></span> | <span class="t">we're going to be using them more and more good question I'll just do the last one and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5019" target="_blank">01:23:39.560</a></span> | <span class="t">also go back and look at the bear classifier from notebook 2 or whatever hopefully you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5025" target="_blank">01:23:45.840</a></span> | <span class="t">created some other classifier for your own data because remember we talked about how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5031" target="_blank">01:23:51.760</a></span> | <span class="t">it would be better if the bear classifier could also recognize that there's no bear</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5036" target="_blank">01:23:56.000</a></span> | <span class="t">at all or maybe there's both a grizzly bear and a black bear or a grizzly bear and a teddy</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5041" target="_blank">01:24:01.940</a></span> | <span class="t">bear so if you retrain it using multi-label classification see what happens see how well</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5048" target="_blank">01:24:08.000</a></span> | <span class="t">it works when there's no bears and see whether it changes the accuracy of the single label</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5054" target="_blank">01:24:14.960</a></span> | <span class="t">model when you turn it into a multi-label problem so have a fiddle around and tell us</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5060" target="_blank">01:24:20.560</a></span> | <span class="t">on the forum what you find I've got a question Rachel is there a tutorial showing how to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5065" target="_blank">01:24:25.480</a></span> | <span class="t">use pre-trained models on four channel images also how can you add a channel to a normal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5071" target="_blank">01:24:31.920</a></span> | <span class="t">image?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5072" target="_blank">01:24:32.920</a></span> | <span class="t">Well it's the last one how do you add a channel to an image I don't know what that means okay</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5081" target="_blank">01:24:41.000</a></span> | <span class="t">I don't know you can't like an image is an image you can't add a channel to an image</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5088" target="_blank">01:24:48.640</a></span> | <span class="t">is what it is I don't know if there's a tutorial but we can certainly make sure somebody on</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5099" target="_blank">01:24:59.240</a></span> | <span class="t">the forum has learned how to do it it's it's super straightforward it should be pretty</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5105" target="_blank">01:25:05.840</a></span> | <span class="t">much automatic okay we're going to talk about collaborative filtering what is collaborative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5121" target="_blank">01:25:21.360</a></span> | <span class="t">filtering?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5122" target="_blank">01:25:22.360</a></span> | <span class="t">Well think about on Netflix or whatever you might have watched a lot of movies that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5129" target="_blank">01:25:29.840</a></span> | <span class="t">sci-fi and have a lot of action and were made in the 70s and Netflix might not know anything</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5140" target="_blank">01:25:40.200</a></span> | <span class="t">about the properties of movies you watched it might just know that they're movies with</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5145" target="_blank">01:25:45.080</a></span> | <span class="t">titles and IDs but what it could absolutely see without any manual work is find other</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5152" target="_blank">01:25:52.520</a></span> | <span class="t">people that watched the same movies that you watched and it could see what other movies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5162" target="_blank">01:26:02.240</a></span> | <span class="t">those people watched that you haven't and it would probably find they were also you</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5166" target="_blank">01:26:06.680</a></span> | <span class="t">would probably find they're also science fiction and full of action and made in the 70s so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5173" target="_blank">01:26:13.880</a></span> | <span class="t">we can use an approach where we recommend things even if we don't know anything about</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5180" target="_blank">01:26:20.440</a></span> | <span class="t">what those things are as long as we know who else has used or recommended things that are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5190" target="_blank">01:26:30.200</a></span> | <span class="t">similar you know the same kind you know many of the same things that that you've liked</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5194" target="_blank">01:26:34.520</a></span> | <span class="t">or used this doesn't necessarily mean users and products in fact in collaborative filtering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5203" target="_blank">01:26:43.760</a></span> | <span class="t">sort of same products we normally say items and items could be links you click on a diagnosis</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5210" target="_blank">01:26:50.960</a></span> | <span class="t">for a patient and so forth so there's a key idea here which is that in the underlying</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5219" target="_blank">01:26:59.480</a></span> | <span class="t">items and we're going to be using movies in this example there are some there are some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5225" target="_blank">01:27:05.400</a></span> | <span class="t">features they may not be labeled but there's some underlying concept of features of of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5232" target="_blank">01:27:12.960</a></span> | <span class="t">those movies like the fact that there's a action concept and a sci-fi concept in the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5239" target="_blank">01:27:19.160</a></span> | <span class="t">1970s concept now you were never actually told Netflix you like these kinds of movies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5244" target="_blank">01:27:24.720</a></span> | <span class="t">and maybe Netflix never actually added columns to their movies saying what movies are those</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5248" target="_blank">01:27:28.320</a></span> | <span class="t">types but as long as like you know in the real world there's this concept of sci-fi</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5255" target="_blank">01:27:35.680</a></span> | <span class="t">and action and movie age and that those concepts are relevant for at least some people's movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5262" target="_blank">01:27:42.520</a></span> | <span class="t">watching decisions as long as this is true then we can actually uncover these they're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5270" target="_blank">01:27:50.240</a></span> | <span class="t">called late latent factors these things that kind of decide what kind of movies you want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5276" target="_blank">01:27:56.600</a></span> | <span class="t">to watch and they're latent because nobody necessarily ever wrote them down or labeled</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5282" target="_blank">01:28:02.560</a></span> | <span class="t">them or communicated them in any way so let me show you what this looks like so there's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5291" target="_blank">01:28:11.240</a></span> | <span class="t">a great data set we can use called movie lens which contains tens of millions of movie rankings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5297" target="_blank">01:28:17.640</a></span> | <span class="t">and so a movie ranking looks like this it has a user number a movie number a rating</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5308" target="_blank">01:28:28.000</a></span> | <span class="t">and a time step so we don't know anything about who user number 196 is I don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5314" target="_blank">01:28:34.160</a></span> | <span class="t">if that is Rachel or somebody else I don't know what movie number 242 is I don't know</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5321" target="_blank">01:28:41.520</a></span> | <span class="t">if that's Casablanca or Lord of the Rings or the mask and then rating is a number between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5329" target="_blank">01:28:49.120</a></span> | <span class="t">I think it was one five a question sure in traditional machine learning we perform cross</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5336" target="_blank">01:28:56.760</a></span> | <span class="t">validations and K fold training to check for variance and bias trade-off is this common</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5343" target="_blank">01:29:03.040</a></span> | <span class="t">in training deep learning models as well.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5349" target="_blank">01:29:09.820</a></span> | <span class="t">So cross validation is a technique where you don't just split your data set into one training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5355" target="_blank">01:29:15.120</a></span> | <span class="t">set and one validation set but you basically do it five or so times like five training</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5361" target="_blank">01:29:21.920</a></span> | <span class="t">sets and like five validation sets representing different overlapping subsets and basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5369" target="_blank">01:29:29.840</a></span> | <span class="t">this was this used to be done a lot because people often used to have not enough data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5375" target="_blank">01:29:35.320</a></span> | <span class="t">get a good result and so this way rather than kind of having 20% that you would leave out</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5383" target="_blank">01:29:43.600</a></span> | <span class="t">each time you could just leave out like 10% each time.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5387" target="_blank">01:29:47.080</a></span> | <span class="t">Nowadays it's less common that we have so little data that we need to worry about the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5393" target="_blank">01:29:53.120</a></span> | <span class="t">complexity and extra time of lots of models it's done on Kaggle a lot it's on Kaggle every</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5401" target="_blank">01:30:01.040</a></span> | <span class="t">little fraction of percent matters but it's not it's not a deep learning thing or a machine</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5407" target="_blank">01:30:07.240</a></span> | <span class="t">learning thing or whatever it's just a you know lots of data or not very much data thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5412" target="_blank">01:30:12.920</a></span> | <span class="t">and do you care about the last decimal place of them or not it's not something we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5418" target="_blank">01:30:18.940</a></span> | <span class="t">to talk about certainly in this part of the course if ever because it's not something</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5424" target="_blank">01:30:24.680</a></span> | <span class="t">that comes up in practice that often as being that important.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5430" target="_blank">01:30:30.040</a></span> | <span class="t">There are two more questions.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5434" target="_blank">01:30:34.800</a></span> | <span class="t">What would be some good applications of collaborative filtering outside of recommender systems?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5442" target="_blank">01:30:42.480</a></span> | <span class="t">Well I mean depends how you define recommender system if you're trying to figure out what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5450" target="_blank">01:30:50.880</a></span> | <span class="t">kind of other diagnoses might be applicable to a patient I guess that's kind of a recommender</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5456" target="_blank">01:30:56.080</a></span> | <span class="t">system or you're trying to figure out where somebody is going to click next or whatever</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5462" target="_blank">01:31:02.320</a></span> | <span class="t">it's kind of a recommender system but you know really conceptually it's anything where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5468" target="_blank">01:31:08.500</a></span> | <span class="t">you're trying to learn from from past behavior where that behavior is kind of like a thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5477" target="_blank">01:31:17.500</a></span> | <span class="t">happened to an entity.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5480" target="_blank">01:31:20.800</a></span> | <span class="t">What is an approach to training using video streams i.e. from drone footage instead of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5486" target="_blank">01:31:26.520</a></span> | <span class="t">images would you need to break up the footage into image frames?</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5491" target="_blank">01:31:31.800</a></span> | <span class="t">In practice quite often you would because images just tend to be pretty big so videos</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5496" target="_blank">01:31:36.520</a></span> | <span class="t">tend to be pretty big.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5499" target="_blank">01:31:39.880</a></span> | <span class="t">There's a lot of so I mean theoretically the time could be the fourth channel yeah or fifth</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5509" target="_blank">01:31:49.080</a></span> | <span class="t">channel so if it's a full color movie you can absolutely have well I guess fourth because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5517" target="_blank">01:31:57.000</a></span> | <span class="t">you can have five rank five tensor being batch by time by color by row by column but often</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5528" target="_blank">01:32:08.920</a></span> | <span class="t">that's too computationally and too memory intensive so sometimes people just look at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5542" target="_blank">01:32:22.460</a></span> | <span class="t">one frame at a time sometimes people use a few frames around kind of the keyframe like</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5550" target="_blank">01:32:30.600</a></span> | <span class="t">three or five frames at a time and sometimes people use something called a recurrent neural</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5556" target="_blank">01:32:36.160</a></span> | <span class="t">network which we'll be seeing in the next week or two treated as a sequence data yeah</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5561" target="_blank">01:32:41.440</a></span> | <span class="t">there's all kinds of tricks you can do to try and work with that conceptually though</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5569" target="_blank">01:32:49.240</a></span> | <span class="t">there's no reason you can't just add an additional access to your tenses and everything to work</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5574" target="_blank">01:32:54.180</a></span> | <span class="t">it's just a practical issue around time and memory.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5579" target="_blank">01:32:59.240</a></span> | <span class="t">And someone else noted that it's pretty fitting that you mentioned the movie The Mask.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5583" target="_blank">01:33:03.880</a></span> | <span class="t">Yes it was not an accident because I've got masks on the brain.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5592" target="_blank">01:33:12.880</a></span> | <span class="t">I'm not sure if we're allowed to like that movie anymore though I kind of liked it when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5596" target="_blank">01:33:16.560</a></span> | <span class="t">it came out I don't know what I think nowadays it's a while okay so let's take a look so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5608" target="_blank">01:33:28.480</a></span> | <span class="t">we can untie data ml 100k so ml 100k is a small subset of the full set there's another</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5615" target="_blank">01:33:35.360</a></span> | <span class="t">one that we can grab which has got the whole lot 25 million but 100k is good enough for</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5621" target="_blank">01:33:41.840</a></span> | <span class="t">messing around so if you look at the readme you'll find the main table the main table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5626" target="_blank">01:33:46.540</a></span> | <span class="t">is in a file called u.data so let's open it up with read.csv again this one is actually</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5631" target="_blank">01:33:51.760</a></span> | <span class="t">not comma separated values it's tab separated rather confusingly we still use csv and to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5637" target="_blank">01:33:57.000</a></span> | <span class="t">say delimiter is a tab /t is tab there's no row at the top saying what the columns are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5644" target="_blank">01:34:04.480</a></span> | <span class="t">called so we say header is none and then pass in a list of what the columns are called .head</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5651" target="_blank">01:34:11.080</a></span> | <span class="t">will give us the first five rows and we mentioned this before what it looks like it's not a</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5659" target="_blank">01:34:19.800</a></span> | <span class="t">particularly friendly way to look at it so what I'm going to do is I'm going to cross</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5665" target="_blank">01:34:25.800</a></span> | <span class="t">tab it and so what I've done here is I've grabbed the top I can't remember how many</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5672" target="_blank">01:34:32.960</a></span> | <span class="t">it was 15 or 20 movies based on the most popular movies and the top bunch of users who watched</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5684" target="_blank">01:34:44.000</a></span> | <span class="t">the most movies and so I've basically kind of reoriented this so for each user I have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5691" target="_blank">01:34:51.280</a></span> | <span class="t">all the movies they've watched and the rating they gave them so empty spots represent users</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5696" target="_blank">01:34:56.240</a></span> | <span class="t">that have not seen that movie so this is just another way of looking at this same data so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5709" target="_blank">01:35:09.640</a></span> | <span class="t">basically what we want to do is guess what movies we should tell people they might want</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5715" target="_blank">01:35:15.640</a></span> | <span class="t">to watch and so it's basically filling in these gaps to tell user 212 do you think we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5721" target="_blank">01:35:21.280</a></span> | <span class="t">would they might like movie 49 or 79 or 99 best to watch next.</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5732" target="_blank">01:35:32.720</a></span> | <span class="t">So let's assume that we actually had columns for every movie that represented say how much</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5743" target="_blank">01:35:43.980</a></span> | <span class="t">sci-fi they are how much action they are and how old they are and maybe they're between</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5749" target="_blank">01:35:49.440</a></span> | <span class="t">minus one and one and so like the last Skywalker is very sci-fi fairly action and definitely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5757" target="_blank">01:35:57.480</a></span> | <span class="t">not old and then we could do the same thing for users so we could say user one really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5765" target="_blank">01:36:05.760</a></span> | <span class="t">likes sci-fi quite likes action and really doesn't like old and so now if you multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5773" target="_blank">01:36:13.120</a></span> | <span class="t">those together and remember in PyTorch and NumPy you have element wise calculations so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5779" target="_blank">01:36:19.200</a></span> | <span class="t">this is going to multiply each corresponding item it's not matrix multiplication if you're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5784" target="_blank">01:36:24.800</a></span> | <span class="t">a mathematician don't go there this is element wise multiplication if we want matrix multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5789" target="_blank">01:36:29.960</a></span> | <span class="t">be an at sign so if we multiply each element together next to with the equivalent element</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5797" target="_blank">01:36:37.440</a></span> | <span class="t">in the other one and then sum them up that's going to give us a number which will basically</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5802" target="_blank">01:36:42.800</a></span> | <span class="t">tell us how much do these two correspond because remember two negatives multiply together to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5807" target="_blank">01:36:47.640</a></span> | <span class="t">get a positive so user one likes exactly the kind of stuff that last guy was that the last</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5815" target="_blank">01:36:55.160</a></span> | <span class="t">Skywalker has in it and so we get two point one multiplying things together element wise</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5821" target="_blank">01:37:01.680</a></span> | <span class="t">and adding them up is called the dot product and we use it a lot and it's the basis of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5826" target="_blank">01:37:06.640</a></span> | <span class="t">matrix multiplication so make sure you know what a dot product is it's this so Casablanca</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5843" target="_blank">01:37:23.760</a></span> | <span class="t">is not at all sci-fi not much action and is certainly old so if we do user one times Casablanca</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5852" target="_blank">01:37:32.040</a></span> | <span class="t">we get a negative number so we might think okay user one more like won't like this movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5859" target="_blank">01:37:39.640</a></span> | <span class="t">problem is we don't know what the latent factors are and even if we did we don't know how to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5864" target="_blank">01:37:44.840</a></span> | <span class="t">label a particular user or a particular movie with them so we have to learn them how do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5873" target="_blank">01:37:53.400</a></span> | <span class="t">we learn them well we can actually look at a spreadsheet so I've got a spreadsheet version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5886" target="_blank">01:38:06.920</a></span> | <span class="t">so we have a spreadsheet version which is basically what I did was I popped this table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5895" target="_blank">01:38:15.800</a></span> | <span class="t">into Excel and then I randomly created a let's count this now one two three four five six</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5904" target="_blank">01:38:24.520</a></span> | <span class="t">seven eight nine ten eleven twelve I randomly created a 15 by 5 table here so these are</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5912" target="_blank">01:38:32.520</a></span> | <span class="t">just random numbers and I randomly created a 5 by 15 table here and I basically said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5919" target="_blank">01:38:39.480</a></span> | <span class="t">okay well let's just pretend let's just assume that every movie and every user has five latent</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5925" target="_blank">01:38:45.320</a></span> | <span class="t">factors I don't know what they are and let's then do a matrix multiply of this set of factors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5934" target="_blank">01:38:54.160</a></span> | <span class="t">by this set of factors and a matrix multiply of a row by a column is identical to a dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5940" target="_blank">01:39:00.280</a></span> | <span class="t">product of two vectors so that's why I can just use matrix multiply so this is just what</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5945" target="_blank">01:39:05.600</a></span> | <span class="t">this first cell contains so they then copied it to the whole thing so all these numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5951" target="_blank">01:39:11.180</a></span> | <span class="t">there are being calculated from the row latent factors dot product with or matrix multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5960" target="_blank">01:39:20.700</a></span> | <span class="t">with a column latent factors so in other words I'm doing exactly this calculation but I'm</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5968" target="_blank">01:39:28.680</a></span> | <span class="t">doing them with random numbers and so that gives us a whole bunch of values right and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5979" target="_blank">01:39:39.000</a></span> | <span class="t">then what I could do is I could calculate a loss by comparing every one of these numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5985" target="_blank">01:39:45.120</a></span> | <span class="t">here to every one of these numbers here and then I could do mean squared error and then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=5994" target="_blank">01:39:54.560</a></span> | <span class="t">I could use stochastic gradient descent to find the best set of numbers in each of these</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6000" target="_blank">01:40:00.920</a></span> | <span class="t">two locations and that is what collaborative filtering is so that's actually all we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6011" target="_blank">01:40:11.180</a></span> | <span class="t">so rather than doing an Excel and very the Excel version later if you're interested because</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6018" target="_blank">01:40:18.280</a></span> | <span class="t">we can actually do this whole thing and it works in Excel let's jump and do it into high</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6025" target="_blank">01:40:25.200</a></span> | <span class="t">torch now one thing that might just make this more fun is actually to know what the movies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6030" target="_blank">01:40:30.120</a></span> | <span class="t">are and movie lens tells us in u.item what the movies are called and that uses the delimiter</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6037" target="_blank">01:40:37.040</a></span> | <span class="t">of the pipe sign weirdly enough so here are the names of each movie and so one of the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6043" target="_blank">01:40:43.880</a></span> | <span class="t">nice things about pandas is it can do joins just like SQL and so you can use the merge</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6052" target="_blank">01:40:52.460</a></span> | <span class="t">method to combine the ratings table and the movies table and since they both have a column</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6057" target="_blank">01:40:57.920</a></span> | <span class="t">called movie by default it will join on those and so now here we have the ratings table</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6063" target="_blank">01:41:03.800</a></span> | <span class="t">with actual movie names that's going to be a bit more fun we don't need it for modeling</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6067" target="_blank">01:41:07.940</a></span> | <span class="t">but it's just going to be better for looking at stuff so we could use data blocks API at</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6075" target="_blank">01:41:15.760</a></span> | <span class="t">this point or we can just use the built-in application factory method since it's there</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6080" target="_blank">01:41:20.240</a></span> | <span class="t">we may as well use it so we can create a collaborative filtering data loaders object from a data</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6085" target="_blank">01:41:25.440</a></span> | <span class="t">frame by passing in the ratings table by default the user column is called user and ours is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6094" target="_blank">01:41:34.200</a></span> | <span class="t">so fine by default the item column is called item and ours is not it's called title so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6101" target="_blank">01:41:41.000</a></span> | <span class="t">let's pick title and choose a batch size and so if we now say show batch here is some of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6110" target="_blank">01:41:50.480</a></span> | <span class="t">that data and the rating is called rating by default so that worked fine too but here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6117" target="_blank">01:41:57.840</a></span> | <span class="t">some data so we need to now create our let's assume we're going to use that five numbers</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6128" target="_blank">01:42:08.380</a></span> | <span class="t">of factors so the number of users is however many classes there are for user and the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6136" target="_blank">01:42:16.640</a></span> | <span class="t">of movies is however many classes there are a title and so these are so we don't just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6146" target="_blank">01:42:26.600</a></span> | <span class="t">have a vocab now right we've actually got a list of classes for each categorical variable</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6156" target="_blank">01:42:36.400</a></span> | <span class="t">for each set of discrete choices so we've got a whole bunch of users at 944 and a whole</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6163" target="_blank">01:42:43.600</a></span> | <span class="t">bunch of titles 1635 so for our randomized latent factor parameters we're going to need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6175" target="_blank">01:42:55.680</a></span> | <span class="t">to create those matrices so we can just create them with random numbers so this is normally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6180" target="_blank">01:43:00.320</a></span> | <span class="t">distributed random numbers that's what random n is and that will be n users okay so 944 by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6187" target="_blank">01:43:07.680</a></span> | <span class="t">10 factors which is 5 that's exactly the same as this except this is just 15 so let's do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6195" target="_blank">01:43:15.920</a></span> | <span class="t">exactly the same thing for movies random numbers and movies by 5 okay and so to calculate the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6204" target="_blank">01:43:24.360</a></span> | <span class="t">result for some movie and some user we have to look up the index of the movie in our movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6210" target="_blank">01:43:30.440</a></span> | <span class="t">latent factors the index of the user in our user latent factors and then do a cross product</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6218" target="_blank">01:43:38.520</a></span> | <span class="t">so in other words we would say like oh okay for this particular combination we would have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6223" target="_blank">01:43:43.640</a></span> | <span class="t">to look up that numbered user over here and that numbered movie over here to get the two</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6231" target="_blank">01:43:51.500</a></span> | <span class="t">appropriate sets of latent factors but this is a problem because look up in an index is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6242" target="_blank">01:44:02.320</a></span> | <span class="t">not a linear model like remember our deep learning models really only know how to just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6252" target="_blank">01:44:12.400</a></span> | <span class="t">multiply matrices together and do simple element wise nonlinearities like ReLU there isn't</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6257" target="_blank">01:44:17.640</a></span> | <span class="t">a thing called look up in an index okay I'll just finish this bit here's the cool thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6267" target="_blank">01:44:27.240</a></span> | <span class="t">though the look up in an index is actually can be represented as a matrix product believe</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6276" target="_blank">01:44:36.440</a></span> | <span class="t">it or not so if you replace our indices with one hot encoded vectors then a one hot encoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6287" target="_blank">01:44:47.200</a></span> | <span class="t">vector times something is identical to looking up in an index and let me show you so if we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6299" target="_blank">01:44:59.440</a></span> | <span class="t">grab if we call the one hot function that creates a as it says here one hot encoding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6311" target="_blank">01:45:11.260</a></span> | <span class="t">and we're going to one hot encode the value three with end users classes and so end users</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6321" target="_blank">01:45:21.700</a></span> | <span class="t">as we've just discussed is 944 right then so if we go one hot one hot encoding the number</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6335" target="_blank">01:45:35.640</a></span> | <span class="t">three into end users one hot three we get this big array big tensor and as you can see in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6354" target="_blank">01:45:54.400</a></span> | <span class="t">index 3 0 1 2 3 we have a 1 and the size of that is 944 so if we then multiply that by</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6370" target="_blank">01:46:10.720</a></span> | <span class="t">user factors or user factors remember is that random matrix of this size and what's going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6382" target="_blank">01:46:22.920</a></span> | <span class="t">to happen so we're going to go 0 by the first row and so that's going to be all zeros and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6395" target="_blank">01:46:35.280</a></span> | <span class="t">then we're going to go 0 again and we're going to 0 again and then we're going to find finally</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6398" target="_blank">01:46:38.860</a></span> | <span class="t">go 1 right on the index 3 row and so it's going to return each of them and then we'll</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6407" target="_blank">01:46:47.160</a></span> | <span class="t">go back to 0 again so if we do that remember at sign is matrix multiply</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6417" target="_blank">01:46:57.520</a></span> | <span class="t">and compare that to user factors 3 same thing isn't that crazy so it's a kind of weird inefficient</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6433" target="_blank">01:47:13.360</a></span> | <span class="t">way to do it right but matrix multiplication is a way to index into an array and this is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6442" target="_blank">01:47:22.080</a></span> | <span class="t">the thing that we know how to do SGD with and we know how to build models with so it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6447" target="_blank">01:47:27.320</a></span> | <span class="t">turns out that anything that we can do with indexing to array we now have a way to optimize</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6453" target="_blank">01:47:33.760</a></span> | <span class="t">and we have a question there are two questions one how different in practice is collaborative</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6460" target="_blank">01:47:40.520</a></span> | <span class="t">filtering with sparse data compared to dense data we are not doing sparse data in this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6468" target="_blank">01:47:48.020</a></span> | <span class="t">course but there's an excellent course I hear called computational linear algebra for coders</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6473" target="_blank">01:47:53.680</a></span> | <span class="t">it has a lot of information about sparse the fast AI course and second question in practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6480" target="_blank">01:48:00.800</a></span> | <span class="t">do we tune the number of latent factors absolutely we do yes just it's just a number of filters</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6490" target="_blank">01:48:10.280</a></span> | <span class="t">like we have in much any kind of deep learning model all right so now that we know that the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6502" target="_blank">01:48:22.400</a></span> | <span class="t">procedure of finding out which latent set of latent factors is the right thing looking</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6507" target="_blank">01:48:27.980</a></span> | <span class="t">something up in an index is the same as matrix multiplication with a one-hot vector I already</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6515" target="_blank">01:48:35.320</a></span> | <span class="t">had it over here we can go ahead and build a model with that so basically if we do this</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6525" target="_blank">01:48:45.360</a></span> | <span class="t">for a whole for a few indices at once then we have a matrix of one hot encoded vectors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6529" target="_blank">01:48:49.840</a></span> | <span class="t">so the whole thing is just one big matrix multiplication now the thing is as I said</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6538" target="_blank">01:48:58.600</a></span> | <span class="t">this is a pretty inefficient way to to do an index lookup so there is a computational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6547" target="_blank">01:49:07.160</a></span> | <span class="t">shortcut which is called an embedding an embedding is a layer that has the computational speed</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6558" target="_blank">01:49:18.400</a></span> | <span class="t">of an array lookup and the same gradients as a matrix multiplication how does it do</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6567" target="_blank">01:49:27.440</a></span> | <span class="t">that well just internally it uses an index lookup to actually grab the values and it</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6575" target="_blank">01:49:35.120</a></span> | <span class="t">also knows what the gradient of a matrix multiplication by a one-hot encoded vector is or matrix is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6584" target="_blank">01:49:44.720</a></span> | <span class="t">without having to go to all this trouble and so an embedding is a matrix multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6590" target="_blank">01:49:50.360</a></span> | <span class="t">with a one-hot encoded vector where you never actually have to create the one-hot encoded</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6594" target="_blank">01:49:54.320</a></span> | <span class="t">vector you just need the indexes this is important to remember because a lot of people have heard</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6600" target="_blank">01:50:00.000</a></span> | <span class="t">about embeddings and they think there's something special and magical and and they're absolutely</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6606" target="_blank">01:50:06.240</a></span> | <span class="t">not you can do exactly the same thing by creating a one-hot encoded matrix and doing a matrix</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6611" target="_blank">01:50:11.360</a></span> | <span class="t">multiply it is just a computational shortcut nothing else I often find when I talk to people</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6618" target="_blank">01:50:18.600</a></span> | <span class="t">about this in person I have to tell them this six or seven times before they believe me</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6625" target="_blank">01:50:25.120</a></span> | <span class="t">because they think embeddings are something more clever and they're not it's just a computational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6629" target="_blank">01:50:29.440</a></span> | <span class="t">shortcut to do a matrix multiplication more quickly with a one-hot encoded matrix by instead</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6634" target="_blank">01:50:34.800</a></span> | <span class="t">doing an array lookup okay so let's try and create a collaborative filtering model in</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6646" target="_blank">01:50:46.280</a></span> | <span class="t">PyTorch a model or an architecture or really an nn.module is a class so to use PyTorch through</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6657" target="_blank">01:50:57.320</a></span> | <span class="t">its fullest you need to understand object-oriented programming because we have to create classes</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6661" target="_blank">01:51:01.600</a></span> | <span class="t">there's a lot of tutorials about this so I won't go into detail about it but I'll give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6666" target="_blank">01:51:06.740</a></span> | <span class="t">you a quick overview a class could be something like dog or resnet or circle and it's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6676" target="_blank">01:51:16.200</a></span> | <span class="t">something that has some data attached to it and it has some functionality attached to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6680" target="_blank">01:51:20.520</a></span> | <span class="t">it is a class called example the data it has attached to it is a and the functionality</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6688" target="_blank">01:51:28.360</a></span> | <span class="t">attached to it is say and so we can for example create an instance of this class an object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6696" target="_blank">01:51:36.040</a></span> | <span class="t">of this type example you pass in silver so silver will now be in ex.a and we can then</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6704" target="_blank">01:51:44.800</a></span> | <span class="t">say ex.say and it will call say and it will say passing in nice to meet you so that will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6710" target="_blank">01:51:50.680</a></span> | <span class="t">be x and so it'll say hello self.a so that's silver nice to meet you here it is okay so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6722" target="_blank">01:52:02.800</a></span> | <span class="t">in Python the way you create a class is to say class in its name then to say what is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6729" target="_blank">01:52:09.360</a></span> | <span class="t">passed to it when you create that object it's a special method called dunder in it as we've</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6735" target="_blank">01:52:15.520</a></span> | <span class="t">briefly mentioned before in Python there are all kinds of special method names that have</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6741" target="_blank">01:52:21.720</a></span> | <span class="t">special behavior they start with two underscores they end with two underscores and we pronounce</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6747" target="_blank">01:52:27.160</a></span> | <span class="t">that dunder so dunder in it all methods in all regular methods instance methods in Python</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6758" target="_blank">01:52:38.240</a></span> | <span class="t">always get passed the actual object itself first that we normally call that self and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6764" target="_blank">01:52:44.000</a></span> | <span class="t">then optionally anything else and so you can then change the contents of the current object</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6769" target="_blank">01:52:49.720</a></span> | <span class="t">by just setting self.whatever to whatever you like so after this self.a is now equal</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6775" target="_blank">01:52:55.880</a></span> | <span class="t">to silver so we call a method same thing it's passed self optionally anything you pass to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6783" target="_blank">01:53:03.400</a></span> | <span class="t">it and then you can access the contents of self which you stashed away back here when</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6789" target="_blank">01:53:09.200</a></span> | <span class="t">we initialized it so that's basically how object or you know the basics of object-oriented</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6794" target="_blank">01:53:14.920</a></span> | <span class="t">programming works in Python there's something else you can do when you create a new class</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6804" target="_blank">01:53:24.640</a></span> | <span class="t">which is you can pop something in parentheses after its name and that means we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6809" target="_blank">01:53:29.120</a></span> | <span class="t">to use something called inheritance and what inheritance means is I want to have all the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6814" target="_blank">01:53:34.160</a></span> | <span class="t">functionality of this class plus I want to add some additional functionality so module</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6821" target="_blank">01:53:41.000</a></span> | <span class="t">is a PyTorch class which fast.ai has customized so it's kind of a fast.ai version of a PyTorch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6829" target="_blank">01:53:49.920</a></span> | <span class="t">class and probably in the next course we'll see exactly how it works and but it looks</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6840" target="_blank">01:54:00.200</a></span> | <span class="t">a lot like a it all acts almost exactly like a just a regular Python class we have an init</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6847" target="_blank">01:54:07.440</a></span> | <span class="t">and we can set attributes to whatever we like and one of the things we can use is an embedding</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6855" target="_blank">01:54:15.120</a></span> | <span class="t">and so an embedding is just this class that does what I just described a it's the same</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6859" target="_blank">01:54:19.880</a></span> | <span class="t">as an as a linear layer with a one hot encoded matrix but it does it with this computational</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6865" target="_blank">01:54:25.920</a></span> | <span class="t">shortcut you can say how many in this case users are there and how many factors will</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6871" target="_blank">01:54:31.000</a></span> | <span class="t">they have now there is one very special thing about things that inherit from module which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6878" target="_blank">01:54:38.400</a></span> | <span class="t">is that when you call them it will actually call a method called forward so forward is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6884" target="_blank">01:54:44.240</a></span> | <span class="t">a special PyTorch method name it's the most important PyTorch method name this is where</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6889" target="_blank">01:54:49.820</a></span> | <span class="t">you put the the actual computation so to to grab the factors from an embedding we just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6898" target="_blank">01:54:58.160</a></span> | <span class="t">call it like a function right so this is going to get passed here the user IDs and the movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6905" target="_blank">01:55:05.640</a></span> | <span class="t">IDs as two columns so let's grab the zero index column and grab the embeddings by passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6912" target="_blank">01:55:12.520</a></span> | <span class="t">them to user factors and then we'll do the same thing for the index one column that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6917" target="_blank">01:55:17.640</a></span> | <span class="t">the movie IDs pass them to the movie factors and then here is our element wise multiplication</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6925" target="_blank">01:55:25.280</a></span> | <span class="t">and then sum and now remember we've got another dimension time the first axis is the minibatch</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6933" target="_blank">01:55:33.320</a></span> | <span class="t">dimension so we want to sum over the other dimension the index one dimension so that's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6940" target="_blank">01:55:40.040</a></span> | <span class="t">going to give us a dot product for each user sorry for each rating for each user movie</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6947" target="_blank">01:55:47.960</a></span> | <span class="t">combination so this is the dot product class so you can see if we look at one batch of</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6958" target="_blank">01:55:58.440</a></span> | <span class="t">our data it's of size of shape 64 by 2 because there are 64 items in the minibatch and each</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6966" target="_blank">01:56:06.240</a></span> | <span class="t">one has this is the independent variables so it's got the user ID and the movie ID to</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6980" target="_blank">01:56:20.840</a></span> | <span class="t">deep neural network based models for collaborative filtering work better than more traditional</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6985" target="_blank">01:56:25.400</a></span> | <span class="t">approaches like SPP or other matrix let's wait until we get there so here's X right so here</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=6999" target="_blank">01:56:39.160</a></span> | <span class="t">is one user ID movie ID combination okay and then each one of those 64 here are the ratings</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7016" target="_blank">01:56:56.400</a></span> | <span class="t">so now we've created a dot product module from scratch so we can instantiate it passing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7023" target="_blank">01:57:03.600</a></span> | <span class="t">in the number of users the number of movies and let's use 50 factors and now we can create</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7027" target="_blank">01:57:07.920</a></span> | <span class="t">a learner now this time we're not creating a CNN learner or a specific application learner</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7033" target="_blank">01:57:13.320</a></span> | <span class="t">it's just a totally generic learner so this is a learner that doesn't really know how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7037" target="_blank">01:57:17.160</a></span> | <span class="t">to do anything clever it just stores away the data you give it and the model you give</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7041" target="_blank">01:57:21.920</a></span> | <span class="t">it and so when we're not using an application specific learner it doesn't know what loss</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7046" target="_blank">01:57:26.280</a></span> | <span class="t">function to use so we'll tell it to use MSE and fit and that's it right so we've just</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7054" target="_blank">01:57:34.680</a></span> | <span class="t">fitted our own collaborative filtering model where we literally created the entire architecture</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7060" target="_blank">01:57:40.920</a></span> | <span class="t">it's a pretty simple one from scratch so that's pretty amazing now the results aren't great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7070" target="_blank">01:57:50.600</a></span> | <span class="t">if you look at the movie lens data set benchmarks online you'll see this is not actually a great</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7077" target="_blank">01:57:57.360</a></span> | <span class="t">result so one of the things we should do is take advantage of the tip we just mentioned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7082" target="_blank">01:58:02.520</a></span> | <span class="t">earlier in this lesson which is when you're doing regression which we are here right the</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7087" target="_blank">01:58:07.320</a></span> | <span class="t">number between one and five is like a continuous value we're trying to get as close to it as</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7091" target="_blank">01:58:11.040</a></span> | <span class="t">possible we should tell fastai what the range is so we can use y range as before so here's</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7102" target="_blank">01:58:22.400</a></span> | <span class="t">exactly the same thing we've got a y range we've stored it away and then at the end we</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7108" target="_blank">01:58:28.400</a></span> | <span class="t">use as we discussed sigmoid range passing in and look here we pass in star self dot</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7115" target="_blank">01:58:35.200</a></span> | <span class="t">y range that's going to pass in by default 0 comma 5.5 and so we can see yeah not really</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7128" target="_blank">01:58:48.160</a></span> | <span class="t">any better it's worth a try normally this is a little bit better but it always depends</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7136" target="_blank">01:58:56.560</a></span> | <span class="t">on when you run it I'll just run it a second time well it's worth looking now there is</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7144" target="_blank">01:59:04.840</a></span> | <span class="t">something else we can do though which is that if we look back at our little Excel version</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7154" target="_blank">01:59:14.240</a></span> | <span class="t">the thing is here when we multiply you know these latent factors by these latent factors</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7162" target="_blank">01:59:22.080</a></span> | <span class="t">and add them up it's not really taking account of the fact that this user may just rate movies</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7171" target="_blank">01:59:31.220</a></span> | <span class="t">really badly in general regardless of what kind of movie they are and this movie might</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7178" target="_blank">01:59:38.260</a></span> | <span class="t">be just a great movie in general just everybody likes it regardless of what kind of stuff</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7182" target="_blank">01:59:42.960</a></span> | <span class="t">they like and so it'd be nice to be able to represent this directly and we can do that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7188" target="_blank">01:59:48.400</a></span> | <span class="t">using something we've already learned about which is bias we could have another single</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7193" target="_blank">01:59:53.400</a></span> | <span class="t">number for each movie which we just add and it's another single number for each user which</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7199" target="_blank">01:59:59.440</a></span> | <span class="t">we just add right and we've already seen this for linear models you know this idea that</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7204" target="_blank">02:00:04.200</a></span> | <span class="t">it's nice to be able to add a bias value so let's do that so that means that we're going</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7213" target="_blank">02:00:13.280</a></span> | <span class="t">to need another embedding for each user which is a size one it's just a single number we're</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7218" target="_blank">02:00:18.520</a></span> | <span class="t">going to add so in other words it's just an array lookup but remember to do an array lookup</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7224" target="_blank">02:00:24.160</a></span> | <span class="t">that we can kind of take a gradient of we have to say embedding so we do the same thing</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7229" target="_blank">02:00:29.420</a></span> | <span class="t">for movie bias and so then all of this is identical as before and we just add this one</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7236" target="_blank">02:00:36.440</a></span> | <span class="t">extra line which is to add the user and movie bias values and so let's train that see how</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7245" target="_blank">02:00:45.680</a></span> | <span class="t">it goes well that was a shame it got worse so we used to have that finished here 0.87</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7259" target="_blank">02:00:59.200</a></span> | <span class="t">0.88, 0.89 so it's a little bit worse why is that well if you look earlier on it was quite</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7269" target="_blank">02:01:09.240</a></span> | <span class="t">better it was 0.86 so it's overfitting very quickly and so what we need to do is we need</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7279" target="_blank">02:01:19.720</a></span> | <span class="t">to find a way that we can train more epochs without overfitting now we've already learned</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7286" target="_blank">02:01:26.760</a></span> | <span class="t">about data augmentation right like rotating images and changing their brightness and color</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7291" target="_blank">02:01:31.640</a></span> | <span class="t">and stuff but it's not obvious how we would do data augmentation for collaborative filtering</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7297" target="_blank">02:01:37.720</a></span> | <span class="t">right so how are we going to make it so that we can train lots of epochs without overfitting</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7306" target="_blank">02:01:46.480</a></span> | <span class="t">and to do that we're going to have to use something called regularization and regularization</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7311" target="_blank">02:01:51.360</a></span> | <span class="t">is a set of techniques which basically allow us to use models with lots of parameters and</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7317" target="_blank">02:01:57.520</a></span> | <span class="t">train them for a long period of time but penalize them effectively for overfitting or in some</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7324" target="_blank">02:02:04.540</a></span> | <span class="t">way cause them to to try to stop overfitting and so that is what we will look at next week</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7333" target="_blank">02:02:13.160</a></span> | <span class="t">okay well thanks everybody so there's a lot to take in there so please remember to practice</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7338" target="_blank">02:02:18.920</a></span> | <span class="t">to experiment listen to the lessons again because you know for the next couple of lessons</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7346" target="_blank">02:02:26.080</a></span> | <span class="t">things are going to really quickly build on top of all the stuff that we've learned so</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7350" target="_blank">02:02:30.440</a></span> | <span class="t">please be as comfortable with it as you can feel free to go back and re-listen and go</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7356" target="_blank">02:02:36.080</a></span> | <span class="t">through and follow through the notebooks and then try to recreate as much of them yourself</span></div><div class="c"><span class="s"><a href="https://www.youtube.com/watch?v=cX30jxMNBUw&t=7360" target="_blank">02:02:40.920</a></span> | <span class="t">thanks everybody and I will see you next week or see you in the next lesson whenever you</span></div></div></body></html>